
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Scala、Java、F#、C#、Haskell、Clojure、Elixir で学ぶ関数型プログラミング">
      
      
        <meta name="author" content="Project Team">
      
      
      
        <link rel="prev" href="../part-5/">
      
      
        <link rel="next" href="../../clojure/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Part VI - 実践 - Grokking Functional Programming</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../docs/mkdocs/assets/css/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#part-vi" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Grokking Functional Programming" class="md-header__button md-logo" aria-label="Grokking Functional Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Grokking Functional Programming
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Part VI - 実践
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/k2works/grokkingfp-excersice" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    grokkingfp-excersice
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../scala/" class="md-tabs__link">
          
  
  
  Scala

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../java/" class="md-tabs__link">
          
  
  
  Java

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../fsharp/" class="md-tabs__link">
          
  
  
  F#

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../csharp/" class="md-tabs__link">
          
  
  
  C#

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
  Haskell

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../clojure/" class="md-tabs__link">
          
  
  
  Clojure

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../elixir/" class="md-tabs__link">
          
  
  
  Elixir

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../rust/" class="md-tabs__link">
          
  
  
  Rust

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Grokking Functional Programming" class="md-nav__button md-logo" aria-label="Grokking Functional Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Grokking Functional Programming
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/k2works/grokkingfp-excersice" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    grokkingfp-excersice
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Scala
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Scala
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scala/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概要
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scala/part-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part I - 基礎
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scala/part-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part II - 関数型スタイル
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scala/part-3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part III - エラーハンドリング
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scala/part-4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part IV - IO と副作用
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scala/part-5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part V - 並行処理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scala/part-6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part VI - 実践
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Java
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Java
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../java/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概要
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../java/part-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part I - 基礎
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../java/part-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part II - 関数型スタイル
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../java/part-3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part III - エラーハンドリング
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../java/part-4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part IV - IO と副作用
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../java/part-5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part V - 並行処理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../java/part-6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part VI - 実践
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    F#
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    F#
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fsharp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概要
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fsharp/part-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part I - 基礎
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fsharp/part-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part II - 関数型スタイル
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fsharp/part-3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part III - エラーハンドリング
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fsharp/part-4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part IV - 非同期処理とストリーム
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fsharp/part-5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part V - 並行処理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fsharp/part-6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part VI - 実践
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    C#
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    C#
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csharp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概要
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csharp/part-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part I - 基礎
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csharp/part-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part II - 関数型スタイル
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csharp/part-3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part III - エラーハンドリング
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csharp/part-4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part IV - 非同期処理とストリーム
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csharp/part-5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part V - 並行処理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csharp/part-6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part VI - 実践
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Haskell
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Haskell
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概要
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../part-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part I - 基礎
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../part-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part II - 関数型スタイル
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../part-3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part III - エラーハンドリング
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../part-4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part IV - IO とストリーム
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../part-5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part V - 並行処理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Part VI - 実践
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Part VI - 実践
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#12" class="md-nav__link">
    <span class="md-ellipsis">
      
        第12章: テスト戦略と実践アプリケーション
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第12章: テスト戦略と実践アプリケーション">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#121-travelguide" class="md-nav__link">
    <span class="md-ellipsis">
      
        12.1 TravelGuide アプリケーション
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#122" class="md-nav__link">
    <span class="md-ellipsis">
      
        12.2 ドメインモデルの定義
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#123" class="md-nav__link">
    <span class="md-ellipsis">
      
        12.3 データアクセス層の抽象化
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#124" class="md-nav__link">
    <span class="md-ellipsis">
      
        12.4 テスト用スタブの作成
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#125-searchreport" class="md-nav__link">
    <span class="md-ellipsis">
      
        12.5 SearchReport の導入
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#126" class="md-nav__link">
    <span class="md-ellipsis">
      
        12.6 アプリケーションロジック
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#127" class="md-nav__link">
    <span class="md-ellipsis">
      
        12.7 キャッシュの実装
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#128-bracket" class="md-nav__link">
    <span class="md-ellipsis">
      
        12.8 リソース管理（bracket）
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#129" class="md-nav__link">
    <span class="md-ellipsis">
      
        12.9 純粋関数のテスト
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1210-hspec" class="md-nav__link">
    <span class="md-ellipsis">
      
        12.10 HSpec によるユニットテスト
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1211-quickcheck" class="md-nav__link">
    <span class="md-ellipsis">
      
        12.11 QuickCheck によるプロパティベーステスト
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1212" class="md-nav__link">
    <span class="md-ellipsis">
      
        12.12 統合テスト
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1213" class="md-nav__link">
    <span class="md-ellipsis">
      
        12.13 テストピラミッド
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        まとめ
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="まとめ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#part-vi_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Part VI で学んだこと
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scala-haskell" class="md-nav__link">
    <span class="md-ellipsis">
      
        Scala と Haskell の比較
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        キーポイント
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        学習の総括
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        演習問題
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="演習問題">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-dataaccess" class="md-nav__link">
    <span class="md-ellipsis">
      
        問題 1: DataAccess の拡張
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      
        問題 2: プロパティベーステスト
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-bracket" class="md-nav__link">
    <span class="md-ellipsis">
      
        問題 3: bracket の実装
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    <span class="md-ellipsis">
      
        問題 4: エラー収集
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        シリーズ全体の総括
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="シリーズ全体の総括">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        学んだ主な概念
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#haskell" class="md-nav__link">
    <span class="md-ellipsis">
      
        Haskell の関数型プログラミングの利点
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      
        次のステップ
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Clojure
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Clojure
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../clojure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概要
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../clojure/part-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part I - 基礎
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../clojure/part-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part II - 関数型スタイル
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../clojure/part-3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part III - nil 安全性
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../clojure/part-4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part IV - 副作用とシーケンス
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../clojure/part-5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part V - 並行処理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../clojure/part-6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part VI - 実践
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Elixir
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Elixir
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../elixir/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概要
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../elixir/part-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part I - 基礎
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../elixir/part-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part II - 関数型スタイル
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../elixir/part-3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part III - エラーハンドリング
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../elixir/part-4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part IV - IO とストリーム
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../elixir/part-5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part V - 並行処理と OTP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../elixir/part-6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part VI - 実践
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Rust
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Rust
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rust/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概要
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rust/part-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part I - 基礎
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rust/part-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part II - 関数型スタイル
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rust/part-3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part III - エラーハンドリング
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rust/part-4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part IV - 非同期とストリーム
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rust/part-5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part V - 並行処理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rust/part-6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part VI - 実践
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="part-vi">Part VI: 実践的なアプリケーション構築とテスト<a class="headerlink" href="#part-vi" title="Permanent link">&para;</a></h1>
<p>本章では、これまで学んだ関数型プログラミングの概念を統合し、実践的なアプリケーションを構築します。また、Haskell におけるテスト戦略についても学びます。</p>
<hr />
<h2 id="12">第12章: テスト戦略と実践アプリケーション<a class="headerlink" href="#12" title="Permanent link">&para;</a></h2>
<h3 id="121-travelguide">12.1 TravelGuide アプリケーション<a class="headerlink" href="#121-travelguide" title="Permanent link">&para;</a></h3>
<p><strong>ソースファイル</strong>: <code>app/haskell/src/Ch12/TestingStrategies.hs</code></p>
<p>旅行ガイドアプリケーションを例に、実践的な FP アプリケーションの構築方法を学びます。</p>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkNMQVNTIiBoZWlnaHQ9IjM4MXB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6NzUzcHg7aGVpZ2h0OjM4MXB4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDc1MyAzODEiIHdpZHRoPSI3NTNweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PGRlZnMvPjxnPjwhLS1jbHVzdGVyIFRyYXZlbEd1aWRlIEFwcGxpY2F0aW9uLS0+PGcgY2xhc3M9ImNsdXN0ZXIiIGRhdGEtZW50aXR5PSJUcmF2ZWxHdWlkZSBBcHBsaWNhdGlvbiIgZGF0YS1zb3VyY2UtbGluZT0iMyIgZGF0YS11aWQ9ImVudDAwMDIiIGlkPSJjbHVzdGVyX1RyYXZlbEd1aWRlIEFwcGxpY2F0aW9uIj48cGF0aCBkPSJNMTMuNSwxMSBMMjAzLjc2NjYsMTEgQTMuNzUsMy43NSAwIDAgMSAyMDYuMjY2NiwxMy41IEwyMTMuMjY2NiwzMy4yOTY5IEw3NDMuNSwzMy4yOTY5IEEyLjUsMi41IDAgMCAxIDc0NiwzNS43OTY5IEw3NDYsMzcyLjI4IEEyLjUsMi41IDAgMCAxIDc0My41LDM3NC43OCBMMTMuNSwzNzQuNzggQTIuNSwyLjUgMCAwIDEgMTEsMzcyLjI4IEwxMSwxMy41IEEyLjUsMi41IDAgMCAxIDEzLjUsMTEiIGZpbGw9IiNGRkZGRkYiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTEiIHgyPSIyMTMuMjY2NiIgeTE9IjMzLjI5NjkiIHkyPSIzMy4yOTY5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE4OS4yNjY2IiB4PSIxNSIgeT0iMjUuOTk1MSI+VHJhdmVsR3VpZGUgQXBwbGljYXRpb248L3RleHQ+PC9nPjwhLS1jbHVzdGVyIE1vZGVsLS0+PGcgY2xhc3M9ImNsdXN0ZXIiIGRhdGEtZW50aXR5PSJNb2RlbCIgZGF0YS1zb3VyY2UtbGluZT0iNCIgZGF0YS11aWQ9ImVudDAwMDMiIGlkPSJjbHVzdGVyX01vZGVsIj48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjI5Ni43OCIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjQxOSIgeD0iMzUiIHk9IjU0Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjQ3Ljg2NTIiIHg9IjIyMC41Njc0IiB5PSI2OC45OTUxIj5Nb2RlbDwvdGV4dD48L2c+PCEtLWNsdXN0ZXIgRGF0YSBBY2Nlc3MtLT48ZyBjbGFzcz0iY2x1c3RlciIgZGF0YS1lbnRpdHk9IkRhdGEgQWNjZXNzIiBkYXRhLXNvdXJjZS1saW5lPSIyNCIgZGF0YS11aWQ9ImVudDAwMDciIGlkPSJjbHVzdGVyX0RhdGEgQWNjZXNzIj48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjE0My44OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjI0NCIgeD0iNDc4IiB5PSI1NCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5NS42NzU4IiB4PSI1NTIuMTYyMSIgeT0iNjguOTk1MSI+RGF0YSBBY2Nlc3M8L3RleHQ+PC9nPjwhLS1jbGFzcyBMb2NhdGlvbi0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJMb2NhdGlvbiIgZGF0YS1zb3VyY2UtbGluZT0iNSIgZGF0YS11aWQ9ImVudDAwMDQiIGlkPSJlbnRpdHlfTG9jYXRpb24iPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iOTIuODkwNiIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjEzMy44NjQzIiB4PSI1MS4wNyIgeT0iODkiLz48ZWxsaXBzZSBjeD0iODQuOTUyNCIgY3k9IjEwMyIgZmlsbD0iI0ZGRkZGRiIgcng9IjkiIHJ5PSI5IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBhdGggZD0iTTg3LjkyMTEsMTA4LjY0MDYgUTg3LjM0MywxMDguOTM3NSA4Ni43MDI0LDEwOS4wNzgxIFE4Ni4wNjE3LDEwOS4yMzQ0IDg1LjM1ODYsMTA5LjIzNDQgUTgyLjg1ODYsMTA5LjIzNDQgODEuNTMwNSwxMDcuNTkzOCBRODAuMjE4LDEwNS45Mzc1IDgwLjIxOCwxMDIuODEyNSBRODAuMjE4LDk5LjY4NzUgODEuNTMwNSw5OC4wMzEzIFE4Mi44NTg2LDk2LjM3NSA4NS4zNTg2LDk2LjM3NSBRODYuMDYxNyw5Ni4zNzUgODYuNzAyNCw5Ni41MzEzIFE4Ny4zNTg2LDk2LjY4NzUgODcuOTIxMSw5Ni45ODQ0IEw4Ny45MjExLDk5LjcwMzEgUTg3LjI5NjEsOTkuMTI1IDg2LjcwMjQsOTguODU5NCBRODYuMTA4Niw5OC41NzgxIDg1LjQ4MzYsOTguNTc4MSBRODQuMTM5OSw5OC41NzgxIDgzLjQ1MjQsOTkuNjU2MyBRODIuNzY0OSwxMDAuNzE4OCA4Mi43NjQ5LDEwMi44MTI1IFE4Mi43NjQ5LDEwNC45MDYzIDgzLjQ1MjQsMTA1Ljk4NDQgUTg0LjEzOTksMTA3LjA0NjkgODUuNDgzNiwxMDcuMDQ2OSBRODYuMTA4NiwxMDcuMDQ2OSA4Ni43MDI0LDEwNi43ODEzIFE4Ny4yOTYxLDEwNi41IDg3LjkyMTEsMTA1LjkyMTkgTDg3LjkyMTEsMTA4LjY0MDYgWiAiIGZpbGw9IiMwMDAwMDAiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1OS40NTkiIHg9IjEwMS41OTI5IiB5PSIxMDcuODQ2NyI+TG9jYXRpb248L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgeDE9IjUyLjA3IiB4Mj0iMTgzLjkzNDMiIHkxPSIxMTciIHkyPSIxMTciLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMTQuODA5NiIgeD0iNTcuMDciIHk9IjEzMy45OTUxIj5sb2NJZDogTG9jYXRpb25JZDwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMTIuNDAzMyIgeD0iNTcuMDciIHk9IjE1MC4yOTIiPmxvY05hbWU6IFN0cmluZzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMjEuODY0MyIgeD0iNTcuMDciIHk9IjE2Ni41ODg5Ij5sb2NQb3B1bGF0aW9uOiBJbnQ8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgeDE9IjUyLjA3IiB4Mj0iMTgzLjkzNDMiIHkxPSIxNzMuODkwNiIgeTI9IjE3My44OTA2Ii8+PC9nPjwhLS1jbGFzcyBBdHRyYWN0aW9uLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9IkF0dHJhY3Rpb24iIGRhdGEtc291cmNlLWxpbmU9IjExIiBkYXRhLXVpZD0iZW50MDAwNSIgaWQ9ImVudGl0eV9BdHRyYWN0aW9uIj48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjkyLjg5MDYiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSIyMTguODg5NiIgeD0iMjE5LjU2IiB5PSI4OSIvPjxlbGxpcHNlIGN4PSIyOTAuNTUyMiIgY3k9IjEwMyIgZmlsbD0iI0ZGRkZGRiIgcng9IjkiIHJ5PSI5IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBhdGggZD0iTTI5My41MjA5LDEwOC42NDA2IFEyOTIuOTQyOCwxMDguOTM3NSAyOTIuMzAyMiwxMDkuMDc4MSBRMjkxLjY2MTYsMTA5LjIzNDQgMjkwLjk1ODQsMTA5LjIzNDQgUTI4OC40NTg0LDEwOS4yMzQ0IDI4Ny4xMzAzLDEwNy41OTM4IFEyODUuODE3OCwxMDUuOTM3NSAyODUuODE3OCwxMDIuODEyNSBRMjg1LjgxNzgsOTkuNjg3NSAyODcuMTMwMyw5OC4wMzEzIFEyODguNDU4NCw5Ni4zNzUgMjkwLjk1ODQsOTYuMzc1IFEyOTEuNjYxNiw5Ni4zNzUgMjkyLjMwMjIsOTYuNTMxMyBRMjkyLjk1ODQsOTYuNjg3NSAyOTMuNTIwOSw5Ni45ODQ0IEwyOTMuNTIwOSw5OS43MDMxIFEyOTIuODk1OSw5OS4xMjUgMjkyLjMwMjIsOTguODU5NCBRMjkxLjcwODQsOTguNTc4MSAyOTEuMDgzNCw5OC41NzgxIFEyODkuNzM5Nyw5OC41NzgxIDI4OS4wNTIyLDk5LjY1NjMgUTI4OC4zNjQ3LDEwMC43MTg4IDI4OC4zNjQ3LDEwMi44MTI1IFEyODguMzY0NywxMDQuOTA2MyAyODkuMDUyMiwxMDUuOTg0NCBRMjg5LjczOTcsMTA3LjA0NjkgMjkxLjA4MzQsMTA3LjA0NjkgUTI5MS43MDg0LDEwNy4wNDY5IDI5Mi4zMDIyLDEwNi43ODEzIFEyOTIuODk1OSwxMDYuNSAyOTMuNTIwOSwxMDUuOTIxOSBMMjkzLjUyMDksMTA4LjY0MDYgWiAiIGZpbGw9IiMwMDAwMDAiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2OS40MDUzIiB4PSIzMDguMDUyMiIgeT0iMTA3Ljg0NjciPkF0dHJhY3Rpb248L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgeDE9IjIyMC41NiIgeDI9IjQzNy40NDk2IiB5MT0iMTE3IiB5Mj0iMTE3Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTE3LjU2NDUiIHg9IjIyNS41NiIgeT0iMTMzLjk5NTEiPmF0dHJOYW1lOiBTdHJpbmc8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjA2Ljg4OTYiIHg9IjIyNS41NiIgeT0iMTUwLjI5MiI+YXR0ckRlc2NyaXB0aW9uOiBNYXliZSBTdHJpbmc8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTUzLjM5ODQiIHg9IjIyNS41NiIgeT0iMTY2LjU4ODkiPmF0dHJMb2NhdGlvbjogTG9jYXRpb248L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgeDE9IjIyMC41NiIgeDI9IjQzNy40NDk2IiB5MT0iMTczLjg5MDYiIHkyPSIxNzMuODkwNiIvPjwvZz48IS0tY2xhc3MgVHJhdmVsR3VpZGUtLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iVHJhdmVsR3VpZGUiIGRhdGEtc291cmNlLWxpbmU9IjE3IiBkYXRhLXVpZD0iZW50MDAwNiIgaWQ9ImVudGl0eV9UcmF2ZWxHdWlkZSI+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgaGVpZ2h0PSI5Mi44OTA2IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iMjI2LjQyOTciIHg9IjUwLjc5IiB5PSIyNDEuODkiLz48ZWxsaXBzZSBjeD0iMTE3Ljg2MTgiIGN5PSIyNTUuODkiIGZpbGw9IiNGRkZGRkYiIHJ4PSI5IiByeT0iOSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjxwYXRoIGQ9Ik0xMjAuODMwNSwyNjEuNTMwNiBRMTIwLjI1MjQsMjYxLjgyNzUgMTE5LjYxMTgsMjYxLjk2ODEgUTExOC45NzEyLDI2Mi4xMjQ0IDExOC4yNjgsMjYyLjEyNDQgUTExNS43NjgsMjYyLjEyNDQgMTE0LjQzOTksMjYwLjQ4MzggUTExMy4xMjc0LDI1OC44Mjc1IDExMy4xMjc0LDI1NS43MDI1IFExMTMuMTI3NCwyNTIuNTc3NSAxMTQuNDM5OSwyNTAuOTIxMyBRMTE1Ljc2OCwyNDkuMjY1IDExOC4yNjgsMjQ5LjI2NSBRMTE4Ljk3MTIsMjQ5LjI2NSAxMTkuNjExOCwyNDkuNDIxMyBRMTIwLjI2OCwyNDkuNTc3NSAxMjAuODMwNSwyNDkuODc0NCBMMTIwLjgzMDUsMjUyLjU5MzEgUTEyMC4yMDU1LDI1Mi4wMTUgMTE5LjYxMTgsMjUxLjc0OTQgUTExOS4wMTgsMjUxLjQ2ODEgMTE4LjM5MywyNTEuNDY4MSBRMTE3LjA0OTMsMjUxLjQ2ODEgMTE2LjM2MTgsMjUyLjU0NjMgUTExNS42NzQzLDI1My42MDg4IDExNS42NzQzLDI1NS43MDI1IFExMTUuNjc0MywyNTcuNzk2MyAxMTYuMzYxOCwyNTguODc0NCBRMTE3LjA0OTMsMjU5LjkzNjkgMTE4LjM5MywyNTkuOTM2OSBRMTE5LjAxOCwyNTkuOTM2OSAxMTkuNjExOCwyNTkuNjcxMyBRMTIwLjIwNTUsMjU5LjM5IDEyMC44MzA1LDI1OC44MTE5IEwxMjAuODMwNSwyNjEuNTMwNiBaICIgZmlsbD0iIzAwMDAwMCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijg0Ljc4NjEiIHg9IjEzNS4zNjE4IiB5PSIyNjAuNzM2NyI+VHJhdmVsR3VpZGU8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgeDE9IjUxLjc5IiB4Mj0iMjc2LjIxOTciIHkxPSIyNjkuODkiIHkyPSIyNjkuODkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNjIuMzUzNSIgeD0iNTYuNzkiIHk9IjI4Ni44ODUxIj50Z0F0dHJhY3Rpb246IEF0dHJhY3Rpb248L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTM1Ljg3NzkiIHg9IjU2Ljc5IiB5PSIzMDMuMTgyIj50Z1N1YmplY3RzOiBbU3RyaW5nXTwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyMTQuNDI5NyIgeD0iNTYuNzkiIHk9IjMxOS40Nzg5Ij50Z1NlYXJjaFJlcG9ydDogU2VhcmNoUmVwb3J0PC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiIHgxPSI1MS43OSIgeDI9IjI3Ni4yMTk3IiB5MT0iMzI2Ljc4MDYiIHkyPSIzMjYuNzgwNiIvPjwvZz48IS0tY2xhc3MgRGF0YUFjY2Vzcy0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJEYXRhQWNjZXNzIiBkYXRhLXNvdXJjZS1saW5lPSIyNSIgZGF0YS11aWQ9ImVudDAwMDgiIGlkPSJlbnRpdHlfRGF0YUFjY2VzcyI+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgaGVpZ2h0PSI5Mi44OTA2IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iMjExLjA3OTEiIHg9IjQ5NC40NiIgeT0iODkiLz48ZWxsaXBzZSBjeD0iNTU1LjQ0OTMiIGN5PSIxMDMiIGZpbGw9IiNGRkZGRkYiIHJ4PSI5IiByeT0iOSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjxwYXRoIGQ9Ik01NTguNDE4LDEwOC42NDA2IFE1NTcuODM5OSwxMDguOTM3NSA1NTcuMTk5MywxMDkuMDc4MSBRNTU2LjU1ODYsMTA5LjIzNDQgNTU1Ljg1NTUsMTA5LjIzNDQgUTU1My4zNTU1LDEwOS4yMzQ0IDU1Mi4wMjc0LDEwNy41OTM4IFE1NTAuNzE0OSwxMDUuOTM3NSA1NTAuNzE0OSwxMDIuODEyNSBRNTUwLjcxNDksOTkuNjg3NSA1NTIuMDI3NCw5OC4wMzEzIFE1NTMuMzU1NSw5Ni4zNzUgNTU1Ljg1NTUsOTYuMzc1IFE1NTYuNTU4Niw5Ni4zNzUgNTU3LjE5OTMsOTYuNTMxMyBRNTU3Ljg1NTUsOTYuNjg3NSA1NTguNDE4LDk2Ljk4NDQgTDU1OC40MTgsOTkuNzAzMSBRNTU3Ljc5Myw5OS4xMjUgNTU3LjE5OTMsOTguODU5NCBRNTU2LjYwNTUsOTguNTc4MSA1NTUuOTgwNSw5OC41NzgxIFE1NTQuNjM2OCw5OC41NzgxIDU1My45NDkzLDk5LjY1NjMgUTU1My4yNjE4LDEwMC43MTg4IDU1My4yNjE4LDEwMi44MTI1IFE1NTMuMjYxOCwxMDQuOTA2MyA1NTMuOTQ5MywxMDUuOTg0NCBRNTU0LjYzNjgsMTA3LjA0NjkgNTU1Ljk4MDUsMTA3LjA0NjkgUTU1Ni42MDU1LDEwNy4wNDY5IDU1Ny4xOTkzLDEwNi43ODEzIFE1NTcuNzkzLDEwNi41IDU1OC40MTgsMTA1LjkyMTkgTDU1OC40MTgsMTA4LjY0MDYgWiAiIGZpbGw9IiMwMDAwMDAiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI4MS42MDA2IiB4PSI1NzIuOTQ5MyIgeT0iMTA3Ljg0NjciPkRhdGFBY2Nlc3M8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgeDE9IjQ5NS40NiIgeDI9IjcwNC41MzkxIiB5MT0iMTE3IiB5Mj0iMTE3Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgeDE9IjQ5NS40NiIgeDI9IjcwNC41MzkxIiB5MT0iMTI1IiB5Mj0iMTI1Ii8+PGVsbGlwc2UgY3g9IjUwNS40NiIgY3k9IjEzOC42NDg0IiBmaWxsPSIjRkZGRkZGIiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMTQuMjAxMiIgeD0iNTEyLjQ2IiB5PSIxNDEuOTk1MSI+ZmluZEF0dHJhY3Rpb25zKCk8L3RleHQ+PGVsbGlwc2UgY3g9IjUwNS40NiIgY3k9IjE1NC45NDUzIiBmaWxsPSIjRkZGRkZGIiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNzcuNzYxNyIgeD0iNTEyLjQ2IiB5PSIxNTguMjkyIj5maW5kQXJ0aXN0c0Zyb21Mb2NhdGlvbigpPC90ZXh0PjxlbGxpcHNlIGN4PSI1MDUuNDYiIGN5PSIxNzEuMjQyMiIgZmlsbD0iI0ZGRkZGRiIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTg3LjA3OTEiIHg9IjUxMi40NiIgeT0iMTc0LjU4ODkiPmZpbmRNb3ZpZXNBYm91dExvY2F0aW9uKCk8L3RleHQ+PC9nPjwhLS1TUkM9W0xQMzFKaUNtMzhSbFVPZ200dVd0b0F0STFBZjQ0TUJTNDBTdENMcjZjYUluRW1iRFV0U0lzajltekZWUl9zX3hYZXl1ZWVtRWgxU1lXbHcyMFVOa0JTNFB0VURhM1NlY0hjU3JpMHItOW95WWVNUm1XeWpUTkozZTJqQ0VZRUhKY0Jpb1M0NnRIbHNIclhKbzMyQ2dVVTFhX0wzZ2JuMGR6d2loc05lTUx4NE9EU205ejY4NWtWV3RNUzBVSUlTUnZ6YUVsZGtpckpMc01zM3BoWS14MjF3c0I1TmJQazRtelFUeUFZZHZGYmpfNThZR3pGNExPcVlTNXdnZ2Q5MHBna1ZpV0s0c01ZRkh6ZzgyUHZSSF9RVnJQaWthc3hpNTlSUjR6OTMya0V3X0licXVNd0ljM25ETktlYy1fVzAwXS0tPjwvZz48L3N2Zz4=" class="uml" alt="uml diagram" title="" /></p>
<h3 id="122">12.2 ドメインモデルの定義<a class="headerlink" href="#122" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">-- 位置ID（値オブジェクト）</span>
<span class="kr">newtype</span><span class="w"> </span><span class="kt">LocationId</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">LocationId</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">unLocationId</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="kr">deriving</span><span class="w"> </span><span class="p">(</span><span class="kt">Show</span><span class="p">,</span><span class="w"> </span><span class="kt">Eq</span><span class="p">,</span><span class="w"> </span><span class="kt">Ord</span><span class="p">)</span>

<span class="c1">-- ロケーション</span>
<span class="kr">data</span><span class="w"> </span><span class="kt">Location</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">Location</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="n">locId</span><span class="w">         </span><span class="ow">::</span><span class="w"> </span><span class="kt">LocationId</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">locName</span><span class="w">       </span><span class="ow">::</span><span class="w"> </span><span class="kt">String</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">locPopulation</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Int</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="kr">deriving</span><span class="w"> </span><span class="p">(</span><span class="kt">Show</span><span class="p">,</span><span class="w"> </span><span class="kt">Eq</span><span class="p">)</span>

<span class="c1">-- アトラクション（観光地）</span>
<span class="kr">data</span><span class="w"> </span><span class="kt">Attraction</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">Attraction</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="n">attrName</span><span class="w">        </span><span class="ow">::</span><span class="w"> </span><span class="kt">String</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">attrDescription</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Maybe</span><span class="w"> </span><span class="kt">String</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">attrLocation</span><span class="w">    </span><span class="ow">::</span><span class="w"> </span><span class="kt">Location</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="kr">deriving</span><span class="w"> </span><span class="p">(</span><span class="kt">Show</span><span class="p">,</span><span class="w"> </span><span class="kt">Eq</span><span class="p">)</span>

<span class="c1">-- 旅行ガイド</span>
<span class="kr">data</span><span class="w"> </span><span class="kt">TravelGuide</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">TravelGuide</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="n">tgAttraction</span><span class="w">   </span><span class="ow">::</span><span class="w"> </span><span class="kt">Attraction</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">tgSubjects</span><span class="w">     </span><span class="ow">::</span><span class="w"> </span><span class="p">[</span><span class="kt">String</span><span class="p">]</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">tgSearchReport</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">SearchReport</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="kr">deriving</span><span class="w"> </span><span class="p">(</span><span class="kt">Show</span><span class="p">,</span><span class="w"> </span><span class="kt">Eq</span><span class="p">)</span>
</code></pre></div>
<p>Scala との対応:
- <code>opaque type LocationId</code> → <code>newtype LocationId</code>
- <code>case class</code> → <code>data</code> with record syntax
- <code>Option[String]</code> → <code>Maybe String</code></p>
<h3 id="123">12.3 データアクセス層の抽象化<a class="headerlink" href="#123" title="Permanent link">&para;</a></h3>
<p>外部データソースへのアクセスをレコード型で抽象化します。</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- データアクセスインターフェース</span>
<span class="kr">data</span><span class="w"> </span><span class="kt">DataAccess</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">DataAccess</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="n">findAttractions</span><span class="w">         </span><span class="ow">::</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">AttractionOrdering</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">IO</span><span class="w"> </span><span class="p">[</span><span class="kt">Attraction</span><span class="p">]</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">findArtistsFromLocation</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">LocationId</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">IO</span><span class="w"> </span><span class="p">(</span><span class="kt">Either</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="p">[</span><span class="kt">MusicArtist</span><span class="p">])</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">findMoviesAboutLocation</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">LocationId</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">IO</span><span class="w"> </span><span class="p">(</span><span class="kt">Either</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="p">[</span><span class="kt">Movie</span><span class="p">])</span>
<span class="w">    </span><span class="p">}</span>
</code></pre></div>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkRFU0NSSVBUSU9OIiBoZWlnaHQ9IjE5MXB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6NjI2cHg7aGVpZ2h0OjE5MXB4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDYyNiAxOTEiIHdpZHRoPSI2MjZweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PGRlZnMvPjxnPjwhLS1jbHVzdGVyIERhdGFBY2Nlc3M/Pz8/Pz8/LS0+PGcgY2xhc3M9ImNsdXN0ZXIiIGRhdGEtZW50aXR5PSJEYXRhQWNjZXNzLi4uLi4uLiIgZGF0YS1zb3VyY2UtbGluZT0iMyIgZGF0YS11aWQ9ImVudDAwMDIiIGlkPSJjbHVzdGVyX0RhdGFBY2Nlc3MuLi4uLi4uIj48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjczLjMiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSI2MDgiIHg9IjEyIiB5PSIxMiIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxODguODAxMyIgeD0iMjIxLjU5OTMiIHk9IjI2Ljk5NTEiPkRhdGFBY2Nlc3MmIzY1Mjg4OyYjMTI1MjQ7JiMxMjQ2NzsmIzEyNTQwOyYjMTI0ODk7JiMyMjQxMTsmIzY1Mjg5OzwvdGV4dD48L2c+PCEtLWVudGl0eSBmaW5kQXR0cmFjdGlvbnMtLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iZmluZEF0dHJhY3Rpb25zIiBkYXRhLXNvdXJjZS1saW5lPSI0IiBkYXRhLXVpZD0iZW50MDAwMyIgaWQ9ImVudGl0eV9maW5kQXR0cmFjdGlvbnMiPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iMjIuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjEyMy4yNzczIiB4PSIyOC4zNiIgeT0iNDciLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDMuMjc3MyIgeD0iMzguMzYiIHk9IjYyLjk5NTEiPmZpbmRBdHRyYWN0aW9uczwvdGV4dD48L2c+PCEtLWVudGl0eSBmaW5kQXJ0aXN0c0Zyb21Mb2NhdGlvbi0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJmaW5kQXJ0aXN0c0Zyb21Mb2NhdGlvbiIgZGF0YS1zb3VyY2UtbGluZT0iNSIgZGF0YS11aWQ9ImVudDAwMDQiIGlkPSJlbnRpdHlfZmluZEFydGlzdHNGcm9tTG9jYXRpb24iPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iMjIuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjE4Ni44Mzc5IiB4PSIxODYuNTgiIHk9IjQ3Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTY2LjgzNzkiIHg9IjE5Ni41OCIgeT0iNjIuOTk1MSI+ZmluZEFydGlzdHNGcm9tTG9jYXRpb248L3RleHQ+PC9nPjwhLS1lbnRpdHkgZmluZE1vdmllc0Fib3V0TG9jYXRpb24tLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iZmluZE1vdmllc0Fib3V0TG9jYXRpb24iIGRhdGEtc291cmNlLWxpbmU9IjYiIGRhdGEtdWlkPSJlbnQwMDA1IiBpZD0iZW50aXR5X2ZpbmRNb3ZpZXNBYm91dExvY2F0aW9uIj48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjIyLjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSIxOTYuMTU1MyIgeD0iNDA3LjkyIiB5PSI0NyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE3Ni4xNTUzIiB4PSI0MTcuOTIiIHk9IjYyLjk5NTEiPmZpbmRNb3ZpZXNBYm91dExvY2F0aW9uPC90ZXh0PjwvZz48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iR01ONiIgZGF0YS1zb3VyY2UtbGluZT0iMTAiIGRhdGEtdWlkPSJlbnQwMDA3IiBpZD0iZW50aXR5X0dNTjYiPjxwYXRoIGQ9Ik00MTcuOCwxMjkuMyBMNDE3LjgsMTg0LjY5ODQgQTAsMCAwIDAgMCA0MTcuOCwxODQuNjk4NCBMNTk0LjE5NzEsMTg0LjY5ODQgQTAsMCAwIDAgMCA1OTQuMTk3MSwxODQuNjk4NCBMNTk0LjE5NzEsMTM5LjMgTDU4NC4xOTcxLDEyOS4zIEw1MTAsMTI5LjMgTDUwNiw2OS41MiBMNTAyLDEyOS4zIEw0MTcuOCwxMjkuMyBBMCwwIDAgMCAwIDQxNy44LDEyOS4zIiBmaWxsPSIjRkZGRkZGIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBhdGggZD0iTTU4NC4xOTcxLDEyOS4zIEw1ODQuMTk3MSwxMzkuMyBMNTk0LjE5NzEsMTM5LjMgTDU4NC4xOTcxLDEyOS4zIiBmaWxsPSIjRkZGRkZGIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTU1LjM5NzEiIHg9IjQyMy44IiB5PSIxNDYuMzY2OSI+SGFza2VsbCAmIzEyMzkxOyYjMTIzOTk7JiMxMjUyNDsmIzEyNDY3OyYjMTI1NDA7JiMxMjQ4OTsmIzIyNDExOyYjMTIzOTE7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE0My4wMDAyIiB4PSI0MjMuOCIgeT0iMTYxLjQ5OTciPiYjMTI0NTI7JiMxMjUzMTsmIzEyNDc5OyYjMTI1NDA7JiMxMjUwMTsmIzEyNDU1OyYjMTI1NDA7JiMxMjQ3MzsmIzEyNDM0OyYjMzQ5MjA7JiMyOTY5NDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTUyLjQ1ODEiIHg9IjQyMy44IiB5PSIxNzYuNjMyNSI+JiM2NTI4ODtTY2FsYSAmIzEyMzk4OyB0cmFpdCAmIzEyMzk1OyYjMzA0NTY7JiMyNDQwMzsmIzY1Mjg5OzwvdGV4dD48L2c+PCEtLVNSQz1bTk8tbklXRDE0OFJ4VU9ocnRrSDBuNEFoRkM1YVJ6SjVsVHNtRXplNFktbXIxV2wxYTRlRzEyNjFZMmRJQTlwd0M0RDhraG8yVXBPNmt2X2xXdF8tRVUwQmdhYURCMWU3NDRXcGtkREJnWlg0bmI5aFlkN050YWhwQWNhYkpJbERVRnJxanNsN1hIZzJuYjJmdWlvdWdjR0VnRGJ1NXVqejdEWDRaYVYxcm9UVU8tVnR6UWNfRFhKQmxoX1lGdHEzdTNvSndkamNOeUNubmFrb0xpYmU5Z0ZibG5xUFdnR05RTFFJbGRfZkxEQWkyLWIzcWlGc1VSd3ZfdUF5bHdWSE9rdnVLdGNkdVBtTWN5VnR6VVNhVm1CYUFqTVRfMDQwXS0tPjwvZz48L3N2Zz4=" class="uml" alt="uml diagram" title="" /></p>
<p>Scala との対応:
- <code>trait DataAccess</code> → <code>data DataAccess = DataAccess { ... }</code>
- メソッド → レコードのフィールド（関数型）</p>
<h3 id="124">12.4 テスト用スタブの作成<a class="headerlink" href="#124" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">-- テスト用データアクセスの作成</span>
<span class="nf">mkTestDataAccess</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">IO</span><span class="w"> </span><span class="kt">DataAccess</span>
<span class="nf">mkTestDataAccess</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">return</span><span class="w"> </span><span class="kt">DataAccess</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="n">findAttractions</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="nf">\</span><span class="n">name</span><span class="w"> </span><span class="kr">_</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="ow">-&gt;</span>
<span class="w">        </span><span class="n">return</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="n">take</span><span class="w"> </span><span class="n">limit</span>
<span class="w">            </span><span class="p">[</span><span class="w"> </span><span class="kt">Attraction</span>
<span class="w">                </span><span class="p">{</span><span class="w"> </span><span class="n">attrName</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="s">&quot;Test Attraction&quot;</span>
<span class="w">                </span><span class="p">,</span><span class="w"> </span><span class="n">attrDescription</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">Just</span><span class="w"> </span><span class="s">&quot;A test attraction&quot;</span>
<span class="w">                </span><span class="p">,</span><span class="w"> </span><span class="n">attrLocation</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">Location</span><span class="w"> </span><span class="p">(</span><span class="kt">LocationId</span><span class="w"> </span><span class="s">&quot;Q123&quot;</span><span class="p">)</span><span class="w"> </span><span class="s">&quot;Test City&quot;</span><span class="w"> </span><span class="mi">100000</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="o">|</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Test&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="w">            </span><span class="p">]</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">findArtistsFromLocation</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="nf">\</span><span class="kr">_</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="ow">-&gt;</span>
<span class="w">        </span><span class="n">return</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="kt">Right</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="n">take</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="p">[</span><span class="kt">MusicArtist</span><span class="w"> </span><span class="s">&quot;Test Artist&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">findMoviesAboutLocation</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="nf">\</span><span class="kr">_</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="ow">-&gt;</span>
<span class="w">        </span><span class="n">return</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="kt">Right</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="n">take</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="p">[</span><span class="kt">Movie</span><span class="w"> </span><span class="s">&quot;Test Movie&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>

<span class="c1">-- 失敗するデータアクセス（エラーテスト用）</span>
<span class="nf">mkFailingDataAccess</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">IO</span><span class="w"> </span><span class="kt">DataAccess</span>
<span class="nf">mkFailingDataAccess</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">return</span><span class="w"> </span><span class="kt">DataAccess</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="n">findAttractions</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="nf">\</span><span class="kr">_</span><span class="w"> </span><span class="kr">_</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="ow">-&gt;</span>
<span class="w">        </span><span class="n">return</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="n">take</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="p">[</span><span class="n">testAttraction</span><span class="p">]</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">findArtistsFromLocation</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="nf">\</span><span class="kr">_</span><span class="w"> </span><span class="kr">_</span><span class="w"> </span><span class="ow">-&gt;</span>
<span class="w">        </span><span class="n">return</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="kt">Left</span><span class="w"> </span><span class="s">&quot;Network error&quot;</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">findMoviesAboutLocation</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="nf">\</span><span class="kr">_</span><span class="w"> </span><span class="kr">_</span><span class="w"> </span><span class="ow">-&gt;</span>
<span class="w">        </span><span class="n">return</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="kt">Left</span><span class="w"> </span><span class="s">&quot;Timeout&quot;</span>
<span class="w">    </span><span class="p">}</span>
</code></pre></div>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkNMQVNTIiBoZWlnaHQ9IjI0MXB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6Njk4cHg7aGVpZ2h0OjI0MXB4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDY5OCAyNDEiIHdpZHRoPSI2OThweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PGRlZnMvPjxnPjwhLS1jbHVzdGVyID8/Pz8/LS0+PGcgY2xhc3M9ImNsdXN0ZXIiIGRhdGEtZW50aXR5PSIuLi4uLiIgZGF0YS1zb3VyY2UtbGluZT0iMyIgZGF0YS11aWQ9ImVudDAwMDIiIGlkPSJjbHVzdGVyXy4uLi4uIj48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjE2MiIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjY4MCIgeD0iMTIiIHk9IjEyIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjY5Ljk5OTciIHg9IjMxNy4wMDAyIiB5PSIyNi45OTUxIj4mIzEyNDg2OyYjMTI0NzM7JiMxMjQ4ODsmIzI3MDgzOyYjMjUxMDQ7PC90ZXh0PjwvZz48IS0tY2x1c3RlciBwcm9kLS0+PGcgY2xhc3M9ImNsdXN0ZXIiIGRhdGEtZW50aXR5PSJwcm9kIiBkYXRhLXNvdXJjZS1saW5lPSI0IiBkYXRhLXVpZD0iZW50MDAwMyIgaWQ9ImNsdXN0ZXJfcHJvZCI+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgaGVpZ2h0PSI5NSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjIwMiIgeD0iMzYiIHk9IjU1Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI3Ljk5OTkiIHg9IjEyMy4wMDAxIiB5PSI2OS45OTUxIj4mIzI2NDEyOyYjMzAwNTg7PC90ZXh0PjwvZz48IS0tY2x1c3RlciB0ZXN0LS0+PGcgY2xhc3M9ImNsdXN0ZXIiIGRhdGEtZW50aXR5PSJ0ZXN0IiBkYXRhLXNvdXJjZS1saW5lPSI4IiBkYXRhLXVpZD0iZW50MDAwNSIgaWQ9ImNsdXN0ZXJfdGVzdCI+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgaGVpZ2h0PSI5NSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjQwNiIgeD0iMjYyIiB5PSI1NSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0MS45OTk4IiB4PSI0NDQuMDAwMSIgeT0iNjkuOTk1MSI+JiMxMjQ4NjsmIzEyNDczOyYjMTI0ODg7PC90ZXh0PjwvZz48IS0tY2xhc3Mgd2RhLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9IndkYSIgZGF0YS1zb3VyY2UtbGluZT0iNSIgZGF0YS11aWQ9ImVudDAwMDQiIGlkPSJlbnRpdHlfd2RhIj48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjQ0IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iMTcwLjg2NDMiIHg9IjUxLjU3IiB5PSI5MCIvPjxlbGxpcHNlIGN4PSI2NC41NyIgY3k9IjEwNCIgZmlsbD0iI0ZGRkZGRiIgcng9IjkiIHJ5PSI5IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBhdGggZD0iTTY3LjUzODgsMTA5LjY0MDYgUTY2Ljk2MDYsMTA5LjkzNzUgNjYuMzIsMTEwLjA3ODEgUTY1LjY3OTQsMTEwLjIzNDQgNjQuOTc2MywxMTAuMjM0NCBRNjIuNDc2MiwxMTAuMjM0NCA2MS4xNDgxLDEwOC41OTM4IFE1OS44MzU2LDEwNi45Mzc1IDU5LjgzNTYsMTAzLjgxMjUgUTU5LjgzNTYsMTAwLjY4NzUgNjEuMTQ4MSw5OS4wMzEzIFE2Mi40NzYyLDk3LjM3NSA2NC45NzYzLDk3LjM3NSBRNjUuNjc5NCw5Ny4zNzUgNjYuMzIsOTcuNTMxMyBRNjYuOTc2Myw5Ny42ODc1IDY3LjUzODgsOTcuOTg0NCBMNjcuNTM4OCwxMDAuNzAzMSBRNjYuOTEzOCwxMDAuMTI1IDY2LjMyLDk5Ljg1OTQgUTY1LjcyNjMsOTkuNTc4MSA2NS4xMDEzLDk5LjU3ODEgUTYzLjc1NzUsOTkuNTc4MSA2My4wNywxMDAuNjU2MyBRNjIuMzgyNSwxMDEuNzE4OCA2Mi4zODI1LDEwMy44MTI1IFE2Mi4zODI1LDEwNS45MDYzIDYzLjA3LDEwNi45ODQ0IFE2My43NTc1LDEwOC4wNDY5IDY1LjEwMTMsMTA4LjA0NjkgUTY1LjcyNjMsMTA4LjA0NjkgNjYuMzIsMTA3Ljc4MTMgUTY2LjkxMzgsMTA3LjUgNjcuNTM4OCwxMDYuOTIxOSBMNjcuNTM4OCwxMDkuNjQwNiBaICIgZmlsbD0iIzAwMDAwMCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE0Mi44NjQzIiB4PSI3Ni41NyIgeT0iMTA4Ljg0NjciPldpa2lkYXRhRGF0YUFjY2VzczwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iNTIuNTciIHgyPSIyMjEuNDM0MyIgeTE9IjExOCIgeTI9IjExOCIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiIHgxPSI1Mi41NyIgeDI9IjIyMS40MzQzIiB5MT0iMTI2IiB5Mj0iMTI2Ii8+PC9nPjwhLS1jbGFzcyB0ZGEtLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0idGRhIiBkYXRhLXNvdXJjZS1saW5lPSI5IiBkYXRhLXVpZD0iZW50MDAwNiIgaWQ9ImVudGl0eV90ZGEiPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iNDQiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSIxNjEuMjkzOSIgeD0iMjc4LjM1IiB5PSI5MCIvPjxlbGxpcHNlIGN4PSIyOTEuMzUiIGN5PSIxMDQiIGZpbGw9IiNGRkZGRkYiIHJ4PSI5IiByeT0iOSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjxwYXRoIGQ9Ik0yOTQuMzE4OCwxMDkuNjQwNiBRMjkzLjc0MDYsMTA5LjkzNzUgMjkzLjEsMTEwLjA3ODEgUTI5Mi40NTk0LDExMC4yMzQ0IDI5MS43NTYzLDExMC4yMzQ0IFEyODkuMjU2MywxMTAuMjM0NCAyODcuOTI4MSwxMDguNTkzOCBRMjg2LjYxNTYsMTA2LjkzNzUgMjg2LjYxNTYsMTAzLjgxMjUgUTI4Ni42MTU2LDEwMC42ODc1IDI4Ny45MjgxLDk5LjAzMTMgUTI4OS4yNTYzLDk3LjM3NSAyOTEuNzU2Myw5Ny4zNzUgUTI5Mi40NTk0LDk3LjM3NSAyOTMuMSw5Ny41MzEzIFEyOTMuNzU2Myw5Ny42ODc1IDI5NC4zMTg4LDk3Ljk4NDQgTDI5NC4zMTg4LDEwMC43MDMxIFEyOTMuNjkzOCwxMDAuMTI1IDI5My4xLDk5Ljg1OTQgUTI5Mi41MDYzLDk5LjU3ODEgMjkxLjg4MTMsOTkuNTc4MSBRMjkwLjUzNzUsOTkuNTc4MSAyODkuODUsMTAwLjY1NjMgUTI4OS4xNjI1LDEwMS43MTg4IDI4OS4xNjI1LDEwMy44MTI1IFEyODkuMTYyNSwxMDUuOTA2MyAyODkuODUsMTA2Ljk4NDQgUTI5MC41Mzc1LDEwOC4wNDY5IDI5MS44ODEzLDEwOC4wNDY5IFEyOTIuNTA2MywxMDguMDQ2OSAyOTMuMSwxMDcuNzgxMyBRMjkzLjY5MzgsMTA3LjUgMjk0LjMxODgsMTA2LjkyMTkgTDI5NC4zMTg4LDEwOS42NDA2IFogIiBmaWxsPSIjMDAwMDAwIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTMzLjI5MzkiIHg9IjMwMy4zNSIgeT0iMTA4Ljg0NjciPm1rVGVzdERhdGFBY2Nlc3M8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgeDE9IjI3OS4zNSIgeDI9IjQzOC42NDM5IiB5MT0iMTE4IiB5Mj0iMTE4Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgeDE9IjI3OS4zNSIgeDI9IjQzOC42NDM5IiB5MT0iMTI2IiB5Mj0iMTI2Ii8+PC9nPjwhLS1jbGFzcyBmZGEtLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iZmRhIiBkYXRhLXNvdXJjZS1saW5lPSIxMCIgZGF0YS11aWQ9ImVudDAwMDciIGlkPSJlbnRpdHlfZmRhIj48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjQ0IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iMTc3LjQwNjMiIHg9IjQ3NC4zIiB5PSI5MCIvPjxlbGxpcHNlIGN4PSI0ODcuMyIgY3k9IjEwNCIgZmlsbD0iI0ZGRkZGRiIgcng9IjkiIHJ5PSI5IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBhdGggZD0iTTQ5MC4yNjg4LDEwOS42NDA2IFE0ODkuNjkwNiwxMDkuOTM3NSA0ODkuMDUsMTEwLjA3ODEgUTQ4OC40MDk0LDExMC4yMzQ0IDQ4Ny43MDYzLDExMC4yMzQ0IFE0ODUuMjA2MywxMTAuMjM0NCA0ODMuODc4MSwxMDguNTkzOCBRNDgyLjU2NTYsMTA2LjkzNzUgNDgyLjU2NTYsMTAzLjgxMjUgUTQ4Mi41NjU2LDEwMC42ODc1IDQ4My44NzgxLDk5LjAzMTMgUTQ4NS4yMDYzLDk3LjM3NSA0ODcuNzA2Myw5Ny4zNzUgUTQ4OC40MDk0LDk3LjM3NSA0ODkuMDUsOTcuNTMxMyBRNDg5LjcwNjMsOTcuNjg3NSA0OTAuMjY4OCw5Ny45ODQ0IEw0OTAuMjY4OCwxMDAuNzAzMSBRNDg5LjY0MzgsMTAwLjEyNSA0ODkuMDUsOTkuODU5NCBRNDg4LjQ1NjMsOTkuNTc4MSA0ODcuODMxMyw5OS41NzgxIFE0ODYuNDg3NSw5OS41NzgxIDQ4NS44LDEwMC42NTYzIFE0ODUuMTEyNSwxMDEuNzE4OCA0ODUuMTEyNSwxMDMuODEyNSBRNDg1LjExMjUsMTA1LjkwNjMgNDg1LjgsMTA2Ljk4NDQgUTQ4Ni40ODc1LDEwOC4wNDY5IDQ4Ny44MzEzLDEwOC4wNDY5IFE0ODguNDU2MywxMDguMDQ2OSA0ODkuMDUsMTA3Ljc4MTMgUTQ4OS42NDM4LDEwNy41IDQ5MC4yNjg4LDEwNi45MjE5IEw0OTAuMjY4OCwxMDkuNjQwNiBaICIgZmlsbD0iIzAwMDAwMCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE0OS40MDYzIiB4PSI0OTkuMyIgeT0iMTA4Ljg0NjciPm1rRmFpbGluZ0RhdGFBY2Nlc3M8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgeDE9IjQ3NS4zIiB4Mj0iNjUwLjcwNjMiIHkxPSIxMTgiIHkyPSIxMTgiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iNDc1LjMiIHgyPSI2NTAuNzA2MyIgeTE9IjEyNiIgeTI9IjEyNiIvPjwvZz48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iR01OOCIgZGF0YS1zb3VyY2UtbGluZT0iMTUiIGRhdGEtdWlkPSJlbnQwMDA5IiBpZD0iZW50aXR5X0dNTjgiPjxwYXRoIGQ9Ik0yNjUuOCwxOTQgTDI2NS44LDIzNC4yNjU2IEEwLDAgMCAwIDAgMjY1LjgsMjM0LjI2NTYgTDQ0OC4xOTU2LDIzNC4yNjU2IEEwLDAgMCAwIDAgNDQ4LjE5NTYsMjM0LjI2NTYgTDQ0OC4xOTU2LDIwNCBMNDM4LjE5NTYsMTk0IEwzNjEuMzksMTk0IEwzNTguNTgsMTM0LjI0IEwzNTMuMzksMTk0IEwyNjUuOCwxOTQgQTAsMCAwIDAgMCAyNjUuOCwxOTQiIGZpbGw9IiNGRkZGRkYiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48cGF0aCBkPSJNNDM4LjE5NTYsMTk0IEw0MzguMTk1NiwyMDQgTDQ0OC4xOTU2LDIwNCBMNDM4LjE5NTYsMTk0IiBmaWxsPSIjRkZGRkZGIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTE3LjAwMDEiIHg9IjI3MS44IiB5PSIyMTEuMDY2OSI+JiMxMjQ4NjsmIzEyNDczOyYjMTI0ODg7JiMxMjQ4NzsmIzEyNTQwOyYjMTI0Nzk7JiMxMjQzNDsmIzM2ODIwOyYjMTIzNzc7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE2MS4zOTU2IiB4PSIyNzEuOCIgeT0iMjI2LjE5OTciPnJldHVybiAmIzEyMzkxOyYjMjEzNjM7JiMyNDIzMTsmIzEyMzk1OyYjMzIwODA7JiMyNjUyNDsmIzEyNDM0OyYjMzY4MjA7JiMxMjM3Nzs8L3RleHQ+PC9nPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJHTU4xMSIgZGF0YS1zb3VyY2UtbGluZT0iMjAiIGRhdGEtdWlkPSJlbnQwMDEyIiBpZD0iZW50aXR5X0dNTjExIj48cGF0aCBkPSJNNDgzLDE5NCBMNDgzLDIzNC4yNjU2IEEwLDAgMCAwIDAgNDgzLDIzNC4yNjU2IEw2NDcuMDAwMiwyMzQuMjY1NiBBMCwwIDAgMCAwIDY0Ny4wMDAyLDIzNC4yNjU2IEw2NDcuMDAwMiwyMDQgTDYzNy4wMDAyLDE5NCBMNTY4LjYxLDE5NCBMNTYzLjQyLDEzNC4yNCBMNTYwLjYxLDE5NCBMNDgzLDE5NCBBMCwwIDAgMCAwIDQ4MywxOTQiIGZpbGw9IiNGRkZGRkYiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48cGF0aCBkPSJNNjM3LjAwMDIsMTk0IEw2MzcuMDAwMiwyMDQgTDY0Ny4wMDAyLDIwNCBMNjM3LjAwMDIsMTk0IiBmaWxsPSIjRkZGRkZGIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTQzLjAwMDIiIHg9IjQ4OSIgeT0iMjExLjA2NjkiPiYjMTI0NTY7JiMxMjUyMTsmIzEyNTQwOyYjMTI0NjU7JiMxMjU0MDsmIzEyNDczOyYjMTIzOTg7JiMxMjQ4NjsmIzEyNDczOyYjMTI0ODg7JiMyOTk5Mjs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTIwLjA0NyIgeD0iNDg5IiB5PSIyMjYuMTk5NyI+TGVmdCAmIzEyMzkxOyYjMTI0NTY7JiMxMjUyMTsmIzEyNTQwOyYjMTI0MzQ7JiMzNjgyMDsmIzEyMzc3OzwvdGV4dD48L2c+PCEtLVNSQz1bUk94RklpRDA0OFZsVU9lblJvQTg5dS0ydnBNUGo0a0p0UDhUeUkwejkwa3M4NEFIVVgyQXJ6R18yMjhVQWE4VlBjWllPeFpQR3JnWVhuck9WaF92bFpjVzhNTzh1ckg4NUdHdkhZSks4NEs4c0x2cGtNT3hnd2tSVVpPRnVNZV9oUFVscFZycDJDQjBFRFVuMndESzYwRlhjSHA5TTkwdVNreW1ZajBPTnhnQ0hKM3ZkLXpwR2FDeEkzT3dUVnlVV1hvWW91LTVKQUtRejJnOWpwWUZxZUhtaGVicTFaaG5ndnNGeFBKakR2U1JCa3otRFdpazdqblBUOTRodUFCUXRkdmlsb2VrTmZoRlVWc3V0NUxHblQxSV94MVI5dlNoamEtVS1reGRjZWt0SmpXaUxpNDk5akpvenZmenlZeTBdLS0+PC9nPjwvc3ZnPg==" class="uml" alt="uml diagram" title="" /></p>
<h3 id="125-searchreport">12.5 SearchReport の導入<a class="headerlink" href="#125-searchreport" title="Permanent link">&para;</a></h3>
<p>テスト可能性を高めるため、<code>SearchReport</code> を導入します。</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- 検索レポート</span>
<span class="kr">data</span><span class="w"> </span><span class="kt">SearchReport</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">SearchReport</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="n">srAttractionsSearched</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Int</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">srErrors</span><span class="w">              </span><span class="ow">::</span><span class="w"> </span><span class="p">[</span><span class="kt">String</span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="kr">deriving</span><span class="w"> </span><span class="p">(</span><span class="kt">Show</span><span class="p">,</span><span class="w"> </span><span class="kt">Eq</span><span class="p">)</span>

<span class="c1">-- 旅行ガイド（SearchReport 付き）</span>
<span class="kr">data</span><span class="w"> </span><span class="kt">TravelGuide</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">TravelGuide</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="n">tgAttraction</span><span class="w">   </span><span class="ow">::</span><span class="w"> </span><span class="kt">Attraction</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">tgSubjects</span><span class="w">     </span><span class="ow">::</span><span class="w"> </span><span class="p">[</span><span class="kt">String</span><span class="p">]</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">tgSearchReport</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">SearchReport</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="kr">deriving</span><span class="w"> </span><span class="p">(</span><span class="kt">Show</span><span class="p">,</span><span class="w"> </span><span class="kt">Eq</span><span class="p">)</span>
</code></pre></div>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkNMQVNTIiBoZWlnaHQ9IjI0OHB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6Mzg5cHg7aGVpZ2h0OjI0OHB4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDM4OSAyNDgiIHdpZHRoPSIzODlweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PGRlZnMvPjxnPjwhLS1jbGFzcyBUcmF2ZWxHdWlkZS0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJUcmF2ZWxHdWlkZSIgZGF0YS1zb3VyY2UtbGluZT0iMyIgZGF0YS11aWQ9ImVudDAwMDIiIGlkPSJlbnRpdHlfVHJhdmVsR3VpZGUiPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iOTIuODkwNiIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjIyNi40Mjk3IiB4PSIxMiIgeT0iMTIiLz48ZWxsaXBzZSBjeD0iNzkuMDcxOCIgY3k9IjI2IiBmaWxsPSIjRkZGRkZGIiByeD0iOSIgcnk9IjkiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48cGF0aCBkPSJNODIuMDQwNSwzMS42NDA2IFE4MS40NjI0LDMxLjkzNzUgODAuODIxOCwzMi4wNzgxIFE4MC4xODEyLDMyLjIzNDQgNzkuNDc4LDMyLjIzNDQgUTc2Ljk3OCwzMi4yMzQ0IDc1LjY0OTksMzAuNTkzOCBRNzQuMzM3NCwyOC45Mzc1IDc0LjMzNzQsMjUuODEyNSBRNzQuMzM3NCwyMi42ODc1IDc1LjY0OTksMjEuMDMxMyBRNzYuOTc4LDE5LjM3NSA3OS40NzgsMTkuMzc1IFE4MC4xODEyLDE5LjM3NSA4MC44MjE4LDE5LjUzMTMgUTgxLjQ3OCwxOS42ODc1IDgyLjA0MDUsMTkuOTg0NCBMODIuMDQwNSwyMi43MDMxIFE4MS40MTU1LDIyLjEyNSA4MC44MjE4LDIxLjg1OTQgUTgwLjIyOCwyMS41NzgxIDc5LjYwMywyMS41NzgxIFE3OC4yNTkzLDIxLjU3ODEgNzcuNTcxOCwyMi42NTYzIFE3Ni44ODQzLDIzLjcxODggNzYuODg0MywyNS44MTI1IFE3Ni44ODQzLDI3LjkwNjMgNzcuNTcxOCwyOC45ODQ0IFE3OC4yNTkzLDMwLjA0NjkgNzkuNjAzLDMwLjA0NjkgUTgwLjIyOCwzMC4wNDY5IDgwLjgyMTgsMjkuNzgxMyBRODEuNDE1NSwyOS41IDgyLjA0MDUsMjguOTIxOSBMODIuMDQwNSwzMS42NDA2IFogIiBmaWxsPSIjMDAwMDAwIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iODQuNzg2MSIgeD0iOTYuNTcxOCIgeT0iMzAuODQ2NyI+VHJhdmVsR3VpZGU8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgeDE9IjEzIiB4Mj0iMjM3LjQyOTciIHkxPSI0MCIgeTI9IjQwIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTYyLjM1MzUiIHg9IjE4IiB5PSI1Ni45OTUxIj50Z0F0dHJhY3Rpb246IEF0dHJhY3Rpb248L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTM1Ljg3NzkiIHg9IjE4IiB5PSI3My4yOTIiPnRnU3ViamVjdHM6IFtTdHJpbmddPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjIxNC40Mjk3IiB4PSIxOCIgeT0iODkuNTg4OSI+dGdTZWFyY2hSZXBvcnQ6IFNlYXJjaFJlcG9ydDwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTMiIHgyPSIyMzcuNDI5NyIgeTE9Ijk2Ljg5MDYiIHkyPSI5Ni44OTA2Ii8+PC9nPjwhLS1jbGFzcyBTZWFyY2hSZXBvcnQtLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iU2VhcmNoUmVwb3J0IiBkYXRhLXNvdXJjZS1saW5lPSI5IiBkYXRhLXVpZD0iZW50MDAwMyIgaWQ9ImVudGl0eV9TZWFyY2hSZXBvcnQiPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iNzYuNTkzOCIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjE5NS4zMTI1IiB4PSIyNy41NiIgeT0iMTY0Ljg5Ii8+PGVsbGlwc2UgY3g9IjczLjc0NDYiIGN5PSIxNzguODkiIGZpbGw9IiNGRkZGRkYiIHJ4PSI5IiByeT0iOSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjxwYXRoIGQ9Ik03Ni43MTMzLDE4NC41MzA2IFE3Ni4xMzUyLDE4NC44Mjc1IDc1LjQ5NDYsMTg0Ljk2ODEgUTc0Ljg1MzksMTg1LjEyNDQgNzQuMTUwOCwxODUuMTI0NCBRNzEuNjUwOCwxODUuMTI0NCA3MC4zMjI3LDE4My40ODM4IFE2OS4wMTAyLDE4MS44Mjc1IDY5LjAxMDIsMTc4LjcwMjUgUTY5LjAxMDIsMTc1LjU3NzUgNzAuMzIyNywxNzMuOTIxMyBRNzEuNjUwOCwxNzIuMjY1IDc0LjE1MDgsMTcyLjI2NSBRNzQuODUzOSwxNzIuMjY1IDc1LjQ5NDYsMTcyLjQyMTMgUTc2LjE1MDgsMTcyLjU3NzUgNzYuNzEzMywxNzIuODc0NCBMNzYuNzEzMywxNzUuNTkzMSBRNzYuMDg4MywxNzUuMDE1IDc1LjQ5NDYsMTc0Ljc0OTQgUTc0LjkwMDgsMTc0LjQ2ODEgNzQuMjc1OCwxNzQuNDY4MSBRNzIuOTMyMSwxNzQuNDY4MSA3Mi4yNDQ2LDE3NS41NDYzIFE3MS41NTcxLDE3Ni42MDg4IDcxLjU1NzEsMTc4LjcwMjUgUTcxLjU1NzEsMTgwLjc5NjMgNzIuMjQ0NiwxODEuODc0NCBRNzIuOTMyMSwxODIuOTM2OSA3NC4yNzU4LDE4Mi45MzY5IFE3NC45MDA4LDE4Mi45MzY5IDc1LjQ5NDYsMTgyLjY3MTMgUTc2LjA4ODMsMTgyLjM5IDc2LjcxMzMsMTgxLjgxMTkgTDc2LjcxMzMsMTg0LjUzMDYgWiAiIGZpbGw9IiMwMDAwMDAiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5NS40NDM0IiB4PSI5MS4yNDQ2IiB5PSIxODMuNzM2NyI+U2VhcmNoUmVwb3J0PC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiIHgxPSIyOC41NiIgeDI9IjIyMS44NzI1IiB5MT0iMTkyLjg5IiB5Mj0iMTkyLjg5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTgzLjMxMjUiIHg9IjMzLjU2IiB5PSIyMDkuODg1MSI+c3JBdHRyYWN0aW9uc1NlYXJjaGVkOiBJbnQ8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTE2Ljg5NDUiIHg9IjMzLjU2IiB5PSIyMjYuMTgyIj5zckVycm9yczogW1N0cmluZ108L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgeDE9IjI4LjU2IiB4Mj0iMjIxLjg3MjUiIHkxPSIyMzMuNDgzOCIgeTI9IjIzMy40ODM4Ii8+PC9nPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJHTU41IiBkYXRhLXNvdXJjZS1saW5lPSIxNyIgZGF0YS11aWQ9ImVudDAwMDYiIGlkPSJlbnRpdHlfR01ONSI+PHBhdGggZD0iTTI1Ny43MSwxODMuMDUgTDI1Ny43MSwxOTkuMTggTDIyMy4xLDIwMy4xOCBMMjU3LjcxLDIwNy4xOCBMMjU3LjcxLDIyMy4zMTU2IEEwLDAgMCAwIDAgMjU3LjcxLDIyMy4zMTU2IEwzODIuNzEwMSwyMjMuMzE1NiBBMCwwIDAgMCAwIDM4Mi43MTAxLDIyMy4zMTU2IEwzODIuNzEwMSwxOTMuMDUgTDM3Mi43MTAxLDE4My4wNSBMMjU3LjcxLDE4My4wNSBBMCwwIDAgMCAwIDI1Ny43MSwxODMuMDUiIGZpbGw9IiNGRkZGRkYiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48cGF0aCBkPSJNMzcyLjcxMDEsMTgzLjA1IEwzNzIuNzEwMSwxOTMuMDUgTDM4Mi43MTAxLDE5My4wNSBMMzcyLjcxMDEsMTgzLjA1IiBmaWxsPSIjRkZGRkZGIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTA0LjAwMDEiIHg9IjI2My43MSIgeT0iMjAwLjExNjkiPiYjMjY5MDg7JiMzMjAzNDsmIzEyMzk4OyYjMzIxMTM7JiMzNTMzNjsmIzI0NzczOyYjMjI1Nzc7JiMxMjM5Mjs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTA0LjAwMDEiIHg9IjI2My43MSIgeT0iMjE1LjI0OTciPiYjMTI0NTY7JiMxMjUyMTsmIzEyNTQwOyYjMjQ3NzM7JiMyMjU3NzsmIzEyNDM0OyYjMjA0NDU7JiMyNTM0NTs8L3RleHQ+PC9nPjwhLS1saW5rIFRyYXZlbEd1aWRlIHRvIFNlYXJjaFJlcG9ydC0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJUcmF2ZWxHdWlkZSIgZGF0YS1lbnRpdHktMj0iU2VhcmNoUmVwb3J0IiBkYXRhLXNvdXJjZS1saW5lPSIxNCIgZGF0YS11aWQ9ImxuazQiIGlkPSJsaW5rX1RyYXZlbEd1aWRlX1NlYXJjaFJlcG9ydCI+PHBhdGggY29kZUxpbmU9IjE0IiBkPSJNMTI1LjIxLDEwNSBDMTI1LjIxLDEyNC4yNSAxMjUuMjEsMTQwLjQxIDEyNS4yMSwxNTguNjkiIGZpbGw9Im5vbmUiIGlkPSJUcmF2ZWxHdWlkZS10by1TZWFyY2hSZXBvcnQiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMDAwMDAwIiBwb2ludHM9IjEyNS4yMSwxNjQuNjksMTI5LjIxLDE1NS42OSwxMjUuMjEsMTU5LjY5LDEyMS4yMSwxNTUuNjksMTI1LjIxLDE2NC42OSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjwvZz48IS0tU1JDPVtLb3A5SUNyRExJWjhJU3BDdS05QXBhYWlCYk84QUtlaUl5cm5CeXJDSUxNZXZZZjlUb21mQUtmQ0JpZENweERJR0IyMTRpNmJJTGNmb0lONUxXaEhtSUw1Y05kZmlJMzFyQ0lZdjhvV3I4QnllWDhoMU1HVUxvdEMxY0hIZTFONUhHWFpZbzVvZ0liTTJmdnY5SzBmcndBWV8yOWFBdTJjOEJqR0x6U0VySFFrbEZvSUw4TVlwRklDNGVOeUQ1SXZQcWxjRkQtb3c3N1pra1RSRHh2T3FWNmlrVk5mV2VzRjZyVG1GTXZReVJYdnZVRmNGTDJYZmFiRnppenpyakY4YlBnTmVXMG80MDAwXS0tPjwvZz48L3N2Zz4=" class="uml" alt="uml diagram" title="" /></p>
<h3 id="126">12.6 アプリケーションロジック<a class="headerlink" href="#126" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">-- 旅行ガイドを取得（SearchReport 付き）</span>
<span class="nf">travelGuideWithReport</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">DataAccess</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">IO</span><span class="w"> </span><span class="p">(</span><span class="kt">Maybe</span><span class="w"> </span><span class="kt">TravelGuide</span><span class="p">)</span>
<span class="nf">travelGuideWithReport</span><span class="w"> </span><span class="n">da</span><span class="w"> </span><span class="n">attractionName</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kr">do</span>
<span class="w">    </span><span class="n">attractions</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="n">findAttractions</span><span class="w"> </span><span class="n">da</span><span class="w"> </span><span class="n">attractionName</span><span class="w"> </span><span class="kt">AttrByLocationPopulation</span><span class="w"> </span><span class="mi">3</span>
<span class="w">    </span><span class="kr">case</span><span class="w"> </span><span class="n">attractions</span><span class="w"> </span><span class="kr">of</span>
<span class="w">        </span><span class="kt">[]</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="n">return</span><span class="w"> </span><span class="kt">Nothing</span>
<span class="w">        </span><span class="p">(</span><span class="n">attraction</span><span class="kt">:</span><span class="kr">_</span><span class="p">)</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kr">do</span>
<span class="w">            </span><span class="kr">let</span><span class="w"> </span><span class="n">locId&#39;</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">locId</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="n">attrLocation</span><span class="w"> </span><span class="n">attraction</span>
<span class="w">            </span><span class="n">artistsResult</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="n">findArtistsFromLocation</span><span class="w"> </span><span class="n">da</span><span class="w"> </span><span class="n">locId&#39;</span><span class="w"> </span><span class="mi">2</span>
<span class="w">            </span><span class="n">moviesResult</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="n">findMoviesAboutLocation</span><span class="w"> </span><span class="n">da</span><span class="w"> </span><span class="n">locId&#39;</span><span class="w"> </span><span class="mi">2</span>

<span class="w">            </span><span class="kr">let</span><span class="w"> </span><span class="n">errors</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">collectErrors</span><span class="w"> </span><span class="p">[</span><span class="n">artistsResult</span><span class="p">,</span><span class="w"> </span><span class="n">moviesResult</span><span class="p">]</span>
<span class="w">            </span><span class="kr">let</span><span class="w"> </span><span class="n">artists</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="p">(</span><span class="n">const</span><span class="w"> </span><span class="kt">[]</span><span class="p">)</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="n">artistsResult</span>
<span class="w">            </span><span class="kr">let</span><span class="w"> </span><span class="n">movies</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="p">(</span><span class="n">const</span><span class="w"> </span><span class="kt">[]</span><span class="p">)</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="n">moviesResult</span>
<span class="w">            </span><span class="kr">let</span><span class="w"> </span><span class="n">subjects</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">map</span><span class="w"> </span><span class="n">artistName</span><span class="w"> </span><span class="n">artists</span><span class="w"> </span><span class="o">++</span><span class="w"> </span><span class="n">map</span><span class="w"> </span><span class="n">movieName</span><span class="w"> </span><span class="n">movies</span>

<span class="w">            </span><span class="n">return</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="kt">Just</span><span class="w"> </span><span class="kt">TravelGuide</span>
<span class="w">                </span><span class="p">{</span><span class="w"> </span><span class="n">tgAttraction</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">attraction</span>
<span class="w">                </span><span class="p">,</span><span class="w"> </span><span class="n">tgSubjects</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">subjects</span>
<span class="w">                </span><span class="p">,</span><span class="w"> </span><span class="n">tgSearchReport</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">SearchReport</span><span class="w"> </span><span class="p">(</span><span class="n">length</span><span class="w"> </span><span class="n">attractions</span><span class="p">)</span><span class="w"> </span><span class="n">errors</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">  </span><span class="kr">where</span>
<span class="w">    </span><span class="n">collectErrors</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="p">[</span><span class="kt">Either</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="p">[</span><span class="kt">String</span><span class="p">]</span>
<span class="w">    </span><span class="n">collectErrors</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">foldr</span><span class="w"> </span><span class="p">(</span><span class="nf">\</span><span class="n">r</span><span class="w"> </span><span class="n">acc</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="p">(</span><span class="kt">:</span><span class="n">acc</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">const</span><span class="w"> </span><span class="n">acc</span><span class="p">)</span><span class="w"> </span><span class="n">r</span><span class="p">)</span><span class="w"> </span><span class="kt">[]</span>
</code></pre></div>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkRFU0NSSVBUSU9OIiBoZWlnaHQ9IjQ3N3B4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6MzI5cHg7aGVpZ2h0OjQ3N3B4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDMyOSA0NzciIHdpZHRoPSIzMjlweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PGRlZnMvPjxnPjwhLS1jbHVzdGVyIHRyYXZlbEd1aWRlV2l0aFJlcG9ydCA/Py0tPjxnIGNsYXNzPSJjbHVzdGVyIiBkYXRhLWVudGl0eT0idHJhdmVsR3VpZGVXaXRoUmVwb3J0IC4uIiBkYXRhLXNvdXJjZS1saW5lPSIzIiBkYXRhLXVpZD0iZW50MDAwMiIgaWQ9ImNsdXN0ZXJfdHJhdmVsR3VpZGVXaXRoUmVwb3J0IC4uIj48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjM3MS4xOCIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjMxMSIgeD0iMTIiIHk9IjEyIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjIxNS41MjMzIiB4PSI1OS43MzgzIiB5PSIyNi45OTUxIj50cmF2ZWxHdWlkZVdpdGhSZXBvcnQgJiMzODMwNjsmIzI1OTY4OzwvdGV4dD48L2c+PCEtLWVudGl0eSBzdGVwMS0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJzdGVwMSIgZGF0YS1zb3VyY2UtbGluZT0iNCIgZGF0YS11aWQ9ImVudDAwMDMiIGlkPSJlbnRpdHlfc3RlcDEiPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iMjIuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjE2My44MDcxIiB4PSI3Ny4xIiB5PSI0NyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE0My44MDcxIiB4PSI4Ny4xIiB5PSI2Mi45OTUxIj4xLiAmIzEyNDUwOyYjMTI0ODg7JiMxMjUyMTsmIzEyNDYzOyYjMTI0NzE7JiMxMjUxOTsmIzEyNTMxOyYjMjY5MDg7JiMzMjAzNDs8L3RleHQ+PC9nPjwhLS1lbnRpdHkgc3RlcDItLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0ic3RlcDIiIGRhdGEtc291cmNlLWxpbmU9IjUiIGRhdGEtdWlkPSJlbnQwMDA0IiBpZD0iZW50aXR5X3N0ZXAyIj48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjIyLjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSIxNDkuODA3MSIgeD0iMjguMSIgeT0iMTQ2LjI5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTI5LjgwNzEiIHg9IjM4LjEiIHk9IjE2Mi4yODUxIj4yLiAmIzEyNDUwOyYjMTI1NDA7JiMxMjQ4NjsmIzEyNDUxOyYjMTI0NzM7JiMxMjQ4ODsmIzI2OTA4OyYjMzIwMzQ7PC90ZXh0PjwvZz48IS0tZW50aXR5IHN0ZXAzLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9InN0ZXAzIiBkYXRhLXNvdXJjZS1saW5lPSI2IiBkYXRhLXVpZD0iZW50MDAwNSIgaWQ9ImVudGl0eV9zdGVwMyI+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgaGVpZ2h0PSIyMi4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iOTMuODA3NCIgeD0iMjEzLjEiIHk9IjE0Ni4yOSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjczLjgwNzQiIHg9IjIyMy4xIiB5PSIxNjIuMjg1MSI+My4gJiMyNjE0NDsmIzMwMDExOyYjMjY5MDg7JiMzMjAzNDs8L3RleHQ+PC9nPjwhLS1lbnRpdHkgc3RlcDQtLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0ic3RlcDQiIGRhdGEtc291cmNlLWxpbmU9IjciIGRhdGEtdWlkPSJlbnQwMDA2IiBpZD0iZW50aXR5X3N0ZXA0Ij48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjIyLjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSIxMDcuODA3MyIgeD0iMTEzLjEiIHk9IjI0NS41OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijg3LjgwNzMiIHg9IjEyMy4xIiB5PSIyNjEuNTg1MSI+NC4gJiMxMjQ1NjsmIzEyNTIxOyYjMTI1NDA7JiMyMTQ1NDsmIzM4NTk4OzwvdGV4dD48L2c+PCEtLWVudGl0eSBzdGVwNS0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJzdGVwNSIgZGF0YS1zb3VyY2UtbGluZT0iOCIgZGF0YS11aWQ9ImVudDAwMDciIGlkPSJlbnRpdHlfc3RlcDUiPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iMjIuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjE4My4wNDM3IiB4PSI3NS40OCIgeT0iMzQ0Ljg5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTYzLjA0MzciIHg9Ijg1LjQ4IiB5PSIzNjAuODg1MSI+NS4gVHJhdmVsR3VpZGUgJiMzMjA2ODsmIzEyNDE1OyYjMzE0MzU7JiMxMjM5MDs8L3RleHQ+PC9nPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJHTU4xMyIgZGF0YS1zb3VyY2UtbGluZT0iMTgiIGRhdGEtdWlkPSJlbnQwMDE0IiBpZD0iZW50aXR5X0dNTjEzIj48cGF0aCBkPSJNMTA2LjMzLDQzMC4xOCBMMTA2LjMzLDQ3MC40NDU2IEEwLDAgMCAwIDAgMTA2LjMzLDQ3MC40NDU2IEwyMjcuNjYxMSw0NzAuNDQ1NiBBMCwwIDAgMCAwIDIyNy42NjExLDQ3MC40NDU2IEwyMjcuNjYxMSw0NDAuMTggTDIxNy42NjExLDQzMC4xOCBMMTcxLDQzMC4xOCBMMTY3LDM2Ny42MiBMMTYzLDQzMC4xOCBMMTA2LjMzLDQzMC4xOCBBMCwwIDAgMCAwIDEwNi4zMyw0MzAuMTgiIGZpbGw9IiNGRkZGRkYiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48cGF0aCBkPSJNMjE3LjY2MTEsNDMwLjE4IEwyMTcuNjYxMSw0NDAuMTggTDIyNy42NjExLDQ0MC4xOCBMMjE3LjY2MTEsNDMwLjE4IiBmaWxsPSIjRkZGRkZGIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNTkuMzM3OSIgeD0iMTEyLjMzIiB5PSI0NDcuMjQ2OSI+ZG8gJiMzNTM1MjsmIzI3ODYxOyYjMTIzOTE7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEwMC4zMzExIiB4PSIxMTIuMzMiIHk9IjQ2Mi4zNzk3Ij4mIzM1MDc5OyYjMjU5Njg7JiMxMjM5ODsgSU8gJiMxMjQzNDsmIzIxNTEyOyYjMjUxMDQ7PC90ZXh0PjwvZz48IS0tbGluayBzdGVwMSB0byBzdGVwMi0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJzdGVwMSIgZGF0YS1lbnRpdHktMj0ic3RlcDIiIGRhdGEtc291cmNlLWxpbmU9IjEwIiBkYXRhLXVpZD0ibG5rOCIgaWQ9Imxpbmtfc3RlcDFfc3RlcDIiPjxwYXRoIGQ9Ik0xNDYuOSw2OS42OSBDMTM4Ljg4LDc3LjI0IDEyOC42NCw4OC4wMyAxMjIsOTkuMjkgQzExMy4wOCwxMTQuNDIgMTA4Ljk4NjMsMTI4LjQ1MzkgMTA2LjMzNjMsMTQwLjMzMzkiIGZpbGw9Im5vbmUiIGlkPSJzdGVwMS10by1zdGVwMiIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMwMDAwMDAiIHBvaW50cz0iMTA1LjAzLDE0Ni4xOSwxMTAuODkzNSwxMzguMjc2NywxMDYuMTE4NiwxNDEuMzA5OSwxMDMuMDg1NCwxMzYuNTM1LDEwNS4wMywxNDYuMTkiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2My41MjEiIHg9IjEyMyIgeT0iMTEyLjM1NjkiPmF0dHJhY3Rpb248L3RleHQ+PC9nPjwhLS1saW5rIHN0ZXAxIHRvIHN0ZXAzLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9InN0ZXAxIiBkYXRhLWVudGl0eS0yPSJzdGVwMyIgZGF0YS1zb3VyY2UtbGluZT0iMTEiIGRhdGEtdWlkPSJsbms5IiBpZD0ibGlua19zdGVwMV9zdGVwMyI+PHBhdGggZD0iTTE2OS44MSw2OS41NiBDMTg5LjE1LDg4LjE5IDIyNS4xMzk0LDEyMi44NTY3IDI0NC42Mzk0LDE0MS42NDY3IiBmaWxsPSJub25lIiBpZD0ic3RlcDEtdG8tc3RlcDMiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMDAwMDAwIiBwb2ludHM9IjI0OC45NiwxNDUuODEsMjQ1LjI1NDcsMTM2LjY4NDcsMjQ1LjM1OTUsMTQyLjM0MDYsMjM5LjcwMzYsMTQyLjQ0NTUsMjQ4Ljk2LDE0NS44MSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjY3LjU3NzEiIHg9IjIxNi41NSIgeT0iMTEyLjM1NjkiPmxvY2F0aW9uLmlkPC90ZXh0PjwvZz48IS0tbGluayBzdGVwMiB0byBzdGVwNC0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJzdGVwMiIgZGF0YS1lbnRpdHktMj0ic3RlcDQiIGRhdGEtc291cmNlLWxpbmU9IjEyIiBkYXRhLXVpZD0ibG5rMTAiIGlkPSJsaW5rX3N0ZXAyX3N0ZXA0Ij48cGF0aCBkPSJNMTA5Ljg1LDE2OC44NSBDMTIyLjEsMTg3LjQ4IDE0NC4zNTI2LDIyMS4zMDczIDE1Ni43MTI2LDI0MC4wOTczIiBmaWxsPSJub25lIiBpZD0ic3RlcDItdG8tc3RlcDQiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMDAwMDAwIiBwb2ludHM9IjE2MC4wMSwyNDUuMTEsMTU4LjQwNTgsMjM1LjM5MjcsMTU3LjI2MjIsMjQwLjkzMjcsMTUxLjcyMjEsMjM5Ljc4OTEsMTYwLjAxLDI0NS4xMSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjM4LjUwNDkiIHg9IjEzOS44MyIgeT0iMjExLjY1NjkiPkVpdGhlcjwvdGV4dD48L2c+PCEtLWxpbmsgc3RlcDMgdG8gc3RlcDQtLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0ic3RlcDMiIGRhdGEtZW50aXR5LTI9InN0ZXA0IiBkYXRhLXNvdXJjZS1saW5lPSIxMyIgZGF0YS11aWQ9ImxuazExIiBpZD0ibGlua19zdGVwM19zdGVwNCI+PHBhdGggZD0iTTI1MC4wNSwxNjguODUgQzIzMi4yNCwxODcuNDggMTk5LjI2NTgsMjIxLjk4MjYgMTgxLjMwNTgsMjQwLjc3MjYiIGZpbGw9Im5vbmUiIGlkPSJzdGVwMy10by1zdGVwNCIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMwMDAwMDAiIHBvaW50cz0iMTc3LjE2LDI0NS4xMSwxODYuMjcwMiwyNDEuMzY3OCwxODAuNjE0OCwyNDEuNDk1NSwxODAuNDg3MSwyMzUuODQwMSwxNzcuMTYsMjQ1LjExIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMzguNTA0OSIgeD0iMjIwLjA3IiB5PSIyMTEuNjU2OSI+RWl0aGVyPC90ZXh0PjwvZz48IS0tbGluayBzdGVwNCB0byBzdGVwNS0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJzdGVwNCIgZGF0YS1lbnRpdHktMj0ic3RlcDUiIGRhdGEtc291cmNlLWxpbmU9IjE0IiBkYXRhLXVpZD0ibG5rMTIiIGlkPSJsaW5rX3N0ZXA0X3N0ZXA1Ij48cGF0aCBkPSJNMTY3LDI2OC4xNSBDMTY3LDI4Ni43OCAxNjcsMzE5LjYyIDE2NywzMzguNCIgZmlsbD0ibm9uZSIgaWQ9InN0ZXA0LXRvLXN0ZXA1IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzAwMDAwMCIgcG9pbnRzPSIxNjcsMzQ0LjQsMTcxLDMzNS40LDE2NywzMzkuNCwxNjMsMzM1LjQsMTY3LDM0NC40IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMzguNzU4OCIgeD0iMTY4IiB5PSIzMTAuOTU2OSI+ZXJyb3JzPC90ZXh0PjwvZz48IS0tU1JDPVtUUDMxSWlEMDQ4Umx5bkhaeFdzcUpJeVVsOGJ1NGFKbWwyUUIzUUpQaTVzelk4U2FLV2syNWg1SXE4RktPYmk0NVFnOE1GMVhYWVJqTXhZbmlLQjF5X1Z6Q19GRllnaG82aVYwT3d1RjhCY2pjQl9sU0pJS1A4VlNzcFhtN1J4aGdrZXMzdUhLRUJsazlrcU4wdV8wUGo5MWVzV1lITHNBY25HRkFOZ2N3OXRZRmlNWmY3VVJsZE9EUDdNaUFudUtTeHNLd3NFQTZuSlRLX0lYZXFqa0FOVkI5WVFUa19KZ1N1Y05Tc3ZiaW1SUHRkV3lrSllWdEpHTVlmS2g1SER0X2NmVy1kUDJ1TFZ3VTRSWG15QWowRm5TWThOMnNkbV9oWTlKa2h3ak5FNGxtUkE2ZGgxUFhhcE5XTmRXYnJnUWhramRTR2JwLUh6V0JLMTUwb3diYTdLdTFsMjV1aFdkYjE4clMwSEUxdnJhckFRbTN6RlVnTnV4WEstdWtRTFJOcXZRcFFKUDBrdXhjNk0tMEcwMF0tLT48L2c+PC9zdmc+" class="uml" alt="uml diagram" title="" /></p>
<h3 id="127">12.7 キャッシュの実装<a class="headerlink" href="#127" title="Permanent link">&para;</a></h3>
<p><code>IORef</code> を使用したスレッドセーフなキャッシュの実装:</p>
<div class="highlight"><pre><span></span><code><span class="kr">import</span><span class="w"> </span><span class="nn">Data.IORef</span>
<span class="kr">import</span><span class="w"> </span><span class="nn">Data.Map.Strict</span><span class="w"> </span><span class="p">(</span><span class="kt">Map</span><span class="p">)</span>
<span class="kr">import</span><span class="w"> </span><span class="k">qualified</span><span class="w"> </span><span class="nn">Data.Map.Strict</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">Map</span>

<span class="c1">-- キャッシュ付きデータアクセス</span>
<span class="kr">type</span><span class="w"> </span><span class="kt">CachedDataAccess</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="p">(</span><span class="kt">DataAccess</span><span class="p">,</span><span class="w"> </span><span class="kt">IORef</span><span class="w"> </span><span class="p">(</span><span class="kt">Map</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="p">[</span><span class="kt">Attraction</span><span class="p">]))</span>

<span class="c1">-- キャッシュ付きデータアクセスの作成</span>
<span class="nf">mkCachedDataAccess</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">DataAccess</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">IO</span><span class="w"> </span><span class="kt">CachedDataAccess</span>
<span class="nf">mkCachedDataAccess</span><span class="w"> </span><span class="n">da</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kr">do</span>
<span class="w">    </span><span class="n">cache</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="n">newIORef</span><span class="w"> </span><span class="kt">Map</span><span class="o">.</span><span class="n">empty</span>
<span class="w">    </span><span class="n">return</span><span class="w"> </span><span class="p">(</span><span class="n">da</span><span class="p">,</span><span class="w"> </span><span class="n">cache</span><span class="p">)</span>

<span class="c1">-- キャッシュ付きアトラクション検索</span>
<span class="nf">cachedFindAttractions</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">CachedDataAccess</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">AttractionOrdering</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">IO</span><span class="w"> </span><span class="p">[</span><span class="kt">Attraction</span><span class="p">]</span>
<span class="nf">cachedFindAttractions</span><span class="w"> </span><span class="p">(</span><span class="n">da</span><span class="p">,</span><span class="w"> </span><span class="n">cache</span><span class="p">)</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">ordering</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kr">do</span>
<span class="w">    </span><span class="kr">let</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">++</span><span class="w"> </span><span class="s">&quot;-&quot;</span><span class="w"> </span><span class="o">++</span><span class="w"> </span><span class="n">show</span><span class="w"> </span><span class="n">ordering</span><span class="w"> </span><span class="o">++</span><span class="w"> </span><span class="s">&quot;-&quot;</span><span class="w"> </span><span class="o">++</span><span class="w"> </span><span class="n">show</span><span class="w"> </span><span class="n">limit</span>
<span class="w">    </span><span class="n">cached</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="kt">Map</span><span class="o">.</span><span class="n">lookup</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">&lt;$&gt;</span><span class="w"> </span><span class="n">readIORef</span><span class="w"> </span><span class="n">cache</span>
<span class="w">    </span><span class="kr">case</span><span class="w"> </span><span class="n">cached</span><span class="w"> </span><span class="kr">of</span>
<span class="w">        </span><span class="kt">Just</span><span class="w"> </span><span class="n">attractions</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="n">return</span><span class="w"> </span><span class="n">attractions</span><span class="w">  </span><span class="c1">-- キャッシュヒット</span>
<span class="w">        </span><span class="kt">Nothing</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kr">do</span>
<span class="w">            </span><span class="n">attractions</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="n">findAttractions</span><span class="w"> </span><span class="n">da</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">ordering</span><span class="w"> </span><span class="n">limit</span>
<span class="w">            </span><span class="n">atomicModifyIORef&#39;</span><span class="w"> </span><span class="n">cache</span><span class="w"> </span><span class="p">(</span><span class="nf">\</span><span class="n">m</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="kt">Map</span><span class="o">.</span><span class="n">insert</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">attractions</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="nb">()</span><span class="p">))</span>
<span class="w">            </span><span class="n">return</span><span class="w"> </span><span class="n">attractions</span>
</code></pre></div>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkFDVElWSVRZIiBoZWlnaHQ9IjQxNnB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6NDMzcHg7aGVpZ2h0OjQxNnB4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDQzMyA0MTYiIHdpZHRoPSI0MzNweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PGRlZnMvPjxnPjxlbGxpcHNlIGN4PSIxOTguMjYwMyIgY3k9IjE1IiBmaWxsPSIjRkZGRkZGIiByeD0iMTAiIHJ5PSIxMCIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iMzMuOTY4OCIgcng9IjEyLjUiIHJ5PSIxMi41IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iMTI4LjAwMDgiIHg9IjEzNC4yNTk5IiB5PSI0NSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEwOC4wMDA4IiB4PSIxNDQuMjU5OSIgeT0iNjYuMTM4NyI+JiMxMjQ2MTsmIzEyNTE1OyYjMTI0ODM7JiMxMjQ3MTsmIzEyNTE3OyYjMTI0NjE7JiMxMjU0MDsmIzI5OTgzOyYjMjUxMDQ7PC90ZXh0PjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iMzMuOTY4OCIgcng9IjEyLjUiIHJ5PSIxMi41IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iMTgwLjAzMiIgeD0iMTA4LjI0NDMiIHk9Ijk4Ljk2ODgiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNjAuMDMyIiB4PSIxMTguMjQ0MyIgeT0iMTIwLjEwNzQiPnJlYWRJT1JlZiAmIzEyMzkxOyYjMTI0NjE7JiMxMjUxNTsmIzEyNDgzOyYjMTI0NzE7JiMxMjUxNzsmIzMwOTA2OyYjMzU0Njk7PC90ZXh0Pjxwb2x5Z29uIGZpbGw9IiNGRkZGRkYiIHBvaW50cz0iMTM0Ljg0MTUsMTUyLjkzNzUsMjYxLjY3OTEsMTUyLjkzNzUsMjczLjY3OTEsMTY0LjkzNzUsMjYxLjY3OTEsMTc2LjkzNzUsMTM0Ljg0MTUsMTc2LjkzNzUsMTIyLjg0MTUsMTY0LjkzNzUsMTM0Ljg0MTUsMTUyLjkzNzUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxMSIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMjYuODM3NSIgeD0iMTM0Ljg0MTUiIHk9IjE2OC43NDU2Ij4mIzEyNDYxOyYjMTI1MTU7JiMxMjQ4MzsmIzEyNDcxOyYjMTI1MTc7JiMxMjM5NTsmIzEyNDg3OyYjMTI1NDA7JiMxMjQ3OTsmIzEyMzU0OyYjMTI0MjY7PzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxMSIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxOS4wMDgzIiB4PSIxMDMuODMzMiIgeT0iMTYyLjM0MzMiPnllczwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxMSIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMy43MDE3IiB4PSIyNzMuNjc5MSIgeT0iMTYyLjM0MzMiPm5vPC90ZXh0PjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iMzMuOTY4OCIgcng9IjEyLjUiIHJ5PSIxMi41IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iMTY0LjAwMTEiIHg9IjYiIHk9IjE4Ni45Mzc1Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTQ0LjAwMTEiIHg9IjE2IiB5PSIyMDguMDc2MiI+JiMxMjQ2MTsmIzEyNTE1OyYjMTI0ODM7JiMxMjQ3MTsmIzEyNTE3OyYjMTIzNjM7JiMxMjQyNTsmIzEyNDg3OyYjMTI1NDA7JiMxMjQ3OTsmIzM2ODIwOyYjMjEzNjQ7PC90ZXh0PjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iMzMuOTY4OCIgcng9IjEyLjUiIHJ5PSIxMi41IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iMTMwLjYxMzkiIHg9IjI0My4yMTMxIiB5PSIxODYuOTM3NSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjExMC42MTM5IiB4PSIyNTMuMjEzMSIgeT0iMjA4LjA3NjIiPiYjMjI4MDY7JiMzNzA5NjsgQVBJICYjMTI0MzQ7JiMyMTYyODsmIzEyNDAzOyYjMjA5ODY7JiMxMjM3NTs8L3RleHQ+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgaGVpZ2h0PSIzMy45Njg4IiByeD0iMTIuNSIgcnk9IjEyLjUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSIyMzcuMDM3OCIgeD0iMTkwLjAwMTEiIHk9IjI0MC45MDYzIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjE3LjAzNzgiIHg9IjIwMC4wMDExIiB5PSIyNjIuMDQ0OSI+YXRvbWljTW9kaWZ5SU9SZWYnICYjMTIzOTE7JiMxMjQ2MTsmIzEyNTE1OyYjMTI0ODM7JiMxMjQ3MTsmIzEyNTE3OyYjMjA0NDU7JiMyMzM4NDs8L3RleHQ+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgaGVpZ2h0PSIzMy45Njg4IiByeD0iMTIuNSIgcnk9IjEyLjUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSI4MC4wMDA1IiB4PSIyNjguNTE5OCIgeT0iMjk0Ljg3NSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjYwLjAwMDUiIHg9IjI3OC41MTk4IiB5PSIzMTYuMDEzNyI+JiMzMjA4MDsmIzI2NTI0OyYjMTI0MzQ7JiMzNjgyMDsmIzIxMzY0OzwvdGV4dD48cG9seWdvbiBmaWxsPSIjRkZGRkZGIiBwb2ludHM9IjE5OC4yNjAzLDMzNC44NDM4LDIxMC4yNjAzLDM0Ni44NDM4LDE5OC4yNjAzLDM1OC44NDM4LDE4Ni4yNjAzLDM0Ni44NDM4LDE5OC4yNjAzLDMzNC44NDM4IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBhdGggZD0iTTIyOS4yNjAzLDM2OS43MTA5IEwyMjkuMjYwMywzODUuODQzOCBMMjA5LjI2MDMsMzg5Ljg0MzggTDIyOS4yNjAzLDM5My44NDM4IEwyMjkuMjYwMyw0MDkuOTc2NiBBMCwwIDAgMCAwIDIyOS4yNjAzLDQwOS45NzY2IEw0MTkuMjYwNSw0MDkuOTc2NiBBMCwwIDAgMCAwIDQxOS4yNjA1LDQwOS45NzY2IEw0MTkuMjYwNSwzNzkuNzEwOSBMNDA5LjI2MDUsMzY5LjcxMDkgTDIyOS4yNjAzLDM2OS43MTA5IEEwLDAgMCAwIDAgMjI5LjI2MDMsMzY5LjcxMDkiIGZpbGw9IiNGRkZGRkYiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48cGF0aCBkPSJNNDA5LjI2MDUsMzY5LjcxMDkgTDQwOS4yNjA1LDM3OS43MTA5IEw0MTkuMjYwNSwzNzkuNzEwOSBMNDA5LjI2MDUsMzY5LjcxMDkiIGZpbGw9IiNGRkZGRkYiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDQuODA2MiIgeD0iMjM1LjI2MDMiIHk9IjM4Ni43Nzc4Ij5JT1JlZiAmIzEyNDM0OyYjMjAzNTE7JiMyOTk5MjsmIzEyMzc1OyYjMTIzODM7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE2OS4wMDAyIiB4PSIyMzUuMjYwMyIgeT0iNDAxLjkxMDYiPiYjMTI0NzM7JiMxMjUyNDsmIzEyNDgzOyYjMTI0ODk7JiMxMjQ3NTsmIzEyNTQwOyYjMTI1MDE7JiMxMjM5NDsmIzEyNDYxOyYjMTI1MTU7JiMxMjQ4MzsmIzEyNDcxOyYjMTI1MTc7PC90ZXh0PjxlbGxpcHNlIGN4PSIxOTguMjYwMyIgY3k9IjM4OS44NDM4IiBmaWxsPSJub25lIiByeD0iMTEiIHJ5PSIxMSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjxlbGxpcHNlIGN4PSIxOTguMjYwMyIgY3k9IjM4OS44NDM4IiBmaWxsPSIjRkZGRkZGIiByeD0iNiIgcnk9IjYiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTk4LjI2MDMiIHgyPSIxOTguMjYwMyIgeTE9IjI1IiB5Mj0iNDUiLz48cG9seWdvbiBmaWxsPSIjMDAwMDAwIiBwb2ludHM9IjE5NC4yNjAzLDM1LDE5OC4yNjAzLDQ1LDIwMi4yNjAzLDM1LDE5OC4yNjAzLDM5IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgeDE9IjE5OC4yNjAzIiB4Mj0iMTk4LjI2MDMiIHkxPSI3OC45Njg4IiB5Mj0iOTguOTY4OCIvPjxwb2x5Z29uIGZpbGw9IiMwMDAwMDAiIHBvaW50cz0iMTk0LjI2MDMsODguOTY4OCwxOTguMjYwMyw5OC45Njg4LDIwMi4yNjAzLDg4Ljk2ODgsMTk4LjI2MDMsOTIuOTY4OCIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiIHgxPSIzMDguNTIiIHgyPSIzMDguNTIiIHkxPSIyMjAuOTA2MyIgeTI9IjI0MC45MDYzIi8+PHBvbHlnb24gZmlsbD0iIzAwMDAwMCIgcG9pbnRzPSIzMDQuNTIsMjMwLjkwNjMsMzA4LjUyLDI0MC45MDYzLDMxMi41MiwyMzAuOTA2MywzMDguNTIsMjM0LjkwNjMiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMzA4LjUyIiB4Mj0iMzA4LjUyIiB5MT0iMjc0Ljg3NSIgeTI9IjI5NC44NzUiLz48cG9seWdvbiBmaWxsPSIjMDAwMDAwIiBwb2ludHM9IjMwNC41MiwyODQuODc1LDMwOC41MiwyOTQuODc1LDMxMi41MiwyODQuODc1LDMwOC41MiwyODguODc1IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgeDE9IjEyMi44NDE1IiB4Mj0iODguMDAwNSIgeTE9IjE2NC45Mzc1IiB5Mj0iMTY0LjkzNzUiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iODguMDAwNSIgeDI9Ijg4LjAwMDUiIHkxPSIxNjQuOTM3NSIgeTI9IjE4Ni45Mzc1Ii8+PHBvbHlnb24gZmlsbD0iIzAwMDAwMCIgcG9pbnRzPSI4NC4wMDA1LDE3Ni45Mzc1LDg4LjAwMDUsMTg2LjkzNzUsOTIuMDAwNSwxNzYuOTM3NSw4OC4wMDA1LDE4MC45Mzc1IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgeDE9IjI3My42NzkxIiB4Mj0iMzA4LjUyIiB5MT0iMTY0LjkzNzUiIHkyPSIxNjQuOTM3NSIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiIHgxPSIzMDguNTIiIHgyPSIzMDguNTIiIHkxPSIxNjQuOTM3NSIgeTI9IjE4Ni45Mzc1Ii8+PHBvbHlnb24gZmlsbD0iIzAwMDAwMCIgcG9pbnRzPSIzMDQuNTIsMTc2LjkzNzUsMzA4LjUyLDE4Ni45Mzc1LDMxMi41MiwxNzYuOTM3NSwzMDguNTIsMTgwLjkzNzUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iODguMDAwNSIgeDI9Ijg4LjAwMDUiIHkxPSIyMjAuOTA2MyIgeTI9IjM0Ni44NDM4Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgeDE9Ijg4LjAwMDUiIHgyPSIxODYuMjYwMyIgeTE9IjM0Ni44NDM4IiB5Mj0iMzQ2Ljg0MzgiLz48cG9seWdvbiBmaWxsPSIjMDAwMDAwIiBwb2ludHM9IjE3Ni4yNjAzLDM0Mi44NDM4LDE4Ni4yNjAzLDM0Ni44NDM4LDE3Ni4yNjAzLDM1MC44NDM4LDE4MC4yNjAzLDM0Ni44NDM4IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgeDE9IjMwOC41MiIgeDI9IjMwOC41MiIgeTE9IjMyOC44NDM4IiB5Mj0iMzQ2Ljg0MzgiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMzA4LjUyIiB4Mj0iMjEwLjI2MDMiIHkxPSIzNDYuODQzOCIgeTI9IjM0Ni44NDM4Ii8+PHBvbHlnb24gZmlsbD0iIzAwMDAwMCIgcG9pbnRzPSIyMjAuMjYwMywzNDIuODQzOCwyMTAuMjYwMywzNDYuODQzOCwyMjAuMjYwMywzNTAuODQzOCwyMTYuMjYwMywzNDYuODQzOCIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiIHgxPSIxOTguMjYwMyIgeDI9IjE5OC4yNjAzIiB5MT0iMTMyLjkzNzUiIHkyPSIxNTIuOTM3NSIvPjxwb2x5Z29uIGZpbGw9IiMwMDAwMDAiIHBvaW50cz0iMTk0LjI2MDMsMTQyLjkzNzUsMTk4LjI2MDMsMTUyLjkzNzUsMjAyLjI2MDMsMTQyLjkzNzUsMTk4LjI2MDMsMTQ2LjkzNzUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTk4LjI2MDMiIHgyPSIxOTguMjYwMyIgeTE9IjM1OC44NDM4IiB5Mj0iMzc4Ljg0MzgiLz48cG9seWdvbiBmaWxsPSIjMDAwMDAwIiBwb2ludHM9IjE5NC4yNjAzLDM2OC44NDM4LDE5OC4yNjAzLDM3OC44NDM4LDIwMi4yNjAzLDM2OC44NDM4LDE5OC4yNjAzLDM3Mi44NDM4IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PCEtLVNSQz1bUlAzREpXOG41OE50Vk9ndzRidjE1YVBTaUowUUR3dVJmYTMzcTk5RURJNzZIVGk1ZVk1MVdaeUJiU0lWSTUxTVFlbzhjT1V2MzhEbE9HU0QydEh2VXlfdnBoYlRLWUxRZVJaZzR5UEhLNlF5SVlJZk85OU5SOC1mNmp2N01QOGw1d05PdlR3d3k4TjRFb01jQUNlQXdMN3Z5dkJyZEdHVDgxR2U4WEwyQXMwNk82XzFNWjFsT0V6ZHVvWmtUMlU3aE9uUklxZ3l0RU9zQk0zRzNtbFEtNk91eEpVVFlYTG1RZjZaN3k3TTdHZkMyRGcwRUxmRE96VVZ1cklEMWtjX2tWZU9KNkRrY09RVGdGY0lHVEdGQTR2bnVHcEh0VGNOeFU2cmhIbTZxdXZFSGcyVmVfZUd6N2E2aEgwYkFZb184Sm5NZ0N0Z0JsX0pUbm5VSE9DQmZ1dlZNdkZoSXFVUG50MWRKRnY0TDE3WUdiNGlNUjZhcUVfYmZadC0zRURFcHNNMXhZOG14czJWNGdualdGYjg2ampKcUZzNWs4SUE0eld0XS0tPjwvZz48L3N2Zz4=" class="uml" alt="uml diagram" title="" /></p>
<h3 id="128-bracket">12.8 リソース管理（bracket）<a class="headerlink" href="#128-bracket" title="Permanent link">&para;</a></h3>
<p>Haskell の <code>bracket</code> を使用して、安全なリソース管理を実現します。</p>
<div class="highlight"><pre><span></span><code><span class="kr">import</span><span class="w"> </span><span class="nn">Control.Exception</span><span class="w"> </span><span class="p">(</span><span class="nf">bracket</span><span class="p">)</span>
<span class="kr">import</span><span class="w"> </span><span class="nn">System.IO</span><span class="w"> </span><span class="p">(</span><span class="kt">Handle</span><span class="p">,</span><span class="w"> </span><span class="nf">openFile</span><span class="p">,</span><span class="w"> </span><span class="nf">hClose</span><span class="p">,</span><span class="w"> </span><span class="nf">hGetContents</span><span class="p">,</span><span class="w"> </span><span class="kt">IOMode</span><span class="p">(</span><span class="o">..</span><span class="p">))</span>

<span class="c1">-- リソースを安全に使用</span>
<span class="nf">withResource</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">IO</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">IO</span><span class="w"> </span><span class="nb">()</span><span class="p">)</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">IO</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">IO</span><span class="w"> </span><span class="n">b</span>
<span class="nf">withResource</span><span class="w"> </span><span class="n">acquire</span><span class="w"> </span><span class="n">release</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">bracket</span><span class="w"> </span><span class="n">acquire</span><span class="w"> </span><span class="n">release</span>

<span class="c1">-- ファイルを安全に開く</span>
<span class="nf">withFile&#39;</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">FilePath</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">IOMode</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="kt">Handle</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">IO</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">IO</span><span class="w"> </span><span class="n">a</span>
<span class="nf">withFile&#39;</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">bracket</span><span class="w"> </span><span class="p">(</span><span class="n">openFile</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">mode</span><span class="p">)</span><span class="w"> </span><span class="n">hClose</span>

<span class="c1">-- 使用例</span>
<span class="nf">readFileContents</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">FilePath</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">IO</span><span class="w"> </span><span class="p">(</span><span class="kt">Either</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="kt">String</span><span class="p">)</span>
<span class="nf">readFileContents</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kr">do</span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="n">try</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="n">withFile&#39;</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="kt">ReadMode</span><span class="w"> </span><span class="n">hGetContents</span>
<span class="w">    </span><span class="kr">case</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="kr">of</span>
<span class="w">        </span><span class="kt">Left</span><span class="w"> </span><span class="n">e</span><span class="w">  </span><span class="ow">-&gt;</span><span class="w"> </span><span class="n">return</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="kt">Left</span><span class="w"> </span><span class="p">(</span><span class="n">show</span><span class="w"> </span><span class="n">e</span><span class="p">)</span>
<span class="w">        </span><span class="kt">Right</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="n">return</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="kt">Right</span><span class="w"> </span><span class="n">c</span>
</code></pre></div>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IlNFUVVFTkNFIiBoZWlnaHQ9IjUyMHB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6NTEzcHg7aGVpZ2h0OjUyMHB4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDUxMyA1MjAiIHdpZHRoPSI1MTNweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PGRlZnMvPjxnPjxnPjx0aXRsZT5BcHBsaWNhdGlvbjwvdGl0bGU+PHJlY3QgZmlsbD0iIzAwMDAwMCIgZmlsbC1vcGFjaXR5PSIwLjAwMDAwIiBoZWlnaHQ9IjQ0OC45OTIyIiB3aWR0aD0iOCIgeD0iNjIuMTExOCIgeT0iMzYuMjk2OSIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTtzdHJva2UtZGFzaGFycmF5OjUsNTsiIHgxPSI2NiIgeDI9IjY2IiB5MT0iMzYuMjk2OSIgeTI9IjQ4NS4yODkxIi8+PC9nPjxnPjx0aXRsZT5icmFja2V0PC90aXRsZT48cmVjdCBmaWxsPSIjMDAwMDAwIiBmaWxsLW9wYWNpdHk9IjAuMDAwMDAiIGhlaWdodD0iNDQ4Ljk5MjIiIHdpZHRoPSI4IiB4PSIyNjcuMTAyNSIgeT0iMzYuMjk2OSIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTtzdHJva2UtZGFzaGFycmF5OjUsNTsiIHgxPSIyNzAuNTM4MSIgeDI9IjI3MC41MzgxIiB5MT0iMzYuMjk2OSIgeTI9IjQ4NS4yODkxIi8+PC9nPjxnPjx0aXRsZT5IYW5kbGU8L3RpdGxlPjxyZWN0IGZpbGw9IiMwMDAwMDAiIGZpbGwtb3BhY2l0eT0iMC4wMDAwMCIgaGVpZ2h0PSI0NDguOTkyMiIgd2lkdGg9IjgiIHg9IjQwMy4zMTY0IiB5PSIzNi4yOTY5Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxO3N0cm9rZS1kYXNoYXJyYXk6NSw1OyIgeDE9IjQwNi42MzE4IiB4Mj0iNDA2LjYzMTgiIHkxPSIzNi4yOTY5IiB5Mj0iNDg1LjI4OTEiLz48L2c+PGc+PHRpdGxlPkZpbGU8L3RpdGxlPjxyZWN0IGZpbGw9IiMwMDAwMDAiIGZpbGwtb3BhY2l0eT0iMC4wMDAwMCIgaGVpZ2h0PSI0NDguOTkyMiIgd2lkdGg9IjgiIHg9IjQ4NC4yMjM2IiB5PSIzNi4yOTY5Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxO3N0cm9rZS1kYXNoYXJyYXk6NSw1OyIgeDE9IjQ4OC4wMDEiIHgyPSI0ODguMDAxIiB5MT0iMzYuMjk2OSIgeTI9IjQ4NS4yODkxIi8+PC9nPjxnIGNsYXNzPSJwYXJ0aWNpcGFudCBwYXJ0aWNpcGFudC1oZWFkIiBkYXRhLXBhcnRpY2lwYW50PSJhcHAiPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iMzAuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjkyLjIyMzYiIHg9IjIwIiB5PSI1Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNzguMjIzNiIgeD0iMjciIHk9IjI0Ljk5NTEiPkFwcGxpY2F0aW9uPC90ZXh0PjwvZz48ZyBjbGFzcz0icGFydGljaXBhbnQgcGFydGljaXBhbnQtdGFpbCIgZGF0YS1wYXJ0aWNpcGFudD0iYXBwIj48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjMwLjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSI5Mi4yMjM2IiB4PSIyMCIgeT0iNDg0LjI4OTEiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI3OC4yMjM2IiB4PSIyNyIgeT0iNTA0LjI4NDIiPkFwcGxpY2F0aW9uPC90ZXh0PjwvZz48ZyBjbGFzcz0icGFydGljaXBhbnQgcGFydGljaXBhbnQtaGVhZCIgZGF0YS1wYXJ0aWNpcGFudD0icmVzIj48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjMwLjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSI2Ny4xMjg5IiB4PSIyMzcuNTM4MSIgeT0iNSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjUzLjEyODkiIHg9IjI0NC41MzgxIiB5PSIyNC45OTUxIj5icmFja2V0PC90ZXh0PjwvZz48ZyBjbGFzcz0icGFydGljaXBhbnQgcGFydGljaXBhbnQtdGFpbCIgZGF0YS1wYXJ0aWNpcGFudD0icmVzIj48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjMwLjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSI2Ny4xMjg5IiB4PSIyMzcuNTM4MSIgeT0iNDg0LjI4OTEiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1My4xMjg5IiB4PSIyNDQuNTM4MSIgeT0iNTA0LjI4NDIiPmJyYWNrZXQ8L3RleHQ+PC9nPjxnIGNsYXNzPSJwYXJ0aWNpcGFudCBwYXJ0aWNpcGFudC1oZWFkIiBkYXRhLXBhcnRpY2lwYW50PSJoYW5kbGUiPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iMzAuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjYzLjM2OTEiIHg9IjM3NS42MzE4IiB5PSI1Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNDkuMzY5MSIgeD0iMzgyLjYzMTgiIHk9IjI0Ljk5NTEiPkhhbmRsZTwvdGV4dD48L2c+PGcgY2xhc3M9InBhcnRpY2lwYW50IHBhcnRpY2lwYW50LXRhaWwiIGRhdGEtcGFydGljaXBhbnQ9ImhhbmRsZSI+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgaGVpZ2h0PSIzMC4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iNjMuMzY5MSIgeD0iMzc1LjYzMTgiIHk9IjQ4NC4yODkxIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNDkuMzY5MSIgeD0iMzgyLjYzMTgiIHk9IjUwNC4yODQyIj5IYW5kbGU8L3RleHQ+PC9nPjxnIGNsYXNzPSJwYXJ0aWNpcGFudCBwYXJ0aWNpcGFudC1oZWFkIiBkYXRhLXBhcnRpY2lwYW50PSJmaWxlIj48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjMwLjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSIzOC40NDUzIiB4PSI0NjkuMDAxIiB5PSI1Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjQuNDQ1MyIgeD0iNDc2LjAwMSIgeT0iMjQuOTk1MSI+RmlsZTwvdGV4dD48L2c+PGcgY2xhc3M9InBhcnRpY2lwYW50IHBhcnRpY2lwYW50LXRhaWwiIGRhdGEtcGFydGljaXBhbnQ9ImZpbGUiPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iMzAuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjM4LjQ0NTMiIHg9IjQ2OS4wMDEiIHk9IjQ4NC4yODkxIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjQuNDQ1MyIgeD0iNDc2LjAwMSIgeT0iNTA0LjI4NDIiPkZpbGU8L3RleHQ+PC9nPjxnIGNsYXNzPSJtZXNzYWdlIiBkYXRhLXBhcnRpY2lwYW50LTE9ImFwcCIgZGF0YS1wYXJ0aWNpcGFudC0yPSJyZXMiPjxwb2x5Z29uIGZpbGw9IiMwMDAwMDAiIHBvaW50cz0iMjU5LjEwMjUsNjMuNDI5NywyNjkuMTAyNSw2Ny40Mjk3LDI1OS4xMDI1LDcxLjQyOTcsMjYzLjEwMjUsNjcuNDI5NyIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiIHgxPSI2Ni4xMTE4IiB4Mj0iMjY1LjEwMjUiIHkxPSI2Ny40Mjk3IiB5Mj0iNjcuNDI5NyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE4MC45OTA3IiB4PSI3My4xMTE4IiB5PSI2Mi4zNjM4Ij5icmFja2V0IGFjcXVpcmUgcmVsZWFzZSB1c2U8L3RleHQ+PC9nPjxnIGNsYXNzPSJtZXNzYWdlIiBkYXRhLXBhcnRpY2lwYW50LTE9InJlcyIgZGF0YS1wYXJ0aWNpcGFudC0yPSJoYW5kbGUiPjxwb2x5Z29uIGZpbGw9IiMwMDAwMDAiIHBvaW50cz0iMzk1LjMxNjQsOTIuNTYyNSw0MDUuMzE2NCw5Ni41NjI1LDM5NS4zMTY0LDEwMC41NjI1LDM5OS4zMTY0LDk2LjU2MjUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMjcxLjEwMjUiIHgyPSI0MDEuMzE2NCIgeTE9Ijk2LjU2MjUiIHkyPSI5Ni41NjI1Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTEyLjIxMzkiIHg9IjI3OC4xMDI1IiB5PSI5MS40OTY2Ij5hY3F1aXJlOiBvcGVuRmlsZTwvdGV4dD48L2c+PGcgY2xhc3M9Im1lc3NhZ2UiIGRhdGEtcGFydGljaXBhbnQtMT0iaGFuZGxlIiBkYXRhLXBhcnRpY2lwYW50LTI9ImZpbGUiPjxwb2x5Z29uIGZpbGw9IiMwMDAwMDAiIHBvaW50cz0iNDc2LjIyMzYsMTIxLjY5NTMsNDg2LjIyMzYsMTI1LjY5NTMsNDc2LjIyMzYsMTI5LjY5NTMsNDgwLjIyMzYsMTI1LjY5NTMiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iNDA3LjMxNjQiIHgyPSI0ODIuMjIzNiIgeTE9IjEyNS42OTUzIiB5Mj0iMTI1LjY5NTMiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzMi40NDI5IiB4PSI0MTQuMzE2NCIgeT0iMTIwLjYyOTQiPm9wZW48L3RleHQ+PC9nPjxnIGNsYXNzPSJtZXNzYWdlIiBkYXRhLXBhcnRpY2lwYW50LTE9ImZpbGUiIGRhdGEtcGFydGljaXBhbnQtMj0iaGFuZGxlIj48cG9seWdvbiBmaWxsPSIjMDAwMDAwIiBwb2ludHM9IjQxOC4zMTY0LDE1MC44MjgxLDQwOC4zMTY0LDE1NC44MjgxLDQxOC4zMTY0LDE1OC44MjgxLDQxNC4zMTY0LDE1NC44MjgxIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxO3N0cm9rZS1kYXNoYXJyYXk6MiwyOyIgeDE9IjQxMi4zMTY0IiB4Mj0iNDg3LjIyMzYiIHkxPSIxNTQuODI4MSIgeTI9IjE1NC44MjgxIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNDQuMzA2NiIgeD0iNDI0LjMxNjQiIHk9IjE0OS43NjIyIj5oYW5kbGU8L3RleHQ+PC9nPjxnIGNsYXNzPSJtZXNzYWdlIiBkYXRhLXBhcnRpY2lwYW50LTE9ImFwcCIgZGF0YS1wYXJ0aWNpcGFudC0yPSJyZXMiPjxwb2x5Z29uIGZpbGw9IiMwMDAwMDAiIHBvaW50cz0iMjU5LjEwMjUsMTc5Ljk2MDksMjY5LjEwMjUsMTgzLjk2MDksMjU5LjEwMjUsMTg3Ljk2MDksMjYzLjEwMjUsMTgzLjk2MDkiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iNjYuMTExOCIgeDI9IjI2NS4xMDI1IiB5MT0iMTgzLjk2MDkiIHkyPSIxODMuOTYwOSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEyNy41MjQ0IiB4PSI3My4xMTE4IiB5PSIxNzguODk1Ij51c2UgKHJlYWQgY29udGVudHMpPC90ZXh0PjwvZz48ZyBjbGFzcz0ibWVzc2FnZSIgZGF0YS1wYXJ0aWNpcGFudC0xPSJyZXMiIGRhdGEtcGFydGljaXBhbnQtMj0iaGFuZGxlIj48cG9seWdvbiBmaWxsPSIjMDAwMDAwIiBwb2ludHM9IjM5NS4zMTY0LDIwOS4wOTM4LDQwNS4zMTY0LDIxMy4wOTM4LDM5NS4zMTY0LDIxNy4wOTM4LDM5OS4zMTY0LDIxMy4wOTM4IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgeDE9IjI3MS4xMDI1IiB4Mj0iNDAxLjMxNjQiIHkxPSIyMTMuMDkzOCIgeTI9IjIxMy4wOTM4Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iODkuODgyOCIgeD0iMjc4LjEwMjUiIHk9IjIwOC4wMjc4Ij5oR2V0Q29udGVudHM8L3RleHQ+PC9nPjxnIGNsYXNzPSJtZXNzYWdlIiBkYXRhLXBhcnRpY2lwYW50LTE9ImhhbmRsZSIgZGF0YS1wYXJ0aWNpcGFudC0yPSJmaWxlIj48cG9seWdvbiBmaWxsPSIjMDAwMDAwIiBwb2ludHM9IjQ3Ni4yMjM2LDIzOC4yMjY2LDQ4Ni4yMjM2LDI0Mi4yMjY2LDQ3Ni4yMjM2LDI0Ni4yMjY2LDQ4MC4yMjM2LDI0Mi4yMjY2IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgeDE9IjQwNy4zMTY0IiB4Mj0iNDgyLjIyMzYiIHkxPSIyNDIuMjI2NiIgeTI9IjI0Mi4yMjY2Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjkuNTYxIiB4PSI0MTQuMzE2NCIgeT0iMjM3LjE2MDYiPnJlYWQ8L3RleHQ+PC9nPjxnIGNsYXNzPSJtZXNzYWdlIiBkYXRhLXBhcnRpY2lwYW50LTE9ImZpbGUiIGRhdGEtcGFydGljaXBhbnQtMj0iaGFuZGxlIj48cG9seWdvbiBmaWxsPSIjMDAwMDAwIiBwb2ludHM9IjQxOC4zMTY0LDI2Ny4zNTk0LDQwOC4zMTY0LDI3MS4zNTk0LDQxOC4zMTY0LDI3NS4zNTk0LDQxNC4zMTY0LDI3MS4zNTk0IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxO3N0cm9rZS1kYXNoYXJyYXk6MiwyOyIgeDE9IjQxMi4zMTY0IiB4Mj0iNDg3LjIyMzYiIHkxPSIyNzEuMzU5NCIgeTI9IjI3MS4zNTk0Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNTYuNTQ0OSIgeD0iNDI0LjMxNjQiIHk9IjI2Ni4yOTM1Ij5jb250ZW50czwvdGV4dD48L2c+PGcgY2xhc3M9Im1lc3NhZ2UiIGRhdGEtcGFydGljaXBhbnQtMT0iaGFuZGxlIiBkYXRhLXBhcnRpY2lwYW50LTI9InJlcyI+PHBvbHlnb24gZmlsbD0iIzAwMDAwMCIgcG9pbnRzPSIyODIuMTAyNSwyOTYuNDkyMiwyNzIuMTAyNSwzMDAuNDkyMiwyODIuMTAyNSwzMDQuNDkyMiwyNzguMTAyNSwzMDAuNDkyMiIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTtzdHJva2UtZGFzaGFycmF5OjIsMjsiIHgxPSIyNzYuMTAyNSIgeDI9IjQwNi4zMTY0IiB5MT0iMzAwLjQ5MjIiIHkyPSIzMDAuNDkyMiIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjU2LjU0NDkiIHg9IjI4OC4xMDI1IiB5PSIyOTUuNDI2MyI+Y29udGVudHM8L3RleHQ+PC9nPjxnIGNsYXNzPSJtZXNzYWdlIiBkYXRhLXBhcnRpY2lwYW50LTE9InJlcyIgZGF0YS1wYXJ0aWNpcGFudC0yPSJhcHAiPjxwb2x5Z29uIGZpbGw9IiMwMDAwMDAiIHBvaW50cz0iNzcuMTExOCwzMjUuNjI1LDY3LjExMTgsMzI5LjYyNSw3Ny4xMTE4LDMzMy42MjUsNzMuMTExOCwzMjkuNjI1IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxO3N0cm9rZS1kYXNoYXJyYXk6MiwyOyIgeDE9IjcxLjExMTgiIHgyPSIyNzAuMTAyNSIgeTE9IjMyOS42MjUiIHkyPSIzMjkuNjI1Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNTYuNTQ0OSIgeD0iODMuMTExOCIgeT0iMzI0LjU1OTEiPmNvbnRlbnRzPC90ZXh0PjwvZz48ZyBjbGFzcz0ibWVzc2FnZSIgZGF0YS1wYXJ0aWNpcGFudC0xPSJhcHAiIGRhdGEtcGFydGljaXBhbnQtMj0icmVzIj48cG9seWdvbiBmaWxsPSIjMDAwMDAwIiBwb2ludHM9IjI1OS4xMDI1LDM1NC43NTc4LDI2OS4xMDI1LDM1OC43NTc4LDI1OS4xMDI1LDM2Mi43NTc4LDI2My4xMDI1LDM1OC43NTc4IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgeDE9IjY2LjExMTgiIHgyPSIyNjUuMTAyNSIgeTE9IjM1OC43NTc4IiB5Mj0iMzU4Ljc1NzgiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMjcuNzA4NSIgeD0iNzMuMTExOCIgeT0iMzUzLjY5MTkiPnJlbGVhc2UgKGF1dG9tYXRpYyk8L3RleHQ+PC9nPjxnIGNsYXNzPSJtZXNzYWdlIiBkYXRhLXBhcnRpY2lwYW50LTE9InJlcyIgZGF0YS1wYXJ0aWNpcGFudC0yPSJoYW5kbGUiPjxwb2x5Z29uIGZpbGw9IiMwMDAwMDAiIHBvaW50cz0iMzk1LjMxNjQsMzgzLjg5MDYsNDA1LjMxNjQsMzg3Ljg5MDYsMzk1LjMxNjQsMzkxLjg5MDYsMzk5LjMxNjQsMzg3Ljg5MDYiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMjcxLjEwMjUiIHgyPSI0MDEuMzE2NCIgeTE9IjM4Ny44OTA2IiB5Mj0iMzg3Ljg5MDYiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0My42NTI4IiB4PSIyNzguMTAyNSIgeT0iMzgyLjgyNDciPmhDbG9zZTwvdGV4dD48L2c+PGcgY2xhc3M9Im1lc3NhZ2UiIGRhdGEtcGFydGljaXBhbnQtMT0iaGFuZGxlIiBkYXRhLXBhcnRpY2lwYW50LTI9ImZpbGUiPjxwb2x5Z29uIGZpbGw9IiMwMDAwMDAiIHBvaW50cz0iNDc2LjIyMzYsNDEzLjAyMzQsNDg2LjIyMzYsNDE3LjAyMzQsNDc2LjIyMzYsNDIxLjAyMzQsNDgwLjIyMzYsNDE3LjAyMzQiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iNDA3LjMxNjQiIHgyPSI0ODIuMjIzNiIgeTE9IjQxNy4wMjM0IiB5Mj0iNDE3LjAyMzQiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzMy40ODM5IiB4PSI0MTQuMzE2NCIgeT0iNDExLjk1NzUiPmNsb3NlPC90ZXh0PjwvZz48cGF0aCBkPSJNMTc1LDQzMC4wMjM0IEwxNzUsNDcwLjAyMzQgTDM2Niw0NzAuMDIzNCBMMzY2LDQ0MC4wMjM0IEwzNTYsNDMwLjAyMzQgTDE3NSw0MzAuMDIzNCIgZmlsbD0iI0ZGRkZGRiIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjxwYXRoIGQ9Ik0zNTYsNDMwLjAyMzQgTDM1Niw0NDAuMDIzNCBMMzY2LDQ0MC4wMjM0IEwzNTYsNDMwLjAyMzQiIGZpbGw9IiNGRkZGRkYiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNzAuNDY2NCIgeD0iMTgxIiB5PSI0NDcuMDkwMyI+YnJhY2tldCAmIzEyMzk5OyYjMjAzNjM7JiMyMjgwNjsmIzEyMzY0OyYjMzAzMzA7JiMyOTk4MzsmIzEyMzc1OyYjMTIzOTA7JiMxMjQxODs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTQ2Ljk1NDciIHg9IjE4MSIgeT0iNDYyLjIyMzEiPiYjMjQ1MTc7JiMxMjM3ODsgcmVsZWFzZSAmIzEyNDM0OyYjMjM0NTU7JiMzNDg5MjsmIzEyMzc3OyYjMTI0Mjc7PC90ZXh0PjwhLS1TUkM9W1BQNm5KaUNtNDhQdEZ5TkhnR256V0duOGcxQm02Z3ZwQTFRZlJNbzd0UDZPc1dhWEs1YWc5Q0c4RW1DeVo4ZEFPczB4SVRLcXMtYy10X3pfbFprbjFJdUhMNGN2ODRISFJKZFpZV2VCYXRFYklpd2V2TDlDVzFnV0lXcTUycXRQM1RlNERQZVhsQThZQnA2bjhmTDNWQzR4VTFxQUdlOHRwQ3dZSW1RVEJMMXNNdDZEZUxhWURHWUxHSDg0S1RTd1BocWEwd2JHSDRsSWFnWTluWXFXaU9KUG1SamtlYTVpaThVZkhmZTNheUFZaUVScUVBd3VIM2xsdTJXZkZYcWRpTUR2N3hTN0FJRHFtb203dFM1ZV9HUWNqQjlvNkl4Mm5nRkRJc2Q2dHNVZkl1SXEyRjhFVFJmSmxzM2xGZC1fTHl0UmF0Vmh0VVBoenhacnhqY3hUcl9OZkZjdnotdmJkLXBoWC1QWi1fVXd6Y3had25MMWFLQ3FfR1MwXS0tPjwvZz48L3N2Zz4=" class="uml" alt="uml diagram" title="" /></p>
<p>Scala との対応:
- <code>Resource[IO, A]</code> → <code>bracket acquire release use</code>
- <code>Resource.make(acquire)(release)</code> → <code>bracket acquire release</code></p>
<h3 id="129">12.9 純粋関数のテスト<a class="headerlink" href="#129" title="Permanent link">&para;</a></h3>
<p>純粋関数は副作用がないため、テストが非常に簡単です。</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- 人口でロケーションをフィルタリング（純粋関数）</span>
<span class="nf">filterPopularLocations</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="p">[</span><span class="kt">Location</span><span class="p">]</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="p">[</span><span class="kt">Location</span><span class="p">]</span>
<span class="nf">filterPopularLocations</span><span class="w"> </span><span class="n">locations</span><span class="w"> </span><span class="n">minPopulation</span><span class="w"> </span><span class="ow">=</span>
<span class="w">    </span><span class="n">filter</span><span class="w"> </span><span class="p">(</span><span class="nf">\</span><span class="n">loc</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="n">locPopulation</span><span class="w"> </span><span class="n">loc</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">minPopulation</span><span class="p">)</span><span class="w"> </span><span class="n">locations</span>

<span class="c1">-- アトラクションを人口でソート（純粋関数）</span>
<span class="nf">sortAttractionsByPopulation</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="p">[</span><span class="kt">Attraction</span><span class="p">]</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="p">[</span><span class="kt">Attraction</span><span class="p">]</span>
<span class="nf">sortAttractionsByPopulation</span><span class="w"> </span><span class="ow">=</span>
<span class="w">    </span><span class="n">sortBy</span><span class="w"> </span><span class="p">(</span><span class="nf">\</span><span class="n">a</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="n">compare</span><span class="w"> </span><span class="p">(</span><span class="kt">Down</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="n">locPopulation</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="n">attrLocation</span><span class="w"> </span><span class="n">a</span><span class="p">)</span>
<span class="w">                            </span><span class="p">(</span><span class="kt">Down</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="n">locPopulation</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="n">attrLocation</span><span class="w"> </span><span class="n">b</span><span class="p">))</span>

<span class="c1">-- バリデーション（純粋関数）</span>
<span class="nf">validateLocation</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Location</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Either</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="kt">Location</span>
<span class="nf">validateLocation</span><span class="w"> </span><span class="n">loc</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="n">null</span><span class="w"> </span><span class="p">(</span><span class="n">unLocationId</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="n">locId</span><span class="w"> </span><span class="n">loc</span><span class="p">)</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">Left</span><span class="w"> </span><span class="s">&quot;Location ID cannot be empty&quot;</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="n">null</span><span class="w"> </span><span class="p">(</span><span class="n">locName</span><span class="w"> </span><span class="n">loc</span><span class="p">)</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">Left</span><span class="w"> </span><span class="s">&quot;Location name cannot be empty&quot;</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="n">locPopulation</span><span class="w"> </span><span class="n">loc</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">Left</span><span class="w"> </span><span class="s">&quot;Population cannot be negative&quot;</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="n">otherwise</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">Right</span><span class="w"> </span><span class="n">loc</span>
</code></pre></div>
<h3 id="1210-hspec">12.10 HSpec によるユニットテスト<a class="headerlink" href="#1210-hspec" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kr">import</span><span class="w"> </span><span class="nn">Test.Hspec</span>

<span class="nf">spec</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Spec</span>
<span class="nf">spec</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kr">do</span>
<span class="w">    </span><span class="n">describe</span><span class="w"> </span><span class="s">&quot;filterPopularLocations&quot;</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="kr">do</span>
<span class="w">        </span><span class="n">it</span><span class="w"> </span><span class="s">&quot;filters by minimum population&quot;</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="kr">do</span>
<span class="w">            </span><span class="kr">let</span><span class="w"> </span><span class="n">locs</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="kt">Location</span><span class="w"> </span><span class="p">(</span><span class="kt">LocationId</span><span class="w"> </span><span class="s">&quot;1&quot;</span><span class="p">)</span><span class="w"> </span><span class="s">&quot;A&quot;</span><span class="w"> </span><span class="mi">100</span>
<span class="w">                       </span><span class="p">,</span><span class="w"> </span><span class="kt">Location</span><span class="w"> </span><span class="p">(</span><span class="kt">LocationId</span><span class="w"> </span><span class="s">&quot;2&quot;</span><span class="p">)</span><span class="w"> </span><span class="s">&quot;B&quot;</span><span class="w"> </span><span class="mi">200</span>
<span class="w">                       </span><span class="p">,</span><span class="w"> </span><span class="kt">Location</span><span class="w"> </span><span class="p">(</span><span class="kt">LocationId</span><span class="w"> </span><span class="s">&quot;3&quot;</span><span class="p">)</span><span class="w"> </span><span class="s">&quot;C&quot;</span><span class="w"> </span><span class="mi">150</span>
<span class="w">                       </span><span class="p">]</span>
<span class="w">            </span><span class="kr">let</span><span class="w"> </span><span class="n">filtered</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">filterPopularLocations</span><span class="w"> </span><span class="n">locs</span><span class="w"> </span><span class="mi">150</span>
<span class="w">            </span><span class="n">length</span><span class="w"> </span><span class="n">filtered</span><span class="w"> </span><span class="p">`</span><span class="n">shouldBe</span><span class="p">`</span><span class="w"> </span><span class="mi">2</span>

<span class="w">        </span><span class="n">it</span><span class="w"> </span><span class="s">&quot;returns empty for high minimum&quot;</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="kr">do</span>
<span class="w">            </span><span class="kr">let</span><span class="w"> </span><span class="n">locs</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="p">[</span><span class="kt">Location</span><span class="w"> </span><span class="p">(</span><span class="kt">LocationId</span><span class="w"> </span><span class="s">&quot;1&quot;</span><span class="p">)</span><span class="w"> </span><span class="s">&quot;A&quot;</span><span class="w"> </span><span class="mi">100</span><span class="p">]</span>
<span class="w">            </span><span class="n">filterPopularLocations</span><span class="w"> </span><span class="n">locs</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="p">`</span><span class="n">shouldBe</span><span class="p">`</span><span class="w"> </span><span class="kt">[]</span>

<span class="w">    </span><span class="n">describe</span><span class="w"> </span><span class="s">&quot;validateLocation&quot;</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="kr">do</span>
<span class="w">        </span><span class="n">it</span><span class="w"> </span><span class="s">&quot;validates correct location&quot;</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="kr">do</span>
<span class="w">            </span><span class="kr">let</span><span class="w"> </span><span class="n">loc</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">Location</span><span class="w"> </span><span class="p">(</span><span class="kt">LocationId</span><span class="w"> </span><span class="s">&quot;Q1&quot;</span><span class="p">)</span><span class="w"> </span><span class="s">&quot;Tokyo&quot;</span><span class="w"> </span><span class="mi">14000000</span>
<span class="w">            </span><span class="n">validateLocation</span><span class="w"> </span><span class="n">loc</span><span class="w"> </span><span class="p">`</span><span class="n">shouldBe</span><span class="p">`</span><span class="w"> </span><span class="kt">Right</span><span class="w"> </span><span class="n">loc</span>

<span class="w">        </span><span class="n">it</span><span class="w"> </span><span class="s">&quot;rejects empty ID&quot;</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="kr">do</span>
<span class="w">            </span><span class="kr">let</span><span class="w"> </span><span class="n">loc</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">Location</span><span class="w"> </span><span class="p">(</span><span class="kt">LocationId</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="s">&quot;Tokyo&quot;</span><span class="w"> </span><span class="mi">14000000</span>
<span class="w">            </span><span class="n">validateLocation</span><span class="w"> </span><span class="n">loc</span><span class="w"> </span><span class="p">`</span><span class="n">shouldBe</span><span class="p">`</span><span class="w"> </span><span class="kt">Left</span><span class="w"> </span><span class="s">&quot;Location ID cannot be empty&quot;</span>
</code></pre></div>
<h3 id="1211-quickcheck">12.11 QuickCheck によるプロパティベーステスト<a class="headerlink" href="#1211-quickcheck" title="Permanent link">&para;</a></h3>
<p>QuickCheck を使用したプロパティベーステスト:</p>
<div class="highlight"><pre><span></span><code><span class="kr">import</span><span class="w"> </span><span class="nn">Test.QuickCheck</span>

<span class="c1">-- Arbitrary インスタンスの定義</span>
<span class="kr">instance</span><span class="w"> </span><span class="kt">Arbitrary</span><span class="w"> </span><span class="kt">LocationId</span><span class="w"> </span><span class="kr">where</span>
<span class="w">    </span><span class="n">arbitrary</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">LocationId</span><span class="w"> </span><span class="o">&lt;$&gt;</span><span class="w"> </span><span class="n">listOf1</span><span class="w"> </span><span class="p">(</span><span class="n">elements</span><span class="w"> </span><span class="p">[</span><span class="sc">&#39;a&#39;</span><span class="o">..</span><span class="sc">&#39;z&#39;</span><span class="p">])</span>

<span class="kr">instance</span><span class="w"> </span><span class="kt">Arbitrary</span><span class="w"> </span><span class="kt">Location</span><span class="w"> </span><span class="kr">where</span>
<span class="w">    </span><span class="n">arbitrary</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">Location</span>
<span class="w">        </span><span class="o">&lt;$&gt;</span><span class="w"> </span><span class="n">arbitrary</span>
<span class="w">        </span><span class="o">&lt;*&gt;</span><span class="w"> </span><span class="n">listOf1</span><span class="w"> </span><span class="p">(</span><span class="n">elements</span><span class="w"> </span><span class="p">[</span><span class="sc">&#39;A&#39;</span><span class="o">..</span><span class="sc">&#39;Z&#39;</span><span class="p">])</span>
<span class="w">        </span><span class="o">&lt;*&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">abs</span><span class="w"> </span><span class="o">&lt;$&gt;</span><span class="w"> </span><span class="n">arbitrary</span><span class="p">)</span>

<span class="c1">-- プロパティテスト</span>
<span class="nf">spec</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Spec</span>
<span class="nf">spec</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kr">do</span>
<span class="w">    </span><span class="n">describe</span><span class="w"> </span><span class="s">&quot;Property-based tests&quot;</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="kr">do</span>
<span class="w">        </span><span class="n">it</span><span class="w"> </span><span class="s">&quot;filterPopularLocations result size &lt;= input size&quot;</span><span class="w"> </span><span class="o">$</span>
<span class="w">            </span><span class="n">property</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="nf">\</span><span class="p">(</span><span class="n">locs</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="p">[</span><span class="kt">Location</span><span class="p">])</span><span class="w"> </span><span class="p">(</span><span class="n">minPop</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Int</span><span class="p">)</span><span class="w"> </span><span class="ow">-&gt;</span>
<span class="w">                </span><span class="n">length</span><span class="w"> </span><span class="p">(</span><span class="n">filterPopularLocations</span><span class="w"> </span><span class="n">locs</span><span class="w"> </span><span class="p">(</span><span class="n">abs</span><span class="w"> </span><span class="n">minPop</span><span class="p">))</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="n">locs</span>

<span class="w">        </span><span class="n">it</span><span class="w"> </span><span class="s">&quot;filterPopularLocations all results meet minimum&quot;</span><span class="w"> </span><span class="o">$</span>
<span class="w">            </span><span class="n">property</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="nf">\</span><span class="p">(</span><span class="n">locs</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="p">[</span><span class="kt">Location</span><span class="p">])</span><span class="w"> </span><span class="p">(</span><span class="n">minPop</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Int</span><span class="p">)</span><span class="w"> </span><span class="ow">-&gt;</span>
<span class="w">                </span><span class="kr">let</span><span class="w"> </span><span class="n">filtered</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">filterPopularLocations</span><span class="w"> </span><span class="n">locs</span><span class="w"> </span><span class="p">(</span><span class="n">abs</span><span class="w"> </span><span class="n">minPop</span><span class="p">)</span>
<span class="w">                </span><span class="kr">in</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="p">(</span><span class="nf">\</span><span class="n">loc</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="n">locPopulation</span><span class="w"> </span><span class="n">loc</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">abs</span><span class="w"> </span><span class="n">minPop</span><span class="p">)</span><span class="w"> </span><span class="n">filtered</span>

<span class="w">        </span><span class="n">it</span><span class="w"> </span><span class="s">&quot;sortAttractionsByPopulation preserves length&quot;</span><span class="w"> </span><span class="o">$</span>
<span class="w">            </span><span class="n">property</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="nf">\</span><span class="p">(</span><span class="n">attrs</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="p">[</span><span class="kt">Attraction</span><span class="p">])</span><span class="w"> </span><span class="ow">-&gt;</span>
<span class="w">                </span><span class="n">length</span><span class="w"> </span><span class="p">(</span><span class="n">sortAttractionsByPopulation</span><span class="w"> </span><span class="n">attrs</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="n">attrs</span>
</code></pre></div>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkRFU0NSSVBUSU9OIiBoZWlnaHQ9IjQyOXB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6MjkycHg7aGVpZ2h0OjQyOXB4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDI5MiA0MjkiIHdpZHRoPSIyOTJweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PGRlZnMvPjxnPjwhLS1jbHVzdGVyID8/Pz8/Pz8/Pz8/LS0+PGcgY2xhc3M9ImNsdXN0ZXIiIGRhdGEtZW50aXR5PSIuLi4uLi4uLi4uLiIgZGF0YS1zb3VyY2UtbGluZT0iMyIgZGF0YS11aWQ9ImVudDAwMDIiIGlkPSJjbHVzdGVyXy4uLi4uLi4uLi4uIj48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjMyMy4xOCIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjI3NCIgeD0iMTIiIHk9IjEyIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE1My45OTkzIiB4PSI3Mi4wMDAzIiB5PSIyNi45OTUxIj4mIzEyNTAzOyYjMTI1MjU7JiMxMjQ5NzsmIzEyNDg2OyYjMTI0NTE7JiMxMjUwNTsmIzEyNTQwOyYjMTI0NzM7JiMxMjQ4NjsmIzEyNDczOyYjMTI0ODg7PC90ZXh0PjwvZz48IS0tZW50aXR5IGdlbi0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJnZW4iIGRhdGEtc291cmNlLWxpbmU9IjQiIGRhdGEtdWlkPSJlbnQwMDAzIiBpZD0iZW50aXR5X2dlbiI+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgaGVpZ2h0PSIyMi4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iMTcwLjQyNDQiIHg9IjYzLjc5IiB5PSI0NyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE1MC40MjQ0IiB4PSI3My43OSIgeT0iNjIuOTk1MSI+QXJiaXRyYXJ5ICYjMTI0NTI7JiMxMjUzMTsmIzEyNDczOyYjMTI0Nzk7JiMxMjUzMTsmIzEyNDczOzwvdGV4dD48L2c+PCEtLWVudGl0eSByYW5kb20tLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0icmFuZG9tIiBkYXRhLXNvdXJjZS1saW5lPSI1IiBkYXRhLXVpZD0iZW50MDAwNCIgaWQ9ImVudGl0eV9yYW5kb20iPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iMjIuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjE0NS45OTk1IiB4PSI3NiIgeT0iMTMwLjI5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTI1Ljk5OTUiIHg9Ijg2IiB5PSIxNDYuMjg1MSI+JiMxMjUyMTsmIzEyNTMxOyYjMTI0ODA7JiMxMjUxMjsmIzEyNDg3OyYjMTI1NDA7JiMxMjQ3OTsmIzI5OTgzOyYjMjUxMDQ7PC90ZXh0PjwvZz48IS0tZW50aXR5IHZlcmlmeS0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJ2ZXJpZnkiIGRhdGEtc291cmNlLWxpbmU9IjYiIGRhdGEtdWlkPSJlbnQwMDA1IiBpZD0iZW50aXR5X3ZlcmlmeSI+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgaGVpZ2h0PSIyMi4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iMTE3Ljk5OTYiIHg9IjI4IiB5PSIyMTMuNTkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5Ny45OTk2IiB4PSIzOCIgeT0iMjI5LjU4NTEiPiYjMTI1MDM7JiMxMjUyNTsmIzEyNDk3OyYjMTI0ODY7JiMxMjQ1MTsmIzI2OTA4OyYjMzUzODg7PC90ZXh0PjwvZz48IS0tZW50aXR5IHJlcGVhdC0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJyZXBlYXQiIGRhdGEtc291cmNlLWxpbmU9IjciIGRhdGEtdWlkPSJlbnQwMDA2IiBpZD0iZW50aXR5X3JlcGVhdCI+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgaGVpZ2h0PSIyMi4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iMTMwLjcyMTMiIHg9IjgzLjY0IiB5PSIyOTYuODkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMTAuNzIxMyIgeD0iOTMuNjQiIHk9IjMxMi44ODUxIj4xMDAmIzIyMjM4OyYjMjAxOTc7JiMxOTk3ODsmIzEyNDg2OyYjMTI0NzM7JiMxMjQ4ODs8L3RleHQ+PC9nPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJHTU4xMSIgZGF0YS1zb3VyY2UtbGluZT0iMTYiIGRhdGEtdWlkPSJlbnQwMDEyIiBpZD0iZW50aXR5X0dNTjExIj48cGF0aCBkPSJNNzIuMDYsMzgyLjE4IEw3Mi4wNiw0MjIuNDQ1NiBBMCwwIDAgMCAwIDcyLjA2LDQyMi40NDU2IEwyMjUuOTQxOSw0MjIuNDQ1NiBBMCwwIDAgMCAwIDIyNS45NDE5LDQyMi40NDU2IEwyMjUuOTQxOSwzOTIuMTggTDIxNS45NDE5LDM4Mi4xOCBMMTUzLDM4Mi4xOCBMMTQ5LDMxOS42MiBMMTQ1LDM4Mi4xOCBMNzIuMDYsMzgyLjE4IEEwLDAgMCAwIDAgNzIuMDYsMzgyLjE4IiBmaWxsPSIjRkZGRkZGIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBhdGggZD0iTTIxNS45NDE5LDM4Mi4xOCBMMjE1Ljk0MTksMzkyLjE4IEwyMjUuOTQxOSwzOTIuMTggTDIxNS45NDE5LDM4Mi4xOCIgZmlsbD0iI0ZGRkZGRiIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEzMi44ODE5IiB4PSI3OC4wNiIgeT0iMzk5LjI0NjkiPlF1aWNrQ2hlY2sgJiMxMjM2NDsmIzMzMjU4OyYjMjEyMDU7JiMxMjM5MTs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTMwLjAwMDIiIHg9Ijc4LjA2IiB5PSI0MTQuMzc5NyI+JiMxMjUyMTsmIzEyNTMxOyYjMTI0ODA7JiMxMjUxMjsmIzEyMzk0OyYjMjA4Mzc7JiMyMTE0NzsmIzEyNDM0OyYjMjk5ODM7JiMyNTEwNDs8L3RleHQ+PC9nPjwhLS1saW5rIGdlbiB0byByYW5kb20tLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iZ2VuIiBkYXRhLWVudGl0eS0yPSJyYW5kb20iIGRhdGEtc291cmNlLWxpbmU9IjkiIGRhdGEtdWlkPSJsbms3IiBpZD0ibGlua19nZW5fcmFuZG9tIj48cGF0aCBkPSJNMTQ5LDY5Ljc3IEMxNDksODUuMzUgMTQ5LDEwOC4yMyAxNDksMTIzLjgxIiBmaWxsPSJub25lIiBpZD0iZ2VuLXRvLXJhbmRvbSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMwMDAwMDAiIHBvaW50cz0iMTQ5LDEyOS44MSwxNTMsMTIwLjgxLDE0OSwxMjQuODEsMTQ1LDEyMC44MSwxNDksMTI5LjgxIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjwhLS1saW5rIHJhbmRvbSB0byB2ZXJpZnktLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0icmFuZG9tIiBkYXRhLWVudGl0eS0yPSJ2ZXJpZnkiIGRhdGEtc291cmNlLWxpbmU9IjEwIiBkYXRhLXVpZD0ibG5rOCIgaWQ9ImxpbmtfcmFuZG9tX3ZlcmlmeSI+PHBhdGggZD0iTTE0MC44OSwxNTMuMDcgQzEyOS4wMSwxNjguNjUgMTEwLjYyODEsMTkyLjc1ODggOTguNzQ4MSwyMDguMzM4OCIgZmlsbD0ibm9uZSIgaWQ9InJhbmRvbS10by12ZXJpZnkiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMDAwMDAwIiBwb2ludHM9Ijk1LjExLDIxMy4xMSwxMDMuNzQ3OSwyMDguMzc4Niw5OC4xNDE4LDIwOS4xMzQsOTcuMzg2NCwyMDMuNTI3OCw5NS4xMSwyMTMuMTEiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48L2c+PCEtLWxpbmsgdmVyaWZ5IHRvIHJlcGVhdC0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJ2ZXJpZnkiIGRhdGEtZW50aXR5LTI9InJlcGVhdCIgZGF0YS1zb3VyY2UtbGluZT0iMTEiIGRhdGEtdWlkPSJsbms5IiBpZD0ibGlua192ZXJpZnlfcmVwZWF0Ij48cGF0aCBkPSJNOTUuMTEsMjM2LjM3IEMxMDYuOTksMjUxLjk1IDEyNS4zNzM0LDI3Ni4wNDc3IDEzNy4yNTM0LDI5MS42Mzc3IiBmaWxsPSJub25lIiBpZD0idmVyaWZ5LXRvLXJlcGVhdCIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMwMDAwMDAiIHBvaW50cz0iMTQwLjg5LDI5Ni40MSwxMzguNjE2NiwyODYuODI3MSwxMzcuODU5NSwyOTIuNDMzMSwxMzIuMjUzNSwyOTEuNjc2LDE0MC44OSwyOTYuNDEiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48L2c+PCEtLWxpbmsgcmVwZWF0IHRvIHJhbmRvbS0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJyZXBlYXQiIGRhdGEtZW50aXR5LTI9InJhbmRvbSIgZGF0YS1zb3VyY2UtbGluZT0iMTIiIGRhdGEtdWlkPSJsbmsxMCIgaWQ9ImxpbmtfcmVwZWF0X3JhbmRvbSI+PHBhdGggZD0iTTE1Mi4zMSwyOTYuNDMgQzE1Ny4zMiwyNzkuMTQgMTY1Ljk0LDI0My44IDE2MywyMTMuNTkgQzE2MC44OCwxOTEuNzkgMTU2LjYxNjMsMTcyLjU4MzEgMTUzLjE4NjMsMTU4Ljc3MzEiIGZpbGw9Im5vbmUiIGlkPSJyZXBlYXQtdG8tcmFuZG9tIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzAwMDAwMCIgcG9pbnRzPSIxNTEuNzQsMTUyLjk1LDE1MC4wMjc0LDE2Mi42NDg4LDE1Mi45NDUyLDE1Ny44MDI2LDE1Ny43OTE1LDE2MC43MjA0LDE1MS43NCwxNTIuOTUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1Mi4wMDAxIiB4PSIxNjQuNiIgeT0iMjI5LjMwNjkiPiYjMzIzNjg7JiMxMjQyNjsmIzM2ODIwOyYjMTIzNzU7PC90ZXh0PjwvZz48IS0tU1JDPVtMT18xSWlEMDQ0M2wtbkxaeGVMd3pJMjhOLTBkUjlFcjNNcXRQTHM1OGVCUEdMa2cxdkxBYU9lQWpjV0JXazM1T1k0VkNxc1JwcDM5SGNhbEVwa3BSenhFUkVjUVEwZmVEUldsNkxGMnJMbk02bThTbVc3WDEtNGp1SU1QTHk4N21aY1BNUHdjUHpVMUstUG92TzZwZm9nLUxib3JXU284eTJqeER2NnpFQzJGZTJmYVdIOUVpWmdVNHh1R1RkOWJqRWVfQnhpdEVRY3V6OEJjRnhtbm1kQnFjQnBGUy1uNEFGLW1OTTNSdk44eVY1aHlaMVZWbFJOZkNmamUyUXVQSV8tN0tjZHRwc3YzTlliNERiWjZ6alltcldLeGk5Znpha2FiS1BfMjBKalpKMFBRRzJOR0VkS1U3RmprVlJ5Y3QzZkdVOXJxZmw3TEZPTGxSNkZYUzFmVlpFRlVhQ29UdFBhOXdLNmMtR0swXS0tPjwvZz48L3N2Zz4=" class="uml" alt="uml diagram" title="" /></p>
<p>Scala との対応:
- ScalaCheck <code>Gen[A]</code> → QuickCheck <code>Arbitrary a</code>
- <code>forAll</code> → <code>property</code></p>
<h3 id="1212">12.12 統合テスト<a class="headerlink" href="#1212" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nf">describe</span><span class="w"> </span><span class="s">&quot;Integration tests&quot;</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="kr">do</span>
<span class="w">    </span><span class="n">it</span><span class="w"> </span><span class="s">&quot;travelGuide returns guide for valid attraction&quot;</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="kr">do</span>
<span class="w">        </span><span class="n">da</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="n">mkTestDataAccess</span>
<span class="w">        </span><span class="n">guide</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="n">travelGuide</span><span class="w"> </span><span class="n">da</span><span class="w"> </span><span class="s">&quot;Test&quot;</span>
<span class="w">        </span><span class="n">guide</span><span class="w"> </span><span class="p">`</span><span class="n">shouldSatisfy</span><span class="p">`</span><span class="w"> </span><span class="nf">\</span><span class="n">g</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kr">case</span><span class="w"> </span><span class="n">g</span><span class="w"> </span><span class="kr">of</span>
<span class="w">            </span><span class="kt">Just</span><span class="w"> </span><span class="n">g&#39;</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="n">attrName</span><span class="w"> </span><span class="p">(</span><span class="n">tgAttraction</span><span class="w"> </span><span class="n">g&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Test Attraction&quot;</span>
<span class="w">            </span><span class="kt">Nothing</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">False</span>

<span class="w">    </span><span class="n">it</span><span class="w"> </span><span class="s">&quot;travelGuideWithReport collects errors&quot;</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="kr">do</span>
<span class="w">        </span><span class="n">da</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="n">mkFailingDataAccess</span>
<span class="w">        </span><span class="n">guide</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="n">travelGuideWithReport</span><span class="w"> </span><span class="n">da</span><span class="w"> </span><span class="s">&quot;Test&quot;</span>
<span class="w">        </span><span class="kr">case</span><span class="w"> </span><span class="n">guide</span><span class="w"> </span><span class="kr">of</span>
<span class="w">            </span><span class="kt">Just</span><span class="w"> </span><span class="n">g</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kr">do</span>
<span class="w">                </span><span class="kr">let</span><span class="w"> </span><span class="n">errors</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">srErrors</span><span class="w"> </span><span class="p">(</span><span class="n">tgSearchReport</span><span class="w"> </span><span class="n">g</span><span class="p">)</span>
<span class="w">                </span><span class="n">length</span><span class="w"> </span><span class="n">errors</span><span class="w"> </span><span class="p">`</span><span class="n">shouldBe</span><span class="p">`</span><span class="w"> </span><span class="mi">2</span>
<span class="w">                </span><span class="n">errors</span><span class="w"> </span><span class="p">`</span><span class="n">shouldContain</span><span class="p">`</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;Network error&quot;</span><span class="p">]</span>
<span class="w">            </span><span class="kt">Nothing</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="n">expectationFailure</span><span class="w"> </span><span class="s">&quot;Expected Just&quot;</span>

<span class="w">    </span><span class="n">it</span><span class="w"> </span><span class="s">&quot;still returns guide even with errors&quot;</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="kr">do</span>
<span class="w">        </span><span class="n">da</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="n">mkFailingDataAccess</span>
<span class="w">        </span><span class="n">guide</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="n">travelGuideWithReport</span><span class="w"> </span><span class="n">da</span><span class="w"> </span><span class="s">&quot;Test&quot;</span>
<span class="w">        </span><span class="n">guide</span><span class="w"> </span><span class="p">`</span><span class="n">shouldSatisfy</span><span class="p">`</span><span class="w"> </span><span class="nf">\</span><span class="n">g</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kr">case</span><span class="w"> </span><span class="n">g</span><span class="w"> </span><span class="kr">of</span>
<span class="w">            </span><span class="kt">Just</span><span class="w"> </span><span class="kr">_</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">True</span>
<span class="w">            </span><span class="kt">Nothing</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">False</span>
</code></pre></div>
<h3 id="1213">12.13 テストピラミッド<a class="headerlink" href="#1213" title="Permanent link">&para;</a></h3>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkRFU0NSSVBUSU9OIiBoZWlnaHQ9IjM0OHB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6NTA4cHg7aGVpZ2h0OjM0OHB4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDUwOCAzNDgiIHdpZHRoPSI1MDhweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PGRlZnMvPjxnPjwhLS1jbHVzdGVyID8/Pz8/Pz8/LS0+PGcgY2xhc3M9ImNsdXN0ZXIiIGRhdGEtZW50aXR5PSIuLi4uLi4uLiIgZGF0YS1zb3VyY2UtbGluZT0iMyIgZGF0YS11aWQ9ImVudDAwMDIiIGlkPSJjbHVzdGVyXy4uLi4uLi4uIj48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjMzMC4xOCIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjI1NCIgeD0iMTIiIHk9IjEyIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjExMS45OTk1IiB4PSI4My4wMDAyIiB5PSIyNi45OTUxIj4mIzEyNDg2OyYjMTI0NzM7JiMxMjQ4ODsmIzEyNTAwOyYjMTI1MjE7JiMxMjUxMTsmIzEyNDgzOyYjMTI0ODk7PC90ZXh0PjwvZz48IS0tZW50aXR5IGUyZS0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJlMmUiIGRhdGEtc291cmNlLWxpbmU9IjQiIGRhdGEtdWlkPSJlbnQwMDAzIiBpZD0iZW50aXR5X2UyZSI+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgaGVpZ2h0PSI1Mi41OTM4IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iOTMuMDQ4NiIgeD0iOTIuNDgiIHk9IjQ3Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNzMuMDQ4NiIgeD0iMTAyLjQ4IiB5PSI2OS45OTUxIj5FMkUgJiMxMjQ4NjsmIzEyNDczOyYjMTI0ODg7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjM4LjkyMzciIHg9IjEwMi40OCIgeT0iODYuMjkyIj4oJiMyMzU2OTsmIzI1OTY4Oyk8L3RleHQ+PC9nPjwhLS1lbnRpdHkgaW50ZWdyYXRpb24tLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iaW50ZWdyYXRpb24iIGRhdGEtc291cmNlLWxpbmU9IjUiIGRhdGEtdWlkPSJlbnQwMDA0IiBpZD0iZW50aXR5X2ludGVncmF0aW9uIj48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjUyLjU5MzgiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSI4OS45OTk3IiB4PSI5NCIgeT0iMTU5LjU5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNjkuOTk5NyIgeD0iMTA0IiB5PSIxODIuNTg1MSI+JiMzMjExMzsmIzIxNTEyOyYjMTI0ODY7JiMxMjQ3MzsmIzEyNDg4OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1Mi45MjM2IiB4PSIxMDQiIHk9IjE5OC44ODIiPigmIzIwMDEzOyYjMzEyNDM7JiMyNDIzMDspPC90ZXh0PjwvZz48IS0tZW50aXR5IHVuaXQtLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0idW5pdCIgZGF0YS1zb3VyY2UtbGluZT0iNiIgZGF0YS11aWQ9ImVudDAwMDUiIGlkPSJlbnRpdHlfdW5pdCI+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgaGVpZ2h0PSI1Mi41OTM4IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iMjIyLjYzMDEiIHg9IjI3LjY4IiB5PSIyNzMuNTkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyMDIuNjMwMSIgeD0iMzcuNjgiIHk9IjI5Ni41ODUxIj4mIzIxMzM2OyYjMjAzMDc7JiMxMjQ4NjsmIzEyNDczOyYjMTI0ODg7ICsgJiMxMjUwMzsmIzEyNTI1OyYjMTI0OTc7JiMxMjQ4NjsmIzEyNDUxOyYjMTI0ODY7JiMxMjQ3MzsmIzEyNDg4OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzOC45MjM3IiB4PSIzNy42OCIgeT0iMzEyLjg4MiI+KCYjMjI4MTA7JiMyNTk2ODspPC90ZXh0PjwvZz48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iR01OOCIgZGF0YS1zb3VyY2UtbGluZT0iMTMiIGRhdGEtdWlkPSJlbnQwMDA5IiBpZD0iZW50aXR5X0dNTjgiPjxwYXRoIGQ9Ik0yODUsMjcyLjE4IEwyODUsMjk1Ljg4IEwyNTAuNjIsMjk5Ljg4IEwyODUsMzAzLjg4IEwyODUsMzI3LjU3ODQgQTAsMCAwIDAgMCAyODUsMzI3LjU3ODQgTDUwMS4wMDAyLDMyNy41Nzg0IEEwLDAgMCAwIDAgNTAxLjAwMDIsMzI3LjU3ODQgTDUwMS4wMDAyLDI4Mi4xOCBMNDkxLjAwMDIsMjcyLjE4IEwyODUsMjcyLjE4IEEwLDAgMCAwIDAgMjg1LDI3Mi4xOCIgZmlsbD0iI0ZGRkZGRiIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjxwYXRoIGQ9Ik00OTEuMDAwMiwyNzIuMTggTDQ5MS4wMDAyLDI4Mi4xOCBMNTAxLjAwMDIsMjgyLjE4IEw0OTEuMDAwMiwyNzIuMTgiIGZpbGw9IiNGRkZGRkYiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxOTQuMzk3MSIgeD0iMjkxIiB5PSIyODkuMjQ2OSI+SGFza2VsbCAmIzEyMzkxOyYjMTIzOTk7JiMzMjAyMDsmIzMxODgzOyYjMzgzMDY7JiMyNTk2ODsmIzEyMzY0OyYjMjI4MTA7JiMxMjM1NjsmIzEyMzgzOyYjMTI0MTc7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE5NS4wMDAyIiB4PSIyOTEiIHk9IjMwNC4zNzk3Ij4mIzIxMzM2OyYjMjAzMDc7JiMxMjQ4NjsmIzEyNDczOyYjMTI0ODg7JiMxMjM5MjsmIzEyNTAzOyYjMTI1MjU7JiMxMjQ5NzsmIzEyNDg2OyYjMTI0NTE7JiMxMjQ4NjsmIzEyNDczOyYjMTI0ODg7JiMxMjM2NDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNzguMDAwMSIgeD0iMjkxIiB5PSIzMTkuNTEyNSI+JiMzODc1MDsmIzI0MTIwOyYjMTIzOTU7JiMyMTE3NzsmIzI2NTI0OyYjMzAzNDA7PC90ZXh0PjwvZz48IS0tbGluayBlMmUgdG8gaW50ZWdyYXRpb24tLT48IS0tbGluayBpbnRlZ3JhdGlvbiB0byB1bml0LS0+PCEtLVNSQz1bVE94VklXOTE1OFZsdm9iRVVyTTREeHczcTNqSzVxanhzWHRRUGNFVHcyQXc2NFYyaVkzOV9ZMmJLOTU2STFPNVF6M0o3Q1YxanNYSk01UVhrLTdtX1VSeGJjSTBrbVh4ZVNpNU9wNWtJTFZ1OE85My1mV2dHejhycWF0SUJ3R3hmM05mNG1TRXlyWWZNODhDdEgzQlBqME9ObXJNNzczQlc0TkNlX1JodExwS3lsMGV3VGpVdE5tX3B0V2s5RmduQXRhYXlaanBWWmx3a1Nuc2k5ZUFScVp0SUpVY255U3ZfckNoeS15QkJqYUhPc2E3NURPM3hkYWVEaHRlRzFKY0xCZHQ4WlJ6V09iODhpSlMzb0g0c3hGUmNibFVtSjA0S2JySVJfUXBRSl9nYS1rN0w0dGdCNnFXTElOTGVPZlkyX01hVWxfTGZxaXNrTS1SOTI3clFhdzd1X1FUUkxLUDJXXy0yZHUxXS0tPjwvZz48L3N2Zz4=" class="uml" alt="uml diagram" title="" /></p>
<hr />
<h2 id="_1">まとめ<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<h3 id="part-vi_1">Part VI で学んだこと<a class="headerlink" href="#part-vi_1" title="Permanent link">&para;</a></h3>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkRFU0NSSVBUSU9OIiBoZWlnaHQ9IjMyMnB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6NjI0cHg7aGVpZ2h0OjMyMnB4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDYyNCAzMjIiIHdpZHRoPSI2MjRweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PGRlZnMvPjxnPjwhLS1jbHVzdGVyIFBhcnQgVkk6ID8/Pz8/Pz8/Pz8/Py0tPjxnIGNsYXNzPSJjbHVzdGVyIiBkYXRhLWVudGl0eT0iUGFydCBWSS4gLi4uLi4uLi4uLi4uIiBkYXRhLXNvdXJjZS1saW5lPSIzIiBkYXRhLXVpZD0iZW50MDAwMiIgaWQ9ImNsdXN0ZXJfUGFydCBWSS4gLi4uLi4uLi4uLi4uIj48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjMwNC44OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjYwNiIgeD0iMTIiIHk9IjEyIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjIzMi42OTQ2IiB4PSIxOTguNjUyNyIgeT0iMjYuOTk1MSI+UGFydCBWSTogJiMyMzQ1NTsmIzM2MzQxOyYjMzAzNDA7JiMxMjM5NDsmIzEyNDUwOyYjMTI1MDM7JiMxMjUyMjsmIzEyNDY1OyYjMTI1NDA7JiMxMjQ3MTsmIzEyNTE5OyYjMTI1MzE7PC90ZXh0PjwvZz48IS0tY2x1c3RlciBjaDEyLS0+PGcgY2xhc3M9ImNsdXN0ZXIiIGRhdGEtZW50aXR5PSJjaDEyIiBkYXRhLXNvdXJjZS1saW5lPSI0IiBkYXRhLXVpZD0iZW50MDAwMyIgaWQ9ImNsdXN0ZXJfY2gxMiI+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgaGVpZ2h0PSIyMzcuODkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSI1NTgiIHg9IjM2IiB5PSI1NSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0Ny40ODIzIiB4PSIyOTEuMjU4OSIgeT0iNjkuOTk1MSI+JiMzMTUzMjsxMiYjMzE0NTY7PC90ZXh0PjwvZz48IS0tZW50aXR5ID8/Pz8/Pz8/Py0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSIuLi4uLi4uLi4iIGRhdGEtc291cmNlLWxpbmU9IjUiIGRhdGEtdWlkPSJlbnQwMDA0IiBpZD0iZW50aXR5Xy4uLi4uLi4uLiI+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgaGVpZ2h0PSIyMi4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iMTQ1Ljk5OTUiIHg9IjUyIiB5PSI5MCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEyNS45OTk1IiB4PSI2MiIgeT0iMTA1Ljk5NTEiPiYjMTI0ODk7JiMxMjUxMzsmIzEyNDUyOyYjMTI1MzE7JiMxMjUxNDsmIzEyNDg3OyYjMTI1MjM7JiMzNTM3MzsmIzM1MzM2OzwvdGV4dD48L2c+PCEtLWVudGl0eSBEYXRhQWNjZXNzID8/Py0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJEYXRhQWNjZXNzIC4uLiIgZGF0YS1zb3VyY2UtbGluZT0iNiIgZGF0YS11aWQ9ImVudDAwMDUiIGlkPSJlbnRpdHlfRGF0YUFjY2VzcyAuLi4iPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iMjIuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjE0OC4wNTA2IiB4PSIyMzIuOTciIHk9IjkwIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTI4LjA1MDYiIHg9IjI0Mi45NyIgeT0iMTA1Ljk5NTEiPkRhdGFBY2Nlc3MgJiMyNTI3NzsmIzM1OTM3OyYjMjEyNzA7PC90ZXh0PjwvZz48IS0tZW50aXR5IGJyYWNrZXQgPz8/Pz8/LS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9ImJyYWNrZXQgLi4uLi4uIiBkYXRhLXNvdXJjZS1saW5lPSI3IiBkYXRhLXVpZD0iZW50MDAwNiIgaWQ9ImVudGl0eV9icmFja2V0IC4uLi4uLiI+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgaGVpZ2h0PSIyMi4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iMTYxLjU3ODciIHg9IjQxNi4yMSIgeT0iOTAiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNDEuNTc4NyIgeD0iNDI2LjIxIiB5PSIxMDUuOTk1MSI+YnJhY2tldCAmIzEyNTIyOyYjMTI0Nzc7JiMxMjU0MDsmIzEyNDczOyYjMzE2NDk7JiMyOTcwMjs8L3RleHQ+PC9nPjwhLS1lbnRpdHkgSU9SZWYgPz8/Pz8tLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iSU9SZWYgLi4uLi4iIGRhdGEtc291cmNlLWxpbmU9IjgiIGRhdGEtdWlkPSJlbnQwMDA3IiBpZD0iZW50aXR5X0lPUmVmIC4uLi4uIj48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjIyLjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSIxMzIuODY3OSIgeD0iNzUuNTciIHk9IjE3Mi4zIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTEyLjg2NzkiIHg9Ijg1LjU3IiB5PSIxODguMjk1MSI+SU9SZWYgJiMxMjQ2MTsmIzEyNTE1OyYjMTI0ODM7JiMxMjQ3MTsmIzEyNTE3OzwvdGV4dD48L2c+PCEtLWVudGl0eSBTZWFyY2hSZXBvcnQtLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iU2VhcmNoUmVwb3J0IiBkYXRhLXNvdXJjZS1saW5lPSI5IiBkYXRhLXVpZD0iZW50MDAwOCIgaWQ9ImVudGl0eV9TZWFyY2hSZXBvcnQiPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iMjIuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjExNS40NDM0IiB4PSIyNDMuMjgiIHk9IjE3Mi4zIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iOTUuNDQzNCIgeD0iMjUzLjI4IiB5PSIxODguMjk1MSI+U2VhcmNoUmVwb3J0PC90ZXh0PjwvZz48IS0tZW50aXR5IEhTcGVjID8/Pz8/Pz8tLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iSFNwZWMgLi4uLi4uLiIgZGF0YS1zb3VyY2UtbGluZT0iMTAiIGRhdGEtdWlkPSJlbnQwMDA5IiBpZD0iZW50aXR5X0hTcGVjIC4uLi4uLi4iPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iMjIuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjE2Ny4wNjExIiB4PSIzOTMuNDciIHk9IjE3Mi4zIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTQ3LjA2MTEiIHg9IjQwMy40NyIgeT0iMTg4LjI5NTEiPkhTcGVjICYjMTI1MTg7JiMxMjQ5MTsmIzEyNDgzOyYjMTI0ODg7JiMxMjQ4NjsmIzEyNDczOyYjMTI0ODg7PC90ZXh0PjwvZz48IS0tZW50aXR5IFF1aWNrQ2hlY2sgPz8/Pz8/Pz8tLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iUXVpY2tDaGVjayAuLi4uLi4uLiIgZGF0YS1zb3VyY2UtbGluZT0iMTEiIGRhdGEtdWlkPSJlbnQwMDEwIiBpZD0iZW50aXR5X1F1aWNrQ2hlY2sgLi4uLi4uLi4iPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iMjIuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjIxOS4xMDMiIHg9IjUyLjQ1IiB5PSIyNTQuNTkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxOTkuMTAzIiB4PSI2Mi40NSIgeT0iMjcwLjU4NTEiPlF1aWNrQ2hlY2sgJiMxMjUwMzsmIzEyNTI1OyYjMTI0OTc7JiMxMjQ4NjsmIzEyNDUxOyYjMTI0ODY7JiMxMjQ3MzsmIzEyNDg4OzwvdGV4dD48L2c+PCEtLVNSQz1bSk8teklXRDE1OE54Vk9oaGw0NUlzZWFNZmI4SmkxXzdnbmlzbmNMc2gySDV6YWdDRnVLczJaUXduZnpXVlkwNDJPOXZjYWxTVkdwN21PNXFYdGstU3BYdG5PSHVYMTB0UEJxUDExZ0xhU3QzMWVCT2JqaDBSY0tMNWtGN09sUVBGdm5uLXVGSlB3UHg5WWljSkQtU3BmWlVjUU8ySmZVcC1OMU9Ba1UzOW00bzBITU1valBNS2stM09CZldvWlh6aUk0Y010UkVEMlp3ZXdCVjVWXzhYWkhvSkliQzRsWXZkMVVKUjc1enZ4cXpCTE00MWpvMmtMbG1iTy1wX0FSWllTZk01Ry0wcW41Slp1ZFNtYlRscmIxZzVMT25GalI2dHBQaENJZlItQ1BxekhVV0JiRjdyYmhYYVBzSmtlaE1HckdIa0V6anp3czNVYWplQXNaejBXMDBdLS0+PC9nPjwvc3ZnPg==" class="uml" alt="uml diagram" title="" /></p>
<h3 id="scala-haskell">Scala と Haskell の比較<a class="headerlink" href="#scala-haskell" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>概念</th>
<th>Scala</th>
<th>Haskell</th>
</tr>
</thead>
<tbody>
<tr>
<td>インターフェース</td>
<td><code>trait</code></td>
<td><code>data</code> (レコード型)</td>
</tr>
<tr>
<td>値オブジェクト</td>
<td><code>opaque type</code></td>
<td><code>newtype</code></td>
</tr>
<tr>
<td>オプショナル</td>
<td><code>Option[A]</code></td>
<td><code>Maybe a</code></td>
</tr>
<tr>
<td>リソース管理</td>
<td><code>Resource[IO, A]</code></td>
<td><code>bracket</code></td>
</tr>
<tr>
<td>キャッシュ</td>
<td><code>Ref[IO, Map]</code></td>
<td><code>IORef (Map ...)</code></td>
</tr>
<tr>
<td>ユニットテスト</td>
<td>ScalaTest</td>
<td>HSpec</td>
</tr>
<tr>
<td>プロパティテスト</td>
<td>ScalaCheck</td>
<td>QuickCheck</td>
</tr>
<tr>
<td>ジェネレータ</td>
<td><code>Gen[A]</code></td>
<td><code>Arbitrary a</code></td>
</tr>
</tbody>
</table>
<h3 id="_2">キーポイント<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>抽象化の重要性</strong>: レコード型で外部依存を抽象化</li>
<li><strong>bracket でリソース管理</strong>: 安全なリソースの取得と解放</li>
<li><strong>IORef でキャッシュ</strong>: スレッドセーフな状態管理</li>
<li><strong>Either でエラー処理</strong>: 明示的なエラーハンドリング</li>
<li><strong>SearchReport</strong>: テスト可能性と可観測性の向上</li>
<li><strong>スタブ</strong>: 外部依存を差し替えてテスト</li>
<li><strong>プロパティベーステスト</strong>: QuickCheck でランダム入力による不変条件の検証</li>
</ol>
<h3 id="_3">学習の総括<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkRFU0NSSVBUSU9OIiBoZWlnaHQ9IjEwN3B4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6OTA0cHg7aGVpZ2h0OjEwN3B4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDkwNCAxMDciIHdpZHRoPSI5MDRweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PGRlZnMvPjxnPjwhLS1jbHVzdGVyIEZQID8/Pz8/LS0+PGcgY2xhc3M9ImNsdXN0ZXIiIGRhdGEtZW50aXR5PSJGUCAuLi4uLiIgZGF0YS1zb3VyY2UtbGluZT0iNCIgZGF0YS11aWQ9ImVudDAwMDIiIGlkPSJjbHVzdGVyX0ZQIC4uLi4uIj48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9Ijg5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iODg2LjA5IiB4PSIxMiIgeT0iMTIiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iOTQuNjk3OSIgeD0iNDA3LjY5NiIgeT0iMjYuOTk1MSI+RlAgJiMxMjM5ODsmIzIzMzk4OyYjMzI3MjI7JiMxMjQ5NzsmIzEyNDczOzwvdGV4dD48L2c+PCEtLWVudGl0eSBwMS0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJwMSIgZGF0YS1zb3VyY2UtbGluZT0iNSIgZGF0YS11aWQ9ImVudDAwMDMiIGlkPSJlbnRpdHlfcDEiPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iMzguNTkzOCIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjU2Ljg0NTciIHg9IjI4IiB5PSI0Ni43Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMzYuODQ1NyIgeD0iMzgiIHk9IjYyLjY5NTEiPlBhcnQgSTwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyNy45OTk5IiB4PSIzOCIgeT0iNzguOTkyIj4mIzIyNTIyOyYjMzA5OTA7PC90ZXh0PjwvZz48IS0tZW50aXR5IHAyLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9InAyIiBkYXRhLXNvdXJjZS1saW5lPSI2IiBkYXRhLXVpZD0iZW50MDAwNCIgaWQ9ImVudGl0eV9wMiI+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgaGVpZ2h0PSIzOC41OTM4IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iMTQ1Ljk5OTUiIHg9IjE0NC44NSIgeT0iNDYuNyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjQwLjk3NDYiIHg9IjE1NC44NSIgeT0iNjIuNjk1MSI+UGFydCBJSTwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMjUuOTk5NSIgeD0iMTU0Ljg1IiB5PSI3OC45OTIiPiYjMTI0NTI7JiMxMjUxMTsmIzEyNTE3OyYjMTI1NDA7JiMxMjQ3OTsmIzEyNTAyOyYjMTI1MjM7JiMyNTgwNTsmIzIwMzE2OzwvdGV4dD48L2c+PCEtLWVudGl0eSBwMy0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJwMyIgZGF0YS1zb3VyY2UtbGluZT0iNyIgZGF0YS11aWQ9ImVudDAwMDUiIGlkPSJlbnRpdHlfcDMiPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iMzguNTkzOCIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjExNy45OTk2IiB4PSIzNTAuODUiIHk9IjQ2LjciLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0NS4xMDM1IiB4PSIzNjAuODUiIHk9IjYyLjY5NTEiPlBhcnQgSUlJPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijk3Ljk5OTYiIHg9IjM2MC44NSIgeT0iNzguOTkyIj4mIzIyNDExOyYjMTIzOTU7JiMxMjQyNDsmIzEyNDI3OyYjMjM0MzM7JiMyMDg0MDsmIzI0NjE1OzwvdGV4dD48L2c+PCEtLWVudGl0eSBwNC0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJwNCIgZGF0YS1zb3VyY2UtbGluZT0iOCIgZGF0YS11aWQ9ImVudDAwMDYiIGlkPSJlbnRpdHlfcDQiPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iMzguNTkzOCIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjkwLjgyNzEiIHg9IjUyOC44NCIgeT0iNDYuNyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjQ2LjQyMjkiIHg9IjUzOC44NCIgeT0iNjIuNjk1MSI+UGFydCBJVjwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI3MC44MjcxIiB4PSI1MzguODQiIHk9Ijc4Ljk5MiI+SU8vU3RyZWFtPC90ZXh0PjwvZz48IS0tZW50aXR5IHA1LS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9InA1IiBkYXRhLXNvdXJjZS1saW5lPSI5IiBkYXRhLXVpZD0iZW50MDAwNyIgaWQ9ImVudGl0eV9wNSI+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgaGVpZ2h0PSIzOC41OTM4IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iNzUuOTk5OCIgeD0iNjc5LjY3IiB5PSI0Ni43Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNDIuMjkzOSIgeD0iNjg5LjY3IiB5PSI2Mi42OTUxIj5QYXJ0IFY8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNTUuOTk5OCIgeD0iNjg5LjY3IiB5PSI3OC45OTIiPiYjMjAwMDY7JiMzNDg5MjsmIzIwOTY2OyYjMjk3MDI7PC90ZXh0PjwvZz48IS0tZW50aXR5IHA2LS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9InA2IiBkYXRhLXNvdXJjZS1saW5lPSIxMCIgZGF0YS11aWQ9ImVudDAwMDgiIGlkPSJlbnRpdHlfcDYiPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iMzguNTkzOCIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjY2LjQyMjkiIHg9IjgxNS42NyIgeT0iNDYuNyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjQ2LjQyMjkiIHg9IjgyNS42NyIgeT0iNjIuNjk1MSI+UGFydCBWSTwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyNy45OTk5IiB4PSI4MjUuNjciIHk9Ijc4Ljk5MiI+JiMyMzQ1NTsmIzM2MzQxOzwvdGV4dD48L2c+PCEtLWxpbmsgcDEgdG8gcDItLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0icDEiIGRhdGEtZW50aXR5LTI9InAyIiBkYXRhLXNvdXJjZS1saW5lPSIxMyIgZGF0YS11aWQ9ImxuazkiIGlkPSJsaW5rX3AxX3AyIj48cGF0aCBkPSJNODUuMTksNjYgQzEwMS43LDY2IDExNy40Niw2NiAxMzguNTMsNjYiIGZpbGw9Im5vbmUiIGlkPSJwMS10by1wMiIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMwMDAwMDAiIHBvaW50cz0iMTQ0LjUzLDY2LDEzNS41Myw2MiwxMzkuNTMsNjYsMTM1LjUzLDcwLDE0NC41Myw2NiIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjwvZz48IS0tbGluayBwMiB0byBwMy0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJwMiIgZGF0YS1lbnRpdHktMj0icDMiIGRhdGEtc291cmNlLWxpbmU9IjE0IiBkYXRhLXVpZD0ibG5rMTAiIGlkPSJsaW5rX3AyX3AzIj48cGF0aCBkPSJNMjkxLjIyLDY2IEMzMTAuODMsNjYgMzI1LjgxLDY2IDM0NC41Myw2NiIgZmlsbD0ibm9uZSIgaWQ9InAyLXRvLXAzIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzAwMDAwMCIgcG9pbnRzPSIzNTAuNTMsNjYsMzQxLjUzLDYyLDM0NS41Myw2NiwzNDEuNTMsNzAsMzUwLjUzLDY2IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjwhLS1saW5rIHAzIHRvIHA0LS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9InAzIiBkYXRhLWVudGl0eS0yPSJwNCIgZGF0YS1zb3VyY2UtbGluZT0iMTUiIGRhdGEtdWlkPSJsbmsxMSIgaWQ9ImxpbmtfcDNfcDQiPjxwYXRoIGQ9Ik00NjkuMDIsNjYgQzQ4OC41OSw2NiA1MDQuMTEsNjYgNTIyLjQ4LDY2IiBmaWxsPSJub25lIiBpZD0icDMtdG8tcDQiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMDAwMDAwIiBwb2ludHM9IjUyOC40OCw2Niw1MTkuNDgsNjIsNTIzLjQ4LDY2LDUxOS40OCw3MCw1MjguNDgsNjYiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48L2c+PCEtLWxpbmsgcDQgdG8gcDUtLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0icDQiIGRhdGEtZW50aXR5LTI9InA1IiBkYXRhLXNvdXJjZS1saW5lPSIxNiIgZGF0YS11aWQ9ImxuazEyIiBpZD0ibGlua19wNF9wNSI+PHBhdGggZD0iTTYyMCw2NiBDNjM5LjEsNjYgNjU1LjEzLDY2IDY3My4zMyw2NiIgZmlsbD0ibm9uZSIgaWQ9InA0LXRvLXA1IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzAwMDAwMCIgcG9pbnRzPSI2NzkuMzMsNjYsNjcwLjMzLDYyLDY3NC4zMyw2Niw2NzAuMzMsNzAsNjc5LjMzLDY2IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjwhLS1saW5rIHA1IHRvIHA2LS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9InA1IiBkYXRhLWVudGl0eS0yPSJwNiIgZGF0YS1zb3VyY2UtbGluZT0iMTciIGRhdGEtdWlkPSJsbmsxMyIgaWQ9ImxpbmtfcDVfcDYiPjxwYXRoIGQ9Ik03NTYuMDUsNjYgQzc3NC44Myw2NiA3OTEuMzcsNjYgODA5LjQyLDY2IiBmaWxsPSJub25lIiBpZD0icDUtdG8tcDYiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMDAwMDAwIiBwb2ludHM9IjgxNS40Miw2Niw4MDYuNDIsNjIsODEwLjQyLDY2LDgwNi40Miw3MCw4MTUuNDIsNjYiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48L2c+PCEtLVNSQz1bTE93eElXRDE1NDN4LU9oaHphNkl0S3JmQVFHbzg1WWI2UDhuTVRYQ1hkNHc0U21DbGVZQTN4MEk1bzVrWEUxc3VXQ2I3dENwc05uNmlhb0p4R3dTU256UmdpVnczNEhDOHF2WVRnWDAzSzE2dFB3MkpZSFBNcUszSmFXMWI3VFoxanZrNHQyT3NPeXFkcHNXa0tWenV5NG5RTEZQMFF6OWZPOTZZemxhRG5fVlVhMkZHNUhCUllySFp6NGFRRHhHX0E2VWVOYjJDcnF5dGlwX2R6cjRoSm5IeDdpUHVOMkEtWEJybzZQTnprbnpTSmZuaUwtQTNyZ3lpUlV6aG9JWlZVVTNKUl9NeS16cS1OZmpCekJ5eGptTE9RYWVoY045eWtsSm9KZXY4S0hLZUxCUEFIdUpES1MtNFJ3Wlc4WjBLS1g0d0FZLTBXMDBdLS0+PC9nPjwvc3ZnPg==" class="uml" alt="uml diagram" title="" /></p>
<hr />
<h2 id="_4">演習問題<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h2>
<h3 id="1-dataaccess">問題 1: DataAccess の拡張<a class="headerlink" href="#1-dataaccess" title="Permanent link">&para;</a></h3>
<p>以下の要件で <code>DataAccess</code> を拡張してください:
- 新しいフィールド <code>findHotelsNearLocation</code> を追加
- 戻り値は <code>IO (Either String [Hotel])</code></p>
<div class="highlight"><pre><span></span><code><span class="kr">data</span><span class="w"> </span><span class="kt">Hotel</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">Hotel</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="n">hotelName</span><span class="w">     </span><span class="ow">::</span><span class="w"> </span><span class="kt">String</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">hotelRating</span><span class="w">   </span><span class="ow">::</span><span class="w"> </span><span class="kt">Double</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">hotelLocation</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Location</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="kr">deriving</span><span class="w"> </span><span class="p">(</span><span class="kt">Show</span><span class="p">,</span><span class="w"> </span><span class="kt">Eq</span><span class="p">)</span>
</code></pre></div>
<details>
<summary>解答</summary>

<div class="highlight"><pre><span></span><code><span class="kr">data</span><span class="w"> </span><span class="kt">DataAccess</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">DataAccess</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="n">findAttractions</span><span class="w">         </span><span class="ow">::</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">AttractionOrdering</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">IO</span><span class="w"> </span><span class="p">[</span><span class="kt">Attraction</span><span class="p">]</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">findArtistsFromLocation</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">LocationId</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">IO</span><span class="w"> </span><span class="p">(</span><span class="kt">Either</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="p">[</span><span class="kt">MusicArtist</span><span class="p">])</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">findMoviesAboutLocation</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">LocationId</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">IO</span><span class="w"> </span><span class="p">(</span><span class="kt">Either</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="p">[</span><span class="kt">Movie</span><span class="p">])</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">findHotelsNearLocation</span><span class="w">  </span><span class="ow">::</span><span class="w"> </span><span class="kt">LocationId</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">IO</span><span class="w"> </span><span class="p">(</span><span class="kt">Either</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="p">[</span><span class="kt">Hotel</span><span class="p">])</span>
<span class="w">    </span><span class="p">}</span>

<span class="c1">-- テスト用スタブ</span>
<span class="nf">mkTestDataAccess</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">IO</span><span class="w"> </span><span class="kt">DataAccess</span>
<span class="nf">mkTestDataAccess</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">return</span><span class="w"> </span><span class="kt">DataAccess</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="c1">-- 既存の実装...</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">findHotelsNearLocation</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="nf">\</span><span class="kr">_</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="ow">-&gt;</span>
<span class="w">        </span><span class="n">return</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="kt">Right</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="n">take</span><span class="w"> </span><span class="n">limit</span>
<span class="w">            </span><span class="p">[</span><span class="kt">Hotel</span><span class="w"> </span><span class="s">&quot;Test Hotel&quot;</span><span class="w"> </span><span class="mf">4.5</span><span class="w"> </span><span class="p">(</span><span class="kt">Location</span><span class="w"> </span><span class="p">(</span><span class="kt">LocationId</span><span class="w"> </span><span class="s">&quot;Q123&quot;</span><span class="p">)</span><span class="w"> </span><span class="s">&quot;Test City&quot;</span><span class="w"> </span><span class="mi">100000</span><span class="p">)]</span>
<span class="w">    </span><span class="p">}</span>
</code></pre></div>

</details>

<h3 id="2">問題 2: プロパティベーステスト<a class="headerlink" href="#2" title="Permanent link">&para;</a></h3>
<p>以下の関数に対するプロパティベーステストを書いてください:</p>
<div class="highlight"><pre><span></span><code><span class="nf">combineSubjects</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="p">[</span><span class="kt">MusicArtist</span><span class="p">]</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="p">[</span><span class="kt">Movie</span><span class="p">]</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="p">[</span><span class="kt">String</span><span class="p">]</span>
<span class="nf">combineSubjects</span><span class="w"> </span><span class="n">artists</span><span class="w"> </span><span class="n">movies</span><span class="w"> </span><span class="ow">=</span>
<span class="w">    </span><span class="n">map</span><span class="w"> </span><span class="n">artistName</span><span class="w"> </span><span class="n">artists</span><span class="w"> </span><span class="o">++</span><span class="w"> </span><span class="n">map</span><span class="w"> </span><span class="n">movieName</span><span class="w"> </span><span class="n">movies</span>
</code></pre></div>
<details>
<summary>解答</summary>

<div class="highlight"><pre><span></span><code><span class="kr">import</span><span class="w"> </span><span class="nn">Test.QuickCheck</span>

<span class="kr">instance</span><span class="w"> </span><span class="kt">Arbitrary</span><span class="w"> </span><span class="kt">MusicArtist</span><span class="w"> </span><span class="kr">where</span>
<span class="w">    </span><span class="n">arbitrary</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">MusicArtist</span><span class="w"> </span><span class="o">&lt;$&gt;</span><span class="w"> </span><span class="n">listOf1</span><span class="w"> </span><span class="p">(</span><span class="n">elements</span><span class="w"> </span><span class="p">[</span><span class="sc">&#39;A&#39;</span><span class="o">..</span><span class="sc">&#39;Z&#39;</span><span class="p">])</span>

<span class="kr">instance</span><span class="w"> </span><span class="kt">Arbitrary</span><span class="w"> </span><span class="kt">Movie</span><span class="w"> </span><span class="kr">where</span>
<span class="w">    </span><span class="n">arbitrary</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">Movie</span><span class="w"> </span><span class="o">&lt;$&gt;</span><span class="w"> </span><span class="n">listOf1</span><span class="w"> </span><span class="p">(</span><span class="n">elements</span><span class="w"> </span><span class="p">[</span><span class="sc">&#39;A&#39;</span><span class="o">..</span><span class="sc">&#39;Z&#39;</span><span class="p">])</span>

<span class="nf">spec</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Spec</span>
<span class="nf">spec</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kr">do</span>
<span class="w">    </span><span class="n">describe</span><span class="w"> </span><span class="s">&quot;combineSubjects properties&quot;</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="kr">do</span>
<span class="w">        </span><span class="n">it</span><span class="w"> </span><span class="s">&quot;length is sum of inputs&quot;</span><span class="w"> </span><span class="o">$</span>
<span class="w">            </span><span class="n">property</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="nf">\</span><span class="p">(</span><span class="n">artists</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="p">[</span><span class="kt">MusicArtist</span><span class="p">])</span><span class="w"> </span><span class="p">(</span><span class="n">movies</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="p">[</span><span class="kt">Movie</span><span class="p">])</span><span class="w"> </span><span class="ow">-&gt;</span>
<span class="w">                </span><span class="n">length</span><span class="w"> </span><span class="p">(</span><span class="n">combineSubjects</span><span class="w"> </span><span class="n">artists</span><span class="w"> </span><span class="n">movies</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="n">artists</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="n">movies</span>

<span class="w">        </span><span class="n">it</span><span class="w"> </span><span class="s">&quot;artists come first&quot;</span><span class="w"> </span><span class="o">$</span>
<span class="w">            </span><span class="n">property</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="nf">\</span><span class="p">(</span><span class="n">artists</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="p">[</span><span class="kt">MusicArtist</span><span class="p">])</span><span class="w"> </span><span class="p">(</span><span class="n">movies</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="p">[</span><span class="kt">Movie</span><span class="p">])</span><span class="w"> </span><span class="ow">-&gt;</span>
<span class="w">                </span><span class="kr">let</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">combineSubjects</span><span class="w"> </span><span class="n">artists</span><span class="w"> </span><span class="n">movies</span>
<span class="w">                    </span><span class="n">artistNames</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">map</span><span class="w"> </span><span class="n">artistName</span><span class="w"> </span><span class="n">artists</span>
<span class="w">                </span><span class="kr">in</span><span class="w"> </span><span class="n">take</span><span class="w"> </span><span class="p">(</span><span class="n">length</span><span class="w"> </span><span class="n">artists</span><span class="p">)</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">artistNames</span>

<span class="w">        </span><span class="n">it</span><span class="w"> </span><span class="s">&quot;movies come after artists&quot;</span><span class="w"> </span><span class="o">$</span>
<span class="w">            </span><span class="n">property</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="nf">\</span><span class="p">(</span><span class="n">artists</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="p">[</span><span class="kt">MusicArtist</span><span class="p">])</span><span class="w"> </span><span class="p">(</span><span class="n">movies</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="p">[</span><span class="kt">Movie</span><span class="p">])</span><span class="w"> </span><span class="ow">-&gt;</span>
<span class="w">                </span><span class="kr">let</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">combineSubjects</span><span class="w"> </span><span class="n">artists</span><span class="w"> </span><span class="n">movies</span>
<span class="w">                    </span><span class="n">movieNames</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">map</span><span class="w"> </span><span class="n">movieName</span><span class="w"> </span><span class="n">movies</span>
<span class="w">                </span><span class="kr">in</span><span class="w"> </span><span class="n">drop</span><span class="w"> </span><span class="p">(</span><span class="n">length</span><span class="w"> </span><span class="n">artists</span><span class="p">)</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">movieNames</span>
</code></pre></div>

</details>

<h3 id="3-bracket">問題 3: bracket の実装<a class="headerlink" href="#3-bracket" title="Permanent link">&para;</a></h3>
<p>データベース接続を安全に管理する関数を実装してください。</p>
<div class="highlight"><pre><span></span><code><span class="kr">data</span><span class="w"> </span><span class="kt">Connection</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">Connection</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">connId</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="p">}</span>

<span class="c1">-- 実装してください</span>
<span class="nf">withConnection</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">IO</span><span class="w"> </span><span class="kt">Connection</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="kt">Connection</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">IO</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">IO</span><span class="w"> </span><span class="n">a</span>
</code></pre></div>
<details>
<summary>解答</summary>

<div class="highlight"><pre><span></span><code><span class="kr">import</span><span class="w"> </span><span class="nn">Control.Exception</span><span class="w"> </span><span class="p">(</span><span class="nf">bracket</span><span class="p">)</span>

<span class="kr">data</span><span class="w"> </span><span class="kt">Connection</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kt">Connection</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">connId</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="p">}</span>

<span class="c1">-- 接続を開く</span>
<span class="nf">openConnection</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">IO</span><span class="w"> </span><span class="kt">Connection</span>
<span class="nf">openConnection</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="kr">do</span>
<span class="w">    </span><span class="n">putStrLn</span><span class="w"> </span><span class="s">&quot;Opening connection...&quot;</span>
<span class="w">    </span><span class="n">return</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="kt">Connection</span><span class="w"> </span><span class="mi">1</span>

<span class="c1">-- 接続を閉じる</span>
<span class="nf">closeConnection</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">Connection</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">IO</span><span class="w"> </span><span class="nb">()</span>
<span class="nf">closeConnection</span><span class="w"> </span><span class="n">conn</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">putStrLn</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="s">&quot;Closing connection &quot;</span><span class="w"> </span><span class="o">++</span><span class="w"> </span><span class="n">show</span><span class="w"> </span><span class="p">(</span><span class="n">connId</span><span class="w"> </span><span class="n">conn</span><span class="p">)</span>

<span class="c1">-- 安全に接続を使用</span>
<span class="nf">withConnection</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="p">(</span><span class="kt">Connection</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">IO</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kt">IO</span><span class="w"> </span><span class="n">a</span>
<span class="nf">withConnection</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">bracket</span><span class="w"> </span><span class="n">openConnection</span><span class="w"> </span><span class="n">closeConnection</span>

<span class="c1">-- 使用例</span>
<span class="nf">queryDatabase</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="kt">IO</span><span class="w"> </span><span class="kt">String</span>
<span class="nf">queryDatabase</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">withConnection</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="nf">\</span><span class="n">conn</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="kr">do</span>
<span class="w">    </span><span class="n">putStrLn</span><span class="w"> </span><span class="o">$</span><span class="w"> </span><span class="s">&quot;Querying with connection &quot;</span><span class="w"> </span><span class="o">++</span><span class="w"> </span><span class="n">show</span><span class="w"> </span><span class="p">(</span><span class="n">connId</span><span class="w"> </span><span class="n">conn</span><span class="p">)</span>
<span class="w">    </span><span class="n">return</span><span class="w"> </span><span class="s">&quot;Query result&quot;</span>
</code></pre></div>

</details>

<h3 id="4">問題 4: エラー収集<a class="headerlink" href="#4" title="Permanent link">&para;</a></h3>
<p>複数の <code>Either</code> からエラーを収集する関数を実装してください。</p>
<div class="highlight"><pre><span></span><code><span class="nf">collectAllErrors</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="p">[</span><span class="kt">Either</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="p">[</span><span class="kt">String</span><span class="p">]</span>
<span class="nf">collectAllErrors</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="o">???</span>
</code></pre></div>
<details>
<summary>解答</summary>

<div class="highlight"><pre><span></span><code><span class="nf">collectAllErrors</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="p">[</span><span class="kt">Either</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="p">[</span><span class="kt">String</span><span class="p">]</span>
<span class="nf">collectAllErrors</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">foldr</span><span class="w"> </span><span class="n">collect</span><span class="w"> </span><span class="kt">[]</span>
<span class="w">  </span><span class="kr">where</span>
<span class="w">    </span><span class="n">collect</span><span class="w"> </span><span class="p">(</span><span class="kt">Left</span><span class="w"> </span><span class="n">err</span><span class="p">)</span><span class="w"> </span><span class="n">acc</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">err</span><span class="w"> </span><span class="kt">:</span><span class="w"> </span><span class="n">acc</span>
<span class="w">    </span><span class="n">collect</span><span class="w"> </span><span class="p">(</span><span class="kt">Right</span><span class="w"> </span><span class="kr">_</span><span class="p">)</span><span class="w"> </span><span class="n">acc</span><span class="w">  </span><span class="ow">=</span><span class="w"> </span><span class="n">acc</span>

<span class="c1">-- または</span>
<span class="nf">collectAllErrors</span><span class="w"> </span><span class="ow">::</span><span class="w"> </span><span class="p">[</span><span class="kt">Either</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="ow">-&gt;</span><span class="w"> </span><span class="p">[</span><span class="kt">String</span><span class="p">]</span>
<span class="nf">collectAllErrors</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="p">[</span><span class="n">err</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kt">Left</span><span class="w"> </span><span class="n">err</span><span class="w"> </span><span class="ow">&lt;-</span><span class="w"> </span><span class="n">results</span><span class="p">]</span>

<span class="c1">-- テスト</span>
<span class="c1">-- collectAllErrors [Right 1, Left &quot;Error1&quot;, Right 2, Left &quot;Error2&quot;]</span>
<span class="c1">-- =&gt; [&quot;Error1&quot;, &quot;Error2&quot;]</span>
</code></pre></div>

</details>

<hr />
<h2 id="_5">シリーズ全体の総括<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h2>
<p>本シリーズでは、「Grokking Functional Programming」の内容に沿って、Haskell で関数型プログラミングの基礎から実践的なアプリケーション構築までを学びました。</p>
<h3 id="_6">学んだ主な概念<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Part</th>
<th>章</th>
<th>主な概念</th>
</tr>
</thead>
<tbody>
<tr>
<td>I</td>
<td>1-2</td>
<td>純粋関数、参照透過性、型推論</td>
</tr>
<tr>
<td>II</td>
<td>3-5</td>
<td>イミュータブルデータ、高階関数、do 記法</td>
</tr>
<tr>
<td>III</td>
<td>6-7</td>
<td>Maybe、Either、パターンマッチング</td>
</tr>
<tr>
<td>IV</td>
<td>8-9</td>
<td>IO モナド、遅延リスト（無限ストリーム）</td>
</tr>
<tr>
<td>V</td>
<td>10-11</td>
<td>並行処理、IORef、Async、STM</td>
</tr>
<tr>
<td>VI</td>
<td>12</td>
<td>実践アプリケーション、テスト戦略</td>
</tr>
</tbody>
</table>
<h3 id="haskell">Haskell の関数型プログラミングの利点<a class="headerlink" href="#haskell" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>純粋性の保証</strong>: 型システムが純粋関数と IO を分離</li>
<li><strong>遅延評価</strong>: 無限リストが自然に扱える</li>
<li><strong>強力な型システム</strong>: newtype、ADT で安全なモデリング</li>
<li><strong>STM</strong>: デッドロックフリーな並行処理</li>
<li><strong>QuickCheck</strong>: プロパティベーステストの先駆者</li>
</ol>
<h3 id="_7">次のステップ<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<ul>
<li>Monad Transformers（モナドトランスフォーマー）を学ぶ</li>
<li>lens ライブラリでデータ操作を効率化</li>
<li>servant で型安全な Web API を構築</li>
<li>実際のプロジェクトで Haskell を適用する</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
    <a href="https://github.com/k2works" target="_blank" rel="noopener" title="GitHub Repository/claude-code-booster" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate", "search.suggest", "search.highlight"], "search": "../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
      
        <script src="../../docs/assets/js/extra.js"></script>
      
    
  </body>
</html>