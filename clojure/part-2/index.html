
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Scala、Java、F#、C#、Haskell、Clojure、Elixir で学ぶ関数型プログラミング">
      
      
        <meta name="author" content="Project Team">
      
      
      
        <link rel="prev" href="../part-1/">
      
      
        <link rel="next" href="../part-3/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Part II - 関数型スタイル - Grokking Functional Programming</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../docs/mkdocs/assets/css/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#part-ii-clojure" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Grokking Functional Programming" class="md-header__button md-logo" aria-label="Grokking Functional Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Grokking Functional Programming
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Part II - 関数型スタイル
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/k2works/grokkingfp-excersice" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    grokkingfp-excersice
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../scala/" class="md-tabs__link">
          
  
  
  Scala

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../java/" class="md-tabs__link">
          
  
  
  Java

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../fsharp/" class="md-tabs__link">
          
  
  
  F#

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../csharp/" class="md-tabs__link">
          
  
  
  C#

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../haskell/" class="md-tabs__link">
          
  
  
  Haskell

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
  Clojure

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../elixir/" class="md-tabs__link">
          
  
  
  Elixir

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Grokking Functional Programming" class="md-nav__button md-logo" aria-label="Grokking Functional Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Grokking Functional Programming
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/k2works/grokkingfp-excersice" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    grokkingfp-excersice
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Scala
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Scala
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scala/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概要
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scala/part-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part I - 基礎
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scala/part-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part II - 関数型スタイル
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scala/part-3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part III - エラーハンドリング
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scala/part-4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part IV - IO と副作用
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scala/part-5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part V - 並行処理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scala/part-6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part VI - 実践
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Java
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Java
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../java/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概要
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../java/part-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part I - 基礎
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../java/part-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part II - 関数型スタイル
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../java/part-3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part III - エラーハンドリング
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../java/part-4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part IV - IO と副作用
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../java/part-5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part V - 並行処理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../java/part-6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part VI - 実践
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    F#
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    F#
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fsharp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概要
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fsharp/part-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part I - 基礎
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fsharp/part-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part II - 関数型スタイル
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fsharp/part-3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part III - エラーハンドリング
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fsharp/part-4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part IV - 非同期処理とストリーム
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fsharp/part-5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part V - 並行処理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fsharp/part-6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part VI - 実践
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    C#
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    C#
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csharp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概要
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csharp/part-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part I - 基礎
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csharp/part-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part II - 関数型スタイル
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csharp/part-3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part III - エラーハンドリング
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csharp/part-4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part IV - 非同期処理とストリーム
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csharp/part-5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part V - 並行処理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csharp/part-6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part VI - 実践
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Haskell
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Haskell
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../haskell/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概要
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../haskell/part-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part I - 基礎
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../haskell/part-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part II - 関数型スタイル
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../haskell/part-3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part III - エラーハンドリング
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../haskell/part-4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part IV - IO とストリーム
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../haskell/part-5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part V - 並行処理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../haskell/part-6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part VI - 実践
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Clojure
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Clojure
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概要
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../part-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part I - 基礎
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Part II - 関数型スタイル
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Part II - 関数型スタイル
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      
        第3章: イミュータブルなデータ操作
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第3章: イミュータブルなデータ操作">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1 イミュータブルとは
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2 永続データ構造
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.3 ベクターの基本操作
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.4 リスト変換パターン
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#35" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.5 旅程の再計画
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#36" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.6 マップの操作
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    <span class="md-ellipsis">
      
        第4章: 関数を値として扱う
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第4章: 関数を値として扱う">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.1 高階関数とは
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-map-" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.2 map - 各要素を変換
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-filter-" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.3 filter - 条件に合う要素を抽出
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-reduce-" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.4 reduce - 畳み込み
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#45-sort-by-" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.5 sort-by - ソート基準を関数で指定
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#46" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.6 関数を返す関数
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#47-partial" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.7 部分適用（partial）
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#48-comp" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.8 関数合成（comp）
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#49" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.9 スレッディングマクロ
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#410" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.10 ワードスコアリングの例
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-mapcat" class="md-nav__link">
    <span class="md-ellipsis">
      
        第5章: mapcat とネスト構造
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第5章: mapcat とネスト構造">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-flatten-" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.1 flatten - ネストを平坦化
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-mapcat-map-concat" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.2 mapcat = map + concat
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-mapcat" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.3 mapcat によるサイズ変化
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#54-mapcat" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.4 ネストした mapcat
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#55-for" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.5 for 内包表記
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#56-when" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.6 ガード式（:when）
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#57" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.7 円内の点の判定
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#58-for" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.8 for と型
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#59" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.9 実践例：商品検索
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        まとめ
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="まとめ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#part-ii" class="md-nav__link">
    <span class="md-ellipsis">
      
        Part II で学んだこと
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scala" class="md-nav__link">
    <span class="md-ellipsis">
      
        Scala との比較
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        キーポイント
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        次のステップ
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../part-3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part III - nil 安全性
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../part-4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part IV - 副作用とシーケンス
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../part-5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part V - 並行処理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../part-6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part VI - 実践
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Elixir
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Elixir
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../elixir/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概要
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../elixir/part-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part I - 基礎
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../elixir/part-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part II - 関数型スタイル
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../elixir/part-3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part III - エラーハンドリング
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../elixir/part-4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part IV - IO とストリーム
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../elixir/part-5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part V - 並行処理と OTP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../elixir/part-6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Part VI - 実践
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="part-ii-clojure">Part II: 関数型スタイルのプログラミング（Clojure 版）<a class="headerlink" href="#part-ii-clojure" title="Permanent link">&para;</a></h1>
<p>本章では、関数型プログラミングの核心となるテクニックを学びます。イミュータブルなデータ操作、高階関数、そして <code>mapcat</code> による複雑なデータ変換を習得します。</p>
<hr />
<h2 id="3">第3章: イミュータブルなデータ操作<a class="headerlink" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 イミュータブルとは<a class="headerlink" href="#31" title="Permanent link">&para;</a></h3>
<p>イミュータブル（不変）とは、一度作成されたデータが変更されないことを意味します。Clojure のデータ構造はデフォルトでイミュータブルです。</p>
<div class="highlight"><pre><span></span><code><span class="c1">;; 元のベクター</span>
<span class="p">(</span><span class="k">def </span><span class="nv">original</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">])</span>

<span class="c1">;; conj で要素を追加しても元のベクターは変わらない</span>
<span class="p">(</span><span class="k">def </span><span class="nv">new-vec</span><span class="w"> </span><span class="p">(</span><span class="nb">conj </span><span class="nv">original</span><span class="w"> </span><span class="mi">4</span><span class="p">))</span>

<span class="nv">original</span><span class="w">  </span><span class="c1">; =&gt; [1 2 3]</span>
<span class="nv">new-vec</span><span class="w">   </span><span class="c1">; =&gt; [1 2 3 4]</span>
</code></pre></div>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkRFU0NSSVBUSU9OIiBoZWlnaHQ9IjMwNnB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6NDI2cHg7aGVpZ2h0OjMwNnB4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDQyNiAzMDYiIHdpZHRoPSI0MjZweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PGRlZnMvPjxnPjwhLS1jbHVzdGVyIG11dC0tPjxnIGNsYXNzPSJjbHVzdGVyIiBkYXRhLWVudGl0eT0ibXV0IiBkYXRhLXNvdXJjZS1saW5lPSIzIiBkYXRhLXVpZD0iZW50MDAwMiIgaWQ9ImNsdXN0ZXJfbXV0Ij48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjI4MC4wNCIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjE4NiIgeD0iMTIiIHk9IjEyIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEzOS45OTk0IiB4PSIzNS4wMDAzIiB5PSIyNi45OTUxIj4mIzEyNTExOyYjMTI1MTc7JiMxMjU0MDsmIzEyNDc5OyYjMTI1MDI7JiMxMjUyMzsmIzY1Mjg4OyYjMjE0ODc7JiMyMjc5MzsmIzY1Mjg5OzwvdGV4dD48L2c+PCEtLWNsdXN0ZXIgaW1tdXQtLT48ZyBjbGFzcz0iY2x1c3RlciIgZGF0YS1lbnRpdHk9ImltbXV0IiBkYXRhLXNvdXJjZS1saW5lPSIxMSIgZGF0YS11aWQ9ImVudDAwMDgiIGlkPSJjbHVzdGVyX2ltbXV0Ij48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjI4OC4xOSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjE5OCIgeD0iMjIyIiB5PSIxMiIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNTMuOTk5MyIgeD0iMjQ0LjAwMDMiIHk9IjI2Ljk5NTEiPiYjMTI0NTI7JiMxMjUxMTsmIzEyNTE3OyYjMTI1NDA7JiMxMjQ3OTsmIzEyNTAyOyYjMTI1MjM7JiM2NTI4ODsmIzE5OTgxOyYjMjI3OTM7JiM2NTI4OTs8L3RleHQ+PC9nPjwhLS1lbnRpdHkgbTEtLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0ibTEiIGRhdGEtc291cmNlLWxpbmU9IjQiIGRhdGEtdWlkPSJlbnQwMDAzIiBpZD0iZW50aXR5X20xIj48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjIyLjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSIxMDAuMTk5MiIgeD0iMjcuOSIgeT0iNDciLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI4MC4xOTkyIiB4PSIzNy45IiB5PSI2Mi45OTUxIj5saXN0ID0gW0EsIEJdPC90ZXh0PjwvZz48IS0tZW50aXR5IG0yLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9Im0yIiBkYXRhLXNvdXJjZS1saW5lPSI1IiBkYXRhLXVpZD0iZW50MDAwNCIgaWQ9ImVudGl0eV9tMiI+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgaGVpZ2h0PSIyMi4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iOTIuMDY0NSIgeD0iMjkuOTciIHk9IjE0Ni4zIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNzIuMDY0NSIgeD0iMzkuOTciIHk9IjE2Mi4yOTUxIj5saXN0LmFkZChDKTwvdGV4dD48L2c+PCEtLWVudGl0eSBtMy0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJtMyIgZGF0YS1zb3VyY2UtbGluZT0iNiIgZGF0YS11aWQ9ImVudDAwMDUiIGlkPSJlbnRpdHlfbTMiPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iMjIuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjExOC44NzUiIHg9IjI3LjU2IiB5PSIyNTMuNzQiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5OC44NzUiIHg9IjM3LjU2IiB5PSIyNjkuNzM1MSI+bGlzdCA9IFtBLCBCLCBDXTwvdGV4dD48L2c+PCEtLWVudGl0eSBpMS0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJpMSIgZGF0YS1zb3VyY2UtbGluZT0iMTIiIGRhdGEtdWlkPSJlbnQwMDA5IiBpZD0iZW50aXR5X2kxIj48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjIyLjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSIxMTMuMTM5NiIgeD0iMjY0LjQzIiB5PSI0NyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjkzLjEzOTYiIHg9IjI3NC40MyIgeT0iNjIuOTk1MSI+dmVjMSA9IFtBLCBCXTwvdGV4dD48L2c+PCEtLWVudGl0eSBpMi0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJpMiIgZGF0YS1zb3VyY2UtbGluZT0iMTMiIGRhdGEtdWlkPSJlbnQwMDEwIiBpZD0iZW50aXR5X2kyIj48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjIyLjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSIxNjYuMjYxNyIgeD0iMjM3Ljg3IiB5PSIxNDYuMyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE0Ni4yNjE3IiB4PSIyNDcuODciIHk9IjE2Mi4yOTUxIj52ZWMyID0gKGNvbmogdmVjMSBDKTwvdGV4dD48L2c+PCEtLWVudGl0eSBpMy0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJpMyIgZGF0YS1zb3VyY2UtbGluZT0iMTQiIGRhdGEtdWlkPSJlbnQwMDExIiBpZD0iZW50aXR5X2kzIj48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjM4LjU5MzgiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSIxMzEuODE1NCIgeD0iMjU1LjA5IiB5PSIyNDUuNiIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjkzLjEzOTYiIHg9IjI2NS4wOSIgeT0iMjYxLjU5NTEiPnZlYzEgPSBbQSwgQl08L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTExLjgxNTQiIHg9IjI2NS4wOSIgeT0iMjc3Ljg5MiI+dmVjMiA9IFtBLCBCLCBDXTwvdGV4dD48L2c+PCEtLWxpbmsgbTEgdG8gbTItLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0ibTEiIGRhdGEtZW50aXR5LTI9Im0yIiBkYXRhLXNvdXJjZS1saW5lPSI3IiBkYXRhLXVpZD0ibG5rNiIgaWQ9ImxpbmtfbTFfbTIiPjxwYXRoIGQ9Ik03Ny43OSw2OS41NiBDNzcuNCw4OC4xOSA3Ni43MjEzLDEyMS4wMzEyIDc2LjM0MTMsMTM5LjgyMTIiIGZpbGw9Im5vbmUiIGlkPSJtMS10by1tMiIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMwMDAwMDAiIHBvaW50cz0iNzYuMjIsMTQ1LjgyLDgwLjQwMTIsMTM2LjkwMjcsNzYuMzIxMSwxNDAuODIxLDcyLjQwMjgsMTM2Ljc0MSw3Ni4yMiwxNDUuODIiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyNiIgeD0iNzguMTIiIHk9IjExMi4zNjY5Ij4mIzIyNzkzOyYjMjYzNTY7PC90ZXh0PjwvZz48IS0tbGluayBtMiB0byBtMy0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJtMiIgZGF0YS1lbnRpdHktMj0ibTMiIGRhdGEtc291cmNlLWxpbmU9IjgiIGRhdGEtdWlkPSJsbms3IiBpZD0ibGlua19tMl9tMyI+PHBhdGggZD0iTTc3LjA5LDE2OC45NCBDNzkuMiwxODkuMTYgODMuMTc2LDIyNy4yOTI1IDg1LjI4NiwyNDcuNDcyNSIgZmlsbD0ibm9uZSIgaWQ9Im0yLXRvLW0zIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzAwMDAwMCIgcG9pbnRzPSI4NS45MSwyNTMuNDQsODguOTUyNCwyNDQuMDcyOCw4NS4zOSwyNDguNDY3MSw4MC45OTU4LDI0NC45MDQ4LDg1LjkxLDI1My40NCIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjExNy4wMDAxIiB4PSI4Mi44MyIgeT0iMjExLjY2NjkiPiYjMjE1MTY7JiMxMjM3NjsmIzEyNTIyOyYjMTI0NzM7JiMxMjQ4ODsmIzEyMzY0OyYjMjI3OTM7JiMxMjQzMTsmIzEyNDI3OzwvdGV4dD48L2c+PCEtLWxpbmsgaTEgdG8gaTItLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iaTEiIGRhdGEtZW50aXR5LTI9ImkyIiBkYXRhLXNvdXJjZS1saW5lPSIxNSIgZGF0YS11aWQ9ImxuazEyIiBpZD0ibGlua19pMV9pMiI+PHBhdGggZD0iTTMyMSw2OS41NiBDMzIxLDg4LjE5IDMyMSwxMjEuMDMgMzIxLDEzOS44MiIgZmlsbD0ibm9uZSIgaWQ9ImkxLXRvLWkyIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzAwMDAwMCIgcG9pbnRzPSIzMjEsMTQ1LjgyLDMyNSwxMzYuODIsMzIxLDE0MC44MiwzMTcsMTM2LjgyLDMyMSwxNDUuODIiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1Mi4wMDAxIiB4PSIzMjIiIHk9IjExMi4zNjY5Ij4mIzI2MDMyOyYjMzUyMTU7JiMyMDMxNjsmIzI1MTA0OzwvdGV4dD48L2c+PCEtLWxpbmsgaTIgdG8gaTMtLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iaTIiIGRhdGEtZW50aXR5LTI9ImkzIiBkYXRhLXNvdXJjZS1saW5lPSIxNiIgZGF0YS11aWQ9ImxuazEzIiBpZD0ibGlua19pMl9pMyI+PHBhdGggZD0iTTMyMSwxNjguOTQgQzMyMSwxODYuNzYgMzIxLDIxNy4xNCAzMjEsMjM5LjMzIiBmaWxsPSJub25lIiBpZD0iaTItdG8taTMiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMDAwMDAwIiBwb2ludHM9IjMyMSwyNDUuMzMsMzI1LDIzNi4zMywzMjEsMjQwLjMzLDMxNywyMzYuMzMsMzIxLDI0NS4zMyIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjY1LjAwMDEiIHg9IjMyMiIgeT0iMjExLjY2NjkiPiYjMjAwMDE7JiMyNjA0MTsmIzEyMzY0OyYjMjMzODQ7JiMyMjMxMjs8L3RleHQ+PC9nPjwhLS1TUkM9W0tvcDlJQ3JETElaOElTcEN1LThnSWFxa0lTbkJwcWJMSzdoU0ZGem55ekI3cE5pVUQtcl90M3BqU1ZGZ3p0aXdkbFFsVnhnYXlfc1VKWU01bjZBNXREOElYTWdrdkNJWTUwTWJkQ3BZNFdMUlhNWDc3R01kTThZaThQQUtOYzlBWWVRcDlhSjIyOGlVN0dMZGczUFpoYm4zMUxyVEV3MHcxSWk1ZTdORlBjX1gwaEIxR2lPV2VHYXpabmpkRjZ2VXpSWGZ2LUZjWmlVREZLMTVadmx3N3BUclN6TVktZzVmMkxQbEZEZEhZLUlEcDVuYVp2SWI5WGtZVVlKSjQyNWIxOUpJSUN4Rm9yODBndUZ3QURDOGMtUU9GQVc2TDB6YzZkRGJHWm9PMlZCV2lzYVJOWXBoVng5dHBoRUUyTG9QNDZ6Y1docHZQQ1YyUHpEc1dkb3RUaVJKRUlrdVFXNDBdLS0+PC9nPjwvc3ZnPg==" class="uml" alt="uml diagram" title="" /></p>
<h3 id="32">3.2 永続データ構造<a class="headerlink" href="#32" title="Permanent link">&para;</a></h3>
<p>Clojure の永続データ構造は「構造共有」を使用します。新しいバージョンを作成しても、変わっていない部分はメモリを共有します。</p>
<div class="highlight"><pre><span></span><code><span class="c1">;; 大きなベクターでも効率的</span>
<span class="p">(</span><span class="k">def </span><span class="nv">large-vec</span><span class="w"> </span><span class="p">(</span><span class="nf">vec</span><span class="w"> </span><span class="p">(</span><span class="nb">range </span><span class="mi">1000000</span><span class="p">)))</span>
<span class="p">(</span><span class="k">def </span><span class="nv">modified</span><span class="w"> </span><span class="p">(</span><span class="nb">assoc </span><span class="nv">large-vec</span><span class="w"> </span><span class="mi">500000</span><span class="w"> </span><span class="ss">:replaced</span><span class="p">))</span>

<span class="c1">;; 変更されていない部分はメモリを共有</span>
</code></pre></div>
<h3 id="33">3.3 ベクターの基本操作<a class="headerlink" href="#33" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">;; 要素の追加（末尾）</span>
<span class="p">(</span><span class="nb">conj </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w">          </span><span class="c1">; =&gt; [1 2 3 4]</span>

<span class="c1">;; 複数要素の追加</span>
<span class="p">(</span><span class="nb">into </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="mi">3</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">5</span><span class="p">])</span><span class="w">      </span><span class="c1">; =&gt; [1 2 3 4 5]</span>

<span class="c1">;; スライス操作</span>
<span class="p">(</span><span class="nb">subvec </span><span class="p">[</span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w">  </span><span class="c1">; =&gt; [1 2]</span>

<span class="c1">;; 最初の n 要素</span>
<span class="p">(</span><span class="nb">take </span><span class="mi">2</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">5</span><span class="p">])</span><span class="w">      </span><span class="c1">; =&gt; (1 2)</span>

<span class="c1">;; 最後の n 要素</span>
<span class="p">(</span><span class="nf">take-last</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">5</span><span class="p">])</span><span class="w"> </span><span class="c1">; =&gt; (4 5)</span>
</code></pre></div>
<h3 id="34">3.4 リスト変換パターン<a class="headerlink" href="#34" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">;; 最初の2要素を末尾に移動</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">move-first-two-to-end</span><span class="w"> </span><span class="p">[</span><span class="nv">coll</span><span class="p">]</span>
<span class="w">  </span><span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">first-two</span><span class="w"> </span><span class="p">(</span><span class="nb">take </span><span class="mi">2</span><span class="w"> </span><span class="nv">coll</span><span class="p">)</span>
<span class="w">        </span><span class="nv">rest-items</span><span class="w"> </span><span class="p">(</span><span class="nb">drop </span><span class="mi">2</span><span class="w"> </span><span class="nv">coll</span><span class="p">)]</span>
<span class="w">    </span><span class="p">(</span><span class="nb">into </span><span class="p">(</span><span class="nf">vec</span><span class="w"> </span><span class="nv">rest-items</span><span class="p">)</span><span class="w"> </span><span class="nv">first-two</span><span class="p">)))</span>

<span class="p">(</span><span class="nf">move-first-two-to-end</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;a&quot;</span><span class="w"> </span><span class="s">&quot;b&quot;</span><span class="w"> </span><span class="s">&quot;c&quot;</span><span class="w"> </span><span class="s">&quot;d&quot;</span><span class="p">])</span>
<span class="c1">; =&gt; [&quot;c&quot; &quot;d&quot; &quot;a&quot; &quot;b&quot;]</span>

<span class="c1">;; 指定位置に挿入</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">insert-at</span><span class="w"> </span><span class="p">[</span><span class="nv">coll</span><span class="w"> </span><span class="nb">index </span><span class="nv">element</span><span class="p">]</span>
<span class="w">  </span><span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">before</span><span class="w"> </span><span class="p">(</span><span class="nb">take index </span><span class="nv">coll</span><span class="p">)</span>
<span class="w">        </span><span class="nv">after</span><span class="w"> </span><span class="p">(</span><span class="nb">drop index </span><span class="nv">coll</span><span class="p">)]</span>
<span class="w">    </span><span class="p">(</span><span class="nb">into </span><span class="p">(</span><span class="nb">conj </span><span class="p">(</span><span class="nf">vec</span><span class="w"> </span><span class="nv">before</span><span class="p">)</span><span class="w"> </span><span class="nv">element</span><span class="p">)</span><span class="w"> </span><span class="nv">after</span><span class="p">)))</span>

<span class="p">(</span><span class="nf">insert-at</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;a&quot;</span><span class="w"> </span><span class="s">&quot;b&quot;</span><span class="w"> </span><span class="s">&quot;c&quot;</span><span class="p">]</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="s">&quot;x&quot;</span><span class="p">)</span>
<span class="c1">; =&gt; [&quot;a&quot; &quot;x&quot; &quot;b&quot; &quot;c&quot;]</span>
</code></pre></div>
<h3 id="35">3.5 旅程の再計画<a class="headerlink" href="#35" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="kd">defn </span><span class="nv">replan</span><span class="w"> </span><span class="p">[</span><span class="nv">plan</span><span class="w"> </span><span class="nv">new-city</span><span class="w"> </span><span class="nv">before-city</span><span class="p">]</span>
<span class="w">  </span><span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nb">index </span><span class="p">(</span><span class="nf">.indexOf</span><span class="w"> </span><span class="p">(</span><span class="nf">vec</span><span class="w"> </span><span class="nv">plan</span><span class="p">)</span><span class="w"> </span><span class="nv">before-city</span><span class="p">)</span>
<span class="w">        </span><span class="nv">cities-before</span><span class="w"> </span><span class="p">(</span><span class="nb">take index </span><span class="nv">plan</span><span class="p">)</span>
<span class="w">        </span><span class="nv">cities-after</span><span class="w"> </span><span class="p">(</span><span class="nb">drop index </span><span class="nv">plan</span><span class="p">)]</span>
<span class="w">    </span><span class="p">(</span><span class="nb">into </span><span class="p">(</span><span class="nb">conj </span><span class="p">(</span><span class="nf">vec</span><span class="w"> </span><span class="nv">cities-before</span><span class="p">)</span><span class="w"> </span><span class="nv">new-city</span><span class="p">)</span><span class="w"> </span><span class="nv">cities-after</span><span class="p">)))</span>

<span class="p">(</span><span class="k">def </span><span class="nv">plan-a</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;Paris&quot;</span><span class="w"> </span><span class="s">&quot;Berlin&quot;</span><span class="w"> </span><span class="s">&quot;Kraków&quot;</span><span class="p">])</span>
<span class="p">(</span><span class="k">def </span><span class="nv">plan-b</span><span class="w"> </span><span class="p">(</span><span class="nf">replan</span><span class="w"> </span><span class="nv">plan-a</span><span class="w"> </span><span class="s">&quot;Vienna&quot;</span><span class="w"> </span><span class="s">&quot;Kraków&quot;</span><span class="p">))</span>

<span class="nv">plan-b</span><span class="w">  </span><span class="c1">; =&gt; [&quot;Paris&quot; &quot;Berlin&quot; &quot;Vienna&quot; &quot;Kraków&quot;]</span>
<span class="nv">plan-a</span><span class="w">  </span><span class="c1">; =&gt; [&quot;Paris&quot; &quot;Berlin&quot; &quot;Kraków&quot;]（変わっていない）</span>
</code></pre></div>
<h3 id="36">3.6 マップの操作<a class="headerlink" href="#36" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">;; 値の更新</span>
<span class="p">(</span><span class="k">def </span><span class="nv">person</span><span class="w"> </span><span class="p">{</span><span class="ss">:name</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="w"> </span><span class="ss">:age</span><span class="w"> </span><span class="mi">30</span><span class="p">})</span>

<span class="p">(</span><span class="nb">assoc </span><span class="nv">person</span><span class="w"> </span><span class="ss">:age</span><span class="w"> </span><span class="mi">31</span><span class="p">)</span>
<span class="c1">; =&gt; {:name &quot;Alice&quot;, :age 31}</span>

<span class="c1">;; 関数で更新</span>
<span class="p">(</span><span class="nf">update</span><span class="w"> </span><span class="nv">person</span><span class="w"> </span><span class="ss">:age</span><span class="w"> </span><span class="nv">inc</span><span class="p">)</span>
<span class="c1">; =&gt; {:name &quot;Alice&quot;, :age 31}</span>

<span class="c1">;; フィールドの削除</span>
<span class="p">(</span><span class="nb">dissoc </span><span class="nv">person</span><span class="w"> </span><span class="ss">:age</span><span class="p">)</span>
<span class="c1">; =&gt; {:name &quot;Alice&quot;}</span>

<span class="c1">;; ネストした更新</span>
<span class="p">(</span><span class="k">def </span><span class="nv">data</span><span class="w"> </span><span class="p">{</span><span class="ss">:user</span><span class="w"> </span><span class="p">{</span><span class="ss">:profile</span><span class="w"> </span><span class="p">{</span><span class="ss">:name</span><span class="w"> </span><span class="s">&quot;Bob&quot;</span><span class="p">}}})</span>
<span class="p">(</span><span class="nf">update-in</span><span class="w"> </span><span class="nv">data</span><span class="w"> </span><span class="p">[</span><span class="ss">:user</span><span class="w"> </span><span class="ss">:profile</span><span class="w"> </span><span class="ss">:name</span><span class="p">]</span><span class="w"> </span><span class="nv">clojure.string/upper-case</span><span class="p">)</span>
<span class="c1">; =&gt; {:user {:profile {:name &quot;BOB&quot;}}}</span>
</code></pre></div>
<hr />
<h2 id="4">第4章: 関数を値として扱う<a class="headerlink" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 高階関数とは<a class="headerlink" href="#41" title="Permanent link">&para;</a></h3>
<p>高階関数（Higher-Order Function）とは、以下のいずれかを満たす関数です：</p>
<ol>
<li>関数を引数として受け取る</li>
<li>関数を戻り値として返す</li>
</ol>
<p>Clojure では関数はファーストクラスの値です。</p>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkRFU0NSSVBUSU9OIiBoZWlnaHQ9IjI0MHB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6NTQzcHg7aGVpZ2h0OjI0MHB4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDU0MyAyNDAiIHdpZHRoPSI1NDNweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PGRlZnMvPjxnPjwhLS1jbHVzdGVyID8/Pz8tLT48ZyBjbGFzcz0iY2x1c3RlciIgZGF0YS1lbnRpdHk9Ii4uLi4iIGRhdGEtc291cmNlLWxpbmU9IjMiIGRhdGEtdWlkPSJlbnQwMDAyIiBpZD0iY2x1c3Rlcl8uLi4uIj48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjIyMi41OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjUyNSIgeD0iMTIiIHk9IjEyIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjU1Ljk5OTgiIHg9IjI0Ni41MDAxIiB5PSIyNi45OTUxIj4mIzM5NjQwOyYjMzg1NDI7JiMzODMwNjsmIzI1OTY4OzwvdGV4dD48L2c+PCEtLWNsdXN0ZXIgYXJnLS0+PGcgY2xhc3M9ImNsdXN0ZXIiIGRhdGEtZW50aXR5PSJhcmciIGRhdGEtc291cmNlLWxpbmU9IjQiIGRhdGEtdWlkPSJlbnQwMDAzIiBpZD0iY2x1c3Rlcl9hcmciPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iMTU1LjU5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iMTg4IiB4PSIzNiIgeT0iNTUiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTExLjk5OTUiIHg9Ijc0LjAwMDIiIHk9IjY5Ljk5NTEiPiYjMzgzMDY7JiMyNTk2ODsmIzEyNDM0OyYjMjQzNDE7JiMyNTk2ODsmIzEyMzk1OyYjMjE0NjI7JiMxMjQyNzs8L3RleHQ+PC9nPjwhLS1jbHVzdGVyIHJldC0tPjxnIGNsYXNzPSJjbHVzdGVyIiBkYXRhLWVudGl0eT0icmV0IiBkYXRhLXNvdXJjZS1saW5lPSIxMCIgZGF0YS11aWQ9ImVudDAwMDciIGlkPSJjbHVzdGVyX3JldCI+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgaGVpZ2h0PSI3My4yOSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjI2NSIgeD0iMjQ4IiB5PSI1NSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2OS45OTk3IiB4PSIzNDUuNTAwMiIgeT0iNjkuOTk1MSI+JiMzODMwNjsmIzI1OTY4OyYjMTI0MzQ7JiMzNjgyMDsmIzEyMzc3OzwvdGV4dD48L2c+PCEtLWVudGl0eSBzb3J0QnktLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0ic29ydEJ5IiBkYXRhLXNvdXJjZS1saW5lPSI1IiBkYXRhLXVpZD0iZW50MDAwNCIgaWQ9ImVudGl0eV9zb3J0QnkiPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iMjIuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjY5LjMyODEiIHg9IjUyLjM0IiB5PSI5MCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjQ5LjMyODEiIHg9IjYyLjM0IiB5PSIxMDUuOTk1MSI+c29ydC1ieTwvdGV4dD48L2c+PCEtLWVudGl0eSBtYXAtLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0ibWFwIiBkYXRhLXNvdXJjZS1saW5lPSI2IiBkYXRhLXVpZD0iZW50MDAwNSIgaWQ9ImVudGl0eV9tYXAiPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iMjIuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjUxLjEwMzUiIHg9IjE1Ni40NSIgeT0iOTAiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzMS4xMDM1IiB4PSIxNjYuNDUiIHk9IjEwNS45OTUxIj5tYXA8L3RleHQ+PC9nPjwhLS1lbnRpdHkgZmlsdGVyLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9ImZpbHRlciIgZGF0YS1zb3VyY2UtbGluZT0iNyIgZGF0YS11aWQ9ImVudDAwMDYiIGlkPSJlbnRpdHlfZmlsdGVyIj48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjIyLjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSI1Mi41NjY0IiB4PSI2MC43MiIgeT0iMTcyLjI5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMzIuNTY2NCIgeD0iNzAuNzIiIHk9IjE4OC4yODUxIj5maWx0ZXI8L3RleHQ+PC9nPjwhLS1lbnRpdHkgbGFyZ2VyLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9ImxhcmdlciIgZGF0YS1zb3VyY2UtbGluZT0iMTEiIGRhdGEtdWlkPSJlbnQwMDA4IiBpZD0iZW50aXR5X2xhcmdlciI+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgaGVpZ2h0PSIyMi4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iOTguMzQ2NyIgeD0iMjYzLjgzIiB5PSI5MCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijc4LjM0NjciIHg9IjI3My44MyIgeT0iMTA1Ljk5NTEiPmxhcmdlci10aGFuPC90ZXh0PjwvZz48IS0tZW50aXR5IGRpdmlzaWJsZS0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJkaXZpc2libGUiIGRhdGEtc291cmNlLWxpbmU9IjEyIiBkYXRhLXVpZD0iZW50MDAwOSIgaWQ9ImVudGl0eV9kaXZpc2libGUiPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iMjIuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9Ijk5Ljc0OCIgeD0iMzk3LjEzIiB5PSI5MCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijc5Ljc0OCIgeD0iNDA3LjEzIiB5PSIxMDUuOTk1MSI+ZGl2aXNpYmxlLWJ5PC90ZXh0PjwvZz48IS0tU1JDPVtLb3A5SUNyRExJWjhJU3BDdS04Z0lhcWtJU25CcHFiTEs3Z3ZVaVJCTU5xbGZvcndEZE0zYWE4cllYSE95NzdKZkFUeGZlOE9aUWtWemF6eHRESWpmOTFPaDkxT2IwdktkUG5PYkFBV0w5blZMQUFSTDBhTTF4NlRBZzRJa09hNU80NFczSEw5b3ltZklJcTIycUFPTkJMU01FcnlpTl9BdXlRUE84TDVnSUxtZ3RBMHpnT013UFBhOUVRMXZJMXlnNkhBUGJiY1NNUElKWWhDQ04wMWUyc3IwMDAwXS0tPjwvZz48L3N2Zz4=" class="uml" alt="uml diagram" title="" /></p>
<h3 id="42-map-">4.2 map - 各要素を変換<a class="headerlink" href="#42-map-" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">;; 関数を定義</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">len</span><span class="w"> </span><span class="p">[</span><span class="nv">s</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="nb">count </span><span class="nv">s</span><span class="p">))</span>

<span class="c1">;; map で各要素に適用</span>
<span class="p">(</span><span class="nb">map </span><span class="nv">len</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;scala&quot;</span><span class="w"> </span><span class="s">&quot;rust&quot;</span><span class="w"> </span><span class="s">&quot;ada&quot;</span><span class="p">])</span>
<span class="c1">; =&gt; (5 4 3)</span>

<span class="c1">;; 無名関数を使用</span>
<span class="p">(</span><span class="nb">map </span><span class="o">#</span><span class="p">(</span><span class="nb">* </span><span class="mi">2</span><span class="w"> </span><span class="nv">%</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="mi">5</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">0</span><span class="p">])</span>
<span class="c1">; =&gt; (10 2 4 8 0)</span>

<span class="c1">;; 2乗</span>
<span class="p">(</span><span class="nb">map </span><span class="o">#</span><span class="p">(</span><span class="nb">* </span><span class="nv">%</span><span class="w"> </span><span class="nv">%</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">5</span><span class="p">])</span>
<span class="c1">; =&gt; (1 4 9 16 25)</span>
</code></pre></div>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkRFU0NSSVBUSU9OIiBoZWlnaHQ9IjI1NXB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6MjU2cHg7aGVpZ2h0OjI1NXB4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDI1NiAyNTUiIHdpZHRoPSIyNTZweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PGRlZnMvPjxnPjwhLS1jbHVzdGVyIG1hcCA/Pz8tLT48ZyBjbGFzcz0iY2x1c3RlciIgZGF0YS1lbnRpdHk9Im1hcCAuLi4iIGRhdGEtc291cmNlLWxpbmU9IjMiIGRhdGEtdWlkPSJlbnQwMDAyIiBpZD0iY2x1c3Rlcl9tYXAgLi4uIj48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjIzNy44OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjIzOCIgeD0iMTIiIHk9IjEyIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjgwLjkzMDUiIHg9IjkwLjUzNDgiIHk9IjI2Ljk5NTEiPm1hcCAmIzEyMzk4OyYjMjEyMDU7JiMyMDMxNjs8L3RleHQ+PC9nPjwhLS1lbnRpdHkgaW5wdXQtLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iaW5wdXQiIGRhdGEtc291cmNlLWxpbmU9IjQiIGRhdGEtdWlkPSJlbnQwMDAzIiBpZD0iZW50aXR5X2lucHV0Ij48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjIyLjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSIyMDUuMTU4MiIgeD0iMjguNDIiIHk9IjQ3Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTg1LjE1ODIiIHg9IjM4LjQyIiB5PSI2Mi45OTUxIj5bXCJzY2FsYVwiLCBcInJ1c3RcIiwgXCJhZGFcIl08L3RleHQ+PC9nPjwhLS1lbnRpdHkgb3AtLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0ib3AiIGRhdGEtc291cmNlLWxpbmU9IjUiIGRhdGEtdWlkPSJlbnQwMDA0IiBpZD0iZW50aXR5X29wIj48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjIyLjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSIxNzEuODI1NiIgeD0iNDUuMDkiIHk9IjEyOS4zIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTUxLjgyNTYiIHg9IjU1LjA5IiB5PSIxNDUuMjk1MSI+bGVuICYjMzgzMDY7JiMyNTk2ODsmIzEyNDM0OyYjMjE1MDg7JiMzNTIwMTsmIzMyMDMyOyYjMTIzOTU7JiMzNjk2OTsmIzI5OTkyOzwvdGV4dD48L2c+PCEtLWVudGl0eSBvdXRwdXQtLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0ib3V0cHV0IiBkYXRhLXNvdXJjZS1saW5lPSI2IiBkYXRhLXVpZD0iZW50MDAwNSIgaWQ9ImVudGl0eV9vdXRwdXQiPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iMjIuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjY2LjU0NTkiIHg9Ijk3LjczIiB5PSIyMTEuNTkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0Ni41NDU5IiB4PSIxMDcuNzMiIHk9IjIyNy41ODUxIj4oNSA0IDMpPC90ZXh0PjwvZz48IS0tbGluayBpbnB1dCB0byBvcC0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJpbnB1dCIgZGF0YS1lbnRpdHktMj0ib3AiIGRhdGEtc291cmNlLWxpbmU9IjgiIGRhdGEtdWlkPSJsbms2IiBpZD0ibGlua19pbnB1dF9vcCI+PHBhdGggZD0iTTEzMSw2OS42NSBDMTMxLDg1LjAzIDEzMSwxMDcuNTUgMTMxLDEyMi45NCIgZmlsbD0ibm9uZSIgaWQ9ImlucHV0LXRvLW9wIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzAwMDAwMCIgcG9pbnRzPSIxMzEsMTI4Ljk0LDEzNSwxMTkuOTQsMTMxLDEyMy45NCwxMjcsMTE5Ljk0LDEzMSwxMjguOTQiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48L2c+PCEtLWxpbmsgb3AgdG8gb3V0cHV0LS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9Im9wIiBkYXRhLWVudGl0eS0yPSJvdXRwdXQiIGRhdGEtc291cmNlLWxpbmU9IjkiIGRhdGEtdWlkPSJsbms3IiBpZD0ibGlua19vcF9vdXRwdXQiPjxwYXRoIGQ9Ik0xMzEsMTUxLjk0IEMxMzEsMTY3LjMzIDEzMSwxODkuODUgMTMxLDIwNS4yNCIgZmlsbD0ibm9uZSIgaWQ9Im9wLXRvLW91dHB1dCIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMwMDAwMDAiIHBvaW50cz0iMTMxLDIxMS4yNCwxMzUsMjAyLjI0LDEzMSwyMDYuMjQsMTI3LDIwMi4yNCwxMzEsMjExLjI0IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjwhLS1TUkM9W0tvcDlJQ3JETElaOElTcEN1LThnSWFxa0lTbkJwcWJMS0NmREI1MXV0QlprUVZWSzl0bGRBMmJLU29LZDVnS2VBNE43QTFLZDktT2FuWVpmQUNHZTVQS01icTFPWUliMGVMV2JYU0hZWFNveVdqOElnRkFTcjNvNWJ6Q01GUGt3dU43SmZBU0pNYnVpUXRvLVBTN1puaktsNnJTLWR4ODJoM3dfMEFmT21ySjFIQzVPNG85T01XOG9YR2ppYzhBa2hYcjhNTnUxWDBNSGdtSzBdLS0+PC9nPjwvc3ZnPg==" class="uml" alt="uml diagram" title="" /></p>
<h3 id="43-filter-">4.3 filter - 条件に合う要素を抽出<a class="headerlink" href="#43-filter-" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">;; 奇数のみ</span>
<span class="p">(</span><span class="nb">filter </span><span class="nv">odd?</span><span class="w"> </span><span class="p">[</span><span class="mi">5</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">0</span><span class="p">])</span>
<span class="c1">; =&gt; (5 1)</span>

<span class="c1">;; 4より大きい</span>
<span class="p">(</span><span class="nb">filter </span><span class="o">#</span><span class="p">(</span><span class="nb">&gt; </span><span class="nv">%</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="mi">5</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">0</span><span class="p">])</span>
<span class="c1">; =&gt; (5)</span>

<span class="c1">;; 偶数のみ</span>
<span class="p">(</span><span class="nb">filter </span><span class="nv">even?</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="mi">6</span><span class="p">])</span>
<span class="c1">; =&gt; (2 4 6)</span>
</code></pre></div>
<h3 id="44-reduce-">4.4 reduce - 畳み込み<a class="headerlink" href="#44-reduce-" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">;; 合計</span>
<span class="p">(</span><span class="nb">reduce + </span><span class="mi">0</span><span class="w"> </span><span class="p">[</span><span class="mi">5</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">100</span><span class="p">])</span>
<span class="c1">; =&gt; 112</span>

<span class="c1">;; 最大値</span>
<span class="p">(</span><span class="nb">reduce </span><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">max-val</span><span class="w"> </span><span class="nv">n</span><span class="p">]</span>
<span class="w">          </span><span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="nv">n</span><span class="w"> </span><span class="nv">max-val</span><span class="p">)</span><span class="w"> </span><span class="nv">n</span><span class="w"> </span><span class="nv">max-val</span><span class="p">))</span>
<span class="w">        </span><span class="nv">Integer/MIN_VALUE</span>
<span class="w">        </span><span class="p">[</span><span class="mi">5</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">15</span><span class="p">])</span>
<span class="c1">; =&gt; 15</span>

<span class="c1">;; 積</span>
<span class="p">(</span><span class="nb">reduce * </span><span class="mi">1</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">5</span><span class="p">])</span>
<span class="c1">; =&gt; 120</span>
</code></pre></div>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkRFU0NSSVBUSU9OIiBoZWlnaHQ9IjUwMnB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6MTgycHg7aGVpZ2h0OjUwMnB4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDE4MiA1MDIiIHdpZHRoPSIxODJweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PGRlZnMvPjxnPjwhLS1jbHVzdGVyIHJlZHVjZSA/Pz8tLT48ZyBjbGFzcz0iY2x1c3RlciIgZGF0YS1lbnRpdHk9InJlZHVjZSAuLi4iIGRhdGEtc291cmNlLWxpbmU9IjMiIGRhdGEtdWlkPSJlbnQwMDAyIiBpZD0iY2x1c3Rlcl9yZWR1Y2UgLi4uIj48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjQ4NC43OCIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjE2NCIgeD0iMTIiIHk9IjEyIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEwMS4wNTU1IiB4PSI0My40NzIzIiB5PSIyNi45OTUxIj5yZWR1Y2UgJiMxMjM5ODsmIzIxMjA1OyYjMjAzMTY7PC90ZXh0PjwvZz48IS0tZW50aXR5IGluaXQtLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iaW5pdCIgZGF0YS1zb3VyY2UtbGluZT0iNCIgZGF0YS11aWQ9ImVudDAwMDMiIGlkPSJlbnRpdHlfaW5pdCI+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgaGVpZ2h0PSIyMi4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iODAuMDc0IiB4PSI1My45NiIgeT0iNDciLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2MC4wNzQiIHg9IjYzLjk2IiB5PSI2Mi45OTUxIj4mIzIxMDIxOyYjMjYzOTk7JiMyMDUxNjs6IDA8L3RleHQ+PC9nPjwhLS1lbnRpdHkgczEtLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iczEiIGRhdGEtc291cmNlLWxpbmU9IjUiIGRhdGEtdWlkPSJlbnQwMDA0IiBpZD0iZW50aXR5X3MxIj48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjIyLjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSI4Ny45ODM0IiB4PSI1MC4wMSIgeT0iMTI5LjMiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2Ny45ODM0IiB4PSI2MC4wMSIgeT0iMTQ1LjI5NTEiPjAgKyA1ID0gNTwvdGV4dD48L2c+PCEtLWVudGl0eSBzMi0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJzMiIgZGF0YS1zb3VyY2UtbGluZT0iNiIgZGF0YS11aWQ9ImVudDAwMDUiIGlkPSJlbnRpdHlfczIiPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iMjIuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9Ijg3Ljk4MzQiIHg9IjUwLjAxIiB5PSIyMTEuNTkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2Ny45ODM0IiB4PSI2MC4wMSIgeT0iMjI3LjU4NTEiPjUgKyAxID0gNjwvdGV4dD48L2c+PCEtLWVudGl0eSBzMy0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJzMyIgZGF0YS1zb3VyY2UtbGluZT0iNyIgZGF0YS11aWQ9ImVudDAwMDYiIGlkPSJlbnRpdHlfczMiPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iMjIuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9Ijg3Ljk4MzQiIHg9IjUwLjAxIiB5PSIyOTMuODkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2Ny45ODM0IiB4PSI2MC4wMSIgeT0iMzA5Ljg4NTEiPjYgKyAyID0gODwvdGV4dD48L2c+PCEtLWVudGl0eSBzNC0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJzNCIgZGF0YS1zb3VyY2UtbGluZT0iOCIgZGF0YS11aWQ9ImVudDAwMDciIGlkPSJlbnRpdHlfczQiPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iMjIuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9Ijk2Ljg5MDYiIHg9IjQ1LjU1IiB5PSIzNzYuMTkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI3Ni44OTA2IiB4PSI1NS41NSIgeT0iMzkyLjE4NTEiPjggKyA0ID0gMTI8L3RleHQ+PC9nPjwhLS1lbnRpdHkgczUtLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iczUiIGRhdGEtc291cmNlLWxpbmU9IjkiIGRhdGEtdWlkPSJlbnQwMDA4IiBpZD0iZW50aXR5X3M1Ij48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjIyLjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSIxMzIuNTE5NSIgeD0iMjcuNzQiIHk9IjQ1OC40OCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjExMi41MTk1IiB4PSIzNy43NCIgeT0iNDc0LjQ3NTEiPjEyICsgMTAwID0gMTEyPC90ZXh0PjwvZz48IS0tbGluayBpbml0IHRvIHMxLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9ImluaXQiIGRhdGEtZW50aXR5LTI9InMxIiBkYXRhLXNvdXJjZS1saW5lPSIxMSIgZGF0YS11aWQ9ImxuazkiIGlkPSJsaW5rX2luaXRfczEiPjxwYXRoIGQ9Ik05NCw2OS42NCBDOTQsODUuMDMgOTQsMTA3LjU1IDk0LDEyMi45NCIgZmlsbD0ibm9uZSIgaWQ9ImluaXQtdG8tczEiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMDAwMDAwIiBwb2ludHM9Ijk0LDEyOC45NCw5OCwxMTkuOTQsOTQsMTIzLjk0LDkwLDExOS45NCw5NCwxMjguOTQiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48L2c+PCEtLWxpbmsgczEgdG8gczItLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iczEiIGRhdGEtZW50aXR5LTI9InMyIiBkYXRhLXNvdXJjZS1saW5lPSIxMiIgZGF0YS11aWQ9ImxuazEwIiBpZD0ibGlua19zMV9zMiI+PHBhdGggZD0iTTk0LDE1MS45NCBDOTQsMTY3LjMzIDk0LDE4OS44NSA5NCwyMDUuMjQiIGZpbGw9Im5vbmUiIGlkPSJzMS10by1zMiIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMwMDAwMDAiIHBvaW50cz0iOTQsMjExLjI0LDk4LDIwMi4yNCw5NCwyMDYuMjQsOTAsMjAyLjI0LDk0LDIxMS4yNCIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjwvZz48IS0tbGluayBzMiB0byBzMy0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJzMiIgZGF0YS1lbnRpdHktMj0iczMiIGRhdGEtc291cmNlLWxpbmU9IjEzIiBkYXRhLXVpZD0ibG5rMTEiIGlkPSJsaW5rX3MyX3MzIj48cGF0aCBkPSJNOTQsMjM0LjI0IEM5NCwyNDkuNjMgOTQsMjcyLjE1IDk0LDI4Ny41NCIgZmlsbD0ibm9uZSIgaWQ9InMyLXRvLXMzIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzAwMDAwMCIgcG9pbnRzPSI5NCwyOTMuNTQsOTgsMjg0LjU0LDk0LDI4OC41NCw5MCwyODQuNTQsOTQsMjkzLjU0IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjwhLS1saW5rIHMzIHRvIHM0LS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9InMzIiBkYXRhLWVudGl0eS0yPSJzNCIgZGF0YS1zb3VyY2UtbGluZT0iMTQiIGRhdGEtdWlkPSJsbmsxMiIgaWQ9ImxpbmtfczNfczQiPjxwYXRoIGQ9Ik05NCwzMTYuNTQgQzk0LDMzMS45MiA5NCwzNTQuNDQgOTQsMzY5LjgzIiBmaWxsPSJub25lIiBpZD0iczMtdG8tczQiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMDAwMDAwIiBwb2ludHM9Ijk0LDM3NS44Myw5OCwzNjYuODMsOTQsMzcwLjgzLDkwLDM2Ni44Myw5NCwzNzUuODMiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48L2c+PCEtLWxpbmsgczQgdG8gczUtLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iczQiIGRhdGEtZW50aXR5LTI9InM1IiBkYXRhLXNvdXJjZS1saW5lPSIxNSIgZGF0YS11aWQ9ImxuazEzIiBpZD0ibGlua19zNF9zNSI+PHBhdGggZD0iTTk0LDM5OC44MyBDOTQsNDE0LjIyIDk0LDQzNi43NCA5NCw0NTIuMTMiIGZpbGw9Im5vbmUiIGlkPSJzNC10by1zNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMwMDAwMDAiIHBvaW50cz0iOTQsNDU4LjEzLDk4LDQ0OS4xMyw5NCw0NTMuMTMsOTAsNDQ5LjEzLDk0LDQ1OC4xMyIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjwvZz48IS0tU1JDPVtEU3FuMmk4bTVDUm5fUHRZY0xLQUlQZ0s4a1hUR1hrcUs4aXFUSDkxRHk3UGhVQll4MHF5WlNQcGNGWll6a1Z0bU5rSk9NTk41WlVqUUpnMHRiUTN3UFFqSFRSUlVialBWMXFWX2RudkZxVTZFd1hDTm9GcGYtamRsRmQzVk9RU2VON09UQ3NHRGV2SnIzWDdfSGtTSUFtM1l5MDVpS25TMTlRMUktOHlTSGJPMUhRSU4yS05DZnhYRjR4X0pHRjR6dlhiWV9aRTJJZTlKYkJidTc4ZzFLdkhRVFhfMEcwMF0tLT48L2c+PC9zdmc+" class="uml" alt="uml diagram" title="" /></p>
<h3 id="45-sort-by-">4.5 sort-by - ソート基準を関数で指定<a class="headerlink" href="#45-sort-by-" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="kd">defn </span><span class="nv">score</span><span class="w"> </span><span class="p">[</span><span class="nv">word</span><span class="p">]</span>
<span class="w">  </span><span class="p">(</span><span class="nb">count </span><span class="p">(</span><span class="nf">clojure.string/replace</span><span class="w"> </span><span class="nv">word</span><span class="w"> </span><span class="s">&quot;a&quot;</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">)))</span>

<span class="p">(</span><span class="nb">sort-by </span><span class="nv">score</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;rust&quot;</span><span class="w"> </span><span class="s">&quot;java&quot;</span><span class="p">])</span>
<span class="c1">; =&gt; (&quot;java&quot; &quot;rust&quot;)</span>
<span class="c1">;; java: 2文字 (j, v), rust: 4文字 (r, u, s, t)</span>
</code></pre></div>
<h3 id="46">4.6 関数を返す関数<a class="headerlink" href="#46" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="kd">defn </span><span class="nv">larger-than</span><span class="w"> </span><span class="p">[</span><span class="nv">n</span><span class="p">]</span>
<span class="w">  </span><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">i</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="nb">&gt; </span><span class="nv">i</span><span class="w"> </span><span class="nv">n</span><span class="p">)))</span>

<span class="p">(</span><span class="nb">filter </span><span class="p">(</span><span class="nf">larger-than</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="mi">5</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">0</span><span class="p">])</span>
<span class="c1">; =&gt; (5)</span>

<span class="p">(</span><span class="nb">filter </span><span class="p">(</span><span class="nf">larger-than</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="mi">5</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">0</span><span class="p">])</span>
<span class="c1">; =&gt; (5 2 4)</span>

<span class="c1">;; 範囲判定</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">between</span><span class="w"> </span><span class="p">[</span><span class="nv">min-val</span><span class="w"> </span><span class="nv">max-val</span><span class="p">]</span>
<span class="w">  </span><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">i</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="nb">and </span><span class="p">(</span><span class="nb">&gt;= </span><span class="nv">i</span><span class="w"> </span><span class="nv">min-val</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">&lt;= </span><span class="nv">i</span><span class="w"> </span><span class="nv">max-val</span><span class="p">))))</span>

<span class="p">(</span><span class="nb">filter </span><span class="p">(</span><span class="nf">between</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="mi">6</span><span class="p">])</span>
<span class="c1">; =&gt; (2 3 4 5)</span>
</code></pre></div>
<h3 id="47-partial">4.7 部分適用（partial）<a class="headerlink" href="#47-partial" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="k">def </span><span class="nv">add-10</span><span class="w"> </span><span class="p">(</span><span class="nb">partial + </span><span class="mi">10</span><span class="p">))</span>
<span class="p">(</span><span class="k">def </span><span class="nv">multiply-by-2</span><span class="w"> </span><span class="p">(</span><span class="nb">partial * </span><span class="mi">2</span><span class="p">))</span>

<span class="p">(</span><span class="nf">add-10</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w">         </span><span class="c1">; =&gt; 15</span>
<span class="p">(</span><span class="nf">multiply-by-2</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w">  </span><span class="c1">; =&gt; 10</span>

<span class="p">(</span><span class="nb">map </span><span class="p">(</span><span class="nb">partial + </span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">])</span>
<span class="c1">; =&gt; (101 102 103)</span>
</code></pre></div>
<h3 id="48-comp">4.8 関数合成（comp）<a class="headerlink" href="#48-comp" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">;; comp は右から左に関数を適用</span>
<span class="p">(</span><span class="k">def </span><span class="nv">process-number</span>
<span class="w">  </span><span class="p">(</span><span class="nb">comp </span><span class="p">(</span><span class="nb">partial + </span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">partial * </span><span class="mi">2</span><span class="p">)))</span>

<span class="p">(</span><span class="nf">process-number</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w">  </span><span class="c1">; =&gt; 20 (5*2=10, 10+10=20)</span>

<span class="p">(</span><span class="k">def </span><span class="nv">normalize-name</span>
<span class="w">  </span><span class="p">(</span><span class="nb">comp </span><span class="nv">clojure.string/capitalize</span>
<span class="w">        </span><span class="nv">clojure.string/trim</span>
<span class="w">        </span><span class="nv">clojure.string/lower-case</span><span class="p">))</span>

<span class="p">(</span><span class="nf">normalize-name</span><span class="w"> </span><span class="s">&quot;  JOHN DOE  &quot;</span><span class="p">)</span>
<span class="c1">; =&gt; &quot;John doe&quot;</span>
</code></pre></div>
<h3 id="49">4.9 スレッディングマクロ<a class="headerlink" href="#49" title="Permanent link">&para;</a></h3>
<p>Clojure のスレッディングマクロは、データの変換パイプラインを読みやすく書けます。</p>
<div class="highlight"><pre><span></span><code><span class="c1">;; -&gt; (thread-first): 前の結果を最初の引数として挿入</span>
<span class="p">(</span><span class="nb">-&gt; </span><span class="s">&quot;  Hello World  &quot;</span>
<span class="w">    </span><span class="nv">clojure.string/trim</span>
<span class="w">    </span><span class="nv">clojure.string/lower-case</span>
<span class="w">    </span><span class="p">(</span><span class="nf">clojure.string/replace</span><span class="w"> </span><span class="o">#</span><span class="s">&quot;\s+&quot;</span><span class="w"> </span><span class="s">&quot;-&quot;</span><span class="p">))</span>
<span class="c1">; =&gt; &quot;hello-world&quot;</span>

<span class="c1">;; -&gt;&gt; (thread-last): 前の結果を最後の引数として挿入</span>
<span class="p">(</span><span class="nf">-&gt;&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">5</span><span class="p">]</span>
<span class="w">     </span><span class="p">(</span><span class="nb">filter </span><span class="nv">odd?</span><span class="p">)</span>
<span class="w">     </span><span class="p">(</span><span class="nb">map </span><span class="o">#</span><span class="p">(</span><span class="nb">* </span><span class="nv">%</span><span class="w"> </span><span class="nv">%</span><span class="p">))</span>
<span class="w">     </span><span class="p">(</span><span class="nb">reduce </span><span class="nv">+</span><span class="p">))</span>
<span class="c1">; =&gt; 35 (1 + 9 + 25)</span>
</code></pre></div>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkRFU0NSSVBUSU9OIiBoZWlnaHQ9IjI0N3B4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6NzE2cHg7aGVpZ2h0OjI0N3B4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDcxNiAyNDciIHdpZHRoPSI3MTZweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PGRlZnMvPjxnPjwhLS1jbHVzdGVyID8/Pz8/Pz8/Pz8tLT48ZyBjbGFzcz0iY2x1c3RlciIgZGF0YS1lbnRpdHk9Ii4uLi4uLi4uLi4iIGRhdGEtc291cmNlLWxpbmU9IjMiIGRhdGEtdWlkPSJlbnQwMDAyIiBpZD0iY2x1c3Rlcl8uLi4uLi4uLi4uIj48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjE3Mi4yOSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjYzNCIgeD0iMTIiIHk9IjEyIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEzOS45OTk0IiB4PSIyNTkuMDAwMyIgeT0iMjYuOTk1MSI+JiMxMjQ3MzsmIzEyNTI0OyYjMTI0ODM7JiMxMjQ4NzsmIzEyNDUxOyYjMTI1MzE7JiMxMjQ2NDsmIzEyNTEwOyYjMTI0NjM7JiMxMjUyNTs8L3RleHQ+PC9nPjwhLS1jbHVzdGVyIHRmLS0+PGcgY2xhc3M9ImNsdXN0ZXIiIGRhdGEtZW50aXR5PSJ0ZiIgZGF0YS1zb3VyY2UtbGluZT0iNCIgZGF0YS11aWQ9ImVudDAwMDMiIGlkPSJjbHVzdGVyX3RmIj48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9Ijg5LjI5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iMjY1IiB4PSI0NCIgeT0iNjMiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTI2LjM2OTEiIHg9IjExMy4zMTU0IiB5PSI3Ny45OTUxIj4tJmd0OyAodGhyZWFkLWZpcnN0KTwvdGV4dD48L2c+PCEtLWNsdXN0ZXIgdGwtLT48ZyBjbGFzcz0iY2x1c3RlciIgZGF0YS1lbnRpdHk9InRsIiBkYXRhLXNvdXJjZS1saW5lPSI4IiBkYXRhLXVpZD0iZW50MDAwNSIgaWQ9ImNsdXN0ZXJfdGwiPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iODkuMjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSIyNjUiIHg9IjM0OSIgeT0iNjMiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTM0LjU1MTgiIHg9IjQxNC4yMjQxIiB5PSI3Ny45OTUxIj4tJmd0OyZndDsgKHRocmVhZC1sYXN0KTwvdGV4dD48L2c+PCEtLWVudGl0eSA/ID8gKGYgPyAuLi4pID8gKGcgPz8gLi4uKS0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSIuIC4gLmYgLiAuLi4uIC4gLmcgLi4gLi4uLiIgZGF0YS1zb3VyY2UtbGluZT0iNSIgZGF0YS11aWQ9ImVudDAwMDQiIGlkPSJlbnRpdHlfLiAuIC5mIC4gLi4uLiAuIC5nIC4uIC4uLi4iPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iMjIuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjE5Ny40MjY1IiB4PSI2OC4yOSIgeT0iMTA2Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTc3LjQyNjUiIHg9Ijc4LjI5IiB5PSIxMjEuOTk1MSI+JiMyMDUxNjsgJiM4NTk0OyAoZiAmIzIwNTE2OyAuLi4pICYjODU5NDsgKGcgJiMzMjA4MDsmIzI2NTI0OyAuLi4pPC90ZXh0PjwvZz48IS0tZW50aXR5ID8gPyAoZiAuLi4gPykgPyAoZyAuLi4gPz8pLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9Ii4gLiAuZiAuLi4gLi4gLiAuZyAuLi4gLi4uIiBkYXRhLXNvdXJjZS1saW5lPSI5IiBkYXRhLXVpZD0iZW50MDAwNiIgaWQ9ImVudGl0eV8uIC4gLmYgLi4uIC4uIC4gLmcgLi4uIC4uLiI+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgaGVpZ2h0PSIyMi4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iMTk3LjQyNjUiIHg9IjM3My4yOSIgeT0iMTA2Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTc3LjQyNjUiIHg9IjM4My4yOSIgeT0iMTIxLjk5NTEiPiYjMjA1MTY7ICYjODU5NDsgKGYgLi4uICYjMjA1MTY7KSAmIzg1OTQ7IChnIC4uLiAmIzMyMDgwOyYjMjY1MjQ7KTwvdGV4dD48L2c+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9IkdNTjciIGRhdGEtc291cmNlLWxpbmU9IjE0IiBkYXRhLXVpZD0iZW50MDAwOCIgaWQ9ImVudGl0eV9HTU43Ij48cGF0aCBkPSJNMjE5LDIwMC4yOSBMMjE5LDI0MC41NTU2IEwzODMuMDAwMiwyNDAuNTU1NiBMMzgzLjAwMDIsMjEwLjI5IEwzNzMuMDAwMiwyMDAuMjkgTDIxOSwyMDAuMjkiIGZpbGw9IiNGRkZGRkYiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48cGF0aCBkPSJNMzczLjAwMDIsMjAwLjI5IEwzNzMuMDAwMiwyMTAuMjkgTDM4My4wMDAyLDIxMC4yOSBMMzczLjAwMDIsMjAwLjI5IiBmaWxsPSIjRkZGRkZGIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTQzLjAwMDIiIHg9IjIyNSIgeT0iMjE3LjM1NjkiPiYjMTI0Njc7JiMxMjUyNDsmIzEyNDYzOyYjMTI0NzE7JiMxMjUxOTsmIzEyNTMxOyYjMjU4MDU7JiMyMDMxNjsmIzEyMzkxOyYjMTIzOTQ7JiMxMjM2Nzs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTMwLjAwMDIiIHg9IjIyNSIgeT0iMjMyLjQ4OTciPiYjMjEzMzY7JiMxOTk2ODsmIzIwNTE2OyYjMTIzOTg7JiMyMjc5MzsmIzI1NTYzOyYjMTIzOTU7JiMzNjk2OTsmIzEyMzc3OyYjMTI0Mjc7PC90ZXh0PjwvZz48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iR01OMTAiIGRhdGEtc291cmNlLWxpbmU9IjE5IiBkYXRhLXVpZD0iZW50MDAxMSIgaWQ9ImVudGl0eV9HTU4xMCI+PHBhdGggZD0iTTUwMi4wNSwyMDAuMjkgTDUwMi4wNSwyNDAuNTU1NiBMNzA5Ljk1NjgsMjQwLjU1NTYgTDcwOS45NTY4LDIxMC4yOSBMNjk5Ljk1NjgsMjAwLjI5IEw1MDIuMDUsMjAwLjI5IiBmaWxsPSIjRkZGRkZGIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBhdGggZD0iTTY5OS45NTY4LDIwMC4yOSBMNjk5Ljk1NjgsMjEwLjI5IEw3MDkuOTU2OCwyMTAuMjkgTDY5OS45NTY4LDIwMC4yOSIgZmlsbD0iI0ZGRkZGRiIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjkxLjAwMDEiIHg9IjUwOC4wNSIgeT0iMjE3LjM1NjkiPiYjMTI0NzE7JiMxMjU0MDsmIzEyNDY1OyYjMTI1MzE7JiMxMjQ3MzsmIzI1ODA1OyYjMjAzMTY7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE4Ni45MDY4IiB4PSI1MDguMDUiIHk9IjIzMi40ODk3Ij4obWFwLCBmaWx0ZXIsIHJlZHVjZSkgJiMxMjM5NTsmIzM2OTY5OyYjMTIzNzc7JiMxMjQyNzs8L3RleHQ+PC9nPjwhLS1saW5rIHRmIHRvIEdNTjctLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0idGYiIGRhdGEtZW50aXR5LTI9IkdNTjciIGRhdGEtc291cmNlLWxpbmU9IjE0IiBkYXRhLXVpZD0ibG5rOSIgaWQ9ImxpbmtfdGZfR01ONyI+PHBhdGggZD0iTTMwMSwxNTIuNjY0NCBDMzAxLDE1Mi43OTcyIDMwMSwxNTIuOTMwMSAzMDEsMTUzLjA2MzEgQzMwMSwxNTMuMzI5MiAzMDEsMTUzLjU5NiAzMDEsMTUzLjg2MzQgQzMwMSwxNTQuMzk4MSAzMDEsMTU0LjkzNTMgMzAxLDE1NS40NzQ3IEMzMDEsMTU3LjYzMjEgMzAxLDE1OS44MjQyIDMwMSwxNjIuMDMzOCBDMzAxLDE2Ni40NTI5IDMwMSwxNzAuOTQyIDMwMSwxNzUuMzYzIEMzMDEsMTg0LjIwNSAzMDEsMTkyLjc3NSAzMDEsMTk5Ljk3IiBmaWxsPSJub25lIiBpZD0idGYtR01ONyIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxO3N0cm9rZS1kYXNoYXJyYXk6Nyw3OyIvPjwvZz48IS0tbGluayB0bCB0byBHTU4xMC0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJ0bCIgZGF0YS1lbnRpdHktMj0iR01OMTAiIGRhdGEtc291cmNlLWxpbmU9IjE5IiBkYXRhLXVpZD0ibG5rMTIiIGlkPSJsaW5rX3RsX0dNTjEwIj48cGF0aCBkPSJNNjA2LDE1Mi42NjQ0IEM2MDYsMTUyLjc5NzIgNjA2LDE1Mi45MzAxIDYwNiwxNTMuMDYzMSBDNjA2LDE1My4zMjkyIDYwNiwxNTMuNTk2IDYwNiwxNTMuODYzNCBDNjA2LDE1NC4zOTgxIDYwNiwxNTQuOTM1MyA2MDYsMTU1LjQ3NDcgQzYwNiwxNTcuNjMyMSA2MDYsMTU5LjgyNDIgNjA2LDE2Mi4wMzM4IEM2MDYsMTY2LjQ1MjkgNjA2LDE3MC45NDIgNjA2LDE3NS4zNjMgQzYwNiwxODQuMjA1IDYwNiwxOTIuNzc1IDYwNiwxOTkuOTciIGZpbGw9Im5vbmUiIGlkPSJ0bC1HTU4xMCIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxO3N0cm9rZS1kYXNoYXJyYXk6Nyw3OyIvPjwvZz48IS0tU1JDPVtSVDNESWlEMDQwVm0tcHg1YzVDMlJIeDFUcmNKdEpRbUlTZnNGT2RHdEdMNWY1SnFlYlh3aUwzeUxlaE9XaHdDcXFIeTJwUzlMQ05VVGZRUDdfRVZCVExiQU9FVWU0YjZZNklIZWJiN0NGM0dCRDdVZVJMZTN6NVNlUHNaVUs4eEdWRTh6anczbFRfRHhNdG1MTFNvNmhUdjhsaWd5ODNzR043TjVMNFBXclNDZmwxblMwZS1YLWVQWGM3R3IxdHVWM2FmOS1Gd29vRnh2Ml94dW1nd1BpS2NyaXJOejlnandlUWtNR1Rka01BbWFva0xmdjFwam5yMUN3eW9rYUpjNVV0Q1BJcEZYZ2x0Q1VlUHdYbEs4cjhDcHJVQldOREhGbkpKZXQ5cVlWaHNJci1abGExcEo1V01HeU4tbm1NZnBKU3FwX05mYmVyQ185SnNNaTBKZVBYaVdNSm5SaUcyczhYLTBtMDBdLS0+PC9nPjwvc3ZnPg==" class="uml" alt="uml diagram" title="" /></p>
<h3 id="410">4.10 ワードスコアリングの例<a class="headerlink" href="#410" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="kd">defn </span><span class="nv">score</span><span class="w"> </span><span class="p">[</span><span class="nv">word</span><span class="p">]</span>
<span class="w">  </span><span class="p">(</span><span class="nb">count </span><span class="p">(</span><span class="nf">clojure.string/replace</span><span class="w"> </span><span class="nv">word</span><span class="w"> </span><span class="s">&quot;a&quot;</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">)))</span>

<span class="p">(</span><span class="kd">defn </span><span class="nv">bonus</span><span class="w"> </span><span class="p">[</span><span class="nv">word</span><span class="p">]</span>
<span class="w">  </span><span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">clojure.string/includes?</span><span class="w"> </span><span class="nv">word</span><span class="w"> </span><span class="s">&quot;c&quot;</span><span class="p">)</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span>

<span class="p">(</span><span class="kd">defn </span><span class="nv">penalty</span><span class="w"> </span><span class="p">[</span><span class="nv">word</span><span class="p">]</span>
<span class="w">  </span><span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">clojure.string/includes?</span><span class="w"> </span><span class="nv">word</span><span class="w"> </span><span class="s">&quot;s&quot;</span><span class="p">)</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span>

<span class="p">(</span><span class="kd">defn </span><span class="nv">ranked-words</span><span class="w"> </span><span class="p">[</span><span class="nv">word-scorer</span><span class="w"> </span><span class="nv">words</span><span class="p">]</span>
<span class="w">  </span><span class="p">(</span><span class="nb">reverse </span><span class="p">(</span><span class="nb">sort-by </span><span class="nv">word-scorer</span><span class="w"> </span><span class="nv">words</span><span class="p">)))</span>

<span class="p">(</span><span class="k">def </span><span class="nv">words</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;ada&quot;</span><span class="w"> </span><span class="s">&quot;haskell&quot;</span><span class="w"> </span><span class="s">&quot;scala&quot;</span><span class="w"> </span><span class="s">&quot;java&quot;</span><span class="w"> </span><span class="s">&quot;rust&quot;</span><span class="p">])</span>

<span class="c1">;; 基本スコアでランキング</span>
<span class="p">(</span><span class="nf">ranked-words</span><span class="w"> </span><span class="nv">score</span><span class="w"> </span><span class="nv">words</span><span class="p">)</span>
<span class="c1">; =&gt; (&quot;haskell&quot; &quot;rust&quot; &quot;scala&quot; &quot;java&quot; &quot;ada&quot;)</span>

<span class="c1">;; ボーナス付きスコアでランキング</span>
<span class="p">(</span><span class="nf">ranked-words</span><span class="w"> </span><span class="o">#</span><span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">score</span><span class="w"> </span><span class="nv">%</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">bonus</span><span class="w"> </span><span class="nv">%</span><span class="p">))</span><span class="w"> </span><span class="nv">words</span><span class="p">)</span>
<span class="c1">; =&gt; (&quot;scala&quot; &quot;haskell&quot; &quot;rust&quot; &quot;java&quot; &quot;ada&quot;)</span>
</code></pre></div>
<hr />
<h2 id="5-mapcat">第5章: mapcat とネスト構造<a class="headerlink" href="#5-mapcat" title="Permanent link">&para;</a></h2>
<h3 id="51-flatten-">5.1 flatten - ネストを平坦化<a class="headerlink" href="#51-flatten-" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">;; flatten は完全に平坦化</span>
<span class="p">(</span><span class="nf">flatten</span><span class="w"> </span><span class="p">[[</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="mi">3</span><span class="w"> </span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="mi">5</span><span class="p">]])</span>
<span class="c1">; =&gt; (1 2 3 4 5)</span>

<span class="p">(</span><span class="nf">flatten</span><span class="w"> </span><span class="p">[[[</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span><span class="w"> </span><span class="p">[[</span><span class="mi">4</span><span class="w"> </span><span class="mi">5</span><span class="p">]]])</span>
<span class="c1">; =&gt; (1 2 3 4 5)</span>

<span class="c1">;; apply concat は1レベルだけ平坦化</span>
<span class="p">(</span><span class="nb">apply concat </span><span class="p">[[</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="mi">3</span><span class="w"> </span><span class="mi">4</span><span class="p">]])</span>
<span class="c1">; =&gt; (1 2 3 4)</span>
</code></pre></div>
<h3 id="52-mapcat-map-concat">5.2 mapcat = map + concat<a class="headerlink" href="#52-mapcat-map-concat" title="Permanent link">&para;</a></h3>
<p><code>mapcat</code> は Scala の <code>flatMap</code> に相当します。</p>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="k">def </span><span class="nv">books</span>
<span class="w">  </span><span class="p">[{</span><span class="ss">:title</span><span class="w"> </span><span class="s">&quot;FP in Scala&quot;</span><span class="w"> </span><span class="ss">:authors</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;Chiusano&quot;</span><span class="w"> </span><span class="s">&quot;Bjarnason&quot;</span><span class="p">]}</span>
<span class="w">   </span><span class="p">{</span><span class="ss">:title</span><span class="w"> </span><span class="s">&quot;The Hobbit&quot;</span><span class="w"> </span><span class="ss">:authors</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;Tolkien&quot;</span><span class="p">]}])</span>

<span class="c1">;; map だけだとネストする</span>
<span class="p">(</span><span class="nb">map </span><span class="ss">:authors</span><span class="w"> </span><span class="nv">books</span><span class="p">)</span>
<span class="c1">; =&gt; ([&quot;Chiusano&quot; &quot;Bjarnason&quot;] [&quot;Tolkien&quot;])</span>

<span class="c1">;; mapcat で平坦化</span>
<span class="p">(</span><span class="nb">mapcat </span><span class="ss">:authors</span><span class="w"> </span><span class="nv">books</span><span class="p">)</span>
<span class="c1">; =&gt; (&quot;Chiusano&quot; &quot;Bjarnason&quot; &quot;Tolkien&quot;)</span>
</code></pre></div>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkRFU0NSSVBUSU9OIiBoZWlnaHQ9IjI1NXB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6MTk2cHg7aGVpZ2h0OjI1NXB4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDE5NiAyNTUiIHdpZHRoPSIxOTZweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PGRlZnMvPjxnPjwhLS1jbHVzdGVyIG1hcGNhdCA/Pz8tLT48ZyBjbGFzcz0iY2x1c3RlciIgZGF0YS1lbnRpdHk9Im1hcGNhdCAuLi4iIGRhdGEtc291cmNlLWxpbmU9IjMiIGRhdGEtdWlkPSJlbnQwMDAyIiBpZD0iY2x1c3Rlcl9tYXBjYXQgLi4uIj48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjIzNy44OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjE3OCIgeD0iMTIiIHk9IjEyIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEwNS4zNjkiIHg9IjQ4LjMxNTUiIHk9IjI2Ljk5NTEiPm1hcGNhdCAmIzEyMzk4OyYjMjEyMDU7JiMyMDMxNjs8L3RleHQ+PC9nPjwhLS1lbnRpdHkgbmVzdGVkLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9Im5lc3RlZCIgZGF0YS1zb3VyY2UtbGluZT0iNCIgZGF0YS11aWQ9ImVudDAwMDMiIGlkPSJlbnRpdHlfbmVzdGVkIj48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjIyLjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSIxMzkuNzk5OCIgeD0iMzEuMSIgeT0iNDciLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMTkuNzk5OCIgeD0iNDEuMSIgeT0iNjIuOTk1MSI+bWFwOiBbW0EsIEJdLCBbQ11dPC90ZXh0PjwvZz48IS0tZW50aXR5IG9wLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9Im9wIiBkYXRhLXNvdXJjZS1saW5lPSI1IiBkYXRhLXVpZD0iZW50MDAwNCIgaWQ9ImVudGl0eV9vcCI+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgaGVpZ2h0PSIyMi4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iMTQ2LjA2ODEiIHg9IjI3Ljk3IiB5PSIxMjkuMyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEyNi4wNjgxIiB4PSIzNy45NyIgeT0iMTQ1LjI5NTEiPmNvbmNhdDogJiMzMjA4MDsmIzI2NTI0OyYjMTI0MzQ7JiMzNjg5OTsmIzMyMDgwOzwvdGV4dD48L2c+PCEtLWVudGl0eSBmbGF0LS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9ImZsYXQiIGRhdGEtc291cmNlLWxpbmU9IjYiIGRhdGEtdWlkPSJlbnQwMDA1IiBpZD0iZW50aXR5X2ZsYXQiPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iMjIuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9Ijc3LjY4MTYiIHg9IjYyLjE2IiB5PSIyMTEuNTkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1Ny42ODE2IiB4PSI3Mi4xNiIgeT0iMjI3LjU4NTEiPltBLCBCLCBDXTwvdGV4dD48L2c+PCEtLWxpbmsgbmVzdGVkIHRvIG9wLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9Im5lc3RlZCIgZGF0YS1lbnRpdHktMj0ib3AiIGRhdGEtc291cmNlLWxpbmU9IjgiIGRhdGEtdWlkPSJsbms2IiBpZD0ibGlua19uZXN0ZWRfb3AiPjxwYXRoIGQ9Ik0xMDEsNjkuNjUgQzEwMSw4NS4wMyAxMDEsMTA3LjU1IDEwMSwxMjIuOTQiIGZpbGw9Im5vbmUiIGlkPSJuZXN0ZWQtdG8tb3AiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMDAwMDAwIiBwb2ludHM9IjEwMSwxMjguOTQsMTA1LDExOS45NCwxMDEsMTIzLjk0LDk3LDExOS45NCwxMDEsMTI4Ljk0IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjwhLS1saW5rIG9wIHRvIGZsYXQtLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0ib3AiIGRhdGEtZW50aXR5LTI9ImZsYXQiIGRhdGEtc291cmNlLWxpbmU9IjkiIGRhdGEtdWlkPSJsbms3IiBpZD0ibGlua19vcF9mbGF0Ij48cGF0aCBkPSJNMTAxLDE1MS45NCBDMTAxLDE2Ny4zMyAxMDEsMTg5Ljg1IDEwMSwyMDUuMjQiIGZpbGw9Im5vbmUiIGlkPSJvcC10by1mbGF0IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzAwMDAwMCIgcG9pbnRzPSIxMDEsMjExLjI0LDEwNSwyMDIuMjQsMTAxLDIwNi4yNCw5NywyMDIuMjQsMTAxLDIxMS4yNCIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjwvZz48IS0tU1JDPVtLb3A5SUNyRExJWjhJU3BDdS04Z0lhcWtJU25CcHFiTEtDZkRCNFhFQjU1dXRCWmtRVlZLOXRsZEEyYktTb0tkNWdNMFBRbUtlZ0NUVEhJU09kS0tlZnJaT3ZLSzRlaUx5YkFCSXI5SmU2Z0l5X0Uwa2dxS2RjLVR5NnBVZENURGFydXNCMFFvbUdocDJ3MkFtNFJlQTNYM3pBVmI5OVBtU0s1Q0tUM0xqR0Vmb295MGl5MUlqRzAwXS0tPjwvZz48L3N2Zz4=" class="uml" alt="uml diagram" title="" /></p>
<h3 id="53-mapcat">5.3 mapcat によるサイズ変化<a class="headerlink" href="#53-mapcat" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">;; 要素数が増える</span>
<span class="p">(</span><span class="nb">mapcat </span><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">x</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="nv">x</span><span class="w"> </span><span class="nv">x</span><span class="p">])</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">])</span>
<span class="c1">; =&gt; (1 1 2 2 3 3)</span>

<span class="c1">;; 要素数が同じ</span>
<span class="p">(</span><span class="nb">mapcat </span><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">x</span><span class="p">]</span><span class="w"> </span><span class="p">[(</span><span class="nb">* </span><span class="mi">2</span><span class="w"> </span><span class="nv">x</span><span class="p">)])</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="p">])</span>
<span class="c1">; =&gt; (2 4 6)</span>

<span class="c1">;; 要素数が減る（フィルタリング効果）</span>
<span class="p">(</span><span class="nb">mapcat </span><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">x</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">even?</span><span class="w"> </span><span class="nv">x</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="nv">x</span><span class="p">]</span><span class="w"> </span><span class="p">[]))</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">5</span><span class="p">])</span>
<span class="c1">; =&gt; (2 4)</span>
</code></pre></div>
<h3 id="54-mapcat">5.4 ネストした mapcat<a class="headerlink" href="#54-mapcat" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="kd">defn </span><span class="nv">book-adaptations</span><span class="w"> </span><span class="p">[</span><span class="nv">author</span><span class="p">]</span>
<span class="w">  </span><span class="p">(</span><span class="nf">case</span><span class="w"> </span><span class="nv">author</span>
<span class="w">    </span><span class="s">&quot;Tolkien&quot;</span><span class="w"> </span><span class="p">[{</span><span class="ss">:title</span><span class="w"> </span><span class="s">&quot;An Unexpected Journey&quot;</span><span class="p">}</span>
<span class="w">               </span><span class="p">{</span><span class="ss">:title</span><span class="w"> </span><span class="s">&quot;The Desolation of Smaug&quot;</span><span class="p">}]</span>
<span class="w">    </span><span class="p">[]))</span>

<span class="c1">;; ネストした mapcat</span>
<span class="p">(</span><span class="nf">mapcat</span>
<span class="w">  </span><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">book</span><span class="p">]</span>
<span class="w">    </span><span class="p">(</span><span class="nf">mapcat</span>
<span class="w">      </span><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">author</span><span class="p">]</span>
<span class="w">        </span><span class="p">(</span><span class="nf">map</span>
<span class="w">          </span><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">movie</span><span class="p">]</span>
<span class="w">            </span><span class="p">(</span><span class="nb">str </span><span class="s">&quot;You may like &quot;</span><span class="w"> </span><span class="p">(</span><span class="ss">:title</span><span class="w"> </span><span class="nv">movie</span><span class="p">)</span>
<span class="w">                 </span><span class="s">&quot;, because you liked &quot;</span><span class="w"> </span><span class="nv">author</span><span class="w"> </span><span class="s">&quot;&#39;s &quot;</span><span class="w"> </span><span class="p">(</span><span class="ss">:title</span><span class="w"> </span><span class="nv">book</span><span class="p">)))</span>
<span class="w">          </span><span class="p">(</span><span class="nf">book-adaptations</span><span class="w"> </span><span class="nv">author</span><span class="p">)))</span>
<span class="w">      </span><span class="p">(</span><span class="ss">:authors</span><span class="w"> </span><span class="nv">book</span><span class="p">)))</span>
<span class="w">  </span><span class="nv">books</span><span class="p">)</span>
</code></pre></div>
<h3 id="55-for">5.5 for 内包表記<a class="headerlink" href="#55-for" title="Permanent link">&para;</a></h3>
<p>Clojure の <code>for</code> は Scala の for 内包表記に相当します。</p>
<div class="highlight"><pre><span></span><code><span class="c1">;; ネストした mapcat と等価</span>
<span class="p">(</span><span class="nb">for </span><span class="p">[</span><span class="nv">book</span><span class="w"> </span><span class="nv">books</span>
<span class="w">      </span><span class="nv">author</span><span class="w"> </span><span class="p">(</span><span class="ss">:authors</span><span class="w"> </span><span class="nv">book</span><span class="p">)</span>
<span class="w">      </span><span class="nv">movie</span><span class="w"> </span><span class="p">(</span><span class="nf">book-adaptations</span><span class="w"> </span><span class="nv">author</span><span class="p">)]</span>
<span class="w">  </span><span class="p">(</span><span class="nb">str </span><span class="s">&quot;You may like &quot;</span><span class="w"> </span><span class="p">(</span><span class="ss">:title</span><span class="w"> </span><span class="nv">movie</span><span class="p">)</span>
<span class="w">       </span><span class="s">&quot;, because you liked &quot;</span><span class="w"> </span><span class="nv">author</span><span class="w"> </span><span class="s">&quot;&#39;s &quot;</span><span class="w"> </span><span class="p">(</span><span class="ss">:title</span><span class="w"> </span><span class="nv">book</span><span class="p">)))</span>
<span class="c1">; =&gt; (&quot;You may like An Unexpected Journey, because you liked Tolkien&#39;s The Hobbit&quot;</span>
<span class="c1">;     &quot;You may like The Desolation of Smaug, because you liked Tolkien&#39;s The Hobbit&quot;)</span>
</code></pre></div>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkRFU0NSSVBUSU9OIiBoZWlnaHQ9IjQ2MnB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6MjU0cHg7aGVpZ2h0OjQ2MnB4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDI1NCA0NjIiIHdpZHRoPSIyNTRweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PGRlZnMvPjxnPjwhLS1jbHVzdGVyIGZvciA/Pz8/Pz8/Py0tPjxnIGNsYXNzPSJjbHVzdGVyIiBkYXRhLWVudGl0eT0iZm9yIC4uLi4uLi4uIiBkYXRhLXNvdXJjZS1saW5lPSIzIiBkYXRhLXVpZD0iZW50MDAwMiIgaWQ9ImNsdXN0ZXJfZm9yIC4uLi4uLi4uIj48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjM3MS4xOSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjIzNiIgeD0iMTIiIHk9IjEyIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEzOS40ODY4IiB4PSI2MC4yNTY2IiB5PSIyNi45OTUxIj5mb3IgJiMyMDg2OTsmIzIxMjUzOyYjMzQ5MjA7JiMzNTM1MjsmIzEyMzk4OyYjMTI1MDE7JiMxMjUyNTsmIzEyNTQwOzwvdGV4dD48L2c+PCEtLWVudGl0eSBib29rcy0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJib29rcyIgZGF0YS1zb3VyY2UtbGluZT0iNCIgZGF0YS11aWQ9ImVudDAwMDMiIGlkPSJlbnRpdHlfYm9va3MiPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iMjIuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjYxLjQxODkiIHg9Ijk5LjI5IiB5PSI0NyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjQxLjQxODkiIHg9IjEwOS4yOSIgeT0iNjIuOTk1MSI+Ym9va3M8L3RleHQ+PC9nPjwhLS1lbnRpdHkgYXV0aG9ycy0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJhdXRob3JzIiBkYXRhLXNvdXJjZS1saW5lPSI1IiBkYXRhLXVpZD0iZW50MDAwNCIgaWQ9ImVudGl0eV9hdXRob3JzIj48cmVjdCBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjIyLjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSIxMjcuNjQ1NSIgeD0iNjYuMTgiIHk9IjE0Ni4zIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTA3LjY0NTUiIHg9Ijc2LjE4IiB5PSIxNjIuMjk1MSI+KDphdXRob3JzIGJvb2spPC90ZXh0PjwvZz48IS0tZW50aXR5IG1vdmllcy0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJtb3ZpZXMiIGRhdGEtc291cmNlLWxpbmU9IjYiIGRhdGEtdWlkPSJlbnQwMDA1IiBpZD0iZW50aXR5X21vdmllcyI+PHJlY3QgZmlsbD0iI0ZGRkZGRiIgaGVpZ2h0PSIyMi4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iMjAzLjc5NzkiIHg9IjI4LjEiIHk9IjI0NS41OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJWZXJkYW5hIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE4My43OTc5IiB4PSIzOC4xIiB5PSIyNjEuNTg1MSI+KGJvb2stYWRhcHRhdGlvbnMgYXV0aG9yKTwvdGV4dD48L2c+PCEtLWVudGl0eSByZXN1bHQtLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0icmVzdWx0IiBkYXRhLXNvdXJjZS1saW5lPSI3IiBkYXRhLXVpZD0iZW50MDAwNiIgaWQ9ImVudGl0eV9yZXN1bHQiPjxyZWN0IGZpbGw9IiNGRkZGRkYiIGhlaWdodD0iMjIuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjE4NC4zMTU0IiB4PSIzNy44NCIgeT0iMzQ0Ljg5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTY0LjMxNTQiIHg9IjQ3Ljg0IiB5PSIzNjAuODg1MSI+cmVjb21tZW5kYXRpb24gc3RyaW5nPC90ZXh0PjwvZz48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iR01OMTAiIGRhdGEtc291cmNlLWxpbmU9IjE1IiBkYXRhLXVpZD0iZW50MDAxMSIgaWQ9ImVudGl0eV9HTU4xMCI+PHBhdGggZD0iTTM3LDQzMC4xOSBMMzcsNDU1LjMyMjggQTAsMCAwIDAgMCAzNyw0NTUuMzIyOCBMMjIzLjAwNzUsNDU1LjMyMjggQTAsMCAwIDAgMCAyMjMuMDA3NSw0NTUuMzIyOCBMMjIzLjAwNzUsNDQwLjE5IEwyMTMuMDA3NSw0MzAuMTkgTDEzNCw0MzAuMTkgTDEzMCwzNjcuNDMgTDEyNiw0MzAuMTkgTDM3LDQzMC4xOSBBMCwwIDAgMCAwIDM3LDQzMC4xOSIgZmlsbD0iI0ZGRkZGRiIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjxwYXRoIGQ9Ik0yMTMuMDA3NSw0MzAuMTkgTDIxMy4wMDc1LDQ0MC4xOSBMMjIzLjAwNzUsNDQwLjE5IEwyMTMuMDA3NSw0MzAuMTkiIGZpbGw9IiNGRkZGRkYiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNjUuMDA3NSIgeD0iNDMiIHk9IjQ0Ny4yNTY5Ij5mb3IgJiMxMjM5OTsmIzM2OTMzOyYjMjQzMTA7JiMxMjQ3MTsmIzEyNTQwOyYjMTI0NjU7JiMxMjUzMTsmIzEyNDczOyYjMTI0MzQ7JiMyOTk4MzsmIzI1MTA0OzwvdGV4dD48L2c+PCEtLWxpbmsgYm9va3MgdG8gYXV0aG9ycy0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJib29rcyIgZGF0YS1lbnRpdHktMj0iYXV0aG9ycyIgZGF0YS1zb3VyY2UtbGluZT0iOSIgZGF0YS11aWQ9ImxuazciIGlkPSJsaW5rX2Jvb2tzX2F1dGhvcnMiPjxwYXRoIGQ9Ik0xMzAsNjkuNTYgQzEzMCw4OC4xOSAxMzAsMTIxLjAzIDEzMCwxMzkuODEiIGZpbGw9Im5vbmUiIGlkPSJib29rcy10by1hdXRob3JzIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzAwMDAwMCIgcG9pbnRzPSIxMzAsMTQ1LjgxLDEzNCwxMzYuODEsMTMwLDE0MC44MSwxMjYsMTM2LjgxLDEzMCwxNDUuODEiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0iVmVyZGFuYSIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNy44NzUiIHg9IjEzMSIgeT0iMTEyLjM2NjkiPmZvcjwvdGV4dD48L2c+PCEtLWxpbmsgYXV0aG9ycyB0byBtb3ZpZXMtLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iYXV0aG9ycyIgZGF0YS1lbnRpdHktMj0ibW92aWVzIiBkYXRhLXNvdXJjZS1saW5lPSIxMCIgZGF0YS11aWQ9ImxuazgiIGlkPSJsaW5rX2F1dGhvcnNfbW92aWVzIj48cGF0aCBkPSJNMTMwLDE2OC44NiBDMTMwLDE4Ny40OSAxMzAsMjIwLjMyIDEzMCwyMzkuMTEiIGZpbGw9Im5vbmUiIGlkPSJhdXRob3JzLXRvLW1vdmllcyIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMwMDAwMDAiIHBvaW50cz0iMTMwLDI0NS4xMSwxMzQsMjM2LjExLDEzMCwyNDAuMTEsMTI2LDIzNi4xMSwxMzAsMjQ1LjExIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTcuODc1IiB4PSIxMzEiIHk9IjIxMS42NTY5Ij5mb3I8L3RleHQ+PC9nPjwhLS1saW5rIG1vdmllcyB0byByZXN1bHQtLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0ibW92aWVzIiBkYXRhLWVudGl0eS0yPSJyZXN1bHQiIGRhdGEtc291cmNlLWxpbmU9IjExIiBkYXRhLXVpZD0ibG5rOSIgaWQ9ImxpbmtfbW92aWVzX3Jlc3VsdCI+PHBhdGggZD0iTTEzMCwyNjguMTUgQzEzMCwyODYuNzggMTMwLDMxOS42MiAxMzAsMzM4LjQxIiBmaWxsPSJub25lIiBpZD0ibW92aWVzLXRvLXJlc3VsdCIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMwMDAwMDAiIHBvaW50cz0iMTMwLDM0NC40MSwxMzQsMzM1LjQxLDEzMCwzMzkuNDEsMTI2LDMzNS40MSwxMzAsMzQ0LjQxIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9IlZlcmRhbmEiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNTIuMDAwMSIgeD0iMTMxIiB5PSIzMTAuOTU2OSI+JiMyNDMzNTsmIzEyNDM0OyYjMzU0MTM7JiMyMDM4NTs8L3RleHQ+PC9nPjwhLS1TUkM9W0RQMm5KaUQwMzhQdEZ1TjkxNERVZTBGbFNaSDc2djZ4Z291azJzOThlWTA2OTEyWTRYbGdMV1AwMjBjNGc3V1A0bmhVV2hqQlJoRV9feFZ6b3RpcWJxaFllWDJ2MWgxb0lhQkYyZWQ5aVI3T05SSlRMVGtsRF90Y2RnamRSYlJTRjc2cEpWMENmaTljYzFtUFNyOGNBNGVDcktadDlzOTlTc0M3VVgzcWFLSTc1ckFIWUdLOW9lc0UtazFMdlpJTnFVZW82UU1hcGU4SEl4QXZkV01SYlVNbzg4MW02akZxQzF4MTJSaHU0M2tsMzJqN09NbXk3dE91dGNzbGtSeGo3clNfdHNpdTF6MjZmOGpGUDFKdU50M3J5YlVydFRTeHJuX2sxTG9fU2xGNnpRU1JzanF6XzV4VVc4azhWa2VWXS0tPjwvZz48L3N2Zz4=" class="uml" alt="uml diagram" title="" /></p>
<h3 id="56-when">5.6 ガード式（:when）<a class="headerlink" href="#56-when" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">;; :when でフィルタリング</span>
<span class="p">(</span><span class="nb">for </span><span class="p">[</span><span class="nv">x</span><span class="w"> </span><span class="p">(</span><span class="nb">range </span><span class="mi">1</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>
<span class="w">      </span><span class="nv">y</span><span class="w"> </span><span class="p">(</span><span class="nb">range </span><span class="mi">1</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>
<span class="w">      </span><span class="ss">:let</span><span class="w"> </span><span class="p">[</span><span class="nv">product</span><span class="w"> </span><span class="p">(</span><span class="nb">* </span><span class="nv">x</span><span class="w"> </span><span class="nv">y</span><span class="p">)]</span>
<span class="w">      </span><span class="ss">:when</span><span class="w"> </span><span class="p">(</span><span class="nf">even?</span><span class="w"> </span><span class="nv">product</span><span class="p">)]</span>
<span class="w">  </span><span class="p">{</span><span class="ss">:x</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="ss">:y</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="ss">:product</span><span class="w"> </span><span class="nv">product</span><span class="p">})</span>
<span class="c1">; =&gt; ({:x 1 :y 2 :product 2} {:x 2 :y 1 :product 2} ...)</span>
</code></pre></div>
<h3 id="57">5.7 円内の点の判定<a class="headerlink" href="#57" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="kd">defn </span><span class="nv">inside?</span><span class="w"> </span><span class="p">[</span><span class="nv">point</span><span class="w"> </span><span class="nv">radius</span><span class="p">]</span>
<span class="w">  </span><span class="p">(</span><span class="nb">&lt;= </span><span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nb">* </span><span class="p">(</span><span class="ss">:x</span><span class="w"> </span><span class="nv">point</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="ss">:x</span><span class="w"> </span><span class="nv">point</span><span class="p">))</span>
<span class="w">         </span><span class="p">(</span><span class="nb">* </span><span class="p">(</span><span class="ss">:y</span><span class="w"> </span><span class="nv">point</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="ss">:y</span><span class="w"> </span><span class="nv">point</span><span class="p">)))</span>
<span class="w">      </span><span class="p">(</span><span class="nb">* </span><span class="nv">radius</span><span class="w"> </span><span class="nv">radius</span><span class="p">)))</span>

<span class="p">(</span><span class="k">def </span><span class="nv">points</span><span class="w"> </span><span class="p">[{</span><span class="ss">:x</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="ss">:y</span><span class="w"> </span><span class="mi">2</span><span class="p">}</span><span class="w"> </span><span class="p">{</span><span class="ss">:x</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="ss">:y</span><span class="w"> </span><span class="mi">1</span><span class="p">}])</span>
<span class="p">(</span><span class="k">def </span><span class="nv">radiuses</span><span class="w"> </span><span class="p">[</span><span class="mi">2</span><span class="w"> </span><span class="mi">1</span><span class="p">])</span>

<span class="c1">;; すべての組み合わせを生成</span>
<span class="p">(</span><span class="nb">for </span><span class="p">[</span><span class="nv">r</span><span class="w"> </span><span class="nv">radiuses</span>
<span class="w">      </span><span class="nv">point</span><span class="w"> </span><span class="nv">points</span><span class="p">]</span>
<span class="w">  </span><span class="p">{</span><span class="ss">:point</span><span class="w"> </span><span class="nv">point</span>
<span class="w">   </span><span class="ss">:radius</span><span class="w"> </span><span class="nv">r</span>
<span class="w">   </span><span class="ss">:inside?</span><span class="w"> </span><span class="p">(</span><span class="nf">inside?</span><span class="w"> </span><span class="nv">point</span><span class="w"> </span><span class="nv">r</span><span class="p">)})</span>

<span class="c1">;; 円内の点のみ</span>
<span class="p">(</span><span class="nb">for </span><span class="p">[</span><span class="nv">r</span><span class="w"> </span><span class="nv">radiuses</span>
<span class="w">      </span><span class="nv">point</span><span class="w"> </span><span class="nv">points</span>
<span class="w">      </span><span class="ss">:when</span><span class="w"> </span><span class="p">(</span><span class="nf">inside?</span><span class="w"> </span><span class="nv">point</span><span class="w"> </span><span class="nv">r</span><span class="p">)]</span>
<span class="w">  </span><span class="p">{</span><span class="ss">:point</span><span class="w"> </span><span class="nv">point</span><span class="w"> </span><span class="ss">:radius</span><span class="w"> </span><span class="nv">r</span><span class="p">})</span>
<span class="c1">; =&gt; ({:point {:x 1, :y 1}, :radius 2})</span>
</code></pre></div>
<h3 id="58-for">5.8 for と型<a class="headerlink" href="#58-for" title="Permanent link">&para;</a></h3>
<p><code>for</code> は常に遅延シーケンスを返します。型を変換するには <code>into</code> を使います。</p>
<div class="highlight"><pre><span></span><code><span class="c1">;; ベクターに変換</span>
<span class="p">(</span><span class="nb">into </span><span class="p">[]</span><span class="w"> </span><span class="p">(</span><span class="nb">for </span><span class="p">[</span><span class="nv">x</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="p">[</span><span class="mi">3</span><span class="w"> </span><span class="mi">4</span><span class="p">]]</span><span class="w"> </span><span class="p">(</span><span class="nb">* </span><span class="nv">x</span><span class="w"> </span><span class="nv">y</span><span class="p">)))</span>
<span class="c1">; =&gt; [3 4 6 8]</span>

<span class="c1">;; セットに変換（重複が除かれる）</span>
<span class="p">(</span><span class="nb">into </span><span class="o">#</span><span class="p">{}</span><span class="w"> </span><span class="p">(</span><span class="nb">for </span><span class="p">[</span><span class="nv">x</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="p">[</span><span class="mi">3</span><span class="w"> </span><span class="mi">4</span><span class="p">]]</span><span class="w"> </span><span class="p">(</span><span class="nb">* </span><span class="nv">x</span><span class="w"> </span><span class="nv">y</span><span class="p">)))</span>
<span class="c1">; =&gt; #{3 4 6 8}</span>
</code></pre></div>
<h3 id="59">5.9 実践例：商品検索<a class="headerlink" href="#59" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="k">def </span><span class="nv">products</span>
<span class="w">  </span><span class="p">[{</span><span class="ss">:id</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="ss">:name</span><span class="w"> </span><span class="s">&quot;Laptop&quot;</span><span class="w"> </span><span class="ss">:category</span><span class="w"> </span><span class="ss">:electronics</span><span class="w"> </span><span class="ss">:price</span><span class="w"> </span><span class="mi">1000</span>
<span class="w">    </span><span class="ss">:tags</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;computer&quot;</span><span class="w"> </span><span class="s">&quot;portable&quot;</span><span class="w"> </span><span class="s">&quot;work&quot;</span><span class="p">]}</span>
<span class="w">   </span><span class="p">{</span><span class="ss">:id</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="ss">:name</span><span class="w"> </span><span class="s">&quot;Phone&quot;</span><span class="w"> </span><span class="ss">:category</span><span class="w"> </span><span class="ss">:electronics</span><span class="w"> </span><span class="ss">:price</span><span class="w"> </span><span class="mi">800</span>
<span class="w">    </span><span class="ss">:tags</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;mobile&quot;</span><span class="w"> </span><span class="s">&quot;portable&quot;</span><span class="p">]}</span>
<span class="w">   </span><span class="p">{</span><span class="ss">:id</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="ss">:name</span><span class="w"> </span><span class="s">&quot;Desk&quot;</span><span class="w"> </span><span class="ss">:category</span><span class="w"> </span><span class="ss">:furniture</span><span class="w"> </span><span class="ss">:price</span><span class="w"> </span><span class="mi">300</span>
<span class="w">    </span><span class="ss">:tags</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;office&quot;</span><span class="w"> </span><span class="s">&quot;work&quot;</span><span class="p">]}])</span>

<span class="c1">;; 条件で検索</span>
<span class="p">(</span><span class="nb">for </span><span class="p">[</span><span class="nv">product</span><span class="w"> </span><span class="nv">products</span>
<span class="w">      </span><span class="ss">:when</span><span class="w"> </span><span class="p">(</span><span class="nb">and </span><span class="p">(</span><span class="nb">&gt;= </span><span class="p">(</span><span class="ss">:price</span><span class="w"> </span><span class="nv">product</span><span class="p">)</span><span class="w"> </span><span class="mi">500</span><span class="p">)</span>
<span class="w">                 </span><span class="p">(</span><span class="nb">= </span><span class="p">(</span><span class="ss">:category</span><span class="w"> </span><span class="nv">product</span><span class="p">)</span><span class="w"> </span><span class="ss">:electronics</span><span class="p">))]</span>
<span class="w">  </span><span class="nv">product</span><span class="p">)</span>

<span class="c1">;; 商品とタグのペアを生成</span>
<span class="p">(</span><span class="nb">for </span><span class="p">[</span><span class="nv">product</span><span class="w"> </span><span class="nv">products</span>
<span class="w">      </span><span class="nv">tag</span><span class="w"> </span><span class="p">(</span><span class="ss">:tags</span><span class="w"> </span><span class="nv">product</span><span class="p">)]</span>
<span class="w">  </span><span class="p">{</span><span class="ss">:product-name</span><span class="w"> </span><span class="p">(</span><span class="ss">:name</span><span class="w"> </span><span class="nv">product</span><span class="p">)</span><span class="w"> </span><span class="ss">:tag</span><span class="w"> </span><span class="nv">tag</span><span class="p">})</span>
</code></pre></div>
<hr />
<h2 id="_1">まとめ<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<h3 id="part-ii">Part II で学んだこと<a class="headerlink" href="#part-ii" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>章</th>
<th>主要概念</th>
<th>キー操作</th>
</tr>
</thead>
<tbody>
<tr>
<td>第3章</td>
<td>イミュータブル</td>
<td><code>conj</code>, <code>into</code>, <code>assoc</code>, <code>update</code></td>
</tr>
<tr>
<td>第4章</td>
<td>高階関数</td>
<td><code>map</code>, <code>filter</code>, <code>reduce</code>, <code>sort-by</code></td>
</tr>
<tr>
<td>第5章</td>
<td>平坦化</td>
<td><code>flatten</code>, <code>mapcat</code>, <code>for</code> 内包表記</td>
</tr>
</tbody>
</table>
<h3 id="scala">Scala との比較<a class="headerlink" href="#scala" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>概念</th>
<th>Scala</th>
<th>Clojure</th>
</tr>
</thead>
<tbody>
<tr>
<td>リスト追加</td>
<td><code>list :+ elem</code></td>
<td><code>(conj vec elem)</code></td>
</tr>
<tr>
<td>スライス</td>
<td><code>list.slice(a, b)</code></td>
<td><code>(subvec vec a b)</code></td>
</tr>
<tr>
<td>map</td>
<td><code>list.map(f)</code></td>
<td><code>(map f coll)</code></td>
</tr>
<tr>
<td>filter</td>
<td><code>list.filter(p)</code></td>
<td><code>(filter p coll)</code></td>
</tr>
<tr>
<td>foldLeft</td>
<td><code>list.foldLeft(init)(f)</code></td>
<td><code>(reduce f init coll)</code></td>
</tr>
<tr>
<td>flatMap</td>
<td><code>list.flatMap(f)</code></td>
<td><code>(mapcat f coll)</code></td>
</tr>
<tr>
<td>for 内包表記</td>
<td><code>for { x &lt;- xs } yield x</code></td>
<td><code>(for [x xs] x)</code></td>
</tr>
</tbody>
</table>
<h3 id="_2">キーポイント<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>イミュータブルデータ</strong>: 元のデータは変更せず、新しいデータを作成</li>
<li><strong>構造共有</strong>: 永続データ構造により効率的なメモリ使用</li>
<li><strong>関数は値</strong>: 関数を引数として渡したり、戻り値として返せる</li>
<li><strong>スレッディングマクロ</strong>: <code>-&gt;</code> と <code>-&gt;&gt;</code> でパイプライン処理</li>
<li><strong>mapcat パターン</strong>: ネストした構造を平坦化しながら変換</li>
<li><strong>for 内包表記</strong>: 宣言的なシーケンス生成</li>
</ol>
<h3 id="_3">次のステップ<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p><a href="../part-3/">Part III: エラーハンドリング</a> では、以下を学びます：</p>
<ul>
<li><code>nil</code> の扱いと <code>some?</code>/<code>nil?</code></li>
<li><code>some-&gt;</code> と <code>some-&gt;&gt;</code> マクロ</li>
<li>結果型パターン（<code>:ok</code>/<code>:error</code>）</li>
<li><code>ex-info</code> と例外処理</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
    <a href="https://github.com/k2works" target="_blank" rel="noopener" title="GitHub Repository/claude-code-booster" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate", "search.suggest", "search.highlight"], "search": "../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
      
        <script src="../../docs/assets/js/extra.js"></script>
      
    
  </body>
</html>