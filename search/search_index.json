{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Grokking Functional Programming","text":"<p>\u300cGrokking Functional Programming\u300d\uff08Micha\u0142 P\u0142achta \u8457\uff09\u306e\u5b66\u7fd2\u7528\u30ea\u30dd\u30b8\u30c8\u30ea\u3067\u3059\u3002 Scala\u3001Java\u3001F# \u306e3\u8a00\u8a9e\u3067\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u5b9f\u88c5\u4f8b\u3068\u65e5\u672c\u8a9e\u89e3\u8aac\u3092\u63d0\u4f9b\u3057\u307e\u3059\u3002</p>"},{"location":"#_1","title":"\u8a00\u8a9e\u5225\u89e3\u8aac","text":""},{"location":"#scala","title":"Scala \u7248","text":"<p>Scala 3 \u3068 cats-effect/fs2 \u3092\u4f7f\u3063\u305f\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u5b9f\u88c5\u4f8b\u3067\u3059\u3002</p> <ul> <li>Scala \u89e3\u8aac</li> </ul>"},{"location":"#java","title":"Java \u7248","text":"<p>Java 21 \u3068 Vavr \u3092\u4f7f\u3063\u305f\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u5b9f\u88c5\u4f8b\u3067\u3059\u3002</p> <ul> <li>Java \u89e3\u8aac</li> </ul>"},{"location":"#f","title":"F# \u7248","text":"<p>F# 8 \u3068 .NET \u3092\u4f7f\u3063\u305f\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u5b9f\u88c5\u4f8b\u3067\u3059\u3002</p> <ul> <li>F# \u89e3\u8aac</li> </ul>"},{"location":"#_2","title":"\u7ae0\u69cb\u6210","text":"Part \u5185\u5bb9 Scala Java F# I \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u790e part-1 part-1 part-1 II \u95a2\u6570\u578b\u30b9\u30bf\u30a4\u30eb\u306e\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0 part-2 part-2 part-2 III \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0 part-3 part-3 part-3 IV IO \u3068\u526f\u4f5c\u7528\u306e\u7ba1\u7406 part-4 part-4 part-4 V \u4e26\u884c\u51e6\u7406 part-5 part-5 part-5 VI \u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3 part-6 part-6 part-6"},{"location":"#_3","title":"\u4e3b\u8981\u30c8\u30d4\u30c3\u30af","text":"Part \u4e3b\u8981\u30c8\u30d4\u30c3\u30af Scala Java F# I \u7d14\u7c8b\u95a2\u6570\u3001\u53c2\u7167\u900f\u904e\u6027 \u95a2\u6570\u578b\u57fa\u790e \u95a2\u6570\u578b\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9 let \u30d0\u30a4\u30f3\u30c7\u30a3\u30f3\u30b0 II \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u3001\u9ad8\u968e\u95a2\u6570\u3001flatMap List, Option Vavr List, Option List, \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3 III Option\u3001Either\u3001ADT sealed trait sealed interface \u5224\u5225\u5171\u7528\u4f53 IV IO \u30e2\u30ca\u30c9\u3001Stream cats-effect, fs2 \u72ec\u81ea IO, Vavr Stream Async, Seq V Ref\u3001Fiber\u3001\u4e26\u5217\u51e6\u7406 cats-effect Ref/Fiber \u72ec\u81ea Ref, Virtual Thread Ref, MailboxProcessor VI Resource\u3001\u30c6\u30b9\u30c8 ScalaCheck JUnit 5 \u30d7\u30ed\u30d1\u30c6\u30a3\u30c6\u30b9\u30c8 use \u30d0\u30a4\u30f3\u30c7\u30a3\u30f3\u30b0, FsCheck"},{"location":"#_4","title":"\u53c2\u7167","text":"<ul> <li>Grokking Functional Programming - \u539f\u8457</li> <li>Scala \u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8</li> <li>cats-effect</li> <li>fs2</li> <li>Vavr</li> <li>F# \u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8</li> <li>F# for Fun and Profit</li> </ul>"},{"location":"fsharp/","title":"Grokking Functional Programming \u65e5\u672c\u8a9e\u89e3\u8aac\uff08F# \u7248\uff09","text":"<p>\u672c\u30b7\u30ea\u30fc\u30ba\u306f\u300cGrokking Functional Programming\u300d\uff08Micha\u0142 P\u0142achta \u8457\uff09\u306e\u5b66\u7fd2\u30b3\u30f3\u30d1\u30cb\u30aa\u30f3\u3068\u3057\u3066\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u6982\u5ff5\u3092 F# \u3067\u5b9f\u88c5\u3057\u306a\u304c\u3089\u65e5\u672c\u8a9e\u3067\u89e3\u8aac\u3057\u307e\u3059\u3002</p>"},{"location":"fsharp/#_1","title":"\u5bfe\u8c61\u8aad\u8005","text":"<ul> <li>C# \u3084 .NET \u306e\u7d4c\u9a13\u304c\u3042\u308a\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u8208\u5473\u304c\u3042\u308b\u958b\u767a\u8005</li> <li>F# \u3092\u5b66\u3073\u305f\u3044\u304c\u3001FP \u306e\u6982\u5ff5\u304b\u3089\u7406\u89e3\u3057\u305f\u3044\u65b9</li> <li>\u5b9f\u8df5\u7684\u306a FP \u306e\u9069\u7528\u65b9\u6cd5\u3092\u77e5\u308a\u305f\u3044 .NET \u30a8\u30f3\u30b8\u30cb\u30a2</li> </ul>"},{"location":"fsharp/#_2","title":"\u8a18\u4e8b\u4e00\u89a7","text":""},{"location":"fsharp/#part-i","title":"Part I: \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u790e","text":"<p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u672c\u6982\u5ff5\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c1\u7ae0 \u547d\u4ee4\u578b vs \u95a2\u6570\u578b\u3001F# \u57fa\u672c\u69cb\u6587 \u7b2c2\u7ae0 \u7d14\u7c8b\u95a2\u6570\u3001\u526f\u4f5c\u7528\u306e\u6392\u9664\u3001\u30c6\u30b9\u30c8\u306e\u5bb9\u6613\u3055 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: \u7d14\u7c8b\u95a2\u6570\u3001\u53c2\u7167\u900f\u904e\u6027\u3001\u526f\u4f5c\u7528\u3001let \u30d0\u30a4\u30f3\u30c7\u30a3\u30f3\u30b0</p>"},{"location":"fsharp/#part-ii","title":"Part II: \u95a2\u6570\u578b\u30b9\u30bf\u30a4\u30eb\u306e\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0","text":"<p>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c\u3068\u9ad8\u968e\u95a2\u6570\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c3\u7ae0 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u3001List \u64cd\u4f5c \u7b2c4\u7ae0 \u9ad8\u968e\u95a2\u6570\u3001List.map/filter/fold \u7b2c5\u7ae0 \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50\u3001\u30b3\u30f3\u30d4\u30e5\u30c6\u30fc\u30b7\u30e7\u30f3\u5f0f <p>\u30ad\u30fc\u30ef\u30fc\u30c9: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u3001\u9ad8\u968e\u95a2\u6570\u3001\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\uff08|&gt;\uff09\u3001\u30b3\u30f3\u30d4\u30e5\u30c6\u30fc\u30b7\u30e7\u30f3\u5f0f</p>"},{"location":"fsharp/#part-iii-optionresult","title":"Part III: \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3068 Option/Result","text":"<p>\u578b\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c6\u7ae0 Option \u578b\u3001Some/None \u7b2c7\u7ae0 Result \u578b\u3001\u5224\u5225\u5171\u7528\u4f53\u3001\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: Option\u3001Result\u3001\u5224\u5225\u5171\u7528\u4f53\uff08Discriminated Union\uff09</p>"},{"location":"fsharp/#part-iv-async","title":"Part IV: Async \u3068\u526f\u4f5c\u7528\u306e\u7ba1\u7406","text":"<p>\u975e\u540c\u671f\u51e6\u7406\u3068\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c8\u7ae0 Async \u30ef\u30fc\u30af\u30d5\u30ed\u30fc\u3001\u975e\u540c\u671f\u30b3\u30f3\u30d4\u30e5\u30c6\u30fc\u30b7\u30e7\u30f3 \u7b2c9\u7ae0 Seq\uff08\u9045\u5ef6\u30b7\u30fc\u30b1\u30f3\u30b9\uff09\u3001AsyncSeq <p>\u30ad\u30fc\u30ef\u30fc\u30c9: Async\u3001\u9045\u5ef6\u8a55\u4fa1\u3001\u30b7\u30fc\u30b1\u30f3\u30b9\u51e6\u7406</p>"},{"location":"fsharp/#part-v","title":"Part V: \u4e26\u884c\u51e6\u7406","text":"<p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u4e26\u884c\u51e6\u7406\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c10\u7ae0 MailboxProcessor\u3001Async.Parallel <p>\u30ad\u30fc\u30ef\u30fc\u30c9: \u4e26\u884c\u51e6\u7406\u3001MailboxProcessor\uff08Agent\uff09\u3001Async.Parallel</p>"},{"location":"fsharp/#part-vi","title":"Part VI: \u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u3068\u30c6\u30b9\u30c8","text":"<p>\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u3068\u30c6\u30b9\u30c8\u6226\u7565\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c11\u7ae0 TravelGuide \u30a2\u30d7\u30ea\u3001use \u30d0\u30a4\u30f3\u30c7\u30a3\u30f3\u30b0\u3001\u30ad\u30e3\u30c3\u30b7\u30e5 \u7b2c12\u7ae0 \u30c6\u30b9\u30c8\u6226\u7565\u3001FsCheck \u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: use\uff08\u30ea\u30bd\u30fc\u30b9\u7ba1\u7406\uff09\u3001Type Provider\u3001FsCheck</p>"},{"location":"fsharp/#_3","title":"\u5b66\u7fd2\u30d1\u30b9","text":""},{"location":"fsharp/#_4","title":"\u4f7f\u7528\u30e9\u30a4\u30d6\u30e9\u30ea","text":"\u30e9\u30a4\u30d6\u30e9\u30ea \u7528\u9014 \u5bfe\u5fdc\u7ae0 F# 8 \u8a00\u8a9e \u5168\u7ae0 FSharp.Core \u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea \u5168\u7ae0 FSharpPlus \u62e1\u5f35\u95a2\u6570\u578b\u30e9\u30a4\u30d6\u30e9\u30ea Part IV-VI FsCheck \u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8 Part VI"},{"location":"fsharp/#_5","title":"\u30ea\u30dd\u30b8\u30c8\u30ea\u69cb\u6210","text":"<pre><code>grokkingfp-examples/\n\u251c\u2500\u2500 app/fsharp/src/           # F# \u306e\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n\u2502   \u251c\u2500\u2500 Ch03/                 # \u7b2c3\u7ae0: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\n\u2502   \u251c\u2500\u2500 Ch04/                 # \u7b2c4\u7ae0: \u9ad8\u968e\u95a2\u6570\n\u2502   \u251c\u2500\u2500 Ch05/                 # \u7b2c5\u7ae0: \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\n\u2502   \u251c\u2500\u2500 Ch06/                 # \u7b2c6\u7ae0: Option\n\u2502   \u251c\u2500\u2500 Ch07/                 # \u7b2c7\u7ae0: Result\n\u2502   \u251c\u2500\u2500 Ch08/                 # \u7b2c8\u7ae0: Async\n\u2502   \u251c\u2500\u2500 Ch09/                 # \u7b2c9\u7ae0: Seq\n\u2502   \u251c\u2500\u2500 Ch10/                 # \u7b2c10\u7ae0: \u4e26\u884c\u51e6\u7406\n\u2502   \u251c\u2500\u2500 Ch11/                 # \u7b2c11\u7ae0: \u5b9f\u8df5\u30a2\u30d7\u30ea\n\u2502   \u2514\u2500\u2500 Ch12/                 # \u7b2c12\u7ae0: \u30c6\u30b9\u30c8\n\u251c\u2500\u2500 app/fsharp/tests/         # \u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\n\u2514\u2500\u2500 docs/article/fsharp/      # \u89e3\u8aac\u8a18\u4e8b\uff08\u672c\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\uff09\n    \u251c\u2500\u2500 index.md              # \u3053\u306e\u8a18\u4e8b\n    \u251c\u2500\u2500 part-1.md             # Part I\n    \u251c\u2500\u2500 part-2.md             # Part II\n    \u251c\u2500\u2500 part-3.md             # Part III\n    \u251c\u2500\u2500 part-4.md             # Part IV\n    \u251c\u2500\u2500 part-5.md             # Part V\n    \u2514\u2500\u2500 part-6.md             # Part VI\n</code></pre>"},{"location":"fsharp/#f","title":"F# \u306e\u7279\u5fb4","text":"<p>F# \u306f .NET \u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u4e0a\u3067\u52d5\u4f5c\u3059\u308b\u95a2\u6570\u578b\u30d5\u30a1\u30fc\u30b9\u30c8\u306e\u8a00\u8a9e\u3067\u3059:</p>"},{"location":"fsharp/#_6","title":"\u8a00\u8a9e\u306e\u7279\u5fb4","text":"\u7279\u5fb4 \u8aac\u660e \u95a2\u6570\u578b\u30d5\u30a1\u30fc\u30b9\u30c8 \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u3092\u7b2c\u4e00\u306b\u8a2d\u8a08 \u578b\u63a8\u8ad6 \u5f37\u529b\u306a\u578b\u63a8\u8ad6\u306b\u3088\u308a\u7c21\u6f54\u306a\u30b3\u30fc\u30c9 \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3 <code>\\|&gt;</code> \u6f14\u7b97\u5b50\u306b\u3088\u308b\u30c7\u30fc\u30bf\u30d5\u30ed\u30fc\u306e\u8868\u73fe \u5224\u5225\u5171\u7528\u4f53 \u4ee3\u6570\u7684\u30c7\u30fc\u30bf\u578b\u306e\u30cd\u30a4\u30c6\u30a3\u30d6\u30b5\u30dd\u30fc\u30c8 \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0 \u5f37\u529b\u306a\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0 .NET \u4e92\u63db C# \u30e9\u30a4\u30d6\u30e9\u30ea\u3068\u306e\u5b8c\u5168\u306a\u76f8\u4e92\u904b\u7528"},{"location":"fsharp/#scala","title":"Scala \u3068\u306e\u6bd4\u8f03","text":"\u6982\u5ff5 Scala F# \u8a00\u8a9e\u30d1\u30e9\u30c0\u30a4\u30e0 \u30de\u30eb\u30c1\u30d1\u30e9\u30c0\u30a4\u30e0 \u95a2\u6570\u578b\u30d5\u30a1\u30fc\u30b9\u30c8 \u5b9f\u884c\u74b0\u5883 JVM .NET (CLR) Option \u578b <code>Option[A]</code> <code>Option&lt;'a&gt;</code> \u307e\u305f\u306f <code>'a option</code> Either/Result <code>Either[E, A]</code> <code>Result&lt;'a, 'e&gt;</code> ADT <code>sealed trait</code> + <code>case class</code> \u5224\u5225\u5171\u7528\u4f53 for \u5185\u5305\u8868\u8a18 <code>for { ... } yield</code> \u30b3\u30f3\u30d4\u30e5\u30c6\u30fc\u30b7\u30e7\u30f3\u5f0f \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3 \u30e1\u30bd\u30c3\u30c9\u30c1\u30a7\u30fc\u30f3 <code>\\|&gt;</code> \u6f14\u7b97\u5b50 \u975e\u540c\u671f <code>IO[A]</code> (cats-effect) <code>Async&lt;'a&gt;</code> \u30b9\u30c8\u30ea\u30fc\u30e0 <code>fs2.Stream</code> <code>Seq&lt;'a&gt;</code> / <code>AsyncSeq</code>"},{"location":"fsharp/#_7","title":"\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u5229\u70b9","text":"<p>\u672c\u30b7\u30ea\u30fc\u30ba\u3092\u901a\u3058\u3066\u3001\u4ee5\u4e0b\u306e\u5229\u70b9\u3092\u5b9f\u611f\u3067\u304d\u307e\u3059:</p> <ol> <li>\u4e88\u6e2c\u53ef\u80fd\u6027 - \u7d14\u7c8b\u95a2\u6570\u306f\u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b</li> <li>\u30c6\u30b9\u30c8\u5bb9\u6613\u6027 - \u526f\u4f5c\u7528\u304c\u306a\u3044\u305f\u3081\u30c6\u30b9\u30c8\u304c\u7c21\u5358</li> <li>\u5408\u6210\u53ef\u80fd\u6027 - \u5c0f\u3055\u306a\u95a2\u6570\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u8907\u96d1\u306a\u51e6\u7406\u3092\u69cb\u7bc9</li> <li>\u4e26\u884c\u5b89\u5168\u6027 - \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u306f\u7af6\u5408\u72b6\u614b\u3092\u9632\u3050</li> <li>\u578b\u5b89\u5168\u6027 - Option\u3001Result \u3067 null \u3084\u4f8b\u5916\u3092\u578b\u3067\u8868\u73fe</li> </ol>"},{"location":"fsharp/#_8","title":"\u53c2\u8003\u8cc7\u6599","text":"<ul> <li>Grokking Functional Programming - \u539f\u8457</li> <li>F# \u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8</li> <li>F# for Fun and Profit - F# \u5b66\u7fd2\u30b5\u30a4\u30c8</li> <li>FSharpPlus \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8</li> <li>FsCheck \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8</li> </ul>"},{"location":"fsharp/part-1/","title":"Part I: \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u790e","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\uff08FP\uff09\u306e\u57fa\u672c\u6982\u5ff5\u3092\u5b66\u3073\u307e\u3059\u3002\u547d\u4ee4\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u3068\u306e\u9055\u3044\u3092\u7406\u89e3\u3057\u3001\u7d14\u7c8b\u95a2\u6570\u306e\u5229\u70b9\u3092\u5b9f\u611f\u3059\u308b\u3053\u3068\u304c\u76ee\u6a19\u3067\u3059\u3002</p>"},{"location":"fsharp/part-1/#1","title":"\u7b2c1\u7ae0: \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u5165\u9580","text":""},{"location":"fsharp/part-1/#11-vs","title":"1.1 \u547d\u4ee4\u578b vs \u95a2\u6570\u578b","text":"<p>\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u306f\u5927\u304d\u304f\u5206\u3051\u30662\u3064\u306e\u30d1\u30e9\u30c0\u30a4\u30e0\u304c\u3042\u308a\u307e\u3059\u3002</p> <p></p> <p>\u547d\u4ee4\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306f\u300c\u3069\u3046\u3084\u308b\u304b\u300d\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002</p> <pre><code>// F#: \u547d\u4ee4\u578b\u3067\u30ef\u30fc\u30c9\u30b9\u30b3\u30a2\u3092\u8a08\u7b97\nlet wordScoreImperative (word: string) : int =\n    let mutable score = 0\n    for _ in word do\n        score &lt;- score + 1\n    score\n</code></pre> <p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306f\u300c\u4f55\u3092\u3059\u308b\u304b\u300d\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002</p> <pre><code>// F#: \u95a2\u6570\u578b\u3067\u30ef\u30fc\u30c9\u30b9\u30b3\u30a2\u3092\u8a08\u7b97\nlet wordScore (word: string) : int =\n    word.Length\n</code></pre>"},{"location":"fsharp/part-1/#12-f","title":"1.2 F# \u306e\u57fa\u672c\u69cb\u6587","text":"<p>F# \u3067\u306e\u95a2\u6570\u5b9a\u7fa9\u306e\u57fa\u672c\u5f62\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/fsharp/src/Ch01/IntroFSharp.fs</code></p> <pre><code>/// \u6570\u5024\u3092\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\nlet increment (x: int) : int =\n    x + 1\n\n/// \u6587\u5b57\u5217\u306e\u6700\u521d\u306e\u6587\u5b57\u3092\u53d6\u5f97\nlet getFirstCharacter (s: string) : char =\n    s.[0]\n\n/// \u5358\u8a9e\u306e\u30b9\u30b3\u30a2\u3092\u8a08\u7b97\uff08\u6587\u5b57\u6570\uff09\nlet wordScore (word: string) : int =\n    word.Length\n</code></pre>"},{"location":"fsharp/part-1/#13","title":"1.3 \u95a2\u6570\u306e\u69cb\u9020","text":""},{"location":"fsharp/part-1/#14-f","title":"1.4 F# \u306e\u7279\u5fb4\u7684\u306a\u69cb\u6587","text":""},{"location":"fsharp/part-1/#_1","title":"\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50","text":"<p>F# \u3067\u306f <code>|&gt;</code> \u6f14\u7b97\u5b50\u3092\u4f7f\u3063\u3066\u3001\u30c7\u30fc\u30bf\u306e\u6d41\u308c\u3092\u5de6\u304b\u3089\u53f3\u306b\u8a18\u8ff0\u3067\u304d\u307e\u3059\u3002</p> <pre><code>/// \u6587\u5b57\u5217\u3092\u5927\u6587\u5b57\u306b\u5909\u63db\u3057\u3066\u30b9\u30b3\u30a2\u3092\u8a08\u7b97\nlet scoreUpperCase (word: string) : int =\n    word\n    |&gt; fun s -&gt; s.ToUpper()\n    |&gt; fun s -&gt; s.Length\n\n/// \u8907\u6570\u306e\u5909\u63db\u3092\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u9023\u7d50\nlet processWord (word: string) : string =\n    word\n    |&gt; fun s -&gt; s.Trim()\n    |&gt; fun s -&gt; s.ToLower()\n    |&gt; fun s -&gt; s.Replace(\" \", \"\")\n</code></pre>"},{"location":"fsharp/part-1/#_2","title":"\u578b\u63a8\u8ad6","text":"<p>F# \u306f\u5f37\u529b\u306a\u578b\u63a8\u8ad6\u3092\u6301\u3063\u3066\u3044\u307e\u3059\u3002</p> <pre><code>// \u578b\u6ce8\u91c8\u306a\u3057\u3067\u3082\u578b\u63a8\u8ad6\u3055\u308c\u308b\nlet add a b = a + b\n\n// \u660e\u793a\u7684\u306a\u578b\u6ce8\u91c8\nlet addExplicit (a: int) (b: int) : int = a + b\n\n// \u30b8\u30a7\u30cd\u30ea\u30c3\u30af\u95a2\u6570\nlet identity x = x\n</code></pre>"},{"location":"fsharp/part-1/#_3","title":"\u90e8\u5206\u9069\u7528\u3068\u30ab\u30ea\u30fc\u5316","text":"<p>F# \u306e\u95a2\u6570\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u30ab\u30ea\u30fc\u5316\u3055\u308c\u3066\u3044\u307e\u3059\u3002</p> <pre><code>/// 2\u3064\u306e\u6570\u5024\u3092\u52a0\u7b97\nlet addTwo x y = x + y\n\n/// \u90e8\u5206\u9069\u7528: 5\u3092\u52a0\u7b97\u3059\u308b\u95a2\u6570\nlet addFive = addTwo 5\n\n// addFive 3 = 8\n</code></pre>"},{"location":"fsharp/part-1/#15","title":"1.5 \u5b66\u7fd2\u30dd\u30a4\u30f3\u30c8","text":"\u6982\u5ff5 \u547d\u4ee4\u578b \u95a2\u6570\u578b \u7126\u70b9 \u624b\u9806\uff08How\uff09 \u7d50\u679c\uff08What\uff09 \u72b6\u614b \u5909\u66f4\u3059\u308b \u5909\u63db\u3059\u308b \u30eb\u30fc\u30d7 for/while map/filter/reduce \u30c7\u30fc\u30bf \u30df\u30e5\u30fc\u30bf\u30d6\u30eb \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb \u95a2\u6570 \u5f15\u6570\u3092\u4e00\u62ec\u3067\u53d7\u3051\u53d6\u308b \u30ab\u30ea\u30fc\u5316\uff08\u90e8\u5206\u9069\u7528\u53ef\u80fd\uff09"},{"location":"fsharp/part-1/#16-f-scala","title":"1.6 F# \u3068 Scala \u306e\u6bd4\u8f03","text":"\u6a5f\u80fd F# Scala \u95a2\u6570\u5b9a\u7fa9 <code>let f x = ...</code> <code>def f(x: Int) = ...</code> \u578b\u6ce8\u91c8 <code>(x: int)</code> <code>(x: Int)</code> \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3 <code>x \\|&gt; f</code> <code>f(x)</code> \u307e\u305f\u306f\u62e1\u5f35\u30e1\u30bd\u30c3\u30c9 \u90e8\u5206\u9069\u7528 \u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u30ab\u30ea\u30fc\u5316 <code>.curried</code> \u3067\u5909\u63db \u6587\u5b57\u5217\u88dc\u9593 <code>$\"Hello {name}\"</code> <code>s\"Hello $name\"</code>"},{"location":"fsharp/part-1/#2","title":"\u7b2c2\u7ae0: \u7d14\u7c8b\u95a2\u6570\u3068\u30c6\u30b9\u30c8","text":""},{"location":"fsharp/part-1/#21","title":"2.1 \u7d14\u7c8b\u95a2\u6570\u3068\u306f","text":"<p>\u7d14\u7c8b\u95a2\u6570\uff08Pure Function\uff09\u306f\u4ee5\u4e0b\u306e\u7279\u5fb4\u3092\u6301\u3064\u95a2\u6570\u3067\u3059:</p> <ol> <li>\u540c\u3058\u5165\u529b\u306b\u306f\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3059</li> <li>\u526f\u4f5c\u7528\u304c\u306a\u3044\uff08\u5916\u90e8\u72b6\u614b\u3092\u5909\u66f4\u3057\u306a\u3044\uff09</li> </ol> <p></p>"},{"location":"fsharp/part-1/#22","title":"2.2 \u7d14\u7c8b\u95a2\u6570\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/fsharp/src/Ch02/PureFunctions.fs</code></p> <pre><code>/// \u6570\u5024\u3092\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\uff08\u7d14\u7c8b\u95a2\u6570\uff09\nlet increment (x: int) : int =\n    x + 1\n\n/// 2\u3064\u306e\u6570\u5024\u3092\u52a0\u7b97\uff08\u7d14\u7c8b\u95a2\u6570\uff09\nlet add (a: int) (b: int) : int =\n    a + b\n\n/// \u6587\u5b57\u5217\u306e\u6700\u521d\u306e\u6587\u5b57\u3092\u53d6\u5f97\uff08\u7d14\u7c8b\u95a2\u6570\uff09\nlet getFirstCharacter (s: string) : char =\n    s.[0]\n\n/// \u6570\u5024\u30922\u500d\u306b\u3059\u308b\uff08\u7d14\u7c8b\u95a2\u6570\uff09\nlet double (x: int) : int =\n    x * 2\n\n/// \u6570\u5024\u304c\u5076\u6570\u304b\u3069\u3046\u304b\u3092\u5224\u5b9a\uff08\u7d14\u7c8b\u95a2\u6570\uff09\nlet isEven (n: int) : bool =\n    n % 2 = 0\n</code></pre> <p>\u7d14\u7c8b\u3067\u306f\u306a\u3044\u95a2\u6570\u306e\u4f8b:</p> <pre><code>/// \u4e0d\u7d14\u306a\u95a2\u6570 - \u6bce\u56de\u7570\u306a\u308b\u5024\u3092\u8fd4\u3059\nlet randomPart (x: float) : float =\n    x * System.Random().NextDouble()\n\n/// \u4e0d\u7d14\u306a\u95a2\u6570 - \u73fe\u5728\u6642\u523b\u3092\u8fd4\u3059\nlet currentTime () : int64 =\n    System.DateTimeOffset.UtcNow.ToUnixTimeMilliseconds()\n</code></pre>"},{"location":"fsharp/part-1/#23","title":"2.3 \u30b7\u30e7\u30c3\u30d4\u30f3\u30b0\u30ab\u30fc\u30c8\u306e\u4f8b","text":"<p>\u72b6\u614b\u3092\u6301\u3064\u30af\u30e9\u30b9\u306e\u554f\u984c\u70b9\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/fsharp/src/Ch02/ShoppingCart.fs</code></p>"},{"location":"fsharp/part-1/#_4","title":"\u554f\u984c\u306e\u3042\u308b\u30b3\u30fc\u30c9\uff08\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u6307\u5411\u7684\u306a\u30a2\u30d7\u30ed\u30fc\u30c1\uff09","text":"<pre><code>// \u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u72b6\u614b\u3092\u6301\u3064\u554f\u984c\u306e\u3042\u308b\u30a2\u30d7\u30ed\u30fc\u30c1\ntype ShoppingCartBad() =\n    let mutable items = []\n    let mutable bookAdded = false\n\n    member _.AddItem(item: string) =\n        items &lt;- item :: items\n        if item = \"Book\" then\n            bookAdded &lt;- true\n\n    member _.GetDiscountPercentage() =\n        if bookAdded then 5 else 0\n\n    member _.GetItems() = items  // \u554f\u984c: \u5185\u90e8\u72b6\u614b\u3078\u306e\u53c2\u7167\u3092\u8fd4\u3057\u3066\u3044\u308b\n</code></pre>"},{"location":"fsharp/part-1/#_5","title":"\u7d14\u7c8b\u95a2\u6570\u306b\u3088\u308b\u89e3\u6c7a","text":"<pre><code>/// \u30ab\u30fc\u30c8\u5185\u306e\u5546\u54c1\u30ea\u30b9\u30c8\u304b\u3089\u5272\u5f15\u7387\u3092\u8a08\u7b97\n/// Book \u304c\u542b\u307e\u308c\u3066\u3044\u308c\u3070 5%\u3001\u305d\u308c\u4ee5\u5916\u306f 0%\nlet getDiscountPercentage (items: string list) : int =\n    if List.contains \"Book\" items then 5\n    else 0\n</code></pre>"},{"location":"fsharp/part-1/#_6","title":"\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30ab\u30fc\u30c8\u64cd\u4f5c","text":"<pre><code>/// \u5546\u54c1\u3092\u8ffd\u52a0\u3057\u305f\u65b0\u3057\u3044\u30ab\u30fc\u30c8\u3092\u8fd4\u3059\nlet addItem (items: string list) (item: string) : string list =\n    item :: items\n\n/// \u5546\u54c1\u3092\u524a\u9664\u3057\u305f\u65b0\u3057\u3044\u30ab\u30fc\u30c8\u3092\u8fd4\u3059\nlet removeItem (items: string list) (item: string) : string list =\n    items |&gt; List.filter (fun i -&gt; i &lt;&gt; item)\n</code></pre> <p>F# \u306e\u30ea\u30b9\u30c8\u306f\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u306e\u3067\u3001<code>addItem</code> \u3084 <code>removeItem</code> \u306f\u5143\u306e\u30ea\u30b9\u30c8\u3092\u5909\u66f4\u305b\u305a\u3001\u65b0\u3057\u3044\u30ea\u30b9\u30c8\u3092\u8fd4\u3057\u307e\u3059\u3002</p>"},{"location":"fsharp/part-1/#24","title":"2.4 \u8907\u6570\u6761\u4ef6\u306b\u3088\u308b\u5272\u5f15\u8a08\u7b97","text":"<p>\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u4f7f\u3063\u305f\u8907\u96d1\u306a\u30d3\u30b8\u30cd\u30b9\u30ed\u30b8\u30c3\u30af\u306e\u5b9f\u88c5:</p> <pre><code>/// \u8907\u6570\u306e\u6761\u4ef6\u306b\u3088\u308b\u5272\u5f15\u8a08\u7b97\nlet getAdvancedDiscountPercentage (items: string list) : int =\n    let hasBook = List.contains \"Book\" items\n    let hasElectronics = List.exists (fun item -&gt;\n        item = \"Laptop\" || item = \"Phone\" || item = \"Tablet\") items\n    let itemCount = List.length items\n\n    match hasBook, hasElectronics, itemCount with\n    | true, true, _ -&gt; 15      // Book + \u96fb\u5b50\u6a5f\u5668 \u2192 15%\n    | true, _, n when n &gt;= 5 -&gt; 10  // Book + 5\u500b\u4ee5\u4e0a \u2192 10%\n    | true, _, _ -&gt; 5          // Book \u306e\u307f \u2192 5%\n    | _, true, n when n &gt;= 3 -&gt; 7   // \u96fb\u5b50\u6a5f\u5668 + 3\u500b\u4ee5\u4e0a \u2192 7%\n    | _, _, n when n &gt;= 10 -&gt; 5     // 10\u500b\u4ee5\u4e0a \u2192 5%\n    | _ -&gt; 0                   // \u305d\u308c\u4ee5\u5916 \u2192 0%\n</code></pre>"},{"location":"fsharp/part-1/#25","title":"2.5 \u30c1\u30c3\u30d7\u8a08\u7b97\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/fsharp/src/Ch02/TipCalculator.fs</code></p> <pre><code>/// \u30b0\u30eb\u30fc\u30d7\u30b5\u30a4\u30ba\u306b\u5fdc\u3058\u305f\u30c1\u30c3\u30d7\u7387\u3092\u8a08\u7b97\n/// 6\u4eba\u4ee5\u4e0a \u2192 20%\n/// 1-5\u4eba \u2192 10%\n/// 0\u4eba \u2192 0%\nlet getTipPercentage (names: string list) : int =\n    let size = List.length names\n    if size &gt; 5 then 20\n    elif size &gt; 0 then 10\n    else 0\n</code></pre> <p>\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u4f7f\u3063\u305f\u5225\u306e\u5b9f\u88c5:</p> <pre><code>/// \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u4f7f\u7528\u3057\u305f\u30c1\u30c3\u30d7\u7387\u8a08\u7b97\nlet getTipPercentageMatch (names: string list) : int =\n    match List.length names with\n    | n when n &gt; 5 -&gt; 20\n    | n when n &gt; 0 -&gt; 10\n    | _ -&gt; 0\n</code></pre>"},{"location":"fsharp/part-1/#option","title":"Option \u578b\u306b\u3088\u308b\u30bc\u30ed\u9664\u7b97\u306e\u9632\u6b62","text":"<pre><code>/// \u4e00\u4eba\u5f53\u305f\u308a\u306e\u652f\u6255\u984d\u3092\u8a08\u7b97\uff08\u30c1\u30c3\u30d7\u8fbc\u307f\uff09\nlet calculatePerPerson (billAmount: decimal) (names: string list) : decimal option =\n    let size = List.length names\n    if size = 0 then\n        None\n    else\n        let tip = calculateTip billAmount names\n        let total = billAmount + tip\n        Some (total / decimal size)\n</code></pre> <p>F# \u306e <code>Option</code> \u578b\u306f\u3001\u5024\u304c\u5b58\u5728\u3057\u306a\u3044\u53ef\u80fd\u6027\u3092\u578b\u3067\u8868\u73fe\u3057\u307e\u3059\u3002\u3053\u308c\u306b\u3088\u308a\u3001<code>null</code> \u306b\u3088\u308b\u5b9f\u884c\u6642\u30a8\u30e9\u30fc\u3092\u9632\u3052\u307e\u3059\u3002</p>"},{"location":"fsharp/part-1/#26","title":"2.6 \u7d14\u7c8b\u95a2\u6570\u306e\u30c6\u30b9\u30c8","text":"<p>\u7d14\u7c8b\u95a2\u6570\u306f\u975e\u5e38\u306b\u30c6\u30b9\u30c8\u3057\u3084\u3059\u3044\u3067\u3059\u3002</p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/fsharp/tests/Ch02/PureFunctionsTests.fs</code></p> <pre><code>[&lt;Fact&gt;]\nlet ``increment \u306f\u6570\u5024\u30921\u5897\u3084\u3059`` () =\n    Assert.Equal(7, increment 6)\n    Assert.Equal(1, increment 0)\n    Assert.Equal(-5, increment -6)\n    Assert.Equal(System.Int32.MaxValue, increment (System.Int32.MaxValue - 1))\n</code></pre> <p></p>"},{"location":"fsharp/part-1/#27-a","title":"2.7 \u6587\u5b57 'a' \u3092\u9664\u5916\u3059\u308b\u30ef\u30fc\u30c9\u30b9\u30b3\u30a2","text":"<p>\u3088\u308a\u8907\u96d1\u306a\u4f8b\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p> <pre><code>/// 'a' \u3092\u9664\u5916\u3057\u305f\u6587\u5b57\u6570\u3092\u30b9\u30b3\u30a2\u3068\u3057\u3066\u8fd4\u3059\nlet wordScore (word: string) : int =\n    word.Replace(\"a\", \"\").Length\n\n/// \u5927\u6587\u5b57\u5c0f\u6587\u5b57\u3092\u533a\u5225\u305b\u305a\u306b 'a' \u3092\u9664\u5916\nlet wordScoreIgnoreCase (word: string) : int =\n    word\n    |&gt; String.filter (fun c -&gt; c &lt;&gt; 'a' &amp;&amp; c &lt;&gt; 'A')\n    |&gt; String.length\n</code></pre> <pre><code>// \u30c6\u30b9\u30c8\n[&lt;Fact&gt;]\nlet ``wordScore \u306f 'a' \u3092\u9664\u5916\u3057\u305f\u6587\u5b57\u6570\u3092\u8fd4\u3059`` () =\n    Assert.Equal(3, wordScore \"Scala\")  // \"Scl\" \u2192 3\n    Assert.Equal(8, wordScore \"function\") // 'a' \u306a\u3057 \u2192 8\n    Assert.Equal(0, wordScore \"\")        // \u7a7a\u6587\u5b57 \u2192 0\n    Assert.Equal(0, wordScore \"aaa\")     // \u3059\u3079\u3066 'a' \u2192 0\n</code></pre>"},{"location":"fsharp/part-1/#28","title":"2.8 \u53c2\u7167\u900f\u904e\u6027","text":"<p>\u7d14\u7c8b\u95a2\u6570\u306f\u53c2\u7167\u900f\u904e\u6027\uff08Referential Transparency\uff09\u3092\u6301\u3061\u307e\u3059\u3002</p> <p>\u5f0f\u3092\u305d\u306e\u8a55\u4fa1\u7d50\u679c\u3067\u7f6e\u304d\u63db\u3048\u3066\u3082\u3001\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u610f\u5473\u304c\u5909\u308f\u3089\u306a\u3044\u3053\u3068</p> <pre><code>// \u53c2\u7167\u900f\u904e\u6027\u306e\u4f8b\nlet score1 = wordScore \"Scala\"\nlet score2 = wordScore \"Scala\"\n// score1 \u3068 score2 \u306f\u5e38\u306b\u540c\u3058\u5024\uff083\uff09\n\n// \u4ee5\u4e0b\u306e2\u3064\u306f\u540c\u7b49\nlet total1 = wordScore \"Scala\" + wordScore \"Java\"\nlet total2 = 3 + 2  // wordScore \u306e\u7d50\u679c\u3067\u7f6e\u304d\u63db\u3048\u53ef\u80fd\n</code></pre> <p></p>"},{"location":"fsharp/part-1/#_7","title":"\u307e\u3068\u3081","text":""},{"location":"fsharp/part-1/#part-i_1","title":"Part I \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"fsharp/part-1/#_8","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306f\u300c\u4f55\u3092\u3059\u308b\u304b\u300d\u3092\u5ba3\u8a00\u7684\u306b\u8a18\u8ff0\u3059\u308b</li> <li>F# \u306e\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50 (<code>|&gt;</code>) \u3067\u30c7\u30fc\u30bf\u306e\u6d41\u308c\u3092\u76f4\u611f\u7684\u306b\u8868\u73fe\u3067\u304d\u308b</li> <li>\u7d14\u7c8b\u95a2\u6570\u306f\u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3059</li> <li>\u526f\u4f5c\u7528\u3092\u907f\u3051\u308b\u3053\u3068\u3067\u30b3\u30fc\u30c9\u306e\u4e88\u6e2c\u53ef\u80fd\u6027\u304c\u5411\u4e0a\u3059\u308b</li> <li>\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3067\u8907\u96d1\u306a\u6761\u4ef6\u5206\u5c90\u3092\u7c21\u6f54\u306b\u8a18\u8ff0\u3067\u304d\u308b</li> <li>Option \u578b\u3067 null \u5b89\u5168\u306a\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u304c\u3067\u304d\u308b</li> <li>\u7d14\u7c8b\u95a2\u6570\u306f\u30c6\u30b9\u30c8\u304c\u975e\u5e38\u306b\u7c21\u5358</li> <li>\u53c2\u7167\u900f\u904e\u6027\u306b\u3088\u308a\u3001\u30b3\u30fc\u30c9\u306e\u7406\u89e3\u3068\u63a8\u8ad6\u304c\u5bb9\u6613\u306b\u306a\u308b</li> </ol>"},{"location":"fsharp/part-1/#_9","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part II \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c</li> <li>\u9ad8\u968e\u95a2\u6570\uff08\u95a2\u6570\u3092\u5024\u3068\u3057\u3066\u6271\u3046\uff09</li> <li><code>List.collect</code> \u3068\u30cd\u30b9\u30c8\u69cb\u9020\u306e\u5e73\u5766\u5316</li> <li>\u30b3\u30f3\u30d4\u30e5\u30c6\u30fc\u30b7\u30e7\u30f3\u5f0f</li> </ul>"},{"location":"fsharp/part-1/#_10","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"fsharp/part-1/#1_1","title":"\u554f\u984c 1: \u7d14\u7c8b\u95a2\u6570\u306e\u8b58\u5225","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u306e\u3046\u3061\u3001\u7d14\u7c8b\u95a2\u6570\u306f\u3069\u308c\u3067\u3059\u304b?</p> <pre><code>// A\nlet double (x: int) : int = x * 2\n\n// B\nlet mutable counter = 0\nlet incrementCounter () : int =\n    counter &lt;- counter + 1\n    counter\n\n// C\nlet greet (name: string) : string = $\"Hello, {name}!\"\n\n// D\nlet currentTime () : int64 = System.DateTimeOffset.UtcNow.ToUnixTimeMilliseconds()\n</code></pre> \u89e3\u7b54  **A \u3068 C \u306f\u7d14\u7c8b\u95a2\u6570**\u3067\u3059\u3002  - A: \u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3057\u3001\u526f\u4f5c\u7528\u304c\u306a\u3044 - B: \u5916\u90e8\u5909\u6570 `counter` \u3092\u5909\u66f4\u3059\u308b\u526f\u4f5c\u7528\u304c\u3042\u308b\uff08\u4e0d\u7d14\uff09 - C: \u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3057\u3001\u526f\u4f5c\u7528\u304c\u306a\u3044 - D: \u547c\u3073\u51fa\u3059\u305f\u3073\u306b\u7570\u306a\u308b\u5024\u3092\u8fd4\u3059\uff08\u4e0d\u7d14\uff09"},{"location":"fsharp/part-1/#2_1","title":"\u554f\u984c 2: \u7d14\u7c8b\u95a2\u6570\u3078\u306e\u66f8\u304d\u63db\u3048","text":"<p>\u4ee5\u4e0b\u306e\u4e0d\u7d14\u306a\u95a2\u6570\u3092\u7d14\u7c8b\u95a2\u6570\u306b\u66f8\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>type Counter() =\n    let mutable value = 0\n\n    member _.Increment() =\n        value &lt;- value + 1\n        value\n</code></pre> \u89e3\u7b54 <pre><code>let increment (value: int) : int = value + 1\n\n// \u4f7f\u7528\u4f8b\nlet v1 = 0\nlet v2 = increment v1  // 1\nlet v3 = increment v2  // 2\n</code></pre>  \u72b6\u614b\u3092\u5916\u90e8\u306b\u6301\u3061\u3001\u95a2\u6570\u306f\u5024\u3092\u53d7\u3051\u53d6\u3063\u3066\u65b0\u3057\u3044\u5024\u3092\u8fd4\u3059\u3060\u3051\u306b\u3057\u307e\u3059\u3002"},{"location":"fsharp/part-1/#3","title":"\u554f\u984c 3: \u30c6\u30b9\u30c8\u3092\u66f8\u304f","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u306b\u5bfe\u3059\u308b\u30c6\u30b9\u30c8\u30b1\u30fc\u30b9\u3092\u8003\u3048\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>let isEven (n: int) : bool = n % 2 = 0\n</code></pre> \u89e3\u7b54 <pre><code>// \u57fa\u672c\u30b1\u30fc\u30b9\nAssert.True(isEven 0)\nAssert.True(isEven 2)\nAssert.True(isEven 4)\n\n// \u5947\u6570\nAssert.False(isEven 1)\nAssert.False(isEven 3)\n\n// \u8ca0\u306e\u6570\nAssert.True(isEven -2)\nAssert.False(isEven -3)\n\n// \u5883\u754c\u5024\nAssert.False(isEven System.Int32.MaxValue)\nAssert.True(isEven System.Int32.MinValue)\n</code></pre>"},{"location":"fsharp/part-1/#4","title":"\u554f\u984c 4: \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50\u3092\u4f7f\u3046","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50\u3092\u4f7f\u3063\u3066\u66f8\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>let processText (text: string) : int =\n    String.length (text.ToUpper().Trim())\n</code></pre> \u89e3\u7b54 <pre><code>let processText (text: string) : int =\n    text\n    |&gt; fun s -&gt; s.Trim()\n    |&gt; fun s -&gt; s.ToUpper()\n    |&gt; String.length\n</code></pre>  \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50\u3092\u4f7f\u3046\u3068\u3001\u30c7\u30fc\u30bf\u306e\u5909\u63db\u904e\u7a0b\u304c\u4e0a\u304b\u3089\u4e0b\u306b\u8aad\u3081\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002"},{"location":"fsharp/part-1/#5-option","title":"\u554f\u984c 5: Option \u578b\u3092\u4f7f\u3046","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092 <code>Option</code> \u578b\u3092\u4f7f\u3063\u3066\u5b89\u5168\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>let divide (a: int) (b: int) : int = a / b  // b \u304c 0 \u306e\u5834\u5408\u306b\u4f8b\u5916\n</code></pre> \u89e3\u7b54 <pre><code>let divide (a: int) (b: int) : int option =\n    if b = 0 then None\n    else Some (a / b)\n\n// \u4f7f\u7528\u4f8b\nmatch divide 10 2 with\n| Some result -&gt; printfn \"\u7d50\u679c: %d\" result\n| None -&gt; printfn \"0\u3067\u9664\u7b97\u3067\u304d\u307e\u305b\u3093\"\n</code></pre>  `Option` \u578b\u3092\u4f7f\u3046\u3053\u3068\u3067\u3001\u30a8\u30e9\u30fc\u30b1\u30fc\u30b9\u3092\u578b\u3067\u8868\u73fe\u3057\u3001\u547c\u3073\u51fa\u3057\u5074\u306b\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3092\u5f37\u5236\u3067\u304d\u307e\u3059\u3002"},{"location":"fsharp/part-2/","title":"Part II: \u95a2\u6570\u578b\u30b9\u30bf\u30a4\u30eb\u306e\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u6838\u5fc3\u3068\u306a\u308b\u30c6\u30af\u30cb\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059\u3002\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c\u3001\u9ad8\u968e\u95a2\u6570\u3001\u305d\u3057\u3066 <code>List.collect</code>\uff08flatMap \u76f8\u5f53\uff09\u306b\u3088\u308b\u8907\u96d1\u306a\u30c7\u30fc\u30bf\u5909\u63db\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"fsharp/part-2/#3","title":"\u7b2c3\u7ae0: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c","text":""},{"location":"fsharp/part-2/#31","title":"3.1 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u3068\u306f","text":"<p>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\uff08\u4e0d\u5909\uff09\u3068\u306f\u3001\u4e00\u5ea6\u4f5c\u6210\u3055\u308c\u305f\u30c7\u30fc\u30bf\u304c\u5909\u66f4\u3055\u308c\u306a\u3044\u3053\u3068\u3092\u610f\u5473\u3057\u307e\u3059\u3002\u30c7\u30fc\u30bf\u3092\u300c\u5909\u66f4\u300d\u3059\u308b\u4ee3\u308f\u308a\u306b\u3001\u65b0\u3057\u3044\u30c7\u30fc\u30bf\u3092\u300c\u4f5c\u6210\u300d\u3057\u307e\u3059\u3002</p> <p></p>"},{"location":"fsharp/part-2/#32-list","title":"3.2 List \u306e\u57fa\u672c\u64cd\u4f5c","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/fsharp/src/Ch03/ImmutableOperations.fs</code></p>"},{"location":"fsharp/part-2/#_1","title":"\u8981\u7d20\u306e\u8ffd\u52a0","text":"<p>F# \u306e\u30ea\u30b9\u30c8\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u3067\u3059\u3002\u8981\u7d20\u3092\u8ffd\u52a0\u3059\u308b\u3068\u65b0\u3057\u3044\u30ea\u30b9\u30c8\u304c\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002</p> <pre><code>let appleBook = [\"Apple\"; \"Book\"]\nlet appleBookMango = appleBook @ [\"Mango\"]\n\n// \u5143\u306e\u30ea\u30b9\u30c8\u306f\u5909\u308f\u3089\u306a\u3044\nassert (List.length appleBook = 2)\n// \u65b0\u3057\u3044\u30ea\u30b9\u30c8\u304c\u4f5c\u6210\u3055\u308c\u308b\nassert (List.length appleBookMango = 3)\nassert (appleBookMango = [\"Apple\"; \"Book\"; \"Mango\"])\n</code></pre>"},{"location":"fsharp/part-2/#_2","title":"\u30b9\u30e9\u30a4\u30b9\u64cd\u4f5c","text":"<pre><code>/// \u30ea\u30b9\u30c8\u306e\u5148\u982dn\u500b\u306e\u8981\u7d20\u3092\u53d6\u5f97\nlet firstN (n: int) (list: 'a list) : 'a list =\n    list |&gt; List.truncate n\n\n/// \u30ea\u30b9\u30c8\u306e\u672b\u5c3en\u500b\u306e\u8981\u7d20\u3092\u53d6\u5f97\nlet lastN (n: int) (list: 'a list) : 'a list =\n    let skipCount = max 0 (List.length list - n)\n    list |&gt; List.skip skipCount\n\n/// \u30ea\u30b9\u30c8\u306e\u6700\u521d\u306e2\u8981\u7d20\u3092\u53d6\u5f97\nlet firstTwo (list: 'a list) : 'a list =\n    firstN 2 list\n\n/// \u30ea\u30b9\u30c8\u306e\u6700\u5f8c\u306e2\u8981\u7d20\u3092\u53d6\u5f97\nlet lastTwo (list: 'a list) : 'a list =\n    lastN 2 list\n</code></pre>"},{"location":"fsharp/part-2/#33","title":"3.3 \u30ea\u30b9\u30c8\u306e\u5909\u63db\u4f8b","text":"<pre><code>/// \u6700\u521d\u306e2\u8981\u7d20\u3092\u672b\u5c3e\u306b\u79fb\u52d5\nlet moveFirstTwoToEnd (list: 'a list) : 'a list =\n    let first = firstTwo list\n    let rest = list |&gt; List.skip 2\n    rest @ first\n\n// \u4f7f\u7528\u4f8b\nassert (moveFirstTwoToEnd [\"a\"; \"b\"; \"c\"] = [\"c\"; \"a\"; \"b\"])\n\n/// \u6700\u5f8c\u306e\u8981\u7d20\u306e\u524d\u306b\u65b0\u3057\u3044\u8981\u7d20\u3092\u633f\u5165\nlet insertBeforeLast (element: 'a) (list: 'a list) : 'a list =\n    let withoutLast = list |&gt; List.truncate (List.length list - 1)\n    let last = list |&gt; lastN 1\n    withoutLast @ [element] @ last\n\nassert (insertBeforeLast \"c\" [\"a\"; \"b\"] = [\"a\"; \"c\"; \"b\"])\n</code></pre>"},{"location":"fsharp/part-2/#34","title":"3.4 \u65c5\u7a0b\u306e\u518d\u8a08\u753b","text":"<p>\u65c5\u884c\u306e\u8a08\u753b\u5909\u66f4\u3092\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306b\u884c\u3046\u4f8b\u3067\u3059\u3002</p> <pre><code>/// \u6307\u5b9a\u3057\u305f\u90fd\u5e02\u306e\u524d\u306b\u65b0\u3057\u3044\u90fd\u5e02\u3092\u633f\u5165\nlet replan (plan: string list) (newCity: string) (beforeCity: string) : string list =\n    let index =\n        plan\n        |&gt; List.tryFindIndex (fun c -&gt; c = beforeCity)\n        |&gt; Option.defaultValue (List.length plan)\n    let citiesBefore = plan |&gt; List.truncate index\n    let citiesAfter = plan |&gt; List.skip index\n    citiesBefore @ [newCity] @ citiesAfter\n\nlet planA = [\"Paris\"; \"Berlin\"; \"Krak\u00f3w\"]\nlet planB = replan planA \"Vienna\" \"Krak\u00f3w\"\n\nassert (planB = [\"Paris\"; \"Berlin\"; \"Vienna\"; \"Krak\u00f3w\"])\nassert (planA = [\"Paris\"; \"Berlin\"; \"Krak\u00f3w\"])  // \u5143\u306e\u8a08\u753b\u306f\u5909\u308f\u3089\u306a\u3044!\n</code></pre> <p></p>"},{"location":"fsharp/part-2/#35-string-list","title":"3.5 String \u3068 List \u306e\u985e\u4f3c\u6027","text":"<p>String \u3068 List \u306f\u4f3c\u305f\u64cd\u4f5c\u304c\u3067\u304d\u307e\u3059\u3002</p> \u64cd\u4f5c F# List F# String \u7d50\u5408 <code>@</code> \u307e\u305f\u306f <code>List.append</code> <code>+</code> \u307e\u305f\u306f <code>String.concat</code> \u5207\u308a\u51fa\u3057 <code>List.skip</code>, <code>List.truncate</code> <code>Substring</code> \u30b5\u30a4\u30ba <code>List.length</code> <code>String.length</code> <pre><code>// List \u306e\u64cd\u4f5c\nlet abList = [\"a\"; \"b\"]\nlet cdList = [\"c\"; \"d\"]\nlet abcdList = abList @ cdList\nassert (abcdList = [\"a\"; \"b\"; \"c\"; \"d\"])\n\n// String \u306e\u64cd\u4f5c\nlet abStr = \"ab\"\nlet cdStr = \"cd\"\nlet abcdStr = abStr + cdStr\nassert (abcdStr = \"abcd\")\n</code></pre>"},{"location":"fsharp/part-2/#36","title":"3.6 \u540d\u524d\u306e\u7701\u7565","text":"<pre><code>/// \u540d\u524d\u3092\u7701\u7565\u5f62\u306b\u5909\u63db\uff08\u4f8b: \"Alonzo Church\" -&gt; \"A. Church\"\uff09\nlet abbreviate (name: string) : string =\n    let initial = name.Substring(0, 1)\n    let separatorIndex = name.IndexOf(' ')\n    if separatorIndex &lt; 0 then\n        name\n    else\n        let lastName = name.Substring(separatorIndex + 1)\n        $\"{initial}. {lastName}\"\n\nassert (abbreviate \"Alonzo Church\" = \"A. Church\")\nassert (abbreviate \"A. Church\" = \"A. Church\")\n</code></pre>"},{"location":"fsharp/part-2/#4","title":"\u7b2c4\u7ae0: \u95a2\u6570\u3092\u5024\u3068\u3057\u3066\u6271\u3046","text":""},{"location":"fsharp/part-2/#41","title":"4.1 \u9ad8\u968e\u95a2\u6570\u3068\u306f","text":"<p>\u9ad8\u968e\u95a2\u6570\uff08Higher-Order Function\uff09\u3068\u306f\u3001\u4ee5\u4e0b\u306e\u3044\u305a\u308c\u304b\u3092\u6e80\u305f\u3059\u95a2\u6570\u3067\u3059:</p> <ol> <li>\u95a2\u6570\u3092\u5f15\u6570\u3068\u3057\u3066\u53d7\u3051\u53d6\u308b</li> <li>\u95a2\u6570\u3092\u623b\u308a\u5024\u3068\u3057\u3066\u8fd4\u3059</li> </ol> <p></p>"},{"location":"fsharp/part-2/#42","title":"4.2 \u95a2\u6570\u3092\u5f15\u6570\u3068\u3057\u3066\u6e21\u3059","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/fsharp/src/Ch04/HigherOrderFunctions.fs</code></p>"},{"location":"fsharp/part-2/#listsortby-","title":"List.sortBy - \u30bd\u30fc\u30c8\u57fa\u6e96\u3092\u95a2\u6570\u3067\u6307\u5b9a","text":"<pre><code>let wordScore (word: string) : int =\n    word.Replace(\"a\", \"\").Length\n\nlet words = [\"rust\"; \"java\"]\nlet sortedWords = words |&gt; List.sortBy wordScore\n\nassert (sortedWords = [\"java\"; \"rust\"])\n// java: 2\u6587\u5b57 (j, v), rust: 4\u6587\u5b57 (r, u, s, t)\n</code></pre>"},{"location":"fsharp/part-2/#listmap-","title":"List.map - \u5404\u8981\u7d20\u3092\u5909\u63db","text":"<pre><code>let len (s: string) : int = s.Length\n\nlet lengths = [\"scala\"; \"rust\"; \"ada\"] |&gt; List.map len\nassert (lengths = [5; 4; 3])\n\nlet double (i: int) : int = i * 2\nlet doubles = [5; 1; 2; 4; 0] |&gt; List.map double\nassert (doubles = [10; 2; 4; 8; 0])\n</code></pre>"},{"location":"fsharp/part-2/#listfilter-","title":"List.filter - \u6761\u4ef6\u306b\u5408\u3046\u8981\u7d20\u3092\u62bd\u51fa","text":"<pre><code>let isOdd (i: int) : bool = i % 2 = 1\n\nlet odds = [5; 1; 2; 4; 0] |&gt; List.filter isOdd\nassert (odds = [5; 1])\n\nlet largerThan4 (i: int) : bool = i &gt; 4\nlet large = [5; 1; 2; 4; 0] |&gt; List.filter largerThan4\nassert (large = [5])\n</code></pre>"},{"location":"fsharp/part-2/#listfold-","title":"List.fold - \u7573\u307f\u8fbc\u307f","text":"<pre><code>let sum = [5; 1; 2; 4; 100] |&gt; List.fold (fun acc i -&gt; acc + i) 0\nassert (sum = 112)\n\nlet maximum = [5; 1; 2; 4; 15] |&gt; List.fold (fun maxVal i -&gt;\n    if i &gt; maxVal then i else maxVal) System.Int32.MinValue\nassert (maximum = 15)\n</code></pre>"},{"location":"fsharp/part-2/#43","title":"4.3 \u30ec\u30b3\u30fc\u30c9\u578b\u3068\u30d1\u30bf\u30fc\u30f3","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/fsharp/src/Ch04/HigherOrderFunctions.fs</code></p> <pre><code>/// \u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u8a00\u8a9e\u3092\u8868\u3059\u30ec\u30b3\u30fc\u30c9\u578b\ntype ProgrammingLanguage = {\n    Name: string\n    Year: int\n}\n\nlet javalang = { Name = \"Java\"; Year = 1995 }\nlet scalalang = { Name = \"Scala\"; Year = 2004 }\n\nlet languages = [javalang; scalalang]\n\n// \u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u30a2\u30af\u30bb\u30b9\nlet names = languages |&gt; List.map (fun lang -&gt; lang.Name)\nassert (names = [\"Java\"; \"Scala\"])\n\n// \u6761\u4ef6\u3067\u30d5\u30a3\u30eb\u30bf\nlet young = languages |&gt; List.filter (fun lang -&gt; lang.Year &gt; 2000)\nassert (young = [scalalang])\n</code></pre>"},{"location":"fsharp/part-2/#44","title":"4.4 \u95a2\u6570\u3092\u8fd4\u3059\u95a2\u6570","text":"<pre><code>/// n \u3088\u308a\u5927\u304d\u3044\u304b\u3092\u5224\u5b9a\u3059\u308b\u95a2\u6570\u3092\u8fd4\u3059\nlet largerThan (n: int) : int -&gt; bool =\n    fun i -&gt; i &gt; n\n\nlet large = [5; 1; 2; 4; 0] |&gt; List.filter (largerThan 4)\nassert (large = [5])\n\nlet medium = [5; 1; 2; 4; 0] |&gt; List.filter (largerThan 1)\nassert (medium = [5; 2; 4])\n</code></pre>"},{"location":"fsharp/part-2/#45","title":"4.5 \u90e8\u5206\u9069\u7528","text":"<p>F# \u306e\u95a2\u6570\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u30ab\u30ea\u30fc\u5316\u3055\u308c\u3066\u3044\u308b\u305f\u3081\u3001\u90e8\u5206\u9069\u7528\u304c\u81ea\u7136\u306b\u884c\u3048\u307e\u3059\u3002</p> <pre><code>/// 2\u3064\u306e\u5f15\u6570\u3092\u53d6\u308b\u95a2\u6570\nlet add x y = x + y\n\n/// \u90e8\u5206\u9069\u7528: 5\u3092\u8db3\u3059\u95a2\u6570\nlet addFive = add 5\n\nassert (addFive 3 = 8)\nassert (addFive 10 = 15)\n</code></pre> <p></p>"},{"location":"fsharp/part-2/#46","title":"4.6 \u30ef\u30fc\u30c9\u30b9\u30b3\u30a2\u30ea\u30f3\u30b0\u306e\u4f8b","text":"<p>\u8907\u6570\u306e\u30b9\u30b3\u30a2\u30ea\u30f3\u30b0\u30ed\u30b8\u30c3\u30af\u3092\u7d44\u307f\u5408\u308f\u305b\u308b\u4f8b\u3067\u3059\u3002</p> <pre><code>let wordScore (word: string) : int = word.Replace(\"a\", \"\").Length\nlet bonus (word: string) : int = if word.Contains(\"c\") then 5 else 0\nlet penalty (word: string) : int = if word.Contains(\"s\") then 7 else 0\n\nlet words = [\"ada\"; \"haskell\"; \"scala\"; \"java\"; \"rust\"]\n\n/// \u6307\u5b9a\u3057\u305f\u30b9\u30b3\u30a2\u95a2\u6570\u3067\u30ef\u30fc\u30c9\u3092\u30e9\u30f3\u30ad\u30f3\u30b0\nlet rankedWords (scoreFn: string -&gt; int) (words: string list) : string list =\n    words |&gt; List.sortByDescending scoreFn\n\n// \u57fa\u672c\u30b9\u30b3\u30a2\u3067\u30e9\u30f3\u30ad\u30f3\u30b0\nlet ranking1 = rankedWords wordScore words\nassert (ranking1 = [\"haskell\"; \"rust\"; \"scala\"; \"java\"; \"ada\"])\n\n// \u30dc\u30fc\u30ca\u30b9\u4ed8\u304d\u30b9\u30b3\u30a2\u3067\u30e9\u30f3\u30ad\u30f3\u30b0\nlet ranking2 = rankedWords (fun w -&gt; wordScore w + bonus w) words\nassert (ranking2 = [\"scala\"; \"haskell\"; \"rust\"; \"java\"; \"ada\"])\n\n// \u30dc\u30fc\u30ca\u30b9\u3068\u30da\u30ca\u30eb\u30c6\u30a3\u4ed8\u304d\u30b9\u30b3\u30a2\u3067\u30e9\u30f3\u30ad\u30f3\u30b0\nlet ranking3 = rankedWords (fun w -&gt; wordScore w + bonus w - penalty w) words\n// java: 2, scala/ada: 1, haskell: -1, rust: -3\n</code></pre>"},{"location":"fsharp/part-2/#5-listcollect","title":"\u7b2c5\u7ae0: List.collect \u3068\u30cd\u30b9\u30c8\u69cb\u9020","text":""},{"location":"fsharp/part-2/#51-flatten-listcollect","title":"5.1 flatten \u3068 List.collect","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/fsharp/src/Ch05/FlatMapOperations.fs</code></p>"},{"location":"fsharp/part-2/#listconcat-","title":"List.concat - \u30cd\u30b9\u30c8\u3057\u305f\u30ea\u30b9\u30c8\u3092\u5e73\u5766\u5316","text":"<pre><code>type Book = {\n    Title: string\n    Authors: string list\n}\n\nlet books = [\n    { Title = \"FP in Scala\"; Authors = [\"Chiusano\"; \"Bjarnason\"] }\n    { Title = \"The Hobbit\"; Authors = [\"Tolkien\"] }\n]\n\n// List.map \u3060\u3051\u3060\u3068\u30cd\u30b9\u30c8\u3059\u308b\nlet authorLists = books |&gt; List.map (fun b -&gt; b.Authors)\n// [ [\"Chiusano\"; \"Bjarnason\"]; [\"Tolkien\"] ]\n\n// List.concat \u3067\u5e73\u5766\u5316\nlet authors = authorLists |&gt; List.concat\n// [\"Chiusano\"; \"Bjarnason\"; \"Tolkien\"]\n</code></pre>"},{"location":"fsharp/part-2/#listcollect-map-concat","title":"List.collect = map + concat","text":"<p>F# \u306e <code>List.collect</code> \u306f Scala \u306e <code>flatMap</code> \u306b\u76f8\u5f53\u3057\u307e\u3059\u3002</p> <pre><code>// map \u3057\u3066 concat\nlet authors1 = books |&gt; List.map (fun b -&gt; b.Authors) |&gt; List.concat\n\n// List.collect \u3067\u540c\u3058\u3053\u3068\u30921\u884c\u3067\nlet authors2 = books |&gt; List.collect (fun b -&gt; b.Authors)\n\nassert (authors1 = authors2)\n// [\"Chiusano\"; \"Bjarnason\"; \"Tolkien\"]\n</code></pre>"},{"location":"fsharp/part-2/#52-listcollect","title":"5.2 List.collect \u306b\u3088\u308b\u30ea\u30b9\u30c8\u30b5\u30a4\u30ba\u306e\u5909\u5316","text":"<pre><code>// \u8981\u7d20\u6570\u304c\u5897\u3048\u308b\nlet duplicate = [1; 2; 3] |&gt; List.collect (fun i -&gt; [i; i + 10])\n// [1; 11; 2; 12; 3; 13] - 6\u8981\u7d20\n\n// \u8981\u7d20\u6570\u304c\u540c\u3058\nlet doubled = [1; 2; 3] |&gt; List.collect (fun i -&gt; [i * 2])\n// [2; 4; 6] - 3\u8981\u7d20\n\n// \u8981\u7d20\u6570\u304c\u6e1b\u308b\uff08\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u52b9\u679c\uff09\nlet evens = [1; 2; 3] |&gt; List.collect (fun i -&gt;\n    if i % 2 = 0 then [i] else [])\n// [2] - 1\u8981\u7d20\n</code></pre>"},{"location":"fsharp/part-2/#53-listcollect","title":"5.3 \u30cd\u30b9\u30c8\u3057\u305f List.collect","text":"<p>\u8907\u6570\u306e\u30ea\u30b9\u30c8\u3092\u7d44\u307f\u5408\u308f\u305b\u308b\u5834\u5408\u3001List.collect \u3092\u30cd\u30b9\u30c8\u3057\u307e\u3059\u3002</p> <pre><code>type Movie = { Title: string }\n\nlet bookAdaptations (author: string) : Movie list =\n    if author = \"Tolkien\" then\n        [{ Title = \"An Unexpected Journey\" }; { Title = \"The Desolation of Smaug\" }]\n    else\n        []\n\nlet books = [\n    { Title = \"FP in Scala\"; Authors = [\"Chiusano\"; \"Bjarnason\"] }\n    { Title = \"The Hobbit\"; Authors = [\"Tolkien\"] }\n]\n\n// \u30cd\u30b9\u30c8\u3057\u305f List.collect\nlet recommendations =\n    books\n    |&gt; List.collect (fun book -&gt;\n        book.Authors\n        |&gt; List.collect (fun author -&gt;\n            bookAdaptations author\n            |&gt; List.map (fun movie -&gt;\n                $\"You may like {movie.Title}, because you liked {author}'s {book.Title}\")))\n\n// \u7d50\u679c:\n// [ \"You may like An Unexpected Journey, because you liked Tolkien's The Hobbit\"\n//   \"You may like The Desolation of Smaug, because you liked Tolkien's The Hobbit\" ]\n</code></pre> <p></p>"},{"location":"fsharp/part-2/#54","title":"5.4 \u30b7\u30fc\u30b1\u30f3\u30b9\u5f0f\uff08\u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18\uff09","text":"<p>F# \u306e\u30b7\u30fc\u30b1\u30f3\u30b9\u5f0f\u306f\u3001\u30cd\u30b9\u30c8\u3057\u305f List.collect \u3092\u8aad\u307f\u3084\u3059\u304f\u66f8\u3051\u307e\u3059\u3002</p> <pre><code>// List.collect/map \u7248\nlet c1 =\n    books\n    |&gt; List.collect (fun book -&gt;\n        book.Authors\n        |&gt; List.collect (fun author -&gt;\n            bookAdaptations author\n            |&gt; List.map (fun movie -&gt;\n                $\"You may like {movie.Title}, because you liked {author}'s {book.Title}\")))\n\n// \u30b7\u30fc\u30b1\u30f3\u30b9\u5f0f\u7248\uff08\u7b49\u4fa1\uff09\nlet c2 =\n    [ for book in books do\n      for author in book.Authors do\n      for movie in bookAdaptations author do\n      yield $\"You may like {movie.Title}, because you liked {author}'s {book.Title}\" ]\n\nassert (c1 = c2)\n</code></pre> <p></p>"},{"location":"fsharp/part-2/#55","title":"5.5 \u5186\u5185\u306e\u70b9\u306e\u5224\u5b9a","text":"<p>\u30b7\u30fc\u30b1\u30f3\u30b9\u5f0f\u3067\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u3082\u884c\u3046\u4f8b\u3067\u3059\u3002</p> <pre><code>type Point = { X: int; Y: int }\n\nlet points = [{ X = 5; Y = 2 }; { X = 1; Y = 1 }]\nlet radiuses = [2; 1]\n\nlet isInside (point: Point) (radius: int) : bool =\n    radius * radius &gt;= point.X * point.X + point.Y * point.Y\n\n// \u5168\u7d44\u307f\u5408\u308f\u305b\u3092\u751f\u6210\nlet allCombinations =\n    [ for r in radiuses do\n      for point in points do\n      yield $\"Point({point.X},{point.Y}) is within a radius of {r}: {isInside point r}\" ]\n\n// \u7d50\u679c:\n// [ \"Point(5,2) is within a radius of 2: false\"\n//   \"Point(1,1) is within a radius of 2: true\"\n//   \"Point(5,2) is within a radius of 1: false\"\n//   \"Point(1,1) is within a radius of 1: false\" ]\n</code></pre>"},{"location":"fsharp/part-2/#if","title":"if \u306b\u3088\u308b\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0","text":"<pre><code>// if \u3092\u4f7f\u3063\u305f\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\nlet insidePoints =\n    [ for r in radiuses do\n      for point in points do\n      if isInside point r then\n          yield $\"Point({point.X},{point.Y}) is within a radius of {r}\" ]\n\n// \u7d50\u679c: [ \"Point(1,1) is within a radius of 2\" ]\n</code></pre>"},{"location":"fsharp/part-2/#56","title":"5.6 \u30b7\u30fc\u30b1\u30f3\u30b9\u5f0f\u306e\u67d4\u8edf\u6027","text":"<p>F# \u306e\u30b7\u30fc\u30b1\u30f3\u30b9\u5f0f\u306f\u3001\u30ea\u30b9\u30c8 <code>[ ]</code>\u3001\u30b7\u30fc\u30b1\u30f3\u30b9 <code>seq { }</code>\u3001\u914d\u5217 <code>[| |]</code> \u3067\u4f7f\u3048\u307e\u3059\u3002</p> <pre><code>// \u30ea\u30b9\u30c8\nlet listResult =\n    [ for a in [1; 2] do\n      for b in [2; 1] do\n      yield a * b ]\n// [2; 1; 4; 2] - \u91cd\u8907\u3042\u308a\u3001\u9806\u5e8f\u3042\u308a\n\n// \u30bb\u30c3\u30c8\u3078\u306e\u5909\u63db\nlet setResult = listResult |&gt; Set.ofList\n// set [1; 2; 4] - \u91cd\u8907\u306a\u3057\n\n// \u30b7\u30fc\u30b1\u30f3\u30b9\uff08\u9045\u5ef6\u8a55\u4fa1\uff09\nlet seqResult =\n    seq { for a in [1; 2] do\n          for b in [2; 1] do\n          yield a * b }\n</code></pre>"},{"location":"fsharp/part-2/#_3","title":"\u307e\u3068\u3081","text":""},{"location":"fsharp/part-2/#part-ii_1","title":"Part II \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"fsharp/part-2/#_4","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"\u7ae0 \u4e3b\u8981\u6982\u5ff5 \u30ad\u30fc\u64cd\u4f5c \u7b2c3\u7ae0 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb <code>@</code>, <code>List.skip</code>, <code>List.truncate</code> \u7b2c4\u7ae0 \u9ad8\u968e\u95a2\u6570 <code>List.map</code>, <code>List.filter</code>, <code>List.fold</code>, <code>List.sortBy</code> \u7b2c5\u7ae0 \u5e73\u5766\u5316 <code>List.concat</code>, <code>List.collect</code>, \u30b7\u30fc\u30b1\u30f3\u30b9\u5f0f"},{"location":"fsharp/part-2/#f-scala","title":"F# \u3068 Scala \u306e\u5bfe\u5fdc","text":"\u64cd\u4f5c F# Scala \u5e73\u5766\u5316 <code>List.concat</code> <code>flatten</code> flatMap <code>List.collect</code> <code>flatMap</code> \u5185\u5305\u8868\u8a18 <code>[ for x in xs do ... ]</code> <code>for { x &lt;- xs } yield ...</code> \u7573\u307f\u8fbc\u307f <code>List.fold</code> <code>foldLeft</code> \u30d5\u30a3\u30eb\u30bf <code>List.filter</code> <code>filter</code>"},{"location":"fsharp/part-2/#_5","title":"\u91cd\u8981\u306a\u6cd5\u5247","text":"<ol> <li>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf: \u5143\u306e\u30c7\u30fc\u30bf\u306f\u5909\u66f4\u305b\u305a\u3001\u65b0\u3057\u3044\u30c7\u30fc\u30bf\u3092\u4f5c\u6210\u3059\u308b</li> <li>\u95a2\u6570\u306f\u5024: \u95a2\u6570\u3092\u5f15\u6570\u3068\u3057\u3066\u6e21\u3057\u305f\u308a\u3001\u623b\u308a\u5024\u3068\u3057\u3066\u8fd4\u3057\u305f\u308a\u3067\u304d\u308b</li> <li>List.collect \u30d1\u30bf\u30fc\u30f3: \u30cd\u30b9\u30c8\u3057\u305f\u69cb\u9020\u3092\u5e73\u5766\u5316\u3057\u306a\u304c\u3089\u5909\u63db\u3059\u308b</li> <li>\u30b7\u30fc\u30b1\u30f3\u30b9\u5f0f: List.collect/map \u306e\u7cd6\u8863\u69cb\u6587\u3068\u3057\u3066\u4f7f\u3048\u308b</li> <li>\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3: <code>|&gt;</code> \u3067\u95a2\u6570\u3092\u9023\u9396\u3055\u305b\u3066\u8aad\u307f\u3084\u3059\u304f\u3059\u308b</li> </ol>"},{"location":"fsharp/part-2/#_6","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part III \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li><code>Option</code> \u578b\u306b\u3088\u308b\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0</li> <li><code>Result</code> \u578b\u3068\u8907\u5408\u7684\u306a\u30a8\u30e9\u30fc\u51e6\u7406</li> </ul>"},{"location":"fsharp/part-2/#_7","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"fsharp/part-2/#1","title":"\u554f\u984c 1: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u64cd\u4f5c","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u30ea\u30b9\u30c8\u306e\u4e2d\u592e\u306b\u8981\u7d20\u3092\u633f\u5165\u3059\u308b\u95a2\u6570\u3067\u3059\u3002</p> <pre><code>let insertAtMiddle (element: 'a) (list: 'a list) : 'a list = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert (insertAtMiddle \"X\" [\"a\"; \"b\"; \"c\"; \"d\"] = [\"a\"; \"b\"; \"X\"; \"c\"; \"d\"])\nassert (insertAtMiddle \"X\" [\"a\"; \"b\"] = [\"a\"; \"X\"; \"b\"])\n</code></pre> \u89e3\u7b54 <pre><code>let insertAtMiddle (element: 'a) (list: 'a list) : 'a list =\n    let middle = List.length list / 2\n    let before = list |&gt; List.truncate middle\n    let after = list |&gt; List.skip middle\n    before @ [element] @ after\n</code></pre>"},{"location":"fsharp/part-2/#2","title":"\u554f\u984c 2: \u9ad8\u968e\u95a2\u6570","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u6761\u4ef6\u3092\u6e80\u305f\u3059\u8981\u7d20\u306e\u6570\u3092\u30ab\u30a6\u30f3\u30c8\u3059\u308b\u95a2\u6570\u3067\u3059\u3002</p> <pre><code>let countWhere (predicate: 'a -&gt; bool) (list: 'a list) : int = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert (countWhere (fun i -&gt; i &gt; 3) [1; 2; 3; 4; 5] = 2)\nassert (countWhere (fun (s: string) -&gt; s.Length &gt; 1) [\"a\"; \"bb\"; \"ccc\"] = 2)\n</code></pre> \u89e3\u7b54 <pre><code>let countWhere (predicate: 'a -&gt; bool) (list: 'a list) : int =\n    list |&gt; List.filter predicate |&gt; List.length\n\n// \u307e\u305f\u306f List.fold \u3092\u4f7f\u3063\u3066\nlet countWhere2 (predicate: 'a -&gt; bool) (list: 'a list) : int =\n    list |&gt; List.fold (fun count elem -&gt;\n        if predicate elem then count + 1 else count) 0\n</code></pre>"},{"location":"fsharp/part-2/#3_1","title":"\u554f\u984c 3: \u30b7\u30fc\u30b1\u30f3\u30b9\u5f0f","text":"<p>\u4ee5\u4e0b\u306e\u30cd\u30b9\u30c8\u3057\u305f List.collect \u3092\u30b7\u30fc\u30b1\u30f3\u30b9\u5f0f\u3067\u66f8\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>let result =\n    [1; 2]\n    |&gt; List.collect (fun x -&gt;\n        [10; 20]\n        |&gt; List.collect (fun y -&gt;\n            [100; 200]\n            |&gt; List.map (fun z -&gt;\n                x + y + z)))\n</code></pre> \u89e3\u7b54 <pre><code>let result =\n    [ for x in [1; 2] do\n      for y in [10; 20] do\n      for z in [100; 200] do\n      yield x + y + z ]\n\n// \u7d50\u679c: [111; 211; 121; 221; 112; 212; 122; 222]\n</code></pre>"},{"location":"fsharp/part-2/#4-listcollect","title":"\u554f\u984c 4: List.collect \u306b\u3088\u308b\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0","text":"<p>\u30b7\u30fc\u30b1\u30f3\u30b9\u5f0f\u306e <code>if</code> \u3092\u4f7f\u308f\u305a\u306b\u3001List.collect \u3060\u3051\u3067\u5076\u6570\u306e\u307f\u3092\u62bd\u51fa\u3059\u308b\u30b3\u30fc\u30c9\u3092\u66f8\u3044\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>let numbers = [1; 2; 3; 4; 5; 6]\n// \u5076\u6570\u306e\u307f\u3092\u62bd\u51fa: [2; 4; 6]\n</code></pre> \u89e3\u7b54 <pre><code>let evenNumbers =\n    numbers\n    |&gt; List.collect (fun n -&gt;\n        if n % 2 = 0 then [n] else [])\n\n// \u307e\u305f\u306f\u95a2\u6570\u306b\u5206\u96e2\nlet evenFilter (n: int) : int list =\n    if n % 2 = 0 then [n] else []\n\nlet evenNumbers2 = numbers |&gt; List.collect evenFilter\n</code></pre>"},{"location":"fsharp/part-2/#5","title":"\u554f\u984c 5: \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u66f8\u304d\u63db\u3048","text":"<p>\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50\u3092\u4f7f\u3063\u3066\u66f8\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>let result = List.length (List.filter (fun x -&gt; x &gt; 0) (List.map (fun x -&gt; x * 2) [1; -2; 3; -4; 5]))\n</code></pre> \u89e3\u7b54 <pre><code>let result =\n    [1; -2; 3; -4; 5]\n    |&gt; List.map (fun x -&gt; x * 2)\n    |&gt; List.filter (fun x -&gt; x &gt; 0)\n    |&gt; List.length\n\n// \u7d50\u679c: 3 (2, 6, 10 \u306e3\u3064)\n</code></pre>  \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50\u3092\u4f7f\u3046\u3068\u3001\u30c7\u30fc\u30bf\u306e\u5909\u63db\u904e\u7a0b\u304c\u4e0a\u304b\u3089\u4e0b\u306b\u8aad\u3081\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002"},{"location":"fsharp/part-3/","title":"Part III: \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3068 Option/Result","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3092\u5b66\u3073\u307e\u3059\u3002<code>null</code> \u3084\u4f8b\u5916\u306b\u983c\u3089\u305a\u3001<code>Option</code> \u3068 <code>Result</code> \u3092\u4f7f\u3063\u3066\u578b\u5b89\u5168\u306b\u30a8\u30e9\u30fc\u3092\u6271\u3046\u65b9\u6cd5\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"fsharp/part-3/#6-option","title":"\u7b2c6\u7ae0: Option \u578b\u306b\u3088\u308b\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":""},{"location":"fsharp/part-3/#61-option","title":"6.1 \u306a\u305c Option \u304c\u5fc5\u8981\u304b","text":"<p>\u5f93\u6765\u306e\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u306b\u306f\u554f\u984c\u304c\u3042\u308a\u307e\u3059\u3002</p> <p></p>"},{"location":"fsharp/part-3/#62-option","title":"6.2 Option \u306e\u57fa\u672c","text":"<p><code>'a option</code> \u306f\u300c<code>'a</code> \u578b\u306e\u5024\u304c\u3042\u308b\u304b\u3001\u306a\u3044\u304b\u300d\u3092\u8868\u3059\u578b\u3067\u3059\u3002</p> <p></p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/fsharp/src/Ch06/OptionHandling.fs</code></p>"},{"location":"fsharp/part-3/#63-tv","title":"6.3 TV\u756a\u7d44\u306e\u30d1\u30fc\u30b9\u4f8b","text":"<p>TV\u756a\u7d44\u306e\u6587\u5b57\u5217\u3092\u30d1\u30fc\u30b9\u3059\u308b\u4f8b\u3067 Option \u306e\u4f7f\u3044\u65b9\u3092\u5b66\u3073\u307e\u3059\u3002</p> <pre><code>type TvShow = {\n    Title: string\n    Start: int\n    End: int\n}\n\n// \u5165\u529b\u4f8b: \"Breaking Bad (2008-2013)\"\n// \u671f\u5f85\u3059\u308b\u51fa\u529b: { Title = \"Breaking Bad\"; Start = 2008; End = 2013 }\n</code></pre>"},{"location":"fsharp/part-3/#_1","title":"\u4f8b\u5916\u3092\u4f7f\u3046\u65b9\u6cd5\uff08\u554f\u984c\u3042\u308a\uff09","text":"<pre><code>let parseShowUnsafe (rawShow: string) : TvShow =\n    let bracketOpen = rawShow.IndexOf('(')\n    let bracketClose = rawShow.IndexOf(')')\n    let dash = rawShow.IndexOf('-')\n\n    let name = rawShow.Substring(0, bracketOpen).Trim()\n    let yearStart = int (rawShow.Substring(bracketOpen + 1, dash - bracketOpen - 1))\n    let yearEnd = int (rawShow.Substring(dash + 1, bracketClose - dash - 1))\n\n    { Title = name; Start = yearStart; End = yearEnd }\n\n// \u6b63\u5e38\u30b1\u30fc\u30b9\nparseShowUnsafe \"Breaking Bad (2008-2013)\"\n// { Title = \"Breaking Bad\"; Start = 2008; End = 2013 }\n\n// \u7570\u5e38\u30b1\u30fc\u30b9 \u2192 \u4f8b\u5916\u304c\u30b9\u30ed\u30fc\u3055\u308c\u308b!\nparseShowUnsafe \"Chernobyl (2019)\"        // ArgumentOutOfRangeException\nparseShowUnsafe \"The Wire 2002-2008\"      // ArgumentOutOfRangeException\n</code></pre>"},{"location":"fsharp/part-3/#option","title":"Option \u3092\u4f7f\u3046\u65b9\u6cd5","text":"<pre><code>let parseShow (rawShow: string) : TvShow option =\n    match extractName rawShow with\n    | None -&gt; None\n    | Some name -&gt;\n        let yearStart =\n            extractYearStart rawShow\n            |&gt; Option.orElse (extractSingleYear rawShow)\n        let yearEnd =\n            extractYearEnd rawShow\n            |&gt; Option.orElse (extractSingleYear rawShow)\n        match yearStart, yearEnd with\n        | Some start, Some endYear -&gt;\n            Some { Title = name; Start = start; End = endYear }\n        | _ -&gt; None\n\n// \u6b63\u5e38\u30b1\u30fc\u30b9\nparseShow \"Breaking Bad (2008-2013)\"\n// Some { Title = \"Breaking Bad\"; Start = 2008; End = 2013 }\n\n// \u7570\u5e38\u30b1\u30fc\u30b9 \u2192 None \u304c\u8fd4\u3055\u308c\u308b\uff08\u4f8b\u5916\u306a\u3057\uff09\nparseShow \"The Wire 2002-2008\"  // None\n</code></pre>"},{"location":"fsharp/part-3/#64","title":"6.4 \u5c0f\u3055\u306a\u95a2\u6570\u304b\u3089\u7d44\u307f\u7acb\u3066\u308b","text":"<p>\u8907\u96d1\u306a\u30d1\u30fc\u30b9\u51e6\u7406\u3092\u5c0f\u3055\u306a\u95a2\u6570\u306b\u5206\u89e3\u3057\u307e\u3059\u3002</p> <pre><code>/// \u6587\u5b57\u5217\u3092\u5b89\u5168\u306b\u6574\u6570\u306b\u5909\u63db\nlet tryParseInt (s: string) : int option =\n    match System.Int32.TryParse(s) with\n    | true, value -&gt; Some value\n    | false, _ -&gt; None\n\n/// \u540d\u524d\u3092\u62bd\u51fa\nlet extractName (rawShow: string) : string option =\n    let bracketOpen = rawShow.IndexOf('(')\n    if bracketOpen &gt; 0 then\n        Some (rawShow.Substring(0, bracketOpen).Trim())\n    else\n        None\n\n/// \u958b\u59cb\u5e74\u3092\u62bd\u51fa\nlet extractYearStart (rawShow: string) : int option =\n    let bracketOpen = rawShow.IndexOf('(')\n    let dash = rawShow.IndexOf('-')\n    if bracketOpen &lt;&gt; -1 &amp;&amp; dash &gt; bracketOpen + 1 then\n        let yearStr = rawShow.Substring(bracketOpen + 1, dash - bracketOpen - 1)\n        tryParseInt yearStr\n    else\n        None\n\n/// \u7d42\u4e86\u5e74\u3092\u62bd\u51fa\nlet extractYearEnd (rawShow: string) : int option =\n    let dash = rawShow.IndexOf('-')\n    let bracketClose = rawShow.IndexOf(')')\n    if dash &lt;&gt; -1 &amp;&amp; bracketClose &gt; dash + 1 then\n        let yearStr = rawShow.Substring(dash + 1, bracketClose - dash - 1)\n        tryParseInt yearStr\n    else\n        None\n</code></pre> <p></p>"},{"location":"fsharp/part-3/#65-optionorelse","title":"6.5 Option.orElse \u306b\u3088\u308b\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af","text":"<p><code>Option.orElse</code> \u3092\u4f7f\u3063\u3066\u3001\u6700\u521d\u306e Option \u304c <code>None</code> \u306e\u5834\u5408\u306b\u4ee3\u66ff\u3092\u8a66\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>let seven = Some 7\nlet eight = Some 8\nlet none: int option = None\n\nseven |&gt; Option.orElse eight   // Some 7 - \u6700\u521d\u304c Some \u306a\u306e\u3067\u305d\u306e\u307e\u307e\nnone |&gt; Option.orElse eight    // Some 8 - \u6700\u521d\u304c None \u306a\u306e\u3067\u4ee3\u66ff\u3092\u4f7f\u7528\nseven |&gt; Option.orElse none    // Some 7\nnone |&gt; Option.orElse none     // None\n</code></pre>"},{"location":"fsharp/part-3/#_2","title":"\u5358\u5e74\u306e\u756a\u7d44\u306b\u5bfe\u5fdc\u3059\u308b","text":"<p>\u300cChernobyl (2019)\u300d\u306e\u3088\u3046\u306a\u5358\u5e74\u306e\u756a\u7d44\u3092\u30d1\u30fc\u30b9\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002</p> <pre><code>/// \u5358\u5e74\u3092\u62bd\u51fa\nlet extractSingleYear (rawShow: string) : int option =\n    let dash = rawShow.IndexOf('-')\n    let bracketOpen = rawShow.IndexOf('(')\n    let bracketClose = rawShow.IndexOf(')')\n    if dash = -1 &amp;&amp; bracketOpen &lt;&gt; -1 &amp;&amp; bracketClose &gt; bracketOpen + 1 then\n        let yearStr = rawShow.Substring(bracketOpen + 1, bracketClose - bracketOpen - 1)\n        tryParseInt yearStr\n    else\n        None\n\nlet parseShow (rawShow: string) : TvShow option =\n    match extractName rawShow with\n    | None -&gt; None\n    | Some name -&gt;\n        let yearStart =\n            extractYearStart rawShow\n            |&gt; Option.orElse (extractSingleYear rawShow)\n        let yearEnd =\n            extractYearEnd rawShow\n            |&gt; Option.orElse (extractSingleYear rawShow)\n        match yearStart, yearEnd with\n        | Some start, Some endYear -&gt;\n            Some { Title = name; Start = start; End = endYear }\n        | _ -&gt; None\n\n// \u3053\u308c\u3067\u5358\u5e74\u306e\u756a\u7d44\u3082\u30d1\u30fc\u30b9\u3067\u304d\u308b\nparseShow \"Chernobyl (2019)\"\n// Some { Title = \"Chernobyl\"; Start = 2019; End = 2019 }\n</code></pre> <p></p>"},{"location":"fsharp/part-3/#66-option","title":"6.6 Option \u306e\u4e3b\u8981\u30e1\u30bd\u30c3\u30c9","text":"\u95a2\u6570 \u8aac\u660e \u4f8b <code>Option.map</code> \u5024\u304c\u3042\u308c\u3070\u5909\u63db <code>Some 5 \\|&gt; Option.map ((*) 2)</code> \u2192 <code>Some 10</code> <code>Option.bind</code> \u5024\u304c\u3042\u308c\u3070 Option \u3092\u8fd4\u3059\u95a2\u6570\u3092\u9069\u7528 <code>Some 5 \\|&gt; Option.bind (fun x -&gt; Some (x * 2))</code> \u2192 <code>Some 10</code> <code>Option.filter</code> \u6761\u4ef6\u3092\u6e80\u305f\u3055\u306a\u3051\u308c\u3070 None <code>Some 5 \\|&gt; Option.filter (fun x -&gt; x &gt; 10)</code> \u2192 <code>None</code> <code>Option.orElse</code> None \u306a\u3089\u4ee3\u66ff\u3092\u4f7f\u7528 <code>None \\|&gt; Option.orElse (Some 5)</code> \u2192 <code>Some 5</code> <code>Option.defaultValue</code> None \u306a\u3089\u30c7\u30d5\u30a9\u30eb\u30c8\u5024 <code>None \\|&gt; Option.defaultValue 0</code> \u2192 <code>0</code> <code>Option.toList</code> List \u306b\u5909\u63db <code>Some 5 \\|&gt; Option.toList</code> \u2192 <code>[5]</code> <pre><code>let year: int option = Some 996\nlet noYear: int option = None\n\n// map\nyear |&gt; Option.map (fun x -&gt; x * 2)     // Some 1992\nnoYear |&gt; Option.map (fun x -&gt; x * 2)   // None\n\n// bind\nyear |&gt; Option.bind (fun y -&gt; Some (y * 2))     // Some 1992\nnoYear |&gt; Option.bind (fun y -&gt; Some (y * 2))   // None\n\n// filter\nyear |&gt; Option.filter (fun x -&gt; x &lt; 2020)   // Some 996\nyear |&gt; Option.filter (fun x -&gt; x &gt; 2020)   // None\n\n// orElse\nyear |&gt; Option.orElse (Some 2020)     // Some 996\nnoYear |&gt; Option.orElse (Some 2020)   // Some 2020\n</code></pre>"},{"location":"fsharp/part-3/#67","title":"6.7 \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u6226\u7565","text":"<p>\u8907\u6570\u306e\u8981\u7d20\u3092\u30d1\u30fc\u30b9\u3059\u308b\u5834\u5408\u30012\u3064\u306e\u6226\u7565\u304c\u3042\u308a\u307e\u3059\u3002</p> <p></p>"},{"location":"fsharp/part-3/#best-effort","title":"Best-effort \u6226\u7565","text":"<pre><code>let parseShowsBestEffort (rawShows: string list) : TvShow list =\n    rawShows\n    |&gt; List.choose parseShow  // Some \u306e\u3082\u306e\u3060\u3051\u62bd\u51fa\n\nlet rawShows = [\n    \"Breaking Bad (2008-2013)\"\n    \"The Wire 2002 2008\"        // \u7121\u52b9\u306a\u5f62\u5f0f\n    \"Mad Men (2007-2015)\"\n]\n\nparseShowsBestEffort rawShows\n// [{ Title = \"Breaking Bad\"; ... }; { Title = \"Mad Men\"; ... }]\n// \u7121\u52b9\u306a\u3082\u306e\u306f\u7121\u8996\u3055\u308c\u308b\n</code></pre>"},{"location":"fsharp/part-3/#all-or-nothing","title":"All-or-nothing \u6226\u7565","text":"<pre><code>let parseShowsAllOrNothing (rawShows: string list) : TvShow list option =\n    let parsed = rawShows |&gt; List.map parseShow\n    if List.forall Option.isSome parsed then\n        Some (parsed |&gt; List.choose id)\n    else\n        None\n\n// \u5168\u90e8\u6210\u529f \u2192 Some [...]\nparseShowsAllOrNothing [\"Breaking Bad (2008-2013)\"; \"Mad Men (2007-2015)\"]\n// Some [{ Title = \"Breaking Bad\"; ... }; { Title = \"Mad Men\"; ... }]\n\n// \u4e00\u3064\u3067\u3082\u5931\u6557 \u2192 None\nparseShowsAllOrNothing [\"Breaking Bad (2008-2013)\"; \"Invalid\"]\n// None\n</code></pre>"},{"location":"fsharp/part-3/#68-forall-exists","title":"6.8 forall \u3068 exists","text":"<p>Option \u3067\u6761\u4ef6\u5224\u5b9a\u3092\u3059\u308b\u969b\u306b\u4fbf\u5229\u306a\u95a2\u6570\u3067\u3059\u3002</p> \u95a2\u6570 \u52d5\u4f5c <code>Option.forall p</code> None \u2192 true, Some x \u2192 p(x) <code>Option.exists p</code> None \u2192 false, Some x \u2192 p(x) <code>Option.contains x</code> Some x \u3068\u7b49\u3057\u3044\u304b <pre><code>let year = Some 996\nlet noYear: int option = None\n\n// forall - \u300c\u5168\u3066\u300d\u307e\u305f\u306f\u300c\u5b58\u5728\u3057\u306a\u3044\u300d\nyear |&gt; Option.forall (fun x -&gt; x &lt; 2020)     // true (996 &lt; 2020)\nnoYear |&gt; Option.forall (fun x -&gt; x &lt; 2020)   // true (\u5024\u304c\u306a\u3044\u306e\u3067\u300c\u5168\u3066\u300d\u304c\u81ea\u660e\u306b\u771f)\nyear |&gt; Option.forall (fun x -&gt; x &gt; 2020)     // false\n\n// exists - \u300c\u5b58\u5728\u3057\u3066\u6761\u4ef6\u3092\u6e80\u305f\u3059\u300d\nyear |&gt; Option.exists (fun x -&gt; x &lt; 2020)     // true\nnoYear |&gt; Option.exists (fun x -&gt; x &lt; 2020)   // false (\u5024\u304c\u306a\u3044\u306e\u3067\u5b58\u5728\u3057\u306a\u3044)\n</code></pre>"},{"location":"fsharp/part-3/#_3","title":"\u5b9f\u7528\u4f8b: \u30e6\u30fc\u30b6\u30fc\u306e\u30e1\u30fc\u30eb\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0","text":"<pre><code>type User = {\n    Name: string\n    Email: string option\n    Age: int\n}\n\nlet users = [\n    { Name = \"Alice\"; Email = Some \"alice@example.com\"; Age = 25 }\n    { Name = \"Bob\"; Email = None; Age = 30 }\n    { Name = \"Charlie\"; Email = Some \"charlie@test.com\"; Age = 17 }\n]\n\n// \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u304b\u3001example.com \u30c9\u30e1\u30a4\u30f3\nlet filterByDomain domain users =\n    users\n    |&gt; List.filter (fun user -&gt;\n        user.Email |&gt; Option.forall (fun email -&gt; email.EndsWith(domain)))\n\nfilterByDomain \"@example.com\" users\n// [Alice; Bob] - Bob \u306f None \u306a\u306e\u3067 forall = true\n\n// \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u3066\u3001test.com \u30c9\u30e1\u30a4\u30f3\nlet filterByDomainExists domain users =\n    users\n    |&gt; List.filter (fun user -&gt;\n        user.Email |&gt; Option.exists (fun email -&gt; email.EndsWith(domain)))\n\nfilterByDomainExists \"@test.com\" users\n// [Charlie]\n</code></pre>"},{"location":"fsharp/part-3/#7-result","title":"\u7b2c7\u7ae0: Result \u578b\u3068\u8907\u5408\u7684\u306a\u30a8\u30e9\u30fc\u51e6\u7406","text":""},{"location":"fsharp/part-3/#71-option","title":"7.1 Option \u306e\u9650\u754c","text":"<p><code>Option</code> \u306f\u300c\u5024\u304c\u3042\u308b\u304b\u306a\u3044\u304b\u300d\u3057\u304b\u8868\u73fe\u3067\u304d\u307e\u305b\u3093\u3002\u306a\u305c\u5931\u6557\u3057\u305f\u306e\u304b\u3092\u4f1d\u3048\u3089\u308c\u307e\u305b\u3093\u3002</p> <p></p>"},{"location":"fsharp/part-3/#72-result","title":"7.2 Result \u306e\u57fa\u672c","text":"<p><code>Result&lt;'T, 'Error&gt;</code> \u306f\u300c<code>'T</code> \u578b\u306e\u6210\u529f\u5024\u304b\u3001<code>'Error</code> \u578b\u306e\u30a8\u30e9\u30fc\u304b\u300d\u3092\u8868\u3059\u578b\u3067\u3059\u3002</p> <ul> <li><code>Ok value</code>: \u6210\u529f</li> <li><code>Error error</code>: \u5931\u6557\uff08\u30a8\u30e9\u30fc\u60c5\u5831\u3092\u4fdd\u6301\uff09</li> </ul> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/fsharp/src/Ch07/ResultHandling.fs</code></p> <pre><code>let extractName (show: string) : Result&lt;string, string&gt; =\n    let bracketOpen = show.IndexOf('(')\n    if bracketOpen &gt; 0 then\n        Ok (show.Substring(0, bracketOpen).Trim())\n    else\n        Error $\"Can't extract name from '{show}'\"\n\nextractName \"The Wire (2002-2008)\"  // Ok \"The Wire\"\nextractName \"(2022)\"                // Error \"Can't extract name from '(2022)'\"\n</code></pre>"},{"location":"fsharp/part-3/#73-result","title":"7.3 Result \u3092\u4f7f\u3063\u305f\u30d1\u30fc\u30b9","text":"<pre><code>let extractYearStart (rawShow: string) : Result&lt;int, string&gt; =\n    let bracketOpen = rawShow.IndexOf('(')\n    let dash = rawShow.IndexOf('-')\n    if bracketOpen &lt;&gt; -1 &amp;&amp; dash &gt; bracketOpen + 1 then\n        let yearStr = rawShow.Substring(bracketOpen + 1, dash - bracketOpen - 1)\n        tryParseInt yearStr\n    else\n        Error $\"Can't extract start year from '{rawShow}'\"\n\nextractYearStart \"The Wire (2002-2008)\"  // Ok 2002\nextractYearStart \"The Wire (-2008)\"      // Error \"Can't extract start year from 'The Wire (-2008)'\"\nextractYearStart \"The Wire (oops-2008)\"  // Error \"Can't parse 'oops' as integer\"\n</code></pre>"},{"location":"fsharp/part-3/#74-option-result","title":"7.4 Option \u304b\u3089 Result \u3078\u306e\u5909\u63db","text":"<p><code>Option.toResult</code> \u76f8\u5f53\u306e\u5909\u63db\u304c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>let year = Some 996\nlet noYear: int option = None\n\n// Option \u3092 Result \u306b\u5909\u63db\nlet toResult errorMsg opt =\n    match opt with\n    | Some x -&gt; Ok x\n    | None -&gt; Error errorMsg\n\nyear |&gt; toResult \"no year given\"     // Ok 996\nnoYear |&gt; toResult \"no year given\"   // Error \"no year given\"\n</code></pre> <p></p>"},{"location":"fsharp/part-3/#75-result","title":"7.5 Result \u306b\u3088\u308b\u5b8c\u5168\u306a\u30d1\u30fc\u30b5\u30fc","text":"<pre><code>let parseShow (rawShow: string) : Result&lt;TvShow, string&gt; =\n    match extractName rawShow with\n    | Error e -&gt; Error e\n    | Ok name -&gt;\n        let yearStart =\n            extractYearStart rawShow\n            |&gt; orElse (extractSingleYear rawShow)\n        let yearEnd =\n            extractYearEnd rawShow\n            |&gt; orElse (extractSingleYear rawShow)\n        match yearStart, yearEnd with\n        | Ok start, Ok endYear -&gt;\n            Ok { Title = name; Start = start; End = endYear }\n        | Error e, _ -&gt; Error e\n        | _, Error e -&gt; Error e\n\nparseShow \"The Wire (2002-2008)\"  // Ok { Title = \"The Wire\"; Start = 2002; End = 2008 }\nparseShow \"Mad Men ()\"            // Error \"Can't extract single year from 'Mad Men ()'\"\nparseShow \"(2002-2008)\"           // Error \"Can't extract name from '(2002-2008)'\"\n</code></pre>"},{"location":"fsharp/part-3/#76","title":"7.6 \u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3","text":"<p>Result \u306f\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u306b\u6700\u9069\u3067\u3059\u3002</p> <pre><code>let validateAge (age: int) : Result&lt;int, string&gt; =\n    if age &lt; 0 then Error \"Age cannot be negative\"\n    elif age &gt; 150 then Error \"Age cannot be greater than 150\"\n    else Ok age\n\nlet validateName (name: string) : Result&lt;string, string&gt; =\n    if System.String.IsNullOrWhiteSpace(name) then\n        Error \"Name cannot be empty\"\n    elif name.Length &gt; 100 then\n        Error \"Name cannot be longer than 100 characters\"\n    else\n        Ok name\n\nlet validateEmail (email: string) : Result&lt;string, string&gt; =\n    if System.String.IsNullOrWhiteSpace(email) then\n        Error \"Email cannot be empty\"\n    elif not (email.Contains(\"@\")) then\n        Error \"Email must contain @\"\n    else\n        Ok email\n</code></pre>"},{"location":"fsharp/part-3/#77-adt","title":"7.7 \u4ee3\u6570\u7684\u30c7\u30fc\u30bf\u578b\uff08ADT\uff09","text":"<p>F# \u3067\u306f\u3001\u5224\u5225\u5171\u7528\u4f53\uff08Discriminated Union\uff09\u3067\u76f4\u548c\u578b\u3092\u8868\u73fe\u3057\u307e\u3059\u3002</p>"},{"location":"fsharp/part-3/#product-type","title":"\u76f4\u7a4d\u578b\uff08Product Type\uff09","text":"<p>\u8907\u6570\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u3092AND\u3067\u7d44\u307f\u5408\u308f\u305b\u308b\u578b\u3067\u3059\u3002</p> <pre><code>/// \u30a2\u30fc\u30c6\u30a3\u30b9\u30c8\uff08\u76f4\u7a4d\u578b\uff09\ntype Artist = {\n    Name: string\n    Genre: MusicGenre\n    Origin: Location\n    YearsActive: YearsActive\n}\n</code></pre>"},{"location":"fsharp/part-3/#sum-type","title":"\u76f4\u548c\u578b\uff08Sum Type\uff09","text":"<p>\u8907\u6570\u306e\u9078\u629e\u80a2\u3092OR\u3067\u8868\u3059\u578b\u3067\u3059\u3002</p> <pre><code>/// \u97f3\u697d\u30b8\u30e3\u30f3\u30eb\uff08\u76f4\u548c\u578b\uff09\ntype MusicGenre =\n    | HeavyMetal\n    | Pop\n    | HardRock\n    | Jazz\n    | Classical\n\n/// \u6d3b\u52d5\u671f\u9593\uff08\u76f4\u548c\u578b\uff09\ntype YearsActive =\n    | StillActive of since: int\n    | ActiveBetween of start: int * endYear: int\n\n/// \u5730\u57df\uff08\u76f4\u548c\u578b\uff09\ntype Location =\n    | US\n    | UK\n    | England\n    | Japan\n    | Germany\n    | Other of string\n</code></pre> <p></p>"},{"location":"fsharp/part-3/#78","title":"7.8 \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0","text":"<p>\u76f4\u548c\u578b\u306f\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3067\u51e6\u7406\u3057\u307e\u3059\u3002</p> <pre><code>let wasArtistActive (artist: Artist) (yearStart: int) (yearEnd: int) : bool =\n    match artist.YearsActive with\n    | StillActive since -&gt; since &lt;= yearEnd\n    | ActiveBetween (start, endY) -&gt; start &lt;= yearEnd &amp;&amp; endY &gt;= yearStart\n\nlet activeLength (artist: Artist) (currentYear: int) : int =\n    match artist.YearsActive with\n    | StillActive since -&gt; currentYear - since\n    | ActiveBetween (start, endY) -&gt; endY - start\n\nlet describeActivity (yearsActive: YearsActive) : string =\n    match yearsActive with\n    | StillActive since -&gt; $\"Active since {since}\"\n    | ActiveBetween (start, endY) -&gt; $\"Active from {start} to {endY}\"\n</code></pre> <p></p>"},{"location":"fsharp/part-3/#79","title":"7.9 \u691c\u7d22\u6761\u4ef6\u306e\u30e2\u30c7\u30ea\u30f3\u30b0","text":"<p>\u691c\u7d22\u6761\u4ef6\u3082 ADT \u3067\u30e2\u30c7\u30ea\u30f3\u30b0\u3067\u304d\u307e\u3059\u3002</p> <pre><code>type SearchCondition =\n    | SearchByGenre of genres: MusicGenre list\n    | SearchByOrigin of locations: Location list\n    | SearchByActiveYears of start: int * endYear: int\n\nlet matchesCondition (artist: Artist) (condition: SearchCondition) : bool =\n    match condition with\n    | SearchByGenre genres -&gt; List.contains artist.Genre genres\n    | SearchByOrigin locations -&gt; List.contains artist.Origin locations\n    | SearchByActiveYears (start, endY) -&gt; wasArtistActive artist start endY\n\nlet searchArtists (artists: Artist list) (conditions: SearchCondition list) : Artist list =\n    artists\n    |&gt; List.filter (fun artist -&gt;\n        conditions |&gt; List.forall (matchesCondition artist))\n</code></pre>"},{"location":"fsharp/part-3/#710","title":"7.10 \u652f\u6255\u3044\u65b9\u6cd5\u306e\u4f8b","text":"<pre><code>type PaymentMethod =\n    | CreditCard of number: string * expiry: string\n    | BankTransfer of accountNumber: string\n    | Cash\n\nlet describePayment (method: PaymentMethod) : string =\n    match method with\n    | CreditCard (number, _) -&gt; $\"Credit card ending in {number}\"\n    | BankTransfer account -&gt; $\"Bank transfer to account {account}\"\n    | Cash -&gt; \"Cash payment\"\n\nlet isValidPayment (method: PaymentMethod) : bool =\n    match method with\n    | CreditCard (number, expiry) -&gt;\n        number.Length &gt;= 4 &amp;&amp; expiry.Contains(\"/\")\n    | BankTransfer account -&gt;\n        account.Length &gt; 0\n    | Cash -&gt; true\n</code></pre>"},{"location":"fsharp/part-3/#_4","title":"\u307e\u3068\u3081","text":""},{"location":"fsharp/part-3/#part-iii","title":"Part III \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"fsharp/part-3/#option-vs-result","title":"Option vs Result \u306e\u4f7f\u3044\u5206\u3051","text":"\u72b6\u6cc1 \u4f7f\u7528\u3059\u308b\u578b \u5024\u304c\u3042\u308b\u304b\u306a\u3044\u304b\u3060\u3051\u304c\u91cd\u8981 <code>'a option</code> \u5931\u6557\u7406\u7531\u3092\u4f1d\u3048\u308b\u5fc5\u8981\u304c\u3042\u308b <code>Result&lt;'a, string&gt;</code> \u691c\u7d22\u7d50\u679c\u304c\u898b\u3064\u304b\u3089\u306a\u3044 <code>'a option</code> \u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u30a8\u30e9\u30fc\u3092\u4f1d\u3048\u308b <code>Result&lt;'a, string&gt;</code> \u8907\u6570\u306e\u30a8\u30e9\u30fc\u7a2e\u5225\u304c\u3042\u308b <code>Result&lt;'a, ErrorType&gt;</code>"},{"location":"fsharp/part-3/#f-scala","title":"F# \u3068 Scala \u306e\u5bfe\u5fdc","text":"\u6982\u5ff5 F# Scala \u5024\u306e\u6709\u7121 <code>option</code> <code>Option</code> \u6210\u529f/\u5931\u6557 <code>Result</code> <code>Either</code> \u5024\u3042\u308a <code>Some</code> <code>Some</code> \u5024\u306a\u3057 <code>None</code> <code>None</code> \u6210\u529f <code>Ok</code> <code>Right</code> \u5931\u6557 <code>Error</code> <code>Left</code> \u76f4\u548c\u578b \u5224\u5225\u5171\u7528\u4f53 enum / sealed trait"},{"location":"fsharp/part-3/#_5","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>Option: \u5024\u306e\u6709\u7121\u3092\u578b\u3067\u8868\u73fe\u3059\u308b</li> <li>Result: \u6210\u529f/\u5931\u6557\u3068\u30a8\u30e9\u30fc\u60c5\u5831\u3092\u578b\u3067\u8868\u73fe\u3059\u308b</li> <li>\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0: Option/Result \u3092\u5b89\u5168\u306b\u51e6\u7406\u3059\u308b</li> <li>Option.orElse: \u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u3092\u63d0\u4f9b\u3059\u308b</li> <li>ADT: \u76f4\u7a4d\u578b\u3068\u76f4\u548c\u578b\u3067\u30c9\u30e1\u30a4\u30f3\u3092\u6b63\u78ba\u306b\u30e2\u30c7\u30ea\u30f3\u30b0</li> <li>forall/exists: Option \u3067\u306e\u6761\u4ef6\u5224\u5b9a\u306b\u4fbf\u5229</li> </ol>"},{"location":"fsharp/part-3/#_6","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part IV \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li>\u526f\u4f5c\u7528\u306e\u7ba1\u7406</li> <li>\u975e\u540c\u671f\u51e6\u7406</li> <li>\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406</li> </ul>"},{"location":"fsharp/part-3/#_7","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"fsharp/part-3/#1-option","title":"\u554f\u984c 1: Option \u306e\u57fa\u672c","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>let safeDivide (a: int) (b: int) : int option = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert (safeDivide 10 2 = Some 5)\nassert (safeDivide 10 0 = None)\nassert (safeDivide 7 2 = Some 3)\n</code></pre> \u89e3\u7b54 <pre><code>let safeDivide (a: int) (b: int) : int option =\n    if b = 0 then None\n    else Some (a / b)\n</code></pre>"},{"location":"fsharp/part-3/#2-option","title":"\u554f\u984c 2: Option \u306e\u5408\u6210","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u30022\u3064\u306e\u6570\u5024\u6587\u5b57\u5217\u3092\u53d7\u3051\u53d6\u308a\u3001\u305d\u306e\u5408\u8a08\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>let addStrings (a: string) (b: string) : int option = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert (addStrings \"10\" \"20\" = Some 30)\nassert (addStrings \"10\" \"abc\" = None)\nassert (addStrings \"xyz\" \"20\" = None)\n</code></pre> \u89e3\u7b54 <pre><code>let tryParseInt (s: string) : int option =\n    match System.Int32.TryParse(s) with\n    | true, value -&gt; Some value\n    | false, _ -&gt; None\n\nlet addStrings (a: string) (b: string) : int option =\n    match tryParseInt a, tryParseInt b with\n    | Some x, Some y -&gt; Some (x + y)\n    | _ -&gt; None\n</code></pre>"},{"location":"fsharp/part-3/#3-result","title":"\u554f\u984c 3: Result \u306b\u3088\u308b\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u5e74\u9f62\u3092\u691c\u8a3c\u3057\u3001\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>let validateAge (age: int) : Result&lt;int, string&gt; = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert (validateAge 25 = Ok 25)\nassert (validateAge -5 = Error \"Age cannot be negative\")\nassert (validateAge 200 = Error \"Age cannot be greater than 150\")\n</code></pre> \u89e3\u7b54 <pre><code>let validateAge (age: int) : Result&lt;int, string&gt; =\n    if age &lt; 0 then Error \"Age cannot be negative\"\n    elif age &gt; 150 then Error \"Age cannot be greater than 150\"\n    else Ok age\n</code></pre>"},{"location":"fsharp/part-3/#4","title":"\u554f\u984c 4: \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0","text":"<p>\u4ee5\u4e0b\u306e\u5224\u5225\u5171\u7528\u4f53\u3068\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u4f7f\u3063\u305f\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>type PaymentMethod =\n    | CreditCard of number: string * expiry: string\n    | BankTransfer of accountNumber: string\n    | Cash\n\nlet describePayment (method: PaymentMethod) : string = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert (describePayment (CreditCard (\"1234\", \"12/25\")) = \"Credit card ending in 1234\")\nassert (describePayment (BankTransfer \"9876\") = \"Bank transfer to account 9876\")\nassert (describePayment Cash = \"Cash payment\")\n</code></pre> \u89e3\u7b54 <pre><code>let describePayment (method: PaymentMethod) : string =\n    match method with\n    | CreditCard (number, _) -&gt; $\"Credit card ending in {number}\"\n    | BankTransfer account -&gt; $\"Bank transfer to account {account}\"\n    | Cash -&gt; \"Cash payment\"\n</code></pre>"},{"location":"fsharp/part-3/#5-forall-exists","title":"\u554f\u984c 5: forall \u3068 exists","text":"<p>\u4ee5\u4e0b\u306e\u6761\u4ef6\u306b\u5408\u3046\u30e6\u30fc\u30b6\u30fc\u3092\u62bd\u51fa\u3059\u308b\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>type User = {\n    Name: string\n    Email: string option\n    Age: int\n}\n\nlet users = [\n    { Name = \"Alice\"; Email = Some \"alice@example.com\"; Age = 25 }\n    { Name = \"Bob\"; Email = None; Age = 30 }\n    { Name = \"Charlie\"; Email = Some \"charlie@test.com\"; Age = 17 }\n]\n\n// 1. \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u304b\u3001example.com \u30c9\u30e1\u30a4\u30f3\u306e\u30e6\u30fc\u30b6\u30fc\nlet f1 (users: User list) : User list = ???\n\n// 2. \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u3066\u3001test.com \u30c9\u30e1\u30a4\u30f3\u306e\u30e6\u30fc\u30b6\u30fc\nlet f2 (users: User list) : User list = ???\n</code></pre> \u89e3\u7b54 <pre><code>// 1. \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u304b\u3001example.com \u30c9\u30e1\u30a4\u30f3\nlet f1 (users: User list) : User list =\n    users\n    |&gt; List.filter (fun user -&gt;\n        user.Email |&gt; Option.forall (fun email -&gt; email.EndsWith(\"@example.com\")))\n// [Alice; Bob]\n\n// 2. \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u3066\u3001test.com \u30c9\u30e1\u30a4\u30f3\nlet f2 (users: User list) : User list =\n    users\n    |&gt; List.filter (fun user -&gt;\n        user.Email |&gt; Option.exists (fun email -&gt; email.EndsWith(\"@test.com\")))\n// [Charlie]\n</code></pre>"},{"location":"fsharp/part-4/","title":"Part IV: \u975e\u540c\u671f\u51e6\u7406\u3068\u30b9\u30c8\u30ea\u30fc\u30e0","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u526f\u4f5c\u7528\u306e\u6271\u3044\u65b9\u3092\u5b66\u3073\u307e\u3059\u3002F# \u306e Async \u3092\u4f7f\u3063\u3066\u526f\u4f5c\u7528\u3092\u7d14\u7c8b\u95a2\u6570\u5185\u3067\u5b89\u5168\u306b\u8a18\u8ff0\u3057\u3001Seq\uff08\u30b7\u30fc\u30b1\u30f3\u30b9\uff09\u3067\u7121\u9650\u306e\u30c7\u30fc\u30bf\u3092\u6271\u3046\u65b9\u6cd5\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"fsharp/part-4/#8-async","title":"\u7b2c8\u7ae0: Async \u306b\u3088\u308b\u975e\u540c\u671f\u51e6\u7406","text":""},{"location":"fsharp/part-4/#81","title":"8.1 \u526f\u4f5c\u7528\u306e\u554f\u984c","text":"<p>\u7d14\u7c8b\u95a2\u6570\u306f\u526f\u4f5c\u7528\u3092\u6301\u3061\u307e\u305b\u3093\u3002\u3057\u304b\u3057\u3001\u5b9f\u969b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u306b\u306f\u526f\u4f5c\u7528\u304c\u5fc5\u8981\u3067\u3059:</p> <ul> <li>\u30d5\u30a1\u30a4\u30eb\u306e\u8aad\u307f\u66f8\u304d</li> <li>\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u901a\u4fe1</li> <li>\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30a2\u30af\u30bb\u30b9</li> <li>\u4e71\u6570\u751f\u6210</li> <li>\u73fe\u5728\u6642\u523b\u306e\u53d6\u5f97</li> </ul> <p></p>"},{"location":"fsharp/part-4/#82-f-async","title":"8.2 F# \u306e Async \u3068\u306f","text":"<p>Async\uff08\u975e\u540c\u671f\u8a08\u7b97\uff09\u306f\u300c\u526f\u4f5c\u7528\u3092\u6301\u3064\u8a08\u7b97\u306e\u8a18\u8ff0\u300d\u3092\u8868\u3059\u578b\u3067\u3059\u3002</p> <ul> <li><code>Async&lt;'a&gt;</code> \u306f\u300c\u5b9f\u884c\u3059\u308b\u3068 <code>'a</code> \u578b\u306e\u5024\u3092\u8fd4\u3059\u526f\u4f5c\u7528\u306e\u3042\u308b\u8a08\u7b97\u300d</li> <li>Async \u5024\u3092\u4f5c\u6210\u3057\u305f\u3060\u3051\u3067\u306f\u526f\u4f5c\u7528\u306f\u767a\u751f\u3057\u306a\u3044</li> <li><code>Async.RunSynchronously</code> \u3067\u5b9f\u969b\u306b\u5b9f\u884c\u3055\u308c\u308b</li> </ul> <p></p>"},{"location":"fsharp/part-4/#83","title":"8.3 \u30b5\u30a4\u30b3\u30ed\u3092\u632f\u308b\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/fsharp/src/Ch08/AsyncIO.fs</code></p>"},{"location":"fsharp/part-4/#_1","title":"\u4e0d\u7d14\u306a\u95a2\u6570\uff08\u526f\u4f5c\u7528\u3042\u308a\uff09","text":"<pre><code>open System\n\nlet castTheDieImpure () : int =\n    let random = Random()\n    random.Next(1, 7)\n\n// \u547c\u3073\u51fa\u3059\u305f\u3073\u306b\u7570\u306a\u308b\u5024\u304c\u8fd4\u308b\nprintfn \"%d\" (castTheDieImpure ())  // 3\nprintfn \"%d\" (castTheDieImpure ())  // 5\nprintfn \"%d\" (castTheDieImpure ())  // 1\n</code></pre>"},{"location":"fsharp/part-4/#async","title":"Async \u3092\u4f7f\u3063\u305f\u7d14\u7c8b\u306a\u8a18\u8ff0","text":"<pre><code>let castTheDie () : Async&lt;int&gt; =\n    async { return castTheDieImpure () }\n\n// Async \u5024\u3092\u4f5c\u6210\uff08\u3053\u306e\u6642\u70b9\u3067\u306f\u5b9f\u884c\u3055\u308c\u306a\u3044\uff09\nlet dieCast: Async&lt;int&gt; = castTheDie ()\nprintfn \"%A\" dieCast  // Async&lt;int&gt; - \u307e\u3060\u5b9f\u884c\u3055\u308c\u3066\u3044\u306a\u3044\n\n// \u5b9f\u969b\u306b\u5b9f\u884c\nprintfn \"%d\" (Async.RunSynchronously dieCast)  // 4\n</code></pre>"},{"location":"fsharp/part-4/#84-async","title":"8.4 Async \u306e\u4f5c\u6210\u65b9\u6cd5","text":"\u65b9\u6cd5 \u7528\u9014 \u4f8b <code>async { return expr }</code> \u526f\u4f5c\u7528\u306e\u3042\u308b\u5f0f\u3092\u30e9\u30c3\u30d7 <code>async { return castTheDieImpure () }</code> <code>async { return value }</code> \u65e2\u5b58\u306e\u5024\u3092\u30e9\u30c3\u30d7\uff08\u526f\u4f5c\u7528\u306a\u3057\uff09 <code>async { return 42 }</code> <code>async { return () }</code> \u4f55\u3082\u3057\u306a\u3044 Async <code>async { return () }</code> <pre><code>// \u526f\u4f5c\u7528\u3092\u9045\u5ef6\u5b9f\u884c\nlet delayedPrint: Async&lt;unit&gt; = async {\n    printfn \"Hello\"\n    return ()\n}\n// println \u306f\u307e\u3060\u5b9f\u884c\u3055\u308c\u3066\u3044\u306a\u3044\n\n// \u65e2\u5b58\u306e\u5024\u3092\u30e9\u30c3\u30d7\nlet pureValue: Async&lt;int&gt; = async { return 42 }\n// \u526f\u4f5c\u7528\u306a\u3057\u3001\u5373\u5ea7\u306b 42 \u304c\u78ba\u5b9a\n</code></pre>"},{"location":"fsharp/part-4/#85-async","title":"8.5 Async \u306e\u5408\u6210","text":"<p>Async \u5024\u306f <code>let!</code> \u3092\u4f7f\u3063\u3066\u5408\u6210\u3067\u304d\u307e\u3059\u3002</p> <pre><code>let castTheDieTwice () : Async&lt;int&gt; =\n    async {\n        let! firstCast = castTheDie ()\n        let! secondCast = castTheDie ()\n        return firstCast + secondCast\n    }\n\n// \u307e\u3060\u5b9f\u884c\u3055\u308c\u3066\u3044\u306a\u3044\nlet program: Async&lt;int&gt; = castTheDieTwice ()\n\n// \u5b9f\u884c\nlet result: int = Async.RunSynchronously program\n</code></pre> <p></p>"},{"location":"fsharp/part-4/#86","title":"8.6 \u30df\u30fc\u30c6\u30a3\u30f3\u30b0\u30b9\u30b1\u30b8\u30e5\u30fc\u30ea\u30f3\u30b0\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/fsharp/src/Ch08/AsyncIO.fs</code></p> <p>\u3088\u308a\u5b9f\u8df5\u7684\u306a\u4f8b\u3068\u3057\u3066\u3001\u30df\u30fc\u30c6\u30a3\u30f3\u30b0\u306e\u30b9\u30b1\u30b8\u30e5\u30fc\u30ea\u30f3\u30b0\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p> <pre><code>type MeetingTime = { StartHour: int; EndHour: int }\n\n// \u526f\u4f5c\u7528\u306e\u3042\u308b API \u547c\u3073\u51fa\u3057\u3092 Async \u3067\u30e9\u30c3\u30d7\nlet calendarEntries (name: string) : Async&lt;MeetingTime list&gt; =\n    async { return calendarEntriesApiCall name }\n\nlet createMeeting (names: string list) (meeting: MeetingTime) : Async&lt;unit&gt; =\n    async { return createMeetingApiCall names meeting }\n</code></pre>"},{"location":"fsharp/part-4/#_2","title":"\u4e88\u5b9a\u306e\u53d6\u5f97","text":"<pre><code>let scheduledMeetings (person1: string) (person2: string) : Async&lt;MeetingTime list&gt; =\n    async {\n        let! entries1 = calendarEntries person1\n        let! entries2 = calendarEntries person2\n        return entries1 @ entries2\n    }\n</code></pre>"},{"location":"fsharp/part-4/#_3","title":"\u7a7a\u304d\u6642\u9593\u306e\u8a08\u7b97\uff08\u7d14\u7c8b\u95a2\u6570\uff09","text":"<pre><code>let possibleMeetings\n    (existingMeetings: MeetingTime list)\n    (startHour: int)\n    (endHour: int)\n    (lengthHours: int)\n    : MeetingTime list =\n    [ startHour .. (endHour - lengthHours) ]\n    |&gt; List.map (fun start -&gt; { StartHour = start; EndHour = start + lengthHours })\n    |&gt; List.filter (fun slot -&gt;\n        existingMeetings |&gt; List.forall (fun meeting -&gt; not (meetingsOverlap meeting slot)))\n</code></pre>"},{"location":"fsharp/part-4/#87-orelse","title":"8.7 orElse \u306b\u3088\u308b\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":"<p>\u5931\u6557\u6642\u306e\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002</p> <pre><code>let orElse (fallback: Async&lt;'a&gt;) (primary: Async&lt;'a&gt;) : Async&lt;'a&gt; =\n    async {\n        try\n            return! primary\n        with _ -&gt;\n            return! fallback\n    }\n\nlet year: Async&lt;int&gt; = async { return 996 }\nlet noYear: Async&lt;int&gt; = async { return failwith \"no year\" }\n\nyear |&gt; orElse (async { return 2020 }) |&gt; Async.RunSynchronously    // 996\nnoYear |&gt; orElse (async { return 2020 }) |&gt; Async.RunSynchronously  // 2020\n</code></pre> <p></p>"},{"location":"fsharp/part-4/#_4","title":"\u30ea\u30c8\u30e9\u30a4\u6226\u7565","text":"<pre><code>// API \u547c\u3073\u51fa\u3057\u30923\u56de\u307e\u3067\u30ea\u30c8\u30e9\u30a4\ncalendarEntries \"Alice\"\n|&gt; orElse (calendarEntries \"Alice\")\n|&gt; orElse (calendarEntries \"Alice\")\n|&gt; orElse (async { return [] })  // \u5168\u90e8\u5931\u6557\u3057\u305f\u3089\u7a7a\u30ea\u30b9\u30c8\n</code></pre>"},{"location":"fsharp/part-4/#_5","title":"\u6c4e\u7528\u30ea\u30c8\u30e9\u30a4\u95a2\u6570","text":"<pre><code>let retry (maxRetries: int) (action: Async&lt;'a&gt;) : Async&lt;'a&gt; =\n    let rec loop remaining =\n        async {\n            try\n                return! action\n            with ex -&gt;\n                if remaining &gt; 0 then\n                    return! loop (remaining - 1)\n                else\n                    return raise ex\n        }\n    loop maxRetries\n\n// \u4f7f\u7528\u4f8b\nretry 10 (calendarEntries \"Alice\")\n</code></pre>"},{"location":"fsharp/part-4/#88-sequence-async","title":"8.8 sequence \u306b\u3088\u308b Async \u306e\u30ea\u30b9\u30c8\u51e6\u7406","text":"<p><code>Async&lt;'a&gt; list</code> \u3092 <code>Async&lt;'a list&gt;</code> \u306b\u5909\u63db\u3059\u308b\u306b\u306f sequence \u3092\u4f7f\u3044\u307e\u3059\u3002</p> <pre><code>let sequence (asyncList: Async&lt;'a&gt; list) : Async&lt;'a list&gt; =\n    async {\n        let! results =\n            asyncList\n            |&gt; List.map (fun a -&gt; async {\n                let! result = a\n                return result\n            })\n            |&gt; Async.Sequential\n        return results |&gt; Array.toList\n    }\n\nlet actions: Async&lt;int&gt; list = [ async { return 1 }; async { return 2 }; async { return 3 } ]\nlet combined: Async&lt;int list&gt; = sequence actions\n\nAsync.RunSynchronously combined  // [1; 2; 3]\n</code></pre>"},{"location":"fsharp/part-4/#_6","title":"\u8907\u6570\u4eba\u306e\u4e88\u5b9a\u3092\u53d6\u5f97","text":"<pre><code>let scheduledMeetingsMultiple (attendees: string list) : Async&lt;MeetingTime list&gt; =\n    async {\n        let! allMeetings =\n            attendees\n            |&gt; List.map (fun name -&gt; retry 10 (calendarEntries name))\n            |&gt; sequence\n        return allMeetings |&gt; List.concat\n    }\n</code></pre>"},{"location":"fsharp/part-4/#89","title":"8.9 \u4e26\u5217\u5b9f\u884c","text":"<p>F# \u3067\u306f <code>Async.Parallel</code> \u3067\u8907\u6570\u306e Async \u3092\u4e26\u5217\u5b9f\u884c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>let parallelAll (asyncList: Async&lt;'a&gt; list) : Async&lt;'a list&gt; =\n    async {\n        let! results = Async.Parallel asyncList\n        return results |&gt; Array.toList\n    }\n\n// \u4f7f\u7528\u4f8b\nlet tasks = [ calendarEntries \"Alice\"; calendarEntries \"Bob\"; calendarEntries \"Charlie\" ]\nlet allResults = parallelAll tasks |&gt; Async.RunSynchronously\n</code></pre>"},{"location":"fsharp/part-4/#9","title":"\u7b2c9\u7ae0: \u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406","text":""},{"location":"fsharp/part-4/#91-seq","title":"9.1 Seq\uff08\u30b7\u30fc\u30b1\u30f3\u30b9\uff09\u3068\u306f","text":"<p>Seq\uff08\u30b7\u30fc\u30b1\u30f3\u30b9\uff09\u306f\u3001\u8981\u7d20\u306e\uff08\u6f5c\u5728\u7684\u306b\u7121\u9650\u306e\uff09\u30b7\u30fc\u30b1\u30f3\u30b9\u3092\u8868\u3057\u307e\u3059\u3002</p> <p></p>"},{"location":"fsharp/part-4/#92","title":"9.2 \u7d14\u7c8b\u306a\u30b7\u30fc\u30b1\u30f3\u30b9","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/fsharp/src/Ch09/StreamProcessing.fs</code></p> <pre><code>// \u6709\u9650\u30b7\u30fc\u30b1\u30f3\u30b9\nlet numbers: int seq = seq { 1; 2; 3 }\n\n// List \u306b\u5909\u63db\nnumbers |&gt; Seq.toList  // [1; 2; 3]\n\n// \u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\nlet oddNumbers = numbers |&gt; Seq.filter (fun n -&gt; n % 2 &lt;&gt; 0)\noddNumbers |&gt; Seq.toList  // [1; 3]\n</code></pre>"},{"location":"fsharp/part-4/#93","title":"9.3 \u7121\u9650\u30b7\u30fc\u30b1\u30f3\u30b9","text":"<pre><code>// repeat \u3067\u7121\u9650\u306b\u7e70\u308a\u8fd4\u3057\nlet repeat (elements: 'a seq) : 'a seq =\n    seq {\n        while true do\n            yield! elements\n    }\n\nlet infinite123s: int seq = repeat (seq { 1; 2; 3 })\n\n// take \u3067\u6709\u9650\u500b\u3092\u53d6\u5f97\ninfinite123s |&gt; Seq.take 8 |&gt; Seq.toList  // [1; 2; 3; 1; 2; 3; 1; 2]\n</code></pre>"},{"location":"fsharp/part-4/#94","title":"9.4 \u30b5\u30a4\u30b3\u30ed\u3092\u632f\u308b\u30b9\u30c8\u30ea\u30fc\u30e0","text":"<pre><code>let private random = Random()\n\nlet private castTheDieImpure () : int =\n    random.Next(1, 7)\n\n// \u30b5\u30a4\u30b3\u30ed\u3092\u7121\u9650\u306b\u632f\u308b\u30b9\u30c8\u30ea\u30fc\u30e0\nlet infiniteDieCasts : int seq =\n    seq {\n        while true do\n            yield castTheDieImpure ()\n    }\n\n// \u6700\u521d\u306e3\u56de\u3092\u53d6\u5f97\ninfiniteDieCasts |&gt; Seq.take 3 |&gt; Seq.toList  // [4; 2; 6]\n\n// 6 \u304c\u51fa\u308b\u307e\u3067\u632f\u308a\u7d9a\u3051\u308b\nlet castUntil (target: int) : int seq =\n    infiniteDieCasts\n    |&gt; Seq.takeWhile (fun n -&gt; n &lt;&gt; target)\n    |&gt; Seq.append (Seq.singleton target)\n</code></pre>"},{"location":"fsharp/part-4/#95","title":"9.5 \u30b7\u30fc\u30b1\u30f3\u30b9\u306e\u4e3b\u8981\u64cd\u4f5c","text":"\u64cd\u4f5c \u8aac\u660e \u4f8b <code>Seq.take n</code> \u6700\u521d\u306e n \u8981\u7d20\u3092\u53d6\u5f97 <code>seq \\|&gt; Seq.take 3</code> <code>Seq.filter p</code> \u6761\u4ef6\u3092\u6e80\u305f\u3059\u8981\u7d20\u306e\u307f <code>seq \\|&gt; Seq.filter (fun x -&gt; x &gt; 0)</code> <code>Seq.map f</code> \u5404\u8981\u7d20\u3092\u5909\u63db <code>seq \\|&gt; Seq.map (fun x -&gt; x * 2)</code> <code>Seq.append s1 s2</code> 2\u3064\u306e\u30b7\u30fc\u30b1\u30f3\u30b9\u3092\u7d50\u5408 <code>Seq.append s1 s2</code> <code>Seq.windowed n</code> \u30b9\u30e9\u30a4\u30c7\u30a3\u30f3\u30b0\u30a6\u30a3\u30f3\u30c9\u30a6 <code>seq \\|&gt; Seq.windowed 3</code>"},{"location":"fsharp/part-4/#96","title":"9.6 \u901a\u8ca8\u4ea4\u63db\u30ec\u30fc\u30c8\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/fsharp/src/Ch09/StreamProcessing.fs</code></p> <p>\u70ba\u66ff\u30ec\u30fc\u30c8\u3092\u76e3\u8996\u3057\u3066\u3001\u4e0a\u6607\u30c8\u30ec\u30f3\u30c9\u3092\u691c\u51fa\u3059\u308b\u4f8b\u3067\u3059\u3002</p>"},{"location":"fsharp/part-4/#_7","title":"\u30c8\u30ec\u30f3\u30c9\u5224\u5b9a\uff08\u7d14\u7c8b\u95a2\u6570\uff09","text":"<pre><code>let trending (rates: decimal list) : bool =\n    rates.Length &gt; 1 &amp;&amp;\n    rates\n    |&gt; List.pairwise\n    |&gt; List.forall (fun (prev, curr) -&gt; curr &gt; prev)\n\ntrending [0.81m; 0.82m; 0.83m]  // true (\u4e0a\u6607\u30c8\u30ec\u30f3\u30c9)\ntrending [0.81m; 0.84m; 0.83m]  // false\n</code></pre>"},{"location":"fsharp/part-4/#_8","title":"\u30ec\u30fc\u30c8\u306e\u30b9\u30c8\u30ea\u30fc\u30e0","text":"<pre><code>type Currency = USD | EUR | GBP | JPY\n\nlet rates (from: Currency) (toC: Currency) : decimal seq =\n    seq {\n        while true do\n            yield getExchangeRate from toC\n    }\n</code></pre>"},{"location":"fsharp/part-4/#97","title":"9.7 \u30b9\u30e9\u30a4\u30c7\u30a3\u30f3\u30b0\u30a6\u30a3\u30f3\u30c9\u30a6","text":"<p><code>Seq.windowed</code> \u3067\u9023\u7d9a\u3059\u308b\u8981\u7d20\u3092\u30b0\u30eb\u30fc\u30d7\u5316\u3067\u304d\u307e\u3059\u3002</p> <pre><code>let stream = seq { 1; 2; 3; 4; 5 }\n\nstream |&gt; Seq.windowed 3 |&gt; Seq.toList\n// [[|1; 2; 3|]; [|2; 3; 4|]; [|3; 4; 5|]]\n</code></pre> <p></p>"},{"location":"fsharp/part-4/#_9","title":"\u30c8\u30ec\u30f3\u30c9\u3092\u691c\u51fa\u3057\u3066\u4ea4\u63db","text":"<pre><code>let exchangeIfTrending\n    (amount: decimal)\n    (from: Currency)\n    (toC: Currency)\n    (windowSize: int)\n    : decimal option =\n    rates from toC\n    |&gt; Seq.windowed windowSize\n    |&gt; Seq.map Array.toList\n    |&gt; Seq.tryFind trending\n    |&gt; Option.map (fun rateWindow -&gt;\n        let lastRate = rateWindow |&gt; List.last\n        amount * lastRate)\n</code></pre>"},{"location":"fsharp/part-4/#98","title":"9.8 \u30b7\u30fc\u30b1\u30f3\u30b9\u306e\u7d50\u5408","text":"<p>2\u3064\u306e\u30b7\u30fc\u30b1\u30f3\u30b9\u3092 <code>Seq.zip</code> \u3067\u7d50\u5408\u3067\u304d\u307e\u3059\u3002</p> <pre><code>let s1 = seq { 1; 2; 3 }\nlet s2 = seq { \"a\"; \"b\"; \"c\" }\n\nSeq.zip s1 s2 |&gt; Seq.toList  // [(1, \"a\"); (2, \"b\"); (3, \"c\")]\n\n// \u5de6\u5074\u306e\u5024\u306e\u307f\u3092\u8fd4\u3059\nlet zipLeft (stream1: 'a seq) (stream2: 'b seq) : 'a seq =\n    Seq.zip stream1 stream2\n    |&gt; Seq.map fst\n</code></pre> <p></p>"},{"location":"fsharp/part-4/#99","title":"9.9 \u5b9f\u7528\u7684\u306a\u30b9\u30c8\u30ea\u30fc\u30e0\u64cd\u4f5c","text":"<pre><code>// \u7d2f\u7a4d\u548c\nlet runningSum (stream: int seq) : int seq =\n    stream |&gt; Seq.scan (+) 0 |&gt; Seq.skip 1\n\nrunningSum (seq { 1; 2; 3; 4; 5 }) |&gt; Seq.toList  // [1; 3; 6; 10; 15]\n\n// \u79fb\u52d5\u5e73\u5747\nlet movingAverage (windowSize: int) (stream: decimal seq) : decimal seq =\n    stream\n    |&gt; Seq.windowed windowSize\n    |&gt; Seq.map (fun window -&gt;\n        window |&gt; Array.sum |&gt; fun s -&gt; s / decimal windowSize)\n\n// \u9023\u7d9a\u3059\u308b\u91cd\u8907\u3092\u9664\u53bb\nlet distinctConsecutive (stream: 'a seq) : 'a seq =\n    seq {\n        let mutable prev = None\n        for item in stream do\n            match prev with\n            | Some p when p = item -&gt; ()\n            | _ -&gt;\n                yield item\n                prev &lt;- Some item\n    }\n</code></pre>"},{"location":"fsharp/part-4/#scala","title":"Scala \u3068\u306e\u6bd4\u8f03","text":""},{"location":"fsharp/part-4/#io-async","title":"IO \u3068 Async \u306e\u6bd4\u8f03","text":"Scala (Cats Effect) F# \u8aac\u660e <code>IO[A]</code> <code>Async&lt;'a&gt;</code> \u526f\u4f5c\u7528\u3092\u8a18\u8ff0\u3059\u308b\u578b <code>IO.delay(expr)</code> <code>async { return expr }</code> \u526f\u4f5c\u7528\u3092\u30e9\u30c3\u30d7 <code>IO.pure(value)</code> <code>async { return value }</code> \u7d14\u7c8b\u306a\u5024\u3092\u30e9\u30c3\u30d7 <code>for { a &lt;- io1; b &lt;- io2 } yield ...</code> <code>async { let! a = io1; let! b = io2; return ... }</code> \u5408\u6210 <code>io.unsafeRunSync()</code> <code>Async.RunSynchronously io</code> \u540c\u671f\u5b9f\u884c <code>io1.orElse(io2)</code> <code>io1 \\|&gt; orElse io2</code> \u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af <code>ios.sequence</code> <code>sequence ios</code> \u30ea\u30b9\u30c8\u306e\u5909\u63db"},{"location":"fsharp/part-4/#stream-seq","title":"Stream \u3068 Seq \u306e\u6bd4\u8f03","text":"Scala (fs2) F# \u8aac\u660e <code>Stream[Pure, A]</code> <code>'a seq</code> \u7d14\u7c8b\u306a\u30b9\u30c8\u30ea\u30fc\u30e0 <code>Stream.eval(io)</code> <code>async { ... }</code> + \u5909\u63db IO \u3092\u542b\u3080\u30b9\u30c8\u30ea\u30fc\u30e0 <code>stream.repeat</code> <code>repeat stream</code> \u7121\u9650\u7e70\u308a\u8fd4\u3057 <code>stream.take(n)</code> <code>Seq.take n stream</code> \u6700\u521d\u306e n \u8981\u7d20 <code>stream.filter(p)</code> <code>Seq.filter p stream</code> \u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0 <code>stream.sliding(n)</code> <code>Seq.windowed n stream</code> \u30b9\u30e9\u30a4\u30c7\u30a3\u30f3\u30b0\u30a6\u30a3\u30f3\u30c9\u30a6"},{"location":"fsharp/part-4/#_10","title":"\u307e\u3068\u3081","text":""},{"location":"fsharp/part-4/#part-iv_1","title":"Part IV \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"fsharp/part-4/#async-seq","title":"Async \u3068 Seq \u306e\u6bd4\u8f03","text":"\u7279\u6027 Async&lt;'a&gt; 'a seq \u8981\u7d20\u6570 1\u3064 0\u500b\u4ee5\u4e0a\uff08\u7121\u9650\u3082\u53ef\uff09 \u5b9f\u884c <code>Async.RunSynchronously</code> <code>Seq.toList</code> \u7528\u9014 \u5358\u4e00\u306e\u526f\u4f5c\u7528 \u9023\u7d9a\u3057\u305f\u8981\u7d20\u306e\u51e6\u7406"},{"location":"fsharp/part-4/#_11","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>Async: \u526f\u4f5c\u7528\u3092\u300c\u8a18\u8ff0\u300d\u3068\u3057\u3066\u6271\u3044\u3001\u5b9f\u884c\u3092\u9045\u5ef6\u3055\u305b\u308b</li> <li>async { return ... }: \u526f\u4f5c\u7528\u306e\u3042\u308b\u5f0f\u3092 Async \u306b\u30e9\u30c3\u30d7</li> <li>let!: Async \u3092\u5408\u6210\uff08Scala \u306e flatMap \u76f8\u5f53\uff09</li> <li>orElse: \u5931\u6557\u6642\u306e\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u3092\u6307\u5b9a</li> <li>sequence: <code>Async&lt;'a&gt; list</code> \u2192 <code>Async&lt;'a list&gt;</code></li> <li>Seq: \u6f5c\u5728\u7684\u306b\u7121\u9650\u306e\u30b7\u30fc\u30b1\u30f3\u30b9\u3092\u9045\u5ef6\u8a55\u4fa1\u3067\u51e6\u7406</li> <li>Seq.windowed: \u9023\u7d9a\u3059\u308b\u8981\u7d20\u3092\u30b0\u30eb\u30fc\u30d7\u5316\u3057\u3066\u30d1\u30bf\u30fc\u30f3\u3092\u691c\u51fa</li> </ol>"},{"location":"fsharp/part-4/#_12","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part V \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li>\u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406</li> <li>Agent\uff08MailboxProcessor\uff09\u306b\u3088\u308b\u8efd\u91cf\u4e26\u884c\u51e6\u7406</li> <li>\u5171\u6709\u72b6\u614b\u306e\u7ba1\u7406</li> </ul>"},{"location":"fsharp/part-4/#_13","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"fsharp/part-4/#1-async","title":"\u554f\u984c 1: Async \u306e\u57fa\u672c","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>let printAndReturn (message: string) : Async&lt;string&gt; = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\n// printAndReturn \"Hello\" |&gt; Async.RunSynchronously \u306f\n// \"Hello\" \u3092\u30b3\u30f3\u30bd\u30fc\u30eb\u306b\u51fa\u529b\u3057\u3001\"Hello\" \u3092\u8fd4\u3059\n</code></pre> \u89e3\u7b54 <pre><code>let printAndReturn (message: string) : Async&lt;string&gt; =\n    async {\n        printfn \"%s\" message\n        return message\n    }\n</code></pre>"},{"location":"fsharp/part-4/#2-async","title":"\u554f\u984c 2: Async \u306e\u5408\u6210","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u30022\u3064\u306e Async \u3092\u9806\u756a\u306b\u5b9f\u884c\u3057\u3001\u7d50\u679c\u3092\u7d50\u5408\u3057\u307e\u3059\u3002</p> <pre><code>let combineAsync (async1: Async&lt;'a&gt;) (async2: Async&lt;'b&gt;) (f: 'a -&gt; 'b -&gt; 'c) : Async&lt;'c&gt; = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nlet result = combineAsync (async { return 1 }) (async { return 2 }) (+)\nAsync.RunSynchronously result  // 3\n</code></pre> \u89e3\u7b54 <pre><code>let combineAsync (async1: Async&lt;'a&gt;) (async2: Async&lt;'b&gt;) (f: 'a -&gt; 'b -&gt; 'c) : Async&lt;'c&gt; =\n    async {\n        let! a = async1\n        let! b = async2\n        return f a b\n    }\n</code></pre>"},{"location":"fsharp/part-4/#3","title":"\u554f\u984c 3: \u30ea\u30c8\u30e9\u30a4","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u6307\u5b9a\u56de\u6570\u30ea\u30c8\u30e9\u30a4\u3057\u3001\u5168\u90e8\u5931\u6557\u3057\u305f\u3089\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>let retryWithDefault (maxRetries: int) (defaultValue: 'a) (action: Async&lt;'a&gt;) : Async&lt;'a&gt; = ???\n</code></pre> \u89e3\u7b54 <pre><code>let retryWithDefault (maxRetries: int) (defaultValue: 'a) (action: Async&lt;'a&gt;) : Async&lt;'a&gt; =\n    let rec loop remaining =\n        async {\n            try\n                return! action\n            with _ -&gt;\n                if remaining &gt; 0 then\n                    return! loop (remaining - 1)\n                else\n                    return defaultValue\n        }\n    loop maxRetries\n</code></pre>"},{"location":"fsharp/part-4/#4","title":"\u554f\u984c 4: \u30b7\u30fc\u30b1\u30f3\u30b9\u64cd\u4f5c","text":"<p>\u4ee5\u4e0b\u306e\u30b7\u30fc\u30b1\u30f3\u30b9\u3092\u4f5c\u6210\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>// 1. 1\u304b\u308910\u307e\u3067\u306e\u5076\u6570\u306e\u30b7\u30fc\u30b1\u30f3\u30b9\nlet evens: int seq = ???\n\n// 2. \u7121\u9650\u306b\u4ea4\u4e92\u306b true/false \u3092\u8fd4\u3059\u30b7\u30fc\u30b1\u30f3\u30b9\nlet alternating: bool seq = ???\n\n// 3. \u6700\u521d\u306e5\u3064\u306e\u8981\u7d20\u306e\u5408\u8a08\u3092\u8a08\u7b97\nlet sum: int = seq { 1; 2; 3; 4; 5; 6; 7; 8; 9; 10 } |&gt; Seq.take 5 |&gt; ???\n</code></pre> \u89e3\u7b54 <pre><code>// 1. 1\u304b\u308910\u307e\u3067\u306e\u5076\u6570\nlet evens: int seq = seq { 1 .. 10 } |&gt; Seq.filter (fun n -&gt; n % 2 = 0)\n// \u307e\u305f\u306f\nlet evens: int seq = seq { 2; 4; 6; 8; 10 }\n\n// 2. \u7121\u9650\u306b\u4ea4\u4e92\u306b true/false\nlet alternating: bool seq =\n    seq {\n        while true do\n            yield true\n            yield false\n    }\n\n// 3. \u6700\u521d\u306e5\u3064\u306e\u8981\u7d20\u306e\u5408\u8a08\nlet sum: int = seq { 1; 2; 3; 4; 5; 6; 7; 8; 9; 10 }\n              |&gt; Seq.take 5\n              |&gt; Seq.sum  // 15\n</code></pre>"},{"location":"fsharp/part-4/#5","title":"\u554f\u984c 5: \u30c8\u30ec\u30f3\u30c9\u691c\u51fa","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u76f4\u8fd13\u3064\u306e\u5024\u304c\u5168\u3066\u540c\u3058\u304b\u3069\u3046\u304b\u3092\u5224\u5b9a\u3057\u307e\u3059\u3002</p> <pre><code>let isStable (values: int list) : bool = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert (isStable [5; 5; 5] = true)\nassert (isStable [5; 5; 6] = false)\nassert (isStable [5; 6; 5] = false)\nassert (isStable [5] = false)  // 3\u3064\u672a\u6e80\u306f false\n</code></pre> \u89e3\u7b54 <pre><code>let isStable (values: int list) : bool =\n    values.Length &gt;= 3 &amp;&amp;\n    values\n    |&gt; List.pairwise\n    |&gt; List.forall (fun (prev, curr) -&gt; prev = curr)\n\n// \u307e\u305f\u306f\nlet isStable (values: int list) : bool =\n    values.Length &gt;= 3 &amp;&amp; values |&gt; List.distinct |&gt; List.length = 1\n</code></pre>"},{"location":"fsharp/part-5/","title":"Part V: \u4e26\u884c\u51e6\u7406","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u4e26\u884c\u51e6\u7406\u3092\u5b66\u3073\u307e\u3059\u3002Ref \u306b\u3088\u308b\u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u5171\u6709\u72b6\u614b\u7ba1\u7406\u3001Async.Parallel \u306b\u3088\u308b\u4e26\u5217\u5b9f\u884c\u3001\u305d\u3057\u3066 MailboxProcessor\uff08Agent\uff09\u306b\u3088\u308b\u8efd\u91cf\u4e26\u884c\u51e6\u7406\u306e\u69cb\u7bc9\u65b9\u6cd5\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"fsharp/part-5/#10","title":"\u7b2c10\u7ae0: \u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406","text":""},{"location":"fsharp/part-5/#101","title":"10.1 \u4e26\u884c\u51e6\u7406\u306e\u8ab2\u984c","text":"<p>\u5f93\u6765\u306e\u4e26\u884c\u51e6\u7406\u306b\u306f\u591a\u304f\u306e\u8ab2\u984c\u304c\u3042\u308a\u307e\u3059:</p> <ul> <li>\u30c7\u30c3\u30c9\u30ed\u30c3\u30af</li> <li>\u7af6\u5408\u72b6\u614b\uff08Race Condition\uff09</li> <li>\u5171\u6709\u72b6\u614b\u306e\u7ba1\u7406\u306e\u8907\u96d1\u3055</li> <li>\u30b9\u30ec\u30c3\u30c9\u306e\u30aa\u30fc\u30d0\u30fc\u30d8\u30c3\u30c9</li> </ul> <p></p>"},{"location":"fsharp/part-5/#102","title":"10.2 \u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u306e\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u96c6\u8a08","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/fsharp/src/Ch10/ConcurrentProcessing.fs</code></p> <p>\u90fd\u5e02\u3078\u306e\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u3092\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u3067\u96c6\u8a08\u3057\u3001\u30e9\u30f3\u30ad\u30f3\u30b0\u3092\u66f4\u65b0\u3059\u308b\u4f8b\u3092\u898b\u3066\u3044\u304d\u307e\u3059\u3002</p> <pre><code>type City = { Name: string }\ntype CityStats = { City: City; CheckIns: int }\n\n// \u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u306e\u30b7\u30fc\u30b1\u30f3\u30b9\nlet checkIns: City seq =\n    seq {\n        for _ in 1..100000 do\n            yield { Name = \"Sydney\" }\n            yield { Name = \"Dublin\" }\n            yield { Name = \"Cape Town\" }\n            yield { Name = \"Lima\" }\n            yield { Name = \"Singapore\" }\n    }\n</code></pre>"},{"location":"fsharp/part-5/#3","title":"\u30c8\u30c3\u30d73\u90fd\u5e02\u306e\u8a08\u7b97\uff08\u7d14\u7c8b\u95a2\u6570\uff09","text":"<pre><code>let topCities (n: int) (cityCheckIns: Map&lt;City, int&gt;) : CityStats list =\n    cityCheckIns\n    |&gt; Map.toList\n    |&gt; List.map (fun (city, checkIns) -&gt; { City = city; CheckIns = checkIns })\n    |&gt; List.sortByDescending (fun stats -&gt; stats.CheckIns)\n    |&gt; List.truncate n\n</code></pre>"},{"location":"fsharp/part-5/#103-ref-","title":"10.3 Ref - \u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u5171\u6709\u72b6\u614b","text":"<p>Ref \u306f\u3001\u8907\u6570\u306e\u4e26\u884c\u51e6\u7406\u304b\u3089\u5b89\u5168\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u53c2\u7167\u3067\u3059\u3002F# \u3067\u306f <code>lock</code> \u3092\u4f7f\u3063\u3066\u5b9f\u88c5\u3057\u307e\u3059\u3002</p> <pre><code>type Ref&lt;'a&gt; private (initialValue: 'a) =\n    let mutable value = initialValue\n    let lockObj = obj()\n\n    /// \u73fe\u5728\u306e\u5024\u3092\u53d6\u5f97\n    member _.Get() : 'a =\n        lock lockObj (fun () -&gt; value)\n\n    /// \u5024\u3092\u8a2d\u5b9a\n    member _.Set(newValue: 'a) : unit =\n        lock lockObj (fun () -&gt; value &lt;- newValue)\n\n    /// \u30a2\u30c8\u30df\u30c3\u30af\u306b\u66f4\u65b0\n    member _.Update(f: 'a -&gt; 'a) : unit =\n        lock lockObj (fun () -&gt; value &lt;- f value)\n\n    /// \u521d\u671f\u5024\u3067 Ref \u3092\u4f5c\u6210\n    static member Of(initialValue: 'a) : Ref&lt;'a&gt; =\n        Ref(initialValue)\n</code></pre> <p></p>"},{"location":"fsharp/part-5/#ref","title":"Ref \u306e\u4e3b\u8981\u30e1\u30bd\u30c3\u30c9","text":"\u30e1\u30bd\u30c3\u30c9 \u8aac\u660e \u4f8b <code>Ref.Of(initial)</code> \u521d\u671f\u5024\u3067 Ref \u3092\u4f5c\u6210 <code>Ref.Of(0)</code> <code>ref.Get()</code> \u73fe\u5728\u306e\u5024\u3092\u53d6\u5f97 <code>counter.Get()</code> <code>ref.Set(value)</code> \u5024\u3092\u8a2d\u5b9a <code>counter.Set(10)</code> <code>ref.Update(f)</code> \u30a2\u30c8\u30df\u30c3\u30af\u306b\u66f4\u65b0 <code>counter.Update((+) 1)</code> <code>ref.GetAndUpdate(f)</code> \u66f4\u65b0\u3057\u3066\u53e4\u3044\u5024\u3092\u8fd4\u3059 <code>counter.GetAndUpdate((+) 1)</code> <code>ref.UpdateAndGet(f)</code> \u66f4\u65b0\u3057\u3066\u65b0\u3057\u3044\u5024\u3092\u8fd4\u3059 <code>counter.UpdateAndGet((+) 1)</code> <code>ref.Modify(f)</code> \u66f4\u65b0\u3057\u3066\u7d50\u679c\u3092\u8fd4\u3059 <code>counter.Modify(fun n -&gt; (n + 1, n * 2))</code>"},{"location":"fsharp/part-5/#_1","title":"\u4f7f\u7528\u4f8b","text":"<pre><code>let example () =\n    let counter = Ref.Of(0)\n    counter.Update((+) 3)  // \u30a2\u30c8\u30df\u30c3\u30af\u306b\u66f4\u65b0\n    counter.Get()           // 3\n</code></pre>"},{"location":"fsharp/part-5/#104-parsequence-","title":"10.4 parSequence - \u4e26\u5217\u5b9f\u884c","text":"<p>F# \u3067\u306f <code>Async.Parallel</code> \u3092\u4f7f\u3063\u3066\u8907\u6570\u306e Async \u3092\u4e26\u5217\u5b9f\u884c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>/// Async \u306e\u30ea\u30b9\u30c8\u3092\u4e26\u5217\u5b9f\u884c\nlet parSequence (asyncList: Async&lt;'a&gt; list) : Async&lt;'a list&gt; =\n    async {\n        let! results = Async.Parallel asyncList\n        return results |&gt; Array.toList\n    }\n\n// \u4f7f\u7528\u4f8b\nlet parallel =\n    [ async { return 1 }\n      async { return 2 }\n      async { return 3 } ]\n    |&gt; parSequence\n\nparallel |&gt; Async.RunSynchronously  // [1; 2; 3]\n</code></pre> <p></p>"},{"location":"fsharp/part-5/#async","title":"\u8907\u6570\u306e Async \u3092\u4e26\u5217\u5b9f\u884c","text":"<pre><code>/// 2\u3064\u306e Async \u3092\u4e26\u5217\u5b9f\u884c\nlet parTuple2 (async1: Async&lt;'a&gt;) (async2: Async&lt;'b&gt;) : Async&lt;'a * 'b&gt; =\n    async {\n        let! results = Async.Parallel [\n            async { let! a = async1 in return box a }\n            async { let! b = async2 in return box b }\n        ]\n        return (unbox results.[0], unbox results.[1])\n    }\n\n/// 3\u3064\u306e Async \u3092\u4e26\u5217\u5b9f\u884c\nlet parTuple3 (async1: Async&lt;'a&gt;) (async2: Async&lt;'b&gt;) (async3: Async&lt;'c&gt;) : Async&lt;'a * 'b * 'c&gt; =\n    async {\n        let! results = Async.Parallel [\n            async { let! a = async1 in return box a }\n            async { let! b = async2 in return box b }\n            async { let! c = async3 in return box c }\n        ]\n        return (unbox results.[0], unbox results.[1], unbox results.[2])\n    }\n</code></pre>"},{"location":"fsharp/part-5/#105","title":"10.5 \u30b5\u30a4\u30b3\u30ed\u3092\u4e26\u884c\u3057\u3066\u632f\u308b","text":"<pre><code>let private random = Random()\n\nlet castTheDie () : Async&lt;int&gt; =\n    async { return random.Next(1, 7) }\n\n/// N \u500b\u306e\u30b5\u30a4\u30b3\u30ed\u3092\u4e26\u884c\u3057\u3066\u632f\u308b\nlet castDiceConcurrently (n: int) : Async&lt;int list&gt; =\n    [ for _ in 1..n -&gt; castTheDie () ]\n    |&gt; parSequence\n\n/// N \u500b\u306e\u30b5\u30a4\u30b3\u30ed\u3092\u4e26\u884c\u3057\u3066\u632f\u308a\u3001\u5408\u8a08\u3092\u8fd4\u3059\nlet castDiceAndSum (n: int) : Async&lt;int&gt; =\n    async {\n        let! results = castDiceConcurrently n\n        return List.sum results\n    }\n</code></pre>"},{"location":"fsharp/part-5/#106-fiber-","title":"10.6 Fiber - \u30ad\u30e3\u30f3\u30bb\u30eb\u53ef\u80fd\u306a\u975e\u540c\u671f\u30bf\u30b9\u30af","text":"<p>Fiber \u306f\u3001\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u5b9f\u884c\u3055\u308c\u308b\u30ad\u30e3\u30f3\u30bb\u30eb\u53ef\u80fd\u306a\u975e\u540c\u671f\u30bf\u30b9\u30af\u3067\u3059\u3002</p> <pre><code>type Fiber&lt;'a&gt; = {\n    /// \u30bf\u30b9\u30af\u306e\u7d50\u679c\u3092\u5f85\u6a5f\n    Join: Async&lt;'a&gt;\n    /// \u30bf\u30b9\u30af\u3092\u30ad\u30e3\u30f3\u30bb\u30eb\n    Cancel: unit -&gt; unit\n}\n\n/// Async \u3092 Fiber \u3068\u3057\u3066\u8d77\u52d5\uff08\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u5b9f\u884c\uff09\nlet start (computation: Async&lt;'a&gt;) : Fiber&lt;'a&gt; =\n    let cts = new CancellationTokenSource()\n    let tcs = new TaskCompletionSource&lt;'a&gt;()\n\n    Async.Start(\n        async {\n            try\n                let! result = computation\n                tcs.SetResult(result)\n            with\n            | :? OperationCanceledException -&gt;\n                tcs.SetCanceled()\n            | ex -&gt;\n                tcs.SetException(ex)\n        },\n        cts.Token)\n\n    {\n        Join = Async.AwaitTask tcs.Task\n        Cancel = fun () -&gt; cts.Cancel()\n    }\n</code></pre> <p></p>"},{"location":"fsharp/part-5/#foreverm-","title":"foreverM - \u6c38\u9060\u306b\u7e70\u308a\u8fd4\u3059","text":"<pre><code>/// \u6c38\u9060\u306b\u7e70\u308a\u8fd4\u3059\nlet foreverM (action: Async&lt;unit&gt;) : Async&lt;unit&gt; =\n    let rec loop () =\n        async {\n            do! action\n            return! loop ()\n        }\n    loop ()\n</code></pre>"},{"location":"fsharp/part-5/#107","title":"10.7 \u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u51e6\u7406\u306e\u4e26\u884c\u7248","text":"<p>\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u306e\u4fdd\u5b58\u3068\u30e9\u30f3\u30ad\u30f3\u30b0\u306e\u66f4\u65b0\u3092\u4e26\u884c\u3057\u3066\u5b9f\u884c\u3057\u307e\u3059\u3002</p>"},{"location":"fsharp/part-5/#_2","title":"\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u306e\u4fdd\u5b58","text":"<pre><code>let storeCheckIn (storedCheckIns: Ref&lt;Map&lt;City, int&gt;&gt;) (city: City) : unit =\n    storedCheckIns.Update(fun map -&gt;\n        match Map.tryFind city map with\n        | Some count -&gt; Map.add city (count + 1) map\n        | None -&gt; Map.add city 1 map)\n</code></pre>"},{"location":"fsharp/part-5/#_3","title":"\u30e9\u30f3\u30ad\u30f3\u30b0\u306e\u7d99\u7d9a\u7684\u306a\u66f4\u65b0","text":"<pre><code>let updateRanking\n    (storedCheckIns: Ref&lt;Map&lt;City, int&gt;&gt;)\n    (storedRanking: Ref&lt;CityStats list&gt;)\n    : Async&lt;unit&gt; =\n    async {\n        let checkIns = storedCheckIns.Get()\n        let ranking = topCities 3 checkIns\n        storedRanking.Set(ranking)\n    }\n\n/// \u30e9\u30f3\u30ad\u30f3\u30b0\u3092\u7d99\u7d9a\u7684\u306b\u66f4\u65b0\nlet updateRankingForever\n    (storedCheckIns: Ref&lt;Map&lt;City, int&gt;&gt;)\n    (storedRanking: Ref&lt;CityStats list&gt;)\n    : Async&lt;unit&gt; =\n    foreverM (updateRanking storedCheckIns storedRanking)\n</code></pre>"},{"location":"fsharp/part-5/#108","title":"10.8 \u547c\u3073\u51fa\u3057\u5143\u306b\u5236\u5fa1\u3092\u8fd4\u3059","text":"<p>\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u51e6\u7406\u3092\u7d9a\u3051\u3064\u3064\u3001\u547c\u3073\u51fa\u3057\u5143\u306b\u5236\u5fa1\u3092\u8fd4\u3059\u8a2d\u8a08\u304c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>type ProcessingCheckIns = {\n    /// \u73fe\u5728\u306e\u30e9\u30f3\u30ad\u30f3\u30b0\u3092\u53d6\u5f97\n    CurrentRanking: unit -&gt; CityStats list\n    /// \u51e6\u7406\u3092\u505c\u6b62\n    Stop: unit -&gt; unit\n}\n\nlet startCheckInProcessing (checkIns: City seq) : ProcessingCheckIns =\n    let storedCheckIns = Ref.Of(Map.empty&lt;City, int&gt;)\n    let storedRanking = Ref.Of([] : CityStats list)\n    let cts = new CancellationTokenSource()\n\n    // \u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u51e6\u7406\u3092\u958b\u59cb\n    Async.Start(\n        async {\n            for city in checkIns do\n                storeCheckIn storedCheckIns city\n        },\n        cts.Token)\n\n    // \u30e9\u30f3\u30ad\u30f3\u30b0\u66f4\u65b0\u3092\u958b\u59cb\n    Async.Start(\n        async {\n            while not cts.Token.IsCancellationRequested do\n                do! updateRanking storedCheckIns storedRanking\n                do! Async.Sleep 10\n        },\n        cts.Token)\n\n    {\n        CurrentRanking = fun () -&gt; storedRanking.Get()\n        Stop = fun () -&gt; cts.Cancel()\n    }\n</code></pre>"},{"location":"fsharp/part-5/#_4","title":"\u4f7f\u7528\u4f8b","text":"<pre><code>let example () =\n    let cities = [\n        { Name = \"Tokyo\" }\n        { Name = \"Sydney\" }\n        { Name = \"Tokyo\" }\n        { Name = \"London\" }\n        { Name = \"Tokyo\" }\n    ]\n\n    let processing = startCheckInProcessing cities\n\n    // \u5c11\u3057\u5f85\u3063\u3066\u304b\u3089\u30e9\u30f3\u30ad\u30f3\u30b0\u3092\u53d6\u5f97\n    System.Threading.Thread.Sleep(100)\n    let ranking = processing.CurrentRanking()\n    printfn \"%A\" ranking\n\n    // \u51e6\u7406\u3092\u505c\u6b62\n    processing.Stop()\n</code></pre>"},{"location":"fsharp/part-5/#109-mailboxprocessoragent","title":"10.9 MailboxProcessor\uff08Agent\uff09\u306b\u3088\u308b\u4e26\u884c\u51e6\u7406","text":"<p>F# \u3067\u306f\u3001MailboxProcessor\uff08\u5225\u540d Agent\uff09\u3092\u4f7f\u3063\u305f\u30e1\u30c3\u30bb\u30fc\u30b8\u30d1\u30c3\u30b7\u30f3\u30b0\u65b9\u5f0f\u306e\u4e26\u884c\u51e6\u7406\u304c\u4e00\u822c\u7684\u3067\u3059\u3002</p> <p></p>"},{"location":"fsharp/part-5/#_5","title":"\u30ab\u30a6\u30f3\u30bf\u30fc\u30a8\u30fc\u30b8\u30a7\u30f3\u30c8","text":"<pre><code>type CounterMessage =\n    | Increment\n    | Decrement\n    | GetValue of AsyncReplyChannel&lt;int&gt;\n    | Reset\n\nlet createCounter (initialValue: int) : MailboxProcessor&lt;CounterMessage&gt; =\n    MailboxProcessor.Start(fun inbox -&gt;\n        let rec loop count =\n            async {\n                let! msg = inbox.Receive()\n                match msg with\n                | Increment -&gt;\n                    return! loop (count + 1)\n                | Decrement -&gt;\n                    return! loop (count - 1)\n                | GetValue replyChannel -&gt;\n                    replyChannel.Reply(count)\n                    return! loop count\n                | Reset -&gt;\n                    return! loop initialValue\n            }\n        loop initialValue)\n</code></pre>"},{"location":"fsharp/part-5/#_6","title":"\u30ab\u30a6\u30f3\u30bf\u30fc\u306e\u4f7f\u7528","text":"<pre><code>let counter = createCounter 0\n\n// \u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\uff08Fire-and-forget\uff09\ncounter.Post(Increment)\ncounter.Post(Increment)\n\n// \u5024\u3092\u53d6\u5f97\uff08\u540c\u671f\uff09\nlet value = counter.PostAndReply(GetValue)  // 2\n\n// \u30c7\u30af\u30ea\u30e1\u30f3\u30c8\ncounter.Post(Decrement)\nlet newValue = counter.PostAndReply(GetValue)  // 1\n</code></pre>"},{"location":"fsharp/part-5/#_7","title":"\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u30a8\u30fc\u30b8\u30a7\u30f3\u30c8","text":"<pre><code>type CheckInMessage =\n    | AddCheckIn of City\n    | GetStats of AsyncReplyChannel&lt;CityStats list&gt;\n    | GetTotal of AsyncReplyChannel&lt;int&gt;\n\nlet createCheckInAgent () : MailboxProcessor&lt;CheckInMessage&gt; =\n    MailboxProcessor.Start(fun inbox -&gt;\n        let rec loop (checkIns: Map&lt;City, int&gt;) =\n            async {\n                let! msg = inbox.Receive()\n                match msg with\n                | AddCheckIn city -&gt;\n                    let newCheckIns =\n                        match Map.tryFind city checkIns with\n                        | Some count -&gt; Map.add city (count + 1) checkIns\n                        | None -&gt; Map.add city 1 checkIns\n                    return! loop newCheckIns\n                | GetStats replyChannel -&gt;\n                    let stats = topCities 3 checkIns\n                    replyChannel.Reply(stats)\n                    return! loop checkIns\n                | GetTotal replyChannel -&gt;\n                    let total = checkIns |&gt; Map.toList |&gt; List.sumBy snd\n                    replyChannel.Reply(total)\n                    return! loop checkIns\n            }\n        loop Map.empty)\n</code></pre>"},{"location":"fsharp/part-5/#1010","title":"10.10 \u4e26\u5217\u51e6\u7406\u30e6\u30fc\u30c6\u30a3\u30ea\u30c6\u30a3","text":"<pre><code>/// \u30ea\u30b9\u30c8\u306e\u5404\u8981\u7d20\u306b\u95a2\u6570\u3092\u4e26\u5217\u9069\u7528\nlet parMap (f: 'a -&gt; 'b) (list: 'a list) : 'b list =\n    list\n    |&gt; List.map (fun x -&gt; async { return f x })\n    |&gt; parSequence\n    |&gt; Async.RunSynchronously\n\n/// \u6761\u4ef6\u3092\u6e80\u305f\u3059\u8981\u7d20\u3092\u4e26\u5217\u3067\u30d5\u30a3\u30eb\u30bf\nlet parFilter (predicate: 'a -&gt; bool) (list: 'a list) : 'a list =\n    list\n    |&gt; List.map (fun x -&gt; async { return (x, predicate x) })\n    |&gt; parSequence\n    |&gt; Async.RunSynchronously\n    |&gt; List.filter snd\n    |&gt; List.map fst\n\n/// \u4e26\u5217\u3067\u96c6\u7d04\nlet parReduce (combine: 'a -&gt; 'a -&gt; 'a) (list: 'a list) : 'a option =\n    match list with\n    | [] -&gt; None\n    | [x] -&gt; Some x\n    | _ -&gt;\n        let rec reduceLevel (items: 'a list) =\n            match items with\n            | [] -&gt; failwith \"Unexpected empty list\"\n            | [x] -&gt; x\n            | _ -&gt;\n                items\n                |&gt; List.chunkBySize 2\n                |&gt; List.map (fun chunk -&gt;\n                    match chunk with\n                    | [a; b] -&gt; async { return combine a b }\n                    | [a] -&gt; async { return a }\n                    | _ -&gt; failwith \"Unexpected chunk size\")\n                |&gt; parSequence\n                |&gt; Async.RunSynchronously\n                |&gt; reduceLevel\n        Some (reduceLevel list)\n</code></pre>"},{"location":"fsharp/part-5/#1011","title":"10.11 \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u4ed8\u304d\u5b9f\u884c","text":"<pre><code>/// \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u4ed8\u304d\u3067 Async \u3092\u5b9f\u884c\nlet withTimeout (timeoutMs: int) (computation: Async&lt;'a&gt;) : Async&lt;'a option&gt; =\n    async {\n        let! child = Async.StartChild(computation, timeoutMs)\n        try\n            let! result = child\n            return Some result\n        with :? TimeoutException -&gt;\n            return None\n    }\n</code></pre>"},{"location":"fsharp/part-5/#1012","title":"10.12 \u5076\u6570\u30ab\u30a6\u30f3\u30c8\uff08\u4e26\u884c\u7248\uff09","text":"<pre><code>/// \u4e26\u884c\u3057\u3066\u5b9f\u884c\u3057\u3001\u5076\u6570\u306e\u6570\u3092\u30ab\u30a6\u30f3\u30c8\nlet countEvens (asyncInts: Async&lt;int&gt; list) : Async&lt;int&gt; =\n    async {\n        let counter = Ref.Of(0)\n        let tasks =\n            asyncInts\n            |&gt; List.map (fun asyncInt -&gt;\n                async {\n                    let! n = asyncInt\n                    if n % 2 = 0 then\n                        counter.Update((+) 1)\n                })\n        do! parSequence tasks |&gt; Async.Ignore\n        return counter.Get()\n    }\n</code></pre>"},{"location":"fsharp/part-5/#scala","title":"Scala \u3068\u306e\u6bd4\u8f03","text":""},{"location":"fsharp/part-5/#ref_1","title":"Ref \u306e\u6bd4\u8f03","text":"Scala (Cats Effect) F# \u8aac\u660e <code>Ref.of[IO, A](initial)</code> <code>Ref.Of(initial)</code> \u521d\u671f\u5024\u3067 Ref \u3092\u4f5c\u6210 <code>ref.get</code> <code>ref.Get()</code> \u73fe\u5728\u306e\u5024\u3092\u53d6\u5f97 <code>ref.set(value)</code> <code>ref.Set(value)</code> \u5024\u3092\u8a2d\u5b9a <code>ref.update(f)</code> <code>ref.Update(f)</code> \u30a2\u30c8\u30df\u30c3\u30af\u306b\u66f4\u65b0 <code>ref.modify(f)</code> <code>ref.Modify(f)</code> \u66f4\u65b0\u3057\u3066\u7d50\u679c\u3092\u8fd4\u3059"},{"location":"fsharp/part-5/#_8","title":"\u4e26\u5217\u5b9f\u884c\u306e\u6bd4\u8f03","text":"Scala (Cats Effect) F# \u8aac\u660e <code>ios.parSequence</code> <code>parSequence ios</code> \u4e26\u5217\u5b9f\u884c <code>ios.sequence</code> <code>sequence ios</code> \u9806\u6b21\u5b9f\u884c <code>(io1, io2).parTupled</code> <code>parTuple2 io1 io2</code> 2\u3064\u3092\u4e26\u5217\u5b9f\u884c"},{"location":"fsharp/part-5/#fiber","title":"Fiber \u306e\u6bd4\u8f03","text":"Scala (Cats Effect) F# \u8aac\u660e <code>io.start</code> <code>start computation</code> Fiber \u3092\u8d77\u52d5 <code>fiber.join</code> <code>fiber.Join</code> \u7d50\u679c\u3092\u5f85\u6a5f <code>fiber.cancel</code> <code>fiber.Cancel()</code> \u30ad\u30e3\u30f3\u30bb\u30eb <code>io.foreverM</code> <code>foreverM io</code> \u6c38\u9060\u306b\u7e70\u308a\u8fd4\u3059"},{"location":"fsharp/part-5/#agentactor","title":"Agent\uff08Actor\uff09\u306e\u6bd4\u8f03","text":"Scala (Akka) F# \u8aac\u660e <code>Actor</code> <code>MailboxProcessor</code> \u30e1\u30c3\u30bb\u30fc\u30b8\u30d9\u30fc\u30b9\u306e\u4e26\u884c\u51e6\u7406 <code>actorRef ! message</code> <code>agent.Post(message)</code> \u30e1\u30c3\u30bb\u30fc\u30b8\u9001\u4fe1\uff08\u975e\u540c\u671f\uff09 <code>actorRef ? message</code> <code>agent.PostAndReply(f)</code> \u30e1\u30c3\u30bb\u30fc\u30b8\u9001\u4fe1\uff08\u540c\u671f\uff09"},{"location":"fsharp/part-5/#_9","title":"\u307e\u3068\u3081","text":""},{"location":"fsharp/part-5/#part-v_1","title":"Part V \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"fsharp/part-5/#_10","title":"\u4e3b\u8981\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8","text":"\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8 \u7528\u9014 <code>Ref&lt;'a&gt;</code> \u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u5171\u6709\u72b6\u614b <code>parSequence</code> Async \u306e\u30ea\u30b9\u30c8\u3092\u4e26\u5217\u5b9f\u884c <code>Fiber</code> \u30ad\u30e3\u30f3\u30bb\u30eb\u53ef\u80fd\u306a\u975e\u540c\u671f\u30bf\u30b9\u30af <code>start</code> Fiber \u3092\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u8d77\u52d5 <code>foreverM</code> \u6c38\u9060\u306b\u7e70\u308a\u8fd4\u3057\u5b9f\u884c <code>MailboxProcessor</code> \u30e1\u30c3\u30bb\u30fc\u30b8\u30d9\u30fc\u30b9\u306e\u4e26\u884c\u51e6\u7406"},{"location":"fsharp/part-5/#_11","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>Ref: \u8907\u6570\u306e\u4e26\u884c\u51e6\u7406\u304b\u3089\u5b89\u5168\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u53c2\u7167</li> <li>parSequence: Async \u306e\u30ea\u30b9\u30c8\u3092\u4e26\u5217\u5b9f\u884c\u3057\u3066\u7d50\u679c\u3092\u96c6\u7d04</li> <li>Fiber: \u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u5b9f\u884c\u3055\u308c\u308b\u30ad\u30e3\u30f3\u30bb\u30eb\u53ef\u80fd\u306a\u30bf\u30b9\u30af</li> <li>MailboxProcessor: F# \u30cd\u30a4\u30c6\u30a3\u30d6\u306e Actor \u30e2\u30c7\u30eb\u5b9f\u88c5</li> <li>Async.Parallel: \u7d44\u307f\u8fbc\u307f\u306e\u4e26\u5217\u5b9f\u884c\u6a5f\u80fd</li> </ol>"},{"location":"fsharp/part-5/#_12","title":"\u8a2d\u8a08\u30d1\u30bf\u30fc\u30f3","text":""},{"location":"fsharp/part-5/#_13","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"fsharp/part-5/#1-ref","title":"\u554f\u984c 1: Ref \u306e\u57fa\u672c","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u30ab\u30a6\u30f3\u30bf\u30fc\u3092 0 \u304b\u3089\u59cb\u3081\u3066\u30013\u56de\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\u3057\u305f\u7d50\u679c\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>let incrementThreeTimes () : int = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nincrementThreeTimes ()  // 3\n</code></pre> \u89e3\u7b54 <pre><code>let incrementThreeTimes () : int =\n    let counter = Ref.Of(0)\n    counter.Update((+) 1)\n    counter.Update((+) 1)\n    counter.Update((+) 1)\n    counter.Get()\n</code></pre>"},{"location":"fsharp/part-5/#2","title":"\u554f\u984c 2: \u4e26\u5217\u5b9f\u884c","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u30023\u3064\u306e Async \u3092\u4e26\u5217\u5b9f\u884c\u3057\u3001\u7d50\u679c\u306e\u5408\u8a08\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>let sumParallel (async1: Async&lt;int&gt;) (async2: Async&lt;int&gt;) (async3: Async&lt;int&gt;) : Async&lt;int&gt; = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nsumParallel (async { return 1 }) (async { return 2 }) (async { return 3 })\n|&gt; Async.RunSynchronously  // 6\n</code></pre> \u89e3\u7b54 <pre><code>let sumParallel (async1: Async&lt;int&gt;) (async2: Async&lt;int&gt;) (async3: Async&lt;int&gt;) : Async&lt;int&gt; =\n    async {\n        let! results = [ async1; async2; async3 ] |&gt; parSequence\n        return List.sum results\n    }\n</code></pre>"},{"location":"fsharp/part-5/#3_1","title":"\u554f\u984c 3: \u4e26\u884c\u30ab\u30a6\u30f3\u30c8","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002Async \u306e\u30ea\u30b9\u30c8\u3092\u4e26\u884c\u5b9f\u884c\u3057\u3001\u305d\u306e\u3046\u3061\u5076\u6570\u3092\u8fd4\u3057\u305f\u56de\u6570\u3092\u30ab\u30a6\u30f3\u30c8\u3057\u307e\u3059\u3002</p> <pre><code>let countEvensInList (asyncInts: Async&lt;int&gt; list) : Async&lt;int&gt; = ???\n\n// \u4f7f\u7528\u4f8b\nlet asyncInts = [\n    async { return 2 }\n    async { return 3 }\n    async { return 4 }\n    async { return 5 }\n    async { return 6 }\n]\ncountEvensInList asyncInts |&gt; Async.RunSynchronously  // 3\n</code></pre> \u89e3\u7b54 <pre><code>let countEvensInList (asyncInts: Async&lt;int&gt; list) : Async&lt;int&gt; =\n    async {\n        let counter = Ref.Of(0)\n        let tasks =\n            asyncInts\n            |&gt; List.map (fun asyncInt -&gt;\n                async {\n                    let! n = asyncInt\n                    if n % 2 = 0 then\n                        counter.Update((+) 1)\n                })\n        do! parSequence tasks |&gt; Async.Ignore\n        return counter.Get()\n    }\n</code></pre>"},{"location":"fsharp/part-5/#4-mailboxprocessor","title":"\u554f\u984c 4: MailboxProcessor","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u53d7\u3051\u53d6\u3063\u3066\u30ea\u30b9\u30c8\u306b\u8ffd\u52a0\u3057\u3001\u30ea\u30b9\u30c8\u3092\u53d6\u5f97\u3067\u304d\u308b Agent \u3092\u4f5c\u6210\u3057\u307e\u3059\u3002</p> <pre><code>type ListMessage&lt;'a&gt; =\n    | Add of 'a\n    | GetAll of AsyncReplyChannel&lt;'a list&gt;\n\nlet createListAgent&lt;'a&gt; () : MailboxProcessor&lt;ListMessage&lt;'a&gt;&gt; = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nlet agent = createListAgent&lt;int&gt; ()\nagent.Post(Add 1)\nagent.Post(Add 2)\nagent.Post(Add 3)\nagent.PostAndReply(GetAll)  // [1; 2; 3] \u307e\u305f\u306f [3; 2; 1]\n</code></pre> \u89e3\u7b54 <pre><code>type ListMessage&lt;'a&gt; =\n    | Add of 'a\n    | GetAll of AsyncReplyChannel&lt;'a list&gt;\n\nlet createListAgent&lt;'a&gt; () : MailboxProcessor&lt;ListMessage&lt;'a&gt;&gt; =\n    MailboxProcessor.Start(fun inbox -&gt;\n        let rec loop (items: 'a list) =\n            async {\n                let! msg = inbox.Receive()\n                match msg with\n                | Add item -&gt;\n                    return! loop (item :: items)\n                | GetAll replyChannel -&gt;\n                    replyChannel.Reply(List.rev items)\n                    return! loop items\n            }\n        loop [])\n</code></pre>"},{"location":"fsharp/part-5/#5","title":"\u554f\u984c 5: \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u4ed8\u304d\u53ce\u96c6","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u6307\u5b9a\u6642\u9593\u5f8c\u306b\u51e6\u7406\u3092\u505c\u6b62\u3057\u3001\u305d\u308c\u307e\u3067\u306b\u84c4\u7a4d\u3055\u308c\u305f\u7d50\u679c\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>let collectFor (durationMs: int) (producer: unit -&gt; int) : int list = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\n// 100ms\u3054\u3068\u306b\u4e71\u6570\u3092\u751f\u6210\u3057\u3066\u30011\u79d2\u9593\u53ce\u96c6\n// \u7d0410\u500b\u306e\u8981\u7d20\u304c\u8fd4\u3055\u308c\u308b\ncollectFor 1000 (fun () -&gt; random.Next(100))\n</code></pre> \u89e3\u7b54 <pre><code>let collectFor (durationMs: int) (producer: unit -&gt; int) : int list =\n    let collected = Ref.Of([] : int list)\n    let cts = new CancellationTokenSource()\n\n    // 100ms\u3054\u3068\u306b\u5024\u3092\u8ffd\u52a0\u3059\u308b\u30d7\u30ed\u30b0\u30e9\u30e0\n    Async.Start(\n        async {\n            while true do\n                do! Async.Sleep 100\n                let value = producer ()\n                collected.Update(fun list -&gt; value :: list)\n        },\n        cts.Token)\n\n    // \u6307\u5b9a\u6642\u9593\u5f85\u6a5f\n    Thread.Sleep(durationMs)\n\n    // \u30ad\u30e3\u30f3\u30bb\u30eb\n    cts.Cancel()\n\n    // \u7d50\u679c\u3092\u53d6\u5f97\uff08\u9006\u9806\u306b\u3057\u3066\u8fd4\u3059\uff09\n    collected.Get() |&gt; List.rev\n</code></pre>"},{"location":"fsharp/part-6/","title":"Part VI: \u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u3068\u30c6\u30b9\u30c8","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u3053\u308c\u307e\u3067\u5b66\u3093\u3060\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u6982\u5ff5\u3092\u7d71\u5408\u3057\u3001\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002\u307e\u305f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u30c6\u30b9\u30c8\u6226\u7565\u306b\u3064\u3044\u3066\u3082\u5b66\u3073\u307e\u3059\u3002</p>"},{"location":"fsharp/part-6/#11","title":"\u7b2c11\u7ae0: \u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9","text":""},{"location":"fsharp/part-6/#111-travelguide","title":"11.1 TravelGuide \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3","text":"<p>\u65c5\u884c\u30ac\u30a4\u30c9\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f8b\u306b\u3001\u5b9f\u8df5\u7684\u306a FP \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u69cb\u7bc9\u65b9\u6cd5\u3092\u5b66\u3073\u307e\u3059\u3002</p> <p></p>"},{"location":"fsharp/part-6/#112","title":"11.2 \u30c9\u30e1\u30a4\u30f3\u30e2\u30c7\u30eb\u306e\u5b9a\u7fa9","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/fsharp/src/Ch11/TravelGuide.fs</code></p> <pre><code>/// \u30ed\u30b1\u30fc\u30b7\u30e7\u30f3 ID\uff08\u5024\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\uff09\ntype LocationId = LocationId of string\n\nmodule LocationId =\n    let value (LocationId id) = id\n    let create id = LocationId id\n\n/// \u30ed\u30b1\u30fc\u30b7\u30e7\u30f3\ntype Location = {\n    Id: LocationId\n    Name: string\n    Population: int\n}\n\n/// \u30a2\u30c8\u30e9\u30af\u30b7\u30e7\u30f3\uff08\u89b3\u5149\u5730\uff09\ntype Attraction = {\n    Name: string\n    Description: string option\n    Location: Location\n}\n\n/// \u30df\u30e5\u30fc\u30b8\u30c3\u30af\u30a2\u30fc\u30c6\u30a3\u30b9\u30c8\ntype MusicArtist = {\n    Name: string\n    Genre: string option\n}\n\n/// \u6620\u753b\ntype Movie = {\n    Name: string\n    BoxOffice: int option\n}\n\n/// \u65c5\u884c\u30ac\u30a4\u30c9\ntype TravelGuide = {\n    Attraction: Attraction\n    Subjects: string list\n}\n</code></pre>"},{"location":"fsharp/part-6/#113","title":"11.3 \u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\u5c64\u306e\u62bd\u8c61\u5316","text":"<p>\u5916\u90e8\u30c7\u30fc\u30bf\u30bd\u30fc\u30b9\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3067\u62bd\u8c61\u5316\u3057\u307e\u3059\u3002</p> <pre><code>/// \u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\ntype IDataAccess =\n    abstract member FindAttractions:\n        name: string * ordering: AttractionOrdering * limit: int\n        -&gt; Async&lt;Attraction list&gt;\n    abstract member FindArtistsFromLocation:\n        locationId: LocationId * limit: int\n        -&gt; Async&lt;MusicArtist list&gt;\n    abstract member FindMoviesAboutLocation:\n        locationId: LocationId * limit: int\n        -&gt; Async&lt;Movie list&gt;\n</code></pre> <p></p>"},{"location":"fsharp/part-6/#114-resource","title":"11.4 Resource \u306b\u3088\u308b\u30ea\u30bd\u30fc\u30b9\u7ba1\u7406","text":"<p>F# \u3067\u306f <code>IDisposable</code> \u30d1\u30bf\u30fc\u30f3\u3068 <code>use</code> \u30ad\u30fc\u30ef\u30fc\u30c9\u3067\u30ea\u30bd\u30fc\u30b9\u3092\u7ba1\u7406\u3067\u304d\u307e\u3059\u304c\u3001\u3088\u308a\u95a2\u6570\u578b\u7684\u306a <code>Resource</code> \u578b\u3092\u5b9f\u88c5\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002</p> <pre><code>/// \u30ea\u30bd\u30fc\u30b9\u3092\u5b89\u5168\u306b\u7ba1\u7406\u3059\u308b\u305f\u3081\u306e\u578b\ntype Resource&lt;'a&gt; = {\n    Acquire: unit -&gt; Async&lt;'a&gt;\n    Release: 'a -&gt; Async&lt;unit&gt;\n}\n\nmodule Resource =\n    /// \u30ea\u30bd\u30fc\u30b9\u3092\u4f5c\u6210\n    let make (acquire: unit -&gt; Async&lt;'a&gt;) (release: 'a -&gt; Async&lt;unit&gt;) : Resource&lt;'a&gt; =\n        { Acquire = acquire; Release = release }\n\n    /// \u30ea\u30bd\u30fc\u30b9\u3092\u4f7f\u7528\u3057\u3066\u64cd\u4f5c\u3092\u5b9f\u884c\n    let useAsync (f: 'a -&gt; Async&lt;'b&gt;) (resource: Resource&lt;'a&gt;) : Async&lt;'b&gt; =\n        async {\n            let! r = resource.Acquire()\n            try\n                return! f r\n            finally\n                resource.Release r |&gt; Async.RunSynchronously\n        }\n</code></pre> <p></p>"},{"location":"fsharp/part-6/#115","title":"11.5 \u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u5b9f\u88c5","text":"<p><code>Ref</code> \u3092\u4f7f\u7528\u3057\u305f\u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u5b9f\u88c5:</p> <pre><code>/// \u30ad\u30e3\u30c3\u30b7\u30e5\u4ed8\u304d\u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\nlet cachedDataAccess (dataAccess: IDataAccess) : Async&lt;IDataAccess&gt; =\n    async {\n        let attractionCache = Ref.Of(Map.empty&lt;string, Attraction list&gt;)\n        let artistCache = Ref.Of(Map.empty&lt;string, MusicArtist list&gt;)\n        let movieCache = Ref.Of(Map.empty&lt;string, Movie list&gt;)\n\n        return\n            { new IDataAccess with\n                member _.FindAttractions(name, ordering, limit) =\n                    async {\n                        let key = sprintf \"%s-%A-%d\" name ordering limit\n                        let cached = attractionCache.Get() |&gt; Map.tryFind key\n                        match cached with\n                        | Some attractions -&gt; return attractions\n                        | None -&gt;\n                            let! attractions = dataAccess.FindAttractions(name, ordering, limit)\n                            attractionCache.Update(Map.add key attractions)\n                            return attractions\n                    }\n                // \u4ed6\u306e\u30e1\u30bd\u30c3\u30c9\u3082\u540c\u69d8\u306b\u5b9f\u88c5...\n            }\n    }\n</code></pre> <p></p>"},{"location":"fsharp/part-6/#116","title":"11.6 \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u7d44\u307f\u7acb\u3066","text":"<p>\u3059\u3079\u3066\u306e\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002</p> <pre><code>/// \u65c5\u884c\u30ac\u30a4\u30c9\u3092\u751f\u6210\nlet travelGuide (data: IDataAccess) (attractionName: string) : Async&lt;TravelGuide option&gt; =\n    async {\n        let! attractions = data.FindAttractions(attractionName, ByLocationPopulation, 1)\n        match attractions with\n        | [] -&gt; return None\n        | attraction :: _ -&gt;\n            let! artists = data.FindArtistsFromLocation(attraction.Location.Id, 2)\n            let! movies = data.FindMoviesAboutLocation(attraction.Location.Id, 2)\n            let subjects =\n                (artists |&gt; List.map (fun a -&gt; a.Name))\n                @ (movies |&gt; List.map (fun m -&gt; m.Name))\n            return Some {\n                Attraction = attraction\n                Subjects = subjects\n            }\n    }\n</code></pre> <p></p>"},{"location":"fsharp/part-6/#12","title":"\u7b2c12\u7ae0: \u30c6\u30b9\u30c8\u6226\u7565","text":""},{"location":"fsharp/part-6/#121","title":"12.1 \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u30c6\u30b9\u30c8","text":"<p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u3067\u306f\u3001\u7d14\u7c8b\u95a2\u6570\u306e\u304a\u304b\u3052\u3067\u30c6\u30b9\u30c8\u304c\u975e\u5e38\u306b\u7c21\u5358\u306b\u306a\u308a\u307e\u3059\u3002</p> <p></p>"},{"location":"fsharp/part-6/#122-searchreport","title":"12.2 SearchReport \u306e\u5c0e\u5165","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/fsharp/src/Ch12/TravelGuideWithReport.fs</code></p> <p>\u30c6\u30b9\u30c8\u53ef\u80fd\u6027\u3092\u9ad8\u3081\u308b\u305f\u3081\u3001<code>SearchReport</code> \u3092\u5c0e\u5165\u3057\u307e\u3059\u3002</p> <pre><code>/// \u691c\u7d22\u306e\u7d71\u8a08\u60c5\u5831\u3068\u30a8\u30e9\u30fc\u60c5\u5831\ntype SearchReport = {\n    AttractionsSearched: int\n    ArtistsFound: int\n    MoviesFound: int\n    Errors: string list\n}\n\nmodule SearchReport =\n    let empty = {\n        AttractionsSearched = 0\n        ArtistsFound = 0\n        MoviesFound = 0\n        Errors = []\n    }\n\n    let addError error report =\n        { report with Errors = error :: report.Errors }\n\n/// SearchReport \u4ed8\u304d\u306e\u65c5\u884c\u30ac\u30a4\u30c9\ntype TravelGuideWithReport = {\n    Attraction: Attraction\n    Subjects: string list\n    SearchReport: SearchReport\n}\n</code></pre> <p></p>"},{"location":"fsharp/part-6/#123","title":"12.3 \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u306e\u6539\u5584","text":"<pre><code>/// Either \u3092\u4f7f\u7528\u3057\u305f\u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\ntype IDataAccessWithErrors =\n    abstract member FindAttractions:\n        name: string * ordering: AttractionOrdering * limit: int\n        -&gt; Async&lt;Attraction list&gt;\n    abstract member FindArtistsFromLocation:\n        locationId: LocationId * limit: int\n        -&gt; Async&lt;Result&lt;MusicArtist list, string&gt;&gt;\n    abstract member FindMoviesAboutLocation:\n        locationId: LocationId * limit: int\n        -&gt; Async&lt;Result&lt;Movie list, string&gt;&gt;\n</code></pre> <p>Result \u3092\u4f7f\u7528\u3057\u3066\u30a8\u30e9\u30fc\u3092\u660e\u793a\u7684\u306b\u6271\u3044\u307e\u3059:</p> <pre><code>/// \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u4ed8\u304d\u65c5\u884c\u30ac\u30a4\u30c9\u751f\u6210\nlet travelGuideWithReport (data: IDataAccessWithErrors) (attractionName: string)\n    : Async&lt;TravelGuideWithReport option&gt; =\n    async {\n        let! attractions = data.FindAttractions(attractionName, ByLocationPopulation, 1)\n        match attractions with\n        | [] -&gt; return None\n        | attraction :: _ -&gt;\n            let! artistsResult = data.FindArtistsFromLocation(attraction.Location.Id, 2)\n            let! moviesResult = data.FindMoviesAboutLocation(attraction.Location.Id, 2)\n\n            let artistError = match artistsResult with Error e -&gt; Some e | Ok _ -&gt; None\n            let movieError = match moviesResult with Error e -&gt; Some e | Ok _ -&gt; None\n            let errors = [artistError; movieError] |&gt; List.choose id\n\n            let artists = artistsResult |&gt; Result.defaultValue []\n            let movies = moviesResult |&gt; Result.defaultValue []\n\n            let subjects =\n                (artists |&gt; List.map (fun a -&gt; a.Name))\n                @ (movies |&gt; List.map (fun m -&gt; m.Name))\n\n            let report = {\n                AttractionsSearched = 1\n                ArtistsFound = List.length artists\n                MoviesFound = List.length movies\n                Errors = errors\n            }\n\n            return Some {\n                Attraction = attraction\n                Subjects = subjects\n                SearchReport = report\n            }\n    }\n</code></pre>"},{"location":"fsharp/part-6/#124","title":"12.4 \u30b9\u30bf\u30d6\u3092\u4f7f\u7528\u3057\u305f\u30c6\u30b9\u30c8","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/fsharp/tests/Ch12/TravelGuideWithReportTests.fs</code></p> <pre><code>/// \u6210\u529f\u3059\u308b\u30c6\u30b9\u30c8\u7528\u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\nlet successfulDataAccess\n    (testAttractions: Attraction list)\n    (testArtists: MusicArtist list)\n    (testMovies: Movie list)\n    : IDataAccessWithErrors =\n    { new IDataAccessWithErrors with\n        member _.FindAttractions(name, _, limit) =\n            async {\n                return\n                    testAttractions\n                    |&gt; List.filter (fun a -&gt; a.Name.Contains(name))\n                    |&gt; List.truncate limit\n            }\n\n        member _.FindArtistsFromLocation(_, limit) =\n            async { return Ok (testArtists |&gt; List.truncate limit) }\n\n        member _.FindMoviesAboutLocation(_, limit) =\n            async { return Ok (testMovies |&gt; List.truncate limit) }\n    }\n\n/// \u90e8\u5206\u7684\u306b\u5931\u6557\u3059\u308b\u30c6\u30b9\u30c8\u7528\u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\nlet partiallyFailingDataAccess\n    (testAttractions: Attraction list)\n    (artistError: string)\n    (movieError: string)\n    : IDataAccessWithErrors =\n    { new IDataAccessWithErrors with\n        member _.FindAttractions(name, _, limit) =\n            async {\n                return\n                    testAttractions\n                    |&gt; List.filter (fun a -&gt; a.Name.Contains(name))\n                    |&gt; List.truncate limit\n            }\n\n        member _.FindArtistsFromLocation(_, _) =\n            async { return Error artistError }\n\n        member _.FindMoviesAboutLocation(_, _) =\n            async { return Error movieError }\n    }\n</code></pre> <p></p>"},{"location":"fsharp/part-6/#125","title":"12.5 \u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8\u7528\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u30fc","text":"<p>\u30e9\u30f3\u30c0\u30e0\u306a\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u3092\u751f\u6210\u3059\u308b\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u30fc\u3092\u5b9f\u88c5:</p> <pre><code>module Generators =\n    open System\n\n    let private random = Random()\n\n    /// \u30e9\u30f3\u30c0\u30e0\u306a LocationId \u3092\u751f\u6210\n    let locationId () =\n        LocationId (sprintf \"Q%d\" (random.Next(1, 10000)))\n\n    /// \u30e9\u30f3\u30c0\u30e0\u306a Location \u3092\u751f\u6210\n    let location () = {\n        Id = locationId ()\n        Name = sprintf \"City%d\" (random.Next(1, 1000))\n        Population = random.Next(1000, 10000000)\n    }\n\n    /// \u30e9\u30f3\u30c0\u30e0\u306a Attraction \u3092\u751f\u6210\n    let attraction () = {\n        Name = sprintf \"Attraction%d\" (random.Next(1, 1000))\n        Description = if random.Next(2) = 0 then Some \"Description\" else None\n        Location = location ()\n    }\n\n    /// \u30e9\u30f3\u30c0\u30e0\u306a Attraction \u30ea\u30b9\u30c8\u3092\u751f\u6210\n    let attractions (count: int) =\n        [ for _ in 1..count -&gt; attraction () ]\n</code></pre>"},{"location":"fsharp/part-6/#126","title":"12.6 \u4e0d\u5909\u6761\u4ef6\u306e\u30c6\u30b9\u30c8","text":"<pre><code>module Invariants =\n    /// \u7d50\u679c\u306e\u30b5\u30a4\u30ba\u306f limit \u4ee5\u4e0b\n    let resultSizeIsLimited (results: 'a list) (limit: int) : bool =\n        List.length results &lt;= limit\n\n    /// SearchReport \u306e\u30a8\u30e9\u30fc\u6570\u306f\u691c\u7d22\u6570\u4ee5\u4e0b\n    let errorsAreBounded (report: SearchReport) : bool =\n        List.length report.Errors &lt;= 2 // artists + movies \u306e\u6700\u5927\n\n/// \u30e6\u30fc\u30c6\u30a3\u30ea\u30c6\u30a3\u95a2\u6570\nlet filterPopularLocations (locations: Location list) (minPopulation: int) : Location list =\n    locations |&gt; List.filter (fun loc -&gt; loc.Population &gt;= minPopulation)\n</code></pre>"},{"location":"fsharp/part-6/#127","title":"12.7 \u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8\uff08\u7c21\u6613\u7248\uff09","text":"<pre><code>[&lt;Fact&gt;]\nlet ``filterPopularLocations \u306e\u7d50\u679c\u30b5\u30a4\u30ba\u306f\u5165\u529b\u4ee5\u4e0b`` () =\n    for _ in 1..10 do\n        let locations = Generators.attractions 10 |&gt; List.map (fun a -&gt; a.Location)\n        let minPop = System.Random().Next(1, 10000000)\n        let result = filterPopularLocations locations minPop\n        Assert.True(List.length result &lt;= List.length locations)\n\n[&lt;Fact&gt;]\nlet ``filterPopularLocations \u306e\u7d50\u679c\u306f\u3059\u3079\u3066\u6761\u4ef6\u3092\u6e80\u305f\u3059`` () =\n    for _ in 1..10 do\n        let locations = Generators.attractions 10 |&gt; List.map (fun a -&gt; a.Location)\n        let minPop = System.Random().Next(1, 100000)\n        let result = filterPopularLocations locations minPop\n        Assert.True(result |&gt; List.forall (fun loc -&gt; loc.Population &gt;= minPop))\n</code></pre>"},{"location":"fsharp/part-6/#128","title":"12.8 \u7d71\u5408\u30c6\u30b9\u30c8","text":"<pre><code>[&lt;Fact&gt;]\nlet ``\u5b8c\u5168\u306a\u30d5\u30ed\u30fc\u306e\u30c6\u30b9\u30c8 - \u6210\u529f\u30b1\u30fc\u30b9`` () =\n    let testLocation = {\n        Id = LocationId \"Q123\"\n        Name = \"Tokyo\"\n        Population = 14000000\n    }\n    let testAttractions = [\n        { Name = \"Tokyo Tower\"; Description = Some \"Famous landmark\"; Location = testLocation }\n    ]\n    let testArtists = [\n        { Name = \"Hikaru Utada\"; Genre = Some \"Pop\" }\n        { Name = \"Ayumi Hamasaki\"; Genre = Some \"Pop\" }\n    ]\n    let testMovies = [\n        { Name = \"Lost in Translation\"; BoxOffice = Some 44000000 }\n    ]\n\n    let dataAccess = successfulDataAccess testAttractions testArtists testMovies\n    let result = travelGuideWithReport dataAccess \"Tokyo\" |&gt; Async.RunSynchronously\n\n    Assert.True(result.IsSome)\n    let guide = result.Value\n    Assert.Equal(\"Tokyo Tower\", guide.Attraction.Name)\n    Assert.Equal(3, List.length guide.Subjects)\n    Assert.Empty(guide.SearchReport.Errors)\n\n[&lt;Fact&gt;]\nlet ``\u5b8c\u5168\u306a\u30d5\u30ed\u30fc\u306e\u30c6\u30b9\u30c8 - \u90e8\u5206\u7684\u5931\u6557\u30b1\u30fc\u30b9`` () =\n    let testLocation = { Id = LocationId \"Q123\"; Name = \"Tokyo\"; Population = 14000000 }\n    let testAttractions = [\n        { Name = \"Tokyo Tower\"; Description = Some \"Famous landmark\"; Location = testLocation }\n    ]\n\n    let dataAccess = partiallyFailingDataAccess testAttractions \"Network error\" \"Timeout\"\n    let result = travelGuideWithReport dataAccess \"Tokyo\" |&gt; Async.RunSynchronously\n\n    Assert.True(result.IsSome)\n    let guide = result.Value\n    Assert.Equal(2, List.length guide.SearchReport.Errors)\n</code></pre>"},{"location":"fsharp/part-6/#129","title":"12.9 \u30c6\u30b9\u30c8\u30d4\u30e9\u30df\u30c3\u30c9","text":""},{"location":"fsharp/part-6/#_1","title":"\u307e\u3068\u3081","text":""},{"location":"fsharp/part-6/#part-vi_1","title":"Part VI \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"fsharp/part-6/#_2","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>\u62bd\u8c61\u5316\u306e\u91cd\u8981\u6027: IDataAccess \u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3067\u5916\u90e8\u4f9d\u5b58\u3092\u62bd\u8c61\u5316</li> <li>Resource \u3067\u30ea\u30bd\u30fc\u30b9\u7ba1\u7406: \u5b89\u5168\u306a\u30ea\u30bd\u30fc\u30b9\u306e\u53d6\u5f97\u3068\u89e3\u653e</li> <li>Ref \u3067\u30ad\u30e3\u30c3\u30b7\u30e5: \u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u72b6\u614b\u7ba1\u7406</li> <li>Result \u3067\u30a8\u30e9\u30fc\u51e6\u7406: \u660e\u793a\u7684\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0</li> <li>SearchReport: \u30c6\u30b9\u30c8\u53ef\u80fd\u6027\u3068\u53ef\u89b3\u6e2c\u6027\u306e\u5411\u4e0a</li> <li>\u30b9\u30bf\u30d6: \u5916\u90e8\u4f9d\u5b58\u3092\u5dee\u3057\u66ff\u3048\u3066\u30c6\u30b9\u30c8</li> <li>\u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8: \u30e9\u30f3\u30c0\u30e0\u5165\u529b\u3067\u4e0d\u5909\u6761\u4ef6\u3092\u691c\u8a3c</li> </ol>"},{"location":"fsharp/part-6/#_3","title":"\u5b66\u7fd2\u306e\u7dcf\u62ec","text":""},{"location":"fsharp/part-6/#_4","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"fsharp/part-6/#1-dataaccess","title":"\u554f\u984c 1: DataAccess \u306e\u62e1\u5f35","text":"<p>\u4ee5\u4e0b\u306e\u8981\u4ef6\u3067 <code>IDataAccess</code> \u3092\u62e1\u5f35\u3057\u3066\u304f\u3060\u3055\u3044: - \u65b0\u3057\u3044\u30e1\u30bd\u30c3\u30c9 <code>FindHotelsNearLocation</code> \u3092\u8ffd\u52a0 - \u623b\u308a\u5024\u306f <code>Async&lt;Result&lt;Hotel list, string&gt;&gt;</code></p> \u89e3\u7b54 <pre><code>type Hotel = {\n    Name: string\n    Rating: float\n    Location: Location\n}\n\ntype IDataAccessExtended =\n    inherit IDataAccess\n    abstract member FindHotelsNearLocation:\n        locationId: LocationId * limit: int\n        -&gt; Async&lt;Result&lt;Hotel list, string&gt;&gt;\n\n// \u30c6\u30b9\u30c8\u7528\u30b9\u30bf\u30d6\nlet testDataAccessExtended\n    (testAttractions: Attraction list)\n    (testArtists: MusicArtist list)\n    (testMovies: Movie list)\n    (testHotels: Hotel list)\n    : IDataAccessExtended =\n    { new IDataAccessExtended with\n        member _.FindAttractions(name, _, limit) =\n            async { return testAttractions |&gt; List.filter (fun a -&gt; a.Name.Contains(name)) |&gt; List.truncate limit }\n        member _.FindArtistsFromLocation(_, limit) =\n            async { return testArtists |&gt; List.truncate limit }\n        member _.FindMoviesAboutLocation(_, limit) =\n            async { return testMovies |&gt; List.truncate limit }\n        member _.FindHotelsNearLocation(_, limit) =\n            async { return Ok (testHotels |&gt; List.truncate limit) }\n    }\n</code></pre>"},{"location":"fsharp/part-6/#2","title":"\u554f\u984c 2: \u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u306b\u5bfe\u3059\u308b\u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8\u3092\u66f8\u3044\u3066\u304f\u3060\u3055\u3044:</p> <pre><code>let sortAttractionsByPopulation (attractions: Attraction list) : Attraction list =\n    attractions |&gt; List.sortByDescending (fun a -&gt; a.Location.Population)\n</code></pre> \u89e3\u7b54 <pre><code>[&lt;Fact&gt;]\nlet ``sortAttractionsByPopulation \u306f\u964d\u9806\u306b\u306a\u308b`` () =\n    for _ in 1..10 do\n        let attractions = Generators.attractions 5\n        let result = sortAttractionsByPopulation attractions\n        let populations = result |&gt; List.map (fun a -&gt; a.Location.Population)\n        let sorted = populations |&gt; List.sortDescending\n        Assert.Equal&lt;int list&gt;(sorted, populations)\n\n[&lt;Fact&gt;]\nlet ``sortAttractionsByPopulation \u306f\u8981\u7d20\u6570\u3092\u5909\u3048\u306a\u3044`` () =\n    for _ in 1..10 do\n        let attractions = Generators.attractions 5\n        let result = sortAttractionsByPopulation attractions\n        Assert.Equal(List.length attractions, List.length result)\n\n[&lt;Fact&gt;]\nlet ``sortAttractionsByPopulation \u306f\u5168\u8981\u7d20\u3092\u4fdd\u6301\u3059\u308b`` () =\n    for _ in 1..10 do\n        let attractions = Generators.attractions 3\n        let result = sortAttractionsByPopulation attractions\n        let inputNames = attractions |&gt; List.map (fun a -&gt; a.Name) |&gt; Set.ofList\n        let outputNames = result |&gt; List.map (fun a -&gt; a.Name) |&gt; Set.ofList\n        Assert.Equal&lt;Set&lt;string&gt;&gt;(inputNames, outputNames)\n</code></pre>"},{"location":"fsharp/part-6/#3-resource","title":"\u554f\u984c 3: Resource \u306e\u5b9f\u88c5","text":"<p>\u30d5\u30a1\u30a4\u30eb\u3092\u5b89\u5168\u306b\u8aad\u307f\u53d6\u308b <code>Resource</code> \u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> \u89e3\u7b54 <pre><code>open System.IO\n\nlet fileResource (path: string) : Resource&lt;StreamReader&gt; =\n    Resource.make\n        (fun () -&gt; async { return new StreamReader(path) })\n        (fun reader -&gt; async { reader.Dispose() })\n\nlet readAllLines (path: string) : Async&lt;string list&gt; =\n    fileResource path\n    |&gt; Resource.useAsync (fun reader -&gt;\n        async {\n            let lines = ResizeArray&lt;string&gt;()\n            let mutable line = reader.ReadLine()\n            while line &lt;&gt; null do\n                lines.Add(line)\n                line &lt;- reader.ReadLine()\n            return lines |&gt; Seq.toList\n        })\n\n// \u4f7f\u7528\u4f8b\nlet program : Async&lt;unit&gt; =\n    async {\n        let! lines = readAllLines \"data.txt\"\n        printfn \"Read %d lines\" (List.length lines)\n    }\n</code></pre>"},{"location":"fsharp/part-6/#_5","title":"\u30b7\u30ea\u30fc\u30ba\u5168\u4f53\u306e\u7dcf\u62ec","text":"<p>\u672c\u30b7\u30ea\u30fc\u30ba\u3067\u306f\u3001\u300cGrokking Functional Programming\u300d\u306e\u5185\u5bb9\u306b\u6cbf\u3063\u3066\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u790e\u304b\u3089\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u307e\u3067\u3092 F# \u3067\u5b66\u3073\u307e\u3057\u305f\u3002</p>"},{"location":"fsharp/part-6/#_6","title":"\u5b66\u3093\u3060\u4e3b\u306a\u6982\u5ff5","text":"Part \u7ae0 \u4e3b\u306a\u6982\u5ff5 I 1-2 \u7d14\u7c8b\u95a2\u6570\u3001\u53c2\u7167\u900f\u904e\u6027 II 3-5 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u3001\u9ad8\u968e\u95a2\u6570\u3001flatMap III 6-7 Option\u3001Result\u3001\u5224\u5225\u5171\u7528\u4f53 IV 8-9 Async\u3001Seq\uff08\u30b9\u30c8\u30ea\u30fc\u30e0\uff09 V 10 \u4e26\u884c\u51e6\u7406\u3001Ref\u3001MailboxProcessor VI 11-12 \u5b9f\u8df5\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3001\u30c6\u30b9\u30c8"},{"location":"fsharp/part-6/#_7","title":"\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u5229\u70b9","text":"<ol> <li>\u4e88\u6e2c\u53ef\u80fd\u6027: \u7d14\u7c8b\u95a2\u6570\u306f\u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b</li> <li>\u30c6\u30b9\u30c8\u5bb9\u6613\u6027: \u526f\u4f5c\u7528\u304c\u306a\u3044\u305f\u3081\u30c6\u30b9\u30c8\u304c\u7c21\u5358</li> <li>\u5408\u6210\u53ef\u80fd\u6027: \u5c0f\u3055\u306a\u95a2\u6570\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u8907\u96d1\u306a\u51e6\u7406\u3092\u69cb\u7bc9</li> <li>\u4e26\u884c\u5b89\u5168\u6027: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u306f\u7af6\u5408\u72b6\u614b\u3092\u9632\u3050</li> <li>\u578b\u5b89\u5168\u6027: Option\u3001Result \u3067 null \u3084\u4f8b\u5916\u3092\u578b\u3067\u8868\u73fe</li> </ol>"},{"location":"fsharp/part-6/#f","title":"F# \u306e\u7279\u5fb4","text":"<p>F# \u306f .NET \u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u4e0a\u3067\u52d5\u4f5c\u3059\u308b\u95a2\u6570\u578b\u512a\u5148\u8a00\u8a9e\u3067\u3001\u4ee5\u4e0b\u306e\u7279\u5fb4\u304c\u3042\u308a\u307e\u3059:</p> <ul> <li>\u578b\u63a8\u8ad6: \u660e\u793a\u7684\u306a\u578b\u6ce8\u91c8\u306a\u3057\u3067\u3082\u578b\u5b89\u5168</li> <li>\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50: <code>|&gt;</code> \u3067\u30c7\u30fc\u30bf\u306e\u6d41\u308c\u3092\u76f4\u611f\u7684\u306b\u8868\u73fe</li> <li>\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0: \u5f37\u529b\u306a\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3067\u5206\u5c90\u51e6\u7406</li> <li>\u8a08\u7b97\u5f0f: <code>async { }</code> \u306a\u3069\u3067\u975e\u540c\u671f\u51e6\u7406\u3092\u5ba3\u8a00\u7684\u306b\u8a18\u8ff0</li> <li>\u76f8\u4e92\u904b\u7528\u6027: C# \u3084 .NET \u30e9\u30a4\u30d6\u30e9\u30ea\u3068\u30b7\u30fc\u30e0\u30ec\u30b9\u306b\u9023\u643a</li> </ul>"},{"location":"fsharp/part-6/#_8","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<ul> <li>F# \u306e\u9ad8\u5ea6\u306a\u6a5f\u80fd\uff08\u578b\u30d7\u30ed\u30d0\u30a4\u30c0\u30fc\u3001\u30a2\u30af\u30c6\u30a3\u30d6\u30d1\u30bf\u30fc\u30f3\uff09\u3092\u5b66\u3076</li> <li>Elmish/Bolero \u306a\u3069\u306e F# Web \u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3092\u63a2\u7d22</li> <li>Fable \u3067 F# \u3092 JavaScript \u306b\u30b3\u30f3\u30d1\u30a4\u30eb</li> <li>\u5b9f\u969b\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067 FP \u3092\u9069\u7528\u3059\u308b</li> </ul>"},{"location":"java/","title":"Grokking Functional Programming Java \u7248\u89e3\u8aac","text":"<p>\u672c\u30b7\u30ea\u30fc\u30ba\u306f\u300cGrokking Functional Programming\u300d\uff08Micha\u0142 P\u0142achta \u8457\uff09\u306e\u5b66\u7fd2\u30b3\u30f3\u30d1\u30cb\u30aa\u30f3\u3068\u3057\u3066\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u6982\u5ff5\u3092 Java + Vavr \u3067\u5b9f\u88c5\u3057\u306a\u304c\u3089\u65e5\u672c\u8a9e\u3067\u89e3\u8aac\u3057\u307e\u3059\u3002</p>"},{"location":"java/#_1","title":"\u5bfe\u8c61\u8aad\u8005","text":"<ul> <li>Java \u306e\u7d4c\u9a13\u304c\u3042\u308a\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u8208\u5473\u304c\u3042\u308b\u958b\u767a\u8005</li> <li>Scala \u3092\u5b66\u3070\u305a\u306b Java \u3067 FP \u3092\u5b9f\u8df5\u3057\u305f\u3044\u65b9</li> <li>Vavr \u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u4f7f\u3063\u305f\u5b9f\u8df5\u7684\u306a FP \u306e\u9069\u7528\u65b9\u6cd5\u3092\u77e5\u308a\u305f\u3044\u30a8\u30f3\u30b8\u30cb\u30a2</li> </ul>"},{"location":"java/#_2","title":"\u8a18\u4e8b\u4e00\u89a7","text":""},{"location":"java/#part-i","title":"Part I: \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u790e","text":"<p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u672c\u6982\u5ff5\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c1\u7ae0 \u547d\u4ee4\u578b vs \u95a2\u6570\u578b\u3001Java \u3067\u306e FP \u5165\u9580 \u7b2c2\u7ae0 \u7d14\u7c8b\u95a2\u6570\u3001\u526f\u4f5c\u7528\u306e\u6392\u9664\u3001\u30c6\u30b9\u30c8\u306e\u5bb9\u6613\u3055 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: \u7d14\u7c8b\u95a2\u6570\u3001\u53c2\u7167\u900f\u904e\u6027\u3001\u526f\u4f5c\u7528</p>"},{"location":"java/#part-ii","title":"Part II: \u95a2\u6570\u578b\u30b9\u30bf\u30a4\u30eb\u306e\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0","text":"<p>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c\u3068\u9ad8\u968e\u95a2\u6570\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c3\u7ae0 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u3001Vavr List \u64cd\u4f5c \u7b2c4\u7ae0 \u9ad8\u968e\u95a2\u6570\u3001map/filter/foldLeft \u7b2c5\u7ae0 flatMap\u3001For \u5185\u5305\u8868\u8a18\uff08Vavr\uff09 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u3001\u9ad8\u968e\u95a2\u6570\u3001flatMap\u3001Vavr \u30b3\u30ec\u30af\u30b7\u30e7\u30f3</p>"},{"location":"java/#part-iii-optioneither","title":"Part III: \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3068 Option/Either","text":"<p>\u578b\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c6\u7ae0 Option \u578b\u3001Some/None \u7b2c7\u7ae0 Either \u578b\u3001Sealed \u30af\u30e9\u30b9\u3001\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: Option\u3001Either\u3001Sealed \u30af\u30e9\u30b9\uff08Java 17+\uff09</p>"},{"location":"java/#part-iv-io","title":"Part IV: IO \u3068\u526f\u4f5c\u7528\u306e\u7ba1\u7406","text":"<p>IO \u30d1\u30bf\u30fc\u30f3\u3068\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c8\u7ae0 IO \u30d1\u30bf\u30fc\u30f3\u3001Lazy \u8a55\u4fa1 \u7b2c9\u7ae0 Stream \u51e6\u7406\u3001\u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: Lazy\u3001Try\u3001Future\u3001\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406</p>"},{"location":"java/#part-v","title":"Part V: \u4e26\u884c\u51e6\u7406","text":"<p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u4e26\u884c\u51e6\u7406\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c10\u7ae0 CompletableFuture\u3001\u4e26\u5217\u30b9\u30c8\u30ea\u30fc\u30e0 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: \u4e26\u884c\u51e6\u7406\u3001CompletableFuture\u3001Virtual Threads\uff08Java 21+\uff09</p>"},{"location":"java/#part-vi","title":"Part VI: \u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u3068\u30c6\u30b9\u30c8","text":"<p>\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u3068\u30c6\u30b9\u30c8\u6226\u7565\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c11\u7ae0 TravelGuide \u30a2\u30d7\u30ea\u3001\u30ea\u30bd\u30fc\u30b9\u7ba1\u7406 \u7b2c12\u7ae0 \u30c6\u30b9\u30c8\u6226\u7565\u3001\u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: Try-with-resources\u3001DataAccess \u62bd\u8c61\u5316\u3001jqwik</p>"},{"location":"java/#_3","title":"\u5b66\u7fd2\u30d1\u30b9","text":""},{"location":"java/#_4","title":"\u4f7f\u7528\u30e9\u30a4\u30d6\u30e9\u30ea","text":"\u30e9\u30a4\u30d6\u30e9\u30ea \u7528\u9014 \u5bfe\u5fdc\u7ae0 Java 17+ \u8a00\u8a9e \u5168\u7ae0 Vavr \u95a2\u6570\u578b\u30c7\u30fc\u30bf\u69cb\u9020 \u5168\u7ae0 jqwik \u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8 Part VI JUnit 5 \u5358\u4f53\u30c6\u30b9\u30c8 \u5168\u7ae0"},{"location":"java/#vavr","title":"Vavr \u3068\u306f","text":"<p>Vavr \u306f Java \u5411\u3051\u306e\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u30e9\u30a4\u30d6\u30e9\u30ea\u3067\u3059\u3002</p>"},{"location":"java/#_5","title":"\u4e3b\u306a\u6a5f\u80fd","text":"<ul> <li>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30b3\u30ec\u30af\u30b7\u30e7\u30f3: <code>List</code>, <code>Set</code>, <code>Map</code>, <code>Seq</code></li> <li>\u95a2\u6570\u578b\u30c7\u30fc\u30bf\u578b: <code>Option</code>, <code>Either</code>, <code>Try</code>, <code>Lazy</code>, <code>Future</code></li> <li>\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0: <code>Match</code> API</li> <li>\u30bf\u30d7\u30eb: <code>Tuple1</code> \u301c <code>Tuple8</code></li> <li>\u95a2\u6570\u578b\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9: <code>Function0</code> \u301c <code>Function8</code></li> </ul>"},{"location":"java/#scala","title":"Scala \u3068\u306e\u5bfe\u5fdc","text":"Scala Vavr (Java) <code>Option[T]</code> <code>Option&lt;T&gt;</code> <code>Either[L, R]</code> <code>Either&lt;L, R&gt;</code> <code>Try[T]</code> <code>Try&lt;T&gt;</code> <code>List[T]</code> <code>List&lt;T&gt;</code> <code>for</code> \u5185\u5305\u8868\u8a18 <code>For.yield()</code> \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1 <code>Match(value).of()</code>"},{"location":"java/#_6","title":"\u30ea\u30dd\u30b8\u30c8\u30ea\u69cb\u6210","text":"<pre><code>grokkingfp-examples/\n\u251c\u2500\u2500 app/java/src/main/java/      # Java + Vavr \u306e\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n\u251c\u2500\u2500 app/java/src/test/java/      # \u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\n\u251c\u2500\u2500 app/scala/src/main/scala/    # Scala \u7248\uff08\u53c2\u8003\uff09\n\u2514\u2500\u2500 docs/article/                # \u89e3\u8aac\u8a18\u4e8b\n    \u251c\u2500\u2500 scala/                   # Scala \u7248\u89e3\u8aac\n    \u2514\u2500\u2500 java/                    # Java \u7248\u89e3\u8aac\uff08\u672c\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\uff09\n        \u251c\u2500\u2500 index.md             # \u3053\u306e\u8a18\u4e8b\n        \u251c\u2500\u2500 part-1.md            # Part I\n        \u251c\u2500\u2500 part-2.md            # Part II\n        \u251c\u2500\u2500 part-3.md            # Part III\n        \u251c\u2500\u2500 part-4.md            # Part IV\n        \u251c\u2500\u2500 part-5.md            # Part V\n        \u2514\u2500\u2500 part-6.md            # Part VI\n</code></pre>"},{"location":"java/#_7","title":"\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u5229\u70b9","text":"<p>\u672c\u30b7\u30ea\u30fc\u30ba\u3092\u901a\u3058\u3066\u3001\u4ee5\u4e0b\u306e\u5229\u70b9\u3092\u5b9f\u611f\u3067\u304d\u307e\u3059:</p> <ol> <li>\u4e88\u6e2c\u53ef\u80fd\u6027 - \u7d14\u7c8b\u95a2\u6570\u306f\u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b</li> <li>\u30c6\u30b9\u30c8\u5bb9\u6613\u6027 - \u526f\u4f5c\u7528\u304c\u306a\u3044\u305f\u3081\u30c6\u30b9\u30c8\u304c\u7c21\u5358</li> <li>\u5408\u6210\u53ef\u80fd\u6027 - \u5c0f\u3055\u306a\u95a2\u6570\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u8907\u96d1\u306a\u51e6\u7406\u3092\u69cb\u7bc9</li> <li>\u4e26\u884c\u5b89\u5168\u6027 - \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u306f\u7af6\u5408\u72b6\u614b\u3092\u9632\u3050</li> <li>\u578b\u5b89\u5168\u6027 - Option\u3001Either \u3067 null \u3084\u4f8b\u5916\u3092\u578b\u3067\u8868\u73fe</li> </ol>"},{"location":"java/#java-fp-scala","title":"Java \u3067\u306e FP: Scala \u3068\u306e\u6bd4\u8f03","text":"\u7279\u5fb4 Scala Java + Vavr \u69cb\u6587\u306e\u7c21\u6f54\u3055 \u975e\u5e38\u306b\u7c21\u6f54 \u3084\u3084\u5197\u9577 \u578b\u63a8\u8ad6 \u5f37\u529b \u9650\u5b9a\u7684 \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1 \u8a00\u8a9e\u6a5f\u80fd \u30e9\u30a4\u30d6\u30e9\u30ea \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb \u30c7\u30d5\u30a9\u30eb\u30c8 \u660e\u793a\u7684\u306b\u9078\u629e for \u5185\u5305\u8868\u8a18 \u8a00\u8a9e\u6a5f\u80fd <code>For.yield()</code> \u5b66\u7fd2\u30b3\u30b9\u30c8 \u9ad8\u3044 \u4f4e\u3044\uff08Java \u7d4c\u9a13\u8005\uff09 \u30a8\u30b3\u30b7\u30b9\u30c6\u30e0 Scala \u5c02\u7528 Java \u8cc7\u7523\u6d3b\u7528\u53ef\u80fd"},{"location":"java/#_8","title":"\u53c2\u8003\u8cc7\u6599","text":"<ul> <li>Grokking Functional Programming - \u539f\u8457</li> <li>Vavr \u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8</li> <li>Vavr GitHub</li> <li>jqwik \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8</li> <li>Java \u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8</li> </ul>"},{"location":"java/part-1/","title":"Part I: \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u790e","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\uff08FP\uff09\u306e\u57fa\u672c\u6982\u5ff5\u3092 Java + Vavr \u3067\u5b66\u3073\u307e\u3059\u3002\u547d\u4ee4\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u3068\u306e\u9055\u3044\u3092\u7406\u89e3\u3057\u3001\u7d14\u7c8b\u95a2\u6570\u306e\u5229\u70b9\u3092\u5b9f\u611f\u3059\u308b\u3053\u3068\u304c\u76ee\u6a19\u3067\u3059\u3002</p>"},{"location":"java/part-1/#1","title":"\u7b2c1\u7ae0: \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u5165\u9580","text":""},{"location":"java/part-1/#11-vs","title":"1.1 \u547d\u4ee4\u578b vs \u95a2\u6570\u578b","text":"<p>\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u306f\u5927\u304d\u304f\u5206\u3051\u30662\u3064\u306e\u30d1\u30e9\u30c0\u30a4\u30e0\u304c\u3042\u308a\u307e\u3059\u3002</p> <p></p> <p>\u547d\u4ee4\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306f\u300c\u3069\u3046\u3084\u308b\u304b\u300d\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002</p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch01/IntroJava.java</code></p> <pre><code>// Java: \u547d\u4ee4\u578b\u3067\u30ef\u30fc\u30c9\u30b9\u30b3\u30a2\u3092\u8a08\u7b97\npublic static int calculateScoreImperative(String word) {\n    int score = 0;\n    for (char c : word.toCharArray()) {\n        score++;\n    }\n    return score;\n}\n</code></pre> <p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306f\u300c\u4f55\u3092\u3059\u308b\u304b\u300d\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002</p> <pre><code>// Java: \u95a2\u6570\u578b\u3067\u30ef\u30fc\u30c9\u30b9\u30b3\u30a2\u3092\u8a08\u7b97\npublic static int wordScore(String word) {\n    return word.length();\n}\n</code></pre>"},{"location":"java/part-1/#12-java","title":"1.2 Java \u3067\u306e\u95a2\u6570\u5b9a\u7fa9","text":"<p>Java \u3067\u306e\u95a2\u6570\uff08\u30e1\u30bd\u30c3\u30c9\uff09\u5b9a\u7fa9\u306e\u57fa\u672c\u5f62\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p> <pre><code>public static int increment(int x) {\n    return x + 1;\n}\n\npublic static char getFirstCharacter(String s) {\n    return s.charAt(0);\n}\n\npublic static int wordScore(String word) {\n    return word.length();\n}\n</code></pre>"},{"location":"java/part-1/#13","title":"1.3 \u95a2\u6570\u306e\u69cb\u9020","text":""},{"location":"java/part-1/#14","title":"1.4 \u5b66\u7fd2\u30dd\u30a4\u30f3\u30c8","text":"\u6982\u5ff5 \u547d\u4ee4\u578b \u95a2\u6570\u578b \u7126\u70b9 \u624b\u9806\uff08How\uff09 \u7d50\u679c\uff08What\uff09 \u72b6\u614b \u5909\u66f4\u3059\u308b \u5909\u63db\u3059\u308b \u30eb\u30fc\u30d7 for/while map/filter/reduce \u30c7\u30fc\u30bf \u30df\u30e5\u30fc\u30bf\u30d6\u30eb \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb"},{"location":"java/part-1/#2","title":"\u7b2c2\u7ae0: \u7d14\u7c8b\u95a2\u6570\u3068\u30c6\u30b9\u30c8","text":""},{"location":"java/part-1/#21","title":"2.1 \u7d14\u7c8b\u95a2\u6570\u3068\u306f","text":"<p>\u7d14\u7c8b\u95a2\u6570\uff08Pure Function\uff09\u306f\u4ee5\u4e0b\u306e\u7279\u5fb4\u3092\u6301\u3064\u95a2\u6570\u3067\u3059:</p> <ol> <li>\u540c\u3058\u5165\u529b\u306b\u306f\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3059</li> <li>\u526f\u4f5c\u7528\u304c\u306a\u3044\uff08\u5916\u90e8\u72b6\u614b\u3092\u5909\u66f4\u3057\u306a\u3044\uff09</li> </ol> <p></p>"},{"location":"java/part-1/#22","title":"2.2 \u7d14\u7c8b\u95a2\u6570\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch02/PureFunctions.java</code></p> <pre><code>// \u7d14\u7c8b\u95a2\u6570\u306e\u4f8b\npublic static int increment(int x) {\n    return x + 1;\n}\n\npublic static int add(int a, int b) {\n    return a + b;\n}\n\npublic static char getFirstCharacter(String s) {\n    return s.charAt(0);\n}\n\npublic static double applyDiscount(double x) {\n    return x * 95.0 / 100.0;\n}\n</code></pre> <p>\u7d14\u7c8b\u3067\u306f\u306a\u3044\u95a2\u6570\u306e\u4f8b:</p> <pre><code>// \u4e0d\u7d14\u306a\u95a2\u6570 - Math.random() \u306f\u6bce\u56de\u7570\u306a\u308b\u5024\u3092\u8fd4\u3059\npublic static double randomPart(double x) {\n    return x * Math.random();\n}\n\n// \u4e0d\u7d14\u306a\u95a2\u6570 - \u73fe\u5728\u6642\u523b\u306f\u6bce\u56de\u7570\u306a\u308b\npublic static long currentTime() {\n    return System.currentTimeMillis();\n}\n</code></pre>"},{"location":"java/part-1/#23","title":"2.3 \u30b7\u30e7\u30c3\u30d4\u30f3\u30b0\u30ab\u30fc\u30c8\u306e\u4f8b","text":"<p>\u72b6\u614b\u3092\u6301\u3064\u30af\u30e9\u30b9\u306e\u554f\u984c\u70b9\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch02/ShoppingCartBad.java</code></p>"},{"location":"java/part-1/#_1","title":"\u554f\u984c\u306e\u3042\u308b\u30b3\u30fc\u30c9","text":"<pre><code>public class ShoppingCartBad {\n    private List&lt;String&gt; items = new ArrayList&lt;&gt;();\n    private boolean bookAdded = false;\n\n    public void addItem(String item) {\n        items.add(item);\n        if (item.equals(\"Book\")) {\n            bookAdded = true;\n        }\n    }\n\n    public int getDiscountPercentage() {\n        if (bookAdded) {\n            return 5;\n        } else {\n            return 0;\n        }\n    }\n\n    public List&lt;String&gt; getItems() {\n        return items;  // \u554f\u984c: \u5185\u90e8\u72b6\u614b\u3078\u306e\u53c2\u7167\u3092\u8fd4\u3057\u3066\u3044\u308b\n    }\n}\n</code></pre>"},{"location":"java/part-1/#_2","title":"\u7d14\u7c8b\u95a2\u6570\u306b\u3088\u308b\u89e3\u6c7a","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch02/ShoppingCart.java</code></p> <pre><code>import io.vavr.collection.List;\n\npublic class ShoppingCart {\n    /**\n     * \u5272\u5f15\u7387\u3092\u8a08\u7b97\u3059\u308b\u7d14\u7c8b\u95a2\u6570\n     */\n    public static int getDiscountPercentage(List&lt;String&gt; items) {\n        if (items.contains(\"Book\")) {\n            return 5;\n        } else {\n            return 0;\n        }\n    }\n}\n</code></pre> <p></p>"},{"location":"java/part-1/#24-vavr-list","title":"2.4 Vavr \u306e List \u3092\u4f7f\u3063\u305f\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u64cd\u4f5c","text":"<p>Vavr \u306e <code>List</code> \u306f\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u69cb\u9020\u3067\u3059\u3002</p> <pre><code>import io.vavr.collection.List;\n\n// \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u64cd\u4f5c\nList&lt;String&gt; cart1 = List.of(\"Apple\");\nList&lt;String&gt; cart2 = cart1.append(\"Book\");  // \u65b0\u3057\u3044\u30ea\u30b9\u30c8\u3092\u4f5c\u6210\nList&lt;String&gt; cart3 = cart2.append(\"Lemon\"); // \u65b0\u3057\u3044\u30ea\u30b9\u30c8\u3092\u4f5c\u6210\n\n// cart1 \u306f\u5909\u66f4\u3055\u308c\u3066\u3044\u306a\u3044\nSystem.out.println(cart1); // List(Apple)\nSystem.out.println(cart2); // List(Apple, Book)\nSystem.out.println(cart3); // List(Apple, Book, Lemon)\n\n// \u5272\u5f15\u7387\u3092\u8a08\u7b97\nShoppingCart.getDiscountPercentage(cart1); // 0\nShoppingCart.getDiscountPercentage(cart2); // 5\nShoppingCart.getDiscountPercentage(cart3); // 5\n</code></pre>"},{"location":"java/part-1/#25","title":"2.5 \u30c1\u30c3\u30d7\u8a08\u7b97\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch02/TipCalculator.java</code></p> <pre><code>import io.vavr.collection.List;\n\npublic class TipCalculator {\n    /**\n     * \u30c1\u30c3\u30d7\u7387\u3092\u8a08\u7b97\u3059\u308b\u7d14\u7c8b\u95a2\u6570\n     */\n    public static int getTipPercentage(List&lt;String&gt; names) {\n        if (names.size() &gt; 5) {\n            return 20;\n        } else if (names.size() &gt; 0) {\n            return 10;\n        } else {\n            return 0;\n        }\n    }\n}\n</code></pre> <p>\u3053\u306e\u95a2\u6570\u306f: - 6\u4eba\u4ee5\u4e0a\u306e\u30b0\u30eb\u30fc\u30d7 \u2192 20% \u306e\u30c1\u30c3\u30d7 - 1-5\u4eba\u306e\u30b0\u30eb\u30fc\u30d7 \u2192 10% \u306e\u30c1\u30c3\u30d7 - 0\u4eba\uff08\u7a7a\u30ea\u30b9\u30c8\uff09 \u2192 0% \u306e\u30c1\u30c3\u30d7</p>"},{"location":"java/part-1/#26","title":"2.6 \u7d14\u7c8b\u95a2\u6570\u306e\u30c6\u30b9\u30c8","text":"<p>\u7d14\u7c8b\u95a2\u6570\u306f\u975e\u5e38\u306b\u30c6\u30b9\u30c8\u3057\u3084\u3059\u3044\u3067\u3059\u3002</p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/test/java/ch01/IntroJavaTest.java</code></p> <pre><code>@Test\n@DisplayName(\"increment \u306f\u5165\u529b\u306b1\u3092\u52a0\u3048\u308b\")\nvoid incrementAddOne() {\n    assertThat(IntroJava.increment(0)).isEqualTo(1);\n    assertThat(IntroJava.increment(6)).isEqualTo(7);\n    assertThat(IntroJava.increment(-1)).isEqualTo(0);\n    assertThat(IntroJava.increment(Integer.MAX_VALUE - 1))\n            .isEqualTo(Integer.MAX_VALUE);\n}\n\n@Test\n@DisplayName(\"isEven \u306f\u5076\u6570\u3092\u5224\u5b9a\")\nvoid isEvenChecksEvenness() {\n    assertThat(IntroJava.isEven(0)).isTrue();\n    assertThat(IntroJava.isEven(2)).isTrue();\n    assertThat(IntroJava.isEven(1)).isFalse();\n    assertThat(IntroJava.isEven(-2)).isTrue();\n    assertThat(IntroJava.isEven(-3)).isFalse();\n}\n</code></pre> <p></p>"},{"location":"java/part-1/#27-a","title":"2.7 \u6587\u5b57 'a' \u3092\u9664\u5916\u3059\u308b\u30ef\u30fc\u30c9\u30b9\u30b3\u30a2","text":"<p>\u3088\u308a\u8907\u96d1\u306a\u4f8b\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p> <pre><code>public static int wordScoreWithoutA(String word) {\n    return word.replace(\"a\", \"\").length();\n}\n\n// \u30c6\u30b9\u30c8\nassertThat(wordScoreWithoutA(\"Scala\")).isEqualTo(3);    // \"Scl\" \u2192 3\u6587\u5b57\nassertThat(wordScoreWithoutA(\"function\")).isEqualTo(8); // 'a' \u306a\u3057 \u2192 8\u6587\u5b57\nassertThat(wordScoreWithoutA(\"\")).isEqualTo(0);         // \u7a7a\u6587\u5b57 \u2192 0\u6587\u5b57\n</code></pre>"},{"location":"java/part-1/#28","title":"2.8 \u53c2\u7167\u900f\u904e\u6027","text":"<p>\u7d14\u7c8b\u95a2\u6570\u306f\u53c2\u7167\u900f\u904e\u6027\uff08Referential Transparency\uff09\u3092\u6301\u3061\u307e\u3059\u3002</p> <p>\u5f0f\u3092\u305d\u306e\u8a55\u4fa1\u7d50\u679c\u3067\u7f6e\u304d\u63db\u3048\u3066\u3082\u3001\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u610f\u5473\u304c\u5909\u308f\u3089\u306a\u3044\u3053\u3068</p> <pre><code>// \u53c2\u7167\u900f\u904e\u6027\u306e\u4f8b\nint score1 = wordScore(\"Java\");\nint score2 = wordScore(\"Java\");\n// score1 \u3068 score2 \u306f\u5e38\u306b\u540c\u3058\u5024\uff084\uff09\n\n// \u4ee5\u4e0b\u306e2\u3064\u306f\u540c\u7b49\nint total1 = wordScore(\"Java\") + wordScore(\"Scala\");\nint total2 = 4 + 5;  // wordScore \u306e\u7d50\u679c\u3067\u7f6e\u304d\u63db\u3048\u53ef\u80fd\n</code></pre> <p></p>"},{"location":"java/part-1/#java-vavr","title":"Java \u3068 Vavr \u306e\u5bfe\u5fdc\u8868","text":"\u6982\u5ff5 \u6a19\u6e96 Java Vavr \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30ea\u30b9\u30c8 <code>List.of()</code> (Java 9+) <code>io.vavr.collection.List</code> \u7a7a\u30ea\u30b9\u30c8 <code>List.of()</code> <code>List.empty()</code> \u8981\u7d20\u8ffd\u52a0 \u4e0d\u53ef\uff08\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\uff09 <code>list.append(x)</code> \u8981\u7d20\u524a\u9664 \u4e0d\u53ef\uff08\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\uff09 <code>list.remove(x)</code> \u8981\u7d20\u691c\u7d22 <code>list.contains(x)</code> <code>list.contains(x)</code>"},{"location":"java/part-1/#_3","title":"\u307e\u3068\u3081","text":""},{"location":"java/part-1/#part-i_1","title":"Part I \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"java/part-1/#_4","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306f\u300c\u4f55\u3092\u3059\u308b\u304b\u300d\u3092\u5ba3\u8a00\u7684\u306b\u8a18\u8ff0\u3059\u308b</li> <li>\u7d14\u7c8b\u95a2\u6570\u306f\u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3059</li> <li>\u526f\u4f5c\u7528\u3092\u907f\u3051\u308b\u3053\u3068\u3067\u30b3\u30fc\u30c9\u306e\u4e88\u6e2c\u53ef\u80fd\u6027\u304c\u5411\u4e0a\u3059\u308b</li> <li>\u7d14\u7c8b\u95a2\u6570\u306f\u30c6\u30b9\u30c8\u304c\u975e\u5e38\u306b\u7c21\u5358</li> <li>\u53c2\u7167\u900f\u904e\u6027\u306b\u3088\u308a\u3001\u30b3\u30fc\u30c9\u306e\u7406\u89e3\u3068\u63a8\u8ad6\u304c\u5bb9\u6613\u306b\u306a\u308b</li> <li>Vavr \u306e List \u3092\u4f7f\u3046\u3068\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c\u304c\u7c21\u5358</li> </ol>"},{"location":"java/part-1/#_5","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part II \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c\uff08Vavr \u30b3\u30ec\u30af\u30b7\u30e7\u30f3\uff09</li> <li>\u9ad8\u968e\u95a2\u6570\uff08\u95a2\u6570\u3092\u5024\u3068\u3057\u3066\u6271\u3046\uff09</li> <li><code>flatMap</code> \u3068\u30cd\u30b9\u30c8\u69cb\u9020\u306e\u5e73\u5766\u5316</li> <li>Vavr \u306e <code>For.yield()</code> \u306b\u3088\u308b\u5185\u5305\u8868\u8a18</li> </ul>"},{"location":"java/part-1/#_6","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"java/part-1/#1_1","title":"\u554f\u984c 1: \u7d14\u7c8b\u95a2\u6570\u306e\u8b58\u5225","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u306e\u3046\u3061\u3001\u7d14\u7c8b\u95a2\u6570\u306f\u3069\u308c\u3067\u3059\u304b?</p> <pre><code>// A\npublic static int doubleValue(int x) {\n    return x * 2;\n}\n\n// B\nprivate static int counter = 0;\npublic static int incrementCounter() {\n    counter++;\n    return counter;\n}\n\n// C\npublic static String greet(String name) {\n    return \"Hello, \" + name + \"!\";\n}\n\n// D\npublic static long currentTime() {\n    return System.currentTimeMillis();\n}\n</code></pre> \u89e3\u7b54  **A \u3068 C \u306f\u7d14\u7c8b\u95a2\u6570**\u3067\u3059\u3002  - A: \u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3057\u3001\u526f\u4f5c\u7528\u304c\u306a\u3044 - B: \u5916\u90e8\u5909\u6570 `counter` \u3092\u5909\u66f4\u3059\u308b\u526f\u4f5c\u7528\u304c\u3042\u308b\uff08\u4e0d\u7d14\uff09 - C: \u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3057\u3001\u526f\u4f5c\u7528\u304c\u306a\u3044 - D: \u547c\u3073\u51fa\u3059\u305f\u3073\u306b\u7570\u306a\u308b\u5024\u3092\u8fd4\u3059\uff08\u4e0d\u7d14\uff09"},{"location":"java/part-1/#2_1","title":"\u554f\u984c 2: \u7d14\u7c8b\u95a2\u6570\u3078\u306e\u66f8\u304d\u63db\u3048","text":"<p>\u4ee5\u4e0b\u306e\u4e0d\u7d14\u306a\u95a2\u6570\u3092\u7d14\u7c8b\u95a2\u6570\u306b\u66f8\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>public class Counter {\n    private int value = 0;\n\n    public int increment() {\n        value++;\n        return value;\n    }\n}\n</code></pre> \u89e3\u7b54 <pre><code>public static int increment(int value) {\n    return value + 1;\n}\n\n// \u4f7f\u7528\u4f8b\nint v1 = 0;\nint v2 = increment(v1);  // 1\nint v3 = increment(v2);  // 2\n</code></pre>  \u72b6\u614b\u3092\u5916\u90e8\u306b\u6301\u3061\u3001\u95a2\u6570\u306f\u5024\u3092\u53d7\u3051\u53d6\u3063\u3066\u65b0\u3057\u3044\u5024\u3092\u8fd4\u3059\u3060\u3051\u306b\u3057\u307e\u3059\u3002"},{"location":"java/part-1/#3-vavr-list","title":"\u554f\u984c 3: Vavr List \u3092\u4f7f\u3063\u305f\u30c6\u30b9\u30c8\u3092\u66f8\u304f","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u306b\u5bfe\u3059\u308b\u30c6\u30b9\u30c8\u30b1\u30fc\u30b9\u3092 JUnit + AssertJ \u3067\u66f8\u3044\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>public static boolean hasDiscount(List&lt;String&gt; items) {\n    return items.contains(\"Book\") || items.contains(\"Magazine\");\n}\n</code></pre> \u89e3\u7b54 <pre><code>@Test\nvoid hasDiscountTest() {\n    // \u7a7a\u306e\u30ea\u30b9\u30c8\n    assertThat(hasDiscount(List.empty())).isFalse();\n\n    // Book \u306e\u307f\n    assertThat(hasDiscount(List.of(\"Book\"))).isTrue();\n\n    // Magazine \u306e\u307f\n    assertThat(hasDiscount(List.of(\"Magazine\"))).isTrue();\n\n    // \u4e21\u65b9\n    assertThat(hasDiscount(List.of(\"Book\", \"Magazine\"))).isTrue();\n\n    // \u3069\u3061\u3089\u3082\u306a\u3044\n    assertThat(hasDiscount(List.of(\"Apple\", \"Orange\"))).isFalse();\n\n    // \u6df7\u5728\n    assertThat(hasDiscount(List.of(\"Apple\", \"Book\", \"Orange\"))).isTrue();\n}\n</code></pre>"},{"location":"java/part-1/#_7","title":"\u5b9f\u884c\u65b9\u6cd5","text":""},{"location":"java/part-1/#_8","title":"\u30c6\u30b9\u30c8\u306e\u5b9f\u884c","text":"<pre><code>cd app/java\n./gradlew test\n</code></pre>"},{"location":"java/part-1/#_9","title":"\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u306e\u5b9f\u884c","text":"<pre><code>cd app/java\n./gradlew run -PmainClass=ch01.IntroJava\n./gradlew run -PmainClass=ch02.PureFunctions\n./gradlew run -PmainClass=ch02.ShoppingCart\n./gradlew run -PmainClass=ch02.TipCalculator\n</code></pre>"},{"location":"java/part-2/","title":"Part II: \u95a2\u6570\u578b\u30b9\u30bf\u30a4\u30eb\u306e\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u6838\u5fc3\u3068\u306a\u308b\u30c6\u30af\u30cb\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059\u3002\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c\u3001\u9ad8\u968e\u95a2\u6570\u3001\u305d\u3057\u3066 <code>flatMap</code> \u306b\u3088\u308b\u8907\u96d1\u306a\u30c7\u30fc\u30bf\u5909\u63db\u3092 Vavr \u3092\u4f7f\u3063\u3066\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"java/part-2/#3","title":"\u7b2c3\u7ae0: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c","text":""},{"location":"java/part-2/#31","title":"3.1 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u3068\u306f","text":"<p>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\uff08\u4e0d\u5909\uff09\u3068\u306f\u3001\u4e00\u5ea6\u4f5c\u6210\u3055\u308c\u305f\u30c7\u30fc\u30bf\u304c\u5909\u66f4\u3055\u308c\u306a\u3044\u3053\u3068\u3092\u610f\u5473\u3057\u307e\u3059\u3002\u30c7\u30fc\u30bf\u3092\u300c\u5909\u66f4\u300d\u3059\u308b\u4ee3\u308f\u308a\u306b\u3001\u65b0\u3057\u3044\u30c7\u30fc\u30bf\u3092\u300c\u4f5c\u6210\u300d\u3057\u307e\u3059\u3002</p> <p></p>"},{"location":"java/part-2/#32-vavr-list","title":"3.2 Vavr List \u306e\u57fa\u672c\u64cd\u4f5c","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch03/ImmutableList.java</code></p>"},{"location":"java/part-2/#append-","title":"append - \u8981\u7d20\u306e\u8ffd\u52a0","text":"<pre><code>List&lt;String&gt; appleBook = List.of(\"Apple\", \"Book\");\nList&lt;String&gt; appleBookMango = appleBook.append(\"Mango\");\n\nassert appleBook.size() == 2;       // \u5143\u306e\u30ea\u30b9\u30c8\u306f\u5909\u308f\u3089\u306a\u3044\nassert appleBookMango.size() == 3;  // \u65b0\u3057\u3044\u30ea\u30b9\u30c8\u304c\u4f5c\u6210\u3055\u308c\u308b\nassert appleBookMango.equals(List.of(\"Apple\", \"Book\", \"Mango\"));\n</code></pre>"},{"location":"java/part-2/#take-drop-","title":"take / drop - \u30ea\u30b9\u30c8\u306e\u5207\u308a\u51fa\u3057","text":"<pre><code>public static List&lt;String&gt; firstTwo(List&lt;String&gt; list) {\n    return list.take(2);\n}\n\npublic static List&lt;String&gt; lastTwo(List&lt;String&gt; list) {\n    return list.takeRight(2);\n}\n\npublic static &lt;T&gt; List&lt;T&gt; slice(List&lt;T&gt; list, int start, int end) {\n    return list.drop(start).take(end - start);\n}\n\n// \u4f7f\u7528\u4f8b\nList&lt;String&gt; fruits = List.of(\"a\", \"b\", \"c\", \"d\");\nassert firstTwo(fruits).equals(List.of(\"a\", \"b\"));\nassert lastTwo(fruits).equals(List.of(\"c\", \"d\"));\nassert slice(fruits, 1, 3).equals(List.of(\"b\", \"c\"));\n</code></pre>"},{"location":"java/part-2/#33","title":"3.3 \u30ea\u30b9\u30c8\u306e\u5909\u63db\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch03/ImmutableList.java</code></p> <pre><code>// \u6700\u521d\u306e2\u8981\u7d20\u3092\u672b\u5c3e\u306b\u79fb\u52d5\npublic static List&lt;String&gt; movedFirstTwoToTheEnd(List&lt;String&gt; list) {\n    List&lt;String&gt; firstTwo = list.take(2);\n    List&lt;String&gt; withoutFirstTwo = list.drop(2);\n    return withoutFirstTwo.appendAll(firstTwo);\n}\n\nassert movedFirstTwoToTheEnd(List.of(\"a\", \"b\", \"c\")).equals(List.of(\"c\", \"a\", \"b\"));\n\n// \u6700\u5f8c\u306e\u8981\u7d20\u306e\u524d\u306b\u633f\u5165\npublic static List&lt;String&gt; insertedBeforeLast(List&lt;String&gt; list, String element) {\n    List&lt;String&gt; withoutLast = list.dropRight(1);\n    List&lt;String&gt; last = list.takeRight(1);\n    return withoutLast.append(element).appendAll(last);\n}\n\nassert insertedBeforeLast(List.of(\"a\", \"b\"), \"c\").equals(List.of(\"a\", \"c\", \"b\"));\n</code></pre>"},{"location":"java/part-2/#34","title":"3.4 \u65c5\u7a0b\u306e\u518d\u8a08\u753b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch03/Itinerary.java</code></p> <p>\u65c5\u884c\u306e\u8a08\u753b\u5909\u66f4\u3092\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306b\u884c\u3046\u4f8b\u3067\u3059\u3002</p> <pre><code>public static List&lt;String&gt; replan(List&lt;String&gt; plan, String newCity, String beforeCity) {\n    int beforeCityIndex = plan.indexOf(beforeCity);\n    List&lt;String&gt; citiesBefore = plan.take(beforeCityIndex);\n    List&lt;String&gt; citiesAfter = plan.drop(beforeCityIndex);\n    return citiesBefore.append(newCity).appendAll(citiesAfter);\n}\n\nList&lt;String&gt; planA = List.of(\"Paris\", \"Berlin\", \"Krak\u00f3w\");\nList&lt;String&gt; planB = replan(planA, \"Vienna\", \"Krak\u00f3w\");\n\nassert planB.equals(List.of(\"Paris\", \"Berlin\", \"Vienna\", \"Krak\u00f3w\"));\nassert planA.equals(List.of(\"Paris\", \"Berlin\", \"Krak\u00f3w\"));  // \u5143\u306e\u8a08\u753b\u306f\u5909\u308f\u3089\u306a\u3044!\n</code></pre> <p></p>"},{"location":"java/part-2/#4","title":"\u7b2c4\u7ae0: \u95a2\u6570\u3092\u5024\u3068\u3057\u3066\u6271\u3046","text":""},{"location":"java/part-2/#41","title":"4.1 \u9ad8\u968e\u95a2\u6570\u3068\u306f","text":"<p>\u9ad8\u968e\u95a2\u6570\uff08Higher-Order Function\uff09\u3068\u306f\u3001\u4ee5\u4e0b\u306e\u3044\u305a\u308c\u304b\u3092\u6e80\u305f\u3059\u95a2\u6570\u3067\u3059:</p> <ol> <li>\u95a2\u6570\u3092\u5f15\u6570\u3068\u3057\u3066\u53d7\u3051\u53d6\u308b</li> <li>\u95a2\u6570\u3092\u623b\u308a\u5024\u3068\u3057\u3066\u8fd4\u3059</li> </ol> <p></p>"},{"location":"java/part-2/#42","title":"4.2 \u95a2\u6570\u3092\u5f15\u6570\u3068\u3057\u3066\u6e21\u3059","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch04/HigherOrderFunctions.java</code></p>"},{"location":"java/part-2/#sortby-","title":"sortBy - \u30bd\u30fc\u30c8\u57fa\u6e96\u3092\u95a2\u6570\u3067\u6307\u5b9a","text":"<pre><code>public static int score(String word) {\n    return word.replaceAll(\"a\", \"\").length();\n}\n\nList&lt;String&gt; words = List.of(\"rust\", \"java\");\nList&lt;String&gt; sortedWords = words.sortBy(HigherOrderFunctions::score);\n\nassert sortedWords.equals(List.of(\"java\", \"rust\"));\n// java: 2\u6587\u5b57 (j, v), rust: 4\u6587\u5b57 (r, u, s, t)\n</code></pre>"},{"location":"java/part-2/#map-","title":"map - \u5404\u8981\u7d20\u3092\u5909\u63db","text":"<pre><code>public static int len(String s) {\n    return s.length();\n}\n\nList&lt;Integer&gt; lengths = List.of(\"scala\", \"rust\", \"ada\").map(HigherOrderFunctions::len);\nassert lengths.equals(List.of(5, 4, 3));\n\npublic static int doubleValue(int i) {\n    return 2 * i;\n}\n\nList&lt;Integer&gt; doubles = List.of(5, 1, 2, 4, 0).map(HigherOrderFunctions::doubleValue);\nassert doubles.equals(List.of(10, 2, 4, 8, 0));\n</code></pre>"},{"location":"java/part-2/#filter-","title":"filter - \u6761\u4ef6\u306b\u5408\u3046\u8981\u7d20\u3092\u62bd\u51fa","text":"<pre><code>public static boolean isOdd(int i) {\n    return i % 2 == 1;\n}\n\nList&lt;Integer&gt; odds = List.of(5, 1, 2, 4, 0).filter(HigherOrderFunctions::isOdd);\nassert odds.equals(List.of(5, 1));\n\npublic static boolean isLargerThan4(int i) {\n    return i &gt; 4;\n}\n\nList&lt;Integer&gt; large = List.of(5, 1, 2, 4, 0).filter(HigherOrderFunctions::isLargerThan4);\nassert large.equals(List.of(5));\n</code></pre>"},{"location":"java/part-2/#foldleft-","title":"foldLeft - \u7573\u307f\u8fbc\u307f","text":"<pre><code>List&lt;Integer&gt; numbers = List.of(5, 1, 2, 4, 100);\nint sum = numbers.foldLeft(0, (acc, i) -&gt; acc + i);\nassert sum == 112;\n\nint max = List.of(5, 1, 2, 4, 15).foldLeft(Integer.MIN_VALUE, (m, i) -&gt; i &gt; m ? i : m);\nassert max == 15;\n</code></pre>"},{"location":"java/part-2/#43-record","title":"4.3 record \u3068\u30e1\u30bd\u30c3\u30c9\u53c2\u7167","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch04/ProgrammingLanguage.java</code></p> <p>Java \u306e record \u3092\u4f7f\u3063\u305f\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u30af\u30e9\u30b9\u306e\u4f8b\u3067\u3059\u3002</p> <pre><code>public record ProgrammingLanguage(String name, int year) {}\n\nProgrammingLanguage java = new ProgrammingLanguage(\"Java\", 1995);\nProgrammingLanguage scala = new ProgrammingLanguage(\"Scala\", 2004);\n\nList&lt;ProgrammingLanguage&gt; languages = List.of(java, scala);\n\n// \u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u30a2\u30af\u30bb\u30b9\nList&lt;String&gt; names = languages.map(ProgrammingLanguage::name);\nassert names.equals(List.of(\"Java\", \"Scala\"));\n\n// \u6761\u4ef6\u3067\u30d5\u30a3\u30eb\u30bf\nList&lt;ProgrammingLanguage&gt; young = languages.filter(lang -&gt; lang.year() &gt; 2000);\nassert young.equals(List.of(scala));\n</code></pre>"},{"location":"java/part-2/#44","title":"4.4 \u95a2\u6570\u3092\u8fd4\u3059\u95a2\u6570","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch04/HigherOrderFunctions.java</code></p> <pre><code>public static Predicate&lt;Integer&gt; largerThan(int n) {\n    return i -&gt; i &gt; n;\n}\n\nList&lt;Integer&gt; large = List.of(5, 1, 2, 4, 0).filter(largerThan(4));\nassert large.equals(List.of(5));\n\nList&lt;Integer&gt; medium = List.of(5, 1, 2, 4, 0).filter(largerThan(1));\nassert medium.equals(List.of(5, 2, 4));\n</code></pre> <p></p>"},{"location":"java/part-2/#45","title":"4.5 \u30ef\u30fc\u30c9\u30b9\u30b3\u30a2\u30ea\u30f3\u30b0\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch04/WordScoring.java</code></p> <p>\u8907\u6570\u306e\u30b9\u30b3\u30a2\u30ea\u30f3\u30b0\u30ed\u30b8\u30c3\u30af\u3092\u7d44\u307f\u5408\u308f\u305b\u308b\u4f8b\u3067\u3059\u3002</p> <pre><code>public static int score(String word) {\n    return word.replaceAll(\"a\", \"\").length();\n}\n\npublic static int bonus(String word) {\n    return word.contains(\"c\") ? 5 : 0;\n}\n\npublic static int penalty(String word) {\n    return word.contains(\"s\") ? 7 : 0;\n}\n\nList&lt;String&gt; words = List.of(\"ada\", \"haskell\", \"scala\", \"java\", \"rust\");\n\n// \u95a2\u6570\u3092\u5f15\u6570\u3068\u3057\u3066\u6e21\u3059\npublic static List&lt;String&gt; rankedWords(Function&lt;String, Integer&gt; wordScore, List&lt;String&gt; words) {\n    return words.sortBy(wordScore).reverse();\n}\n\n// \u57fa\u672c\u30b9\u30b3\u30a2\u3067\u30e9\u30f3\u30ad\u30f3\u30b0\nList&lt;String&gt; ranking1 = rankedWords(WordScoring::score, words);\nassert ranking1.equals(List.of(\"haskell\", \"rust\", \"scala\", \"java\", \"ada\"));\n\n// \u30dc\u30fc\u30ca\u30b9\u4ed8\u304d\u30b9\u30b3\u30a2\u3067\u30e9\u30f3\u30ad\u30f3\u30b0\nList&lt;String&gt; ranking2 = rankedWords(w -&gt; score(w) + bonus(w), words);\nassert ranking2.equals(List.of(\"scala\", \"haskell\", \"rust\", \"java\", \"ada\"));\n\n// \u30dc\u30fc\u30ca\u30b9\u3068\u30da\u30ca\u30eb\u30c6\u30a3\u4ed8\u304d\u30b9\u30b3\u30a2\u3067\u30e9\u30f3\u30ad\u30f3\u30b0\nList&lt;String&gt; ranking3 = rankedWords(w -&gt; score(w) + bonus(w) - penalty(w), words);\n// java \u304c1\u4f4d\n</code></pre>"},{"location":"java/part-2/#5-flatmap","title":"\u7b2c5\u7ae0: flatMap \u3068\u30cd\u30b9\u30c8\u69cb\u9020","text":""},{"location":"java/part-2/#51-flatten-flatmap","title":"5.1 flatten \u3068 flatMap","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch05/FlatMapExamples.java</code></p>"},{"location":"java/part-2/#flatten-","title":"flatten - \u30cd\u30b9\u30c8\u3057\u305f\u30ea\u30b9\u30c8\u3092\u5e73\u5766\u5316","text":"<pre><code>List&lt;List&lt;Integer&gt;&gt; nested = List.of(\n    List.of(1, 2),\n    List.of(3, 4, 5),\n    List.of(6)\n);\n\n// flatMap \u3067\u5e73\u5766\u5316\nList&lt;Integer&gt; flat = nested.flatMap(x -&gt; x);\n// List(1, 2, 3, 4, 5, 6)\n</code></pre>"},{"location":"java/part-2/#flatmap-map-flatten","title":"flatMap = map + flatten","text":"<pre><code>// \u66f8\u7c4d\u3068\u6620\u753b\u5316\u306e\u4f8b\npublic record Book(String title, List&lt;String&gt; authors) {}\n\nList&lt;Book&gt; books = List.of(\n    new Book(\"FP in Scala\", List.of(\"Chiusano\", \"Bjarnason\")),\n    new Book(\"The Hobbit\", List.of(\"Tolkien\"))\n);\n\n// map \u3060\u3051\u3060\u3068\u30cd\u30b9\u30c8\u3059\u308b\nList&lt;List&lt;String&gt;&gt; authorLists = books.map(Book::authors);\n// List(List(\"Chiusano\", \"Bjarnason\"), List(\"Tolkien\"))\n\n// flatMap \u3067\u5e73\u5766\u5316\nList&lt;String&gt; authors = books.flatMap(Book::authors);\n// List(\"Chiusano\", \"Bjarnason\", \"Tolkien\")\n</code></pre>"},{"location":"java/part-2/#52-flatmap","title":"5.2 flatMap \u306b\u3088\u308b\u30ea\u30b9\u30c8\u30b5\u30a4\u30ba\u306e\u5909\u5316","text":"<pre><code>// \u8981\u7d20\u6570\u304c\u5897\u3048\u308b\nList.of(1, 2, 3).flatMap(i -&gt; List.of(i, i + 10));\n// List(1, 11, 2, 12, 3, 13) - 6\u8981\u7d20\n\n// \u8981\u7d20\u6570\u304c\u540c\u3058\nList.of(1, 2, 3).flatMap(i -&gt; List.of(i * 2));\n// List(2, 4, 6) - 3\u8981\u7d20\n\n// \u8981\u7d20\u6570\u304c\u6e1b\u308b\uff08\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u52b9\u679c\uff09\nList.of(1, 2, 3).flatMap(i -&gt; i % 2 == 0 ? List.of(i) : List.empty());\n// List(2) - 1\u8981\u7d20\n</code></pre>"},{"location":"java/part-2/#53-flatmap","title":"5.3 \u30cd\u30b9\u30c8\u3057\u305f flatMap","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch05/BookAdaptations.java</code></p> <p>\u8907\u6570\u306e\u30ea\u30b9\u30c8\u3092\u7d44\u307f\u5408\u308f\u305b\u308b\u5834\u5408\u3001flatMap \u3092\u30cd\u30b9\u30c8\u3057\u307e\u3059\u3002</p> <pre><code>public record Book(String title, List&lt;String&gt; authors) {}\npublic record Movie(String title) {}\n\npublic static List&lt;Movie&gt; bookAdaptations(String author) {\n    if (\"Tolkien\".equals(author)) {\n        return List.of(\n            new Movie(\"An Unexpected Journey\"),\n            new Movie(\"The Desolation of Smaug\")\n        );\n    }\n    return List.empty();\n}\n\nList&lt;Book&gt; books = List.of(\n    new Book(\"FP in Scala\", List.of(\"Chiusano\", \"Bjarnason\")),\n    new Book(\"The Hobbit\", List.of(\"Tolkien\"))\n);\n\n// \u30cd\u30b9\u30c8\u3057\u305f flatMap\nList&lt;String&gt; recommendations = books.flatMap(book -&gt;\n    book.authors().flatMap(author -&gt;\n        bookAdaptations(author).map(movie -&gt;\n            String.format(\"You may like %s, because you liked %s's %s\",\n                movie.title(), author, book.title())\n        )\n    )\n);\n\n// \u7d50\u679c:\n// List(\n//   \"You may like An Unexpected Journey, because you liked Tolkien's The Hobbit\",\n//   \"You may like The Desolation of Smaug, because you liked Tolkien's The Hobbit\"\n// )\n</code></pre> <p></p>"},{"location":"java/part-2/#54-java-for","title":"5.4 Java \u3067\u306e for \u5185\u5305\u8868\u8a18\u306e\u4ee3\u66ff","text":"<p>Scala \u306e for \u5185\u5305\u8868\u8a18\u306b\u76f8\u5f53\u3059\u308b\u6a5f\u80fd\u306f\u3001Java \u3067\u306f flatMap \u306e\u30c1\u30a7\u30fc\u30f3\u3067\u8868\u73fe\u3057\u307e\u3059\u3002</p> <pre><code>// flatMap/map \u7248\nList&lt;String&gt; c1 = books.flatMap(book -&gt;\n    book.authors().flatMap(author -&gt;\n        bookAdaptations(author).map(movie -&gt;\n            String.format(\"You may like %s, because you liked %s's %s\",\n                movie.title(), author, book.title())\n        )\n    )\n);\n\n// Vavr \u306e Iterator \u3092\u4f7f\u3063\u305f\u7248\uff08\u540c\u7b49\uff09\nList&lt;String&gt; c2 = Iterator.ofAll(books)\n    .flatMap(book -&gt; Iterator.ofAll(book.authors())\n        .flatMap(author -&gt; Iterator.ofAll(bookAdaptations(author))\n            .map(movie -&gt; String.format(\n                \"You may like %s, because you liked %s's %s\",\n                movie.title(), author, book.title()))))\n    .toList();\n</code></pre>"},{"location":"java/part-2/#55","title":"5.5 \u5186\u5185\u306e\u70b9\u306e\u5224\u5b9a","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch05/PointsInsideCircles.java</code></p> <p>flatMap \u3092\u4f7f\u3063\u305f\u7d44\u307f\u5408\u308f\u305b\u751f\u6210\u3068\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u306e\u4f8b\u3067\u3059\u3002</p> <pre><code>public record Point(int x, int y) {}\n\nList&lt;Point&gt; points = List.of(new Point(5, 2), new Point(1, 1));\nList&lt;Integer&gt; radiuses = List.of(2, 1);\n\npublic static boolean isInside(Point point, int radius) {\n    return radius * radius &gt;= point.x() * point.x() + point.y() * point.y();\n}\n\n// \u5168\u7d44\u307f\u5408\u308f\u305b\u3092\u751f\u6210\nList&lt;String&gt; allCombinations = radiuses.flatMap(r -&gt;\n    points.map(point -&gt;\n        String.format(\"%s is within radius %d: %s\", point, r, isInside(point, r))\n    )\n);\n\n// \u7d50\u679c:\n// List(\n//   \"(5, 2) is within radius 2: false\",\n//   \"(1, 1) is within radius 2: true\",\n//   \"(5, 2) is within radius 1: false\",\n//   \"(1, 1) is within radius 1: false\"\n// )\n</code></pre>"},{"location":"java/part-2/#_1","title":"\u30ac\u30fc\u30c9\u5f0f\u76f8\u5f53\u306e\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0","text":"<pre><code>// \u5186\u5185\u306e\u70b9\u306e\u307f\u3092\u53d6\u5f97\uff08\u30ac\u30fc\u30c9\u5f0f\u76f8\u5f53\uff09\nList&lt;String&gt; inside = radiuses.flatMap(r -&gt;\n    points.filter(point -&gt; isInside(point, r))\n        .map(point -&gt; String.format(\"%s is inside circle with radius %d\", point, r))\n);\n</code></pre>"},{"location":"java/part-2/#_2","title":"\u307e\u3068\u3081","text":""},{"location":"java/part-2/#_3","title":"\u5b66\u3093\u3060\u3053\u3068","text":"<ol> <li>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c</li> <li>Vavr \u306e <code>List</code> \u306f\u4e0d\u5909</li> <li><code>take</code>, <code>drop</code>, <code>append</code>, <code>appendAll</code> \u3067\u65b0\u3057\u3044\u30ea\u30b9\u30c8\u3092\u4f5c\u6210</li> <li> <p>\u5143\u306e\u30c7\u30fc\u30bf\u306f\u5909\u66f4\u3055\u308c\u306a\u3044</p> </li> <li> <p>\u9ad8\u968e\u95a2\u6570</p> </li> <li><code>map</code>: \u5404\u8981\u7d20\u3092\u5909\u63db</li> <li><code>filter</code>: \u6761\u4ef6\u306b\u5408\u3046\u8981\u7d20\u3092\u62bd\u51fa</li> <li><code>foldLeft</code>: \u7573\u307f\u8fbc\u307f</li> <li> <p><code>sortBy</code>: \u30bd\u30fc\u30c8\u57fa\u6e96\u3092\u95a2\u6570\u3067\u6307\u5b9a</p> </li> <li> <p>\u95a2\u6570\u3092\u8fd4\u3059\u95a2\u6570</p> </li> <li><code>Predicate&lt;T&gt;</code> \u3092\u8fd4\u3059\u3053\u3068\u3067\u518d\u5229\u7528\u53ef\u80fd\u306a\u30d5\u30a3\u30eb\u30bf\u3092\u4f5c\u6210</li> <li> <p>\u90e8\u5206\u9069\u7528\u306e\u3088\u3046\u306a\u52b9\u679c\u3092\u5f97\u3089\u308c\u308b</p> </li> <li> <p>flatMap</p> </li> <li>\u30cd\u30b9\u30c8\u3057\u305f\u30ea\u30b9\u30c8\u3092\u5e73\u5766\u5316</li> <li><code>map</code> + <code>flatten</code> \u306e\u7d44\u307f\u5408\u308f\u305b</li> <li>\u30ea\u30b9\u30c8\u30b5\u30a4\u30ba\u304c\u5897\u6e1b\u3059\u308b\u5909\u63db\u306b\u5bfe\u5fdc</li> </ol>"},{"location":"java/part-2/#scala","title":"Scala \u3068\u306e\u5bfe\u5fdc","text":"Scala Java + Vavr <code>List</code> <code>io.vavr.collection.List</code> <code>slice(a, b)</code> <code>drop(a).take(b - a)</code> <code>appended</code> <code>append</code> <code>appendedAll</code> <code>appendAll</code> <code>sortBy</code> <code>sortBy</code> <code>map</code> <code>map</code> <code>filter</code> <code>filter</code> <code>foldLeft</code> <code>foldLeft</code> <code>flatMap</code> <code>flatMap</code> <code>for {...} yield</code> <code>flatMap</code> \u306e\u30c1\u30a7\u30fc\u30f3"},{"location":"java/part-2/#_4","title":"\u6b21\u306e\u30d1\u30fc\u30c8","text":"<p>Part III \u3067\u306f\u3001\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u306b\u3064\u3044\u3066\u5b66\u3073\u307e\u3059\u3002<code>Option</code> \u3068 <code>Either</code> \u3092\u4f7f\u3063\u305f\u5b89\u5168\u306a\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u624b\u6cd5\u3092\u7d39\u4ecb\u3057\u307e\u3059\u3002</p>"},{"location":"java/part-3/","title":"Part III: \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3068 Option/Either","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3092\u5b66\u3073\u307e\u3059\u3002<code>null</code> \u3084\u4f8b\u5916\u306b\u983c\u3089\u305a\u3001Vavr \u306e <code>Option</code> \u3068 <code>Either</code> \u3092\u4f7f\u3063\u3066\u578b\u5b89\u5168\u306b\u30a8\u30e9\u30fc\u3092\u6271\u3046\u65b9\u6cd5\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"java/part-3/#6-option","title":"\u7b2c6\u7ae0: Option \u578b\u306b\u3088\u308b\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":""},{"location":"java/part-3/#61-option","title":"6.1 \u306a\u305c Option \u304c\u5fc5\u8981\u304b","text":"<p>\u5f93\u6765\u306e\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u306b\u306f\u554f\u984c\u304c\u3042\u308a\u307e\u3059\u3002</p> <p></p>"},{"location":"java/part-3/#62-option","title":"6.2 Option \u306e\u57fa\u672c","text":"<p><code>Option&lt;A&gt;</code> \u306f\u300c<code>A</code> \u578b\u306e\u5024\u304c\u3042\u308b\u304b\u3001\u306a\u3044\u304b\u300d\u3092\u8868\u3059\u578b\u3067\u3059\u3002</p> <p></p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch06/OptionBasics.java</code></p> <pre><code>import io.vavr.control.Option;\n\n// Some: \u5024\u304c\u5b58\u5728\u3059\u308b\nOption&lt;Integer&gt; some = Option.some(42);\n\n// None: \u5024\u304c\u5b58\u5728\u3057\u306a\u3044\nOption&lt;Integer&gt; none = Option.none();\n\n// null \u304b\u3089\u5b89\u5168\u306b\u4f5c\u6210\nOption&lt;String&gt; fromNull = Option.of(maybeNull); // null \u306a\u3089 None\n</code></pre>"},{"location":"java/part-3/#63-tv","title":"6.3 TV\u756a\u7d44\u306e\u30d1\u30fc\u30b9\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch06/TvShowParser.java</code></p> <p>TV\u756a\u7d44\u306e\u6587\u5b57\u5217\u3092\u30d1\u30fc\u30b9\u3059\u308b\u4f8b\u3067 Option \u306e\u4f7f\u3044\u65b9\u3092\u5b66\u3073\u307e\u3059\u3002</p> <pre><code>public record TvShow(String title, int start, int end) {}\n\n// \u5165\u529b\u4f8b: \"Breaking Bad (2008-2013)\"\n// \u671f\u5f85\u3059\u308b\u51fa\u529b: TvShow(\"Breaking Bad\", 2008, 2013)\n</code></pre>"},{"location":"java/part-3/#_1","title":"\u4f8b\u5916\u3092\u4f7f\u3046\u65b9\u6cd5\uff08\u554f\u984c\u3042\u308a\uff09","text":"<pre><code>public static TvShow parseShowUnsafe(String rawShow) {\n    int bracketOpen = rawShow.indexOf('(');\n    int bracketClose = rawShow.indexOf(')');\n    int dash = rawShow.indexOf('-');\n\n    String name = rawShow.substring(0, bracketOpen).trim();\n    int yearStart = Integer.parseInt(rawShow.substring(bracketOpen + 1, dash));\n    int yearEnd = Integer.parseInt(rawShow.substring(dash + 1, bracketClose));\n\n    return new TvShow(name, yearStart, yearEnd);\n}\n\n// \u6b63\u5e38\u30b1\u30fc\u30b9\nparseShowUnsafe(\"Breaking Bad (2008-2013)\");  // TvShow(\"Breaking Bad\", 2008, 2013)\n\n// \u7570\u5e38\u30b1\u30fc\u30b9 \u2192 \u4f8b\u5916\u304c\u30b9\u30ed\u30fc\u3055\u308c\u308b!\nparseShowUnsafe(\"Chernobyl (2019)\");           // StringIndexOutOfBoundsException\nparseShowUnsafe(\"The Wire 2002-2008\");         // StringIndexOutOfBoundsException\n</code></pre>"},{"location":"java/part-3/#option","title":"Option \u3092\u4f7f\u3046\u65b9\u6cd5","text":"<pre><code>public static Option&lt;TvShow&gt; parseShow(String rawShow) {\n    return extractName(rawShow).flatMap(name -&gt;\n        extractYearStart(rawShow).orElse(() -&gt; extractSingleYear(rawShow)).flatMap(yearStart -&gt;\n            extractYearEnd(rawShow).orElse(() -&gt; extractSingleYear(rawShow)).map(yearEnd -&gt;\n                new TvShow(name, yearStart, yearEnd)\n            )\n        )\n    );\n}\n\n// \u6b63\u5e38\u30b1\u30fc\u30b9\nparseShow(\"Breaking Bad (2008-2013)\");  // Some(TvShow(\"Breaking Bad\", 2008, 2013))\n\n// \u7570\u5e38\u30b1\u30fc\u30b9 \u2192 None \u304c\u8fd4\u3055\u308c\u308b\uff08\u4f8b\u5916\u306a\u3057\uff09\nparseShow(\"The Wire 2002-2008\");         // None\n</code></pre>"},{"location":"java/part-3/#64","title":"6.4 \u5c0f\u3055\u306a\u95a2\u6570\u304b\u3089\u7d44\u307f\u7acb\u3066\u308b","text":"<p>\u8907\u96d1\u306a\u30d1\u30fc\u30b9\u51e6\u7406\u3092\u5c0f\u3055\u306a\u95a2\u6570\u306b\u5206\u89e3\u3057\u307e\u3059\u3002</p> <pre><code>// \u540d\u524d\u3092\u62bd\u51fa\npublic static Option&lt;String&gt; extractName(String rawShow) {\n    int bracketOpen = rawShow.indexOf('(');\n    if (bracketOpen &gt; 0) {\n        return Option.some(rawShow.substring(0, bracketOpen).trim());\n    }\n    return Option.none();\n}\n\n// \u958b\u59cb\u5e74\u3092\u62bd\u51fa\npublic static Option&lt;Integer&gt; extractYearStart(String rawShow) {\n    int bracketOpen = rawShow.indexOf('(');\n    int dash = rawShow.indexOf('-');\n\n    if (bracketOpen != -1 &amp;&amp; dash &gt; bracketOpen + 1) {\n        String yearStr = rawShow.substring(bracketOpen + 1, dash);\n        return parseYear(yearStr);\n    }\n    return Option.none();\n}\n\n// \u6587\u5b57\u5217\u3092\u5e74\uff08\u6574\u6570\uff09\u306b\u30d1\u30fc\u30b9\npublic static Option&lt;Integer&gt; parseYear(String yearStr) {\n    try {\n        return Option.some(Integer.parseInt(yearStr.trim()));\n    } catch (NumberFormatException e) {\n        return Option.none();\n    }\n}\n</code></pre>"},{"location":"java/part-3/#65-orelse","title":"6.5 orElse \u306b\u3088\u308b\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af","text":"<p><code>orElse</code> \u3092\u4f7f\u3063\u3066\u3001\u6700\u521d\u306e Option \u304c <code>None</code> \u306e\u5834\u5408\u306b\u4ee3\u66ff\u3092\u8a66\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>Option&lt;Integer&gt; seven = Option.some(7);\nOption&lt;Integer&gt; eight = Option.some(8);\nOption&lt;Integer&gt; none = Option.none();\n\nseven.orElse(eight);  // Some(7) - \u6700\u521d\u304c Some \u306a\u306e\u3067\u305d\u306e\u307e\u307e\nnone.orElse(eight);   // Some(8) - \u6700\u521d\u304c None \u306a\u306e\u3067\u4ee3\u66ff\u3092\u4f7f\u7528\nseven.orElse(none);   // Some(7)\nnone.orElse(none);    // None\n</code></pre>"},{"location":"java/part-3/#_2","title":"\u5358\u5e74\u306e\u756a\u7d44\u306b\u5bfe\u5fdc\u3059\u308b","text":"<p>\u300cChernobyl (2019)\u300d\u306e\u3088\u3046\u306a\u5358\u5e74\u306e\u756a\u7d44\u3092\u30d1\u30fc\u30b9\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002</p> <pre><code>public static Option&lt;Integer&gt; extractSingleYear(String rawShow) {\n    int dash = rawShow.indexOf('-');\n    int bracketOpen = rawShow.indexOf('(');\n    int bracketClose = rawShow.indexOf(')');\n\n    if (dash == -1 &amp;&amp; bracketOpen != -1 &amp;&amp; bracketClose &gt; bracketOpen + 1) {\n        String yearStr = rawShow.substring(bracketOpen + 1, bracketClose);\n        return parseYear(yearStr);\n    }\n    return Option.none();\n}\n\n// \u3053\u308c\u3067\u5358\u5e74\u306e\u756a\u7d44\u3082\u30d1\u30fc\u30b9\u3067\u304d\u308b\nparseShow(\"Chernobyl (2019)\");  // Some(TvShow(\"Chernobyl\", 2019, 2019))\n</code></pre>"},{"location":"java/part-3/#66-option","title":"6.6 Option \u306e\u4e3b\u8981\u30e1\u30bd\u30c3\u30c9","text":"\u30e1\u30bd\u30c3\u30c9 \u8aac\u660e \u4f8b <code>map</code> \u5024\u304c\u3042\u308c\u3070\u5909\u63db <code>Some(5).map(x -&gt; x * 2)</code> \u2192 <code>Some(10)</code> <code>flatMap</code> \u5024\u304c\u3042\u308c\u3070 Option \u3092\u8fd4\u3059\u95a2\u6570\u3092\u9069\u7528 <code>Some(5).flatMap(x -&gt; Some(x * 2))</code> \u2192 <code>Some(10)</code> <code>filter</code> \u6761\u4ef6\u3092\u6e80\u305f\u3055\u306a\u3051\u308c\u3070 None <code>Some(5).filter(x -&gt; x &gt; 10)</code> \u2192 <code>None</code> <code>orElse</code> None \u306a\u3089\u4ee3\u66ff\u3092\u4f7f\u7528 <code>None.orElse(Some(5))</code> \u2192 <code>Some(5)</code> <code>getOrElse</code> None \u306a\u3089\u30c7\u30d5\u30a9\u30eb\u30c8\u5024 <code>None.getOrElse(0)</code> \u2192 <code>0</code> <code>toList</code> List \u306b\u5909\u63db <code>Some(5).toList()</code> \u2192 <code>List(5)</code> <code>toEither</code> Either \u306b\u5909\u63db <code>Some(5).toEither(\"error\")</code> \u2192 <code>Right(5)</code> <pre><code>Option&lt;Integer&gt; year = Option.some(996);\nOption&lt;Integer&gt; noYear = Option.none();\n\n// map\nyear.map(y -&gt; y * 2);    // Some(1992)\nnoYear.map(y -&gt; y * 2);  // None\n\n// flatMap\nyear.flatMap(y -&gt; Option.some(y * 2));    // Some(1992)\nnoYear.flatMap(y -&gt; Option.some(y * 2));  // None\n\n// filter\nyear.filter(y -&gt; y &lt; 2020);   // Some(996)\nyear.filter(y -&gt; y &gt; 2020);   // None\n\n// getOrElse\nyear.getOrElse(2020);    // 996\nnoYear.getOrElse(2020);  // 2020\n</code></pre>"},{"location":"java/part-3/#67","title":"6.7 \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u6226\u7565","text":"<p>\u8907\u6570\u306e\u8981\u7d20\u3092\u30d1\u30fc\u30b9\u3059\u308b\u5834\u5408\u30012\u3064\u306e\u6226\u7565\u304c\u3042\u308a\u307e\u3059\u3002</p> <p></p>"},{"location":"java/part-3/#best-effort","title":"Best-effort \u6226\u7565","text":"<pre><code>public static List&lt;TvShow&gt; parseShowsBestEffort(List&lt;String&gt; rawShows) {\n    return rawShows\n        .map(TvShowParser::parseShow)\n        .flatMap(Option::toList);\n}\n\nList&lt;String&gt; rawShows = List.of(\n    \"Breaking Bad (2008-2013)\",\n    \"The Wire 2002 2008\",        // \u7121\u52b9\u306a\u5f62\u5f0f\n    \"Mad Men (2007-2015)\"\n);\n\nparseShowsBestEffort(rawShows);\n// List(TvShow(\"Breaking Bad\", 2008, 2013), TvShow(\"Mad Men\", 2007, 2015))\n// \u7121\u52b9\u306a\u3082\u306e\u306f\u7121\u8996\u3055\u308c\u308b\n</code></pre>"},{"location":"java/part-3/#all-or-nothing","title":"All-or-nothing \u6226\u7565","text":"<pre><code>public static Option&lt;List&lt;TvShow&gt;&gt; parseShowsAllOrNothing(List&lt;String&gt; rawShows) {\n    Option&lt;List&lt;TvShow&gt;&gt; initial = Option.some(List.empty());\n\n    return rawShows\n        .map(TvShowParser::parseShow)\n        .foldLeft(initial, (acc, optShow) -&gt;\n            acc.flatMap(shows -&gt;\n                optShow.map(shows::append)\n            )\n        );\n}\n\n// \u5168\u90e8\u6210\u529f \u2192 Some(List(...))\nparseShowsAllOrNothing(List.of(\"Breaking Bad (2008-2013)\", \"Mad Men (2007-2015)\"));\n// Some(List(TvShow(...), TvShow(...)))\n\n// \u4e00\u3064\u3067\u3082\u5931\u6557 \u2192 None\nparseShowsAllOrNothing(List.of(\"Breaking Bad (2008-2013)\", \"Invalid\"));\n// None\n</code></pre>"},{"location":"java/part-3/#68-forall-exists","title":"6.8 forall \u3068 exists","text":"<p>Option \u3067\u6761\u4ef6\u5224\u5b9a\u3092\u3059\u308b\u969b\u306b\u4fbf\u5229\u306a\u30e1\u30bd\u30c3\u30c9\u3067\u3059\u3002</p> \u30e1\u30bd\u30c3\u30c9 Option \u3067\u306e\u52d5\u4f5c <code>forAll(p)</code> None \u2192 true, Some(x) \u2192 p(x) <code>exists(p)</code> None \u2192 false, Some(x) \u2192 p(x) <pre><code>Option&lt;Integer&gt; year = Option.some(996);\nOption&lt;Integer&gt; noYear = Option.none();\n\n// forAll - \u300c\u5168\u3066\u300d\u307e\u305f\u306f\u300c\u5b58\u5728\u3057\u306a\u3044\u300d\nyear.forAll(y -&gt; y &lt; 2020);    // true (996 &lt; 2020)\nnoYear.forAll(y -&gt; y &lt; 2020);  // true (\u5024\u304c\u306a\u3044\u306e\u3067\u300c\u5168\u3066\u300d\u304c\u81ea\u660e\u306b\u771f)\nyear.forAll(y -&gt; y &gt; 2020);    // false\n\n// exists - \u300c\u5b58\u5728\u3057\u3066\u6761\u4ef6\u3092\u6e80\u305f\u3059\u300d\nyear.exists(y -&gt; y &lt; 2020);    // true\nnoYear.exists(y -&gt; y &lt; 2020);  // false (\u5024\u304c\u306a\u3044\u306e\u3067\u5b58\u5728\u3057\u306a\u3044)\n</code></pre>"},{"location":"java/part-3/#7-either","title":"\u7b2c7\u7ae0: Either \u578b\u3068\u8907\u5408\u7684\u306a\u30a8\u30e9\u30fc\u51e6\u7406","text":""},{"location":"java/part-3/#71-option","title":"7.1 Option \u306e\u9650\u754c","text":"<p><code>Option</code> \u306f\u300c\u5024\u304c\u3042\u308b\u304b\u306a\u3044\u304b\u300d\u3057\u304b\u8868\u73fe\u3067\u304d\u307e\u305b\u3093\u3002\u306a\u305c\u5931\u6557\u3057\u305f\u306e\u304b\u3092\u4f1d\u3048\u3089\u308c\u307e\u305b\u3093\u3002</p> <p></p>"},{"location":"java/part-3/#72-either","title":"7.2 Either \u306e\u57fa\u672c","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch07/EitherBasics.java</code></p> <p><code>Either&lt;E, A&gt;</code> \u306f\u300c<code>E</code> \u578b\u306e\u30a8\u30e9\u30fc\u304b\u3001<code>A</code> \u578b\u306e\u6210\u529f\u5024\u304b\u300d\u3092\u8868\u3059\u578b\u3067\u3059\u3002</p> <ul> <li><code>Right(value)</code>: \u6210\u529f\uff08\u6163\u4f8b\u7684\u306b\u300c\u6b63\u3057\u3044\u300d= right\uff09</li> <li><code>Left(error)</code>: \u5931\u6557\uff08\u30a8\u30e9\u30fc\u60c5\u5831\u3092\u4fdd\u6301\uff09</li> </ul> <pre><code>import io.vavr.control.Either;\n\npublic static Either&lt;String, String&gt; extractName(String show) {\n    int bracketOpen = show.indexOf('(');\n    if (bracketOpen &gt; 0) {\n        return Either.right(show.substring(0, bracketOpen).trim());\n    }\n    return Either.left(\"Can't extract name from: \" + show);\n}\n\nextractName(\"The Wire (2002-2008)\");  // Right(\"The Wire\")\nextractName(\"(2022)\");                // Left(\"Can't extract name from: (2022)\")\n</code></pre>"},{"location":"java/part-3/#73-either","title":"7.3 Either \u3092\u4f7f\u3063\u305f\u30d1\u30fc\u30b9","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch07/TvShowParserEither.java</code></p> <pre><code>public static Either&lt;String, Integer&gt; extractYearStart(String rawShow) {\n    int bracketOpen = rawShow.indexOf('(');\n    int dash = rawShow.indexOf('-');\n\n    if (bracketOpen != -1 &amp;&amp; dash &gt; bracketOpen + 1) {\n        String yearStr = rawShow.substring(bracketOpen + 1, dash);\n        return parseYear(yearStr, \"start year\");\n    }\n    return Either.left(\"Can't extract start year from: \" + rawShow);\n}\n\nextractYearStart(\"The Wire (2002-2008)\");  // Right(2002)\nextractYearStart(\"The Wire (-2008)\");      // Left(\"Can't extract start year from: The Wire (-2008)\")\nextractYearStart(\"The Wire (oops-2008)\");  // Left(\"Can't parse start year: 'oops'\")\n</code></pre>"},{"location":"java/part-3/#74-option-either","title":"7.4 Option \u304b\u3089 Either \u3078\u306e\u5909\u63db","text":"<p><code>toEither</code> \u30e1\u30bd\u30c3\u30c9\u3067 <code>Option</code> \u3092 <code>Either</code> \u306b\u5909\u63db\u3067\u304d\u307e\u3059\u3002</p> <pre><code>Option&lt;Integer&gt; year = Option.some(996);\nOption&lt;Integer&gt; noYear = Option.none();\n\nyear.toEither(\"no year given\");    // Right(996)\nnoYear.toEither(\"no year given\");  // Left(\"no year given\")\n</code></pre>"},{"location":"java/part-3/#75-either","title":"7.5 Either \u306e\u4e3b\u8981\u30e1\u30bd\u30c3\u30c9","text":"\u30e1\u30bd\u30c3\u30c9 \u8aac\u660e \u4f8b <code>map</code> Right \u306e\u5024\u3092\u5909\u63db <code>Right(5).map(x -&gt; x * 2)</code> \u2192 <code>Right(10)</code> <code>flatMap</code> Right \u306a\u3089 Either \u3092\u8fd4\u3059\u95a2\u6570\u3092\u9069\u7528 <code>Right(5).flatMap(x -&gt; Right(x * 2))</code> \u2192 <code>Right(10)</code> <code>orElse</code> Left \u306a\u3089\u4ee3\u66ff\u3092\u4f7f\u7528 <code>Left(\"err\").orElse(Right(5))</code> \u2192 <code>Right(5)</code> <code>toOption</code> Option \u306b\u5909\u63db <code>Right(5).toOption()</code> \u2192 <code>Some(5)</code> <code>fold</code> \u4e21\u65b9\u306e\u30b1\u30fc\u30b9\u3092\u51e6\u7406 <code>either.fold(err -&gt; ..., val -&gt; ...)</code> <pre><code>Either&lt;String, Integer&gt; year = Either.right(996);\nEither&lt;String, Integer&gt; noYear = Either.left(\"no year\");\n\n// map\nyear.map(y -&gt; y * 2);    // Right(1992)\nnoYear.map(y -&gt; y * 2);  // Left(\"no year\")\n\n// flatMap\nyear.flatMap(y -&gt; Either.right(y * 2));   // Right(1992)\nnoYear.flatMap(y -&gt; Either.right(y * 2)); // Left(\"no year\")\n\n// fold\nyear.fold(\n    error -&gt; \"Error: \" + error,\n    value -&gt; \"Success: \" + value\n);  // \"Success: 996\"\n</code></pre>"},{"location":"java/part-3/#76","title":"7.6 \u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u306e\u4f8b","text":"<pre><code>public static Either&lt;String, Integer&gt; validateAge(int age) {\n    if (age &lt; 0) {\n        return Either.left(\"Age cannot be negative\");\n    } else if (age &gt; 150) {\n        return Either.left(\"Age cannot be greater than 150\");\n    }\n    return Either.right(age);\n}\n\nvalidateAge(25);   // Right(25)\nvalidateAge(-5);   // Left(\"Age cannot be negative\")\nvalidateAge(200);  // Left(\"Age cannot be greater than 150\")\n</code></pre>"},{"location":"java/part-3/#_3","title":"\u8907\u5408\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3","text":"<pre><code>public record User(String username, String email, int age) {}\n\npublic static Either&lt;String, User&gt; validateUser(String username, String email, int age) {\n    return validateUsername(username).flatMap(validUsername -&gt;\n        validateEmail(email).flatMap(validEmail -&gt;\n            validateAge(age).map(validAge -&gt;\n                new User(validUsername, validEmail, validAge)\n            )\n        )\n    );\n}\n\nvalidateUser(\"alice\", \"alice@example.com\", 25);  // Right(User(...))\nvalidateUser(\"ab\", \"alice@example.com\", 25);     // Left(\"Username must be at least 3 characters\")\n</code></pre>"},{"location":"java/part-3/#77-adt","title":"7.7 \u4ee3\u6570\u7684\u30c7\u30fc\u30bf\u578b\uff08ADT\uff09","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch07/MusicArtist.java</code></p> <p>Java 17+ \u306e sealed interface \u3068 record \u3092\u4f7f\u3063\u3066 ADT \u3092\u8868\u73fe\u3057\u307e\u3059\u3002</p>"},{"location":"java/part-3/#sum-type-sealed-interface","title":"\u76f4\u548c\u578b\uff08Sum Type\uff09- sealed interface","text":"<pre><code>// \u6d3b\u52d5\u671f\u9593\u3092\u8868\u3059\u76f4\u548c\u578b\npublic sealed interface YearsActive permits StillActive, ActiveBetween {}\n\npublic record StillActive(int since) implements YearsActive {}\npublic record ActiveBetween(int start, int end) implements YearsActive {}\n</code></pre>"},{"location":"java/part-3/#product-type-record","title":"\u76f4\u7a4d\u578b\uff08Product Type\uff09- record","text":"<pre><code>public record Artist(\n    String name,\n    MusicGenre genre,\n    String origin,\n    YearsActive yearsActive\n) {}\n</code></pre>"},{"location":"java/part-3/#78","title":"7.8 \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0","text":"<p>Java 21 \u306e\u62e1\u5f35 switch \u3092\u4f7f\u3063\u3066\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u884c\u3044\u307e\u3059\u3002</p> <pre><code>public static boolean wasArtistActive(Artist artist, int yearStart, int yearEnd) {\n    return switch (artist.yearsActive()) {\n        case StillActive(int since) -&gt; since &lt;= yearEnd;\n        case ActiveBetween(int start, int end) -&gt; start &lt;= yearEnd &amp;&amp; end &gt;= yearStart;\n    };\n}\n\npublic static int activeLength(Artist artist, int currentYear) {\n    return switch (artist.yearsActive()) {\n        case StillActive(int since) -&gt; currentYear - since;\n        case ActiveBetween(int start, int end) -&gt; end - start;\n    };\n}\n\n// \u4f7f\u7528\u4f8b\nArtist metallica = new Artist(\"Metallica\", MusicGenre.HEAVY_METAL, \"U.S.\", new StillActive(1981));\nArtist ledZeppelin = new Artist(\"Led Zeppelin\", MusicGenre.HARD_ROCK, \"England\", new ActiveBetween(1968, 1980));\n\nactiveLength(metallica, 2024);    // 43 (2024 - 1981)\nactiveLength(ledZeppelin, 2024);  // 12 (1980 - 1968)\n</code></pre>"},{"location":"java/part-3/#79","title":"7.9 \u691c\u7d22\u6761\u4ef6\u306e\u30e2\u30c7\u30ea\u30f3\u30b0","text":"<p>\u691c\u7d22\u6761\u4ef6\u3082 ADT \u3067\u30e2\u30c7\u30ea\u30f3\u30b0\u3067\u304d\u307e\u3059\u3002</p> <pre><code>public sealed interface SearchCondition permits SearchByGenre, SearchByOrigin, SearchByActiveYears {}\n\npublic record SearchByGenre(List&lt;MusicGenre&gt; genres) implements SearchCondition {}\npublic record SearchByOrigin(List&lt;String&gt; locations) implements SearchCondition {}\npublic record SearchByActiveYears(int start, int end) implements SearchCondition {}\n\npublic static List&lt;Artist&gt; searchArtists(\n        List&lt;Artist&gt; artists,\n        List&lt;SearchCondition&gt; requiredConditions) {\n    return artists.filter(artist -&gt;\n        requiredConditions.forAll(condition -&gt; matchesCondition(artist, condition))\n    );\n}\n\npublic static boolean matchesCondition(Artist artist, SearchCondition condition) {\n    return switch (condition) {\n        case SearchByGenre(List&lt;MusicGenre&gt; genres) -&gt;\n            genres.contains(artist.genre());\n        case SearchByOrigin(List&lt;String&gt; locations) -&gt;\n            locations.contains(artist.origin());\n        case SearchByActiveYears(int start, int end) -&gt;\n            wasArtistActive(artist, start, end);\n    };\n}\n</code></pre>"},{"location":"java/part-3/#710","title":"7.10 \u652f\u6255\u3044\u65b9\u6cd5\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch07/PaymentMethod.java</code></p> <pre><code>public sealed interface Payment permits CreditCard, BankTransfer, Cash {}\n\npublic record CreditCard(String number, String expiry) implements Payment {}\npublic record BankTransfer(String accountNumber) implements Payment {}\npublic record Cash() implements Payment {}\n\npublic static String describePayment(Payment method) {\n    return switch (method) {\n        case CreditCard(String number, String expiry) -&gt;\n            \"Credit card ending in \" + number.substring(number.length() - 4);\n        case BankTransfer(String account) -&gt;\n            \"Bank transfer to account \" + account;\n        case Cash() -&gt;\n            \"Cash payment\";\n    };\n}\n</code></pre>"},{"location":"java/part-3/#_4","title":"\u307e\u3068\u3081","text":""},{"location":"java/part-3/#part-iii","title":"Part III \u3067\u5b66\u3093\u3060\u3053\u3068","text":"<ol> <li>Option: \u5024\u306e\u6709\u7121\u3092\u578b\u3067\u8868\u73fe\u3059\u308b</li> <li>Either: \u6210\u529f/\u5931\u6557\u3068\u30a8\u30e9\u30fc\u60c5\u5831\u3092\u578b\u3067\u8868\u73fe\u3059\u308b</li> <li>flatMap: Option/Either \u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u4f7f\u3046</li> <li>orElse: \u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u3092\u63d0\u4f9b\u3059\u308b</li> <li>ADT: \u76f4\u7a4d\u578b\u3068\u76f4\u548c\u578b\u3067\u30c9\u30e1\u30a4\u30f3\u3092\u6b63\u78ba\u306b\u30e2\u30c7\u30ea\u30f3\u30b0</li> <li>\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0: \u76f4\u548c\u578b\u3092\u5b89\u5168\u306b\u51e6\u7406\u3059\u308b</li> </ol>"},{"location":"java/part-3/#option-vs-either","title":"Option vs Either \u306e\u4f7f\u3044\u5206\u3051","text":"\u72b6\u6cc1 \u4f7f\u7528\u3059\u308b\u578b \u5024\u304c\u3042\u308b\u304b\u306a\u3044\u304b\u3060\u3051\u304c\u91cd\u8981 <code>Option&lt;A&gt;</code> \u5931\u6557\u7406\u7531\u3092\u4f1d\u3048\u308b\u5fc5\u8981\u304c\u3042\u308b <code>Either&lt;E, A&gt;</code> \u691c\u7d22\u7d50\u679c\u304c\u898b\u3064\u304b\u3089\u306a\u3044 <code>Option&lt;A&gt;</code> \u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u30a8\u30e9\u30fc\u3092\u4f1d\u3048\u308b <code>Either&lt;String, A&gt;</code> \u8907\u6570\u306e\u30a8\u30e9\u30fc\u7a2e\u5225\u304c\u3042\u308b <code>Either&lt;ErrorType, A&gt;</code>"},{"location":"java/part-3/#scala","title":"Scala \u3068\u306e\u5bfe\u5fdc","text":"Scala Java + Vavr <code>Option[A]</code> <code>io.vavr.control.Option&lt;A&gt;</code> <code>Some(x)</code> <code>Option.some(x)</code> <code>None</code> <code>Option.none()</code> <code>Either[E, A]</code> <code>io.vavr.control.Either&lt;E, A&gt;</code> <code>Right(x)</code> <code>Either.right(x)</code> <code>Left(e)</code> <code>Either.left(e)</code> <code>toRight(e)</code> <code>toEither(e)</code> <code>case class</code> <code>record</code> <code>sealed trait</code> <code>sealed interface</code> <code>match { case ... }</code> <code>switch (expr) { case ... -&gt; }</code>"},{"location":"java/part-3/#_5","title":"\u6b21\u306e\u30d1\u30fc\u30c8","text":"<p>Part IV \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li>IO \u30e2\u30ca\u30c9\u306e\u5c0e\u5165</li> <li>\u526f\u4f5c\u7528\u306e\u7ba1\u7406</li> <li>\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406</li> </ul>"},{"location":"java/part-4/","title":"Part IV: IO \u3068\u526f\u4f5c\u7528\u306e\u7ba1\u7406","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u526f\u4f5c\u7528\u306e\u6271\u3044\u65b9\u3092\u5b66\u3073\u307e\u3059\u3002IO \u30e2\u30ca\u30c9\u3092\u4f7f\u3063\u3066\u526f\u4f5c\u7528\u3092\u7d14\u7c8b\u95a2\u6570\u5185\u3067\u5b89\u5168\u306b\u8a18\u8ff0\u3057\u3001\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406\u3067\u7121\u9650\u306e\u30c7\u30fc\u30bf\u3092\u6271\u3046\u65b9\u6cd5\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"java/part-4/#8-io","title":"\u7b2c8\u7ae0: IO \u30e2\u30ca\u30c9\u306e\u5c0e\u5165","text":""},{"location":"java/part-4/#81","title":"8.1 \u526f\u4f5c\u7528\u306e\u554f\u984c","text":"<p>\u7d14\u7c8b\u95a2\u6570\u306f\u526f\u4f5c\u7528\u3092\u6301\u3061\u307e\u305b\u3093\u3002\u3057\u304b\u3057\u3001\u5b9f\u969b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u306b\u306f\u526f\u4f5c\u7528\u304c\u5fc5\u8981\u3067\u3059:</p> <ul> <li>\u30d5\u30a1\u30a4\u30eb\u306e\u8aad\u307f\u66f8\u304d</li> <li>\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u901a\u4fe1</li> <li>\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30a2\u30af\u30bb\u30b9</li> <li>\u4e71\u6570\u751f\u6210</li> <li>\u73fe\u5728\u6642\u523b\u306e\u53d6\u5f97</li> </ul> <p></p>"},{"location":"java/part-4/#82-io","title":"8.2 IO \u30e2\u30ca\u30c9\u3068\u306f","text":"<p>IO \u30e2\u30ca\u30c9\u306f\u300c\u526f\u4f5c\u7528\u3092\u6301\u3064\u8a08\u7b97\u306e\u8a18\u8ff0\u300d\u3092\u8868\u3059\u578b\u3067\u3059\u3002</p> <ul> <li><code>IO&lt;A&gt;</code> \u306f\u300c\u5b9f\u884c\u3059\u308b\u3068 <code>A</code> \u578b\u306e\u5024\u3092\u8fd4\u3059\u526f\u4f5c\u7528\u306e\u3042\u308b\u8a08\u7b97\u300d</li> <li>IO \u5024\u3092\u4f5c\u6210\u3057\u305f\u3060\u3051\u3067\u306f\u526f\u4f5c\u7528\u306f\u767a\u751f\u3057\u306a\u3044</li> <li><code>unsafeRun()</code> \u3067\u5b9f\u969b\u306b\u5b9f\u884c\u3055\u308c\u308b</li> </ul> <p></p>"},{"location":"java/part-4/#83-io","title":"8.3 IO \u306e\u5b9f\u88c5","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch08/IO.java</code></p> <p>Java + Vavr \u3067\u306e IO \u30e2\u30ca\u30c9\u306e\u7c21\u6613\u5b9f\u88c5\u3067\u3059:</p> <pre><code>public final class IO&lt;A&gt; {\n\n    private final Supplier&lt;A&gt; thunk;\n\n    private IO(Supplier&lt;A&gt; thunk) {\n        this.thunk = thunk;\n    }\n\n    // \u526f\u4f5c\u7528\u306e\u3042\u308b\u5f0f\u3092\u9045\u5ef6\u5b9f\u884c\u3059\u308b IO \u3092\u4f5c\u6210\n    public static &lt;A&gt; IO&lt;A&gt; delay(Supplier&lt;A&gt; supplier) {\n        return new IO&lt;&gt;(supplier);\n    }\n\n    // \u65e2\u5b58\u306e\u5024\u3092\u30e9\u30c3\u30d7\uff08\u526f\u4f5c\u7528\u306a\u3057\uff09\n    public static &lt;A&gt; IO&lt;A&gt; pure(A value) {\n        return new IO&lt;&gt;(() -&gt; value);\n    }\n\n    // IO \u3092\u5b9f\u884c\u3057\u3066\u7d50\u679c\u3092\u53d6\u5f97\uff08\u526f\u4f5c\u7528\u304c\u767a\u751f\u3059\u308b\uff09\n    public A unsafeRun() {\n        return thunk.get();\n    }\n\n    // \u7d50\u679c\u3092\u5909\u63db\u3059\u308b\n    public &lt;B&gt; IO&lt;B&gt; map(Function&lt;A, B&gt; f) {\n        return new IO&lt;&gt;(() -&gt; f.apply(thunk.get()));\n    }\n\n    // IO \u3092\u8fd4\u3059\u95a2\u6570\u3092\u9069\u7528\u3057\u3066\u30d5\u30e9\u30c3\u30c8\u5316\n    public &lt;B&gt; IO&lt;B&gt; flatMap(Function&lt;A, IO&lt;B&gt;&gt; f) {\n        return new IO&lt;&gt;(() -&gt; f.apply(thunk.get()).unsafeRun());\n    }\n}\n</code></pre>"},{"location":"java/part-4/#84","title":"8.4 \u30b5\u30a4\u30b3\u30ed\u3092\u632f\u308b\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch08/CastingDie.java</code></p>"},{"location":"java/part-4/#_1","title":"\u4e0d\u7d14\u306a\u95a2\u6570\uff08\u526f\u4f5c\u7528\u3042\u308a\uff09","text":"<pre><code>private static final Random random = new Random();\n\n// \u547c\u3073\u51fa\u3059\u305f\u3073\u306b\u7570\u306a\u308b\u5024\u304c\u8fd4\u308b\npublic static int castTheDieImpure() {\n    return random.nextInt(6) + 1;\n}\n</code></pre>"},{"location":"java/part-4/#io","title":"IO \u3092\u4f7f\u3063\u305f\u7d14\u7c8b\u306a\u8a18\u8ff0","text":"<pre><code>// \u30b5\u30a4\u30b3\u30ed\u3092\u632f\u308b\uff08IO \u3067\u30e9\u30c3\u30d7\uff09\n// IO \u5024\u3092\u4f5c\u6210\u3057\u305f\u3060\u3051\u3067\u306f\u5b9f\u884c\u3055\u308c\u306a\u3044\npublic static IO&lt;Integer&gt; castTheDie() {\n    return IO.delay(CastingDie::castTheDieImpure);\n}\n\n// IO \u5024\u3092\u4f5c\u6210\uff08\u3053\u306e\u6642\u70b9\u3067\u306f\u5b9f\u884c\u3055\u308c\u306a\u3044\uff09\nIO&lt;Integer&gt; dieCast = castTheDie();\nSystem.out.println(dieCast);  // IO(...) - \u307e\u3060\u5b9f\u884c\u3055\u308c\u3066\u3044\u306a\u3044\n\n// \u5b9f\u969b\u306b\u5b9f\u884c\nSystem.out.println(dieCast.unsafeRun());  // 4\n</code></pre>"},{"location":"java/part-4/#85-io","title":"8.5 IO \u306e\u4f5c\u6210\u65b9\u6cd5","text":"\u30e1\u30bd\u30c3\u30c9 \u7528\u9014 \u4f8b <code>IO.delay(expr)</code> \u526f\u4f5c\u7528\u306e\u3042\u308b\u5f0f\u3092\u30e9\u30c3\u30d7 <code>IO.delay(() -&gt; System.out.println(\"hello\"))</code> <code>IO.pure(value)</code> \u65e2\u5b58\u306e\u5024\u3092\u30e9\u30c3\u30d7\uff08\u526f\u4f5c\u7528\u306a\u3057\uff09 <code>IO.pure(42)</code> <code>IO.unit()</code> \u4f55\u3082\u3057\u306a\u3044 IO <code>IO.unit()</code> (= <code>IO.pure(null)</code>) <code>IO.effect(runnable)</code> \u526f\u4f5c\u7528\u306e\u307f\u3092\u5b9f\u884c <code>IO.effect(() -&gt; System.out.println(\"!\"))</code> <pre><code>// IO.delay: \u526f\u4f5c\u7528\u3092\u9045\u5ef6\u5b9f\u884c\nIO&lt;Void&gt; delayedPrint = IO.effect(() -&gt; System.out.println(\"Hello\"));\n// println \u306f\u307e\u3060\u5b9f\u884c\u3055\u308c\u3066\u3044\u306a\u3044\n\n// IO.pure: \u65e2\u5b58\u306e\u5024\u3092\u30e9\u30c3\u30d7\nIO&lt;Integer&gt; pureValue = IO.pure(42);\n// \u526f\u4f5c\u7528\u306a\u3057\u3001\u5373\u5ea7\u306b 42 \u304c\u78ba\u5b9a\n</code></pre>"},{"location":"java/part-4/#86-io","title":"8.6 IO \u306e\u5408\u6210","text":"<p>IO \u5024\u306f <code>flatMap</code> \u3084 <code>map</code> \u3067\u5408\u6210\u3067\u304d\u307e\u3059\u3002</p> <pre><code>// \u30b5\u30a4\u30b3\u30ed\u30922\u56de\u632f\u3063\u3066\u5408\u8a08\u3092\u8fd4\u3059\npublic static IO&lt;Integer&gt; castTheDieTwice() {\n    return castTheDie()\n            .flatMap(first -&gt; castTheDie()\n                    .map(second -&gt; first + second));\n}\n\n// \u307e\u3060\u5b9f\u884c\u3055\u308c\u3066\u3044\u306a\u3044\nIO&lt;Integer&gt; program = castTheDieTwice();\n\n// \u5b9f\u884c\nint result = program.unsafeRun();\n</code></pre> <p></p>"},{"location":"java/part-4/#87","title":"8.7 \u30df\u30fc\u30c6\u30a3\u30f3\u30b0\u30b9\u30b1\u30b8\u30e5\u30fc\u30ea\u30f3\u30b0\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch08/SchedulingMeetings.java</code></p> <p>\u3088\u308a\u5b9f\u8df5\u7684\u306a\u4f8b\u3068\u3057\u3066\u3001\u30df\u30fc\u30c6\u30a3\u30f3\u30b0\u306e\u30b9\u30b1\u30b8\u30e5\u30fc\u30ea\u30f3\u30b0\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p>"},{"location":"java/part-4/#_2","title":"\u30c7\u30fc\u30bf\u578b","text":"<pre><code>public record MeetingTime(int startHour, int endHour) {\n    public int lengthHours() {\n        return endHour - startHour;\n    }\n}\n</code></pre>"},{"location":"java/part-4/#api-io","title":"\u526f\u4f5c\u7528\u306e\u3042\u308b API \u547c\u3073\u51fa\u3057\u3092 IO \u3067\u30e9\u30c3\u30d7","text":"<pre><code>public static IO&lt;List&lt;MeetingTime&gt;&gt; calendarEntries(String name) {\n    return IO.delay(() -&gt; simulateCalendarApi(name));\n}\n\npublic static IO&lt;Void&gt; createMeeting(List&lt;String&gt; attendees, MeetingTime meeting) {\n    return IO.effect(() -&gt; {\n        System.out.println(\"Creating meeting for \" + attendees.mkString(\", \") +\n                \" at \" + meeting.startHour() + \":00 - \" + meeting.endHour() + \":00\");\n    });\n}\n</code></pre>"},{"location":"java/part-4/#_3","title":"\u4e88\u5b9a\u306e\u53d6\u5f97","text":"<pre><code>public static IO&lt;List&lt;MeetingTime&gt;&gt; scheduledMeetings(String person1, String person2) {\n    return calendarEntries(person1)\n            .flatMap(p1Entries -&gt; calendarEntries(person2)\n                    .map(p2Entries -&gt; p1Entries.appendAll(p2Entries)));\n}\n</code></pre>"},{"location":"java/part-4/#_4","title":"\u7a7a\u304d\u6642\u9593\u306e\u8a08\u7b97\uff08\u7d14\u7c8b\u95a2\u6570\uff09","text":"<pre><code>public static List&lt;MeetingTime&gt; possibleMeetings(\n        List&lt;MeetingTime&gt; existingMeetings,\n        int startHour,\n        int endHour,\n        int lengthHours) {\n\n    return List.range(startHour, endHour - lengthHours + 1)\n            .map(start -&gt; new MeetingTime(start, start + lengthHours))\n            .filter(slot -&gt; existingMeetings.forAll(\n                    existing -&gt; !meetingsOverlap(existing, slot)));\n}\n</code></pre>"},{"location":"java/part-4/#88-orelse","title":"8.8 orElse \u306b\u3088\u308b\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":"<p>IO \u306e <code>orElse</code> \u30e1\u30bd\u30c3\u30c9\u3067\u3001\u5931\u6557\u6642\u306e\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002</p> <pre><code>IO&lt;Integer&gt; year = IO.delay(() -&gt; 996);\nIO&lt;Integer&gt; noYear = IO.delay(() -&gt; { throw new RuntimeException(\"no year\"); });\n\nyear.orElse(2020).unsafeRun();    // 996\nnoYear.orElse(2020).unsafeRun();  // 2020\n</code></pre> <p></p>"},{"location":"java/part-4/#_5","title":"\u30ea\u30c8\u30e9\u30a4\u6226\u7565","text":"<pre><code>// API \u547c\u3073\u51fa\u3057\u30923\u56de\u307e\u3067\u30ea\u30c8\u30e9\u30a4\ncalendarEntries(\"Alice\")\n    .retry(3)\n    .orElse(List.empty());  // \u5168\u90e8\u5931\u6557\u3057\u305f\u3089\u7a7a\u30ea\u30b9\u30c8\n</code></pre>"},{"location":"java/part-4/#_6","title":"\u6c4e\u7528\u30ea\u30c8\u30e9\u30a4\u95a2\u6570","text":"<pre><code>public IO&lt;A&gt; retry(int maxRetries) {\n    IO&lt;A&gt; result = this;\n    for (int i = 0; i &lt; maxRetries; i++) {\n        result = result.orElse(() -&gt; this);\n    }\n    return result;\n}\n\n// \u4f7f\u7528\u4f8b\ncalendarEntries(\"Alice\").retry(10);\n</code></pre>"},{"location":"java/part-4/#89-sequence-io","title":"8.9 sequence \u306b\u3088\u308b IO \u306e\u30ea\u30b9\u30c8\u51e6\u7406","text":"<p><code>List&lt;IO&lt;A&gt;&gt;</code> \u3092 <code>IO&lt;List&lt;A&gt;&gt;</code> \u306b\u5909\u63db\u3059\u308b\u306b\u306f <code>sequence</code> \u3092\u4f7f\u3044\u307e\u3059\u3002</p> <pre><code>public static &lt;A&gt; IO&lt;List&lt;A&gt;&gt; sequence(List&lt;IO&lt;A&gt;&gt; ios) {\n    return ios.foldLeft(\n            IO.pure(List.empty()),\n            (acc, io) -&gt; acc.flatMap(list -&gt; io.map(list::append))\n    );\n}\n\nList&lt;IO&lt;Integer&gt;&gt; actions = List.of(IO.pure(1), IO.pure(2), IO.pure(3));\nIO&lt;List&lt;Integer&gt;&gt; combined = IO.sequence(actions);\n\ncombined.unsafeRun();  // List(1, 2, 3)\n</code></pre>"},{"location":"java/part-4/#_7","title":"\u8907\u6570\u4eba\u306e\u4e88\u5b9a\u3092\u53d6\u5f97","text":"<pre><code>public static IO&lt;List&lt;MeetingTime&gt;&gt; scheduledMeetings(List&lt;String&gt; attendees) {\n    return IO.traverse(attendees, SchedulingMeetings::calendarEntries)\n            .map(lists -&gt; lists.flatMap(x -&gt; x));\n}\n</code></pre>"},{"location":"java/part-4/#9","title":"\u7b2c9\u7ae0: \u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406","text":""},{"location":"java/part-4/#91","title":"9.1 \u30b9\u30c8\u30ea\u30fc\u30e0\u3068\u306f","text":"<p>\u30b9\u30c8\u30ea\u30fc\u30e0\u306f\u3001\u8981\u7d20\u306e\uff08\u6f5c\u5728\u7684\u306b\u7121\u9650\u306e\uff09\u30b7\u30fc\u30b1\u30f3\u30b9\u3092\u8868\u3057\u307e\u3059\u3002</p> <p></p>"},{"location":"java/part-4/#92-lazystream","title":"9.2 LazyStream \u306e\u5b9f\u88c5","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch09/LazyStream.java</code></p> <p>Java + Vavr \u3067\u306e\u9045\u5ef6\u8a55\u4fa1\u30b9\u30c8\u30ea\u30fc\u30e0\u306e\u5b9f\u88c5\u3067\u3059:</p> <pre><code>public final class LazyStream&lt;A&gt; implements Iterable&lt;A&gt; {\n\n    private final Supplier&lt;Option&lt;Cons&lt;A&gt;&gt;&gt; headTail;\n\n    private record Cons&lt;A&gt;(A head, LazyStream&lt;A&gt; tail) {}\n\n    private LazyStream(Supplier&lt;Option&lt;Cons&lt;A&gt;&gt;&gt; headTail) {\n        this.headTail = headTail;\n    }\n\n    // \u7a7a\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\n    public static &lt;A&gt; LazyStream&lt;A&gt; empty() {\n        return new LazyStream&lt;&gt;(Option::none);\n    }\n\n    // \u5358\u4e00\u8981\u7d20\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\n    public static &lt;A&gt; LazyStream&lt;A&gt; of(A value) {\n        return new LazyStream&lt;&gt;(() -&gt;\n            Option.some(new Cons&lt;&gt;(value, empty())));\n    }\n\n    // \u7121\u9650\u306b\u5024\u3092\u7e70\u308a\u8fd4\u3059\u30b9\u30c8\u30ea\u30fc\u30e0\n    public static &lt;A&gt; LazyStream&lt;A&gt; repeat(A value) {\n        return new LazyStream&lt;&gt;(() -&gt;\n            Option.some(new Cons&lt;&gt;(value, repeat(value))));\n    }\n}\n</code></pre>"},{"location":"java/part-4/#93","title":"9.3 \u7d14\u7c8b\u306a\u30b9\u30c8\u30ea\u30fc\u30e0","text":"<pre><code>// \u6709\u9650\u30b9\u30c8\u30ea\u30fc\u30e0\nLazyStream&lt;Integer&gt; numbers = LazyStream.of(1, 2, 3);\n\n// List \u306b\u5909\u63db\nnumbers.toList();  // List(1, 2, 3)\n\n// \u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\nLazyStream&lt;Integer&gt; oddNumbers = numbers.filter(x -&gt; x % 2 != 0);\noddNumbers.toList();  // List(1, 3)\n</code></pre>"},{"location":"java/part-4/#94","title":"9.4 \u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0","text":"<pre><code>// repeat \u3067\u7121\u9650\u306b\u7e70\u308a\u8fd4\u3057\nLazyStream&lt;Integer&gt; infinite123s = LazyStream.of(1, 2, 3).repeat();\n\n// take \u3067\u6709\u9650\u500b\u3092\u53d6\u5f97\ninfinite123s.take(8).toList();  // List(1, 2, 3, 1, 2, 3, 1, 2)\n</code></pre>"},{"location":"java/part-4/#95","title":"9.5 \u30b9\u30c8\u30ea\u30fc\u30e0\u306e\u4e3b\u8981\u64cd\u4f5c","text":"\u64cd\u4f5c \u8aac\u660e \u4f8b <code>take(n)</code> \u6700\u521d\u306e n \u8981\u7d20\u3092\u53d6\u5f97 <code>stream.take(3)</code> <code>filter(p)</code> \u6761\u4ef6\u3092\u6e80\u305f\u3059\u8981\u7d20\u306e\u307f <code>stream.filter(x -&gt; x &gt; 0)</code> <code>map(f)</code> \u5404\u8981\u7d20\u3092\u5909\u63db <code>stream.map(x -&gt; x * 2)</code> <code>append(s)</code> \u5225\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u7d50\u5408 <code>stream1.append(stream2)</code> <code>repeat()</code> \u7121\u9650\u306b\u7e70\u308a\u8fd4\u3057 <code>stream.repeat()</code> <code>sliding(n)</code> \u30b9\u30e9\u30a4\u30c7\u30a3\u30f3\u30b0\u30a6\u30a3\u30f3\u30c9\u30a6 <code>stream.sliding(3)</code>"},{"location":"java/part-4/#96","title":"9.6 \u901a\u8ca8\u4ea4\u63db\u30ec\u30fc\u30c8\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch09/CurrencyExchange.java</code></p> <p>\u70ba\u66ff\u30ec\u30fc\u30c8\u3092\u76e3\u8996\u3057\u3066\u3001\u4e0a\u6607\u30c8\u30ec\u30f3\u30c9\u3092\u691c\u51fa\u3059\u308b\u4f8b\u3067\u3059\u3002</p>"},{"location":"java/part-4/#_8","title":"\u30c8\u30ec\u30f3\u30c9\u5224\u5b9a\uff08\u7d14\u7c8b\u95a2\u6570\uff09","text":"<pre><code>public static boolean trending(List&lt;BigDecimal&gt; rates) {\n    if (rates.size() &lt;= 1) {\n        return false;\n    }\n    return rates.zip(rates.drop(1))\n            .forAll(pair -&gt; pair._2().compareTo(pair._1()) &gt; 0);\n}\n\ntrending(List.of(\n    BigDecimal.valueOf(0.81),\n    BigDecimal.valueOf(0.82),\n    BigDecimal.valueOf(0.83)\n));  // true (\u4e0a\u6607\u30c8\u30ec\u30f3\u30c9)\n\ntrending(List.of(\n    BigDecimal.valueOf(0.81),\n    BigDecimal.valueOf(0.84),\n    BigDecimal.valueOf(0.83)\n));  // false\n</code></pre>"},{"location":"java/part-4/#_9","title":"\u30ec\u30fc\u30c8\u306e\u30b9\u30c8\u30ea\u30fc\u30e0","text":"<pre><code>public static LazyStream&lt;IO&lt;Option&lt;BigDecimal&gt;&gt;&gt; ratesStream(\n        Currency from,\n        Currency to) {\n    return LazyStream.continually(() -&gt; rate(from, to));\n}\n</code></pre>"},{"location":"java/part-4/#97","title":"9.7 \u30b9\u30e9\u30a4\u30c7\u30a3\u30f3\u30b0\u30a6\u30a3\u30f3\u30c9\u30a6","text":"<p><code>sliding</code> \u3067\u9023\u7d9a\u3059\u308b\u8981\u7d20\u3092\u30b0\u30eb\u30fc\u30d7\u5316\u3067\u304d\u307e\u3059\u3002</p> <pre><code>LazyStream&lt;Integer&gt; stream = LazyStream.of(1, 2, 3, 4, 5);\n\nstream.sliding(3).toList().map(Queue::toList);\n// List(List(1, 2, 3), List(2, 3, 4), List(3, 4, 5))\n</code></pre> <p></p>"},{"location":"java/part-4/#_10","title":"\u30c8\u30ec\u30f3\u30c9\u3092\u691c\u51fa","text":"<pre><code>public static Option&lt;BigDecimal&gt; findTrendInRates(\n        List&lt;BigDecimal&gt; rates,\n        int windowSize) {\n\n    LazyStream&lt;Queue&lt;BigDecimal&gt;&gt; windows = LazyStream.fromList(rates)\n            .sliding(windowSize);\n\n    for (Queue&lt;BigDecimal&gt; window : windows) {\n        List&lt;BigDecimal&gt; windowList = window.toList();\n        if (trending(windowList)) {\n            return Option.some(windowList.last());\n        }\n    }\n    return Option.none();\n}\n</code></pre>"},{"location":"java/part-4/#_11","title":"\u307e\u3068\u3081","text":""},{"location":"java/part-4/#part-iv","title":"Part IV \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"java/part-4/#io-lazystream","title":"IO \u3068 LazyStream \u306e\u6bd4\u8f03","text":"\u7279\u6027 IO LazyStream \u8981\u7d20\u6570 1\u3064 0\u500b\u4ee5\u4e0a\uff08\u7121\u9650\u3082\u53ef\uff09 \u5b9f\u884c <code>unsafeRun()</code> <code>toList()</code> \u7528\u9014 \u5358\u4e00\u306e\u526f\u4f5c\u7528 \u9023\u7d9a\u3057\u305f\u30c7\u30fc\u30bf\u51e6\u7406"},{"location":"java/part-4/#_12","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>IO \u30e2\u30ca\u30c9: \u526f\u4f5c\u7528\u3092\u300c\u8a18\u8ff0\u300d\u3068\u3057\u3066\u6271\u3044\u3001\u5b9f\u884c\u3092\u9045\u5ef6\u3055\u305b\u308b</li> <li>IO.delay: \u526f\u4f5c\u7528\u306e\u3042\u308b\u5f0f\u3092 IO \u306b\u30e9\u30c3\u30d7</li> <li>orElse: \u5931\u6557\u6642\u306e\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u3092\u6307\u5b9a</li> <li>sequence: <code>List&lt;IO&lt;A&gt;&gt;</code> \u2192 <code>IO&lt;List&lt;A&gt;&gt;</code></li> <li>LazyStream: \u6f5c\u5728\u7684\u306b\u7121\u9650\u306e\u30b7\u30fc\u30b1\u30f3\u30b9\u3092\u9045\u5ef6\u8a55\u4fa1\u3067\u51e6\u7406</li> <li>sliding: \u9023\u7d9a\u3059\u308b\u8981\u7d20\u3092\u30b0\u30eb\u30fc\u30d7\u5316\u3057\u3066\u30d1\u30bf\u30fc\u30f3\u3092\u691c\u51fa</li> </ol>"},{"location":"java/part-4/#scala","title":"Scala \u3068\u306e\u6bd4\u8f03","text":"\u6982\u5ff5 Scala (cats-effect/fs2) Java + Vavr IO \u578b <code>cats.effect.IO[A]</code> <code>IO&lt;A&gt;</code> (\u72ec\u81ea\u5b9f\u88c5) \u9045\u5ef6\u5b9f\u884c <code>IO.delay(expr)</code> <code>IO.delay(() -&gt; expr)</code> \u5373\u5ea7\u306e\u5024 <code>IO.pure(value)</code> <code>IO.pure(value)</code> \u5b9f\u884c <code>unsafeRunSync()</code> <code>unsafeRun()</code> \u30b9\u30c8\u30ea\u30fc\u30e0 <code>fs2.Stream[F, A]</code> <code>LazyStream&lt;A&gt;</code> (\u72ec\u81ea\u5b9f\u88c5) \u7121\u9650\u7e70\u308a\u8fd4\u3057 <code>stream.repeat</code> <code>stream.repeat()</code>"},{"location":"java/part-4/#_13","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part V \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3076\u4e88\u5b9a\u3067\u3059:</p> <ul> <li>\u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406</li> <li>\u5171\u6709\u72b6\u614b\u7ba1\u7406</li> </ul>"},{"location":"java/part-4/#_14","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"java/part-4/#1-io","title":"\u554f\u984c 1: IO \u306e\u57fa\u672c","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>public static IO&lt;String&gt; printAndReturn(String message) {\n    // \"message\" \u3092\u30b3\u30f3\u30bd\u30fc\u30eb\u306b\u51fa\u529b\u3057\u3001\"message\" \u3092\u8fd4\u3059 IO\n}\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\n// printAndReturn(\"Hello\").unsafeRun() \u306f\n// \"Hello\" \u3092\u30b3\u30f3\u30bd\u30fc\u30eb\u306b\u51fa\u529b\u3057\u3001\"Hello\" \u3092\u8fd4\u3059\n</code></pre> \u89e3\u7b54 <pre><code>public static IO&lt;String&gt; printAndReturn(String message) {\n    return IO.delay(() -&gt; {\n        System.out.println(message);\n        return message;\n    });\n}\n</code></pre>"},{"location":"java/part-4/#2-io","title":"\u554f\u984c 2: IO \u306e\u5408\u6210","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u30022\u3064\u306e IO \u3092\u9806\u756a\u306b\u5b9f\u884c\u3057\u3001\u7d50\u679c\u3092\u7d50\u5408\u3057\u307e\u3059\u3002</p> <pre><code>public static &lt;A, B, C&gt; IO&lt;C&gt; combineIO(\n        IO&lt;A&gt; io1,\n        IO&lt;B&gt; io2,\n        BiFunction&lt;A, B, C&gt; f) {\n    // ???\n}\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nIO&lt;Integer&gt; result = combineIO(IO.pure(1), IO.pure(2), Integer::sum);\nresult.unsafeRun();  // 3\n</code></pre> \u89e3\u7b54 <pre><code>public static &lt;A, B, C&gt; IO&lt;C&gt; combineIO(\n        IO&lt;A&gt; io1,\n        IO&lt;B&gt; io2,\n        BiFunction&lt;A, B, C&gt; f) {\n    return io1.flatMap(a -&gt; io2.map(b -&gt; f.apply(a, b)));\n}\n</code></pre>"},{"location":"java/part-4/#3","title":"\u554f\u984c 3: \u30ea\u30c8\u30e9\u30a4","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u6307\u5b9a\u56de\u6570\u30ea\u30c8\u30e9\u30a4\u3057\u3001\u5168\u90e8\u5931\u6557\u3057\u305f\u3089\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>public IO&lt;A&gt; retryWithDefault(int maxRetries, A defaultValue) {\n    // ???\n}\n</code></pre> \u89e3\u7b54 <pre><code>public IO&lt;A&gt; retryWithDefault(int maxRetries, A defaultValue) {\n    return retry(maxRetries).orElse(defaultValue);\n}\n</code></pre>"},{"location":"java/part-4/#4","title":"\u554f\u984c 4: \u30b9\u30c8\u30ea\u30fc\u30e0\u64cd\u4f5c","text":"<p>\u4ee5\u4e0b\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u4f5c\u6210\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>// 1. 1\u304b\u308910\u307e\u3067\u306e\u5076\u6570\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\nLazyStream&lt;Integer&gt; evens = ???\n\n// 2. \u7121\u9650\u306b\u4ea4\u4e92\u306b true/false \u3092\u8fd4\u3059\u30b9\u30c8\u30ea\u30fc\u30e0\nLazyStream&lt;Boolean&gt; alternating = ???\n\n// 3. \u6700\u521d\u306e5\u3064\u306e\u8981\u7d20\u306e\u5408\u8a08\u3092\u8a08\u7b97\nint sum = LazyStream.of(1, 2, 3, 4, 5, 6, 7, 8, 9, 10).take(5).???\n</code></pre> \u89e3\u7b54 <pre><code>// 1. 1\u304b\u308910\u307e\u3067\u306e\u5076\u6570\nLazyStream&lt;Integer&gt; evens = LazyStream.range(1, 11).filter(x -&gt; x % 2 == 0);\n// \u307e\u305f\u306f\nLazyStream&lt;Integer&gt; evens = LazyStream.of(2, 4, 6, 8, 10);\n\n// 2. \u7121\u9650\u306b\u4ea4\u4e92\u306b true/false\nLazyStream&lt;Boolean&gt; alternating = LazyStream.of(true, false).repeat();\n\n// 3. \u6700\u521d\u306e5\u3064\u306e\u8981\u7d20\u306e\u5408\u8a08\nint sum = LazyStream.of(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)\n    .take(5)\n    .foldLeft(0, Integer::sum);  // 15\n</code></pre>"},{"location":"java/part-4/#5","title":"\u554f\u984c 5: \u30c8\u30ec\u30f3\u30c9\u691c\u51fa","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u76f4\u8fd13\u3064\u306e\u5024\u304c\u5168\u3066\u540c\u3058\u304b\u3069\u3046\u304b\u3092\u5224\u5b9a\u3057\u307e\u3059\u3002</p> <pre><code>public static boolean isStable(List&lt;BigDecimal&gt; values) {\n    // ???\n}\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert isStable(List.of(bd(5), bd(5), bd(5))) == true;\nassert isStable(List.of(bd(5), bd(5), bd(6))) == false;\nassert isStable(List.of(bd(5), bd(6), bd(5))) == false;\nassert isStable(List.of(bd(5))) == false;  // 3\u3064\u672a\u6e80\u306f false\n</code></pre> \u89e3\u7b54 <pre><code>public static boolean isStable(List&lt;BigDecimal&gt; values) {\n    return values.size() &gt;= 3 &amp;&amp; values.distinct().size() == 1;\n}\n</code></pre>"},{"location":"java/part-5/","title":"Part V: \u4e26\u884c\u51e6\u7406","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u4e26\u884c\u51e6\u7406\u3092\u5b66\u3073\u307e\u3059\u3002Ref \u306b\u3088\u308b\u5b89\u5168\u306a\u5171\u6709\u72b6\u614b\u7ba1\u7406\u3001Fiber \u306b\u3088\u308b\u8efd\u91cf\u30b9\u30ec\u30c3\u30c9\u3001\u305d\u3057\u3066\u4e26\u5217 IO \u64cd\u4f5c\u306e\u69cb\u7bc9\u65b9\u6cd5\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"java/part-5/#10","title":"\u7b2c10\u7ae0: \u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406","text":""},{"location":"java/part-5/#101","title":"10.1 \u4e26\u884c\u51e6\u7406\u306e\u8ab2\u984c","text":"<p>\u5f93\u6765\u306e\u4e26\u884c\u51e6\u7406\u306b\u306f\u591a\u304f\u306e\u8ab2\u984c\u304c\u3042\u308a\u307e\u3059:</p> <ul> <li>\u30c7\u30c3\u30c9\u30ed\u30c3\u30af</li> <li>\u7af6\u5408\u72b6\u614b\uff08Race Condition\uff09</li> <li>\u5171\u6709\u72b6\u614b\u306e\u7ba1\u7406\u306e\u8907\u96d1\u3055</li> <li>\u30b9\u30ec\u30c3\u30c9\u306e\u30aa\u30fc\u30d0\u30fc\u30d8\u30c3\u30c9</li> </ul> <p></p>"},{"location":"java/part-5/#102","title":"10.2 \u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u306e\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u96c6\u8a08","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch10/CheckIns.java</code></p> <p>\u90fd\u5e02\u3078\u306e\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u3092\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u3067\u96c6\u8a08\u3057\u3001\u30e9\u30f3\u30ad\u30f3\u30b0\u3092\u66f4\u65b0\u3059\u308b\u4f8b\u3092\u898b\u3066\u3044\u304d\u307e\u3059\u3002</p> <pre><code>public record City(String name) {}\npublic record CityStats(City city, int checkIns) {}\n\n// \u30b5\u30f3\u30d7\u30eb\u306e\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u30c7\u30fc\u30bf\u3092\u751f\u6210\npublic static List&lt;City&gt; sampleCheckIns(int repeatCount) {\n    List&lt;City&gt; cities = List.of(\n            new City(\"Sydney\"),\n            new City(\"Dublin\"),\n            new City(\"Cape Town\"),\n            new City(\"Lima\"),\n            new City(\"Singapore\")\n    );\n\n    return List.range(0, repeatCount)\n            .flatMap(i -&gt; cities);\n}\n</code></pre>"},{"location":"java/part-5/#n","title":"\u30c8\u30c3\u30d7 N \u90fd\u5e02\u306e\u8a08\u7b97\uff08\u7d14\u7c8b\u95a2\u6570\uff09","text":"<pre><code>public static List&lt;CityStats&gt; topCities(Map&lt;City, Integer&gt; cityCheckIns, int n) {\n    return cityCheckIns.toList()\n            .map(t -&gt; new CityStats(t._1(), t._2()))\n            .sortBy(stats -&gt; -stats.checkIns())  // \u964d\u9806\n            .take(n);\n}\n</code></pre>"},{"location":"java/part-5/#103","title":"10.3 \u9010\u6b21\u51e6\u7406\u306e\u554f\u984c","text":"<p>\u6700\u521d\u306e\u5b9f\u88c5\u306f\u9010\u6b21\u51e6\u7406\u3067\u3001\u30b7\u30f3\u30d7\u30eb\u3067\u3059\u304c\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u306b\u554f\u984c\u304c\u3042\u308a\u307e\u3059\u3002</p> <pre><code>public static IO&lt;List&lt;CityStats&gt;&gt; processCheckInsSequential(List&lt;City&gt; checkIns, int topN) {\n    return IO.delay(() -&gt; {\n        Map&lt;City, Integer&gt; cityCheckIns = checkIns.foldLeft(\n                HashMap.&lt;City, Integer&gt;empty(),\n                CheckIns::updateCheckIns\n        );\n        return topCities(cityCheckIns, topN);\n    });\n}\n\npublic static Map&lt;City, Integer&gt; updateCheckIns(Map&lt;City, Integer&gt; current, City city) {\n    return current.put(city, current.get(city).map(c -&gt; c + 1).getOrElse(1));\n}\n</code></pre> <p></p>"},{"location":"java/part-5/#104-ref-","title":"10.4 Ref - \u30a2\u30c8\u30df\u30c3\u30af\u306a\u5171\u6709\u72b6\u614b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch10/Ref.java</code></p> <p>Ref \u306f\u3001\u8907\u6570\u306e\u4e26\u884c\u51e6\u7406\u304b\u3089\u5b89\u5168\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u30a2\u30c8\u30df\u30c3\u30af\u306a\u53c2\u7167\u3067\u3059\u3002Java \u306e <code>AtomicReference</code> \u3092\u30e9\u30c3\u30d7\u3057\u3001IO \u30e2\u30ca\u30c9\u3068\u7d71\u5408\u3057\u3066\u3044\u307e\u3059\u3002</p> <pre><code>public final class Ref&lt;A&gt; {\n\n    private final AtomicReference&lt;A&gt; value;\n\n    private Ref(A initial) {\n        this.value = new AtomicReference&lt;&gt;(initial);\n    }\n\n    // \u521d\u671f\u5024\u3067 Ref \u3092\u4f5c\u6210\uff08IO \u3067\u30e9\u30c3\u30d7\uff09\n    public static &lt;A&gt; IO&lt;Ref&lt;A&gt;&gt; of(A initial) {\n        return IO.delay(() -&gt; new Ref&lt;&gt;(initial));\n    }\n\n    // \u73fe\u5728\u306e\u5024\u3092\u53d6\u5f97\n    public IO&lt;A&gt; get() {\n        return IO.delay(value::get);\n    }\n\n    // \u5024\u3092\u8a2d\u5b9a\n    public IO&lt;Void&gt; set(A newValue) {\n        return IO.effect(() -&gt; value.set(newValue));\n    }\n\n    // \u30a2\u30c8\u30df\u30c3\u30af\u306b\u5024\u3092\u66f4\u65b0\n    public IO&lt;Void&gt; update(UnaryOperator&lt;A&gt; f) {\n        return IO.effect(() -&gt; value.updateAndGet(f));\n    }\n}\n</code></pre>"},{"location":"java/part-5/#ref","title":"Ref \u306e\u4f7f\u7528\u4f8b","text":"<pre><code>// Ref \u306e\u4f5c\u6210\u3068\u4f7f\u7528\nIO&lt;Integer&gt; program = Ref.of(0)\n        .flatMap(counter -&gt;\n                counter.update(x -&gt; x + 3)    // \u30a2\u30c8\u30df\u30c3\u30af\u306b\u66f4\u65b0\n                        .andThen(counter.get()) // \u73fe\u5728\u306e\u5024\u3092\u53d6\u5f97\n        );\n\nprogram.unsafeRun();  // 3\n</code></pre>"},{"location":"java/part-5/#ref_1","title":"Ref \u306e\u4e3b\u8981\u30e1\u30bd\u30c3\u30c9","text":"\u30e1\u30bd\u30c3\u30c9 \u8aac\u660e \u4f8b <code>Ref.of(initial)</code> \u521d\u671f\u5024\u3067 Ref \u3092\u4f5c\u6210 <code>Ref.of(0)</code> <code>ref.get()</code> \u73fe\u5728\u306e\u5024\u3092\u53d6\u5f97 <code>counter.get()</code> <code>ref.set(value)</code> \u5024\u3092\u8a2d\u5b9a <code>counter.set(10)</code> <code>ref.update(f)</code> \u30a2\u30c8\u30df\u30c3\u30af\u306b\u66f4\u65b0 <code>counter.update(x -&gt; x + 1)</code> <code>ref.modify(f)</code> \u66f4\u65b0\u3057\u3066\u7d50\u679c\u3092\u8fd4\u3059 <code>counter.modify(n -&gt; ModifyResult.of(n + 1, n))</code> <code>ref.getAndUpdate(f)</code> \u53e4\u3044\u5024\u3092\u8fd4\u3057\u3066\u66f4\u65b0 <code>counter.getAndUpdate(x -&gt; x * 2)</code> <code>ref.updateAndGet(f)</code> \u66f4\u65b0\u3057\u3066\u65b0\u3057\u3044\u5024\u3092\u8fd4\u3059 <code>counter.updateAndGet(x -&gt; x * 2)</code>"},{"location":"java/part-5/#modify","title":"modify \u306e\u4f7f\u7528\u4f8b","text":"<p><code>modify</code> \u306f\u5024\u3092\u66f4\u65b0\u3057\u3064\u3064\u3001\u4f55\u304b\u5225\u306e\u5024\u3092\u8fd4\u3057\u305f\u3044\u5834\u5408\u306b\u4fbf\u5229\u3067\u3059\u3002</p> <pre><code>Ref&lt;Integer&gt; ref = Ref.unsafe(10);\nString result = ref.modify(x -&gt;\n        Ref.ModifyResult.of(x + 1, \"was \" + x)\n).unsafeRun();\n\n// result: \"was 10\"\n// ref \u306e\u5024: 11\n</code></pre>"},{"location":"java/part-5/#105-parallelio-","title":"10.5 ParallelIO - \u4e26\u5217\u5b9f\u884c","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch10/ParallelIO.java</code></p> <p><code>IO.sequence</code> \u306f IO \u3092\u9806\u756a\u306b\u5b9f\u884c\u3057\u307e\u3059\u304c\u3001<code>ParallelIO.parSequence</code> \u306f\u4e26\u5217\u306b\u5b9f\u884c\u3057\u307e\u3059\u3002</p> <pre><code>public final class ParallelIO {\n\n    private static final ExecutorService executor =\n        Executors.newVirtualThreadPerTaskExecutor();\n\n    // IO \u306e\u30ea\u30b9\u30c8\u3092\u4e26\u5217\u306b\u5b9f\u884c\n    public static &lt;A&gt; IO&lt;List&lt;A&gt;&gt; parSequence(List&lt;IO&lt;A&gt;&gt; ios) {\n        return IO.delay(() -&gt; {\n            // \u5404 IO \u3092 CompletableFuture \u3068\u3057\u3066\u975e\u540c\u671f\u5b9f\u884c\n            java.util.List&lt;CompletableFuture&lt;A&gt;&gt; futures = ios\n                    .map(io -&gt; CompletableFuture.supplyAsync(io::unsafeRun, executor))\n                    .toJavaList();\n\n            // \u3059\u3079\u3066\u306e\u5b8c\u4e86\u3092\u5f85\u6a5f\n            CompletableFuture.allOf(futures.toArray(new CompletableFuture[0])).join();\n\n            // \u7d50\u679c\u3092\u53ce\u96c6\n            return List.ofAll(futures.stream().map(CompletableFuture::join).toList());\n        });\n    }\n}\n</code></pre> <p></p>"},{"location":"java/part-5/#_1","title":"\u4e26\u5217\u5b9f\u884c\u306e\u52b9\u679c","text":"<pre><code>List&lt;IO&lt;Integer&gt;&gt; ios = List.of(\n        Fiber.sleep(100).andThen(IO.pure(1)),\n        Fiber.sleep(100).andThen(IO.pure(2)),\n        Fiber.sleep(100).andThen(IO.pure(3))\n);\n\nlong start = System.currentTimeMillis();\nParallelIO.parSequence(ios).unsafeRun();\nlong elapsed = System.currentTimeMillis() - start;\n\n// \u4e26\u5217\u306a\u306e\u3067\u7d04100ms\uff08\u9806\u6b21\u306a\u3089\u7d04300ms\uff09\nassertThat(elapsed).isLessThan(200);\n</code></pre>"},{"location":"java/part-5/#partraverse","title":"parTraverse","text":"<p><code>parTraverse</code> \u306f\u3001\u30ea\u30b9\u30c8\u306e\u5404\u8981\u7d20\u306b IO \u3092\u8fd4\u3059\u95a2\u6570\u3092\u9069\u7528\u3057\u3001\u4e26\u5217\u306b\u5b9f\u884c\u3057\u307e\u3059\u3002</p> <pre><code>public static &lt;A, B&gt; IO&lt;List&lt;B&gt;&gt; parTraverse(\n        List&lt;A&gt; list,\n        Function&lt;A, IO&lt;B&gt;&gt; f) {\n    return parSequence(list.map(f));\n}\n\n// \u4f7f\u7528\u4f8b\nList&lt;Integer&gt; numbers = List.of(1, 2, 3, 4, 5);\n\nList&lt;Integer&gt; result = ParallelIO.parTraverse(\n        numbers,\n        n -&gt; IO.pure(n * 2)\n).unsafeRun();  // List(2, 4, 6, 8, 10)\n</code></pre>"},{"location":"java/part-5/#106","title":"10.6 \u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u51e6\u7406\u306e\u4e26\u884c\u7248","text":"<p>Ref \u3068 ParallelIO \u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u3001\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u3092\u4e26\u884c\u51e6\u7406\u3057\u307e\u3059\u3002</p>"},{"location":"java/part-5/#_2","title":"\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u306e\u4fdd\u5b58","text":"<pre><code>public static IO&lt;Void&gt; storeCheckIn(\n        Ref&lt;Map&lt;City, Integer&gt;&gt; storedCheckIns,\n        City city) {\n    return storedCheckIns.update(current -&gt; updateCheckIns(current, city));\n}\n</code></pre>"},{"location":"java/part-5/#_3","title":"\u4e26\u884c\u51e6\u7406\u7248","text":"<pre><code>public static IO&lt;List&lt;CityStats&gt;&gt; processCheckInsConcurrent(\n        List&lt;City&gt; checkIns,\n        int topN) {\n    return Ref.&lt;Map&lt;City, Integer&gt;&gt;of(HashMap.empty())\n            .flatMap(storedCheckIns -&gt;\n                    // \u3059\u3079\u3066\u306e\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u3092\u4e26\u5217\u306b\u51e6\u7406\n                    ParallelIO.parTraverse(checkIns, city -&gt;\n                            storeCheckIn(storedCheckIns, city))\n                            .andThen(storedCheckIns.get())\n                            .map(cityCheckIns -&gt; topCities(cityCheckIns, topN))\n            );\n}\n</code></pre>"},{"location":"java/part-5/#107-partuple-parmap","title":"10.7 parTuple \u3068 parMap","text":"<p>\u8907\u6570\u306e IO \u3092\u4e26\u5217\u306b\u5b9f\u884c\u3057\u3066\u7d50\u679c\u3092\u7d44\u307f\u5408\u308f\u305b\u308b\u4fbf\u5229\u306a\u30e1\u30bd\u30c3\u30c9\u3067\u3059\u3002</p>"},{"location":"java/part-5/#partuple2-partuple3","title":"parTuple2 / parTuple3","text":"<pre><code>// 2\u3064\u306e IO \u3092\u4e26\u5217\u5b9f\u884c\u3057\u3001\u30bf\u30d7\u30eb\u3067\u8fd4\u3059\nTuple2&lt;Integer, String&gt; result = ParallelIO.parTuple2(\n        IO.pure(42),\n        IO.pure(\"hello\")\n).unsafeRun();\n\n// result._1(): 42\n// result._2(): \"hello\"\n\n// 3\u3064\u306e IO \u3082\u540c\u69d8\nvar result3 = ParallelIO.parTuple3(\n        IO.pure(1),\n        IO.pure(\"two\"),\n        IO.pure(3.0)\n).unsafeRun();\n</code></pre>"},{"location":"java/part-5/#parmap2","title":"parMap2","text":"<pre><code>// 2\u3064\u306e IO \u3092\u4e26\u5217\u5b9f\u884c\u3057\u3066\u7d50\u679c\u3092\u7d50\u5408\nIO&lt;Integer&gt; result = ParallelIO.parMap2(\n        IO.pure(10),\n        IO.pure(20),\n        Integer::sum\n);\n\nresult.unsafeRun();  // 30\n</code></pre>"},{"location":"java/part-5/#108-race-timeout","title":"10.8 race \u3068 timeout","text":""},{"location":"java/part-5/#race-","title":"race - \u7af6\u4e89","text":"<p>2\u3064\u306e IO \u3092\u4e26\u5217\u306b\u5b9f\u884c\u3057\u3001\u6700\u521d\u306b\u5b8c\u4e86\u3057\u305f\u65b9\u306e\u7d50\u679c\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>public static &lt;A&gt; IO&lt;A&gt; race(IO&lt;A&gt; io1, IO&lt;A&gt; io2) {\n    return IO.delay(() -&gt; {\n        CompletableFuture&lt;A&gt; f1 = CompletableFuture.supplyAsync(io1::unsafeRun, executor);\n        CompletableFuture&lt;A&gt; f2 = CompletableFuture.supplyAsync(io2::unsafeRun, executor);\n\n        return CompletableFuture.anyOf(f1, f2)\n                .thenApply(result -&gt; {\n                    f1.cancel(true);\n                    f2.cancel(true);\n                    @SuppressWarnings(\"unchecked\")\n                    A typedResult = (A) result;\n                    return typedResult;\n                })\n                .join();\n    });\n}\n\n// \u4f7f\u7528\u4f8b\nIO&lt;String&gt; slow = Fiber.sleep(200).andThen(IO.pure(\"slow\"));\nIO&lt;String&gt; fast = Fiber.sleep(50).andThen(IO.pure(\"fast\"));\n\nString result = ParallelIO.race(slow, fast).unsafeRun();\n// result: \"fast\"\n</code></pre>"},{"location":"java/part-5/#timeout-","title":"timeout - \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8","text":"<pre><code>public static &lt;A&gt; IO&lt;Option&lt;A&gt;&gt; timeout(IO&lt;A&gt; action, long millis) {\n    return IO.delay(() -&gt; {\n        CompletableFuture&lt;A&gt; future =\n            CompletableFuture.supplyAsync(action::unsafeRun, executor);\n\n        try {\n            A result = future.get(millis, TimeUnit.MILLISECONDS);\n            return Option.some(result);\n        } catch (TimeoutException e) {\n            future.cancel(true);\n            return Option.none();\n        } catch (Exception e) {\n            throw new RuntimeException(e);\n        }\n    });\n}\n\n// \u4f7f\u7528\u4f8b\nIO&lt;Integer&gt; fast = Fiber.sleep(50).andThen(IO.pure(42));\nOption&lt;Integer&gt; result1 = ParallelIO.timeout(fast, 200).unsafeRun();\n// result1: Some(42)\n\nIO&lt;Integer&gt; slow = Fiber.sleep(500).andThen(IO.pure(42));\nOption&lt;Integer&gt; result2 = ParallelIO.timeout(slow, 100).unsafeRun();\n// result2: None\n</code></pre>"},{"location":"java/part-5/#109-fiber-","title":"10.9 Fiber - \u8efd\u91cf\u30b9\u30ec\u30c3\u30c9","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch10/Fiber.java</code></p> <p>Fiber \u306f\u3001IO \u306e\u5b9f\u884c\u3092\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u884c\u3046\u8efd\u91cf\u306a\u5b9f\u884c\u5358\u4f4d\u3067\u3059\u3002Java 21 \u306e\u4eee\u60f3\u30b9\u30ec\u30c3\u30c9\uff08Virtual Thread\uff09\u3092\u6d3b\u7528\u3057\u3066\u3044\u307e\u3059\u3002</p> <p></p>"},{"location":"java/part-5/#fiber","title":"Fiber \u306e\u5b9f\u88c5","text":"<pre><code>public final class Fiber&lt;A&gt; {\n\n    private static final ExecutorService executor =\n        Executors.newVirtualThreadPerTaskExecutor();\n\n    private final CompletableFuture&lt;A&gt; future;\n    private final AtomicBoolean cancelled;\n    private final Future&lt;?&gt; task;\n\n    // IO \u3092\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u8d77\u52d5\u3057\u3001Fiber \u3092\u8fd4\u3059\n    public static &lt;A&gt; IO&lt;Fiber&lt;A&gt;&gt; start(IO&lt;A&gt; io) {\n        return IO.delay(() -&gt; {\n            CompletableFuture&lt;A&gt; future = new CompletableFuture&lt;&gt;();\n            AtomicBoolean cancelled = new AtomicBoolean(false);\n\n            Future&lt;?&gt; task = executor.submit(() -&gt; {\n                try {\n                    if (!cancelled.get()) {\n                        A result = io.unsafeRun();\n                        if (!cancelled.get()) {\n                            future.complete(result);\n                        }\n                    }\n                } catch (Exception e) {\n                    if (!cancelled.get()) {\n                        future.completeExceptionally(e);\n                    }\n                }\n            });\n\n            return new Fiber&lt;&gt;(future, cancelled, task);\n        });\n    }\n}\n</code></pre>"},{"location":"java/part-5/#fiber_1","title":"Fiber \u306e\u8d77\u52d5\u3068\u30ad\u30e3\u30f3\u30bb\u30eb","text":"<pre><code>AtomicInteger counter = new AtomicInteger(0);\n\n// \u7121\u9650\u30eb\u30fc\u30d7\u3059\u308b IO \u3092\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u8d77\u52d5\nFiber&lt;Void&gt; fiber = Fiber.startForever(\n        Fiber.sleep(10).andThen(IO.effect(counter::incrementAndGet))\n).unsafeRun();\n\n// \u3057\u3070\u3089\u304f\u5b9f\u884c\nThread.sleep(100);\nint countBefore = counter.get();\nassertThat(countBefore).isGreaterThan(0);\n\n// \u30ad\u30e3\u30f3\u30bb\u30eb\nfiber.cancel().unsafeRun();\nThread.sleep(50);\n\nint countAfter = counter.get();\n// \u30ad\u30e3\u30f3\u30bb\u30eb\u5f8c\u306f\u5897\u52a0\u3057\u306a\u3044\nassertThat(fiber.isCancelled()).isTrue();\n</code></pre>"},{"location":"java/part-5/#fiber_2","title":"Fiber \u306e\u4e3b\u8981\u30e1\u30bd\u30c3\u30c9","text":"\u30e1\u30bd\u30c3\u30c9 \u8aac\u660e \u4f8b <code>Fiber.start(io)</code> IO \u3092\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u8d77\u52d5 <code>Fiber.start(IO.pure(42))</code> <code>Fiber.startForever(io)</code> \u7121\u9650\u30eb\u30fc\u30d7\u3067\u8d77\u52d5 <code>Fiber.startForever(process)</code> <code>fiber.join()</code> \u5b8c\u4e86\u3092\u5f85\u6a5f\u3057\u7d50\u679c\u3092\u53d6\u5f97 <code>fiber.join().unsafeRun()</code> <code>fiber.cancel()</code> Fiber \u3092\u30ad\u30e3\u30f3\u30bb\u30eb <code>fiber.cancel().unsafeRun()</code> <code>fiber.isDone()</code> \u5b8c\u4e86\u3057\u305f\u304b <code>fiber.isDone()</code> <code>fiber.isCancelled()</code> \u30ad\u30e3\u30f3\u30bb\u30eb\u3055\u308c\u305f\u304b <code>fiber.isCancelled()</code> <code>Fiber.sleep(millis)</code> \u6307\u5b9a\u6642\u9593\u30b9\u30ea\u30fc\u30d7 <code>Fiber.sleep(100)</code> <code>Fiber.delay(millis, io)</code> \u9045\u5ef6\u5b9f\u884c <code>Fiber.delay(100, IO.pure(42))</code>"},{"location":"java/part-5/#1010","title":"10.10 \u547c\u3073\u51fa\u3057\u5143\u306b\u5236\u5fa1\u3092\u8fd4\u3059","text":"<p>Fiber \u3092\u4f7f\u3063\u3066\u3001\u547c\u3073\u51fa\u3057\u5143\u306b\u3059\u3050\u5236\u5fa1\u3092\u8fd4\u3057\u3064\u3064\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u51e6\u7406\u3092\u7d9a\u3051\u308b\u8a2d\u8a08\u304c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>public record ProcessingCheckIns(\n        IO&lt;List&lt;CityStats&gt;&gt; currentRanking,  // \u73fe\u5728\u306e\u30e9\u30f3\u30ad\u30f3\u30b0\u3092\u53d6\u5f97\n        IO&lt;Void&gt; stop                         // \u51e6\u7406\u3092\u505c\u6b62\n) {}\n\npublic static IO&lt;ProcessingCheckIns&gt; processCheckInsBackground(\n        List&lt;City&gt; checkIns,\n        int topN,\n        long updateIntervalMillis) {\n\n    return Ref.&lt;Map&lt;City, Integer&gt;&gt;of(HashMap.empty())\n            .flatMap(storedCheckIns -&gt;\n                    Ref.&lt;List&lt;CityStats&gt;&gt;of(List.empty())\n                            .flatMap(storedRanking -&gt; {\n                                // \u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u51e6\u7406\u30d7\u30ed\u30b0\u30e9\u30e0\n                                IO&lt;Void&gt; checkInsProgram = IO.traverse(\n                                        checkIns,\n                                        city -&gt; storeCheckIn(storedCheckIns, city)\n                                ).map(ignored -&gt; null);\n\n                                // \u30e9\u30f3\u30ad\u30f3\u30b0\u66f4\u65b0\u30d7\u30ed\u30b0\u30e9\u30e0\uff08\u5b9a\u671f\u7684\u306b\u5b9f\u884c\uff09\n                                IO&lt;Void&gt; rankingProgram = IO.delay(() -&gt; {\n                                    updateRanking(storedCheckIns, storedRanking, topN)\n                                        .unsafeRun();\n                                    return null;\n                                });\n\n                                // Fiber \u3068\u3057\u3066\u8d77\u52d5\u3057\u3001\u3059\u3050\u306b\u623b\u308b\n                                return Fiber.start(checkInsProgram)\n                                        .flatMap(checkInsFiber -&gt;\n                                                Fiber.startForever(\n                                                        Fiber.sleep(updateIntervalMillis)\n                                                                .andThen(rankingProgram)\n                                                ).map(rankingFiber -&gt;\n                                                        new ProcessingCheckIns(\n                                                                storedRanking.get(),\n                                                                checkInsFiber.cancel()\n                                                                        .andThen(rankingFiber.cancel())\n                                                        )\n                                                )\n                                        );\n                            })\n            );\n}\n</code></pre> <p></p>"},{"location":"java/part-5/#1011-parfold-","title":"10.11 parFold - \u4e26\u5217\u5b9f\u884c\u3057\u3066\u96c6\u7d04","text":"<pre><code>public static &lt;A, B&gt; IO&lt;B&gt; parFold(\n        List&lt;IO&lt;A&gt;&gt; ios,\n        B initial,\n        BiFunction&lt;B, A, B&gt; f) {\n    return parSequence(ios).map(results -&gt; results.foldLeft(initial, f));\n}\n\n// \u4f7f\u7528\u4f8b\nList&lt;IO&lt;Integer&gt;&gt; ios = List.of(\n        IO.pure(1),\n        IO.pure(2),\n        IO.pure(3),\n        IO.pure(4)\n);\n\nInteger sum = ParallelIO.parFold(ios, 0, Integer::sum).unsafeRun();\n// sum: 10\n</code></pre>"},{"location":"java/part-5/#1012-java-21-virtual-thread","title":"10.12 Java 21 Virtual Thread \u306e\u6d3b\u7528","text":"<p>\u3053\u306e\u5b9f\u88c5\u3067\u306f Java 21 \u306e\u4eee\u60f3\u30b9\u30ec\u30c3\u30c9\uff08Virtual Thread\uff09\u3092\u6d3b\u7528\u3057\u3066\u3044\u307e\u3059\u3002</p> <pre><code>private static final ExecutorService executor =\n    Executors.newVirtualThreadPerTaskExecutor();\n</code></pre> <p>\u4eee\u60f3\u30b9\u30ec\u30c3\u30c9\u306e\u5229\u70b9:</p> <ul> <li>\u8efd\u91cf: \u5f93\u6765\u306e\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u30b9\u30ec\u30c3\u30c9\u3088\u308a\u9065\u304b\u306b\u8efd\u91cf</li> <li>\u30b9\u30b1\u30fc\u30e9\u30d6\u30eb: \u6570\u767e\u4e07\u306e\u540c\u6642\u5b9f\u884c\u304c\u53ef\u80fd</li> <li>\u30d6\u30ed\u30c3\u30ad\u30f3\u30b0 OK: \u30d6\u30ed\u30c3\u30ad\u30f3\u30b0\u64cd\u4f5c\u3067\u3082\u30b9\u30ec\u30c3\u30c9\u30d7\u30fc\u30eb\u3092\u67af\u6e07\u3055\u305b\u306a\u3044</li> <li>\u65e2\u5b58\u30b3\u30fc\u30c9\u3068\u4e92\u63db: \u65e2\u5b58\u306e Java \u30b3\u30fc\u30c9\u3092\u305d\u306e\u307e\u307e\u4f7f\u7528\u53ef\u80fd</li> </ul>"},{"location":"java/part-5/#_4","title":"\u307e\u3068\u3081","text":""},{"location":"java/part-5/#part-v_1","title":"Part V \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"java/part-5/#_5","title":"\u4e3b\u8981\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8","text":"\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8 \u7528\u9014 <code>Ref&lt;A&gt;</code> \u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u5171\u6709\u72b6\u614b <code>ParallelIO.parSequence</code> IO \u306e\u30ea\u30b9\u30c8\u3092\u4e26\u5217\u5b9f\u884c <code>ParallelIO.parTraverse</code> \u30ea\u30b9\u30c8\u306b\u95a2\u6570\u3092\u9069\u7528\u3057\u3066\u4e26\u5217\u5b9f\u884c <code>ParallelIO.race</code> \u6700\u521d\u306b\u5b8c\u4e86\u3057\u305f\u65b9\u3092\u8fd4\u3059 <code>ParallelIO.timeout</code> \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u4ed8\u304d\u5b9f\u884c <code>Fiber</code> \u8efd\u91cf\u306a\u5b9f\u884c\u5358\u4f4d <code>fiber.start</code> Fiber \u3092\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u8d77\u52d5 <code>fiber.cancel</code> Fiber \u3092\u30ad\u30e3\u30f3\u30bb\u30eb"},{"location":"java/part-5/#_6","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>Ref: <code>AtomicReference</code> \u3092\u30e9\u30c3\u30d7\u3057\u3001IO \u30e2\u30ca\u30c9\u3068\u7d71\u5408\u3057\u305f\u30a2\u30c8\u30df\u30c3\u30af\u306a\u53c2\u7167</li> <li>parSequence: IO \u306e\u30ea\u30b9\u30c8\u3092\u4e26\u5217\u5b9f\u884c\u3057\u3066\u7d50\u679c\u3092\u96c6\u7d04</li> <li>Fiber: Java 21 \u306e\u4eee\u60f3\u30b9\u30ec\u30c3\u30c9\u3092\u6d3b\u7528\u3057\u305f\u8efd\u91cf\u306a\u5b9f\u884c\u5358\u4f4d</li> <li>start: Fiber \u3092\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u8d77\u52d5\u3057\u3001\u3059\u3050\u306b\u5236\u5fa1\u3092\u8fd4\u3059</li> <li>race: 2\u3064\u306e IO \u3092\u7af6\u4e89\u3055\u305b\u3001\u6700\u521d\u306b\u5b8c\u4e86\u3057\u305f\u65b9\u3092\u63a1\u7528</li> <li>timeout: \u6307\u5b9a\u6642\u9593\u5185\u306b\u5b8c\u4e86\u3057\u306a\u3051\u308c\u3070 None \u3092\u8fd4\u3059</li> </ol>"},{"location":"java/part-5/#_7","title":"\u8a2d\u8a08\u30d1\u30bf\u30fc\u30f3","text":""},{"location":"java/part-5/#scala","title":"Scala \u3068\u306e\u6bd4\u8f03","text":"\u6982\u5ff5 Scala (cats-effect) Java + Vavr \u30a2\u30c8\u30df\u30c3\u30af\u53c2\u7167 <code>Ref[IO, A]</code> <code>Ref&lt;A&gt;</code> (\u72ec\u81ea\u5b9f\u88c5) \u4e26\u5217\u5b9f\u884c <code>parSequence</code> <code>ParallelIO.parSequence</code> \u8efd\u91cf\u30b9\u30ec\u30c3\u30c9 <code>Fiber[IO, A]</code> <code>Fiber&lt;A&gt;</code> (Virtual Thread) Fiber \u8d77\u52d5 <code>io.start</code> <code>Fiber.start(io)</code> \u30ad\u30e3\u30f3\u30bb\u30eb <code>fiber.cancel</code> <code>fiber.cancel()</code> \u7af6\u4e89 <code>IO.race(io1, io2)</code> <code>ParallelIO.race(io1, io2)</code> \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8 <code>io.timeout(duration)</code> <code>ParallelIO.timeout(io, millis)</code>"},{"location":"java/part-5/#_8","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"java/part-5/#1-ref","title":"\u554f\u984c 1: Ref \u306e\u57fa\u672c","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u30ab\u30a6\u30f3\u30bf\u30fc\u3092 0 \u304b\u3089\u59cb\u3081\u3066\u30013\u56de\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\u3057\u305f\u7d50\u679c\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>public static IO&lt;Integer&gt; incrementThreeTimes() {\n    // ???\n}\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nincrementThreeTimes().unsafeRun();  // 3\n</code></pre> \u89e3\u7b54 <pre><code>public static IO&lt;Integer&gt; incrementThreeTimes() {\n    return Ref.of(0)\n            .flatMap(counter -&gt;\n                    counter.update(x -&gt; x + 1)\n                            .andThen(counter.update(x -&gt; x + 1))\n                            .andThen(counter.update(x -&gt; x + 1))\n                            .andThen(counter.get())\n            );\n}\n</code></pre>"},{"location":"java/part-5/#2","title":"\u554f\u984c 2: \u4e26\u5217\u5b9f\u884c","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u30023\u3064\u306e IO \u3092\u4e26\u5217\u5b9f\u884c\u3057\u3001\u7d50\u679c\u306e\u5408\u8a08\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>public static IO&lt;Integer&gt; sumParallel(IO&lt;Integer&gt; io1, IO&lt;Integer&gt; io2, IO&lt;Integer&gt; io3) {\n    // ???\n}\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nsumParallel(IO.pure(1), IO.pure(2), IO.pure(3)).unsafeRun();  // 6\n</code></pre> \u89e3\u7b54 <pre><code>public static IO&lt;Integer&gt; sumParallel(IO&lt;Integer&gt; io1, IO&lt;Integer&gt; io2, IO&lt;Integer&gt; io3) {\n    return ParallelIO.parSequence(List.of(io1, io2, io3))\n            .map(list -&gt; list.foldLeft(0, Integer::sum));\n}\n\n// \u307e\u305f\u306f parFold \u3092\u4f7f\u7528\npublic static IO&lt;Integer&gt; sumParallel(IO&lt;Integer&gt; io1, IO&lt;Integer&gt; io2, IO&lt;Integer&gt; io3) {\n    return ParallelIO.parFold(List.of(io1, io2, io3), 0, Integer::sum);\n}\n</code></pre>"},{"location":"java/part-5/#3","title":"\u554f\u984c 3: \u4e26\u884c\u30ab\u30a6\u30f3\u30c8","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002IO \u306e\u30ea\u30b9\u30c8\u3092\u4e26\u884c\u5b9f\u884c\u3057\u3001\u305d\u306e\u3046\u3061\u5076\u6570\u3092\u8fd4\u3057\u305f\u56de\u6570\u3092\u30ab\u30a6\u30f3\u30c8\u3057\u307e\u3059\u3002</p> <pre><code>public static IO&lt;Integer&gt; countEvens(List&lt;IO&lt;Integer&gt;&gt; ios) {\n    // ???\n}\n\n// \u4f7f\u7528\u4f8b\nList&lt;IO&lt;Integer&gt;&gt; ios = List.range(0, 100).map(IO::pure);\ncountEvens(ios).unsafeRun();  // 50\n</code></pre> \u89e3\u7b54 <pre><code>public static IO&lt;Integer&gt; countEvens(List&lt;IO&lt;Integer&gt;&gt; ios) {\n    return Ref.of(0)\n            .flatMap(counter -&gt;\n                    ParallelIO.parTraverse(ios, io -&gt;\n                            io.flatMap(n -&gt;\n                                    n % 2 == 0\n                                            ? counter.update(x -&gt; x + 1)\n                                            : IO.unit()\n                            )\n                    ).andThen(counter.get())\n            );\n}\n</code></pre>"},{"location":"java/part-5/#4","title":"\u554f\u984c 4: \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u4ed8\u304d\u5b9f\u884c","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u6307\u5b9a\u6642\u9593\u5f8c\u306b Fiber \u3092\u30ad\u30e3\u30f3\u30bb\u30eb\u3057\u3001\u305d\u308c\u307e\u3067\u306b\u84c4\u7a4d\u3055\u308c\u305f\u7d50\u679c\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>public static IO&lt;List&lt;Integer&gt;&gt; collectFor(long durationMillis) {\n    // 100ms\u3054\u3068\u306b\u4e71\u6570\u3092\u751f\u6210\u3057\u3066\u30ea\u30b9\u30c8\u306b\u8ffd\u52a0\n    // \u6307\u5b9a\u6642\u9593\u5f8c\u306b\u505c\u6b62\u3057\u3066\u7d50\u679c\u3092\u8fd4\u3059\n    // ???\n}\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\n// 1\u79d2\u9593\u5b9f\u884c\u3059\u308b\u3068\u7d0410\u500b\u306e\u8981\u7d20\u304c\u8fd4\u3055\u308c\u308b\ncollectFor(1000).unsafeRun();\n</code></pre> \u89e3\u7b54 <pre><code>public static IO&lt;List&lt;Integer&gt;&gt; collectFor(long durationMillis) {\n    return Ref.&lt;List&lt;Integer&gt;&gt;of(List.empty())\n            .flatMap(collected -&gt; {\n                Random random = new Random();\n\n                // 100ms\u3054\u3068\u306b\u4e71\u6570\u3092\u8ffd\u52a0\u3059\u308b\u30d7\u30ed\u30b0\u30e9\u30e0\n                IO&lt;Void&gt; producer = Fiber.sleep(100)\n                        .andThen(IO.delay(() -&gt; random.nextInt(100)))\n                        .flatMap(n -&gt; collected.update(list -&gt; list.append(n)));\n\n                return Fiber.startForever(producer)\n                        .flatMap(fiber -&gt;\n                                Fiber.sleep(durationMillis)\n                                        .andThen(fiber.cancel())\n                                        .andThen(collected.get())\n                        );\n            });\n}\n</code></pre>"},{"location":"java/part-5/#5","title":"\u554f\u984c 5: \u4e26\u884c\u30de\u30c3\u30d7\u66f4\u65b0","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u8907\u6570\u306e\u66f4\u65b0\u3092\u4e26\u884c\u3057\u3066 Map \u306b\u9069\u7528\u3057\u3001\u6700\u7d42\u7684\u306a Map \u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>record Update(String key, int value) {}\n\npublic static IO&lt;Map&lt;String, Integer&gt;&gt; applyUpdates(List&lt;Update&gt; updates) {\n    // ???\n}\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nList&lt;Update&gt; updates = List.of(\n    new Update(\"a\", 1),\n    new Update(\"b\", 2),\n    new Update(\"a\", 3),  // \"a\" \u3092\u4e0a\u66f8\u304d\n    new Update(\"c\", 4)\n);\napplyUpdates(updates).unsafeRun();  // HashMap(a -&gt; 3, b -&gt; 2, c -&gt; 4)\n</code></pre> \u89e3\u7b54 <pre><code>record Update(String key, int value) {}\n\npublic static IO&lt;Map&lt;String, Integer&gt;&gt; applyUpdates(List&lt;Update&gt; updates) {\n    return Ref.&lt;Map&lt;String, Integer&gt;&gt;of(HashMap.empty())\n            .flatMap(mapRef -&gt;\n                    ParallelIO.parTraverse(updates, update -&gt;\n                            mapRef.update(m -&gt; m.put(update.key(), update.value()))\n                    ).andThen(mapRef.get())\n            );\n}\n</code></pre>  \u6ce8\u610f: \u4e26\u884c\u5b9f\u884c\u306a\u306e\u3067\u3001\u540c\u3058\u30ad\u30fc\u3078\u306e\u8907\u6570\u306e\u66f4\u65b0\u304c\u3042\u308b\u5834\u5408\u3001\u6700\u7d42\u7684\u306a\u5024\u306f\u5b9f\u884c\u9806\u5e8f\u306b\u4f9d\u5b58\u3057\u307e\u3059\u3002"},{"location":"java/part-6/","title":"Part VI: \u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u3068\u30c6\u30b9\u30c8","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u3053\u308c\u307e\u3067\u5b66\u3093\u3060\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u6982\u5ff5\u3092\u7d71\u5408\u3057\u3001\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002\u307e\u305f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u30c6\u30b9\u30c8\u6226\u7565\u306b\u3064\u3044\u3066\u3082\u5b66\u3073\u307e\u3059\u3002</p>"},{"location":"java/part-6/#11","title":"\u7b2c11\u7ae0: \u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9","text":""},{"location":"java/part-6/#111-travelguide","title":"11.1 TravelGuide \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3","text":"<p>\u65c5\u884c\u30ac\u30a4\u30c9\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f8b\u306b\u3001\u5b9f\u8df5\u7684\u306a FP \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u69cb\u7bc9\u65b9\u6cd5\u3092\u5b66\u3073\u307e\u3059\u3002</p> <p></p>"},{"location":"java/part-6/#112","title":"11.2 \u30c9\u30e1\u30a4\u30f3\u30e2\u30c7\u30eb\u306e\u5b9a\u7fa9","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch11/TravelGuide.java</code></p> <pre><code>// \u4f4d\u7f6e\u60c5\u5831\u3092\u8868\u3059\u5024\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\npublic record LocationId(String value) {\n    public LocationId {\n        Objects.requireNonNull(value, \"LocationId value cannot be null\");\n    }\n}\n\n// \u30ed\u30b1\u30fc\u30b7\u30e7\u30f3\npublic record Location(LocationId id, String name, int population) {\n    public Location {\n        Objects.requireNonNull(id, \"Location id cannot be null\");\n        Objects.requireNonNull(name, \"Location name cannot be null\");\n    }\n}\n\n// \u30a2\u30c8\u30e9\u30af\u30b7\u30e7\u30f3\uff08\u89b3\u5149\u5730\uff09\npublic record Attraction(\n        String name,\n        Option&lt;String&gt; description,\n        Location location\n) {\n    public Attraction {\n        Objects.requireNonNull(name, \"Attraction name cannot be null\");\n        Objects.requireNonNull(description, \"Attraction description cannot be null\");\n        Objects.requireNonNull(location, \"Attraction location cannot be null\");\n    }\n}\n\n// \u30dd\u30c3\u30d7\u30ab\u30eb\u30c1\u30e3\u30fc\u306e\u984c\u6750\uff08sealed interface\uff09\npublic sealed interface PopCultureSubject permits Artist, Movie {\n    String name();\n}\n\n// \u30a2\u30fc\u30c6\u30a3\u30b9\u30c8\npublic record Artist(String name, int followers) implements PopCultureSubject {\n    public Artist {\n        Objects.requireNonNull(name, \"Artist name cannot be null\");\n    }\n}\n\n// \u6620\u753b\npublic record Movie(String name, int boxOffice) implements PopCultureSubject {\n    public Movie {\n        Objects.requireNonNull(name, \"Movie name cannot be null\");\n    }\n}\n\n// \u65c5\u884c\u30ac\u30a4\u30c9\npublic record Guide(\n        Attraction attraction,\n        List&lt;PopCultureSubject&gt; subjects\n) {\n    public Guide {\n        Objects.requireNonNull(attraction, \"Guide attraction cannot be null\");\n        Objects.requireNonNull(subjects, \"Guide subjects cannot be null\");\n    }\n}\n</code></pre> <p>Java 17 \u306e <code>record</code> \u3068 <code>sealed interface</code> \u3092\u6d3b\u7528\u3057\u3066\u3001Scala \u306e case class \u3068 ADT \u3092\u8868\u73fe\u3057\u3066\u3044\u307e\u3059\u3002</p>"},{"location":"java/part-6/#113","title":"11.3 \u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\u5c64\u306e\u62bd\u8c61\u5316","text":"<p>\u5916\u90e8\u30c7\u30fc\u30bf\u30bd\u30fc\u30b9\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3067\u62bd\u8c61\u5316\u3057\u307e\u3059\u3002</p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch11/DataAccess.java</code></p> <pre><code>public interface DataAccess {\n    IO&lt;List&lt;Attraction&gt;&gt; findAttractions(\n            String name,\n            AttractionOrdering ordering,\n            int limit\n    );\n\n    IO&lt;List&lt;Artist&gt;&gt; findArtistsFromLocation(\n            LocationId locationId,\n            int limit\n    );\n\n    IO&lt;List&lt;Movie&gt;&gt; findMoviesAboutLocation(\n            LocationId locationId,\n            int limit\n    );\n}\n</code></pre> <p></p>"},{"location":"java/part-6/#114-resource","title":"11.4 Resource \u306b\u3088\u308b\u30ea\u30bd\u30fc\u30b9\u7ba1\u7406","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch11/Resource.java</code></p> <p><code>Resource</code> \u306f\u3001\u30ea\u30bd\u30fc\u30b9\u306e\u53d6\u5f97\uff08acquire\uff09\u3068\u89e3\u653e\uff08release\uff09\u3092\u5b89\u5168\u306b\u7ba1\u7406\u3059\u308b\u305f\u3081\u306e\u578b\u3067\u3059\u3002cats-effect \u306e <code>Resource</code> \u306b\u76f8\u5f53\u3059\u308b\u6a5f\u80fd\u3092\u63d0\u4f9b\u3057\u307e\u3059\u3002</p> <pre><code>public final class Resource&lt;A&gt; {\n\n    private final IO&lt;A&gt; acquire;\n    private final Consumer&lt;A&gt; release;\n\n    private Resource(IO&lt;A&gt; acquire, Consumer&lt;A&gt; release) {\n        this.acquire = acquire;\n        this.release = release;\n    }\n\n    // \u30ea\u30bd\u30fc\u30b9\u3092\u4f5c\u6210\n    public static &lt;A&gt; Resource&lt;A&gt; make(IO&lt;A&gt; acquire, Consumer&lt;A&gt; release) {\n        return new Resource&lt;&gt;(acquire, release);\n    }\n\n    // AutoCloseable \u304b\u3089\u30ea\u30bd\u30fc\u30b9\u3092\u4f5c\u6210\n    public static &lt;A extends AutoCloseable&gt; Resource&lt;A&gt; fromAutoCloseable(IO&lt;A&gt; acquire) {\n        return new Resource&lt;&gt;(acquire, a -&gt; {\n            try {\n                a.close();\n            } catch (Exception e) {\n                throw new RuntimeException(\"Failed to close resource\", e);\n            }\n        });\n    }\n\n    // \u30ea\u30bd\u30fc\u30b9\u3092\u4f7f\u7528\u3057\u3066\u51e6\u7406\u3092\u5b9f\u884c\n    // \u30ea\u30bd\u30fc\u30b9\u306f\u51e6\u7406\u5b8c\u4e86\u5f8c\uff08\u6210\u529f\u30fb\u5931\u6557\u554f\u308f\u305a\uff09\u306b\u5fc5\u305a\u89e3\u653e\u3055\u308c\u308b\n    public &lt;B&gt; IO&lt;B&gt; use(Function&lt;A, IO&lt;B&gt;&gt; f) {\n        return acquire.flatMap(resource -&gt;\n                f.apply(resource)\n                        .guarantee(IO.effect(() -&gt; release.accept(resource)))\n        );\n    }\n}\n</code></pre>"},{"location":"java/part-6/#resource","title":"Resource \u306e\u4f7f\u7528\u4f8b","text":"<pre><code>// \u30d5\u30a1\u30a4\u30eb\u30ea\u30bd\u30fc\u30b9\u306e\u4f8b\nResource&lt;BufferedReader&gt; fileResource = Resource.fromAutoCloseable(\n        IO.delay(() -&gt; new BufferedReader(new FileReader(\"data.txt\")))\n);\n\n// \u30ea\u30bd\u30fc\u30b9\u3092\u4f7f\u7528\u3057\u3066\u51e6\u7406\u3092\u5b9f\u884c\nIO&lt;String&gt; readFirstLine = fileResource.use(reader -&gt;\n        IO.delay(reader::readLine)\n);\n\n// \u30d5\u30a1\u30a4\u30eb\u306f\u81ea\u52d5\u7684\u306b\u30af\u30ed\u30fc\u30ba\u3055\u308c\u308b\nString firstLine = readFirstLine.unsafeRun();\n</code></pre>"},{"location":"java/part-6/#guarantee","title":"guarantee \u30e1\u30bd\u30c3\u30c9","text":"<p><code>IO</code> \u30af\u30e9\u30b9\u306b\u8ffd\u52a0\u3057\u305f <code>guarantee</code> \u30e1\u30bd\u30c3\u30c9\u306f\u3001\u6210\u529f\u30fb\u5931\u6557\u306b\u304b\u304b\u308f\u3089\u305a\u5fc5\u305a\u5b9f\u884c\u3055\u308c\u308b\u51e6\u7406\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002</p> <pre><code>// IO \u30af\u30e9\u30b9\u306e guarantee \u30e1\u30bd\u30c3\u30c9\npublic IO&lt;A&gt; guarantee(IO&lt;Void&gt; finalizer) {\n    return new IO&lt;&gt;(() -&gt; {\n        try {\n            return thunk.get();\n        } finally {\n            try {\n                finalizer.unsafeRun();\n            } catch (Exception ignored) {\n                // finalizer \u306e\u30a8\u30e9\u30fc\u306f\u7121\u8996\n            }\n        }\n    });\n}\n</code></pre>"},{"location":"java/part-6/#115","title":"11.5 \u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u5b9f\u88c5","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch11/CachedDataAccess.java</code></p> <p><code>Ref</code> \u3092\u4f7f\u7528\u3057\u305f\u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u5b9f\u88c5:</p> <pre><code>public final class CachedDataAccess implements DataAccess {\n\n    private final DataAccess underlying;\n    private final Ref&lt;Map&lt;String, Object&gt;&gt; cache;\n\n    private CachedDataAccess(DataAccess underlying, Ref&lt;Map&lt;String, Object&gt;&gt; cache) {\n        this.underlying = underlying;\n        this.cache = cache;\n    }\n\n    // IO \u7d4c\u7531\u3067\u30ad\u30e3\u30c3\u30b7\u30e5\u4ed8\u304d DataAccess \u3092\u4f5c\u6210\n    public static IO&lt;DataAccess&gt; create(DataAccess underlying) {\n        return Ref.&lt;Map&lt;String, Object&gt;&gt;of(HashMap.empty())\n                .map(cache -&gt; new CachedDataAccess(underlying, cache));\n    }\n\n    @Override\n    public IO&lt;List&lt;Attraction&gt;&gt; findAttractions(\n            String name,\n            AttractionOrdering ordering,\n            int limit) {\n        String key = \"attractions:\" + name + \":\" + ordering + \":\" + limit;\n        return getOrCompute(key, () -&gt; underlying.findAttractions(name, ordering, limit));\n    }\n\n    @SuppressWarnings(\"unchecked\")\n    private &lt;T&gt; IO&lt;T&gt; getOrCompute(String key, Supplier&lt;IO&lt;T&gt;&gt; compute) {\n        return cache.get()\n                .flatMap(currentCache -&gt;\n                        currentCache.get(key)\n                                .map(cached -&gt; IO.pure((T) cached))\n                                .getOrElse(() -&gt;\n                                        compute.get().flatMap(result -&gt;\n                                                cache.update(c -&gt; c.put(key, result))\n                                                        .andThen(IO.pure(result))\n                                        )\n                                )\n                );\n    }\n\n    // ... \u4ed6\u306e\u30e1\u30bd\u30c3\u30c9\u3082\u540c\u69d8\n}\n</code></pre> <p></p>"},{"location":"java/part-6/#116","title":"11.6 \u30ac\u30a4\u30c9\u30b9\u30b3\u30a2\u306e\u8a08\u7b97","text":"<p>\u7d14\u7c8b\u95a2\u6570\u3067\u30ac\u30a4\u30c9\u306e\u30b9\u30b3\u30a2\u3092\u8a08\u7b97\u3057\u307e\u3059:</p> <pre><code>/**\n * \u30ac\u30a4\u30c9\u306e\u30b9\u30b3\u30a2\u3092\u8a08\u7b97\n *\n * \u8981\u4ef6:\n * - 30 \u70b9: \u8aac\u660e\u304c\u3042\u308b\u5834\u5408\n * - 10 \u70b9/\u4ef6: \u30a2\u30fc\u30c6\u30a3\u30b9\u30c8\u307e\u305f\u306f\u6620\u753b\uff08\u6700\u5927 40 \u70b9\uff09\n * - 1 \u70b9/100,000 \u30d5\u30a9\u30ed\u30ef\u30fc: \u5168\u30a2\u30fc\u30c6\u30a3\u30b9\u30c8\u5408\u8a08\uff08\u6700\u5927 15 \u70b9\uff09\n * - 1 \u70b9/10,000,000 \u30c9\u30eb: \u5168\u6620\u753b\u306e\u8208\u884c\u53ce\u5165\u5408\u8a08\uff08\u6700\u5927 15 \u70b9\uff09\n */\npublic static int guideScore(Guide guide) {\n    int descriptionScore = guide.attraction().description().isDefined() ? 30 : 0;\n    int quantityScore = Math.min(40, guide.subjects().size() * 10);\n\n    // Long \u3092\u4f7f\u7528\u3057\u3066\u30aa\u30fc\u30d0\u30fc\u30d5\u30ed\u30fc\u3092\u9632\u3050\n    long totalFollowers = guide.subjects()\n            .filter(s -&gt; s instanceof Artist)\n            .map(s -&gt; (long) ((Artist) s).followers())\n            .sum().longValue();\n\n    long totalBoxOffice = guide.subjects()\n            .filter(s -&gt; s instanceof Movie)\n            .map(s -&gt; (long) ((Movie) s).boxOffice())\n            .sum().longValue();\n\n    int followersScore = (int) Math.min(15, totalFollowers / 100_000);\n    int boxOfficeScore = (int) Math.min(15, totalBoxOffice / 10_000_000);\n\n    return descriptionScore + quantityScore + followersScore + boxOfficeScore;\n}\n</code></pre> <p>\u91cd\u8981\u306a\u30dd\u30a4\u30f3\u30c8: - \u30aa\u30fc\u30d0\u30fc\u30d5\u30ed\u30fc\u9632\u6b62: <code>long</code> \u3092\u4f7f\u7528\u3057\u3066\u5927\u304d\u306a\u6570\u5024\u306e\u5408\u8a08\u3092\u5b89\u5168\u306b\u8a08\u7b97 - \u4e0a\u9650\u5024\u306e\u8a2d\u5b9a: \u5404\u30b9\u30b3\u30a2\u6210\u5206\u306b\u6700\u5927\u5024\u3092\u8a2d\u5b9a\u3057\u3066\u30b9\u30b3\u30a2\u3092 0-100 \u306e\u7bc4\u56f2\u306b</p>"},{"location":"java/part-6/#117","title":"11.7 \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u7d44\u307f\u7acb\u3066","text":"<p>\u3059\u3079\u3066\u306e\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002</p>"},{"location":"java/part-6/#1","title":"\u30d0\u30fc\u30b8\u30e7\u30f3 1: \u57fa\u672c\u7684\u306a\u5b9f\u88c5","text":"<pre><code>public static IO&lt;Option&lt;Guide&gt;&gt; travelGuideV1(\n        DataAccess dataAccess,\n        String attractionName) {\n\n    return dataAccess.findAttractions(attractionName, AttractionOrdering.BY_LOCATION_POPULATION, 1)\n            .flatMap(attractions -&gt; attractions.headOption()\n                    .map(attraction -&gt;\n                            dataAccess.findArtistsFromLocation(attraction.location().id(), 2)\n                                    .flatMap(artists -&gt;\n                                            dataAccess.findMoviesAboutLocation(attraction.location().id(), 2)\n                                                    .map(movies -&gt; {\n                                                        List&lt;PopCultureSubject&gt; subjects = List.&lt;PopCultureSubject&gt;empty()\n                                                                .appendAll(artists)\n                                                                .appendAll(movies);\n                                                        return Option.some(new Guide(attraction, subjects));\n                                                    })\n                                    )\n                    )\n                    .getOrElse(IO.pure(Option.none()))\n            );\n}\n</code></pre>"},{"location":"java/part-6/#2","title":"\u30d0\u30fc\u30b8\u30e7\u30f3 2: \u8907\u6570\u5019\u88dc\u304b\u3089\u30d9\u30b9\u30c8\u3092\u9078\u629e","text":"<pre><code>public static IO&lt;Option&lt;Guide&gt;&gt; travelGuideV2(\n        DataAccess dataAccess,\n        String attractionName) {\n\n    return dataAccess.findAttractions(attractionName, AttractionOrdering.BY_LOCATION_POPULATION, 3)\n            .flatMap(attractions -&gt;\n                    IO.traverse(attractions, attraction -&gt;\n                            dataAccess.findArtistsFromLocation(attraction.location().id(), 2)\n                                    .flatMap(artists -&gt;\n                                            dataAccess.findMoviesAboutLocation(attraction.location().id(), 2)\n                                                    .map(movies -&gt; {\n                                                        List&lt;PopCultureSubject&gt; subjects = List.&lt;PopCultureSubject&gt;empty()\n                                                                .appendAll(artists)\n                                                                .appendAll(movies);\n                                                        return new Guide(attraction, subjects);\n                                                    })\n                                    )\n                    ).map(TravelGuide::findBestGuide)\n            );\n}\n</code></pre>"},{"location":"java/part-6/#3","title":"\u30d0\u30fc\u30b8\u30e7\u30f3 3: \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u4ed8\u304d","text":"<pre><code>public static IO&lt;Either&lt;SearchReport, Guide&gt;&gt; travelGuideV3(\n        DataAccess dataAccess,\n        String attractionName) {\n\n    return dataAccess.findAttractions(attractionName, AttractionOrdering.BY_LOCATION_POPULATION, 3)\n            .attempt()\n            .flatMap(attractionsResult -&gt;\n                    attractionsResult.fold(\n                            error -&gt; IO.pure(Either.left(\n                                    SearchReport.withProblems(List.of(error.getMessage())))),\n                            attractions -&gt;\n                                    IO.traverse(attractions, attraction -&gt;\n                                                    guideForAttraction(dataAccess, attraction).attempt()\n                                            )\n                                            .map(TravelGuide::processGuideResults)\n                    )\n            );\n}\n</code></pre>"},{"location":"java/part-6/#118-attempt","title":"11.8 attempt \u30e1\u30bd\u30c3\u30c9\u306b\u3088\u308b\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":"<p><code>IO</code> \u30af\u30e9\u30b9\u306b\u8ffd\u52a0\u3057\u305f <code>attempt</code> \u30e1\u30bd\u30c3\u30c9\u306f\u3001\u4f8b\u5916\u3092 <code>Either</code> \u306b\u5909\u63db\u3057\u307e\u3059:</p> <pre><code>// IO \u30af\u30e9\u30b9\u306e attempt \u30e1\u30bd\u30c3\u30c9\npublic IO&lt;Either&lt;Throwable, A&gt;&gt; attempt() {\n    return new IO&lt;&gt;(() -&gt; {\n        try {\n            return Either.right(thunk.get());\n        } catch (Throwable e) {\n            return Either.left(e);\n        }\n    });\n}\n</code></pre> <p>\u3053\u308c\u306b\u3088\u308a\u3001\u4f8b\u5916\u3092\u5024\u3068\u3057\u3066\u6271\u3046\u3053\u3068\u304c\u3067\u304d\u3001\u95a2\u6570\u578b\u306e\u65b9\u6cd5\u3067\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u304c\u3067\u304d\u307e\u3059\u3002</p>"},{"location":"java/part-6/#12","title":"\u7b2c12\u7ae0: \u30c6\u30b9\u30c8\u6226\u7565","text":""},{"location":"java/part-6/#121","title":"12.1 \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u30c6\u30b9\u30c8","text":"<p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u3067\u306f\u3001\u7d14\u7c8b\u95a2\u6570\u306e\u304a\u304b\u3052\u3067\u30c6\u30b9\u30c8\u304c\u975e\u5e38\u306b\u7c21\u5358\u306b\u306a\u308a\u307e\u3059\u3002</p> <p></p>"},{"location":"java/part-6/#122-searchreport","title":"12.2 SearchReport \u306e\u5c0e\u5165","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch11/TravelGuide.java</code></p> <p>\u30c6\u30b9\u30c8\u53ef\u80fd\u6027\u3092\u9ad8\u3081\u308b\u305f\u3081\u3001<code>SearchReport</code> \u3092\u5c0e\u5165\u3057\u307e\u3059\u3002</p> <pre><code>/**\n * \u691c\u7d22\u30ec\u30dd\u30fc\u30c8\uff08\u30a8\u30e9\u30fc\u3084\u4e0d\u5341\u5206\u306a\u7d50\u679c\u3092\u5831\u544a\uff09\n */\npublic record SearchReport(\n        List&lt;Guide&gt; badGuides,\n        List&lt;String&gt; problems\n) {\n    public SearchReport {\n        Objects.requireNonNull(badGuides, \"SearchReport badGuides cannot be null\");\n        Objects.requireNonNull(problems, \"SearchReport problems cannot be null\");\n    }\n\n    public static SearchReport empty() {\n        return new SearchReport(List.empty(), List.empty());\n    }\n\n    public static SearchReport withProblems(List&lt;String&gt; problems) {\n        return new SearchReport(List.empty(), problems);\n    }\n\n    public static SearchReport withBadGuides(List&lt;Guide&gt; badGuides) {\n        return new SearchReport(badGuides, List.empty());\n    }\n}\n</code></pre> <p></p>"},{"location":"java/part-6/#123-testdataaccess-","title":"12.3 TestDataAccess - \u30c6\u30b9\u30c8\u7528\u30b9\u30bf\u30d6","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/test/java/ch12/TestDataAccess.java</code></p> <p>Builder \u30d1\u30bf\u30fc\u30f3\u3092\u4f7f\u7528\u3057\u305f\u30c6\u30b9\u30c8\u7528\u30b9\u30bf\u30d6:</p> <pre><code>public class TestDataAccess implements DataAccess {\n\n    // \u30d3\u30eb\u30c0\u30fc\u30d1\u30bf\u30fc\u30f3\u3067\u4f5c\u6210\n    public static Builder builder() {\n        return new Builder();\n    }\n\n    // \u7a7a\u306e DataAccess \u3092\u4f5c\u6210\n    public static DataAccess empty() {\n        return builder().build();\n    }\n\n    // \u30d5\u30a1\u30af\u30c8\u30ea\u30e1\u30bd\u30c3\u30c9\n    public static DataAccess withAttractions(Attraction... attractions) {\n        return builder().withAttractions(attractions).build();\n    }\n\n    public static class Builder {\n        private List&lt;Attraction&gt; attractions = List.empty();\n        private List&lt;Artist&gt; artists = List.empty();\n        private List&lt;Movie&gt; movies = List.empty();\n        private String attractionsError = null;\n        private String artistsError = null;\n        private String moviesError = null;\n\n        public Builder withAttractions(Attraction... attractions) {\n            this.attractions = List.of(attractions);\n            return this;\n        }\n\n        public Builder withArtists(Artist... artists) {\n            this.artists = List.of(artists);\n            return this;\n        }\n\n        public Builder withMovies(Movie... movies) {\n            this.movies = List.of(movies);\n            return this;\n        }\n\n        public Builder failOnAttractions(String errorMessage) {\n            this.attractionsError = errorMessage;\n            return this;\n        }\n\n        public Builder failOnArtists(String errorMessage) {\n            this.artistsError = errorMessage;\n            return this;\n        }\n\n        public Builder failOnMovies(String errorMessage) {\n            this.moviesError = errorMessage;\n            return this;\n        }\n\n        public TestDataAccess build() {\n            return new TestDataAccess(this);\n        }\n    }\n}\n</code></pre> <p></p>"},{"location":"java/part-6/#testdataaccess","title":"TestDataAccess \u306e\u4f7f\u7528\u4f8b","text":"<pre><code>// \u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u306e\u6e96\u5099\nstatic final Location LONDON = new Location(\n        new LocationId(\"Q84\"),\n        \"London\",\n        8_908_081\n);\n\nstatic final Attraction TOWER_BRIDGE = new Attraction(\n        \"Tower Bridge\",\n        Option.none(),\n        LONDON\n);\n\nstatic final Artist QUEEN = new Artist(\"Queen\", 2_050_559);\nstatic final Movie INSIDE_OUT = new Movie(\"Inside Out\", 857_611_174);\n\n// \u6b63\u5e38\u7cfb\u306e\u30c6\u30b9\u30c8\n@Test\nvoid withAllData() {\n    DataAccess dataAccess = TestDataAccess.of(\n            List.of(TOWER_BRIDGE),\n            List.of(QUEEN),\n            List.of(INSIDE_OUT)\n    );\n\n    assertThat(dataAccess.findAttractions(\"test\", AttractionOrdering.BY_NAME, 10).unsafeRun())\n            .containsExactly(TOWER_BRIDGE);\n    assertThat(dataAccess.findArtistsFromLocation(LONDON.id(), 10).unsafeRun())\n            .containsExactly(QUEEN);\n    assertThat(dataAccess.findMoviesAboutLocation(LONDON.id(), 10).unsafeRun())\n            .containsExactly(INSIDE_OUT);\n}\n\n// \u30a8\u30e9\u30fc\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\n@Test\nvoid failOnAttractions() {\n    DataAccess dataAccess = TestDataAccess.builder()\n            .failOnAttractions(\"Network error\")\n            .build();\n\n    assertThatThrownBy(() -&gt;\n            dataAccess.findAttractions(\"test\", AttractionOrdering.BY_NAME, 10).unsafeRun()\n    ).isInstanceOf(RuntimeException.class)\n            .hasMessage(\"Network error\");\n}\n</code></pre>"},{"location":"java/part-6/#124","title":"12.4 \u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/test/java/ch12/PropertyBasedTest.java</code></p> <p>JUnit 5 \u306e <code>@RepeatedTest</code> \u3092\u4f7f\u7528\u3057\u305f\u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8:</p> <pre><code>// \u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306e\u5b9a\u7fa9\nstatic int nonNegativeInt() {\n    return random.nextInt(Integer.MAX_VALUE);\n}\n\nstatic String randomString() {\n    int length = random.nextInt(20) + 1;\n    StringBuilder sb = new StringBuilder();\n    for (int i = 0; i &lt; length; i++) {\n        sb.append((char) ('a' + random.nextInt(26)));\n    }\n    return sb.toString();\n}\n\nstatic Location randomLocation() {\n    return new Location(\n            new LocationId(\"Q\" + nonNegativeInt(1000000)),\n            randomString(),\n            nonNegativeInt(10_000_000)\n    );\n}\n\nstatic Attraction randomAttraction(boolean withDescription) {\n    return new Attraction(\n            randomString(),\n            withDescription ? Option.some(randomString()) : Option.none(),\n            randomLocation()\n    );\n}\n\nstatic Guide randomGuide(boolean withDescription, int maxSubjects) {\n    return new Guide(\n            randomAttraction(withDescription),\n            randomSubjects(maxSubjects)\n    );\n}\n</code></pre> <p></p>"},{"location":"java/part-6/#125","title":"12.5 \u4e0d\u5909\u6761\u4ef6\u306e\u30c6\u30b9\u30c8","text":"<pre><code>@Nested\n@DisplayName(\"guideScore \u306e\u30d7\u30ed\u30d1\u30c6\u30a3\")\nclass GuideScorePropertyTest {\n\n    @RepeatedTest(100)\n    @DisplayName(\"\u30b9\u30b3\u30a2\u306f\u5e38\u306b 0 \u4ee5\u4e0a 100 \u4ee5\u4e0b\")\n    void scoreIsBetween0And100() {\n        Guide guide = randomGuide(random.nextBoolean(), 10);\n\n        int score = guideScore(guide);\n\n        assertThat(score).isBetween(0, 100);\n    }\n\n    @RepeatedTest(100)\n    @DisplayName(\"\u8aac\u660e\u3042\u308a\u306e\u30b9\u30b3\u30a2\u306f\u8aac\u660e\u306a\u3057\u3088\u308a 30 \u70b9\u9ad8\u3044\")\n    void descriptionAdds30Points() {\n        Location location = randomLocation();\n        List&lt;PopCultureSubject&gt; subjects = randomSubjects(4);\n\n        Attraction withDesc = new Attraction(\"Test\", Option.some(\"Description\"), location);\n        Attraction withoutDesc = new Attraction(\"Test\", Option.none(), location);\n\n        Guide guideWithDesc = new Guide(withDesc, subjects);\n        Guide guideWithoutDesc = new Guide(withoutDesc, subjects);\n\n        int scoreDiff = guideScore(guideWithDesc) - guideScore(guideWithoutDesc);\n\n        assertThat(scoreDiff).isEqualTo(30);\n    }\n\n    @RepeatedTest(100)\n    @DisplayName(\"\u30b9\u30b3\u30a2\u306f\u30a2\u30c8\u30e9\u30af\u30b7\u30e7\u30f3\u540d\u306b\u4f9d\u5b58\u3057\u306a\u3044\")\n    void scoreDoesNotDependOnName() {\n        Location location = randomLocation();\n        Option&lt;String&gt; description = Option.some(randomString());\n        List&lt;PopCultureSubject&gt; subjects = randomSubjects(4);\n\n        Attraction attr1 = new Attraction(\"Name1\", description, location);\n        Attraction attr2 = new Attraction(\"Name2\", description, location);\n\n        Guide guide1 = new Guide(attr1, subjects);\n        Guide guide2 = new Guide(attr2, subjects);\n\n        assertThat(guideScore(guide1)).isEqualTo(guideScore(guide2));\n    }\n\n    @Test\n    @DisplayName(\"\u30d5\u30a9\u30ed\u30ef\u30fc\u6570\u306e\u30aa\u30fc\u30d0\u30fc\u30d5\u30ed\u30fc\u3092\u9632\u3050\")\n    void preventsFollowerOverflow() {\n        Attraction attraction = randomAttraction(false);\n        List&lt;Artist&gt; artists = List.range(0, 100)\n                .map(i -&gt; new Artist(\"Artist\" + i, Integer.MAX_VALUE));\n        Guide guide = new Guide(attraction, List.narrow(artists));\n\n        int score = guideScore(guide);\n\n        assertThat(score).isBetween(0, 100);\n    }\n}\n</code></pre>"},{"location":"java/part-6/#126","title":"12.6 \u7d14\u7c8b\u95a2\u6570\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u30c6\u30b9\u30c8","text":"<pre><code>@Nested\n@DisplayName(\"\u7d14\u7c8b\u95a2\u6570\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\")\nclass PureFunctionPropertyTest {\n\n    @RepeatedTest(100)\n    @DisplayName(\"guideScore \u306f\u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3059\uff08\u53c2\u7167\u900f\u904e\u6027\uff09\")\n    void guideScoreIsReferentiallyTransparent() {\n        Guide guide = randomGuide(random.nextBoolean(), 5);\n\n        int score1 = guideScore(guide);\n        int score2 = guideScore(guide);\n        int score3 = guideScore(guide);\n\n        assertThat(score1).isEqualTo(score2).isEqualTo(score3);\n    }\n\n    @RepeatedTest(100)\n    @DisplayName(\"findBestGuide \u306f\u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3059\")\n    void findBestGuideIsReferentiallyTransparent() {\n        List&lt;Guide&gt; guides = List.range(0, random.nextInt(5) + 1)\n                .map(i -&gt; randomGuide(random.nextBoolean(), 3));\n\n        Option&lt;Guide&gt; result1 = TravelGuide.findBestGuide(guides);\n        Option&lt;Guide&gt; result2 = TravelGuide.findBestGuide(guides);\n\n        assertThat(result1).isEqualTo(result2);\n    }\n}\n</code></pre>"},{"location":"java/part-6/#127","title":"12.7 \u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u30c6\u30b9\u30c8","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/test/java/ch11/CachedDataAccessTest.java</code></p> <pre><code>@Test\n@DisplayName(\"\u540c\u3058\u30af\u30a8\u30ea\u306f2\u56de\u76ee\u4ee5\u964d\u30ad\u30e3\u30c3\u30b7\u30e5\u304b\u3089\u8fd4\u3055\u308c\u308b\")\nvoid cachedResultsAreReused() {\n    AtomicInteger callCount = new AtomicInteger(0);\n\n    DataAccess underlying = new DataAccess() {\n        @Override\n        public IO&lt;List&lt;Attraction&gt;&gt; findAttractions(String name, AttractionOrdering ordering, int limit) {\n            return IO.delay(() -&gt; {\n                callCount.incrementAndGet();\n                return List.of(TOWER_BRIDGE);\n            });\n        }\n\n        // \u4ed6\u306e\u30e1\u30bd\u30c3\u30c9\u3082\u540c\u69d8\u306b\u5b9f\u88c5...\n    };\n\n    DataAccess cached = CachedDataAccess.createUnsafe(underlying);\n\n    // 1\u56de\u76ee\u306e\u30af\u30a8\u30ea\n    cached.findAttractions(\"Bridge\", AttractionOrdering.BY_NAME, 10).unsafeRun();\n    assertThat(callCount.get()).isEqualTo(1);\n\n    // 2\u56de\u76ee\u306e\u30af\u30a8\u30ea\uff08\u540c\u3058\u30d1\u30e9\u30e1\u30fc\u30bf\uff09\n    cached.findAttractions(\"Bridge\", AttractionOrdering.BY_NAME, 10).unsafeRun();\n    assertThat(callCount.get()).isEqualTo(1); // \u30ad\u30e3\u30c3\u30b7\u30e5\u304b\u3089\u8fd4\u3055\u308c\u308b\u306e\u3067\u547c\u3073\u51fa\u3057\u56de\u6570\u306f\u5897\u3048\u306a\u3044\n\n    // 3\u56de\u76ee\u306e\u30af\u30a8\u30ea\uff08\u7570\u306a\u308b\u30d1\u30e9\u30e1\u30fc\u30bf\uff09\n    cached.findAttractions(\"Tower\", AttractionOrdering.BY_NAME, 10).unsafeRun();\n    assertThat(callCount.get()).isEqualTo(2); // \u65b0\u3057\u3044\u30af\u30a8\u30ea\u306a\u306e\u3067\u547c\u3073\u51fa\u3055\u308c\u308b\n}\n</code></pre>"},{"location":"java/part-6/#128-resource","title":"12.8 Resource \u306e\u30c6\u30b9\u30c8","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/test/java/ch11/ResourceTest.java</code></p> <pre><code>@Test\n@DisplayName(\"use \u3067\u30ea\u30bd\u30fc\u30b9\u3092\u53d6\u5f97\u3057\u3066\u4f7f\u7528\")\nvoid useAcquiresAndReleasesResource() {\n    AtomicBoolean released = new AtomicBoolean(false);\n\n    Resource&lt;String&gt; resource = Resource.make(\n            IO.pure(\"hello\"),\n            s -&gt; released.set(true)\n    );\n\n    String result = resource.use(s -&gt; IO.pure(s.toUpperCase())).unsafeRun();\n\n    assertThat(result).isEqualTo(\"HELLO\");\n    assertThat(released.get()).isTrue();\n}\n\n@Test\n@DisplayName(\"\u51e6\u7406\u304c\u5931\u6557\u3057\u3066\u3082\u30ea\u30bd\u30fc\u30b9\u306f\u89e3\u653e\u3055\u308c\u308b\")\nvoid resourceReleasedOnFailure() {\n    AtomicBoolean released = new AtomicBoolean(false);\n\n    Resource&lt;String&gt; resource = Resource.make(\n            IO.pure(\"hello\"),\n            s -&gt; released.set(true)\n    );\n\n    assertThatThrownBy(() -&gt;\n            resource.use(s -&gt; IO.delay(() -&gt; {\n                throw new RuntimeException(\"error\");\n            })).unsafeRun()\n    ).isInstanceOf(RuntimeException.class);\n\n    assertThat(released.get()).isTrue();\n}\n\n@Test\n@DisplayName(\"both \u30672\u3064\u306e\u30ea\u30bd\u30fc\u30b9\u3092\u7d44\u307f\u5408\u308f\u305b\u308b\")\nvoid bothCombinesTwoResources() {\n    AtomicBoolean firstReleased = new AtomicBoolean(false);\n    AtomicBoolean secondReleased = new AtomicBoolean(false);\n\n    Resource&lt;Integer&gt; first = Resource.make(\n            IO.pure(1),\n            i -&gt; firstReleased.set(true)\n    );\n\n    Resource&lt;String&gt; second = Resource.make(\n            IO.pure(\"two\"),\n            s -&gt; secondReleased.set(true)\n    );\n\n    var result = Resource.both(first, second)\n            .use(tuple -&gt; IO.pure(tuple._1() + tuple._2()))\n            .unsafeRun();\n\n    assertThat(result).isEqualTo(\"1two\");\n    assertThat(firstReleased.get()).isTrue();\n    assertThat(secondReleased.get()).isTrue();\n}\n</code></pre>"},{"location":"java/part-6/#129","title":"12.9 \u30c6\u30b9\u30c8\u30d4\u30e9\u30df\u30c3\u30c9","text":""},{"location":"java/part-6/#_1","title":"\u307e\u3068\u3081","text":""},{"location":"java/part-6/#part-vi_1","title":"Part VI \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"java/part-6/#_2","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>record \u3068 sealed interface: Java 17 \u306e\u6a5f\u80fd\u3067 Scala \u306e case class \u3068 ADT \u3092\u8868\u73fe</li> <li>DataAccess \u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9: \u5916\u90e8\u4f9d\u5b58\u3092\u62bd\u8c61\u5316\u3057\u3066\u30c6\u30b9\u30c8\u53ef\u80fd\u306b</li> <li>Resource: acquire/release \u30d1\u30bf\u30fc\u30f3\u3067\u5b89\u5168\u306a\u30ea\u30bd\u30fc\u30b9\u7ba1\u7406</li> <li>guarantee: finally \u7684\u306a\u30bb\u30de\u30f3\u30c6\u30a3\u30af\u30b9\u3092 IO \u306b\u8ffd\u52a0</li> <li>attempt: \u4f8b\u5916\u3092 Either \u306b\u5909\u63db\u3057\u3066\u30a8\u30e9\u30fc\u3092\u5024\u3068\u3057\u3066\u6271\u3046</li> <li>CachedDataAccess: Ref \u3092\u4f7f\u7528\u3057\u305f\u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u30ad\u30e3\u30c3\u30b7\u30e5</li> <li>TestDataAccess: Builder \u30d1\u30bf\u30fc\u30f3\u3067\u30c6\u30b9\u30c8\u30b9\u30bf\u30d6\u3092\u67d4\u8edf\u306b\u4f5c\u6210</li> <li>\u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8: @RepeatedTest \u3068\u30e9\u30f3\u30c0\u30e0\u751f\u6210\u3067\u4e0d\u5909\u6761\u4ef6\u3092\u691c\u8a3c</li> </ol>"},{"location":"java/part-6/#_3","title":"\u5b66\u7fd2\u306e\u7dcf\u62ec","text":""},{"location":"java/part-6/#scala","title":"Scala \u3068\u306e\u6bd4\u8f03","text":"\u6982\u5ff5 Scala (cats-effect) Java + Vavr \u5024\u30aa\u30d6\u30b8\u30a7\u30af\u30c8 <code>opaque type LocationId</code> <code>record LocationId(String value)</code> \u30c9\u30e1\u30a4\u30f3\u30e2\u30c7\u30eb <code>case class</code> <code>record</code> ADT <code>sealed trait</code> <code>sealed interface</code> \u30ea\u30bd\u30fc\u30b9\u7ba1\u7406 <code>Resource[IO, A]</code> <code>Resource&lt;A&gt;</code> (\u72ec\u81ea\u5b9f\u88c5) \u30ad\u30e3\u30c3\u30b7\u30e5 <code>Ref[IO, Map[...]]</code> <code>Ref&lt;Map&lt;...&gt;&gt;</code> \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0 <code>IO[A].attempt</code> <code>IO&lt;A&gt;.attempt()</code> \u30c6\u30b9\u30c8\u30b9\u30bf\u30d6 <code>val stub = new DataAccess {...}</code> <code>TestDataAccess.builder().build()</code> \u30d7\u30ed\u30d1\u30c6\u30a3\u30c6\u30b9\u30c8 ScalaCheck <code>Gen[A]</code> <code>@RepeatedTest</code> + random generators"},{"location":"java/part-6/#_4","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"java/part-6/#1-dataaccess","title":"\u554f\u984c 1: DataAccess \u306e\u62e1\u5f35","text":"<p>\u4ee5\u4e0b\u306e\u8981\u4ef6\u3067 <code>DataAccess</code> \u3092\u62e1\u5f35\u3057\u3066\u304f\u3060\u3055\u3044: - \u65b0\u3057\u3044\u30e1\u30bd\u30c3\u30c9 <code>findHotelsNearLocation</code> \u3092\u8ffd\u52a0 - \u623b\u308a\u5024\u306f <code>IO&lt;List&lt;Hotel&gt;&gt;</code></p> \u89e3\u7b54 <pre><code>public record Hotel(String name, double rating, Location location) {}\n\npublic interface DataAccess {\n    // \u65e2\u5b58\u306e\u30e1\u30bd\u30c3\u30c9...\n\n    IO&lt;List&lt;Hotel&gt;&gt; findHotelsNearLocation(\n            LocationId locationId,\n            int limit\n    );\n}\n\n// TestDataAccess.Builder \u306b\u8ffd\u52a0\npublic Builder withHotels(Hotel... hotels) {\n    this.hotels = List.of(hotels);\n    return this;\n}\n</code></pre>"},{"location":"java/part-6/#2_1","title":"\u554f\u984c 2: \u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u306b\u5bfe\u3059\u308b\u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8\u3092\u66f8\u3044\u3066\u304f\u3060\u3055\u3044:</p> <pre><code>public static List&lt;Location&gt; filterPopularLocations(\n        List&lt;Location&gt; locations,\n        int minPopulation) {\n    return locations.filter(loc -&gt; loc.population() &gt;= minPopulation);\n}\n</code></pre> \u89e3\u7b54 <pre><code>static List&lt;Location&gt; randomLocations(int maxCount) {\n    int count = random.nextInt(maxCount + 1);\n    return List.range(0, count).map(i -&gt; randomLocation());\n}\n\n// \u30d7\u30ed\u30d1\u30c6\u30a31: \u7d50\u679c\u306f\u5165\u529b\u4ee5\u4e0b\u306e\u8981\u7d20\u6570\n@RepeatedTest(100)\n@DisplayName(\"\u7d50\u679c\u306e\u30b5\u30a4\u30ba\u306f\u5165\u529b\u4ee5\u4e0b\")\nvoid resultSizeIsLessOrEqual() {\n    List&lt;Location&gt; locations = randomLocations(20);\n    int minPop = nonNegativeInt(10_000_000);\n\n    List&lt;Location&gt; result = filterPopularLocations(locations, minPop);\n\n    assertThat(result.size()).isLessThanOrEqualTo(locations.size());\n}\n\n// \u30d7\u30ed\u30d1\u30c6\u30a32: \u7d50\u679c\u306e\u3059\u3079\u3066\u306e\u8981\u7d20\u306f\u6761\u4ef6\u3092\u6e80\u305f\u3059\n@RepeatedTest(100)\n@DisplayName(\"\u3059\u3079\u3066\u306e\u7d50\u679c\u306f\u6700\u5c0f\u4eba\u53e3\u4ee5\u4e0a\")\nvoid allResultsMeetMinimum() {\n    List&lt;Location&gt; locations = randomLocations(20);\n    int minPop = nonNegativeInt(10_000_000);\n\n    List&lt;Location&gt; result = filterPopularLocations(locations, minPop);\n\n    assertThat(result.forAll(loc -&gt; loc.population() &gt;= minPop)).isTrue();\n}\n\n// \u30d7\u30ed\u30d1\u30c6\u30a33: \u6761\u4ef6\u3092\u6e80\u305f\u3059\u8981\u7d20\u306f\u3059\u3079\u3066\u7d50\u679c\u306b\u542b\u307e\u308c\u308b\n@RepeatedTest(100)\n@DisplayName(\"\u6761\u4ef6\u3092\u6e80\u305f\u3059\u8981\u7d20\u306f\u3059\u3079\u3066\u7d50\u679c\u306b\u542b\u307e\u308c\u308b\")\nvoid allQualifyingLocationsAreInResult() {\n    List&lt;Location&gt; locations = randomLocations(20);\n    int minPop = nonNegativeInt(10_000_000);\n\n    List&lt;Location&gt; result = filterPopularLocations(locations, minPop);\n    List&lt;Location&gt; expected = locations.filter(loc -&gt; loc.population() &gt;= minPop);\n\n    assertThat(result).containsExactlyInAnyOrderElementsOf(expected);\n}\n</code></pre>"},{"location":"java/part-6/#3-resource","title":"\u554f\u984c 3: Resource \u306e\u5b9f\u88c5","text":"<p>\u30d5\u30a1\u30a4\u30eb\u3092\u5b89\u5168\u306b\u8aad\u307f\u53d6\u308b <code>Resource</code> \u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> \u89e3\u7b54 <pre><code>public static Resource&lt;BufferedReader&gt; fileResource(String path) {\n    return Resource.fromAutoCloseable(\n            IO.delay(() -&gt; new BufferedReader(new FileReader(path)))\n    );\n}\n\npublic static IO&lt;List&lt;String&gt;&gt; readLines(String path) {\n    return fileResource(path).use(reader -&gt;\n            IO.delay(() -&gt; {\n                java.util.List&lt;String&gt; lines = new java.util.ArrayList&lt;&gt;();\n                String line;\n                while ((line = reader.readLine()) != null) {\n                    lines.add(line);\n                }\n                return List.ofAll(lines);\n            })\n    );\n}\n\n// \u4f7f\u7528\u4f8b\nIO&lt;Void&gt; program = readLines(\"data.txt\")\n        .flatMap(lines -&gt;\n                IO.effect(() -&gt; System.out.println(\"Read \" + lines.size() + \" lines\"))\n        );\n\nprogram.unsafeRun();\n</code></pre>"},{"location":"java/part-6/#_5","title":"\u30b7\u30ea\u30fc\u30ba\u5168\u4f53\u306e\u7dcf\u62ec","text":"<p>\u672c\u30b7\u30ea\u30fc\u30ba\u3067\u306f\u3001\u300cGrokking Functional Programming\u300d\u306e\u5185\u5bb9\u306b\u6cbf\u3063\u3066\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u790e\u304b\u3089\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u307e\u3067\u3092\u5b66\u3073\u307e\u3057\u305f\u3002</p>"},{"location":"java/part-6/#_6","title":"\u5b66\u3093\u3060\u4e3b\u306a\u6982\u5ff5","text":"Part \u7ae0 \u4e3b\u306a\u6982\u5ff5 I 1-2 \u7d14\u7c8b\u95a2\u6570\u3001\u53c2\u7167\u900f\u904e\u6027 II 3-5 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u3001\u9ad8\u968e\u95a2\u6570\u3001flatMap III 6-7 Option\u3001Either\u3001ADT IV 8-9 IO \u30e2\u30ca\u30c9\u3001Stream V 10 \u4e26\u884c\u51e6\u7406\u3001Ref\u3001Fiber VI 11-12 \u5b9f\u8df5\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3001\u30c6\u30b9\u30c8"},{"location":"java/part-6/#_7","title":"\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u5229\u70b9","text":"<ol> <li>\u4e88\u6e2c\u53ef\u80fd\u6027: \u7d14\u7c8b\u95a2\u6570\u306f\u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b</li> <li>\u30c6\u30b9\u30c8\u5bb9\u6613\u6027: \u526f\u4f5c\u7528\u304c\u306a\u3044\u305f\u3081\u30c6\u30b9\u30c8\u304c\u7c21\u5358</li> <li>\u5408\u6210\u53ef\u80fd\u6027: \u5c0f\u3055\u306a\u95a2\u6570\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u8907\u96d1\u306a\u51e6\u7406\u3092\u69cb\u7bc9</li> <li>\u4e26\u884c\u5b89\u5168\u6027: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u306f\u7af6\u5408\u72b6\u614b\u3092\u9632\u3050</li> <li>\u578b\u5b89\u5168\u6027: Option\u3001Either \u3067 null \u3084\u4f8b\u5916\u3092\u578b\u3067\u8868\u73fe</li> </ol>"},{"location":"java/part-6/#_8","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<ul> <li>Vavr \u306e\u3088\u308a\u9ad8\u5ea6\u306a\u6a5f\u80fd\u3092\u5b66\u3076</li> <li>\u30d7\u30ed\u30b8\u30a7\u30af\u30c8 Reactor \u3084 RxJava \u3092\u63a2\u7d22</li> <li>Virtual Thread \u3068\u7d44\u307f\u5408\u308f\u305b\u305f\u5b9f\u8df5\u7684\u306a\u4e26\u884c\u51e6\u7406</li> <li>\u5b9f\u969b\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067 FP \u3092\u9069\u7528\u3059\u308b</li> </ul>"},{"location":"scala/","title":"Grokking Functional Programming \u65e5\u672c\u8a9e\u89e3\u8aac","text":"<p>\u672c\u30b7\u30ea\u30fc\u30ba\u306f\u300cGrokking Functional Programming\u300d\uff08Micha\u0142 P\u0142achta \u8457\uff09\u306e\u5b66\u7fd2\u30b3\u30f3\u30d1\u30cb\u30aa\u30f3\u3068\u3057\u3066\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u6982\u5ff5\u3092\u65e5\u672c\u8a9e\u3067\u89e3\u8aac\u3057\u307e\u3059\u3002</p>"},{"location":"scala/#_1","title":"\u5bfe\u8c61\u8aad\u8005","text":"<ul> <li>Java \u3084 OOP \u306e\u7d4c\u9a13\u304c\u3042\u308a\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u8208\u5473\u304c\u3042\u308b\u958b\u767a\u8005</li> <li>Scala \u3092\u5b66\u3073\u305f\u3044\u304c\u3001FP \u306e\u6982\u5ff5\u304b\u3089\u7406\u89e3\u3057\u305f\u3044\u65b9</li> <li>\u5b9f\u8df5\u7684\u306a FP \u306e\u9069\u7528\u65b9\u6cd5\u3092\u77e5\u308a\u305f\u3044\u30a8\u30f3\u30b8\u30cb\u30a2</li> </ul>"},{"location":"scala/#_2","title":"\u8a18\u4e8b\u4e00\u89a7","text":""},{"location":"scala/#part-i","title":"Part I: \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u790e","text":"<p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u672c\u6982\u5ff5\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c1\u7ae0 \u547d\u4ee4\u578b vs \u95a2\u6570\u578b\u3001Scala \u57fa\u672c\u69cb\u6587 \u7b2c2\u7ae0 \u7d14\u7c8b\u95a2\u6570\u3001\u526f\u4f5c\u7528\u306e\u6392\u9664\u3001\u30c6\u30b9\u30c8\u306e\u5bb9\u6613\u3055 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: \u7d14\u7c8b\u95a2\u6570\u3001\u53c2\u7167\u900f\u904e\u6027\u3001\u526f\u4f5c\u7528</p>"},{"location":"scala/#part-ii","title":"Part II: \u95a2\u6570\u578b\u30b9\u30bf\u30a4\u30eb\u306e\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0","text":"<p>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c\u3068\u9ad8\u968e\u95a2\u6570\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c3\u7ae0 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u3001List \u64cd\u4f5c \u7b2c4\u7ae0 \u9ad8\u968e\u95a2\u6570\u3001map/filter/foldLeft \u7b2c5\u7ae0 flatMap\u3001for \u5185\u5305\u8868\u8a18 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u3001\u9ad8\u968e\u95a2\u6570\u3001flatMap\u3001for \u5185\u5305\u8868\u8a18</p>"},{"location":"scala/#part-iii-optioneither","title":"Part III: \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3068 Option/Either","text":"<p>\u578b\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c6\u7ae0 Option \u578b\u3001Some/None \u7b2c7\u7ae0 Either \u578b\u3001ADT\u3001\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: Option\u3001Either\u3001\u4ee3\u6570\u7684\u30c7\u30fc\u30bf\u578b\uff08ADT\uff09</p>"},{"location":"scala/#part-iv-io","title":"Part IV: IO \u3068\u526f\u4f5c\u7528\u306e\u7ba1\u7406","text":"<p>IO \u30e2\u30ca\u30c9\u3068\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c8\u7ae0 IO \u30e2\u30ca\u30c9\u3001cats-effect \u7b2c9\u7ae0 fs2 Stream\u3001\u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: IO \u30e2\u30ca\u30c9\u3001\u9045\u5ef6\u8a55\u4fa1\u3001\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406</p>"},{"location":"scala/#part-v","title":"Part V: \u4e26\u884c\u51e6\u7406","text":"<p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u4e26\u884c\u51e6\u7406\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c10\u7ae0 Ref\u3001Fiber\u3001parSequence <p>\u30ad\u30fc\u30ef\u30fc\u30c9: \u4e26\u884c\u51e6\u7406\u3001Ref\u3001Fiber\u3001\u8efd\u91cf\u30b9\u30ec\u30c3\u30c9</p>"},{"location":"scala/#part-vi","title":"Part VI: \u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u3068\u30c6\u30b9\u30c8","text":"<p>\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u3068\u30c6\u30b9\u30c8\u6226\u7565\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c11\u7ae0 TravelGuide \u30a2\u30d7\u30ea\u3001Resource\u3001\u30ad\u30e3\u30c3\u30b7\u30e5 \u7b2c12\u7ae0 \u30c6\u30b9\u30c8\u6226\u7565\u3001\u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: Resource\u3001DataAccess \u62bd\u8c61\u5316\u3001ScalaCheck</p>"},{"location":"scala/#_3","title":"\u5b66\u7fd2\u30d1\u30b9","text":""},{"location":"scala/#_4","title":"\u4f7f\u7528\u30e9\u30a4\u30d6\u30e9\u30ea","text":"\u30e9\u30a4\u30d6\u30e9\u30ea \u7528\u9014 \u5bfe\u5fdc\u7ae0 Scala 3 \u8a00\u8a9e \u5168\u7ae0 cats-effect IO \u30e2\u30ca\u30c9 Part IV-VI fs2 \u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406 Part IV-V ScalaCheck \u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8 Part VI"},{"location":"scala/#_5","title":"\u30ea\u30dd\u30b8\u30c8\u30ea\u69cb\u6210","text":"<pre><code>grokkingfp-examples/\n\u251c\u2500\u2500 app/scala/src/main/scala/    # Scala \u306e\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n\u251c\u2500\u2500 app/java/src/main/java/      # Java \u306e\u6bd4\u8f03\u7528\u30b3\u30fc\u30c9\n\u251c\u2500\u2500 src/test/scala/              # \u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\n\u251c\u2500\u2500 docs/journal/                # \u958b\u767a\u5c65\u6b74\n\u2514\u2500\u2500 docs/article/                # \u89e3\u8aac\u8a18\u4e8b\uff08\u672c\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\uff09\n    \u251c\u2500\u2500 index.md                 # \u3053\u306e\u8a18\u4e8b\n    \u251c\u2500\u2500 outline.md               # \u30a2\u30a6\u30c8\u30e9\u30a4\u30f3\n    \u251c\u2500\u2500 part-1.md                # Part I\n    \u251c\u2500\u2500 part-2.md                # Part II\n    \u251c\u2500\u2500 part-3.md                # Part III\n    \u251c\u2500\u2500 part-4.md                # Part IV\n    \u251c\u2500\u2500 part-5.md                # Part V\n    \u2514\u2500\u2500 part-6.md                # Part VI\n</code></pre>"},{"location":"scala/#_6","title":"\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u5229\u70b9","text":"<p>\u672c\u30b7\u30ea\u30fc\u30ba\u3092\u901a\u3058\u3066\u3001\u4ee5\u4e0b\u306e\u5229\u70b9\u3092\u5b9f\u611f\u3067\u304d\u307e\u3059:</p> <ol> <li>\u4e88\u6e2c\u53ef\u80fd\u6027 - \u7d14\u7c8b\u95a2\u6570\u306f\u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b</li> <li>\u30c6\u30b9\u30c8\u5bb9\u6613\u6027 - \u526f\u4f5c\u7528\u304c\u306a\u3044\u305f\u3081\u30c6\u30b9\u30c8\u304c\u7c21\u5358</li> <li>\u5408\u6210\u53ef\u80fd\u6027 - \u5c0f\u3055\u306a\u95a2\u6570\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u8907\u96d1\u306a\u51e6\u7406\u3092\u69cb\u7bc9</li> <li>\u4e26\u884c\u5b89\u5168\u6027 - \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u306f\u7af6\u5408\u72b6\u614b\u3092\u9632\u3050</li> <li>\u578b\u5b89\u5168\u6027 - Option\u3001Either \u3067 null \u3084\u4f8b\u5916\u3092\u578b\u3067\u8868\u73fe</li> </ol>"},{"location":"scala/#_7","title":"\u53c2\u8003\u8cc7\u6599","text":"<ul> <li>Grokking Functional Programming - \u539f\u8457</li> <li>Scala \u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8</li> <li>cats-effect \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8</li> <li>fs2 \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8</li> </ul>"},{"location":"scala/part-1/","title":"Part I: \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u790e","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\uff08FP\uff09\u306e\u57fa\u672c\u6982\u5ff5\u3092\u5b66\u3073\u307e\u3059\u3002\u547d\u4ee4\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u3068\u306e\u9055\u3044\u3092\u7406\u89e3\u3057\u3001\u7d14\u7c8b\u95a2\u6570\u306e\u5229\u70b9\u3092\u5b9f\u611f\u3059\u308b\u3053\u3068\u304c\u76ee\u6a19\u3067\u3059\u3002</p>"},{"location":"scala/part-1/#1","title":"\u7b2c1\u7ae0: \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u5165\u9580","text":""},{"location":"scala/part-1/#11-vs","title":"1.1 \u547d\u4ee4\u578b vs \u95a2\u6570\u578b","text":"<p>\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u306f\u5927\u304d\u304f\u5206\u3051\u30662\u3064\u306e\u30d1\u30e9\u30c0\u30a4\u30e0\u304c\u3042\u308a\u307e\u3059\u3002</p> <p></p> <p>\u547d\u4ee4\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306f\u300c\u3069\u3046\u3084\u308b\u304b\u300d\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002</p> <pre><code>// Java: \u547d\u4ee4\u578b\u3067\u30ef\u30fc\u30c9\u30b9\u30b3\u30a2\u3092\u8a08\u7b97\npublic static int calculateScore(String word) {\n    int score = 0;\n    for(char c : word.toCharArray()) {\n        score++;\n    }\n    return score;\n}\n</code></pre> <p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306f\u300c\u4f55\u3092\u3059\u308b\u304b\u300d\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002</p> <pre><code>// Scala: \u95a2\u6570\u578b\u3067\u30ef\u30fc\u30c9\u30b9\u30b3\u30a2\u3092\u8a08\u7b97\ndef wordScore(word: String): Int = {\n  word.length()\n}\n</code></pre>"},{"location":"scala/part-1/#12-scala","title":"1.2 Scala \u306e\u57fa\u672c\u69cb\u6587","text":"<p>Scala \u3067\u306e\u95a2\u6570\u5b9a\u7fa9\u306e\u57fa\u672c\u5f62\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch01_IntroScala.scala</code></p> <pre><code>def increment(x: Int): Int = {\n  x + 1\n}\n\ndef getFirstCharacter(s: String): Char = {\n  s.charAt(0)\n}\n\ndef wordScore(word: String): Int = {\n  word.length()\n}\n</code></pre>"},{"location":"scala/part-1/#13","title":"1.3 \u95a2\u6570\u306e\u69cb\u9020","text":""},{"location":"scala/part-1/#14","title":"1.4 \u5b66\u7fd2\u30dd\u30a4\u30f3\u30c8","text":"\u6982\u5ff5 \u547d\u4ee4\u578b \u95a2\u6570\u578b \u7126\u70b9 \u624b\u9806\uff08How\uff09 \u7d50\u679c\uff08What\uff09 \u72b6\u614b \u5909\u66f4\u3059\u308b \u5909\u63db\u3059\u308b \u30eb\u30fc\u30d7 for/while map/filter/reduce \u30c7\u30fc\u30bf \u30df\u30e5\u30fc\u30bf\u30d6\u30eb \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb"},{"location":"scala/part-1/#2","title":"\u7b2c2\u7ae0: \u7d14\u7c8b\u95a2\u6570\u3068\u30c6\u30b9\u30c8","text":""},{"location":"scala/part-1/#21","title":"2.1 \u7d14\u7c8b\u95a2\u6570\u3068\u306f","text":"<p>\u7d14\u7c8b\u95a2\u6570\uff08Pure Function\uff09\u306f\u4ee5\u4e0b\u306e\u7279\u5fb4\u3092\u6301\u3064\u95a2\u6570\u3067\u3059:</p> <ol> <li>\u540c\u3058\u5165\u529b\u306b\u306f\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3059</li> <li>\u526f\u4f5c\u7528\u304c\u306a\u3044\uff08\u5916\u90e8\u72b6\u614b\u3092\u5909\u66f4\u3057\u306a\u3044\uff09</li> </ol> <p></p>"},{"location":"scala/part-1/#22","title":"2.2 \u7d14\u7c8b\u95a2\u6570\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch02_PureFunctions.java</code></p> <pre><code>// \u7d14\u7c8b\u95a2\u6570\u306e\u4f8b\nstatic int increment(int x) {\n    return x + 1;\n}\n\nstatic int add(int a, int b) {\n    return a + b;\n}\n\nstatic char getFirstCharacter(String s) {\n    return s.charAt(0);\n}\n</code></pre> <p>\u7d14\u7c8b\u3067\u306f\u306a\u3044\u95a2\u6570\u306e\u4f8b:</p> <pre><code>// \u4e0d\u7d14\u306a\u95a2\u6570 - Math.random() \u306f\u6bce\u56de\u7570\u306a\u308b\u5024\u3092\u8fd4\u3059\nstatic double randomPart(double x) {\n    return x * Math.random();\n}\n</code></pre>"},{"location":"scala/part-1/#23","title":"2.3 \u30b7\u30e7\u30c3\u30d4\u30f3\u30b0\u30ab\u30fc\u30c8\u306e\u4f8b","text":"<p>\u72b6\u614b\u3092\u6301\u3064\u30af\u30e9\u30b9\u306e\u554f\u984c\u70b9\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch02_ShoppingCartDiscounts.java</code></p>"},{"location":"scala/part-1/#_1","title":"\u554f\u984c\u306e\u3042\u308b\u30b3\u30fc\u30c9","text":"<pre><code>class ShoppingCartBad {\n    private List&lt;String&gt; items = new ArrayList&lt;&gt;();\n    private boolean bookAdded = false;\n\n    public void addItem(String item) {\n        items.add(item);\n        if(item.equals(\"Book\")) {\n            bookAdded = true;\n        }\n    }\n\n    public int getDiscountPercentage() {\n        if(bookAdded) {\n            return 5;\n        } else {\n            return 0;\n        }\n    }\n\n    public List&lt;String&gt; getItems() {\n        return items;  // \u554f\u984c: \u5185\u90e8\u72b6\u614b\u3078\u306e\u53c2\u7167\u3092\u8fd4\u3057\u3066\u3044\u308b\n    }\n}\n</code></pre>"},{"location":"scala/part-1/#_2","title":"\u7d14\u7c8b\u95a2\u6570\u306b\u3088\u308b\u89e3\u6c7a","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch02_ShoppingCartDiscountsScala.scala</code></p> <pre><code>object ShoppingCart {\n  def getDiscountPercentage(items: List[String]): Int = {\n    if (items.contains(\"Book\")) {\n      5\n    } else {\n      0\n    }\n  }\n}\n</code></pre> <p></p>"},{"location":"scala/part-1/#24","title":"2.4 \u30c1\u30c3\u30d7\u8a08\u7b97\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch02_TipCalculationScala.scala</code></p> <pre><code>object TipCalculator {\n  def getTipPercentage(names: List[String]): Int = {\n    if (names.size &gt; 5) 20\n    else if (names.size &gt; 0) 10\n    else 0\n  }\n}\n</code></pre> <p>\u3053\u306e\u95a2\u6570\u306f: - 6\u4eba\u4ee5\u4e0a\u306e\u30b0\u30eb\u30fc\u30d7 \u2192 20% \u306e\u30c1\u30c3\u30d7 - 1-5\u4eba\u306e\u30b0\u30eb\u30fc\u30d7 \u2192 10% \u306e\u30c1\u30c3\u30d7 - 0\u4eba\uff08\u7a7a\u30ea\u30b9\u30c8\uff09 \u2192 0% \u306e\u30c1\u30c3\u30d7</p>"},{"location":"scala/part-1/#25","title":"2.5 \u7d14\u7c8b\u95a2\u6570\u306e\u30c6\u30b9\u30c8","text":"<p>\u7d14\u7c8b\u95a2\u6570\u306f\u975e\u5e38\u306b\u30c6\u30b9\u30c8\u3057\u3084\u3059\u3044\u3067\u3059\u3002</p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch02_TestingPureFunctions.scala</code></p> <pre><code>def increment(x: Int): Int = {\n  x + 1\n}\n\n// \u30c6\u30b9\u30c8\u30b1\u30fc\u30b9\nassert(increment(6) == 7)\nassert(increment(0) == 1)\nassert(increment(-6) == -5)\nassert(increment(Integer.MAX_VALUE - 1) == Integer.MAX_VALUE)\n</code></pre> <p></p>"},{"location":"scala/part-1/#26-a","title":"2.6 \u6587\u5b57 'a' \u3092\u9664\u5916\u3059\u308b\u30ef\u30fc\u30c9\u30b9\u30b3\u30a2","text":"<p>\u3088\u308a\u8907\u96d1\u306a\u4f8b\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p> <pre><code>def wordScore(word: String): Int = {\n  word.replaceAll(\"a\", \"\").length\n}\n\n// \u30c6\u30b9\u30c8\nassert(wordScore(\"Scala\") == 3)    // \"Scl\" \u2192 3\u6587\u5b57\nassert(wordScore(\"function\") == 8) // 'a' \u306a\u3057 \u2192 8\u6587\u5b57\nassert(wordScore(\"\") == 0)         // \u7a7a\u6587\u5b57 \u2192 0\u6587\u5b57\n</code></pre>"},{"location":"scala/part-1/#27","title":"2.7 \u53c2\u7167\u900f\u904e\u6027","text":"<p>\u7d14\u7c8b\u95a2\u6570\u306f\u53c2\u7167\u900f\u904e\u6027\uff08Referential Transparency\uff09\u3092\u6301\u3061\u307e\u3059\u3002</p> <p>\u5f0f\u3092\u305d\u306e\u8a55\u4fa1\u7d50\u679c\u3067\u7f6e\u304d\u63db\u3048\u3066\u3082\u3001\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u610f\u5473\u304c\u5909\u308f\u3089\u306a\u3044\u3053\u3068</p> <pre><code>// \u53c2\u7167\u900f\u904e\u6027\u306e\u4f8b\nval score1 = wordScore(\"Scala\")\nval score2 = wordScore(\"Scala\")\n// score1 \u3068 score2 \u306f\u5e38\u306b\u540c\u3058\u5024\uff083\uff09\n\n// \u4ee5\u4e0b\u306e2\u3064\u306f\u540c\u7b49\nval total1 = wordScore(\"Scala\") + wordScore(\"Java\")\nval total2 = 3 + 4  // wordScore \u306e\u7d50\u679c\u3067\u7f6e\u304d\u63db\u3048\u53ef\u80fd\n</code></pre> <p></p>"},{"location":"scala/part-1/#_3","title":"\u307e\u3068\u3081","text":""},{"location":"scala/part-1/#part-i_1","title":"Part I \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"scala/part-1/#_4","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306f\u300c\u4f55\u3092\u3059\u308b\u304b\u300d\u3092\u5ba3\u8a00\u7684\u306b\u8a18\u8ff0\u3059\u308b</li> <li>\u7d14\u7c8b\u95a2\u6570\u306f\u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3059</li> <li>\u526f\u4f5c\u7528\u3092\u907f\u3051\u308b\u3053\u3068\u3067\u30b3\u30fc\u30c9\u306e\u4e88\u6e2c\u53ef\u80fd\u6027\u304c\u5411\u4e0a\u3059\u308b</li> <li>\u7d14\u7c8b\u95a2\u6570\u306f\u30c6\u30b9\u30c8\u304c\u975e\u5e38\u306b\u7c21\u5358</li> <li>\u53c2\u7167\u900f\u904e\u6027\u306b\u3088\u308a\u3001\u30b3\u30fc\u30c9\u306e\u7406\u89e3\u3068\u63a8\u8ad6\u304c\u5bb9\u6613\u306b\u306a\u308b</li> </ol>"},{"location":"scala/part-1/#_5","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part II \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c</li> <li>\u9ad8\u968e\u95a2\u6570\uff08\u95a2\u6570\u3092\u5024\u3068\u3057\u3066\u6271\u3046\uff09</li> <li><code>flatMap</code> \u3068\u30cd\u30b9\u30c8\u69cb\u9020\u306e\u5e73\u5766\u5316</li> <li>for \u5185\u5305\u8868\u8a18</li> </ul>"},{"location":"scala/part-1/#_6","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"scala/part-1/#1_1","title":"\u554f\u984c 1: \u7d14\u7c8b\u95a2\u6570\u306e\u8b58\u5225","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u306e\u3046\u3061\u3001\u7d14\u7c8b\u95a2\u6570\u306f\u3069\u308c\u3067\u3059\u304b?</p> <pre><code>// A\ndef double(x: Int): Int = x * 2\n\n// B\nvar counter = 0\ndef incrementCounter(): Int = {\n  counter += 1\n  counter\n}\n\n// C\ndef greet(name: String): String = s\"Hello, $name!\"\n\n// D\ndef currentTime(): Long = System.currentTimeMillis()\n</code></pre> \u89e3\u7b54  **A \u3068 C \u306f\u7d14\u7c8b\u95a2\u6570**\u3067\u3059\u3002  - A: \u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3057\u3001\u526f\u4f5c\u7528\u304c\u306a\u3044 - B: \u5916\u90e8\u5909\u6570 `counter` \u3092\u5909\u66f4\u3059\u308b\u526f\u4f5c\u7528\u304c\u3042\u308b\uff08\u4e0d\u7d14\uff09 - C: \u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3057\u3001\u526f\u4f5c\u7528\u304c\u306a\u3044 - D: \u547c\u3073\u51fa\u3059\u305f\u3073\u306b\u7570\u306a\u308b\u5024\u3092\u8fd4\u3059\uff08\u4e0d\u7d14\uff09"},{"location":"scala/part-1/#2_1","title":"\u554f\u984c 2: \u7d14\u7c8b\u95a2\u6570\u3078\u306e\u66f8\u304d\u63db\u3048","text":"<p>\u4ee5\u4e0b\u306e\u4e0d\u7d14\u306a\u95a2\u6570\u3092\u7d14\u7c8b\u95a2\u6570\u306b\u66f8\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>class Counter {\n    private int value = 0;\n\n    public int increment() {\n        value++;\n        return value;\n    }\n}\n</code></pre> \u89e3\u7b54 <pre><code>def increment(value: Int): Int = value + 1\n\n// \u4f7f\u7528\u4f8b\nval v1 = 0\nval v2 = increment(v1)  // 1\nval v3 = increment(v2)  // 2\n</code></pre>  \u72b6\u614b\u3092\u5916\u90e8\u306b\u6301\u3061\u3001\u95a2\u6570\u306f\u5024\u3092\u53d7\u3051\u53d6\u3063\u3066\u65b0\u3057\u3044\u5024\u3092\u8fd4\u3059\u3060\u3051\u306b\u3057\u307e\u3059\u3002"},{"location":"scala/part-1/#3","title":"\u554f\u984c 3: \u30c6\u30b9\u30c8\u3092\u66f8\u304f","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u306b\u5bfe\u3059\u308b\u30c6\u30b9\u30c8\u30b1\u30fc\u30b9\u3092\u8003\u3048\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>def isEven(n: Int): Boolean = n % 2 == 0\n</code></pre> \u89e3\u7b54 <pre><code>// \u57fa\u672c\u30b1\u30fc\u30b9\nassert(isEven(0) == true)\nassert(isEven(2) == true)\nassert(isEven(4) == true)\n\n// \u5947\u6570\nassert(isEven(1) == false)\nassert(isEven(3) == false)\n\n// \u8ca0\u306e\u6570\nassert(isEven(-2) == true)\nassert(isEven(-3) == false)\n\n// \u5883\u754c\u5024\nassert(isEven(Integer.MAX_VALUE) == false)\nassert(isEven(Integer.MIN_VALUE) == true)\n</code></pre>"},{"location":"scala/part-2/","title":"Part II: \u95a2\u6570\u578b\u30b9\u30bf\u30a4\u30eb\u306e\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u6838\u5fc3\u3068\u306a\u308b\u30c6\u30af\u30cb\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059\u3002\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c\u3001\u9ad8\u968e\u95a2\u6570\u3001\u305d\u3057\u3066 <code>flatMap</code> \u306b\u3088\u308b\u8907\u96d1\u306a\u30c7\u30fc\u30bf\u5909\u63db\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"scala/part-2/#3","title":"\u7b2c3\u7ae0: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c","text":""},{"location":"scala/part-2/#31","title":"3.1 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u3068\u306f","text":"<p>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\uff08\u4e0d\u5909\uff09\u3068\u306f\u3001\u4e00\u5ea6\u4f5c\u6210\u3055\u308c\u305f\u30c7\u30fc\u30bf\u304c\u5909\u66f4\u3055\u308c\u306a\u3044\u3053\u3068\u3092\u610f\u5473\u3057\u307e\u3059\u3002\u30c7\u30fc\u30bf\u3092\u300c\u5909\u66f4\u300d\u3059\u308b\u4ee3\u308f\u308a\u306b\u3001\u65b0\u3057\u3044\u30c7\u30fc\u30bf\u3092\u300c\u4f5c\u6210\u300d\u3057\u307e\u3059\u3002</p> <p></p>"},{"location":"scala/part-2/#32-list","title":"3.2 List \u306e\u57fa\u672c\u64cd\u4f5c","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch03_SlicingAndAppending.scala</code></p>"},{"location":"scala/part-2/#appended-","title":"appended - \u8981\u7d20\u306e\u8ffd\u52a0","text":"<pre><code>val appleBook      = List(\"Apple\", \"Book\")\nval appleBookMango = appleBook.appended(\"Mango\")\n\nassert(appleBook.size == 2)       // \u5143\u306e\u30ea\u30b9\u30c8\u306f\u5909\u308f\u3089\u306a\u3044\nassert(appleBookMango.size == 3)  // \u65b0\u3057\u3044\u30ea\u30b9\u30c8\u304c\u4f5c\u6210\u3055\u308c\u308b\nassert(appleBookMango == List(\"Apple\", \"Book\", \"Mango\"))\n</code></pre>"},{"location":"scala/part-2/#slice-","title":"slice - \u30ea\u30b9\u30c8\u306e\u5207\u308a\u51fa\u3057","text":"<pre><code>def firstTwo(list: List[String]): List[String] =\n  list.slice(0, 2)\n\ndef lastTwo(list: List[String]): List[String] =\n  list.slice(list.size - 2, list.size)\n\nassert(firstTwo(List(\"a\", \"b\", \"c\")) == List(\"a\", \"b\"))\nassert(lastTwo(List(\"a\", \"b\", \"c\")) == List(\"b\", \"c\"))\n</code></pre>"},{"location":"scala/part-2/#33","title":"3.3 \u30ea\u30b9\u30c8\u306e\u5909\u63db\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch03_SlicingAndAppending.scala</code></p> <pre><code>// \u6700\u521d\u306e2\u8981\u7d20\u3092\u672b\u5c3e\u306b\u79fb\u52d5\ndef movedFirstTwoToTheEnd(list: List[String]): List[String] = {\n  val firstTwo        = list.slice(0, 2)\n  val withoutFirstTwo = list.slice(2, list.size)\n  withoutFirstTwo.appendedAll(firstTwo)\n}\n\nassert(movedFirstTwoToTheEnd(List(\"a\", \"b\", \"c\")) == List(\"c\", \"a\", \"b\"))\n\n// \u6700\u5f8c\u306e\u8981\u7d20\u306e\u524d\u306b\u633f\u5165\ndef insertedBeforeLast(list: List[String], element: String): List[String] = {\n  val last        = list.slice(list.size - 1, list.size)\n  val withoutLast = list.slice(0, list.size - 1)\n  withoutLast.appended(element).appendedAll(last)\n}\n\nassert(insertedBeforeLast(List(\"a\", \"b\"), \"c\") == List(\"a\", \"c\", \"b\"))\n</code></pre>"},{"location":"scala/part-2/#34","title":"3.4 \u65c5\u7a0b\u306e\u518d\u8a08\u753b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch03_ItineraryScala.scala</code></p> <p>\u65c5\u884c\u306e\u8a08\u753b\u5909\u66f4\u3092\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306b\u884c\u3046\u4f8b\u3067\u3059\u3002</p> <pre><code>def replan(plan: List[String], newCity: String, beforeCity: String): List[String] = {\n  val beforeCityIndex = plan.indexOf(beforeCity)\n  val citiesBefore    = plan.slice(0, beforeCityIndex)\n  val citiesAfter     = plan.slice(beforeCityIndex, plan.size)\n  citiesBefore.appended(newCity).appendedAll(citiesAfter)\n}\n\nval planA = List(\"Paris\", \"Berlin\", \"Krak\u00f3w\")\nval planB = replan(planA, \"Vienna\", \"Krak\u00f3w\")\n\nassert(planB == List(\"Paris\", \"Berlin\", \"Vienna\", \"Krak\u00f3w\"))\nassert(planA == List(\"Paris\", \"Berlin\", \"Krak\u00f3w\"))  // \u5143\u306e\u8a08\u753b\u306f\u5909\u308f\u3089\u306a\u3044!\n</code></pre> <p></p>"},{"location":"scala/part-2/#35-string-list","title":"3.5 String \u3068 List \u306e\u985e\u4f3c\u6027","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch03_ListVsStringScala.scala</code></p> <p>String \u3068 List \u306f\u4f3c\u305f\u64cd\u4f5c\u304c\u3067\u304d\u307e\u3059\u3002</p> \u64cd\u4f5c List String \u7d50\u5408 <code>appendedAll</code> <code>concat</code> \u5207\u308a\u51fa\u3057 <code>slice</code> <code>substring</code> \u30b5\u30a4\u30ba <code>size</code> <code>length</code> <pre><code>// List \u306e\u64cd\u4f5c\nval abList   = List(\"a\", \"b\")\nval cdList   = List(\"c\", \"d\")\nval abcdList = abList.appendedAll(cdList)\nassert(abcdList == List(\"a\", \"b\", \"c\", \"d\"))\n\n// String \u306e\u64cd\u4f5c\nval abStr   = \"ab\"\nval cdStr   = \"cd\"\nval abcdStr = abStr.concat(cdStr)\nassert(abcdStr == \"abcd\")\n</code></pre>"},{"location":"scala/part-2/#36","title":"3.6 \u540d\u524d\u306e\u7701\u7565","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch03_AbbreviateNames.scala</code></p> <pre><code>def abbreviate(name: String): String = {\n  val initial   = name.substring(0, 1)\n  val separator = name.indexOf(' ')\n  val lastName  = name.substring(separator + 1)\n  initial + \". \" + lastName\n}\n\nassert(abbreviate(\"Alonzo Church\") == \"A. Church\")\nassert(abbreviate(\"A. Church\") == \"A. Church\")\n</code></pre>"},{"location":"scala/part-2/#4","title":"\u7b2c4\u7ae0: \u95a2\u6570\u3092\u5024\u3068\u3057\u3066\u6271\u3046","text":""},{"location":"scala/part-2/#41","title":"4.1 \u9ad8\u968e\u95a2\u6570\u3068\u306f","text":"<p>\u9ad8\u968e\u95a2\u6570\uff08Higher-Order Function\uff09\u3068\u306f\u3001\u4ee5\u4e0b\u306e\u3044\u305a\u308c\u304b\u3092\u6e80\u305f\u3059\u95a2\u6570\u3067\u3059:</p> <ol> <li>\u95a2\u6570\u3092\u5f15\u6570\u3068\u3057\u3066\u53d7\u3051\u53d6\u308b</li> <li>\u95a2\u6570\u3092\u623b\u308a\u5024\u3068\u3057\u3066\u8fd4\u3059</li> </ol> <p></p>"},{"location":"scala/part-2/#42","title":"4.2 \u95a2\u6570\u3092\u5f15\u6570\u3068\u3057\u3066\u6e21\u3059","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch04_PassingFunctions.scala</code></p>"},{"location":"scala/part-2/#sortby-","title":"sortBy - \u30bd\u30fc\u30c8\u57fa\u6e96\u3092\u95a2\u6570\u3067\u6307\u5b9a","text":"<pre><code>def score(word: String): Int = word.replaceAll(\"a\", \"\").length\n\nval words = List(\"rust\", \"java\")\nval sortedWords = words.sortBy(score)\n\nassert(sortedWords == List(\"java\", \"rust\"))\n// java: 2\u6587\u5b57 (j, v), rust: 4\u6587\u5b57 (r, u, s, t)\n</code></pre>"},{"location":"scala/part-2/#map-","title":"map - \u5404\u8981\u7d20\u3092\u5909\u63db","text":"<pre><code>def len(s: String): Int = s.length\n\nval lengths = List(\"scala\", \"rust\", \"ada\").map(len)\nassert(lengths == List(5, 4, 3))\n\ndef double(i: Int): Int = 2 * i\nval doubles = List(5, 1, 2, 4, 0).map(double)\nassert(doubles == List(10, 2, 4, 8, 0))\n</code></pre>"},{"location":"scala/part-2/#filter-","title":"filter - \u6761\u4ef6\u306b\u5408\u3046\u8981\u7d20\u3092\u62bd\u51fa","text":"<pre><code>def odd(i: Int): Boolean = i % 2 == 1\n\nval odds = List(5, 1, 2, 4, 0).filter(odd)\nassert(odds == List(5, 1))\n\ndef largerThan4(i: Int): Boolean = i &gt; 4\nval large = List(5, 1, 2, 4, 0).filter(largerThan4)\nassert(large == List(5))\n</code></pre>"},{"location":"scala/part-2/#foldleft-","title":"foldLeft - \u7573\u307f\u8fbc\u307f","text":"<pre><code>val sum = List(5, 1, 2, 4, 100).foldLeft(0)((acc, i) =&gt; acc + i)\nassert(sum == 112)\n\nval max = List(5, 1, 2, 4, 15).foldLeft(Int.MinValue)((max, i) =&gt;\n  if (i &gt; max) i else max\n)\nassert(max == 15)\n</code></pre>"},{"location":"scala/part-2/#43-case-class","title":"4.3 case class \u3068\u30d1\u30bf\u30fc\u30f3","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch04_ProgrammingLanguages.scala</code></p> <pre><code>case class ProgrammingLanguage(name: String, year: Int)\n\nval javalang  = ProgrammingLanguage(\"Java\", 1995)\nval scalalang = ProgrammingLanguage(\"Scala\", 2004)\n\nval languages = List(javalang, scalalang)\n\n// \u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u30a2\u30af\u30bb\u30b9\nval names = languages.map(lang =&gt; lang.name)\nassert(names == List(\"Java\", \"Scala\"))\n\n// \u7701\u7565\u8a18\u6cd5\uff08\u30a2\u30f3\u30c0\u30fc\u30b9\u30b3\u30a2\uff09\nval names2 = languages.map(_.name)\nassert(names2 == List(\"Java\", \"Scala\"))\n\n// \u6761\u4ef6\u3067\u30d5\u30a3\u30eb\u30bf\nval young = languages.filter(_.year &gt; 2000)\nassert(young == List(scalalang))\n</code></pre>"},{"location":"scala/part-2/#44","title":"4.4 \u95a2\u6570\u3092\u8fd4\u3059\u95a2\u6570","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch04_ReturningFunctions.scala</code></p> <pre><code>def largerThan(n: Int): Int =&gt; Boolean = i =&gt; i &gt; n\n\nval large = List(5, 1, 2, 4, 0).filter(largerThan(4))\nassert(large == List(5))\n\nval medium = List(5, 1, 2, 4, 0).filter(largerThan(1))\nassert(medium == List(5, 2, 4))\n</code></pre> <p></p>"},{"location":"scala/part-2/#45","title":"4.5 \u30ab\u30ea\u30fc\u5316","text":"<p>\u30ab\u30ea\u30fc\u5316\uff08Currying\uff09\u306f\u3001\u8907\u6570\u306e\u5f15\u6570\u3092\u53d6\u308b\u95a2\u6570\u3092\u3001\u5f15\u6570\u30921\u3064\u305a\u3064\u53d6\u308b\u95a2\u6570\u306e\u30c1\u30a7\u30fc\u30f3\u306b\u5909\u63db\u3059\u308b\u6280\u6cd5\u3067\u3059\u3002</p> <pre><code>// \u901a\u5e38\u306e\u95a2\u6570\ndef largerThanNormal(n: Int, i: Int): Boolean = i &gt; n\n\n// \u30ab\u30ea\u30fc\u5316\u3055\u308c\u305f\u95a2\u6570\ndef largerThan(n: Int)(i: Int): Boolean = i &gt; n\n\n// \u4f7f\u7528\u4f8b\nval large = List(5, 1, 2, 4, 0).filter(largerThan(4))\nassert(large == List(5))\n</code></pre> <p></p>"},{"location":"scala/part-2/#46","title":"4.6 \u30ef\u30fc\u30c9\u30b9\u30b3\u30a2\u30ea\u30f3\u30b0\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch04_WordScoringScala.scala</code></p> <p>\u8907\u6570\u306e\u30b9\u30b3\u30a2\u30ea\u30f3\u30b0\u30ed\u30b8\u30c3\u30af\u3092\u7d44\u307f\u5408\u308f\u305b\u308b\u4f8b\u3067\u3059\u3002</p> <pre><code>def score(word: String): Int = word.replaceAll(\"a\", \"\").length\ndef bonus(word: String): Int = if (word.contains(\"c\")) 5 else 0\ndef penalty(word: String): Int = if (word.contains(\"s\")) 7 else 0\n\nval words = List(\"ada\", \"haskell\", \"scala\", \"java\", \"rust\")\n\n// \u95a2\u6570\u3092\u5f15\u6570\u3068\u3057\u3066\u6e21\u3059\ndef rankedWords(wordScore: String =&gt; Int, words: List[String]): List[String] = {\n  words.sortBy(wordScore).reverse\n}\n\n// \u57fa\u672c\u30b9\u30b3\u30a2\u3067\u30e9\u30f3\u30ad\u30f3\u30b0\nval ranking1 = rankedWords(score, words)\nassert(ranking1 == List(\"haskell\", \"rust\", \"scala\", \"java\", \"ada\"))\n\n// \u30dc\u30fc\u30ca\u30b9\u4ed8\u304d\u30b9\u30b3\u30a2\u3067\u30e9\u30f3\u30ad\u30f3\u30b0\nval ranking2 = rankedWords(w =&gt; score(w) + bonus(w), words)\nassert(ranking2 == List(\"scala\", \"haskell\", \"rust\", \"java\", \"ada\"))\n\n// \u30dc\u30fc\u30ca\u30b9\u3068\u30da\u30ca\u30eb\u30c6\u30a3\u4ed8\u304d\u30b9\u30b3\u30a2\u3067\u30e9\u30f3\u30ad\u30f3\u30b0\nval ranking3 = rankedWords(w =&gt; score(w) + bonus(w) - penalty(w), words)\nassert(ranking3 == List(\"java\", \"scala\", \"ada\", \"haskell\", \"rust\"))\n</code></pre>"},{"location":"scala/part-2/#5-flatmap","title":"\u7b2c5\u7ae0: flatMap \u3068\u30cd\u30b9\u30c8\u69cb\u9020","text":""},{"location":"scala/part-2/#51-flatten-flatmap","title":"5.1 flatten \u3068 flatMap","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch05_BookAdaptations.scala</code></p>"},{"location":"scala/part-2/#flatten-","title":"flatten - \u30cd\u30b9\u30c8\u3057\u305f\u30ea\u30b9\u30c8\u3092\u5e73\u5766\u5316","text":"<pre><code>case class Book(title: String, authors: List[String])\n\nval books = List(\n  Book(\"FP in Scala\", List(\"Chiusano\", \"Bjarnason\")),\n  Book(\"The Hobbit\", List(\"Tolkien\"))\n)\n\n// map \u3060\u3051\u3060\u3068\u30cd\u30b9\u30c8\u3059\u308b\nval authorLists = books.map(_.authors)\n// List(List(\"Chiusano\", \"Bjarnason\"), List(\"Tolkien\"))\n\n// flatten \u3067\u5e73\u5766\u5316\nval authors = authorLists.flatten\n// List(\"Chiusano\", \"Bjarnason\", \"Tolkien\")\n</code></pre>"},{"location":"scala/part-2/#flatmap-map-flatten","title":"flatMap = map + flatten","text":"<pre><code>// map \u3057\u3066 flatten\nval authors1 = books.map(_.authors).flatten\n\n// flatMap \u3067\u540c\u3058\u3053\u3068\u30921\u884c\u3067\nval authors2 = books.flatMap(_.authors)\n\nassert(authors1 == authors2)\n// List(\"Chiusano\", \"Bjarnason\", \"Tolkien\")\n</code></pre>"},{"location":"scala/part-2/#52-flatmap","title":"5.2 flatMap \u306b\u3088\u308b\u30ea\u30b9\u30c8\u30b5\u30a4\u30ba\u306e\u5909\u5316","text":"<pre><code>// \u8981\u7d20\u6570\u304c\u5897\u3048\u308b\nList(1, 2, 3).flatMap(i =&gt; List(i, i + 10))\n// List(1, 11, 2, 12, 3, 13) - 6\u8981\u7d20\n\n// \u8981\u7d20\u6570\u304c\u540c\u3058\nList(1, 2, 3).flatMap(i =&gt; List(i * 2))\n// List(2, 4, 6) - 3\u8981\u7d20\n\n// \u8981\u7d20\u6570\u304c\u6e1b\u308b\uff08\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u52b9\u679c\uff09\nList(1, 2, 3).flatMap(i =&gt; if (i % 2 == 0) List(i) else List.empty)\n// List(2) - 1\u8981\u7d20\n</code></pre>"},{"location":"scala/part-2/#53-flatmap","title":"5.3 \u30cd\u30b9\u30c8\u3057\u305f flatMap","text":"<p>\u8907\u6570\u306e\u30ea\u30b9\u30c8\u3092\u7d44\u307f\u5408\u308f\u305b\u308b\u5834\u5408\u3001flatMap \u3092\u30cd\u30b9\u30c8\u3057\u307e\u3059\u3002</p> <pre><code>case class Book(title: String, authors: List[String])\ncase class Movie(title: String)\n\ndef bookAdaptations(author: String): List[Movie] = {\n  if (author == \"Tolkien\")\n    List(Movie(\"An Unexpected Journey\"), Movie(\"The Desolation of Smaug\"))\n  else\n    List.empty\n}\n\nval books = List(\n  Book(\"FP in Scala\", List(\"Chiusano\", \"Bjarnason\")),\n  Book(\"The Hobbit\", List(\"Tolkien\"))\n)\n\n// \u30cd\u30b9\u30c8\u3057\u305f flatMap\nval recommendations = books.flatMap(book =&gt;\n  book.authors.flatMap(author =&gt;\n    bookAdaptations(author).map(movie =&gt;\n      s\"You may like ${movie.title}, because you liked $author's ${book.title}\"\n    )\n  )\n)\n\n// \u7d50\u679c:\n// List(\n//   \"You may like An Unexpected Journey, because you liked Tolkien's The Hobbit\",\n//   \"You may like The Desolation of Smaug, because you liked Tolkien's The Hobbit\"\n// )\n</code></pre> <p></p>"},{"location":"scala/part-2/#54-for","title":"5.4 for \u5185\u5305\u8868\u8a18","text":"<p>\u30cd\u30b9\u30c8\u3057\u305f flatMap \u306f for \u5185\u5305\u8868\u8a18\u3067\u8aad\u307f\u3084\u3059\u304f\u66f8\u3051\u307e\u3059\u3002</p> <pre><code>// flatMap/map \u7248\nval c1 = books.flatMap(book =&gt;\n  book.authors.flatMap(author =&gt;\n    bookAdaptations(author).map(movie =&gt;\n      s\"You may like ${movie.title}, because you liked $author's ${book.title}\"\n    )\n  )\n)\n\n// for \u5185\u5305\u8868\u8a18\u7248\uff08\u7b49\u4fa1\uff09\nval c2 = for {\n  book   &lt;- books\n  author &lt;- book.authors\n  movie  &lt;- bookAdaptations(author)\n} yield s\"You may like ${movie.title}, because you liked $author's ${book.title}\"\n\nassert(c1 == c2)\n</code></pre> <p></p>"},{"location":"scala/part-2/#55","title":"5.5 \u5186\u5185\u306e\u70b9\u306e\u5224\u5b9a","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch05_PointsInsideCircles.scala</code></p> <p>for \u5185\u5305\u8868\u8a18\u3067\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u3082\u884c\u3046\u4f8b\u3067\u3059\u3002</p> <pre><code>case class Point(x: Int, y: Int)\n\nval points   = List(Point(5, 2), Point(1, 1))\nval radiuses = List(2, 1)\n\ndef isInside(point: Point, radius: Int): Boolean = {\n  radius * radius &gt;= point.x * point.x + point.y * point.y\n}\n\n// \u5168\u7d44\u307f\u5408\u308f\u305b\u3092\u751f\u6210\nval allCombinations = for {\n  r     &lt;- radiuses\n  point &lt;- points\n} yield s\"$point is within a radius of $r: ${isInside(point, r)}\"\n\n// \u7d50\u679c:\n// List(\n//   \"Point(5,2) is within a radius of 2: false\",\n//   \"Point(1,1) is within a radius of 2: true\",\n//   \"Point(5,2) is within a radius of 1: false\",\n//   \"Point(1,1) is within a radius of 1: false\"\n// )\n</code></pre>"},{"location":"scala/part-2/#_1","title":"\u30ac\u30fc\u30c9\u5f0f\u306b\u3088\u308b\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0","text":"<pre><code>// if \u3092\u4f7f\u3063\u305f\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\uff08\u30ac\u30fc\u30c9\u5f0f\uff09\nval insidePoints = for {\n  r     &lt;- radiuses\n  point &lt;- points\n  if isInside(point, r)  // \u30ac\u30fc\u30c9\u5f0f\n} yield s\"$point is within a radius of $r\"\n\n// \u7d50\u679c: List(\"Point(1,1) is within a radius of 2\")\n</code></pre>"},{"location":"scala/part-2/#56-for","title":"5.6 for \u5185\u5305\u8868\u8a18\u3068\u578b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch05_RandomForComprehensions.scala</code></p> <p>for \u5185\u5305\u8868\u8a18\u306e\u623b\u308a\u5024\u306e\u578b\u306f\u3001\u6700\u521d\u306e\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306e\u578b\u306b\u4f9d\u5b58\u3057\u307e\u3059\u3002</p> <pre><code>// List \u304b\u3089\u59cb\u307e\u308b \u2192 List \u3092\u8fd4\u3059\nval listResult = for {\n  a &lt;- List(1, 2)\n  b &lt;- Set(2, 1)\n} yield a * b\n// List(2, 1, 4, 2) - \u91cd\u8907\u3042\u308a\n\n// Set \u304b\u3089\u59cb\u307e\u308b \u2192 Set \u3092\u8fd4\u3059\nval setResult = for {\n  a &lt;- Set(1, 2)\n  b &lt;- List(2, 1)\n} yield a * b\n// Set(2, 1, 4) - \u91cd\u8907\u306a\u3057\n</code></pre> <p></p>"},{"location":"scala/part-2/#_2","title":"\u307e\u3068\u3081","text":""},{"location":"scala/part-2/#part-ii_1","title":"Part II \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"scala/part-2/#_3","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"\u7ae0 \u4e3b\u8981\u6982\u5ff5 \u30ad\u30fc\u64cd\u4f5c \u7b2c3\u7ae0 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb <code>slice</code>, <code>appended</code>, <code>appendedAll</code> \u7b2c4\u7ae0 \u9ad8\u968e\u95a2\u6570 <code>map</code>, <code>filter</code>, <code>foldLeft</code>, <code>sortBy</code> \u7b2c5\u7ae0 \u5e73\u5766\u5316 <code>flatten</code>, <code>flatMap</code>, <code>for</code> \u5185\u5305\u8868\u8a18"},{"location":"scala/part-2/#_4","title":"\u91cd\u8981\u306a\u6cd5\u5247","text":"<ol> <li>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf: \u5143\u306e\u30c7\u30fc\u30bf\u306f\u5909\u66f4\u305b\u305a\u3001\u65b0\u3057\u3044\u30c7\u30fc\u30bf\u3092\u4f5c\u6210\u3059\u308b</li> <li>\u95a2\u6570\u306f\u5024: \u95a2\u6570\u3092\u5f15\u6570\u3068\u3057\u3066\u6e21\u3057\u305f\u308a\u3001\u623b\u308a\u5024\u3068\u3057\u3066\u8fd4\u3057\u305f\u308a\u3067\u304d\u308b</li> <li>flatMap \u30d1\u30bf\u30fc\u30f3: \u30cd\u30b9\u30c8\u3057\u305f\u69cb\u9020\u3092\u5e73\u5766\u5316\u3057\u306a\u304c\u3089\u5909\u63db\u3059\u308b</li> <li>for \u5185\u5305\u8868\u8a18: flatMap/map \u306e\u7cd6\u8863\u69cb\u6587\u3068\u3057\u3066\u4f7f\u3048\u308b</li> </ol>"},{"location":"scala/part-2/#_5","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part III \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li><code>Option</code> \u578b\u306b\u3088\u308b\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0</li> <li><code>Either</code> \u578b\u3068\u8907\u5408\u7684\u306a\u30a8\u30e9\u30fc\u51e6\u7406</li> </ul>"},{"location":"scala/part-2/#_6","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"scala/part-2/#1","title":"\u554f\u984c 1: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u64cd\u4f5c","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u30ea\u30b9\u30c8\u306e\u4e2d\u592e\u306b\u8981\u7d20\u3092\u633f\u5165\u3059\u308b\u95a2\u6570\u3067\u3059\u3002</p> <pre><code>def insertAtMiddle(list: List[String], element: String): List[String] = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert(insertAtMiddle(List(\"a\", \"b\", \"c\", \"d\"), \"X\") == List(\"a\", \"b\", \"X\", \"c\", \"d\"))\nassert(insertAtMiddle(List(\"a\", \"b\"), \"X\") == List(\"a\", \"X\", \"b\"))\n</code></pre> \u89e3\u7b54 <pre><code>def insertAtMiddle(list: List[String], element: String): List[String] = {\n  val middle = list.size / 2\n  val before = list.slice(0, middle)\n  val after  = list.slice(middle, list.size)\n  before.appended(element).appendedAll(after)\n}\n</code></pre>"},{"location":"scala/part-2/#2","title":"\u554f\u984c 2: \u9ad8\u968e\u95a2\u6570","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u6761\u4ef6\u3092\u6e80\u305f\u3059\u8981\u7d20\u306e\u6570\u3092\u30ab\u30a6\u30f3\u30c8\u3059\u308b\u95a2\u6570\u3067\u3059\u3002</p> <pre><code>def countWhere[A](list: List[A], predicate: A =&gt; Boolean): Int = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert(countWhere(List(1, 2, 3, 4, 5), (i: Int) =&gt; i &gt; 3) == 2)\nassert(countWhere(List(\"a\", \"bb\", \"ccc\"), (s: String) =&gt; s.length &gt; 1) == 2)\n</code></pre> \u89e3\u7b54 <pre><code>def countWhere[A](list: List[A], predicate: A =&gt; Boolean): Int = {\n  list.filter(predicate).size\n}\n\n// \u307e\u305f\u306f foldLeft \u3092\u4f7f\u3063\u3066\ndef countWhere2[A](list: List[A], predicate: A =&gt; Boolean): Int = {\n  list.foldLeft(0)((count, elem) =&gt; if (predicate(elem)) count + 1 else count)\n}\n</code></pre>"},{"location":"scala/part-2/#3-for","title":"\u554f\u984c 3: for \u5185\u5305\u8868\u8a18","text":"<p>\u4ee5\u4e0b\u306e\u30cd\u30b9\u30c8\u3057\u305f flatMap \u3092 for \u5185\u5305\u8868\u8a18\u3067\u66f8\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>val result = List(1, 2).flatMap(x =&gt;\n  List(10, 20).flatMap(y =&gt;\n    List(100, 200).map(z =&gt;\n      x + y + z\n    )\n  )\n)\n</code></pre> \u89e3\u7b54 <pre><code>val result = for {\n  x &lt;- List(1, 2)\n  y &lt;- List(10, 20)\n  z &lt;- List(100, 200)\n} yield x + y + z\n\n// \u7d50\u679c: List(111, 211, 121, 221, 112, 212, 122, 222)\n</code></pre>"},{"location":"scala/part-2/#4-flatmap","title":"\u554f\u984c 4: flatMap \u306b\u3088\u308b\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0","text":"<p>for \u5185\u5305\u8868\u8a18\u306e <code>if</code> \u3092\u4f7f\u308f\u305a\u306b\u3001flatMap \u3060\u3051\u3067\u5076\u6570\u306e\u307f\u3092\u62bd\u51fa\u3059\u308b\u30b3\u30fc\u30c9\u3092\u66f8\u3044\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>val numbers = List(1, 2, 3, 4, 5, 6)\n// \u5076\u6570\u306e\u307f\u3092\u62bd\u51fa: List(2, 4, 6)\n</code></pre> \u89e3\u7b54 <pre><code>val evenNumbers = numbers.flatMap(n =&gt;\n  if (n % 2 == 0) List(n) else List.empty\n)\n\n// \u307e\u305f\u306f\u95a2\u6570\u306b\u5206\u96e2\ndef evenFilter(n: Int): List[Int] =\n  if (n % 2 == 0) List(n) else List.empty\n\nval evenNumbers2 = numbers.flatMap(evenFilter)\n</code></pre>"},{"location":"scala/part-3/","title":"Part III: \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3068 Option/Either","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3092\u5b66\u3073\u307e\u3059\u3002<code>null</code> \u3084\u4f8b\u5916\u306b\u983c\u3089\u305a\u3001<code>Option</code> \u3068 <code>Either</code> \u3092\u4f7f\u3063\u3066\u578b\u5b89\u5168\u306b\u30a8\u30e9\u30fc\u3092\u6271\u3046\u65b9\u6cd5\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"scala/part-3/#6-option","title":"\u7b2c6\u7ae0: Option \u578b\u306b\u3088\u308b\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":""},{"location":"scala/part-3/#61-option","title":"6.1 \u306a\u305c Option \u304c\u5fc5\u8981\u304b","text":"<p>\u5f93\u6765\u306e\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u306b\u306f\u554f\u984c\u304c\u3042\u308a\u307e\u3059\u3002</p> <p></p>"},{"location":"scala/part-3/#62-option","title":"6.2 Option \u306e\u57fa\u672c","text":"<p><code>Option[A]</code> \u306f\u300c<code>A</code> \u578b\u306e\u5024\u304c\u3042\u308b\u304b\u3001\u306a\u3044\u304b\u300d\u3092\u8868\u3059\u578b\u3067\u3059\u3002</p> <p></p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch06_TvShows.scala</code></p>"},{"location":"scala/part-3/#63-tv","title":"6.3 TV\u756a\u7d44\u306e\u30d1\u30fc\u30b9\u4f8b","text":"<p>TV\u756a\u7d44\u306e\u6587\u5b57\u5217\u3092\u30d1\u30fc\u30b9\u3059\u308b\u4f8b\u3067 Option \u306e\u4f7f\u3044\u65b9\u3092\u5b66\u3073\u307e\u3059\u3002</p> <pre><code>case class TvShow(title: String, start: Int, end: Int)\n\n// \u5165\u529b\u4f8b: \"Breaking Bad (2008-2013)\"\n// \u671f\u5f85\u3059\u308b\u51fa\u529b: TvShow(\"Breaking Bad\", 2008, 2013)\n</code></pre>"},{"location":"scala/part-3/#_1","title":"\u4f8b\u5916\u3092\u4f7f\u3046\u65b9\u6cd5\uff08\u554f\u984c\u3042\u308a\uff09","text":"<pre><code>def parseShow(rawShow: String): TvShow = {\n  val bracketOpen  = rawShow.indexOf('(')\n  val bracketClose = rawShow.indexOf(')')\n  val dash         = rawShow.indexOf('-')\n\n  val name      = rawShow.substring(0, bracketOpen).trim\n  val yearStart = rawShow.substring(bracketOpen + 1, dash).toInt\n  val yearEnd   = rawShow.substring(dash + 1, bracketClose).toInt\n\n  TvShow(name, yearStart, yearEnd)\n}\n\n// \u6b63\u5e38\u30b1\u30fc\u30b9\nparseShow(\"Breaking Bad (2008-2013)\")  // TvShow(\"Breaking Bad\", 2008, 2013)\n\n// \u7570\u5e38\u30b1\u30fc\u30b9 \u2192 \u4f8b\u5916\u304c\u30b9\u30ed\u30fc\u3055\u308c\u308b!\nparseShow(\"Chernobyl (2019)\")           // StringIndexOutOfBoundsException\nparseShow(\"The Wire 2002-2008\")         // StringIndexOutOfBoundsException\n</code></pre>"},{"location":"scala/part-3/#option","title":"Option \u3092\u4f7f\u3046\u65b9\u6cd5","text":"<pre><code>def parseShow(rawShow: String): Option[TvShow] = {\n  for {\n    name      &lt;- extractName(rawShow)\n    yearStart &lt;- extractYearStart(rawShow)\n    yearEnd   &lt;- extractYearEnd(rawShow)\n  } yield TvShow(name, yearStart, yearEnd)\n}\n\n// \u6b63\u5e38\u30b1\u30fc\u30b9\nparseShow(\"Breaking Bad (2008-2013)\")  // Some(TvShow(\"Breaking Bad\", 2008, 2013))\n\n// \u7570\u5e38\u30b1\u30fc\u30b9 \u2192 None \u304c\u8fd4\u3055\u308c\u308b\uff08\u4f8b\u5916\u306a\u3057\uff09\nparseShow(\"The Wire 2002-2008\")         // None\n</code></pre>"},{"location":"scala/part-3/#64","title":"6.4 \u5c0f\u3055\u306a\u95a2\u6570\u304b\u3089\u7d44\u307f\u7acb\u3066\u308b","text":"<p>\u8907\u96d1\u306a\u30d1\u30fc\u30b9\u51e6\u7406\u3092\u5c0f\u3055\u306a\u95a2\u6570\u306b\u5206\u89e3\u3057\u307e\u3059\u3002</p> <pre><code>// \u540d\u524d\u3092\u62bd\u51fa\ndef extractName(rawShow: String): Option[String] = {\n  val bracketOpen = rawShow.indexOf('(')\n  if (bracketOpen &gt; 0) Some(rawShow.substring(0, bracketOpen).trim)\n  else None\n}\n\n// \u958b\u59cb\u5e74\u3092\u62bd\u51fa\ndef extractYearStart(rawShow: String): Option[Int] = {\n  val bracketOpen = rawShow.indexOf('(')\n  val dash        = rawShow.indexOf('-')\n  for {\n    yearStr &lt;- if (bracketOpen != -1 &amp;&amp; dash &gt; bracketOpen + 1)\n                 Some(rawShow.substring(bracketOpen + 1, dash))\n               else None\n    year    &lt;- yearStr.toIntOption\n  } yield year\n}\n\n// \u7d42\u4e86\u5e74\u3092\u62bd\u51fa\ndef extractYearEnd(rawShow: String): Option[Int] = {\n  val dash         = rawShow.indexOf('-')\n  val bracketClose = rawShow.indexOf(')')\n  for {\n    yearStr &lt;- if (dash != -1 &amp;&amp; bracketClose &gt; dash + 1)\n                 Some(rawShow.substring(dash + 1, bracketClose))\n               else None\n    year    &lt;- yearStr.toIntOption\n  } yield year\n}\n</code></pre> <p></p>"},{"location":"scala/part-3/#65-orelse","title":"6.5 orElse \u306b\u3088\u308b\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af","text":"<p><code>orElse</code> \u3092\u4f7f\u3063\u3066\u3001\u6700\u521d\u306e Option \u304c <code>None</code> \u306e\u5834\u5408\u306b\u4ee3\u66ff\u3092\u8a66\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>val seven: Option[Int] = Some(7)\nval eight: Option[Int] = Some(8)\nval none: Option[Int]  = None\n\nseven.orElse(eight)  // Some(7) - \u6700\u521d\u304c Some \u306a\u306e\u3067\u305d\u306e\u307e\u307e\nnone.orElse(eight)   // Some(8) - \u6700\u521d\u304c None \u306a\u306e\u3067\u4ee3\u66ff\u3092\u4f7f\u7528\nseven.orElse(none)   // Some(7)\nnone.orElse(none)    // None\n</code></pre>"},{"location":"scala/part-3/#_2","title":"\u5358\u5e74\u306e\u756a\u7d44\u306b\u5bfe\u5fdc\u3059\u308b","text":"<p>\u300cChernobyl (2019)\u300d\u306e\u3088\u3046\u306a\u5358\u5e74\u306e\u756a\u7d44\u3092\u30d1\u30fc\u30b9\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002</p> <pre><code>def extractSingleYear(rawShow: String): Option[Int] = {\n  val dash         = rawShow.indexOf('-')\n  val bracketOpen  = rawShow.indexOf('(')\n  val bracketClose = rawShow.indexOf(')')\n  for {\n    yearStr &lt;- if (dash == -1 &amp;&amp; bracketOpen != -1 &amp;&amp; bracketClose &gt; bracketOpen + 1)\n                 Some(rawShow.substring(bracketOpen + 1, bracketClose))\n               else None\n    year    &lt;- yearStr.toIntOption\n  } yield year\n}\n\ndef parseShow(rawShow: String): Option[TvShow] = {\n  for {\n    name      &lt;- extractName(rawShow)\n    yearStart &lt;- extractYearStart(rawShow).orElse(extractSingleYear(rawShow))\n    yearEnd   &lt;- extractYearEnd(rawShow).orElse(extractSingleYear(rawShow))\n  } yield TvShow(name, yearStart, yearEnd)\n}\n\n// \u3053\u308c\u3067\u5358\u5e74\u306e\u756a\u7d44\u3082\u30d1\u30fc\u30b9\u3067\u304d\u308b\nparseShow(\"Chernobyl (2019)\")  // Some(TvShow(\"Chernobyl\", 2019, 2019))\n</code></pre> <p></p>"},{"location":"scala/part-3/#66-option","title":"6.6 Option \u306e\u4e3b\u8981\u30e1\u30bd\u30c3\u30c9","text":"\u30e1\u30bd\u30c3\u30c9 \u8aac\u660e \u4f8b <code>map</code> \u5024\u304c\u3042\u308c\u3070\u5909\u63db <code>Some(5).map(_ * 2)</code> \u2192 <code>Some(10)</code> <code>flatMap</code> \u5024\u304c\u3042\u308c\u3070 Option \u3092\u8fd4\u3059\u95a2\u6570\u3092\u9069\u7528 <code>Some(5).flatMap(x =&gt; Some(x * 2))</code> \u2192 <code>Some(10)</code> <code>filter</code> \u6761\u4ef6\u3092\u6e80\u305f\u3055\u306a\u3051\u308c\u3070 None <code>Some(5).filter(_ &gt; 10)</code> \u2192 <code>None</code> <code>orElse</code> None \u306a\u3089\u4ee3\u66ff\u3092\u4f7f\u7528 <code>None.orElse(Some(5))</code> \u2192 <code>Some(5)</code> <code>getOrElse</code> None \u306a\u3089\u30c7\u30d5\u30a9\u30eb\u30c8\u5024 <code>None.getOrElse(0)</code> \u2192 <code>0</code> <code>toList</code> List \u306b\u5909\u63db <code>Some(5).toList</code> \u2192 <code>List(5)</code> <code>toRight</code> Either \u306b\u5909\u63db <code>Some(5).toRight(\"error\")</code> \u2192 <code>Right(5)</code> <pre><code>val year: Option[Int]   = Some(996)\nval noYear: Option[Int] = None\n\n// map\nyear.map(_ * 2)    // Some(1992)\nnoYear.map(_ * 2)  // None\n\n// flatMap\nyear.flatMap(y =&gt; Some(y * 2))    // Some(1992)\nnoYear.flatMap(y =&gt; Some(y * 2))  // None\n\n// filter\nyear.filter(_ &lt; 2020)   // Some(996)\nyear.filter(_ &gt; 2020)   // None\n\n// orElse\nyear.orElse(Some(2020))    // Some(996)\nnoYear.orElse(Some(2020))  // Some(2020)\n</code></pre>"},{"location":"scala/part-3/#67","title":"6.7 \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u6226\u7565","text":"<p>\u8907\u6570\u306e\u8981\u7d20\u3092\u30d1\u30fc\u30b9\u3059\u308b\u5834\u5408\u30012\u3064\u306e\u6226\u7565\u304c\u3042\u308a\u307e\u3059\u3002</p> <p></p>"},{"location":"scala/part-3/#best-effort","title":"Best-effort \u6226\u7565","text":"<pre><code>def parseShows(rawShows: List[String]): List[TvShow] = {\n  rawShows\n    .map(parseShow)     // List[Option[TvShow]]\n    .map(_.toList)      // List[List[TvShow]]\n    .flatten            // List[TvShow]\n}\n\nval rawShows = List(\n  \"Breaking Bad (2008-2013)\",\n  \"The Wire 2002 2008\",        // \u7121\u52b9\u306a\u5f62\u5f0f\n  \"Mad Men (2007-2015)\"\n)\n\nparseShows(rawShows)\n// List(TvShow(\"Breaking Bad\", 2008, 2013), TvShow(\"Mad Men\", 2007, 2015))\n// \u7121\u52b9\u306a\u3082\u306e\u306f\u7121\u8996\u3055\u308c\u308b\n</code></pre>"},{"location":"scala/part-3/#all-or-nothing","title":"All-or-nothing \u6226\u7565","text":"<pre><code>def addOrResign(\n    parsedShows: Option[List[TvShow]],\n    newParsedShow: Option[TvShow]\n): Option[List[TvShow]] = {\n  for {\n    shows      &lt;- parsedShows\n    parsedShow &lt;- newParsedShow\n  } yield shows.appended(parsedShow)\n}\n\ndef parseShows(rawShows: List[String]): Option[List[TvShow]] = {\n  val initialResult: Option[List[TvShow]] = Some(List.empty)\n  rawShows\n    .map(parseShow)\n    .foldLeft(initialResult)(addOrResign)\n}\n\n// \u5168\u90e8\u6210\u529f \u2192 Some(List(...))\nparseShows(List(\"Breaking Bad (2008-2013)\", \"Mad Men (2007-2015)\"))\n// Some(List(TvShow(\"Breaking Bad\", 2008, 2013), TvShow(\"Mad Men\", 2007, 2015)))\n\n// \u4e00\u3064\u3067\u3082\u5931\u6557 \u2192 None\nparseShows(List(\"Breaking Bad (2008-2013)\", \"Invalid\"))\n// None\n</code></pre>"},{"location":"scala/part-3/#7-either","title":"\u7b2c7\u7ae0: Either \u578b\u3068\u8907\u5408\u7684\u306a\u30a8\u30e9\u30fc\u51e6\u7406","text":""},{"location":"scala/part-3/#71-option","title":"7.1 Option \u306e\u9650\u754c","text":"<p><code>Option</code> \u306f\u300c\u5024\u304c\u3042\u308b\u304b\u306a\u3044\u304b\u300d\u3057\u304b\u8868\u73fe\u3067\u304d\u307e\u305b\u3093\u3002\u306a\u305c\u5931\u6557\u3057\u305f\u306e\u304b\u3092\u4f1d\u3048\u3089\u308c\u307e\u305b\u3093\u3002</p> <p></p>"},{"location":"scala/part-3/#72-either","title":"7.2 Either \u306e\u57fa\u672c","text":"<p><code>Either[E, A]</code> \u306f\u300c<code>E</code> \u578b\u306e\u30a8\u30e9\u30fc\u304b\u3001<code>A</code> \u578b\u306e\u6210\u529f\u5024\u304b\u300d\u3092\u8868\u3059\u578b\u3067\u3059\u3002</p> <ul> <li><code>Right(value)</code>: \u6210\u529f\uff08\u6163\u4f8b\u7684\u306b\u300c\u6b63\u3057\u3044\u300d= right\uff09</li> <li><code>Left(error)</code>: \u5931\u6557\uff08\u30a8\u30e9\u30fc\u60c5\u5831\u3092\u4fdd\u6301\uff09</li> </ul> <pre><code>def extractName(show: String): Either[String, String] = {\n  val bracketOpen = show.indexOf('(')\n  if (bracketOpen &gt; 0) Right(show.substring(0, bracketOpen).trim)\n  else Left(s\"Can't extract name from $show\")\n}\n\nextractName(\"The Wire (2002-2008)\")  // Right(\"The Wire\")\nextractName(\"(2022)\")                // Left(\"Can't extract name from (2022)\")\n</code></pre>"},{"location":"scala/part-3/#73-either","title":"7.3 Either \u3092\u4f7f\u3063\u305f\u30d1\u30fc\u30b9","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch06_TvShows.scala</code></p> <pre><code>def extractYearStart(rawShow: String): Either[String, Int] = {\n  val bracketOpen = rawShow.indexOf('(')\n  val dash        = rawShow.indexOf('-')\n  for {\n    yearStr &lt;- if (bracketOpen != -1 &amp;&amp; dash &gt; bracketOpen + 1)\n                 Right(rawShow.substring(bracketOpen + 1, dash))\n               else Left(s\"Can't extract start year from $rawShow\")\n    year    &lt;- yearStr.toIntOption.toRight(s\"Can't parse $yearStr\")\n  } yield year\n}\n\nextractYearStart(\"The Wire (2002-2008)\")  // Right(2002)\nextractYearStart(\"The Wire (-2008)\")      // Left(\"Can't extract start year from The Wire (-2008)\")\nextractYearStart(\"The Wire (oops-2008)\")  // Left(\"Can't parse oops\")\n</code></pre>"},{"location":"scala/part-3/#74-option-either","title":"7.4 Option \u304b\u3089 Either \u3078\u306e\u5909\u63db","text":"<p><code>toRight</code> \u30e1\u30bd\u30c3\u30c9\u3067 <code>Option</code> \u3092 <code>Either</code> \u306b\u5909\u63db\u3067\u304d\u307e\u3059\u3002</p> <pre><code>val year: Option[Int] = Some(996)\nval noYear: Option[Int] = None\n\nyear.toRight(\"no year given\")    // Right(996)\nnoYear.toRight(\"no year given\")  // Left(\"no year given\")\n</code></pre> <p></p>"},{"location":"scala/part-3/#75-either","title":"7.5 Either \u306b\u3088\u308b\u5b8c\u5168\u306a\u30d1\u30fc\u30b5\u30fc","text":"<pre><code>def parseShow(rawShow: String): Either[String, TvShow] = {\n  for {\n    name      &lt;- extractName(rawShow)\n    yearStart &lt;- extractYearStart(rawShow).orElse(extractSingleYear(rawShow))\n    yearEnd   &lt;- extractYearEnd(rawShow).orElse(extractSingleYear(rawShow))\n  } yield TvShow(name, yearStart, yearEnd)\n}\n\nparseShow(\"The Wire (2002-2008)\")  // Right(TvShow(\"The Wire\", 2002, 2008))\nparseShow(\"Mad Men ()\")            // Left(\"Can't extract single year from Mad Men ()\")\nparseShow(\"The Wire (-)\")          // Left(\"Can't extract single year from The Wire (-)\")\nparseShow(\"(2002-2008)\")           // Left(\"Can't extract name from (2002-2008)\")\n</code></pre>"},{"location":"scala/part-3/#76-either","title":"7.6 Either \u306e\u4e3b\u8981\u30e1\u30bd\u30c3\u30c9","text":"\u30e1\u30bd\u30c3\u30c9 \u8aac\u660e \u4f8b <code>map</code> Right \u306e\u5024\u3092\u5909\u63db <code>Right(5).map(_ * 2)</code> \u2192 <code>Right(10)</code> <code>flatMap</code> Right \u306a\u3089 Either \u3092\u8fd4\u3059\u95a2\u6570\u3092\u9069\u7528 <code>Right(5).flatMap(x =&gt; Right(x * 2))</code> \u2192 <code>Right(10)</code> <code>orElse</code> Left \u306a\u3089\u4ee3\u66ff\u3092\u4f7f\u7528 <code>Left(\"err\").orElse(Right(5))</code> \u2192 <code>Right(5)</code> <code>toOption</code> Option \u306b\u5909\u63db <code>Right(5).toOption</code> \u2192 <code>Some(5)</code> <code>flatten</code> \u30cd\u30b9\u30c8\u3057\u305f Either \u3092\u5e73\u5766\u5316 <code>Right(Right(5)).flatten</code> \u2192 <code>Right(5)</code> <pre><code>val year: Either[String, Int]   = Right(996)\nval noYear: Either[String, Int] = Left(\"no year\")\n\n// map\nyear.map(_ * 2)    // Right(1992)\nnoYear.map(_ * 2)  // Left(\"no year\")\n\n// flatMap\nyear.flatMap(y =&gt; Right(y * 2))             // Right(1992)\nnoYear.flatMap(y =&gt; Right(y * 2))           // Left(\"no year\")\nyear.flatMap(y =&gt; Left(\"can't progress\"))   // Left(\"can't progress\")\n\n// orElse\nyear.orElse(Right(2020))           // Right(996)\nnoYear.orElse(Right(2020))         // Right(2020)\nnoYear.orElse(Left(\"can't recover\")) // Left(\"can't recover\")\n\n// toOption\nyear.toOption    // Some(996)\nnoYear.toOption  // None\n</code></pre>"},{"location":"scala/part-3/#77","title":"7.7 \u97f3\u697d\u30a2\u30fc\u30c6\u30a3\u30b9\u30c8\u691c\u7d22\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch07_MusicArtistsSearch.scala</code></p> <p>\u3088\u308a\u8907\u96d1\u306a\u4f8b\u3068\u3057\u3066\u3001\u97f3\u697d\u30a2\u30fc\u30c6\u30a3\u30b9\u30c8\u306e\u691c\u7d22\u6a5f\u80fd\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p>"},{"location":"scala/part-3/#_3","title":"\u57fa\u672c\u7684\u306a\u30e2\u30c7\u30eb\uff08\u554f\u984c\u3042\u308a\uff09","text":"<pre><code>case class Artist(\n    name: String,\n    genre: String,\n    origin: String,\n    yearsActiveStart: Int,\n    isActive: Boolean,\n    yearsActiveEnd: Int  // \u30a2\u30af\u30c6\u30a3\u30d6\u306a\u5834\u5408\u306f 0 \u3092\u5165\u308c\u308b\uff1f\n)\n</code></pre> <p>\u3053\u306e\u8a2d\u8a08\u306b\u306f\u554f\u984c\u304c\u3042\u308a\u307e\u3059: - <code>isActive</code> \u304c <code>true</code> \u306e\u5834\u5408\u3001<code>yearsActiveEnd</code> \u306f\u4f55\u3092\u5165\u308c\u308b\u3079\u304d\uff1f - \u7121\u52b9\u306a\u72b6\u614b\uff08<code>isActive = true</code> \u304b\u3064 <code>yearsActiveEnd = 2020</code>\uff09\u3092\u4f5c\u308c\u3066\u3057\u307e\u3046</p>"},{"location":"scala/part-3/#option_1","title":"Option \u3092\u4f7f\u3063\u305f\u6539\u5584","text":"<pre><code>case class Artist(\n    name: String,\n    genre: String,\n    origin: String,\n    yearsActiveStart: Int,\n    yearsActiveEnd: Option[Int]  // \u30a2\u30af\u30c6\u30a3\u30d6\u306a\u3089 None\n)\n\nval metallica = Artist(\"Metallica\", \"Heavy Metal\", \"U.S.\", 1981, None)\nval ledZeppelin = Artist(\"Led Zeppelin\", \"Hard Rock\", \"England\", 1968, Some(1980))\n</code></pre>"},{"location":"scala/part-3/#78-adt","title":"7.8 \u4ee3\u6570\u7684\u30c7\u30fc\u30bf\u578b\uff08ADT\uff09","text":"<p>enum\uff08\u5217\u6319\u578b\uff09\u3092\u4f7f\u3063\u3066\u3001\u3088\u308a\u8868\u73fe\u529b\u306e\u9ad8\u3044\u30e2\u30c7\u30eb\u3092\u4f5c\u308c\u307e\u3059\u3002</p>"},{"location":"scala/part-3/#product-type","title":"\u76f4\u7a4d\u578b\uff08Product Type\uff09","text":"<p>\u8907\u6570\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u3092AND\u3067\u7d44\u307f\u5408\u308f\u305b\u308b\u578b\u3067\u3059\u3002</p> <pre><code>case class PeriodInYears(start: Int, end: Option[Int])\n\ncase class Artist(\n    name: String,\n    genre: MusicGenre,\n    origin: Location,\n    yearsActive: PeriodInYears\n)\n</code></pre>"},{"location":"scala/part-3/#sum-type","title":"\u76f4\u548c\u578b\uff08Sum Type\uff09","text":"<p>\u8907\u6570\u306e\u9078\u629e\u80a2\u3092OR\u3067\u8868\u3059\u578b\u3067\u3059\u3002</p> <pre><code>enum MusicGenre {\n  case HeavyMetal\n  case Pop\n  case HardRock\n}\n\nenum YearsActive {\n  case StillActive(since: Int)\n  case ActiveBetween(start: Int, end: Int)\n}\n</code></pre> <p></p>"},{"location":"scala/part-3/#79","title":"7.9 \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0","text":"<p>\u76f4\u548c\u578b\u306f\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3067\u51e6\u7406\u3057\u307e\u3059\u3002</p> <pre><code>def wasArtistActive(artist: Artist, yearStart: Int, yearEnd: Int): Boolean = {\n  artist.yearsActive match {\n    case StillActive(since)        =&gt; since &lt;= yearEnd\n    case ActiveBetween(start, end) =&gt; start &lt;= yearEnd &amp;&amp; end &gt;= yearStart\n  }\n}\n\ndef activeLength(artist: Artist, currentYear: Int): Int = {\n  artist.yearsActive match {\n    case StillActive(since)        =&gt; currentYear - since\n    case ActiveBetween(start, end) =&gt; end - start\n  }\n}\n</code></pre> <p></p>"},{"location":"scala/part-3/#710","title":"7.10 \u691c\u7d22\u6761\u4ef6\u306e\u30e2\u30c7\u30ea\u30f3\u30b0","text":"<p>\u691c\u7d22\u6761\u4ef6\u3082 ADT \u3067\u30e2\u30c7\u30ea\u30f3\u30b0\u3067\u304d\u307e\u3059\u3002</p> <pre><code>enum SearchCondition {\n  case SearchByGenre(genres: List[MusicGenre])\n  case SearchByOrigin(locations: List[Location])\n  case SearchByActiveYears(start: Int, end: Int)\n}\n\ndef searchArtists(\n    artists: List[Artist],\n    requiredConditions: List[SearchCondition]\n): List[Artist] = {\n  artists.filter(artist =&gt;\n    requiredConditions.forall(condition =&gt;\n      condition match {\n        case SearchByGenre(genres)           =&gt; genres.contains(artist.genre)\n        case SearchByOrigin(locations)       =&gt; locations.contains(artist.origin)\n        case SearchByActiveYears(start, end) =&gt; wasArtistActive(artist, start, end)\n      }\n    )\n  )\n}\n</code></pre>"},{"location":"scala/part-3/#711-forall-exists","title":"7.11 forall \u3068 exists","text":"<p>Option \u3068 List \u3067\u6761\u4ef6\u5224\u5b9a\u3092\u3059\u308b\u969b\u306b\u4fbf\u5229\u306a\u30e1\u30bd\u30c3\u30c9\u3067\u3059\u3002</p> \u30e1\u30bd\u30c3\u30c9 Option \u3067\u306e\u52d5\u4f5c List \u3067\u306e\u52d5\u4f5c <code>forall(p)</code> None \u2192 true, Some(x) \u2192 p(x) \u5168\u8981\u7d20\u304c p \u3092\u6e80\u305f\u3059 <code>exists(p)</code> None \u2192 false, Some(x) \u2192 p(x) \u3044\u305a\u308c\u304b\u306e\u8981\u7d20\u304c p \u3092\u6e80\u305f\u3059 <code>contains(x)</code> Some(x) \u3068\u7b49\u3057\u3044\u304b x \u3092\u542b\u3080\u304b <pre><code>val year: Option[Int] = Some(996)\nval noYear: Option[Int] = None\n\n// forall - \u300c\u5168\u3066\u300d\u307e\u305f\u306f\u300c\u5b58\u5728\u3057\u306a\u3044\u300d\nyear.forall(_ &lt; 2020)    // true (996 &lt; 2020)\nnoYear.forall(_ &lt; 2020)  // true (\u5024\u304c\u306a\u3044\u306e\u3067\u300c\u5168\u3066\u300d\u304c\u81ea\u660e\u306b\u771f)\nyear.forall(_ &gt; 2020)    // false\n\n// exists - \u300c\u5b58\u5728\u3057\u3066\u6761\u4ef6\u3092\u6e80\u305f\u3059\u300d\nyear.exists(_ &lt; 2020)    // true\nnoYear.exists(_ &lt; 2020)  // false (\u5024\u304c\u306a\u3044\u306e\u3067\u5b58\u5728\u3057\u306a\u3044)\n</code></pre>"},{"location":"scala/part-3/#_4","title":"\u307e\u3068\u3081","text":""},{"location":"scala/part-3/#part-iii","title":"Part III \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"scala/part-3/#option-vs-either","title":"Option vs Either \u306e\u4f7f\u3044\u5206\u3051","text":"\u72b6\u6cc1 \u4f7f\u7528\u3059\u308b\u578b \u5024\u304c\u3042\u308b\u304b\u306a\u3044\u304b\u3060\u3051\u304c\u91cd\u8981 <code>Option[A]</code> \u5931\u6557\u7406\u7531\u3092\u4f1d\u3048\u308b\u5fc5\u8981\u304c\u3042\u308b <code>Either[E, A]</code> \u691c\u7d22\u7d50\u679c\u304c\u898b\u3064\u304b\u3089\u306a\u3044 <code>Option[A]</code> \u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u30a8\u30e9\u30fc\u3092\u4f1d\u3048\u308b <code>Either[String, A]</code> \u8907\u6570\u306e\u30a8\u30e9\u30fc\u7a2e\u5225\u304c\u3042\u308b <code>Either[ErrorType, A]</code>"},{"location":"scala/part-3/#_5","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>Option: \u5024\u306e\u6709\u7121\u3092\u578b\u3067\u8868\u73fe\u3059\u308b</li> <li>Either: \u6210\u529f/\u5931\u6557\u3068\u30a8\u30e9\u30fc\u60c5\u5831\u3092\u578b\u3067\u8868\u73fe\u3059\u308b</li> <li>for \u5185\u5305\u8868\u8a18: Option/Either \u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u4f7f\u3046</li> <li>orElse: \u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u3092\u63d0\u4f9b\u3059\u308b</li> <li>ADT: \u76f4\u7a4d\u578b\u3068\u76f4\u548c\u578b\u3067\u30c9\u30e1\u30a4\u30f3\u3092\u6b63\u78ba\u306b\u30e2\u30c7\u30ea\u30f3\u30b0</li> <li>\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0: \u76f4\u548c\u578b\u3092\u5b89\u5168\u306b\u51e6\u7406\u3059\u308b</li> </ol>"},{"location":"scala/part-3/#_6","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part IV \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li>IO \u30e2\u30ca\u30c9\u306e\u5c0e\u5165</li> <li>\u526f\u4f5c\u7528\u306e\u7ba1\u7406</li> <li>\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406</li> </ul>"},{"location":"scala/part-3/#_7","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"scala/part-3/#1-option","title":"\u554f\u984c 1: Option \u306e\u57fa\u672c","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>def safeDivide(a: Int, b: Int): Option[Int] = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert(safeDivide(10, 2) == Some(5))\nassert(safeDivide(10, 0) == None)\nassert(safeDivide(7, 2) == Some(3))\n</code></pre> \u89e3\u7b54 <pre><code>def safeDivide(a: Int, b: Int): Option[Int] = {\n  if (b == 0) None\n  else Some(a / b)\n}\n</code></pre>"},{"location":"scala/part-3/#2-option","title":"\u554f\u984c 2: Option \u306e\u5408\u6210","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u30022\u3064\u306e\u6570\u5024\u6587\u5b57\u5217\u3092\u53d7\u3051\u53d6\u308a\u3001\u305d\u306e\u5408\u8a08\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>def addStrings(a: String, b: String): Option[Int] = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert(addStrings(\"10\", \"20\") == Some(30))\nassert(addStrings(\"10\", \"abc\") == None)\nassert(addStrings(\"xyz\", \"20\") == None)\n</code></pre> \u89e3\u7b54 <pre><code>def addStrings(a: String, b: String): Option[Int] = {\n  for {\n    x &lt;- a.toIntOption\n    y &lt;- b.toIntOption\n  } yield x + y\n}\n</code></pre>"},{"location":"scala/part-3/#3-either","title":"\u554f\u984c 3: Either \u306b\u3088\u308b\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u5e74\u9f62\u3092\u691c\u8a3c\u3057\u3001\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>def validateAge(age: Int): Either[String, Int] = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert(validateAge(25) == Right(25))\nassert(validateAge(-5) == Left(\"Age cannot be negative\"))\nassert(validateAge(200) == Left(\"Age cannot be greater than 150\"))\n</code></pre> \u89e3\u7b54 <pre><code>def validateAge(age: Int): Either[String, Int] = {\n  if (age &lt; 0) Left(\"Age cannot be negative\")\n  else if (age &gt; 150) Left(\"Age cannot be greater than 150\")\n  else Right(age)\n}\n</code></pre>"},{"location":"scala/part-3/#4","title":"\u554f\u984c 4: \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0","text":"<p>\u4ee5\u4e0b\u306e enum \u3068\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u4f7f\u3063\u305f\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>enum PaymentMethod {\n  case CreditCard(number: String, expiry: String)\n  case BankTransfer(accountNumber: String)\n  case Cash\n}\n\ndef describePayment(method: PaymentMethod): String = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert(describePayment(CreditCard(\"1234\", \"12/25\")) == \"Credit card ending in 1234\")\nassert(describePayment(BankTransfer(\"9876\")) == \"Bank transfer to account 9876\")\nassert(describePayment(Cash) == \"Cash payment\")\n</code></pre> \u89e3\u7b54 <pre><code>import PaymentMethod._\n\ndef describePayment(method: PaymentMethod): String = method match {\n  case CreditCard(number, _) =&gt; s\"Credit card ending in $number\"\n  case BankTransfer(account) =&gt; s\"Bank transfer to account $account\"\n  case Cash                  =&gt; \"Cash payment\"\n}\n</code></pre>"},{"location":"scala/part-3/#5-forall-exists","title":"\u554f\u984c 5: forall \u3068 exists","text":"<p>\u4ee5\u4e0b\u306e\u6761\u4ef6\u306b\u5408\u3046\u30e6\u30fc\u30b6\u30fc\u3092\u62bd\u51fa\u3059\u308b\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>case class User(name: String, email: Option[String], age: Int)\n\nval users = List(\n  User(\"Alice\", Some(\"alice@example.com\"), 25),\n  User(\"Bob\", None, 30),\n  User(\"Charlie\", Some(\"charlie@test.com\"), 17)\n)\n\n// 1. \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u304b\u3001example.com \u30c9\u30e1\u30a4\u30f3\u306e\u30e6\u30fc\u30b6\u30fc\ndef f1(users: List[User]): List[User] = ???\n\n// 2. \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u3066\u3001test.com \u30c9\u30e1\u30a4\u30f3\u306e\u30e6\u30fc\u30b6\u30fc\ndef f2(users: List[User]): List[User] = ???\n</code></pre> \u89e3\u7b54 <pre><code>// 1. \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u304b\u3001example.com \u30c9\u30e1\u30a4\u30f3\ndef f1(users: List[User]): List[User] = {\n  users.filter(_.email.forall(_.endsWith(\"@example.com\")))\n}\n// List(User(\"Alice\", ...), User(\"Bob\", None, 30))\n\n// 2. \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u3066\u3001test.com \u30c9\u30e1\u30a4\u30f3\ndef f2(users: List[User]): List[User] = {\n  users.filter(_.email.exists(_.endsWith(\"@test.com\")))\n}\n// List(User(\"Charlie\", ...))\n</code></pre>"},{"location":"scala/part-4/","title":"Part IV: IO \u3068\u526f\u4f5c\u7528\u306e\u7ba1\u7406","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u526f\u4f5c\u7528\u306e\u6271\u3044\u65b9\u3092\u5b66\u3073\u307e\u3059\u3002IO \u30e2\u30ca\u30c9\u3092\u4f7f\u3063\u3066\u526f\u4f5c\u7528\u3092\u7d14\u7c8b\u95a2\u6570\u5185\u3067\u5b89\u5168\u306b\u8a18\u8ff0\u3057\u3001\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406\u3067\u7121\u9650\u306e\u30c7\u30fc\u30bf\u3092\u6271\u3046\u65b9\u6cd5\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"scala/part-4/#8-io","title":"\u7b2c8\u7ae0: IO \u30e2\u30ca\u30c9\u306e\u5c0e\u5165","text":""},{"location":"scala/part-4/#81","title":"8.1 \u526f\u4f5c\u7528\u306e\u554f\u984c","text":"<p>\u7d14\u7c8b\u95a2\u6570\u306f\u526f\u4f5c\u7528\u3092\u6301\u3061\u307e\u305b\u3093\u3002\u3057\u304b\u3057\u3001\u5b9f\u969b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u306b\u306f\u526f\u4f5c\u7528\u304c\u5fc5\u8981\u3067\u3059:</p> <ul> <li>\u30d5\u30a1\u30a4\u30eb\u306e\u8aad\u307f\u66f8\u304d</li> <li>\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u901a\u4fe1</li> <li>\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30a2\u30af\u30bb\u30b9</li> <li>\u4e71\u6570\u751f\u6210</li> <li>\u73fe\u5728\u6642\u523b\u306e\u53d6\u5f97</li> </ul> <p></p>"},{"location":"scala/part-4/#82-io","title":"8.2 IO \u30e2\u30ca\u30c9\u3068\u306f","text":"<p>IO \u30e2\u30ca\u30c9\u306f\u300c\u526f\u4f5c\u7528\u3092\u6301\u3064\u8a08\u7b97\u306e\u8a18\u8ff0\u300d\u3092\u8868\u3059\u578b\u3067\u3059\u3002</p> <ul> <li><code>IO[A]</code> \u306f\u300c\u5b9f\u884c\u3059\u308b\u3068 <code>A</code> \u578b\u306e\u5024\u3092\u8fd4\u3059\u526f\u4f5c\u7528\u306e\u3042\u308b\u8a08\u7b97\u300d</li> <li>IO \u5024\u3092\u4f5c\u6210\u3057\u305f\u3060\u3051\u3067\u306f\u526f\u4f5c\u7528\u306f\u767a\u751f\u3057\u306a\u3044</li> <li><code>unsafeRunSync()</code> \u3067\u5b9f\u969b\u306b\u5b9f\u884c\u3055\u308c\u308b</li> </ul> <p></p>"},{"location":"scala/part-4/#83","title":"8.3 \u30b5\u30a4\u30b3\u30ed\u3092\u632f\u308b\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch08_CastingDie.scala</code></p>"},{"location":"scala/part-4/#_1","title":"\u4e0d\u7d14\u306a\u95a2\u6570\uff08\u526f\u4f5c\u7528\u3042\u308a\uff09","text":"<pre><code>def castTheDieImpure(): Int = {\n  val random = new java.util.Random()\n  random.nextInt(6) + 1\n}\n\n// \u547c\u3073\u51fa\u3059\u305f\u3073\u306b\u7570\u306a\u308b\u5024\u304c\u8fd4\u308b\nprintln(castTheDieImpure())  // 3\nprintln(castTheDieImpure())  // 5\nprintln(castTheDieImpure())  // 1\n</code></pre>"},{"location":"scala/part-4/#io","title":"IO \u3092\u4f7f\u3063\u305f\u7d14\u7c8b\u306a\u8a18\u8ff0","text":"<pre><code>import cats.effect.IO\n\ndef castTheDie(): IO[Int] = IO.delay(castTheDieImpure())\n\n// IO \u5024\u3092\u4f5c\u6210\uff08\u3053\u306e\u6642\u70b9\u3067\u306f\u5b9f\u884c\u3055\u308c\u306a\u3044\uff09\nval dieCast: IO[Int] = castTheDie()\nprintln(dieCast)  // IO(...) - \u307e\u3060\u5b9f\u884c\u3055\u308c\u3066\u3044\u306a\u3044\n\n// \u5b9f\u969b\u306b\u5b9f\u884c\nprintln(dieCast.unsafeRunSync())  // 4\n</code></pre>"},{"location":"scala/part-4/#84-io","title":"8.4 IO \u306e\u4f5c\u6210\u65b9\u6cd5","text":"\u30e1\u30bd\u30c3\u30c9 \u7528\u9014 \u4f8b <code>IO.delay(expr)</code> \u526f\u4f5c\u7528\u306e\u3042\u308b\u5f0f\u3092\u30e9\u30c3\u30d7 <code>IO.delay(println(\"hello\"))</code> <code>IO.pure(value)</code> \u65e2\u5b58\u306e\u5024\u3092\u30e9\u30c3\u30d7\uff08\u526f\u4f5c\u7528\u306a\u3057\uff09 <code>IO.pure(42)</code> <code>IO.unit</code> \u4f55\u3082\u3057\u306a\u3044 IO <code>IO.unit</code> (= <code>IO.pure(())</code>) <pre><code>// IO.delay: \u526f\u4f5c\u7528\u3092\u9045\u5ef6\u5b9f\u884c\nval delayedPrint: IO[Unit] = IO.delay(println(\"Hello\"))\n// println \u306f\u307e\u3060\u5b9f\u884c\u3055\u308c\u3066\u3044\u306a\u3044\n\n// IO.pure: \u65e2\u5b58\u306e\u5024\u3092\u30e9\u30c3\u30d7\nval pureValue: IO[Int] = IO.pure(42)\n// \u526f\u4f5c\u7528\u306a\u3057\u3001\u5373\u5ea7\u306b 42 \u304c\u78ba\u5b9a\n</code></pre>"},{"location":"scala/part-4/#85-io","title":"8.5 IO \u306e\u5408\u6210","text":"<p>IO \u5024\u306f <code>flatMap</code> \u3084 <code>for</code> \u5185\u5305\u8868\u8a18\u3067\u5408\u6210\u3067\u304d\u307e\u3059\u3002</p> <pre><code>def castTheDieTwice(): IO[Int] = {\n  for {\n    firstCast  &lt;- castTheDie()\n    secondCast &lt;- castTheDie()\n  } yield firstCast + secondCast\n}\n\n// \u307e\u3060\u5b9f\u884c\u3055\u308c\u3066\u3044\u306a\u3044\nval program: IO[Int] = castTheDieTwice()\n\n// \u5b9f\u884c\nval result: Int = program.unsafeRunSync()\n</code></pre> <p></p>"},{"location":"scala/part-4/#86","title":"8.6 \u30df\u30fc\u30c6\u30a3\u30f3\u30b0\u30b9\u30b1\u30b8\u30e5\u30fc\u30ea\u30f3\u30b0\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch08_SchedulingMeetings.scala</code></p> <p>\u3088\u308a\u5b9f\u8df5\u7684\u306a\u4f8b\u3068\u3057\u3066\u3001\u30df\u30fc\u30c6\u30a3\u30f3\u30b0\u306e\u30b9\u30b1\u30b8\u30e5\u30fc\u30ea\u30f3\u30b0\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p> <pre><code>case class MeetingTime(startHour: Int, endHour: Int)\n\n// \u526f\u4f5c\u7528\u306e\u3042\u308b API \u547c\u3073\u51fa\u3057\u3092 IO \u3067\u30e9\u30c3\u30d7\ndef calendarEntries(name: String): IO[List[MeetingTime]] = {\n  IO.delay(calendarEntriesApiCall(name))\n}\n\ndef createMeeting(names: List[String], meeting: MeetingTime): IO[Unit] = {\n  IO.delay(createMeetingApiCall(names, meeting))\n}\n</code></pre>"},{"location":"scala/part-4/#_2","title":"\u4e88\u5b9a\u306e\u53d6\u5f97","text":"<pre><code>def scheduledMeetings(person1: String, person2: String): IO[List[MeetingTime]] = {\n  for {\n    person1Entries &lt;- calendarEntries(person1)\n    person2Entries &lt;- calendarEntries(person2)\n  } yield person1Entries.appendedAll(person2Entries)\n}\n</code></pre>"},{"location":"scala/part-4/#_3","title":"\u7a7a\u304d\u6642\u9593\u306e\u8a08\u7b97\uff08\u7d14\u7c8b\u95a2\u6570\uff09","text":"<pre><code>def possibleMeetings(\n    existingMeetings: List[MeetingTime],\n    startHour: Int,\n    endHour: Int,\n    lengthHours: Int\n): List[MeetingTime] = {\n  val slots = List.range(startHour, endHour - lengthHours + 1)\n    .map(start =&gt; MeetingTime(start, start + lengthHours))\n  slots.filter(slot =&gt;\n    existingMeetings.forall(meeting =&gt; !meetingsOverlap(meeting, slot))\n  )\n}\n</code></pre>"},{"location":"scala/part-4/#87-orelse","title":"8.7 orElse \u306b\u3088\u308b\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":"<p>IO \u306e <code>orElse</code> \u30e1\u30bd\u30c3\u30c9\u3067\u3001\u5931\u6557\u6642\u306e\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002</p> <pre><code>val year: IO[Int]   = IO.delay(996)\nval noYear: IO[Int] = IO.delay(throw new Exception(\"no year\"))\n\nyear.orElse(IO.delay(2020)).unsafeRunSync()    // 996\nnoYear.orElse(IO.delay(2020)).unsafeRunSync()  // 2020\n</code></pre> <p></p>"},{"location":"scala/part-4/#_4","title":"\u30ea\u30c8\u30e9\u30a4\u6226\u7565","text":"<pre><code>// API \u547c\u3073\u51fa\u3057\u30923\u56de\u307e\u3067\u30ea\u30c8\u30e9\u30a4\ncalendarEntries(\"Alice\")\n  .orElse(calendarEntries(\"Alice\"))\n  .orElse(calendarEntries(\"Alice\"))\n  .orElse(IO.pure(List.empty))  // \u5168\u90e8\u5931\u6557\u3057\u305f\u3089\u7a7a\u30ea\u30b9\u30c8\n</code></pre>"},{"location":"scala/part-4/#_5","title":"\u6c4e\u7528\u30ea\u30c8\u30e9\u30a4\u95a2\u6570","text":"<pre><code>def retry[A](action: IO[A], maxRetries: Int): IO[A] = {\n  List.range(0, maxRetries)\n    .map(_ =&gt; action)\n    .foldLeft(action)((program, retryAction) =&gt;\n      program.orElse(retryAction)\n    )\n}\n\n// \u4f7f\u7528\u4f8b\nretry(calendarEntries(\"Alice\"), 10)\n</code></pre>"},{"location":"scala/part-4/#88-sequence-io","title":"8.8 sequence \u306b\u3088\u308b IO \u306e\u30ea\u30b9\u30c8\u51e6\u7406","text":"<p><code>List[IO[A]]</code> \u3092 <code>IO[List[A]]</code> \u306b\u5909\u63db\u3059\u308b\u306b\u306f <code>sequence</code> \u3092\u4f7f\u3044\u307e\u3059\u3002</p> <pre><code>import cats.implicits._\n\nval actions: List[IO[Int]] = List(IO.pure(1), IO.pure(2), IO.pure(3))\nval combined: IO[List[Int]] = actions.sequence\n\ncombined.unsafeRunSync()  // List(1, 2, 3)\n</code></pre>"},{"location":"scala/part-4/#_6","title":"\u8907\u6570\u4eba\u306e\u4e88\u5b9a\u3092\u53d6\u5f97","text":"<pre><code>def scheduledMeetings(attendees: List[String]): IO[List[MeetingTime]] = {\n  attendees\n    .map(attendee =&gt; retry(calendarEntries(attendee), 10))\n    .sequence\n    .map(_.flatten)\n}\n</code></pre>"},{"location":"scala/part-4/#9","title":"\u7b2c9\u7ae0: \u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406","text":""},{"location":"scala/part-4/#91","title":"9.1 \u30b9\u30c8\u30ea\u30fc\u30e0\u3068\u306f","text":"<p>\u30b9\u30c8\u30ea\u30fc\u30e0\u306f\u3001\u8981\u7d20\u306e\uff08\u6f5c\u5728\u7684\u306b\u7121\u9650\u306e\uff09\u30b7\u30fc\u30b1\u30f3\u30b9\u3092\u8868\u3057\u307e\u3059\u3002fs2 \u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002</p> <p></p>"},{"location":"scala/part-4/#92","title":"9.2 \u7d14\u7c8b\u306a\u30b9\u30c8\u30ea\u30fc\u30e0","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch09_CastingDieStream.scala</code></p> <pre><code>import fs2.{Pure, Stream}\n\n// \u6709\u9650\u30b9\u30c8\u30ea\u30fc\u30e0\nval numbers: Stream[Pure, Int] = Stream(1, 2, 3)\n\n// List \u306b\u5909\u63db\nnumbers.toList  // List(1, 2, 3)\n\n// \u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\nval oddNumbers = numbers.filter(_ % 2 != 0)\noddNumbers.toList  // List(1, 3)\n</code></pre>"},{"location":"scala/part-4/#93","title":"9.3 \u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0","text":"<pre><code>// repeat \u3067\u7121\u9650\u306b\u7e70\u308a\u8fd4\u3057\nval infinite123s: Stream[Pure, Int] = Stream(1, 2, 3).repeat\n\n// take \u3067\u6709\u9650\u500b\u3092\u53d6\u5f97\ninfinite123s.take(8).toList  // List(1, 2, 3, 1, 2, 3, 1, 2)\n</code></pre>"},{"location":"scala/part-4/#94-io","title":"9.4 IO \u3092\u542b\u3080\u30b9\u30c8\u30ea\u30fc\u30e0","text":"<pre><code>import cats.effect.IO\nimport fs2.Stream\n\ndef castTheDie(): IO[Int] = IO.delay(castTheDieImpure())\n\n// \u5358\u4e00\u306e IO \u3092\u30b9\u30c8\u30ea\u30fc\u30e0\u306b\nval dieCast: Stream[IO, Int] = Stream.eval(castTheDie())\n\n// \u7121\u9650\u306b\u30b5\u30a4\u30b3\u30ed\u3092\u632f\u308b\u30b9\u30c8\u30ea\u30fc\u30e0\nval infiniteDieCasts: Stream[IO, Int] = Stream.eval(castTheDie()).repeat\n</code></pre>"},{"location":"scala/part-4/#_7","title":"\u30b9\u30c8\u30ea\u30fc\u30e0\u306e\u5b9f\u884c","text":"<pre><code>// \u6700\u521d\u306e3\u56de\u3092\u53d6\u5f97\nval firstThree: IO[List[Int]] = infiniteDieCasts.take(3).compile.toList\nfirstThree.unsafeRunSync()  // List(4, 2, 6)\n\n// 6 \u304c\u51fa\u308b\u307e\u3067\u632f\u308a\u7d9a\u3051\u308b\nval six: IO[List[Int]] = infiniteDieCasts.filter(_ == 6).take(1).compile.toList\nsix.unsafeRunSync()  // List(6)\n</code></pre>"},{"location":"scala/part-4/#95","title":"9.5 \u30b9\u30c8\u30ea\u30fc\u30e0\u306e\u4e3b\u8981\u64cd\u4f5c","text":"\u64cd\u4f5c \u8aac\u660e \u4f8b <code>take(n)</code> \u6700\u521d\u306e n \u8981\u7d20\u3092\u53d6\u5f97 <code>stream.take(3)</code> <code>filter(p)</code> \u6761\u4ef6\u3092\u6e80\u305f\u3059\u8981\u7d20\u306e\u307f <code>stream.filter(_ &gt; 0)</code> <code>map(f)</code> \u5404\u8981\u7d20\u3092\u5909\u63db <code>stream.map(_ * 2)</code> <code>append(s)</code> \u5225\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u7d50\u5408 <code>stream1.append(stream2)</code> <code>repeat</code> \u7121\u9650\u306b\u7e70\u308a\u8fd4\u3057 <code>stream.repeat</code> <code>sliding(n)</code> \u30b9\u30e9\u30a4\u30c7\u30a3\u30f3\u30b0\u30a6\u30a3\u30f3\u30c9\u30a6 <code>stream.sliding(3)</code>"},{"location":"scala/part-4/#96","title":"9.6 \u901a\u8ca8\u4ea4\u63db\u30ec\u30fc\u30c8\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch09_CurrencyExchange.scala</code></p> <p>\u70ba\u66ff\u30ec\u30fc\u30c8\u3092\u76e3\u8996\u3057\u3066\u3001\u4e0a\u6607\u30c8\u30ec\u30f3\u30c9\u3092\u691c\u51fa\u3059\u308b\u4f8b\u3067\u3059\u3002</p>"},{"location":"scala/part-4/#_8","title":"\u30c8\u30ec\u30f3\u30c9\u5224\u5b9a\uff08\u7d14\u7c8b\u95a2\u6570\uff09","text":"<pre><code>def trending(rates: List[BigDecimal]): Boolean = {\n  rates.size &gt; 1 &amp;&amp;\n  rates.zip(rates.drop(1)).forall {\n    case (previousRate, rate) =&gt; rate &gt; previousRate\n  }\n}\n\ntrending(List(0.81, 0.82, 0.83))  // true (\u4e0a\u6607\u30c8\u30ec\u30f3\u30c9)\ntrending(List(0.81, 0.84, 0.83))  // false\n</code></pre>"},{"location":"scala/part-4/#_9","title":"\u30ec\u30fc\u30c8\u306e\u30b9\u30c8\u30ea\u30fc\u30e0","text":"<pre><code>def rates(from: Currency, to: Currency): Stream[IO, BigDecimal] = {\n  Stream\n    .eval(exchangeTable(from))\n    .repeat\n    .map(extractSingleCurrencyRate(to))\n    .unNone  // None \u3092\u9664\u5916\n    .orElse(rates(from, to))  // \u30a8\u30e9\u30fc\u6642\u306f\u30ea\u30c8\u30e9\u30a4\n}\n</code></pre>"},{"location":"scala/part-4/#97","title":"9.7 \u30b9\u30e9\u30a4\u30c7\u30a3\u30f3\u30b0\u30a6\u30a3\u30f3\u30c9\u30a6","text":"<p><code>sliding</code> \u3067\u9023\u7d9a\u3059\u308b\u8981\u7d20\u3092\u30b0\u30eb\u30fc\u30d7\u5316\u3067\u304d\u307e\u3059\u3002</p> <pre><code>val stream = Stream(1, 2, 3, 4, 5)\n\nstream.sliding(3).toList\n// List(Queue(1, 2, 3), Queue(2, 3, 4), Queue(3, 4, 5))\n</code></pre> <p></p>"},{"location":"scala/part-4/#_10","title":"\u30c8\u30ec\u30f3\u30c9\u3092\u691c\u51fa\u3057\u3066\u4ea4\u63db","text":"<pre><code>def exchangeIfTrending(\n    amount: BigDecimal,\n    from: Currency,\n    to: Currency\n): IO[BigDecimal] = {\n  rates(from, to)\n    .sliding(3)\n    .map(_.toList)\n    .filter(trending)        // \u4e0a\u6607\u30c8\u30ec\u30f3\u30c9\u3092\u691c\u51fa\n    .map(_.last)             // \u6700\u65b0\u306e\u30ec\u30fc\u30c8\u3092\u53d6\u5f97\n    .take(1)\n    .compile\n    .lastOrError\n    .map(_ * amount)\n}\n</code></pre>"},{"location":"scala/part-4/#98","title":"9.8 \u30b9\u30c8\u30ea\u30fc\u30e0\u306e\u7d50\u5408","text":"<p>2\u3064\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\u3092 <code>zip</code> \u3067\u7d50\u5408\u3067\u304d\u307e\u3059\u3002</p> <pre><code>import scala.concurrent.duration._\n\nval ticks: Stream[IO, Unit] = Stream.fixedRate[IO](1.second)\n\n// \u30ec\u30fc\u30c8\u3068 tick \u3092\u7d50\u5408\uff081\u79d2\u9593\u9694\u3067\u53d6\u5f97\uff09\nval ratesWithDelay = rates(from, to).zipLeft(ticks)\n</code></pre> <p></p>"},{"location":"scala/part-4/#_11","title":"\u307e\u3068\u3081","text":""},{"location":"scala/part-4/#part-iv","title":"Part IV \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"scala/part-4/#io-stream","title":"IO \u3068 Stream \u306e\u6bd4\u8f03","text":"\u7279\u6027 IO[A] Stream[IO, A] \u8981\u7d20\u6570 1\u3064 0\u500b\u4ee5\u4e0a\uff08\u7121\u9650\u3082\u53ef\uff09 \u5b9f\u884c <code>unsafeRunSync()</code> <code>compile.toList.unsafeRunSync()</code> \u7528\u9014 \u5358\u4e00\u306e\u526f\u4f5c\u7528 \u9023\u7d9a\u3057\u305f\u526f\u4f5c\u7528"},{"location":"scala/part-4/#_12","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>IO \u30e2\u30ca\u30c9: \u526f\u4f5c\u7528\u3092\u300c\u8a18\u8ff0\u300d\u3068\u3057\u3066\u6271\u3044\u3001\u5b9f\u884c\u3092\u9045\u5ef6\u3055\u305b\u308b</li> <li>IO.delay: \u526f\u4f5c\u7528\u306e\u3042\u308b\u5f0f\u3092 IO \u306b\u30e9\u30c3\u30d7</li> <li>orElse: \u5931\u6557\u6642\u306e\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u3092\u6307\u5b9a</li> <li>sequence: <code>List[IO[A]]</code> \u2192 <code>IO[List[A]]</code></li> <li>Stream: \u6f5c\u5728\u7684\u306b\u7121\u9650\u306e\u30b7\u30fc\u30b1\u30f3\u30b9\u3092\u9045\u5ef6\u8a55\u4fa1\u3067\u51e6\u7406</li> <li>sliding: \u9023\u7d9a\u3059\u308b\u8981\u7d20\u3092\u30b0\u30eb\u30fc\u30d7\u5316\u3057\u3066\u30d1\u30bf\u30fc\u30f3\u3092\u691c\u51fa</li> </ol>"},{"location":"scala/part-4/#_13","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part V \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li>\u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406</li> <li>Fiber \u306b\u3088\u308b\u8efd\u91cf\u30b9\u30ec\u30c3\u30c9</li> <li>Ref \u306b\u3088\u308b\u5171\u6709\u72b6\u614b\u7ba1\u7406</li> </ul>"},{"location":"scala/part-4/#_14","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"scala/part-4/#1-io","title":"\u554f\u984c 1: IO \u306e\u57fa\u672c","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>import cats.effect.IO\n\ndef printAndReturn(message: String): IO[String] = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\n// printAndReturn(\"Hello\").unsafeRunSync() \u306f\n// \"Hello\" \u3092\u30b3\u30f3\u30bd\u30fc\u30eb\u306b\u51fa\u529b\u3057\u3001\"Hello\" \u3092\u8fd4\u3059\n</code></pre> \u89e3\u7b54 <pre><code>def printAndReturn(message: String): IO[String] = {\n  IO.delay {\n    println(message)\n    message\n  }\n}\n\n// \u307e\u305f\u306f\ndef printAndReturn(message: String): IO[String] = {\n  for {\n    _ &lt;- IO.delay(println(message))\n  } yield message\n}\n</code></pre>"},{"location":"scala/part-4/#2-io","title":"\u554f\u984c 2: IO \u306e\u5408\u6210","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u30022\u3064\u306e IO \u3092\u9806\u756a\u306b\u5b9f\u884c\u3057\u3001\u7d50\u679c\u3092\u7d50\u5408\u3057\u307e\u3059\u3002</p> <pre><code>def combineIO[A, B, C](io1: IO[A], io2: IO[B])(f: (A, B) =&gt; C): IO[C] = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nval result = combineIO(IO.pure(1), IO.pure(2))(_ + _)\nresult.unsafeRunSync()  // 3\n</code></pre> \u89e3\u7b54 <pre><code>def combineIO[A, B, C](io1: IO[A], io2: IO[B])(f: (A, B) =&gt; C): IO[C] = {\n  for {\n    a &lt;- io1\n    b &lt;- io2\n  } yield f(a, b)\n}\n</code></pre>"},{"location":"scala/part-4/#3","title":"\u554f\u984c 3: \u30ea\u30c8\u30e9\u30a4","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u6307\u5b9a\u56de\u6570\u30ea\u30c8\u30e9\u30a4\u3057\u3001\u5168\u90e8\u5931\u6557\u3057\u305f\u3089\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>def retryWithDefault[A](action: IO[A], maxRetries: Int, default: A): IO[A] = ???\n</code></pre> \u89e3\u7b54 <pre><code>def retryWithDefault[A](action: IO[A], maxRetries: Int, default: A): IO[A] = {\n  List.range(0, maxRetries)\n    .foldLeft(action)((program, _) =&gt; program.orElse(action))\n    .orElse(IO.pure(default))\n}\n</code></pre>"},{"location":"scala/part-4/#4","title":"\u554f\u984c 4: \u30b9\u30c8\u30ea\u30fc\u30e0\u64cd\u4f5c","text":"<p>\u4ee5\u4e0b\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u4f5c\u6210\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>import fs2.Stream\n\n// 1. 1\u304b\u308910\u307e\u3067\u306e\u5076\u6570\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\nval evens: Stream[Pure, Int] = ???\n\n// 2. \u7121\u9650\u306b\u4ea4\u4e92\u306b true/false \u3092\u8fd4\u3059\u30b9\u30c8\u30ea\u30fc\u30e0\nval alternating: Stream[Pure, Boolean] = ???\n\n// 3. \u6700\u521d\u306e5\u3064\u306e\u8981\u7d20\u306e\u5408\u8a08\u3092\u8a08\u7b97\nval sum: Int = Stream(1, 2, 3, 4, 5, 6, 7, 8, 9, 10).take(5).???\n</code></pre> \u89e3\u7b54 <pre><code>// 1. 1\u304b\u308910\u307e\u3067\u306e\u5076\u6570\nval evens: Stream[Pure, Int] = Stream.range(1, 11).filter(_ % 2 == 0)\n// \u307e\u305f\u306f\nval evens: Stream[Pure, Int] = Stream(2, 4, 6, 8, 10)\n\n// 2. \u7121\u9650\u306b\u4ea4\u4e92\u306b true/false\nval alternating: Stream[Pure, Boolean] = Stream(true, false).repeat\n\n// 3. \u6700\u521d\u306e5\u3064\u306e\u8981\u7d20\u306e\u5408\u8a08\nval sum: Int = Stream(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)\n  .take(5)\n  .toList\n  .sum  // 15\n</code></pre>"},{"location":"scala/part-4/#5","title":"\u554f\u984c 5: \u30c8\u30ec\u30f3\u30c9\u691c\u51fa","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u76f4\u8fd13\u3064\u306e\u5024\u304c\u5168\u3066\u540c\u3058\u304b\u3069\u3046\u304b\u3092\u5224\u5b9a\u3057\u307e\u3059\u3002</p> <pre><code>def isStable(values: List[Int]): Boolean = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert(isStable(List(5, 5, 5)) == true)\nassert(isStable(List(5, 5, 6)) == false)\nassert(isStable(List(5, 6, 5)) == false)\nassert(isStable(List(5)) == false)  // 3\u3064\u672a\u6e80\u306f false\n</code></pre> \u89e3\u7b54 <pre><code>def isStable(values: List[Int]): Boolean = {\n  values.size &gt;= 3 &amp;&amp;\n  values.zip(values.drop(1)).forall {\n    case (prev, curr) =&gt; prev == curr\n  }\n}\n\n// \u307e\u305f\u306f\ndef isStable(values: List[Int]): Boolean = {\n  values.size &gt;= 3 &amp;&amp; values.distinct.size == 1\n}\n</code></pre>"},{"location":"scala/part-5/","title":"Part V: \u4e26\u884c\u51e6\u7406","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u4e26\u884c\u51e6\u7406\u3092\u5b66\u3073\u307e\u3059\u3002Fiber \u306b\u3088\u308b\u8efd\u91cf\u30b9\u30ec\u30c3\u30c9\u3001Ref \u306b\u3088\u308b\u5b89\u5168\u306a\u5171\u6709\u72b6\u614b\u7ba1\u7406\u3001\u305d\u3057\u3066\u4e26\u884c\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u69cb\u7bc9\u65b9\u6cd5\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"scala/part-5/#10","title":"\u7b2c10\u7ae0: \u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406","text":""},{"location":"scala/part-5/#101","title":"10.1 \u4e26\u884c\u51e6\u7406\u306e\u8ab2\u984c","text":"<p>\u5f93\u6765\u306e\u4e26\u884c\u51e6\u7406\u306b\u306f\u591a\u304f\u306e\u8ab2\u984c\u304c\u3042\u308a\u307e\u3059:</p> <ul> <li>\u30c7\u30c3\u30c9\u30ed\u30c3\u30af</li> <li>\u7af6\u5408\u72b6\u614b\uff08Race Condition\uff09</li> <li>\u5171\u6709\u72b6\u614b\u306e\u7ba1\u7406\u306e\u8907\u96d1\u3055</li> <li>\u30b9\u30ec\u30c3\u30c9\u306e\u30aa\u30fc\u30d0\u30fc\u30d8\u30c3\u30c9</li> </ul> <p></p>"},{"location":"scala/part-5/#102","title":"10.2 \u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u306e\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u96c6\u8a08","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch10_CheckIns.scala</code></p> <p>\u90fd\u5e02\u3078\u306e\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u3092\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u3067\u96c6\u8a08\u3057\u3001\u30e9\u30f3\u30ad\u30f3\u30b0\u3092\u66f4\u65b0\u3059\u308b\u4f8b\u3092\u898b\u3066\u3044\u304d\u307e\u3059\u3002</p> <pre><code>case class City(name: String)\ncase class CityStats(city: City, checkIns: Int)\n\n// \u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\nval checkIns: Stream[IO, City] =\n  Stream(City(\"Sydney\"), City(\"Dublin\"), City(\"Cape Town\"), City(\"Lima\"), City(\"Singapore\"))\n    .repeatN(100_000)\n    .covary[IO]\n</code></pre>"},{"location":"scala/part-5/#3","title":"\u30c8\u30c3\u30d73\u90fd\u5e02\u306e\u8a08\u7b97\uff08\u7d14\u7c8b\u95a2\u6570\uff09","text":"<pre><code>def topCities(cityCheckIns: Map[City, Int]): List[CityStats] = {\n  cityCheckIns.toList\n    .map { case (city, checkIns) =&gt; CityStats(city, checkIns) }\n    .sortBy(_.checkIns)\n    .reverse\n    .take(3)\n}\n</code></pre>"},{"location":"scala/part-5/#103","title":"10.3 \u9010\u6b21\u51e6\u7406\u306e\u554f\u984c","text":"<p>\u6700\u521d\u306e\u5b9f\u88c5\u306f\u9010\u6b21\u51e6\u7406\u3067\u3001\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u306b\u554f\u984c\u304c\u3042\u308a\u307e\u3059\u3002</p> <pre><code>def processCheckIns(checkIns: Stream[IO, City]): IO[Unit] = {\n  checkIns\n    .scan(Map.empty[City, Int])((cityCheckIns, city) =&gt;\n      cityCheckIns.updatedWith(city)(_.map(_ + 1).orElse(Some(1)))\n    )\n    .map(topCities)\n    .foreach(IO.println)\n    .compile\n    .drain\n}\n</code></pre> <p></p>"},{"location":"scala/part-5/#104-ref-","title":"10.4 Ref - \u30a2\u30c8\u30df\u30c3\u30af\u306a\u5171\u6709\u72b6\u614b","text":"<p>Ref \u306f\u3001\u8907\u6570\u306e\u4e26\u884c\u51e6\u7406\u304b\u3089\u5b89\u5168\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u30a2\u30c8\u30df\u30c3\u30af\u306a\u53c2\u7167\u3067\u3059\u3002</p> <pre><code>import cats.effect.Ref\n\n// Ref \u306e\u4f5c\u6210\u3068\u4f7f\u7528\nval example: IO[Int] = for {\n  counter &lt;- Ref.of[IO, Int](0)    // \u521d\u671f\u5024 0 \u306e Ref \u3092\u4f5c\u6210\n  _       &lt;- counter.update(_ + 3)  // \u30a2\u30c8\u30df\u30c3\u30af\u306b\u66f4\u65b0\n  result  &lt;- counter.get            // \u73fe\u5728\u306e\u5024\u3092\u53d6\u5f97\n} yield result\n\nexample.unsafeRunSync()  // 3\n</code></pre> <p></p>"},{"location":"scala/part-5/#ref","title":"Ref \u306e\u4e3b\u8981\u30e1\u30bd\u30c3\u30c9","text":"\u30e1\u30bd\u30c3\u30c9 \u8aac\u660e \u4f8b <code>Ref.of[IO, A](initial)</code> \u521d\u671f\u5024\u3067 Ref \u3092\u4f5c\u6210 <code>Ref.of[IO, Int](0)</code> <code>ref.get</code> \u73fe\u5728\u306e\u5024\u3092\u53d6\u5f97 <code>counter.get</code> <code>ref.set(value)</code> \u5024\u3092\u8a2d\u5b9a <code>counter.set(10)</code> <code>ref.update(f)</code> \u30a2\u30c8\u30df\u30c3\u30af\u306b\u66f4\u65b0 <code>counter.update(_ + 1)</code> <code>ref.modify(f)</code> \u66f4\u65b0\u3057\u3066\u53e4\u3044\u5024\u3092\u8fd4\u3059 <code>counter.modify(n =&gt; (n + 1, n))</code>"},{"location":"scala/part-5/#105-parsequence-","title":"10.5 parSequence - \u4e26\u5217\u5b9f\u884c","text":"<p><code>sequence</code> \u306f IO \u3092\u9806\u756a\u306b\u5b9f\u884c\u3057\u307e\u3059\u304c\u3001<code>parSequence</code> \u306f\u4e26\u5217\u306b\u5b9f\u884c\u3057\u307e\u3059\u3002</p> <pre><code>import cats.implicits._\n\n// \u9806\u6b21\u5b9f\u884c\nval sequential: IO[List[Int]] =\n  List(IO.pure(1), IO.pure(2), IO.pure(3)).sequence\n\n// \u4e26\u5217\u5b9f\u884c\nval parallel: IO[List[Int]] =\n  List(IO.pure(1), IO.pure(2), IO.pure(3)).parSequence\n</code></pre> <p></p>"},{"location":"scala/part-5/#_1","title":"\u30b9\u30ea\u30fc\u30d7\u3092\u4f7f\u3063\u305f\u6bd4\u8f03","text":"<pre><code>import scala.concurrent.duration._\n\nval program1 = IO.sleep(1.second).flatMap(_ =&gt; IO.pure(1))\nval program2 = IO.sleep(1.second).flatMap(_ =&gt; IO.pure(2))\nval program3 = IO.sleep(1.second).flatMap(_ =&gt; IO.pure(3))\n\n// \u9806\u6b21\u5b9f\u884c: \u7d043\u79d2\nList(program1, program2, program3).sequence\n\n// \u4e26\u5217\u5b9f\u884c: \u7d041\u79d2\nList(program1, program2, program3).parSequence\n</code></pre>"},{"location":"scala/part-5/#106","title":"10.6 \u30b5\u30a4\u30b3\u30ed\u3092\u4e26\u884c\u3057\u3066\u632f\u308b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch10_CastingDieConcurrently.scala</code></p> <pre><code>def castTheDie(): IO[Int] = IO.delay(castTheDieImpure())\n\n// 2\u3064\u306e\u30b5\u30a4\u30b3\u30ed\u3092\u4e26\u884c\u3057\u3066\u632f\u308a\u3001\u5408\u8a08\u3092\u8fd4\u3059\nval program: IO[Int] = for {\n  _      &lt;- IO.sleep(1.second)\n  result &lt;- List(castTheDie(), castTheDie()).parSequence\n} yield result.sum\n</code></pre>"},{"location":"scala/part-5/#ref-parsequence","title":"Ref \u3068 parSequence \u306e\u7d44\u307f\u5408\u308f\u305b","text":"<pre><code>// 3\u3064\u306e\u30b5\u30a4\u30b3\u30ed\u3092\u4e26\u884c\u3057\u3066\u632f\u308a\u3001\u7d50\u679c\u3092 Ref \u306b\u4fdd\u5b58\nval program: IO[List[Int]] = for {\n  storedCasts &lt;- Ref.of[IO, List[Int]](List.empty)\n  singleCast   = castTheDie().flatMap(result =&gt;\n                   storedCasts.update(_.appended(result)))\n  _           &lt;- List.fill(3)(singleCast).parSequence\n  casts       &lt;- storedCasts.get\n} yield casts\n</code></pre>"},{"location":"scala/part-5/#107","title":"10.7 \u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u51e6\u7406\u306e\u4e26\u884c\u7248","text":"<p>\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u306e\u4fdd\u5b58\u3068\u30e9\u30f3\u30ad\u30f3\u30b0\u306e\u66f4\u65b0\u3092\u4e26\u884c\u3057\u3066\u5b9f\u884c\u3057\u307e\u3059\u3002</p>"},{"location":"scala/part-5/#_2","title":"\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u306e\u4fdd\u5b58","text":"<pre><code>def storeCheckIn(storedCheckIns: Ref[IO, Map[City, Int]])(city: City): IO[Unit] = {\n  storedCheckIns.update(_.updatedWith(city) {\n    case None           =&gt; Some(1)\n    case Some(checkIns) =&gt; Some(checkIns + 1)\n  })\n}\n</code></pre>"},{"location":"scala/part-5/#_3","title":"\u30e9\u30f3\u30ad\u30f3\u30b0\u306e\u7d99\u7d9a\u7684\u306a\u66f4\u65b0","text":"<pre><code>def updateRanking(\n    storedCheckIns: Ref[IO, Map[City, Int]],\n    storedRanking: Ref[IO, List[CityStats]]\n): IO[Nothing] = {\n  storedCheckIns.get\n    .map(topCities)\n    .flatMap(storedRanking.set)\n    .foreverM  // \u6c38\u9060\u306b\u7e70\u308a\u8fd4\u3059\n}\n</code></pre>"},{"location":"scala/part-5/#_4","title":"\u5b8c\u5168\u306a\u4e26\u884c\u51e6\u7406\u7248","text":"<pre><code>def processCheckIns(checkIns: Stream[IO, City]): IO[Unit] = {\n  for {\n    storedCheckIns &lt;- Ref.of[IO, Map[City, Int]](Map.empty)\n    storedRanking  &lt;- Ref.of[IO, List[CityStats]](List.empty)\n\n    // \u30e9\u30f3\u30ad\u30f3\u30b0\u66f4\u65b0\u30d7\u30ed\u30b0\u30e9\u30e0\uff08\u6c38\u9060\u306b\u5b9f\u884c\uff09\n    rankingProgram  = updateRanking(storedCheckIns, storedRanking)\n\n    // \u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u51e6\u7406\u30d7\u30ed\u30b0\u30e9\u30e0\n    checkInsProgram = checkIns.evalMap(storeCheckIn(storedCheckIns)).compile.drain\n\n    // \u51fa\u529b\u30d7\u30ed\u30b0\u30e9\u30e0\uff081\u79d2\u3054\u3068\u306b\u30e9\u30f3\u30ad\u30f3\u30b0\u3092\u51fa\u529b\uff09\n    outputProgram   = IO.sleep(1.second)\n                        .flatMap(_ =&gt; storedRanking.get)\n                        .flatMap(IO.println)\n                        .foreverM\n\n    // 3\u3064\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u4e26\u884c\u5b9f\u884c\n    _ &lt;- List(rankingProgram, checkInsProgram, outputProgram).parSequence\n  } yield ()\n}\n</code></pre>"},{"location":"scala/part-5/#108-fiber-","title":"10.8 Fiber - \u8efd\u91cf\u30b9\u30ec\u30c3\u30c9","text":"<p>Fiber \u306f\u3001OS \u30b9\u30ec\u30c3\u30c9\u3088\u308a\u3082\u306f\u308b\u304b\u306b\u8efd\u91cf\u306a\u5b9f\u884c\u5358\u4f4d\u3067\u3059\u3002</p> <p></p>"},{"location":"scala/part-5/#fiber","title":"Fiber \u306e\u8d77\u52d5\u3068\u30ad\u30e3\u30f3\u30bb\u30eb","text":"<pre><code>val program: IO[Unit] = for {\n  // Fiber \u3092\u8d77\u52d5\uff08\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u5b9f\u884c\uff09\n  fiber &lt;- IO.sleep(300.millis)\n             .flatMap(_ =&gt; IO.println(\"hello\"))\n             .foreverM\n             .start\n\n  // 1\u79d2\u5f85\u6a5f\n  _ &lt;- IO.sleep(1.second)\n\n  // Fiber \u3092\u30ad\u30e3\u30f3\u30bb\u30eb\n  _ &lt;- fiber.cancel\n\n  // \u3055\u3089\u306b1\u79d2\u5f85\u6a5f\uff08hello \u306f\u51fa\u529b\u3055\u308c\u306a\u3044\uff09\n  _ &lt;- IO.sleep(1.second)\n} yield ()\n</code></pre>"},{"location":"scala/part-5/#109","title":"10.9 \u547c\u3073\u51fa\u3057\u5143\u306b\u5236\u5fa1\u3092\u8fd4\u3059","text":"<p>Fiber \u3092\u4f7f\u3063\u3066\u3001\u547c\u3073\u51fa\u3057\u5143\u306b\u5236\u5fa1\u3092\u8fd4\u3057\u3064\u3064\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u51e6\u7406\u3092\u7d9a\u3051\u308b\u8a2d\u8a08\u304c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>case class ProcessingCheckIns(\n  currentRanking: IO[List[CityStats]],  // \u73fe\u5728\u306e\u30e9\u30f3\u30ad\u30f3\u30b0\u3092\u53d6\u5f97\n  stop: IO[Unit]                         // \u51e6\u7406\u3092\u505c\u6b62\n)\n\ndef processCheckIns(checkIns: Stream[IO, City]): IO[ProcessingCheckIns] = {\n  for {\n    storedCheckIns &lt;- Ref.of[IO, Map[City, Int]](Map.empty)\n    storedRanking  &lt;- Ref.of[IO, List[CityStats]](List.empty)\n\n    rankingProgram  = updateRanking(storedCheckIns, storedRanking)\n    checkInsProgram = checkIns.evalMap(storeCheckIn(storedCheckIns)).compile.drain\n\n    // Fiber \u3068\u3057\u3066\u8d77\u52d5\u3057\u3001\u3059\u3050\u306b\u623b\u308b\n    fiber &lt;- List(rankingProgram, checkInsProgram).parSequence.start\n  } yield ProcessingCheckIns(storedRanking.get, fiber.cancel)\n}\n</code></pre> <p></p>"},{"location":"scala/part-5/#_5","title":"\u4f7f\u7528\u4f8b","text":"<pre><code>val program: IO[List[CityStats]] = for {\n  processing &lt;- processCheckIns(checkIns)\n\n  // \u6700\u521d\u306e\u30e9\u30f3\u30ad\u30f3\u30b0\u3092\u53d6\u5f97\n  ranking    &lt;- processing.currentRanking\n  _          &lt;- IO.println(ranking)\n\n  // 1\u79d2\u5f85\u6a5f\n  _          &lt;- IO.sleep(1.second)\n\n  // \u66f4\u65b0\u3055\u308c\u305f\u30e9\u30f3\u30ad\u30f3\u30b0\u3092\u53d6\u5f97\n  newRanking &lt;- processing.currentRanking\n\n  // \u51e6\u7406\u3092\u505c\u6b62\n  _          &lt;- processing.stop\n} yield newRanking\n</code></pre>"},{"location":"scala/part-5/#1010-iosleep-vs-threadsleep","title":"10.10 IO.sleep vs Thread.sleep","text":"<p><code>IO.sleep</code> \u3068 <code>Thread.sleep</code> \u306f\u7570\u306a\u308b\u52d5\u4f5c\u3092\u3057\u307e\u3059\u3002</p> \u7279\u6027 IO.sleep Thread.sleep \u30d6\u30ed\u30c3\u30af\u5bfe\u8c61 Fiber OS Thread \u30ea\u30bd\u30fc\u30b9 \u8efd\u91cf \u91cd\u3044 \u4e26\u884c\u6027 \u4ed6\u306e Fiber \u304c\u5b9f\u884c\u53ef\u80fd \u30b9\u30ec\u30c3\u30c9\u304c\u30d6\u30ed\u30c3\u30af <pre><code>// Thread.sleep: \u30b9\u30ec\u30c3\u30c9\u3092\u30d6\u30ed\u30c3\u30af\nval threadSleep = IO.delay(Thread.sleep(1000))\n\n// IO.sleep: Fiber \u3092\u30b9\u30ea\u30fc\u30d7\uff08\u30b9\u30ec\u30c3\u30c9\u306f\u89e3\u653e\uff09\nval fiberSleep = IO.sleep(1.second)\n\n// \u30b7\u30f3\u30b0\u30eb\u30b9\u30ec\u30c3\u30c9\u30673\u3064\u306e IO.sleep \u3092\u4e26\u884c\u5b9f\u884c \u2192 \u7d041\u79d2\nList.fill(3)(fiberSleep).parSequence\n\n// \u30b7\u30f3\u30b0\u30eb\u30b9\u30ec\u30c3\u30c9\u30673\u3064\u306e Thread.sleep \u3092\u4e26\u884c\u5b9f\u884c \u2192 \u7d043\u79d2\nList.fill(3)(threadSleep).parSequence\n</code></pre>"},{"location":"scala/part-5/#_6","title":"\u307e\u3068\u3081","text":""},{"location":"scala/part-5/#part-v_1","title":"Part V \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"scala/part-5/#_7","title":"\u4e3b\u8981\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8","text":"\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8 \u7528\u9014 <code>Ref[IO, A]</code> \u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u5171\u6709\u72b6\u614b <code>parSequence</code> IO \u306e\u30ea\u30b9\u30c8\u3092\u4e26\u5217\u5b9f\u884c <code>Fiber</code> \u8efd\u91cf\u306a\u5b9f\u884c\u5358\u4f4d <code>fiber.start</code> Fiber \u3092\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u8d77\u52d5 <code>fiber.cancel</code> Fiber \u3092\u30ad\u30e3\u30f3\u30bb\u30eb <code>foreverM</code> \u6c38\u9060\u306b\u7e70\u308a\u8fd4\u3057\u5b9f\u884c"},{"location":"scala/part-5/#_8","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>Ref: \u8907\u6570\u306e\u4e26\u884c\u51e6\u7406\u304b\u3089\u5b89\u5168\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u30a2\u30c8\u30df\u30c3\u30af\u306a\u53c2\u7167</li> <li>parSequence: IO \u306e\u30ea\u30b9\u30c8\u3092\u4e26\u5217\u5b9f\u884c\u3057\u3066\u7d50\u679c\u3092\u96c6\u7d04</li> <li>Fiber: OS \u30b9\u30ec\u30c3\u30c9\u3088\u308a\u8efd\u91cf\u3067\u3001\u6570\u767e\u4e07\u306e\u4e26\u884c\u51e6\u7406\u304c\u53ef\u80fd</li> <li>start: Fiber \u3092\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u8d77\u52d5\u3057\u3001\u3059\u3050\u306b\u5236\u5fa1\u3092\u8fd4\u3059</li> <li>IO.sleep: Fiber \u3092\u30b9\u30ea\u30fc\u30d7\u3055\u305b\u3001\u30b9\u30ec\u30c3\u30c9\u306f\u89e3\u653e\u3059\u308b</li> </ol>"},{"location":"scala/part-5/#_9","title":"\u8a2d\u8a08\u30d1\u30bf\u30fc\u30f3","text":""},{"location":"scala/part-5/#_10","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part VI \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li>\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9</li> <li>\u5916\u90e8 API \u3068\u306e\u9023\u643a</li> <li>\u30c6\u30b9\u30c8\u6226\u7565</li> </ul>"},{"location":"scala/part-5/#_11","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"scala/part-5/#1-ref","title":"\u554f\u984c 1: Ref \u306e\u57fa\u672c","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u30ab\u30a6\u30f3\u30bf\u30fc\u3092 0 \u304b\u3089\u59cb\u3081\u3066\u30013\u56de\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\u3057\u305f\u7d50\u679c\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>def incrementThreeTimes(): IO[Int] = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nincrementThreeTimes().unsafeRunSync()  // 3\n</code></pre> \u89e3\u7b54 <pre><code>def incrementThreeTimes(): IO[Int] = {\n  for {\n    counter &lt;- Ref.of[IO, Int](0)\n    _       &lt;- counter.update(_ + 1)\n    _       &lt;- counter.update(_ + 1)\n    _       &lt;- counter.update(_ + 1)\n    result  &lt;- counter.get\n  } yield result\n}\n</code></pre>"},{"location":"scala/part-5/#2","title":"\u554f\u984c 2: \u4e26\u5217\u5b9f\u884c","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u30023\u3064\u306e IO \u3092\u4e26\u5217\u5b9f\u884c\u3057\u3001\u7d50\u679c\u306e\u5408\u8a08\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>def sumParallel(io1: IO[Int], io2: IO[Int], io3: IO[Int]): IO[Int] = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nsumParallel(IO.pure(1), IO.pure(2), IO.pure(3)).unsafeRunSync()  // 6\n</code></pre> \u89e3\u7b54 <pre><code>import cats.implicits._\n\ndef sumParallel(io1: IO[Int], io2: IO[Int], io3: IO[Int]): IO[Int] = {\n  List(io1, io2, io3).parSequence.map(_.sum)\n}\n</code></pre>"},{"location":"scala/part-5/#3_1","title":"\u554f\u984c 3: \u4e26\u884c\u30ab\u30a6\u30f3\u30c8","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002100\u500b\u306e IO \u3092\u4e26\u884c\u5b9f\u884c\u3057\u3001\u305d\u306e\u3046\u3061\u5076\u6570\u3092\u8fd4\u3057\u305f\u56de\u6570\u3092\u30ab\u30a6\u30f3\u30c8\u3057\u307e\u3059\u3002</p> <pre><code>def countEvens(ios: List[IO[Int]]): IO[Int] = ???\n\n// \u4f7f\u7528\u4f8b\nval ios = List.fill(100)(IO.delay(scala.util.Random.nextInt(10)))\ncountEvens(ios).unsafeRunSync()  // \u7d0450\uff08\u30e9\u30f3\u30c0\u30e0\uff09\n</code></pre> \u89e3\u7b54 <pre><code>def countEvens(ios: List[IO[Int]]): IO[Int] = {\n  for {\n    counter &lt;- Ref.of[IO, Int](0)\n    _       &lt;- ios.map(io =&gt;\n                 io.flatMap(n =&gt;\n                   if (n % 2 == 0) counter.update(_ + 1)\n                   else IO.unit\n                 )\n               ).parSequence\n    result  &lt;- counter.get\n  } yield result\n}\n</code></pre>"},{"location":"scala/part-5/#4","title":"\u554f\u984c 4: \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u4ed8\u304d\u5b9f\u884c","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u6307\u5b9a\u6642\u9593\u5f8c\u306b Fiber \u3092\u30ad\u30e3\u30f3\u30bb\u30eb\u3057\u3001\u305d\u308c\u307e\u3067\u306b\u84c4\u7a4d\u3055\u308c\u305f\u7d50\u679c\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>def collectFor(duration: FiniteDuration): IO[List[Int]] = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\n// 1\u79d2\u9593\u3001100ms\u3054\u3068\u306b\u4e71\u6570\u3092\u751f\u6210\u3057\u3066\u30ea\u30b9\u30c8\u306b\u8ffd\u52a0\n// \u7d0410\u500b\u306e\u8981\u7d20\u304c\u8fd4\u3055\u308c\u308b\ncollectFor(1.second).unsafeRunSync()\n</code></pre> \u89e3\u7b54 <pre><code>import scala.concurrent.duration._\n\ndef collectFor(duration: FiniteDuration): IO[List[Int]] = {\n  for {\n    collected &lt;- Ref.of[IO, List[Int]](List.empty)\n\n    // 100ms\u3054\u3068\u306b\u4e71\u6570\u3092\u8ffd\u52a0\u3059\u308b\u30d7\u30ed\u30b0\u30e9\u30e0\n    producer = (IO.sleep(100.millis) *&gt;\n                IO.delay(scala.util.Random.nextInt(100))\n                  .flatMap(n =&gt; collected.update(_.appended(n))))\n                .foreverM\n\n    // Fiber \u3068\u3057\u3066\u8d77\u52d5\n    fiber &lt;- producer.start\n\n    // \u6307\u5b9a\u6642\u9593\u5f85\u6a5f\n    _ &lt;- IO.sleep(duration)\n\n    // \u30ad\u30e3\u30f3\u30bb\u30eb\n    _ &lt;- fiber.cancel\n\n    // \u7d50\u679c\u3092\u53d6\u5f97\n    result &lt;- collected.get\n  } yield result\n}\n</code></pre>"},{"location":"scala/part-5/#5","title":"\u554f\u984c 5: \u4e26\u884c\u30de\u30c3\u30d7\u66f4\u65b0","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u8907\u6570\u306e\u66f4\u65b0\u3092\u4e26\u884c\u3057\u3066 Map \u306b\u9069\u7528\u3057\u3001\u6700\u7d42\u7684\u306a Map \u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>case class Update(key: String, value: Int)\n\ndef applyUpdates(updates: List[Update]): IO[Map[String, Int]] = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nval updates = List(\n  Update(\"a\", 1),\n  Update(\"b\", 2),\n  Update(\"a\", 3),  // \"a\" \u3092\u4e0a\u66f8\u304d\n  Update(\"c\", 4)\n)\napplyUpdates(updates).unsafeRunSync()  // Map(\"a\" -&gt; 3, \"b\" -&gt; 2, \"c\" -&gt; 4)\n</code></pre> \u89e3\u7b54 <pre><code>case class Update(key: String, value: Int)\n\ndef applyUpdates(updates: List[Update]): IO[Map[String, Int]] = {\n  for {\n    mapRef &lt;- Ref.of[IO, Map[String, Int]](Map.empty)\n    _      &lt;- updates.map(update =&gt;\n                mapRef.update(_.updated(update.key, update.value))\n              ).parSequence\n    result &lt;- mapRef.get\n  } yield result\n}\n</code></pre>  \u6ce8\u610f: \u4e26\u884c\u5b9f\u884c\u306a\u306e\u3067\u3001\u540c\u3058\u30ad\u30fc\u3078\u306e\u8907\u6570\u306e\u66f4\u65b0\u304c\u3042\u308b\u5834\u5408\u3001\u6700\u7d42\u7684\u306a\u5024\u306f\u5b9f\u884c\u9806\u5e8f\u306b\u4f9d\u5b58\u3057\u307e\u3059\u3002"},{"location":"scala/part-6/","title":"Part VI: \u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u3068\u30c6\u30b9\u30c8","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u3053\u308c\u307e\u3067\u5b66\u3093\u3060\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u6982\u5ff5\u3092\u7d71\u5408\u3057\u3001\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002\u307e\u305f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u30c6\u30b9\u30c8\u6226\u7565\u306b\u3064\u3044\u3066\u3082\u5b66\u3073\u307e\u3059\u3002</p>"},{"location":"scala/part-6/#11","title":"\u7b2c11\u7ae0: \u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9","text":""},{"location":"scala/part-6/#111-travelguide","title":"11.1 TravelGuide \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3","text":"<p>\u65c5\u884c\u30ac\u30a4\u30c9\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f8b\u306b\u3001\u5b9f\u8df5\u7684\u306a FP \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u69cb\u7bc9\u65b9\u6cd5\u3092\u5b66\u3073\u307e\u3059\u3002</p> <p></p>"},{"location":"scala/part-6/#112","title":"11.2 \u30c9\u30e1\u30a4\u30f3\u30e2\u30c7\u30eb\u306e\u5b9a\u7fa9","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch11_TravelGuide.scala</code></p> <pre><code>// \u4f4d\u7f6e\u60c5\u5831\u3092\u8868\u3059\u5024\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\nopaque type LocationId = String\nobject LocationId {\n  def apply(value: String): LocationId = value\n  extension (a: LocationId) def value: String = a\n}\n\n// \u30ed\u30b1\u30fc\u30b7\u30e7\u30f3\ncase class Location(id: LocationId, name: String, population: Int)\n\n// \u30a2\u30c8\u30e9\u30af\u30b7\u30e7\u30f3\uff08\u89b3\u5149\u5730\uff09\ncase class Attraction(\n    name: String,\n    description: Option[String],\n    location: Location\n)\n\n// \u65c5\u884c\u30ac\u30a4\u30c9\ncase class TravelGuide(attraction: Attraction, subjects: List[String])\n</code></pre>"},{"location":"scala/part-6/#113","title":"11.3 \u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\u5c64\u306e\u62bd\u8c61\u5316","text":"<p>\u5916\u90e8\u30c7\u30fc\u30bf\u30bd\u30fc\u30b9\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u30c8\u30ec\u30a4\u30c8\u3067\u62bd\u8c61\u5316\u3057\u307e\u3059\u3002</p> <pre><code>trait DataAccess {\n  def findAttractions(\n      name: String,\n      ordering: AttractionOrdering,\n      limit: Int\n  ): IO[List[Attraction]]\n\n  def findArtistsFromLocation(\n      locationId: LocationId,\n      limit: Int\n  ): IO[List[MusicArtist]]\n\n  def findMoviesAboutLocation(\n      locationId: LocationId,\n      limit: Int\n  ): IO[List[Movie]]\n}\n</code></pre> <p></p>"},{"location":"scala/part-6/#114-resource","title":"11.4 Resource \u306b\u3088\u308b\u30ea\u30bd\u30fc\u30b9\u7ba1\u7406","text":"<p>cats-effect \u306e <code>Resource</code> \u3092\u4f7f\u7528\u3057\u3066\u3001\u5b89\u5168\u306a\u30ea\u30bd\u30fc\u30b9\u7ba1\u7406\u3092\u5b9f\u73fe\u3057\u307e\u3059\u3002</p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch11_TravelGuide.scala</code></p> <pre><code>def execQuery(\n    query: String\n): Resource[IO, List[QuerySolution]] = {\n  val connection: Resource[IO, RDFConnection] =\n    Resource.make(\n      IO.blocking(\n        RDFConnectionRemote\n          .create()\n          .destination(WikidataSparqlEndpoint)\n          .build()\n      )\n    )(connection =&gt; IO.blocking(connection.close()))\n\n  for {\n    conn   &lt;- connection\n    result &lt;- Resource.eval(IO.blocking {\n      val resultSet = conn.query(query).execSelect()\n      resultSet.asScala.toList\n    })\n  } yield result\n}\n</code></pre> <p></p>"},{"location":"scala/part-6/#115","title":"11.5 \u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u5b9f\u88c5","text":"<p><code>Ref</code> \u3092\u4f7f\u7528\u3057\u305f\u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u5b9f\u88c5:</p> <pre><code>def cachedAttractions(\n    dataAccess: DataAccess\n): IO[DataAccess] = {\n  for {\n    cache &lt;- Ref.of[IO, Map[String, List[Attraction]]](Map.empty)\n  } yield new DataAccess {\n    def findAttractions(\n        name: String,\n        ordering: AttractionOrdering,\n        limit: Int\n    ): IO[List[Attraction]] = {\n      val key = s\"$name-$ordering-$limit\"\n      for {\n        cached &lt;- cache.get.map(_.get(key))\n        result &lt;- cached match {\n          case Some(attractions) =&gt; IO.pure(attractions)\n          case None =&gt;\n            for {\n              attractions &lt;- dataAccess.findAttractions(name, ordering, limit)\n              _           &lt;- cache.update(_ + (key -&gt; attractions))\n            } yield attractions\n        }\n      } yield result\n    }\n\n    // \u4ed6\u306e\u30e1\u30bd\u30c3\u30c9\u3082\u540c\u69d8\u306b\u5b9f\u88c5...\n  }\n}\n</code></pre> <p></p>"},{"location":"scala/part-6/#116","title":"11.6 \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u7d44\u307f\u7acb\u3066","text":"<p>\u3059\u3079\u3066\u306e\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002</p> <pre><code>def travelGuide(data: DataAccess, attractionName: String): IO[Option[TravelGuide]] = {\n  for {\n    attractions &lt;- data.findAttractions(attractionName, ByLocationPopulation, 1)\n    guide &lt;- attractions.headOption match {\n      case None =&gt; IO.pure(None)\n      case Some(attraction) =&gt;\n        for {\n          artists &lt;- data.findArtistsFromLocation(attraction.location.id, 2)\n          movies  &lt;- data.findMoviesAboutLocation(attraction.location.id, 2)\n        } yield Some(\n          TravelGuide(\n            attraction,\n            artists.map(_.name) ++ movies.map(_.name)\n          )\n        )\n    }\n  } yield guide\n}\n</code></pre> <p></p>"},{"location":"scala/part-6/#12","title":"\u7b2c12\u7ae0: \u30c6\u30b9\u30c8\u6226\u7565","text":""},{"location":"scala/part-6/#121","title":"12.1 \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u30c6\u30b9\u30c8","text":"<p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u3067\u306f\u3001\u7d14\u7c8b\u95a2\u6570\u306e\u304a\u304b\u3052\u3067\u30c6\u30b9\u30c8\u304c\u975e\u5e38\u306b\u7c21\u5358\u306b\u306a\u308a\u307e\u3059\u3002</p> <p></p>"},{"location":"scala/part-6/#122-searchreport","title":"12.2 SearchReport \u306e\u5c0e\u5165","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch12_TravelGuide.scala</code></p> <p>\u30c6\u30b9\u30c8\u53ef\u80fd\u6027\u3092\u9ad8\u3081\u308b\u305f\u3081\u3001<code>SearchReport</code> \u3092\u5c0e\u5165\u3057\u307e\u3059\u3002</p> <pre><code>case class SearchReport(\n    attractionsSearched: Int,\n    errors: List[String]\n)\n\ncase class TravelGuide(\n    attraction: Attraction,\n    subjects: List[String],\n    searchReport: SearchReport\n)\n</code></pre> <p></p>"},{"location":"scala/part-6/#123","title":"12.3 \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u306e\u6539\u5584","text":"<pre><code>def findArtistsFromLocation(\n    locationId: LocationId,\n    limit: Int\n): IO[Either[String, List[MusicArtist]]]\n\ndef findMoviesAboutLocation(\n    locationId: LocationId,\n    limit: Int\n): IO[Either[String, List[Movie]]]\n</code></pre> <p>Either \u3092\u4f7f\u7528\u3057\u3066\u30a8\u30e9\u30fc\u3092\u660e\u793a\u7684\u306b\u6271\u3044\u307e\u3059:</p> <pre><code>def travelGuide(\n    data: DataAccess,\n    attractionName: String\n): IO[Option[TravelGuide]] = {\n  for {\n    attractions &lt;- data.findAttractions(attractionName, ByLocationPopulation, 3)\n    guides &lt;- attractions.traverse { attraction =&gt;\n      for {\n        artistsResult &lt;- data.findArtistsFromLocation(attraction.location.id, 2)\n        moviesResult  &lt;- data.findMoviesAboutLocation(attraction.location.id, 2)\n      } yield {\n        val errors = List(artistsResult, moviesResult).collect {\n          case Left(error) =&gt; error\n        }\n        val artists = artistsResult.getOrElse(Nil)\n        val movies = moviesResult.getOrElse(Nil)\n        TravelGuide(\n          attraction,\n          artists.map(_.name) ++ movies.map(_.name),\n          SearchReport(attractions.size, errors)\n        )\n      }\n    }\n  } yield guides.headOption\n}\n</code></pre>"},{"location":"scala/part-6/#124","title":"12.4 \u30b9\u30bf\u30d6\u3092\u4f7f\u7528\u3057\u305f\u30c6\u30b9\u30c8","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch12_TravelGuideTest.scala</code></p> <pre><code>// \u30c6\u30b9\u30c8\u7528\u306e\u30b9\u30bf\u30d6\u5b9f\u88c5\nval testDataAccess: DataAccess = new DataAccess {\n  def findAttractions(\n      name: String,\n      ordering: AttractionOrdering,\n      limit: Int\n  ): IO[List[Attraction]] = IO.pure(\n    List(\n      Attraction(\n        \"Test Attraction\",\n        Some(\"A test attraction\"),\n        Location(LocationId(\"Q123\"), \"Test City\", 100000)\n      )\n    )\n  )\n\n  def findArtistsFromLocation(\n      locationId: LocationId,\n      limit: Int\n  ): IO[Either[String, List[MusicArtist]]] =\n    IO.pure(Right(List(MusicArtist(\"Test Artist\"))))\n\n  def findMoviesAboutLocation(\n      locationId: LocationId,\n      limit: Int\n  ): IO[Either[String, List[Movie]]] =\n    IO.pure(Right(List(Movie(\"Test Movie\"))))\n}\n</code></pre> <p></p>"},{"location":"scala/part-6/#125","title":"12.5 \u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8","text":"<p>ScalaCheck \u3092\u4f7f\u7528\u3057\u305f\u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8:</p> <pre><code>import org.scalacheck.Gen\nimport org.scalacheck.Prop.forAll\n\n// \u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306e\u5b9a\u7fa9\nval locationIdGen: Gen[LocationId] =\n  Gen.alphaNumStr.map(LocationId.apply)\n\nval locationGen: Gen[Location] = for {\n  id         &lt;- locationIdGen\n  name       &lt;- Gen.alphaStr\n  population &lt;- Gen.posNum[Int]\n} yield Location(id, name, population)\n\nval attractionGen: Gen[Attraction] = for {\n  name        &lt;- Gen.alphaStr\n  description &lt;- Gen.option(Gen.alphaStr)\n  location    &lt;- locationGen\n} yield Attraction(name, description, location)\n</code></pre> <p></p>"},{"location":"scala/part-6/#126","title":"12.6 \u4e0d\u5909\u6761\u4ef6\u306e\u30c6\u30b9\u30c8","text":"<pre><code>// \u30d7\u30ed\u30d1\u30c6\u30a3: \u30a2\u30c8\u30e9\u30af\u30b7\u30e7\u30f3\u306e\u6570\u306f limit \u4ee5\u4e0b\nproperty(\"findAttractions returns at most limit attractions\") =\n  forAll(Gen.alphaStr, Gen.posNum[Int]) { (name: String, limit: Int) =&gt;\n    val result = dataAccess\n      .findAttractions(name, ByLocationPopulation, limit)\n      .unsafeRunSync()\n    result.size &lt;= limit\n  }\n\n// \u30d7\u30ed\u30d1\u30c6\u30a3: SearchReport \u306e\u30a8\u30e9\u30fc\u6570\u306f\u691c\u7d22\u6570\u4ee5\u4e0b\nproperty(\"SearchReport errors are bounded by searches\") =\n  forAll(attractionGen) { attraction =&gt;\n    val guide = travelGuide(testDataAccess, attraction.name).unsafeRunSync()\n    guide.forall { g =&gt;\n      g.searchReport.errors.size &lt;= 2 // artists + movies\n    }\n  }\n</code></pre>"},{"location":"scala/part-6/#127","title":"12.7 \u7d71\u5408\u30c6\u30b9\u30c8","text":"<pre><code>// \u7d71\u5408\u30c6\u30b9\u30c8: \u30a8\u30f3\u30c9\u30c4\u30fc\u30a8\u30f3\u30c9\u306e\u30b7\u30ca\u30ea\u30aa\ntest(\"travelGuide returns guide for valid attraction\") {\n  val result = travelGuide(testDataAccess, \"Test\").unsafeRunSync()\n\n  assert(result.isDefined)\n  result.foreach { guide =&gt;\n    assert(guide.attraction.name == \"Test Attraction\")\n    assert(guide.subjects.nonEmpty)\n    assert(guide.searchReport.errors.isEmpty)\n  }\n}\n\n// \u30a8\u30e9\u30fc\u30b1\u30fc\u30b9\u306e\u30c6\u30b9\u30c8\ntest(\"travelGuide handles errors gracefully\") {\n  val failingDataAccess = new DataAccess {\n    def findAttractions(name: String, ordering: AttractionOrdering, limit: Int) =\n      IO.pure(List(testAttraction))\n\n    def findArtistsFromLocation(locationId: LocationId, limit: Int) =\n      IO.pure(Left(\"Network error\"))\n\n    def findMoviesAboutLocation(locationId: LocationId, limit: Int) =\n      IO.pure(Left(\"Timeout\"))\n  }\n\n  val result = travelGuide(failingDataAccess, \"Test\").unsafeRunSync()\n\n  assert(result.isDefined)\n  result.foreach { guide =&gt;\n    assert(guide.searchReport.errors.size == 2)\n  }\n}\n</code></pre>"},{"location":"scala/part-6/#128","title":"12.8 \u30c6\u30b9\u30c8\u30d4\u30e9\u30df\u30c3\u30c9","text":""},{"location":"scala/part-6/#_1","title":"\u307e\u3068\u3081","text":""},{"location":"scala/part-6/#part-vi_1","title":"Part VI \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"scala/part-6/#_2","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>\u62bd\u8c61\u5316\u306e\u91cd\u8981\u6027: DataAccess \u30c8\u30ec\u30a4\u30c8\u3067\u5916\u90e8\u4f9d\u5b58\u3092\u62bd\u8c61\u5316</li> <li>Resource \u3067\u30ea\u30bd\u30fc\u30b9\u7ba1\u7406: \u5b89\u5168\u306a\u30ea\u30bd\u30fc\u30b9\u306e\u53d6\u5f97\u3068\u89e3\u653e</li> <li>Ref \u3067\u30ad\u30e3\u30c3\u30b7\u30e5: \u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u72b6\u614b\u7ba1\u7406</li> <li>Either \u3067\u30a8\u30e9\u30fc\u51e6\u7406: \u660e\u793a\u7684\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0</li> <li>SearchReport: \u30c6\u30b9\u30c8\u53ef\u80fd\u6027\u3068\u53ef\u89b3\u6e2c\u6027\u306e\u5411\u4e0a</li> <li>\u30b9\u30bf\u30d6: \u5916\u90e8\u4f9d\u5b58\u3092\u5dee\u3057\u66ff\u3048\u3066\u30c6\u30b9\u30c8</li> <li>\u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8: \u30e9\u30f3\u30c0\u30e0\u5165\u529b\u3067\u4e0d\u5909\u6761\u4ef6\u3092\u691c\u8a3c</li> </ol>"},{"location":"scala/part-6/#_3","title":"\u5b66\u7fd2\u306e\u7dcf\u62ec","text":""},{"location":"scala/part-6/#_4","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"scala/part-6/#1-dataaccess","title":"\u554f\u984c 1: DataAccess \u306e\u62e1\u5f35","text":"<p>\u4ee5\u4e0b\u306e\u8981\u4ef6\u3067 <code>DataAccess</code> \u3092\u62e1\u5f35\u3057\u3066\u304f\u3060\u3055\u3044: - \u65b0\u3057\u3044\u30e1\u30bd\u30c3\u30c9 <code>findHotelsNearLocation</code> \u3092\u8ffd\u52a0 - \u623b\u308a\u5024\u306f <code>IO[Either[String, List[Hotel]]]</code></p> \u89e3\u7b54 <pre><code>case class Hotel(name: String, rating: Double, location: Location)\n\ntrait DataAccess {\n  // \u65e2\u5b58\u306e\u30e1\u30bd\u30c3\u30c9...\n\n  def findHotelsNearLocation(\n      locationId: LocationId,\n      limit: Int\n  ): IO[Either[String, List[Hotel]]]\n}\n\n// \u30c6\u30b9\u30c8\u7528\u30b9\u30bf\u30d6\nval testDataAccess: DataAccess = new DataAccess {\n  // \u65e2\u5b58\u306e\u5b9f\u88c5...\n\n  def findHotelsNearLocation(\n      locationId: LocationId,\n      limit: Int\n  ): IO[Either[String, List[Hotel]]] =\n    IO.pure(Right(List(\n      Hotel(\"Test Hotel\", 4.5, testLocation)\n    )))\n}\n</code></pre>"},{"location":"scala/part-6/#2","title":"\u554f\u984c 2: \u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u306b\u5bfe\u3059\u308b\u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8\u3092\u66f8\u3044\u3066\u304f\u3060\u3055\u3044:</p> <pre><code>def filterPopularLocations(\n    locations: List[Location],\n    minPopulation: Int\n): List[Location] =\n  locations.filter(_.population &gt;= minPopulation)\n</code></pre> \u89e3\u7b54 <pre><code>import org.scalacheck.Gen\nimport org.scalacheck.Prop.forAll\n\nval locationGen: Gen[Location] = for {\n  id         &lt;- Gen.alphaNumStr.map(LocationId.apply)\n  name       &lt;- Gen.alphaStr\n  population &lt;- Gen.chooseNum(0, 10000000)\n} yield Location(id, name, population)\n\nval locationsGen: Gen[List[Location]] =\n  Gen.listOf(locationGen)\n\n// \u30d7\u30ed\u30d1\u30c6\u30a31: \u7d50\u679c\u306f\u5165\u529b\u4ee5\u4e0b\u306e\u8981\u7d20\u6570\nproperty(\"result size &lt;= input size\") =\n  forAll(locationsGen, Gen.posNum[Int]) {\n    (locations: List[Location], minPop: Int) =&gt;\n      filterPopularLocations(locations, minPop).size &lt;= locations.size\n  }\n\n// \u30d7\u30ed\u30d1\u30c6\u30a32: \u7d50\u679c\u306e\u3059\u3079\u3066\u306e\u8981\u7d20\u306f\u6761\u4ef6\u3092\u6e80\u305f\u3059\nproperty(\"all results meet minimum population\") =\n  forAll(locationsGen, Gen.posNum[Int]) {\n    (locations: List[Location], minPop: Int) =&gt;\n      filterPopularLocations(locations, minPop)\n        .forall(_.population &gt;= minPop)\n  }\n\n// \u30d7\u30ed\u30d1\u30c6\u30a33: \u6761\u4ef6\u3092\u6e80\u305f\u3059\u8981\u7d20\u306f\u3059\u3079\u3066\u7d50\u679c\u306b\u542b\u307e\u308c\u308b\nproperty(\"all qualifying locations are in result\") =\n  forAll(locationsGen, Gen.posNum[Int]) {\n    (locations: List[Location], minPop: Int) =&gt;\n      val result = filterPopularLocations(locations, minPop)\n      locations.filter(_.population &gt;= minPop).forall(result.contains)\n  }\n</code></pre>"},{"location":"scala/part-6/#3-resource","title":"\u554f\u984c 3: Resource \u306e\u5b9f\u88c5","text":"<p>\u30d5\u30a1\u30a4\u30eb\u3092\u5b89\u5168\u306b\u8aad\u307f\u53d6\u308b <code>Resource</code> \u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> \u89e3\u7b54 <pre><code>import cats.effect.{IO, Resource}\nimport java.io.{BufferedReader, FileReader}\n\ndef fileResource(path: String): Resource[IO, BufferedReader] =\n  Resource.make(\n    IO.blocking(new BufferedReader(new FileReader(path)))\n  )(reader =&gt; IO.blocking(reader.close()))\n\ndef readLines(path: String): IO[List[String]] = {\n  fileResource(path).use { reader =&gt;\n    IO.blocking {\n      Iterator\n        .continually(reader.readLine())\n        .takeWhile(_ != null)\n        .toList\n    }\n  }\n}\n\n// \u4f7f\u7528\u4f8b\nval program: IO[Unit] = for {\n  lines &lt;- readLines(\"data.txt\")\n  _     &lt;- IO.println(s\"Read ${lines.size} lines\")\n} yield ()\n</code></pre>"},{"location":"scala/part-6/#_5","title":"\u30b7\u30ea\u30fc\u30ba\u5168\u4f53\u306e\u7dcf\u62ec","text":"<p>\u672c\u30b7\u30ea\u30fc\u30ba\u3067\u306f\u3001\u300cGrokking Functional Programming\u300d\u306e\u5185\u5bb9\u306b\u6cbf\u3063\u3066\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u790e\u304b\u3089\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u307e\u3067\u3092\u5b66\u3073\u307e\u3057\u305f\u3002</p>"},{"location":"scala/part-6/#_6","title":"\u5b66\u3093\u3060\u4e3b\u306a\u6982\u5ff5","text":"Part \u7ae0 \u4e3b\u306a\u6982\u5ff5 I 1-2 \u7d14\u7c8b\u95a2\u6570\u3001\u53c2\u7167\u900f\u904e\u6027 II 3-5 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u3001\u9ad8\u968e\u95a2\u6570\u3001flatMap III 6-7 Option\u3001Either\u3001ADT IV 8-9 IO \u30e2\u30ca\u30c9\u3001Stream V 10 \u4e26\u884c\u51e6\u7406\u3001Ref\u3001Fiber VI 11-12 \u5b9f\u8df5\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3001\u30c6\u30b9\u30c8"},{"location":"scala/part-6/#_7","title":"\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u5229\u70b9","text":"<ol> <li>\u4e88\u6e2c\u53ef\u80fd\u6027: \u7d14\u7c8b\u95a2\u6570\u306f\u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b</li> <li>\u30c6\u30b9\u30c8\u5bb9\u6613\u6027: \u526f\u4f5c\u7528\u304c\u306a\u3044\u305f\u3081\u30c6\u30b9\u30c8\u304c\u7c21\u5358</li> <li>\u5408\u6210\u53ef\u80fd\u6027: \u5c0f\u3055\u306a\u95a2\u6570\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u8907\u96d1\u306a\u51e6\u7406\u3092\u69cb\u7bc9</li> <li>\u4e26\u884c\u5b89\u5168\u6027: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u306f\u7af6\u5408\u72b6\u614b\u3092\u9632\u3050</li> <li>\u578b\u5b89\u5168\u6027: Option\u3001Either \u3067 null \u3084\u4f8b\u5916\u3092\u578b\u3067\u8868\u73fe</li> </ol>"},{"location":"scala/part-6/#_8","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<ul> <li>Cats Effect \u306e\u3088\u308a\u9ad8\u5ea6\u306a\u6a5f\u80fd\u3092\u5b66\u3076</li> <li>fs2 \u306e\u5b9f\u8df5\u7684\u306a\u4f7f\u7528\u65b9\u6cd5\u3092\u6df1\u3081\u308b</li> <li>ZIO \u306a\u3069\u4ed6\u306e FP \u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u63a2\u7d22</li> <li>\u5b9f\u969b\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067 FP \u3092\u9069\u7528\u3059\u308b</li> </ul>"}]}