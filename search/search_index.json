{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Grokking Functional Programming","text":"<p>\u300cGrokking Functional Programming\u300d\uff08Michal Plachta \u8457\uff09\u306e\u5b66\u7fd2\u7528\u30ea\u30dd\u30b8\u30c8\u30ea\u3067\u3059\u3002 Scala\u3001Java\u3001F#\u3001C#\u3001Haskell\u3001Clojure\u3001Elixir\u3001Rust \u306e8\u8a00\u8a9e\u3067\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u5b9f\u88c5\u4f8b\u3068\u65e5\u672c\u8a9e\u89e3\u8aac\u3092\u63d0\u4f9b\u3057\u307e\u3059\u3002</p>"},{"location":"#_1","title":"\u8a00\u8a9e\u5225\u89e3\u8aac","text":""},{"location":"#scala","title":"Scala \u7248","text":"<p>Scala 3 \u3068 cats-effect/fs2 \u3092\u4f7f\u3063\u305f\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u5b9f\u88c5\u4f8b\u3067\u3059\u3002</p> <ul> <li>Scala \u89e3\u8aac</li> </ul>"},{"location":"#java","title":"Java \u7248","text":"<p>Java 21 \u3068 Vavr \u3092\u4f7f\u3063\u305f\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u5b9f\u88c5\u4f8b\u3067\u3059\u3002</p> <ul> <li>Java \u89e3\u8aac</li> </ul>"},{"location":"#f","title":"F# \u7248","text":"<p>F# 8 \u3068 .NET \u3092\u4f7f\u3063\u305f\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u5b9f\u88c5\u4f8b\u3067\u3059\u3002</p> <ul> <li>F# \u89e3\u8aac</li> </ul>"},{"location":"#c","title":"C# \u7248","text":"<p>C# 12 \u3068 LanguageExt \u3092\u4f7f\u3063\u305f\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u5b9f\u88c5\u4f8b\u3067\u3059\u3002</p> <ul> <li>C# \u89e3\u8aac</li> </ul>"},{"location":"#haskell","title":"Haskell \u7248","text":"<p>Haskell\uff08GHC 9.x\uff09\u3092\u4f7f\u3063\u305f\u7d14\u7c8b\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u5b9f\u88c5\u4f8b\u3067\u3059\u3002</p> <ul> <li>Haskell \u89e3\u8aac</li> </ul>"},{"location":"#clojure","title":"Clojure \u7248","text":"<p>Clojure 1.11 \u3068 core.async \u3092\u4f7f\u3063\u305f\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u5b9f\u88c5\u4f8b\u3067\u3059\u3002</p> <ul> <li>Clojure \u89e3\u8aac</li> </ul>"},{"location":"#elixir","title":"Elixir \u7248","text":"<p>Elixir 1.15 \u3068 OTP \u3092\u4f7f\u3063\u305f\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u5b9f\u88c5\u4f8b\u3067\u3059\u3002</p> <ul> <li>Elixir \u89e3\u8aac</li> </ul>"},{"location":"#rust","title":"Rust \u7248","text":"<p>Rust \u3068 tokio \u3092\u4f7f\u3063\u305f\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u5b9f\u88c5\u4f8b\u3067\u3059\u3002</p> <ul> <li>Rust \u89e3\u8aac</li> </ul>"},{"location":"#_2","title":"\u7ae0\u69cb\u6210","text":"Part \u5185\u5bb9 Scala Java F# C# Haskell Clojure Elixir Rust I \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u790e part-1 part-1 part-1 part-1 part-1 part-1 part-1 part-1 II \u95a2\u6570\u578b\u30b9\u30bf\u30a4\u30eb\u306e\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0 part-2 part-2 part-2 part-2 part-2 part-2 part-2 part-2 III \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0 part-3 part-3 part-3 part-3 part-3 part-3 part-3 part-3 IV IO \u3068\u526f\u4f5c\u7528\u306e\u7ba1\u7406 part-4 part-4 part-4 part-4 part-4 part-4 part-4 part-4 V \u4e26\u884c\u51e6\u7406 part-5 part-5 part-5 part-5 part-5 part-5 part-5 part-5 VI \u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3 part-6 part-6 part-6 part-6 part-6 part-6 part-6 part-6"},{"location":"#_3","title":"\u4e3b\u8981\u30c8\u30d4\u30c3\u30af","text":"Part \u4e3b\u8981\u30c8\u30d4\u30c3\u30af Scala Java F# C# Haskell Clojure Elixir Rust I \u7d14\u7c8b\u95a2\u6570\u3001\u53c2\u7167\u900f\u904e\u6027 \u95a2\u6570\u578b\u57fa\u790e \u95a2\u6570\u578b\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9 let \u30d0\u30a4\u30f3\u30c7\u30a3\u30f3\u30b0 \u5f0f\u5f62\u5f0f\u30e1\u30bd\u30c3\u30c9 \u7d14\u7c8b\u95a2\u6570\u3001\u9045\u5ef6\u8a55\u4fa1 defn, let def, fn fn, \u6240\u6709\u6a29 II \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u3001\u9ad8\u968e\u95a2\u6570\u3001flatMap List, Option Vavr List, Option List, \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3 Seq, LINQ \u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18, fold map/filter/reduce Enum, \u30d1\u30a4\u30d7 Iterator, \u30af\u30ed\u30fc\u30b8\u30e3 III Option\u3001Either\u3001ADT sealed trait sealed interface \u5224\u5225\u5171\u7528\u4f53 Option, Either Maybe, Either, ADT nil, some-&gt;/some-&gt;&gt; {:ok}/{:error} Option, Result IV IO \u30e2\u30ca\u30c9\u3001Stream cats-effect, fs2 \u72ec\u81ea IO, Vavr Stream Async, Seq Task, IAsyncEnumerable IO \u30e2\u30ca\u30c9, conduit lazy-seq Agent, Stream async/await, Stream V Ref\u3001Fiber\u3001\u4e26\u5217\u51e6\u7406 cats-effect Ref/Fiber \u72ec\u81ea Ref, Virtual Thread Ref, MailboxProcessor Ref, Task\u4e26\u5217 STM, TVar, async atom/ref, core.async Task, GenServer Arc, Mutex, tokio VI Resource\u3001\u30c6\u30b9\u30c8 ScalaCheck JUnit 5 \u30d7\u30ed\u30d1\u30c6\u30a3\u30c6\u30b9\u30c8 use, FsCheck Resource, Validator bracket, QuickCheck with-open, test.check ExUnit, StreamData \u30c8\u30ec\u30a4\u30c8, proptest"},{"location":"#_4","title":"\u53c2\u7167","text":"<ul> <li>Grokking Functional Programming - \u539f\u8457</li> <li>Scala \u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8</li> <li>cats-effect</li> <li>fs2</li> <li>Vavr</li> <li>F# \u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8</li> <li>F# for Fun and Profit</li> <li>LanguageExt</li> <li>Haskell \u516c\u5f0f\u30b5\u30a4\u30c8</li> <li>Learn You a Haskell</li> <li>Clojure \u516c\u5f0f\u30b5\u30a4\u30c8</li> <li>ClojureDocs</li> <li>Elixir \u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8</li> <li>Elixir School</li> <li>Rust \u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8</li> <li>tokio</li> </ul>"},{"location":"clojure/","title":"Grokking Functional Programming \u65e5\u672c\u8a9e\u89e3\u8aac\uff08Clojure \u7248\uff09","text":"<p>\u672c\u30b7\u30ea\u30fc\u30ba\u306f\u300cGrokking Functional Programming\u300d\uff08Micha\u0142 P\u0142achta \u8457\uff09\u306e\u5b66\u7fd2\u30b3\u30f3\u30d1\u30cb\u30aa\u30f3\u3068\u3057\u3066\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u6982\u5ff5\u3092 Clojure \u3067\u5b9f\u88c5\u3057\u306a\u304c\u3089\u65e5\u672c\u8a9e\u3067\u89e3\u8aac\u3057\u307e\u3059\u3002</p>"},{"location":"clojure/#_1","title":"\u5bfe\u8c61\u8aad\u8005","text":"<ul> <li>Java \u3084 JVM \u306e\u7d4c\u9a13\u304c\u3042\u308a\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u8208\u5473\u304c\u3042\u308b\u958b\u767a\u8005</li> <li>Clojure \u3092\u5b66\u3073\u305f\u3044\u304c\u3001FP \u306e\u6982\u5ff5\u304b\u3089\u7406\u89e3\u3057\u305f\u3044\u65b9</li> <li>\u5b9f\u8df5\u7684\u306a FP \u306e\u9069\u7528\u65b9\u6cd5\u3092\u77e5\u308a\u305f\u3044 JVM \u30a8\u30f3\u30b8\u30cb\u30a2</li> <li>Lisp \u7cfb\u8a00\u8a9e\u306b\u8208\u5473\u304c\u3042\u308b\u958b\u767a\u8005</li> </ul>"},{"location":"clojure/#_2","title":"\u8a18\u4e8b\u4e00\u89a7","text":""},{"location":"clojure/#part-i","title":"Part I: \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u790e","text":"<p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u672c\u6982\u5ff5\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c1\u7ae0 \u547d\u4ee4\u578b vs \u95a2\u6570\u578b\u3001Clojure \u57fa\u672c\u69cb\u6587 \u7b2c2\u7ae0 \u7d14\u7c8b\u95a2\u6570\u3001\u526f\u4f5c\u7528\u306e\u6392\u9664\u3001\u30c6\u30b9\u30c8\u306e\u5bb9\u6613\u3055 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: \u7d14\u7c8b\u95a2\u6570\u3001\u53c2\u7167\u900f\u904e\u6027\u3001\u526f\u4f5c\u7528\u3001S\u5f0f\u3001def/defn</p>"},{"location":"clojure/#part-ii","title":"Part II: \u95a2\u6570\u578b\u30b9\u30bf\u30a4\u30eb\u306e\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0","text":"<p>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c\u3068\u9ad8\u968e\u95a2\u6570\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c3\u7ae0 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u3001\u6c38\u7d9a\u30c7\u30fc\u30bf\u69cb\u9020 \u7b2c4\u7ae0 \u9ad8\u968e\u95a2\u6570\u3001map/filter/reduce \u7b2c5\u7ae0 \u30b9\u30ec\u30c3\u30c7\u30a3\u30f3\u30b0\u30de\u30af\u30ed\u3001\u30b7\u30fc\u30b1\u30f3\u30b9\u62bd\u8c61\u5316 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u3001\u6c38\u7d9a\u30c7\u30fc\u30bf\u69cb\u9020\u3001\u9ad8\u968e\u95a2\u6570\u3001\u30b9\u30ec\u30c3\u30c7\u30a3\u30f3\u30b0\u30de\u30af\u30ed\uff08-&gt;\u3001-&gt;&gt;\uff09</p>"},{"location":"clojure/#part-iii-nil","title":"Part III: \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3068 nil \u5b89\u5168\u6027","text":"<p>\u578b\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c6\u7ae0 nil \u51e6\u7406\u3001some/when\u3001fnil \u7b2c7\u7ae0 \u6761\u4ef6\u5206\u5c90\u3001\u30de\u30eb\u30c1\u30e1\u30bd\u30c3\u30c9\u3001\u30d7\u30ed\u30c8\u30b3\u30eb <p>\u30ad\u30fc\u30ef\u30fc\u30c9: nil\u3001some-&gt;\u3001\u6761\u4ef6\u5206\u5c90\u3001\u30de\u30eb\u30c1\u30e1\u30bd\u30c3\u30c9\u3001\u30d7\u30ed\u30c8\u30b3\u30eb</p>"},{"location":"clojure/#part-iv","title":"Part IV: \u526f\u4f5c\u7528\u306e\u7ba1\u7406\u3068\u30b7\u30fc\u30b1\u30f3\u30b9\u51e6\u7406","text":"<p>\u526f\u4f5c\u7528\u306e\u7ba1\u7406\u3068\u30b7\u30fc\u30b1\u30f3\u30b9\u51e6\u7406\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c8\u7ae0 \u526f\u4f5c\u7528\u306e\u5206\u96e2\u3001do\u3001with-open \u7b2c9\u7ae0 \u9045\u5ef6\u30b7\u30fc\u30b1\u30f3\u30b9\u3001\u7121\u9650\u30b7\u30fc\u30b1\u30f3\u30b9\u3001\u30c8\u30e9\u30f3\u30b9\u30c7\u30e5\u30fc\u30b5\u30fc <p>\u30ad\u30fc\u30ef\u30fc\u30c9: \u526f\u4f5c\u7528\u3001\u9045\u5ef6\u30b7\u30fc\u30b1\u30f3\u30b9\u3001\u30c8\u30e9\u30f3\u30b9\u30c7\u30e5\u30fc\u30b5\u30fc</p>"},{"location":"clojure/#part-v","title":"Part V: \u4e26\u884c\u51e6\u7406","text":"<p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u4e26\u884c\u51e6\u7406\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c10\u7ae0 atom\u3001ref\u3001agent\u3001STM \u7b2c11\u7ae0 future\u3001promise\u3001core.async <p>\u30ad\u30fc\u30ef\u30fc\u30c9: \u4e26\u884c\u51e6\u7406\u3001atom\u3001ref\u3001STM\u3001core.async</p>"},{"location":"clojure/#part-vi","title":"Part VI: \u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u3068\u30c6\u30b9\u30c8","text":"<p>\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u3068\u30c6\u30b9\u30c8\u6226\u7565\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c12\u7ae0 TravelGuide \u30a2\u30d7\u30ea\u3001\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3001spec \u7b2c13\u7ae0 \u30c6\u30b9\u30c8\u6226\u7565\u3001test.check \u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: \u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3001spec\u3001test.check\u3001REPL \u99c6\u52d5\u958b\u767a</p>"},{"location":"clojure/#_3","title":"\u5b66\u7fd2\u30d1\u30b9","text":""},{"location":"clojure/#_4","title":"\u4f7f\u7528\u30e9\u30a4\u30d6\u30e9\u30ea","text":"\u30e9\u30a4\u30d6\u30e9\u30ea \u7528\u9014 \u5bfe\u5fdc\u7ae0 Clojure 1.11+ \u8a00\u8a9e \u5168\u7ae0 clojure.spec \u30c7\u30fc\u30bf\u4ed5\u69d8 Part III, VI core.async \u975e\u540c\u671f\u51e6\u7406 Part V test.check \u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8 Part VI"},{"location":"clojure/#_5","title":"\u30ea\u30dd\u30b8\u30c8\u30ea\u69cb\u6210","text":"<pre><code>grokkingfp-examples/\n\u251c\u2500\u2500 app/clojure/src/           # Clojure \u306e\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n\u2502   \u251c\u2500\u2500 ch01/                  # \u7b2c1\u7ae0: \u30a4\u30f3\u30c8\u30ed\u30c0\u30af\u30b7\u30e7\u30f3\n\u2502   \u251c\u2500\u2500 ch02/                  # \u7b2c2\u7ae0: \u7d14\u7c8b\u95a2\u6570\n\u2502   \u251c\u2500\u2500 ch03/                  # \u7b2c3\u7ae0: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\n\u2502   \u251c\u2500\u2500 ch04/                  # \u7b2c4\u7ae0: \u9ad8\u968e\u95a2\u6570\n\u2502   \u251c\u2500\u2500 ch05/                  # \u7b2c5\u7ae0: \u30b7\u30fc\u30b1\u30f3\u30b9\u51e6\u7406\n\u2502   \u251c\u2500\u2500 ch06/                  # \u7b2c6\u7ae0: nil \u51e6\u7406\n\u2502   \u251c\u2500\u2500 ch07/                  # \u7b2c7\u7ae0: \u6761\u4ef6\u5206\u5c90\n\u2502   \u251c\u2500\u2500 ch08/                  # \u7b2c8\u7ae0: \u526f\u4f5c\u7528\n\u2502   \u251c\u2500\u2500 ch09/                  # \u7b2c9\u7ae0: \u9045\u5ef6\u30b7\u30fc\u30b1\u30f3\u30b9\n\u2502   \u251c\u2500\u2500 ch10/                  # \u7b2c10\u7ae0: \u72b6\u614b\u7ba1\u7406\n\u2502   \u251c\u2500\u2500 ch11/                  # \u7b2c11\u7ae0: \u4e26\u884c\u51e6\u7406\n\u2502   \u2514\u2500\u2500 ch12/                  # \u7b2c12\u7ae0: \u30c6\u30b9\u30c8\n\u251c\u2500\u2500 app/clojure/test/          # \u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\n\u2514\u2500\u2500 docs/article/clojure/      # \u89e3\u8aac\u8a18\u4e8b\uff08\u672c\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\uff09\n    \u251c\u2500\u2500 index.md               # \u3053\u306e\u8a18\u4e8b\n    \u251c\u2500\u2500 part-1.md              # Part I\n    \u251c\u2500\u2500 part-2.md              # Part II\n    \u251c\u2500\u2500 part-3.md              # Part III\n    \u251c\u2500\u2500 part-4.md              # Part IV\n    \u251c\u2500\u2500 part-5.md              # Part V\n    \u2514\u2500\u2500 part-6.md              # Part VI\n</code></pre>"},{"location":"clojure/#clojure","title":"Clojure \u306e\u7279\u5fb4","text":"<p>Clojure \u306f JVM \u4e0a\u3067\u52d5\u4f5c\u3059\u308b Lisp \u65b9\u8a00\u3067\u3042\u308a\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u3092\u5f37\u529b\u306b\u30b5\u30dd\u30fc\u30c8\u3057\u307e\u3059:</p>"},{"location":"clojure/#_6","title":"\u8a00\u8a9e\u306e\u7279\u5fb4","text":"\u7279\u5fb4 \u8aac\u660e Lisp \u65b9\u8a00 S\u5f0f\u306b\u3088\u308b\u30db\u30e2\u30a4\u30b3\u30cb\u30b7\u30c6\u30a3\uff08\u30b3\u30fc\u30c9\u304c\u30c7\u30fc\u30bf\uff09 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb \u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u69cb\u9020 \u6c38\u7d9a\u30c7\u30fc\u30bf\u69cb\u9020 \u52b9\u7387\u7684\u306a\u69cb\u9020\u5171\u6709\u306b\u3088\u308b\u4e0d\u5909\u30b3\u30ec\u30af\u30b7\u30e7\u30f3 \u9045\u5ef6\u8a55\u4fa1 \u30b7\u30fc\u30b1\u30f3\u30b9\u306e\u9045\u5ef6\u8a55\u4fa1 REPL \u99c6\u52d5 \u30a4\u30f3\u30bf\u30e9\u30af\u30c6\u30a3\u30d6\u306a\u958b\u767a\u30b9\u30bf\u30a4\u30eb JVM \u4e92\u63db Java \u30e9\u30a4\u30d6\u30e9\u30ea\u3068\u306e\u5b8c\u5168\u306a\u76f8\u4e92\u904b\u7528 STM Software Transactional Memory \u306b\u3088\u308b\u4e26\u884c\u51e6\u7406"},{"location":"clojure/#scala","title":"Scala \u3068\u306e\u6bd4\u8f03","text":"\u6982\u5ff5 Scala Clojure \u8a00\u8a9e\u30d1\u30e9\u30c0\u30a4\u30e0 \u30de\u30eb\u30c1\u30d1\u30e9\u30c0\u30a4\u30e0\uff08\u9759\u7684\u578b\u4ed8\u3051\uff09 \u95a2\u6570\u578b\uff08\u52d5\u7684\u578b\u4ed8\u3051\uff09 \u5b9f\u884c\u74b0\u5883 JVM JVM Option \u578b <code>Option[A]</code> <code>nil</code> + <code>some-&gt;</code> Either/Result <code>Either[E, A]</code> \u4f8b\u5916 \u307e\u305f\u306f \u30de\u30c3\u30d7 ADT <code>sealed trait</code> + <code>case class</code> \u30de\u30c3\u30d7 + \u30de\u30eb\u30c1\u30e1\u30bd\u30c3\u30c9 for \u5185\u5305\u8868\u8a18 <code>for { ... } yield</code> <code>for</code> \u30de\u30af\u30ed \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3 \u30e1\u30bd\u30c3\u30c9\u30c1\u30a7\u30fc\u30f3 <code>-&gt;</code> <code>-&gt;&gt;</code> \u30de\u30af\u30ed \u975e\u540c\u671f <code>IO[A]</code> (cats-effect) <code>future</code> / <code>core.async</code> \u30b9\u30c8\u30ea\u30fc\u30e0 <code>fs2.Stream</code> \u9045\u5ef6\u30b7\u30fc\u30b1\u30f3\u30b9 / \u30c8\u30e9\u30f3\u30b9\u30c7\u30e5\u30fc\u30b5\u30fc \u53ef\u5909\u72b6\u614b <code>Ref[IO, A]</code> <code>atom</code> / <code>ref</code>"},{"location":"clojure/#haskell","title":"Haskell \u3068\u306e\u6bd4\u8f03","text":"\u6982\u5ff5 Haskell Clojure \u578b\u30b7\u30b9\u30c6\u30e0 \u9759\u7684\u30fb\u5f37\u3044\u578b\u4ed8\u3051 \u52d5\u7684\u578b\u4ed8\u3051 \u7d14\u7c8b\u6027 \u578b\u3067\u4fdd\u8a3c \u6163\u7fd2\u3067\u5206\u96e2 \u30e2\u30ca\u30c9 \u578b\u30af\u30e9\u30b9 \u306a\u3057\uff08\u30de\u30af\u30ed\u3067\u4ee3\u66ff\uff09 \u9045\u5ef6\u8a55\u4fa1 \u30c7\u30d5\u30a9\u30eb\u30c8 \u30b7\u30fc\u30b1\u30f3\u30b9\u306e\u307f \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1 \u8a00\u8a9e\u6a5f\u80fd <code>core.match</code> \u30e9\u30a4\u30d6\u30e9\u30ea STM <code>TVar</code> <code>ref</code> + <code>dosync</code>"},{"location":"clojure/#_7","title":"\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u5229\u70b9","text":"<p>\u672c\u30b7\u30ea\u30fc\u30ba\u3092\u901a\u3058\u3066\u3001\u4ee5\u4e0b\u306e\u5229\u70b9\u3092\u5b9f\u611f\u3067\u304d\u307e\u3059:</p> <ol> <li>\u4e88\u6e2c\u53ef\u80fd\u6027 - \u7d14\u7c8b\u95a2\u6570\u306f\u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b</li> <li>\u30c6\u30b9\u30c8\u5bb9\u6613\u6027 - \u526f\u4f5c\u7528\u304c\u306a\u3044\u305f\u3081\u30c6\u30b9\u30c8\u304c\u7c21\u5358</li> <li>\u5408\u6210\u53ef\u80fd\u6027 - \u5c0f\u3055\u306a\u95a2\u6570\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u8907\u96d1\u306a\u51e6\u7406\u3092\u69cb\u7bc9</li> <li>\u4e26\u884c\u5b89\u5168\u6027 - \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u306f\u7af6\u5408\u72b6\u614b\u3092\u9632\u3050</li> <li>REPL \u99c6\u52d5\u958b\u767a - \u30a4\u30f3\u30bf\u30e9\u30af\u30c6\u30a3\u30d6\u306a\u958b\u767a\u3067\u7d20\u65e9\u3044\u30d5\u30a3\u30fc\u30c9\u30d0\u30c3\u30af</li> </ol>"},{"location":"clojure/#clojure_1","title":"Clojure \u306e\u57fa\u672c\u69cb\u6587","text":""},{"location":"clojure/#ss-expression","title":"S\u5f0f\uff08S-expression\uff09","text":"<pre><code>; \u95a2\u6570\u547c\u3073\u51fa\u3057: (\u95a2\u6570 \u5f15\u65701 \u5f15\u65702 ...)\n(+ 1 2 3)        ; =&gt; 6\n(str \"Hello\" \" \" \"World\")  ; =&gt; \"Hello World\"\n\n; \u95a2\u6570\u5b9a\u7fa9\n(defn greet [name]\n  (str \"Hello, \" name \"!\"))\n\n(greet \"Clojure\")  ; =&gt; \"Hello, Clojure!\"\n</code></pre>"},{"location":"clojure/#_8","title":"\u30c7\u30fc\u30bf\u69cb\u9020","text":"<pre><code>; \u30ea\u30b9\u30c8\uff08\u9023\u7d50\u30ea\u30b9\u30c8\uff09\n'(1 2 3)\n\n; \u30d9\u30af\u30bf\u30fc\uff08\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30a2\u30af\u30bb\u30b9\u53ef\u80fd\uff09\n[1 2 3]\n\n; \u30de\u30c3\u30d7\uff08\u30ad\u30fc\u30fb\u5024\u30da\u30a2\uff09\n{:name \"Alice\" :age 30}\n\n; \u30bb\u30c3\u30c8\uff08\u91cd\u8907\u306a\u3057\uff09\n#{1 2 3}\n</code></pre>"},{"location":"clojure/#_9","title":"\u30b9\u30ec\u30c3\u30c7\u30a3\u30f3\u30b0\u30de\u30af\u30ed","text":"<pre><code>; -&gt; (thread-first): \u6700\u521d\u306e\u5f15\u6570\u306b\u633f\u5165\n(-&gt; 5\n    (+ 3)      ; (+ 5 3)\n    (* 2))     ; (* 8 2) =&gt; 16\n\n; -&gt;&gt; (thread-last): \u6700\u5f8c\u306e\u5f15\u6570\u306b\u633f\u5165\n(-&gt;&gt; [1 2 3 4 5]\n     (filter odd?)    ; (filter odd? [1 2 3 4 5])\n     (map inc))       ; (map inc '(1 3 5)) =&gt; (2 4 6)\n</code></pre>"},{"location":"clojure/#_10","title":"\u53c2\u8003\u8cc7\u6599","text":"<ul> <li>Grokking Functional Programming - \u539f\u8457</li> <li>Clojure \u516c\u5f0f\u30b5\u30a4\u30c8</li> <li>ClojureDocs - \u95a2\u6570\u30ea\u30d5\u30a1\u30ec\u30f3\u30b9</li> <li>Clojure for the Brave and True - \u7121\u6599\u30aa\u30f3\u30e9\u30a4\u30f3\u66f8\u7c4d</li> <li>core.async \u30ac\u30a4\u30c9</li> <li>clojure.spec \u30ac\u30a4\u30c9</li> </ul>"},{"location":"clojure/part-1/","title":"Part I: \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u790e\uff08Clojure \u7248\uff09","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u672c\u6982\u5ff5\u3092 Clojure \u3067\u5b66\u3073\u307e\u3059\u3002</p>"},{"location":"clojure/part-1/#1-clojure","title":"\u7b2c1\u7ae0: Clojure \u30a4\u30f3\u30c8\u30ed\u30c0\u30af\u30b7\u30e7\u30f3","text":""},{"location":"clojure/part-1/#11-vs","title":"1.1 \u547d\u4ee4\u578b vs \u95a2\u6570\u578b","text":""},{"location":"clojure/part-1/#_1","title":"\u547d\u4ee4\u578b\u30b9\u30bf\u30a4\u30eb\uff08\u975e\u63a8\u5968\uff09","text":"<pre><code>;; \u53ef\u5909\u72b6\u614b\u3092\u4f7f\u7528\u3057\u305f\u547d\u4ee4\u578b\u30b9\u30bf\u30a4\u30eb\n(defn imperative-sum [numbers]\n  (let [result (atom 0)]\n    (doseq [n numbers]\n      (swap! result + n))\n    @result))\n\n(imperative-sum [1 2 3 4 5])  ; =&gt; 15\n</code></pre>"},{"location":"clojure/part-1/#_2","title":"\u95a2\u6570\u578b\u30b9\u30bf\u30a4\u30eb\uff08\u63a8\u5968\uff09","text":"<pre><code>;; \u95a2\u6570\u578b\u30b9\u30bf\u30a4\u30eb\uff1a\u5ba3\u8a00\u7684\u3067\u7c21\u6f54\n(defn functional-sum [numbers]\n  (reduce + 0 numbers))\n\n(functional-sum [1 2 3 4 5])  ; =&gt; 15\n</code></pre> <p>\u95a2\u6570\u578b\u30b9\u30bf\u30a4\u30eb\u306e\u5229\u70b9\uff1a</p> \u89b3\u70b9 \u547d\u4ee4\u578b \u95a2\u6570\u578b \u72b6\u614b\u7ba1\u7406 \u53ef\u5909\u72b6\u614b\u306e\u8ffd\u8de1\u304c\u5fc5\u8981 \u72b6\u614b\u306a\u3057 \u30c6\u30b9\u30c8 \u30bb\u30c3\u30c8\u30a2\u30c3\u30d7\u304c\u8907\u96d1 \u5165\u51fa\u529b\u306e\u307f\u78ba\u8a8d \u4e26\u884c\u51e6\u7406 \u7af6\u5408\u72b6\u614b\u306b\u6ce8\u610f \u5b89\u5168 \u30b3\u30fc\u30c9\u91cf \u591a\u3044 \u5c11\u306a\u3044"},{"location":"clojure/part-1/#12-ss-expression","title":"1.2 S\u5f0f\uff08S-expression\uff09","text":"<p>Clojure \u306f Lisp \u65b9\u8a00\u3067\u3042\u308a\u3001\u30b3\u30fc\u30c9\u306f S\u5f0f\u3067\u8868\u73fe\u3055\u308c\u307e\u3059\u3002</p> <pre><code>;; S\u5f0f\u306e\u57fa\u672c\u69cb\u6587: (\u95a2\u6570 \u5f15\u65701 \u5f15\u65702 ...)\n(+ 1 2 3)           ; =&gt; 6\n(* 2 (+ 3 4))       ; =&gt; 14\n(str \"Hello\" \" \" \"World\")  ; =&gt; \"Hello World\"\n</code></pre> <p>S\u5f0f\u306e\u7279\u5fb4\uff1a</p> <p></p>"},{"location":"clojure/part-1/#13","title":"1.3 \u57fa\u672c\u69cb\u6587","text":""},{"location":"clojure/part-1/#def","title":"\u5b9a\u6570\u5b9a\u7fa9\uff08def\uff09","text":"<pre><code>;; \u5024\u306e\u5b9a\u7fa9\n(def greeting \"Hello, Clojure!\")\n(def pi 3.14159)\n(def languages [\"Scala\" \"Java\" \"Clojure\" \"Haskell\"])\n\ngreeting    ; =&gt; \"Hello, Clojure!\"\npi          ; =&gt; 3.14159\nlanguages   ; =&gt; [\"Scala\" \"Java\" \"Clojure\" \"Haskell\"]\n</code></pre>"},{"location":"clojure/part-1/#defn","title":"\u95a2\u6570\u5b9a\u7fa9\uff08defn\uff09","text":"<pre><code>;; \u57fa\u672c\u7684\u306a\u95a2\u6570\u5b9a\u7fa9\n(defn greet\n  \"\u540d\u524d\u3092\u53d7\u3051\u53d6\u3063\u3066\u6328\u62f6\u3092\u8fd4\u3059\"\n  [name]\n  (str \"Hello, \" name \"!\"))\n\n(greet \"World\")  ; =&gt; \"Hello, World!\"\n\n;; \u8907\u6570\u5f15\u6570\n(defn add [a b]\n  (+ a b))\n\n(add 2 3)  ; =&gt; 5\n</code></pre>"},{"location":"clojure/part-1/#_3","title":"\u8907\u6570\u30a2\u30ea\u30c6\u30a3\u95a2\u6570","text":"<pre><code>;; \u540c\u3058\u95a2\u6570\u540d\u3067\u7570\u306a\u308b\u5f15\u6570\u306e\u6570\u306b\u5bfe\u5fdc\n(defn greet-multi\n  ([] (greet-multi \"World\"))\n  ([name] (str \"Hello, \" name \"!\"))\n  ([title name] (str \"Hello, \" title \" \" name \"!\")))\n\n(greet-multi)              ; =&gt; \"Hello, World!\"\n(greet-multi \"Alice\")      ; =&gt; \"Hello, Alice!\"\n(greet-multi \"Dr.\" \"Smith\") ; =&gt; \"Hello, Dr. Smith!\"\n</code></pre>"},{"location":"clojure/part-1/#14-let","title":"1.4 \u30ed\u30fc\u30ab\u30eb\u675f\u7e1b\uff08let\uff09","text":"<pre><code>;; let \u306b\u3088\u308b\u30ed\u30fc\u30ab\u30eb\u5909\u6570\n(defn calculate-area [radius]\n  (let [pi 3.14159\n        r-squared (* radius radius)]\n    (* pi r-squared)))\n\n(calculate-area 2)  ; =&gt; 12.56636\n\n;; \u30cd\u30b9\u30c8\u3057\u305f let\n(defn format-name [first-name last-name]\n  (let [full-name (str first-name \" \" last-name)\n        upper-name (clojure.string/upper-case full-name)]\n    {:full full-name\n     :upper upper-name\n     :initials (str (first first-name) \".\" (first last-name) \".\")}))\n\n(format-name \"John\" \"Doe\")\n; =&gt; {:full \"John Doe\", :upper \"JOHN DOE\", :initials \"J.D.\"}\n</code></pre>"},{"location":"clojure/part-1/#15","title":"1.5 \u30c7\u30fc\u30bf\u69cb\u9020","text":"<p>Clojure \u306e\u30b3\u30a2\u30c7\u30fc\u30bf\u69cb\u9020\u306f\u3059\u3079\u3066\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\uff08\u4e0d\u5909\uff09\u3067\u3059\u3002</p>"},{"location":"clojure/part-1/#list","title":"\u30ea\u30b9\u30c8\uff08List\uff09","text":"<pre><code>;; \u30ea\u30b9\u30c8\uff08\u9023\u7d50\u30ea\u30b9\u30c8\uff09- \u5148\u982d\u3078\u306e\u8ffd\u52a0\u304c O(1)\n'(1 2 3 4 5)\n\n;; \u30ea\u30b9\u30c8\u306e\u64cd\u4f5c\n(first '(1 2 3))   ; =&gt; 1\n(rest '(1 2 3))    ; =&gt; (2 3)\n(cons 0 '(1 2 3))  ; =&gt; (0 1 2 3)\n</code></pre>"},{"location":"clojure/part-1/#vector","title":"\u30d9\u30af\u30bf\u30fc\uff08Vector\uff09","text":"<pre><code>;; \u30d9\u30af\u30bf\u30fc - \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u30a2\u30af\u30bb\u30b9\u304c\u9ad8\u901f\n[1 2 3 4 5]\n\n;; \u30d9\u30af\u30bf\u30fc\u306e\u64cd\u4f5c\n(nth [1 2 3] 1)      ; =&gt; 2\n(get [1 2 3] 1)      ; =&gt; 2\n(conj [1 2 3] 4)     ; =&gt; [1 2 3 4]\n([1 2 3] 0)          ; =&gt; 1 \uff08\u30d9\u30af\u30bf\u30fc\u306f\u95a2\u6570\u3068\u3057\u3066\u3082\u4f7f\u3048\u308b\uff09\n</code></pre>"},{"location":"clojure/part-1/#map","title":"\u30de\u30c3\u30d7\uff08Map\uff09","text":"<pre><code>;; \u30de\u30c3\u30d7\uff08\u30ad\u30fc\u30fb\u5024\u30da\u30a2\uff09\n(def person {:name \"Alice\"\n             :age 30\n             :city \"Tokyo\"})\n\n;; \u30de\u30c3\u30d7\u306e\u64cd\u4f5c\n(:name person)           ; =&gt; \"Alice\"\n(get person :name)       ; =&gt; \"Alice\"\n(assoc person :email \"alice@example.com\")\n; =&gt; {:name \"Alice\", :age 30, :city \"Tokyo\", :email \"alice@example.com\"}\n</code></pre>"},{"location":"clojure/part-1/#set","title":"\u30bb\u30c3\u30c8\uff08Set\uff09","text":"<pre><code>;; \u30bb\u30c3\u30c8\uff08\u91cd\u8907\u306a\u3057\uff09\n#{1 2 3 4 5}\n\n;; \u30bb\u30c3\u30c8\u306e\u64cd\u4f5c\n(contains? #{1 2 3} 2)   ; =&gt; true\n(conj #{1 2 3} 4)        ; =&gt; #{1 4 3 2}\n(disj #{1 2 3} 2)        ; =&gt; #{1 3}\n</code></pre>"},{"location":"clojure/part-1/#_4","title":"\u30c7\u30fc\u30bf\u69cb\u9020\u306e\u6bd4\u8f03","text":"\u69cb\u9020 \u8ffd\u52a0\u4f4d\u7f6e \u30a2\u30af\u30bb\u30b9 \u7528\u9014 \u30ea\u30b9\u30c8 \u5148\u982d O(1) \u7dda\u5f62 O(n) \u30b9\u30bf\u30c3\u30af\u3001\u518d\u5e30\u51e6\u7406 \u30d9\u30af\u30bf\u30fc \u672b\u5c3e O(1)* \u30a4\u30f3\u30c7\u30c3\u30af\u30b9 O(log32 n) \u914d\u5217\u7684\u7528\u9014 \u30de\u30c3\u30d7 \u30ad\u30fc\u6307\u5b9a \u30ad\u30fc\u691c\u7d22 O(log32 n) \u9023\u60f3\u30c7\u30fc\u30bf \u30bb\u30c3\u30c8 \u5024\u8ffd\u52a0 \u5b58\u5728\u78ba\u8a8d O(log32 n) \u91cd\u8907\u6392\u9664\u3001\u96c6\u5408\u6f14\u7b97 <p>*\u53b3\u5bc6\u306b\u306f O(log32 n) \u3060\u304c\u3001\u5b9f\u8cea\u7684\u306b\u5b9a\u6570\u6642\u9593</p>"},{"location":"clojure/part-1/#16","title":"1.6 \u6761\u4ef6\u5206\u5c90","text":""},{"location":"clojure/part-1/#if","title":"if","text":"<pre><code>;; \u57fa\u672c\u7684\u306a if\n(if (&gt; 5 3)\n  \"5 is greater\"\n  \"3 is greater\")\n; =&gt; \"5 is greater\"\n</code></pre>"},{"location":"clojure/part-1/#cond","title":"cond","text":"<pre><code>;; \u8907\u6570\u6761\u4ef6\u306e\u5206\u5c90\n(defn check-age [age]\n  (cond\n    (&lt; age 0) \"Invalid age\"\n    (&lt; age 13) \"Child\"\n    (&lt; age 20) \"Teenager\"\n    (&lt; age 65) \"Adult\"\n    :else \"Senior\"))\n\n(check-age 25)  ; =&gt; \"Adult\"\n</code></pre>"},{"location":"clojure/part-1/#if-let-when-let","title":"if-let \u3068 when-let","text":"<pre><code>;; nil \u30c1\u30a7\u30c3\u30af\u3068\u675f\u7e1b\u3092\u540c\u6642\u306b\n(defn greet-optional [person]\n  (if-let [name (:name person)]\n    (str \"Hello, \" name \"!\")\n    \"Hello, stranger!\"))\n\n(greet-optional {:name \"Alice\"})  ; =&gt; \"Hello, Alice!\"\n(greet-optional {})               ; =&gt; \"Hello, stranger!\"\n</code></pre>"},{"location":"clojure/part-1/#17","title":"1.7 \u30eb\u30fc\u30d7\u3068\u518d\u5e30","text":""},{"location":"clojure/part-1/#looprecur","title":"loop/recur\uff08\u672b\u5c3e\u518d\u5e30\uff09","text":"<pre><code>;; \u672b\u5c3e\u518d\u5e30\u306b\u3088\u308b\u968e\u4e57\n(defn factorial [n]\n  (loop [i n\n         acc 1]\n    (if (&lt;= i 1)\n      acc\n      (recur (dec i) (* acc i)))))\n\n(factorial 5)   ; =&gt; 120\n(factorial 10)  ; =&gt; 3628800\n</code></pre>"},{"location":"clojure/part-1/#reduce","title":"reduce \u306b\u3088\u308b\u96c6\u7d04","text":"<pre><code>;; reduce \u306f\u6700\u3082\u6c4e\u7528\u7684\u306a\u30eb\u30fc\u30d7\u69cb\u9020\n(defn sum-of-squares [numbers]\n  (reduce (fn [acc n] (+ acc (* n n))) 0 numbers))\n\n(sum-of-squares [1 2 3])  ; =&gt; 14 (1 + 4 + 9)\n</code></pre>"},{"location":"clojure/part-1/#18","title":"1.8 \u5b9f\u8df5\u4f8b\uff1a\u30b7\u30e7\u30c3\u30d4\u30f3\u30b0\u30ab\u30fc\u30c8","text":"<pre><code>;; \u30b5\u30f3\u30d7\u30eb\u30ab\u30fc\u30c8\n(def sample-cart\n  [{:name \"Apple\" :price 100 :quantity 3}\n   {:name \"Banana\" :price 80 :quantity 5}\n   {:name \"Orange\" :price 120 :quantity 2}])\n\n;; \u30a2\u30a4\u30c6\u30e0\u306e\u5c0f\u8a08\n(defn item-total [item]\n  (* (:price item) (:quantity item)))\n\n;; \u30ab\u30fc\u30c8\u306e\u5408\u8a08\n(defn cart-total [cart]\n  (reduce + (map item-total cart)))\n\n;; \u5272\u5f15\u9069\u7528\n(defn apply-discount [total discount-rate]\n  (let [discount (* total discount-rate)]\n    (- total discount)))\n\n;; \u30c1\u30a7\u30c3\u30af\u30a2\u30a6\u30c8\n(defn checkout [cart discount-rate]\n  (let [subtotal (cart-total cart)\n        total (apply-discount subtotal discount-rate)]\n    {:subtotal subtotal\n     :discount-rate discount-rate\n     :discount (* subtotal discount-rate)\n     :total total}))\n\n(checkout sample-cart 0.1)\n; =&gt; {:subtotal 940, :discount-rate 0.1, :discount 94.0, :total 846.0}\n</code></pre>"},{"location":"clojure/part-1/#2","title":"\u7b2c2\u7ae0: \u7d14\u7c8b\u95a2\u6570","text":""},{"location":"clojure/part-1/#21","title":"2.1 \u7d14\u7c8b\u95a2\u6570\u3068\u306f","text":"<p>\u7d14\u7c8b\u95a2\u6570\u306f\u4ee5\u4e0b\u306e\u6761\u4ef6\u3092\u6e80\u305f\u3057\u307e\u3059\uff1a</p> <ol> <li>\u6c7a\u5b9a\u6027: \u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3059</li> <li>\u526f\u4f5c\u7528\u306a\u3057: \u5916\u90e8\u72b6\u614b\u3092\u5909\u66f4\u3057\u306a\u3044</li> </ol> <pre><code>;; \u7d14\u7c8b\u95a2\u6570\u306e\u4f8b\n(defn add [a b]\n  (+ a b))\n\n(defn square [n]\n  (* n n))\n\n;; \u4f55\u5ea6\u547c\u3093\u3067\u3082\u540c\u3058\u7d50\u679c\n(add 2 3)    ; =&gt; 5\n(add 2 3)    ; =&gt; 5\n(square 4)   ; =&gt; 16\n(square 4)   ; =&gt; 16\n</code></pre>"},{"location":"clojure/part-1/#22","title":"2.2 \u53c2\u7167\u900f\u904e\u6027","text":"<p>\u53c2\u7167\u900f\u904e\u6027\u3068\u306f\u3001\u5f0f\u3092\u305d\u306e\u7d50\u679c\u3067\u7f6e\u304d\u63db\u3048\u3066\u3082\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u52d5\u4f5c\u304c\u5909\u308f\u3089\u306a\u3044\u6027\u8cea\u3067\u3059\u3002</p> <pre><code>(defn referential-transparency-demo []\n  (let [x (+ 1 2)    ; x = 3\n        y (* x 3)    ; y = 9\n        z (+ x y)]   ; z = 12\n    ;; \u4ee5\u4e0b\u306f\u540c\u3058\u7d50\u679c\n    {:using-names z\n     :using-values (+ 3 9)}))\n\n;; x \u3068 y \u3092\u76f4\u63a5\u5024\u3067\u7f6e\u304d\u63db\u3048\u3066\u3082\u540c\u3058\n</code></pre>"},{"location":"clojure/part-1/#23","title":"2.3 \u4e0d\u7d14\u306a\u95a2\u6570\u306e\u554f\u984c","text":""},{"location":"clojure/part-1/#_5","title":"\u30b0\u30ed\u30fc\u30d0\u30eb\u72b6\u614b\u3078\u306e\u4f9d\u5b58","text":"<pre><code>;; \u4e0d\u7d14\uff1a\u30b0\u30ed\u30fc\u30d0\u30eb\u72b6\u614b\u306b\u4f9d\u5b58\n(def ^:dynamic *tax-rate* 0.1)\n\n(defn impure-calculate-tax [amount]\n  (* amount *tax-rate*))\n\n;; \u7d50\u679c\u304c\u5916\u90e8\u72b6\u614b\u306b\u4f9d\u5b58\u3059\u308b\n(impure-calculate-tax 1000)  ; =&gt; 100.0\n\n(binding [*tax-rate* 0.2]\n  (impure-calculate-tax 1000))  ; =&gt; 200.0\n</code></pre>"},{"location":"clojure/part-1/#_6","title":"\u7d14\u7c8b\u306a\u30d0\u30fc\u30b8\u30e7\u30f3","text":"<pre><code>;; \u7d14\u7c8b\uff1a\u7a0e\u7387\u3092\u5f15\u6570\u3068\u3057\u3066\u53d7\u3051\u53d6\u308b\n(defn pure-calculate-tax [amount tax-rate]\n  (* amount tax-rate))\n\n;; \u7d50\u679c\u306f\u5165\u529b\u306e\u307f\u306b\u4f9d\u5b58\n(pure-calculate-tax 1000 0.1)  ; =&gt; 100.0\n(pure-calculate-tax 1000 0.2)  ; =&gt; 200.0\n</code></pre>"},{"location":"clojure/part-1/#24","title":"2.4 \u526f\u4f5c\u7528\u306e\u5206\u96e2","text":"<pre><code>;; \u526f\u4f5c\u7528\u3092\u6301\u3064\u90e8\u5206\n(defn get-current-hour []\n  (.getHour (java.time.LocalTime/now)))\n\n;; \u7d14\u7c8b\u306a\u30b3\u30a2\u30ed\u30b8\u30c3\u30af\n(defn pure-greeting [name hour]\n  (str (cond\n         (&lt; hour 12) \"Good morning\"\n         (&lt; hour 18) \"Good afternoon\"\n         :else \"Good evening\")\n       \", \" name \"!\"))\n\n;; \u526f\u4f5c\u7528\u3092\u542b\u3080\u30e9\u30c3\u30d1\u30fc\n(defn create-greeting [name]\n  (pure-greeting name (get-current-hour)))\n</code></pre>"},{"location":"clojure/part-1/#25","title":"2.5 \u5b9f\u8df5\u4f8b\uff1a\u7d66\u4e0e\u8a08\u7b97\u30b7\u30b9\u30c6\u30e0","text":"<pre><code>;; \u7a0e\u7387\u5b9a\u7fa9\n(def tax-rates\n  {:income 0.20\n   :social 0.10\n   :health 0.05})\n\n;; \u7d14\u7c8b\u95a2\u6570\uff1a\u7dcf\u652f\u7d66\u984d\n(defn calculate-gross-salary [base-salary overtime-hours hourly-rate]\n  (+ base-salary (* overtime-hours hourly-rate)))\n\n;; \u7d14\u7c8b\u95a2\u6570\uff1a\u63a7\u9664\u8a08\u7b97\n(defn calculate-deductions [gross-salary rates]\n  (let [income-tax (* gross-salary (:income rates))\n        social (* gross-salary (:social rates))\n        health (* gross-salary (:health rates))]\n    {:income-tax income-tax\n     :social social\n     :health health\n     :total (+ income-tax social health)}))\n\n;; \u7d14\u7c8b\u95a2\u6570\uff1a\u624b\u53d6\u308a\u8a08\u7b97\n(defn calculate-net-salary [gross-salary deductions]\n  (- gross-salary (:total deductions)))\n\n;; \u7d14\u7c8b\u95a2\u6570\uff1a\u7d66\u4e0e\u8a08\u7b97\u5168\u4f53\n(defn process-payroll [employee rates]\n  (let [gross (calculate-gross-salary\n               (:base-salary employee)\n               (:overtime-hours employee 0)\n               (:hourly-rate employee 0))\n        deductions (calculate-deductions gross rates)\n        net (calculate-net-salary gross deductions)]\n    {:employee-id (:id employee)\n     :gross-salary gross\n     :deductions deductions\n     :net-salary net}))\n\n;; \u4f7f\u7528\u4f8b\n(process-payroll\n  {:id 1 :base-salary 300000 :overtime-hours 10 :hourly-rate 1000}\n  tax-rates)\n; =&gt; {:employee-id 1,\n;     :gross-salary 310000,\n;     :deductions {:income-tax 62000.0, :social 31000.0, :health 15500.0, :total 108500.0},\n;     :net-salary 201500.0}\n</code></pre>"},{"location":"clojure/part-1/#26","title":"2.6 \u6587\u5b57\u5217\u51e6\u7406","text":"<pre><code>;; \u7d14\u7c8b\u95a2\u6570\u306b\u3088\u308b\u6587\u5b57\u5217\u51e6\u7406\n(defn normalize-string [s]\n  (-&gt; s\n      clojure.string/trim\n      clojure.string/lower-case))\n\n(defn count-words [s]\n  (if (clojure.string/blank? s)\n    0\n    (count (clojure.string/split (clojure.string/trim s) #\"\\s+\"))))\n\n(defn word-frequencies [s]\n  (frequencies (clojure.string/split (normalize-string s) #\"\\s+\")))\n\n(word-frequencies \"Hello World hello\")\n; =&gt; {\"hello\" 2, \"world\" 1}\n</code></pre>"},{"location":"clojure/part-1/#27","title":"2.7 \u30c7\u30fc\u30bf\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3","text":"<pre><code>;; \u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u95a2\u6570\u7fa4\n(defn validate-not-empty [field-name value]\n  (if (clojure.string/blank? value)\n    {:valid false :error (str field-name \" cannot be empty\")}\n    {:valid true :value value}))\n\n(defn validate-email-format [email]\n  (if (re-matches #\".+@.+\\..+\" email)\n    {:valid true :value email}\n    {:valid false :error \"Invalid email format\"}))\n\n(defn validate-age [age]\n  (cond\n    (not (integer? age)) {:valid false :error \"Age must be an integer\"}\n    (neg? age) {:valid false :error \"Age cannot be negative\"}\n    (&gt; age 150) {:valid false :error \"Age seems unrealistic\"}\n    :else {:valid true :value age}))\n\n;; \u30e6\u30fc\u30b6\u30fc\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\n(defn validate-user [user]\n  (let [name-result (validate-not-empty \"Name\" (:name user \"\"))\n        email-result (validate-email-format (:email user \"\"))\n        age-result (validate-age (:age user))]\n    (if (and (:valid name-result)\n             (:valid email-result)\n             (:valid age-result))\n      {:valid true :user user}\n      {:valid false\n       :errors (remove nil?\n                 [(when-not (:valid name-result) (:error name-result))\n                  (when-not (:valid email-result) (:error email-result))\n                  (when-not (:valid age-result) (:error age-result))])})))\n\n(validate-user {:name \"Alice\" :email \"alice@example.com\" :age 30})\n; =&gt; {:valid true, :user {:name \"Alice\", :email \"alice@example.com\", :age 30}}\n\n(validate-user {:name \"\" :email \"invalid\" :age -1})\n; =&gt; {:valid false, :errors (\"Name cannot be empty\" \"Invalid email format\" \"Age cannot be negative\")}\n</code></pre>"},{"location":"clojure/part-1/#28","title":"2.8 \u30b3\u30f3\u30dd\u30b8\u30b7\u30e7\u30f3","text":""},{"location":"clojure/part-1/#_7","title":"\u30b9\u30ec\u30c3\u30c7\u30a3\u30f3\u30b0\u30de\u30af\u30ed","text":"<pre><code>;; -&gt; (thread-first): \u6700\u521d\u306e\u5f15\u6570\u4f4d\u7f6e\u306b\u633f\u5165\n(-&gt; 5\n    (+ 3)      ; (+ 5 3)\n    (* 2))     ; (* 8 2) =&gt; 16\n\n;; -&gt;&gt; (thread-last): \u6700\u5f8c\u306e\u5f15\u6570\u4f4d\u7f6e\u306b\u633f\u5165\n(-&gt;&gt; [1 2 3 4 5]\n     (filter odd?)    ; (filter odd? [1 2 3 4 5])\n     (map inc))       ; (map inc '(1 3 5)) =&gt; (2 4 6)\n</code></pre>"},{"location":"clojure/part-1/#comp","title":"comp \u306b\u3088\u308b\u95a2\u6570\u5408\u6210","text":"<pre><code>;; comp \u306f\u53f3\u304b\u3089\u5de6\u306b\u9069\u7528\n(def process-string\n  (comp clojure.string/upper-case\n        clojure.string/trim\n        clojure.string/reverse))\n\n(process-string \"  hello  \")  ; =&gt; \"OLLEH\"\n</code></pre>"},{"location":"clojure/part-1/#partial","title":"partial \u306b\u3088\u308b\u90e8\u5206\u9069\u7528","text":"<pre><code>;; partial \u3067\u5f15\u6570\u3092\u56fa\u5b9a\n(def add-ten (partial + 10))\n(def multiply-by-two (partial * 2))\n\n(add-ten 5)          ; =&gt; 15\n(multiply-by-two 5)  ; =&gt; 10\n</code></pre>"},{"location":"clojure/part-1/#29","title":"2.9 \u7d71\u8a08\u8a08\u7b97","text":"<pre><code>;; \u7d14\u7c8b\u95a2\u6570\u306b\u3088\u308b\u7d71\u8a08\u8a08\u7b97\n(defn sum-all [numbers]\n  (reduce + 0 numbers))\n\n(defn average [numbers]\n  (if (empty? numbers)\n    0\n    (/ (sum-all numbers) (count numbers))))\n\n(defn statistics [numbers]\n  (if (empty? numbers)\n    {:count 0 :sum 0 :average 0 :min nil :max nil}\n    {:count (count numbers)\n     :sum (sum-all numbers)\n     :average (average numbers)\n     :min (apply min numbers)\n     :max (apply max numbers)}))\n\n(statistics [1 2 3 4 5])\n; =&gt; {:count 5, :sum 15, :average 3, :min 1, :max 5}\n</code></pre>"},{"location":"clojure/part-1/#_8","title":"\u307e\u3068\u3081","text":""},{"location":"clojure/part-1/#_9","title":"\u5b66\u3093\u3060\u6982\u5ff5","text":"\u6982\u5ff5 \u8aac\u660e Clojure \u3067\u306e\u8868\u73fe S\u5f0f Lisp \u306e\u30b3\u30fc\u30c9\u8868\u73fe <code>(\u95a2\u6570 \u5f15\u6570...)</code> \u95a2\u6570\u5b9a\u7fa9 \u540d\u524d\u4ed8\u304d\u95a2\u6570 <code>defn</code> \u30ed\u30fc\u30ab\u30eb\u675f\u7e1b \u4e00\u6642\u7684\u306a\u5024\u306e\u675f\u7e1b <code>let</code> \u7d14\u7c8b\u95a2\u6570 \u526f\u4f5c\u7528\u306e\u306a\u3044\u95a2\u6570 \u5f15\u6570\u306e\u307f\u306b\u4f9d\u5b58 \u53c2\u7167\u900f\u904e\u6027 \u5f0f\u3068\u5024\u306e\u7f6e\u63db\u53ef\u80fd\u6027 \u5916\u90e8\u72b6\u614b\u3078\u306e\u975e\u4f9d\u5b58 \u30b3\u30f3\u30dd\u30b8\u30b7\u30e7\u30f3 \u95a2\u6570\u306e\u7d44\u307f\u5408\u308f\u305b <code>-&gt;</code>, <code>-&gt;&gt;</code>, <code>comp</code>"},{"location":"clojure/part-1/#scala","title":"Scala \u3068\u306e\u6bd4\u8f03","text":"\u6982\u5ff5 Scala Clojure \u95a2\u6570\u5b9a\u7fa9 <code>def f(x: Int) = ...</code> <code>(defn f [x] ...)</code> \u7121\u540d\u95a2\u6570 <code>x =&gt; x + 1</code> <code>#(+ % 1)</code> \u307e\u305f\u306f <code>(fn [x] (+ x 1))</code> \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3 <code>.map().filter()</code> <code>(-&gt;&gt; coll (map f) (filter p))</code> \u90e8\u5206\u9069\u7528 <code>f(1, _)</code> <code>(partial f 1)</code> \u5408\u6210 <code>f andThen g</code> <code>(comp g f)</code>"},{"location":"clojure/part-1/#_10","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part II: \u95a2\u6570\u578b\u30b9\u30bf\u30a4\u30eb\u306e\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0 \u3067\u306f\u3001\u4ee5\u4e0b\u3092\u5b66\u3073\u307e\u3059\uff1a</p> <ul> <li>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u306e\u6df1\u5800\u308a</li> <li>\u6c38\u7d9a\u30c7\u30fc\u30bf\u69cb\u9020</li> <li>\u9ad8\u968e\u95a2\u6570\u306e\u6d3b\u7528\uff08map\u3001filter\u3001reduce\uff09</li> <li>\u30b9\u30ec\u30c3\u30c7\u30a3\u30f3\u30b0\u30de\u30af\u30ed\u306e\u5fdc\u7528</li> </ul>"},{"location":"clojure/part-2/","title":"Part II: \u95a2\u6570\u578b\u30b9\u30bf\u30a4\u30eb\u306e\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\uff08Clojure \u7248\uff09","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u6838\u5fc3\u3068\u306a\u308b\u30c6\u30af\u30cb\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059\u3002\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c\u3001\u9ad8\u968e\u95a2\u6570\u3001\u305d\u3057\u3066 <code>mapcat</code> \u306b\u3088\u308b\u8907\u96d1\u306a\u30c7\u30fc\u30bf\u5909\u63db\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"clojure/part-2/#3","title":"\u7b2c3\u7ae0: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c","text":""},{"location":"clojure/part-2/#31","title":"3.1 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u3068\u306f","text":"<p>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\uff08\u4e0d\u5909\uff09\u3068\u306f\u3001\u4e00\u5ea6\u4f5c\u6210\u3055\u308c\u305f\u30c7\u30fc\u30bf\u304c\u5909\u66f4\u3055\u308c\u306a\u3044\u3053\u3068\u3092\u610f\u5473\u3057\u307e\u3059\u3002Clojure \u306e\u30c7\u30fc\u30bf\u69cb\u9020\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u3067\u3059\u3002</p> <pre><code>;; \u5143\u306e\u30d9\u30af\u30bf\u30fc\n(def original [1 2 3])\n\n;; conj \u3067\u8981\u7d20\u3092\u8ffd\u52a0\u3057\u3066\u3082\u5143\u306e\u30d9\u30af\u30bf\u30fc\u306f\u5909\u308f\u3089\u306a\u3044\n(def new-vec (conj original 4))\n\noriginal  ; =&gt; [1 2 3]\nnew-vec   ; =&gt; [1 2 3 4]\n</code></pre> <p></p>"},{"location":"clojure/part-2/#32","title":"3.2 \u6c38\u7d9a\u30c7\u30fc\u30bf\u69cb\u9020","text":"<p>Clojure \u306e\u6c38\u7d9a\u30c7\u30fc\u30bf\u69cb\u9020\u306f\u300c\u69cb\u9020\u5171\u6709\u300d\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\u65b0\u3057\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u4f5c\u6210\u3057\u3066\u3082\u3001\u5909\u308f\u3063\u3066\u3044\u306a\u3044\u90e8\u5206\u306f\u30e1\u30e2\u30ea\u3092\u5171\u6709\u3057\u307e\u3059\u3002</p> <pre><code>;; \u5927\u304d\u306a\u30d9\u30af\u30bf\u30fc\u3067\u3082\u52b9\u7387\u7684\n(def large-vec (vec (range 1000000)))\n(def modified (assoc large-vec 500000 :replaced))\n\n;; \u5909\u66f4\u3055\u308c\u3066\u3044\u306a\u3044\u90e8\u5206\u306f\u30e1\u30e2\u30ea\u3092\u5171\u6709\n</code></pre>"},{"location":"clojure/part-2/#33","title":"3.3 \u30d9\u30af\u30bf\u30fc\u306e\u57fa\u672c\u64cd\u4f5c","text":"<pre><code>;; \u8981\u7d20\u306e\u8ffd\u52a0\uff08\u672b\u5c3e\uff09\n(conj [1 2 3] 4)          ; =&gt; [1 2 3 4]\n\n;; \u8907\u6570\u8981\u7d20\u306e\u8ffd\u52a0\n(into [1 2] [3 4 5])      ; =&gt; [1 2 3 4 5]\n\n;; \u30b9\u30e9\u30a4\u30b9\u64cd\u4f5c\n(subvec [0 1 2 3 4] 1 3)  ; =&gt; [1 2]\n\n;; \u6700\u521d\u306e n \u8981\u7d20\n(take 2 [1 2 3 4 5])      ; =&gt; (1 2)\n\n;; \u6700\u5f8c\u306e n \u8981\u7d20\n(take-last 2 [1 2 3 4 5]) ; =&gt; (4 5)\n</code></pre>"},{"location":"clojure/part-2/#34","title":"3.4 \u30ea\u30b9\u30c8\u5909\u63db\u30d1\u30bf\u30fc\u30f3","text":"<pre><code>;; \u6700\u521d\u306e2\u8981\u7d20\u3092\u672b\u5c3e\u306b\u79fb\u52d5\n(defn move-first-two-to-end [coll]\n  (let [first-two (take 2 coll)\n        rest-items (drop 2 coll)]\n    (into (vec rest-items) first-two)))\n\n(move-first-two-to-end [\"a\" \"b\" \"c\" \"d\"])\n; =&gt; [\"c\" \"d\" \"a\" \"b\"]\n\n;; \u6307\u5b9a\u4f4d\u7f6e\u306b\u633f\u5165\n(defn insert-at [coll index element]\n  (let [before (take index coll)\n        after (drop index coll)]\n    (into (conj (vec before) element) after)))\n\n(insert-at [\"a\" \"b\" \"c\"] 1 \"x\")\n; =&gt; [\"a\" \"x\" \"b\" \"c\"]\n</code></pre>"},{"location":"clojure/part-2/#35","title":"3.5 \u65c5\u7a0b\u306e\u518d\u8a08\u753b","text":"<pre><code>(defn replan [plan new-city before-city]\n  (let [index (.indexOf (vec plan) before-city)\n        cities-before (take index plan)\n        cities-after (drop index plan)]\n    (into (conj (vec cities-before) new-city) cities-after)))\n\n(def plan-a [\"Paris\" \"Berlin\" \"Krak\u00f3w\"])\n(def plan-b (replan plan-a \"Vienna\" \"Krak\u00f3w\"))\n\nplan-b  ; =&gt; [\"Paris\" \"Berlin\" \"Vienna\" \"Krak\u00f3w\"]\nplan-a  ; =&gt; [\"Paris\" \"Berlin\" \"Krak\u00f3w\"]\uff08\u5909\u308f\u3063\u3066\u3044\u306a\u3044\uff09\n</code></pre>"},{"location":"clojure/part-2/#36","title":"3.6 \u30de\u30c3\u30d7\u306e\u64cd\u4f5c","text":"<pre><code>;; \u5024\u306e\u66f4\u65b0\n(def person {:name \"Alice\" :age 30})\n\n(assoc person :age 31)\n; =&gt; {:name \"Alice\", :age 31}\n\n;; \u95a2\u6570\u3067\u66f4\u65b0\n(update person :age inc)\n; =&gt; {:name \"Alice\", :age 31}\n\n;; \u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u524a\u9664\n(dissoc person :age)\n; =&gt; {:name \"Alice\"}\n\n;; \u30cd\u30b9\u30c8\u3057\u305f\u66f4\u65b0\n(def data {:user {:profile {:name \"Bob\"}}})\n(update-in data [:user :profile :name] clojure.string/upper-case)\n; =&gt; {:user {:profile {:name \"BOB\"}}}\n</code></pre>"},{"location":"clojure/part-2/#4","title":"\u7b2c4\u7ae0: \u95a2\u6570\u3092\u5024\u3068\u3057\u3066\u6271\u3046","text":""},{"location":"clojure/part-2/#41","title":"4.1 \u9ad8\u968e\u95a2\u6570\u3068\u306f","text":"<p>\u9ad8\u968e\u95a2\u6570\uff08Higher-Order Function\uff09\u3068\u306f\u3001\u4ee5\u4e0b\u306e\u3044\u305a\u308c\u304b\u3092\u6e80\u305f\u3059\u95a2\u6570\u3067\u3059\uff1a</p> <ol> <li>\u95a2\u6570\u3092\u5f15\u6570\u3068\u3057\u3066\u53d7\u3051\u53d6\u308b</li> <li>\u95a2\u6570\u3092\u623b\u308a\u5024\u3068\u3057\u3066\u8fd4\u3059</li> </ol> <p>Clojure \u3067\u306f\u95a2\u6570\u306f\u30d5\u30a1\u30fc\u30b9\u30c8\u30af\u30e9\u30b9\u306e\u5024\u3067\u3059\u3002</p> <p></p>"},{"location":"clojure/part-2/#42-map-","title":"4.2 map - \u5404\u8981\u7d20\u3092\u5909\u63db","text":"<pre><code>;; \u95a2\u6570\u3092\u5b9a\u7fa9\n(defn len [s] (count s))\n\n;; map \u3067\u5404\u8981\u7d20\u306b\u9069\u7528\n(map len [\"scala\" \"rust\" \"ada\"])\n; =&gt; (5 4 3)\n\n;; \u7121\u540d\u95a2\u6570\u3092\u4f7f\u7528\n(map #(* 2 %) [5 1 2 4 0])\n; =&gt; (10 2 4 8 0)\n\n;; 2\u4e57\n(map #(* % %) [1 2 3 4 5])\n; =&gt; (1 4 9 16 25)\n</code></pre>"},{"location":"clojure/part-2/#43-filter-","title":"4.3 filter - \u6761\u4ef6\u306b\u5408\u3046\u8981\u7d20\u3092\u62bd\u51fa","text":"<pre><code>;; \u5947\u6570\u306e\u307f\n(filter odd? [5 1 2 4 0])\n; =&gt; (5 1)\n\n;; 4\u3088\u308a\u5927\u304d\u3044\n(filter #(&gt; % 4) [5 1 2 4 0])\n; =&gt; (5)\n\n;; \u5076\u6570\u306e\u307f\n(filter even? [1 2 3 4 5 6])\n; =&gt; (2 4 6)\n</code></pre>"},{"location":"clojure/part-2/#44-reduce-","title":"4.4 reduce - \u7573\u307f\u8fbc\u307f","text":"<pre><code>;; \u5408\u8a08\n(reduce + 0 [5 1 2 4 100])\n; =&gt; 112\n\n;; \u6700\u5927\u5024\n(reduce (fn [max-val n]\n          (if (&gt; n max-val) n max-val))\n        Integer/MIN_VALUE\n        [5 1 2 4 15])\n; =&gt; 15\n\n;; \u7a4d\n(reduce * 1 [1 2 3 4 5])\n; =&gt; 120\n</code></pre>"},{"location":"clojure/part-2/#45-sort-by-","title":"4.5 sort-by - \u30bd\u30fc\u30c8\u57fa\u6e96\u3092\u95a2\u6570\u3067\u6307\u5b9a","text":"<pre><code>(defn score [word]\n  (count (clojure.string/replace word \"a\" \"\")))\n\n(sort-by score [\"rust\" \"java\"])\n; =&gt; (\"java\" \"rust\")\n;; java: 2\u6587\u5b57 (j, v), rust: 4\u6587\u5b57 (r, u, s, t)\n</code></pre>"},{"location":"clojure/part-2/#46","title":"4.6 \u95a2\u6570\u3092\u8fd4\u3059\u95a2\u6570","text":"<pre><code>(defn larger-than [n]\n  (fn [i] (&gt; i n)))\n\n(filter (larger-than 4) [5 1 2 4 0])\n; =&gt; (5)\n\n(filter (larger-than 1) [5 1 2 4 0])\n; =&gt; (5 2 4)\n\n;; \u7bc4\u56f2\u5224\u5b9a\n(defn between [min-val max-val]\n  (fn [i] (and (&gt;= i min-val) (&lt;= i max-val))))\n\n(filter (between 2 5) [1 2 3 4 5 6])\n; =&gt; (2 3 4 5)\n</code></pre>"},{"location":"clojure/part-2/#47-partial","title":"4.7 \u90e8\u5206\u9069\u7528\uff08partial\uff09","text":"<pre><code>(def add-10 (partial + 10))\n(def multiply-by-2 (partial * 2))\n\n(add-10 5)         ; =&gt; 15\n(multiply-by-2 5)  ; =&gt; 10\n\n(map (partial + 100) [1 2 3])\n; =&gt; (101 102 103)\n</code></pre>"},{"location":"clojure/part-2/#48-comp","title":"4.8 \u95a2\u6570\u5408\u6210\uff08comp\uff09","text":"<pre><code>;; comp \u306f\u53f3\u304b\u3089\u5de6\u306b\u95a2\u6570\u3092\u9069\u7528\n(def process-number\n  (comp (partial + 10) (partial * 2)))\n\n(process-number 5)  ; =&gt; 20 (5*2=10, 10+10=20)\n\n(def normalize-name\n  (comp clojure.string/capitalize\n        clojure.string/trim\n        clojure.string/lower-case))\n\n(normalize-name \"  JOHN DOE  \")\n; =&gt; \"John doe\"\n</code></pre>"},{"location":"clojure/part-2/#49","title":"4.9 \u30b9\u30ec\u30c3\u30c7\u30a3\u30f3\u30b0\u30de\u30af\u30ed","text":"<p>Clojure \u306e\u30b9\u30ec\u30c3\u30c7\u30a3\u30f3\u30b0\u30de\u30af\u30ed\u306f\u3001\u30c7\u30fc\u30bf\u306e\u5909\u63db\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3092\u8aad\u307f\u3084\u3059\u304f\u66f8\u3051\u307e\u3059\u3002</p> <pre><code>;; -&gt; (thread-first): \u524d\u306e\u7d50\u679c\u3092\u6700\u521d\u306e\u5f15\u6570\u3068\u3057\u3066\u633f\u5165\n(-&gt; \"  Hello World  \"\n    clojure.string/trim\n    clojure.string/lower-case\n    (clojure.string/replace #\"\\s+\" \"-\"))\n; =&gt; \"hello-world\"\n\n;; -&gt;&gt; (thread-last): \u524d\u306e\u7d50\u679c\u3092\u6700\u5f8c\u306e\u5f15\u6570\u3068\u3057\u3066\u633f\u5165\n(-&gt;&gt; [1 2 3 4 5]\n     (filter odd?)\n     (map #(* % %))\n     (reduce +))\n; =&gt; 35 (1 + 9 + 25)\n</code></pre> <p></p>"},{"location":"clojure/part-2/#410","title":"4.10 \u30ef\u30fc\u30c9\u30b9\u30b3\u30a2\u30ea\u30f3\u30b0\u306e\u4f8b","text":"<pre><code>(defn score [word]\n  (count (clojure.string/replace word \"a\" \"\")))\n\n(defn bonus [word]\n  (if (clojure.string/includes? word \"c\") 5 0))\n\n(defn penalty [word]\n  (if (clojure.string/includes? word \"s\") 7 0))\n\n(defn ranked-words [word-scorer words]\n  (reverse (sort-by word-scorer words)))\n\n(def words [\"ada\" \"haskell\" \"scala\" \"java\" \"rust\"])\n\n;; \u57fa\u672c\u30b9\u30b3\u30a2\u3067\u30e9\u30f3\u30ad\u30f3\u30b0\n(ranked-words score words)\n; =&gt; (\"haskell\" \"rust\" \"scala\" \"java\" \"ada\")\n\n;; \u30dc\u30fc\u30ca\u30b9\u4ed8\u304d\u30b9\u30b3\u30a2\u3067\u30e9\u30f3\u30ad\u30f3\u30b0\n(ranked-words #(+ (score %) (bonus %)) words)\n; =&gt; (\"scala\" \"haskell\" \"rust\" \"java\" \"ada\")\n</code></pre>"},{"location":"clojure/part-2/#5-mapcat","title":"\u7b2c5\u7ae0: mapcat \u3068\u30cd\u30b9\u30c8\u69cb\u9020","text":""},{"location":"clojure/part-2/#51-flatten-","title":"5.1 flatten - \u30cd\u30b9\u30c8\u3092\u5e73\u5766\u5316","text":"<pre><code>;; flatten \u306f\u5b8c\u5168\u306b\u5e73\u5766\u5316\n(flatten [[1 2] [3 4] [5]])\n; =&gt; (1 2 3 4 5)\n\n(flatten [[[1 2] [3]] [[4 5]]])\n; =&gt; (1 2 3 4 5)\n\n;; apply concat \u306f1\u30ec\u30d9\u30eb\u3060\u3051\u5e73\u5766\u5316\n(apply concat [[1 2] [3 4]])\n; =&gt; (1 2 3 4)\n</code></pre>"},{"location":"clojure/part-2/#52-mapcat-map-concat","title":"5.2 mapcat = map + concat","text":"<p><code>mapcat</code> \u306f Scala \u306e <code>flatMap</code> \u306b\u76f8\u5f53\u3057\u307e\u3059\u3002</p> <pre><code>(def books\n  [{:title \"FP in Scala\" :authors [\"Chiusano\" \"Bjarnason\"]}\n   {:title \"The Hobbit\" :authors [\"Tolkien\"]}])\n\n;; map \u3060\u3051\u3060\u3068\u30cd\u30b9\u30c8\u3059\u308b\n(map :authors books)\n; =&gt; ([\"Chiusano\" \"Bjarnason\"] [\"Tolkien\"])\n\n;; mapcat \u3067\u5e73\u5766\u5316\n(mapcat :authors books)\n; =&gt; (\"Chiusano\" \"Bjarnason\" \"Tolkien\")\n</code></pre> <p></p>"},{"location":"clojure/part-2/#53-mapcat","title":"5.3 mapcat \u306b\u3088\u308b\u30b5\u30a4\u30ba\u5909\u5316","text":"<pre><code>;; \u8981\u7d20\u6570\u304c\u5897\u3048\u308b\n(mapcat (fn [x] [x x]) [1 2 3])\n; =&gt; (1 1 2 2 3 3)\n\n;; \u8981\u7d20\u6570\u304c\u540c\u3058\n(mapcat (fn [x] [(* 2 x)]) [1 2 3])\n; =&gt; (2 4 6)\n\n;; \u8981\u7d20\u6570\u304c\u6e1b\u308b\uff08\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u52b9\u679c\uff09\n(mapcat (fn [x] (if (even? x) [x] [])) [1 2 3 4 5])\n; =&gt; (2 4)\n</code></pre>"},{"location":"clojure/part-2/#54-mapcat","title":"5.4 \u30cd\u30b9\u30c8\u3057\u305f mapcat","text":"<pre><code>(defn book-adaptations [author]\n  (case author\n    \"Tolkien\" [{:title \"An Unexpected Journey\"}\n               {:title \"The Desolation of Smaug\"}]\n    []))\n\n;; \u30cd\u30b9\u30c8\u3057\u305f mapcat\n(mapcat\n  (fn [book]\n    (mapcat\n      (fn [author]\n        (map\n          (fn [movie]\n            (str \"You may like \" (:title movie)\n                 \", because you liked \" author \"'s \" (:title book)))\n          (book-adaptations author)))\n      (:authors book)))\n  books)\n</code></pre>"},{"location":"clojure/part-2/#55-for","title":"5.5 for \u5185\u5305\u8868\u8a18","text":"<p>Clojure \u306e <code>for</code> \u306f Scala \u306e for \u5185\u5305\u8868\u8a18\u306b\u76f8\u5f53\u3057\u307e\u3059\u3002</p> <pre><code>;; \u30cd\u30b9\u30c8\u3057\u305f mapcat \u3068\u7b49\u4fa1\n(for [book books\n      author (:authors book)\n      movie (book-adaptations author)]\n  (str \"You may like \" (:title movie)\n       \", because you liked \" author \"'s \" (:title book)))\n; =&gt; (\"You may like An Unexpected Journey, because you liked Tolkien's The Hobbit\"\n;     \"You may like The Desolation of Smaug, because you liked Tolkien's The Hobbit\")\n</code></pre> <p></p>"},{"location":"clojure/part-2/#56-when","title":"5.6 \u30ac\u30fc\u30c9\u5f0f\uff08:when\uff09","text":"<pre><code>;; :when \u3067\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\n(for [x (range 1 4)\n      y (range 1 4)\n      :let [product (* x y)]\n      :when (even? product)]\n  {:x x :y y :product product})\n; =&gt; ({:x 1 :y 2 :product 2} {:x 2 :y 1 :product 2} ...)\n</code></pre>"},{"location":"clojure/part-2/#57","title":"5.7 \u5186\u5185\u306e\u70b9\u306e\u5224\u5b9a","text":"<pre><code>(defn inside? [point radius]\n  (&lt;= (+ (* (:x point) (:x point))\n         (* (:y point) (:y point)))\n      (* radius radius)))\n\n(def points [{:x 5 :y 2} {:x 1 :y 1}])\n(def radiuses [2 1])\n\n;; \u3059\u3079\u3066\u306e\u7d44\u307f\u5408\u308f\u305b\u3092\u751f\u6210\n(for [r radiuses\n      point points]\n  {:point point\n   :radius r\n   :inside? (inside? point r)})\n\n;; \u5186\u5185\u306e\u70b9\u306e\u307f\n(for [r radiuses\n      point points\n      :when (inside? point r)]\n  {:point point :radius r})\n; =&gt; ({:point {:x 1, :y 1}, :radius 2})\n</code></pre>"},{"location":"clojure/part-2/#58-for","title":"5.8 for \u3068\u578b","text":"<p><code>for</code> \u306f\u5e38\u306b\u9045\u5ef6\u30b7\u30fc\u30b1\u30f3\u30b9\u3092\u8fd4\u3057\u307e\u3059\u3002\u578b\u3092\u5909\u63db\u3059\u308b\u306b\u306f <code>into</code> \u3092\u4f7f\u3044\u307e\u3059\u3002</p> <pre><code>;; \u30d9\u30af\u30bf\u30fc\u306b\u5909\u63db\n(into [] (for [x [1 2] y [3 4]] (* x y)))\n; =&gt; [3 4 6 8]\n\n;; \u30bb\u30c3\u30c8\u306b\u5909\u63db\uff08\u91cd\u8907\u304c\u9664\u304b\u308c\u308b\uff09\n(into #{} (for [x [1 2] y [3 4]] (* x y)))\n; =&gt; #{3 4 6 8}\n</code></pre>"},{"location":"clojure/part-2/#59","title":"5.9 \u5b9f\u8df5\u4f8b\uff1a\u5546\u54c1\u691c\u7d22","text":"<pre><code>(def products\n  [{:id 1 :name \"Laptop\" :category :electronics :price 1000\n    :tags [\"computer\" \"portable\" \"work\"]}\n   {:id 2 :name \"Phone\" :category :electronics :price 800\n    :tags [\"mobile\" \"portable\"]}\n   {:id 3 :name \"Desk\" :category :furniture :price 300\n    :tags [\"office\" \"work\"]}])\n\n;; \u6761\u4ef6\u3067\u691c\u7d22\n(for [product products\n      :when (and (&gt;= (:price product) 500)\n                 (= (:category product) :electronics))]\n  product)\n\n;; \u5546\u54c1\u3068\u30bf\u30b0\u306e\u30da\u30a2\u3092\u751f\u6210\n(for [product products\n      tag (:tags product)]\n  {:product-name (:name product) :tag tag})\n</code></pre>"},{"location":"clojure/part-2/#_1","title":"\u307e\u3068\u3081","text":""},{"location":"clojure/part-2/#part-ii","title":"Part II \u3067\u5b66\u3093\u3060\u3053\u3068","text":"\u7ae0 \u4e3b\u8981\u6982\u5ff5 \u30ad\u30fc\u64cd\u4f5c \u7b2c3\u7ae0 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb <code>conj</code>, <code>into</code>, <code>assoc</code>, <code>update</code> \u7b2c4\u7ae0 \u9ad8\u968e\u95a2\u6570 <code>map</code>, <code>filter</code>, <code>reduce</code>, <code>sort-by</code> \u7b2c5\u7ae0 \u5e73\u5766\u5316 <code>flatten</code>, <code>mapcat</code>, <code>for</code> \u5185\u5305\u8868\u8a18"},{"location":"clojure/part-2/#scala","title":"Scala \u3068\u306e\u6bd4\u8f03","text":"\u6982\u5ff5 Scala Clojure \u30ea\u30b9\u30c8\u8ffd\u52a0 <code>list :+ elem</code> <code>(conj vec elem)</code> \u30b9\u30e9\u30a4\u30b9 <code>list.slice(a, b)</code> <code>(subvec vec a b)</code> map <code>list.map(f)</code> <code>(map f coll)</code> filter <code>list.filter(p)</code> <code>(filter p coll)</code> foldLeft <code>list.foldLeft(init)(f)</code> <code>(reduce f init coll)</code> flatMap <code>list.flatMap(f)</code> <code>(mapcat f coll)</code> for \u5185\u5305\u8868\u8a18 <code>for { x &lt;- xs } yield x</code> <code>(for [x xs] x)</code>"},{"location":"clojure/part-2/#_2","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf: \u5143\u306e\u30c7\u30fc\u30bf\u306f\u5909\u66f4\u305b\u305a\u3001\u65b0\u3057\u3044\u30c7\u30fc\u30bf\u3092\u4f5c\u6210</li> <li>\u69cb\u9020\u5171\u6709: \u6c38\u7d9a\u30c7\u30fc\u30bf\u69cb\u9020\u306b\u3088\u308a\u52b9\u7387\u7684\u306a\u30e1\u30e2\u30ea\u4f7f\u7528</li> <li>\u95a2\u6570\u306f\u5024: \u95a2\u6570\u3092\u5f15\u6570\u3068\u3057\u3066\u6e21\u3057\u305f\u308a\u3001\u623b\u308a\u5024\u3068\u3057\u3066\u8fd4\u305b\u308b</li> <li>\u30b9\u30ec\u30c3\u30c7\u30a3\u30f3\u30b0\u30de\u30af\u30ed: <code>-&gt;</code> \u3068 <code>-&gt;&gt;</code> \u3067\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u51e6\u7406</li> <li>mapcat \u30d1\u30bf\u30fc\u30f3: \u30cd\u30b9\u30c8\u3057\u305f\u69cb\u9020\u3092\u5e73\u5766\u5316\u3057\u306a\u304c\u3089\u5909\u63db</li> <li>for \u5185\u5305\u8868\u8a18: \u5ba3\u8a00\u7684\u306a\u30b7\u30fc\u30b1\u30f3\u30b9\u751f\u6210</li> </ol>"},{"location":"clojure/part-2/#_3","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part III: \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0 \u3067\u306f\u3001\u4ee5\u4e0b\u3092\u5b66\u3073\u307e\u3059\uff1a</p> <ul> <li><code>nil</code> \u306e\u6271\u3044\u3068 <code>some?</code>/<code>nil?</code></li> <li><code>some-&gt;</code> \u3068 <code>some-&gt;&gt;</code> \u30de\u30af\u30ed</li> <li>\u7d50\u679c\u578b\u30d1\u30bf\u30fc\u30f3\uff08<code>:ok</code>/<code>:error</code>\uff09</li> <li><code>ex-info</code> \u3068\u4f8b\u5916\u51e6\u7406</li> </ul>"},{"location":"clojure/part-3/","title":"Part III: \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\uff08Clojure \u7248\uff09","text":"<p>\u672c\u7ae0\u3067\u306f\u3001Clojure \u306b\u304a\u3051\u308b\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3092\u5b66\u3073\u307e\u3059\u3002<code>nil</code> \u306e\u6271\u3044\u3001Result \u578b\u30d1\u30bf\u30fc\u30f3\u3001\u305d\u3057\u3066\u4ee3\u6570\u7684\u30c7\u30fc\u30bf\u578b\uff08ADT\uff09\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"clojure/part-3/#6-nil","title":"\u7b2c6\u7ae0: nil \u3068\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":""},{"location":"clojure/part-3/#61","title":"6.1 \u306a\u305c\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u304c\u5fc5\u8981\u304b","text":"<p>\u5f93\u6765\u306e\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u306b\u306f\u554f\u984c\u304c\u3042\u308a\u307e\u3059\u3002</p> <p></p>"},{"location":"clojure/part-3/#62-nil","title":"6.2 nil \u306e\u57fa\u672c","text":"<p>Clojure \u3067\u306f <code>nil</code> \u304c\u300c\u5024\u304c\u306a\u3044\u300d\u3053\u3068\u3092\u8868\u3057\u307e\u3059\u3002</p> <pre><code>;; nil \u30c1\u30a7\u30c3\u30af\n(some? 42)    ; =&gt; true\n(some? nil)   ; =&gt; false\n(nil? nil)    ; =&gt; true\n(nil? 42)     ; =&gt; false\n\n;; nil \u306f false \u6271\u3044\uff08falsy\uff09\n(if nil \"truthy\" \"falsy\")  ; =&gt; \"falsy\"\n(if 0 \"truthy\" \"falsy\")    ; =&gt; \"truthy\" (0 \u306f truthy)\n</code></pre>"},{"location":"clojure/part-3/#63","title":"6.3 \u5b89\u5168\u306a\u95a2\u6570","text":"<pre><code>;; \u5b89\u5168\u306a\u9664\u7b97\n(defn safe-divide [a b]\n  (when-not (zero? b)\n    (/ a b)))\n\n(safe-divide 10 2)  ; =&gt; 5\n(safe-divide 10 0)  ; =&gt; nil\n\n;; \u5b89\u5168\u306a\u5e73\u65b9\u6839\n(defn safe-sqrt [n]\n  (when (&gt;= n 0)\n    (Math/sqrt n)))\n\n(safe-sqrt 4)   ; =&gt; 2.0\n(safe-sqrt -1)  ; =&gt; nil\n</code></pre>"},{"location":"clojure/part-3/#64-some-some-","title":"6.4 some-&gt; \u3068 some-&gt;&gt; \u30de\u30af\u30ed","text":"<p><code>some-&gt;</code> \u306f\u9014\u4e2d\u3067 <code>nil</code> \u306b\u306a\u3063\u305f\u3089\u51e6\u7406\u3092\u4e2d\u65ad\u3057\u307e\u3059\u3002Scala \u306e <code>Option.flatMap</code> \u306e\u30c1\u30a7\u30fc\u30f3\u306b\u76f8\u5f53\u3057\u307e\u3059\u3002</p> <pre><code>;; some-&gt; : \u6700\u521d\u306e\u5f15\u6570\u4f4d\u7f6e\u306b\u633f\u5165\u3001nil \u3067\u4e2d\u65ad\n(some-&gt; {:user {:profile {:name \"Alice\"}}}\n        :user\n        :profile\n        :name)\n; =&gt; \"Alice\"\n\n(some-&gt; {:user {:profile {}}}\n        :user\n        :profile\n        :name)\n; =&gt; nil \uff08:name \u304c\u306a\u3044\u306e\u3067 nil\uff09\n\n;; some-&gt;&gt; : \u6700\u5f8c\u306e\u5f15\u6570\u4f4d\u7f6e\u306b\u633f\u5165\n(some-&gt;&gt; [1 -2 3 -4 5]\n         (filter pos?)\n         seq\n         (reduce +))\n; =&gt; 9\n</code></pre> <p></p>"},{"location":"clojure/part-3/#65-tv","title":"6.5 TV\u756a\u7d44\u30d1\u30fc\u30b9\u306e\u4f8b","text":"<p>TV\u756a\u7d44\u306e\u6587\u5b57\u5217\u3092\u30d1\u30fc\u30b9\u3059\u308b\u4f8b\u3067\u3001nil \u306e\u6271\u3044\u3092\u5b66\u3073\u307e\u3059\u3002</p> <pre><code>;; TV\u756a\u7d44\u306e\u30c7\u30fc\u30bf\u69cb\u9020\n(defn tv-show [title start end]\n  {:title title :start start :end end})\n\n;; \u6587\u5b57\u5217\u3092\u6574\u6570\u306b\u30d1\u30fc\u30b9\uff08\u5931\u6557\u6642\u306f nil\uff09\n(defn parse-int [s]\n  (try\n    (Integer/parseInt (clojure.string/trim s))\n    (catch Exception _ nil)))\n\n;; \u540d\u524d\u3092\u62bd\u51fa\n(defn extract-name [raw-show]\n  (when-let [bracket-open (.indexOf raw-show \"(\")]\n    (when (pos? bracket-open)\n      (clojure.string/trim (subs raw-show 0 bracket-open)))))\n\n(extract-name \"Breaking Bad (2008-2013)\")\n; =&gt; \"Breaking Bad\"\n\n(extract-name \"No Brackets\")\n; =&gt; nil\n</code></pre>"},{"location":"clojure/part-3/#66-when-let-if-let","title":"6.6 when-let \u3068 if-let","text":"<pre><code>;; when-let: \u5024\u304c\u3042\u308c\u3070\u51e6\u7406\n(defn greet-user [user]\n  (if-let [name (:name user)]\n    (str \"Hello, \" name \"!\")\n    \"Hello, Guest!\"))\n\n(greet-user {:name \"Alice\"})  ; =&gt; \"Hello, Alice!\"\n(greet-user {})               ; =&gt; \"Hello, Guest!\"\n\n;; when-let: \u6761\u4ef6\u3092\u6e80\u305f\u3059\u5834\u5408\u306e\u307f\u51e6\u7406\uff08else \u306a\u3057\uff09\n(defn process-order [order]\n  (when-let [items (:items order)]\n    (when (seq items)\n      {:order-id (:id order)\n       :total (reduce + (map :price items))})))\n</code></pre>"},{"location":"clojure/part-3/#67-tv","title":"6.7 TV\u756a\u7d44\u30d1\u30fc\u30b9\uff08\u5b8c\u5168\u7248\uff09","text":"<pre><code>;; \u958b\u59cb\u5e74\u3092\u62bd\u51fa\n(defn extract-year-start [raw-show]\n  (let [bracket-open (.indexOf raw-show \"(\")\n        dash (.indexOf raw-show \"-\")]\n    (when (and (&gt;= bracket-open 0) (&gt; dash (inc bracket-open)))\n      (parse-int (subs raw-show (inc bracket-open) dash)))))\n\n;; \u7d42\u4e86\u5e74\u3092\u62bd\u51fa\n(defn extract-year-end [raw-show]\n  (let [dash (.indexOf raw-show \"-\")\n        bracket-close (.indexOf raw-show \")\")]\n    (when (and (&gt;= dash 0) (&gt; bracket-close (inc dash)))\n      (parse-int (subs raw-show (inc dash) bracket-close)))))\n\n;; \u5358\u5e74\u3092\u62bd\u51fa\uff08\"Chernobyl (2019)\" \u5f62\u5f0f\uff09\n(defn extract-single-year [raw-show]\n  (let [dash (.indexOf raw-show \"-\")\n        bracket-open (.indexOf raw-show \"(\")\n        bracket-close (.indexOf raw-show \")\")]\n    (when (and (neg? dash) (&gt;= bracket-open 0) (&gt; bracket-close (inc bracket-open)))\n      (parse-int (subs raw-show (inc bracket-open) bracket-close)))))\n\n;; TV\u756a\u7d44\u30d1\u30fc\u30b9\n(defn parse-show [raw-show]\n  (when-let [name (extract-name raw-show)]\n    (when-let [year-start (or (extract-year-start raw-show)\n                              (extract-single-year raw-show))]\n      (when-let [year-end (or (extract-year-end raw-show)\n                              (extract-single-year raw-show))]\n        (tv-show name year-start year-end)))))\n\n(parse-show \"Breaking Bad (2008-2013)\")\n; =&gt; {:title \"Breaking Bad\", :start 2008, :end 2013}\n\n(parse-show \"Chernobyl (2019)\")\n; =&gt; {:title \"Chernobyl\", :start 2019, :end 2019}\n\n(parse-show \"Invalid\")\n; =&gt; nil\n</code></pre>"},{"location":"clojure/part-3/#68","title":"6.8 \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u6226\u7565","text":"<pre><code>;; Best-effort \u6226\u7565: \u30d1\u30fc\u30b9\u3067\u304d\u305f\u3082\u306e\u3060\u3051\u8fd4\u3059\n(defn parse-shows-best-effort [raw-shows]\n  (keep parse-show raw-shows))\n\n(parse-shows-best-effort [\"Breaking Bad (2008-2013)\"\n                          \"Invalid\"\n                          \"Chernobyl (2019)\"])\n; =&gt; ({:title \"Breaking Bad\", ...} {:title \"Chernobyl\", ...})\n\n;; All-or-nothing \u6226\u7565: \u5168\u90e8\u6210\u529f\u3059\u308b\u304b nil\n(defn parse-shows-all-or-nothing [raw-shows]\n  (let [parsed (map parse-show raw-shows)]\n    (when (every? some? parsed)\n      (vec parsed))))\n\n(parse-shows-all-or-nothing [\"Breaking Bad (2008-2013)\"\n                             \"Chernobyl (2019)\"])\n; =&gt; [{...} {...}]\n\n(parse-shows-all-or-nothing [\"Breaking Bad (2008-2013)\"\n                             \"Invalid\"])\n; =&gt; nil\n</code></pre>"},{"location":"clojure/part-3/#69-fnil-nil","title":"6.9 fnil - nil \u306b\u5bfe\u3059\u308b\u30c7\u30d5\u30a9\u30eb\u30c8\u5024","text":"<pre><code>;; fnil: nil \u3092\u6307\u5b9a\u5024\u3068\u3057\u3066\u6271\u3046\u95a2\u6570\u3092\u4f5c\u6210\n(def safe-inc (fnil inc 0))\n\n(safe-inc 5)    ; =&gt; 6\n(safe-inc nil)  ; =&gt; 1\n\n;; \u51fa\u73fe\u56de\u6570\u30ab\u30a6\u30f3\u30c8\u306b\u6d3b\u7528\n(defn count-occurrences [coll]\n  (reduce (fn [acc item]\n            (update acc item (fnil inc 0)))\n          {}\n          coll))\n\n(count-occurrences [:a :b :b :c :a :b])\n; =&gt; {:a 2, :b 3, :c 1}\n</code></pre>"},{"location":"clojure/part-3/#7-result-adt","title":"\u7b2c7\u7ae0: Result \u578b\u30d1\u30bf\u30fc\u30f3\u3068 ADT","text":""},{"location":"clojure/part-3/#71-nil","title":"7.1 nil \u306e\u9650\u754c","text":"<p><code>nil</code> \u306f\u300c\u5024\u304c\u306a\u3044\u3053\u3068\u300d\u3057\u304b\u8868\u73fe\u3067\u304d\u307e\u305b\u3093\u3002\u306a\u305c\u5931\u6557\u3057\u305f\u306e\u304b\u3092\u4f1d\u3048\u3089\u308c\u307e\u305b\u3093\u3002</p> <p></p>"},{"location":"clojure/part-3/#72-result","title":"7.2 Result \u578b\u30d1\u30bf\u30fc\u30f3","text":"<p>Clojure \u3067\u306f Either \u306e\u4ee3\u308f\u308a\u306b <code>:ok/:error</code> \u306e\u30de\u30c3\u30d7\u3092\u4f7f\u3046\u306e\u304c\u4e00\u822c\u7684\u3067\u3059\u3002</p> <pre><code>;; Result \u4f5c\u6210\u95a2\u6570\n(defn ok [value]\n  {:status :ok :value value})\n\n(defn error [message]\n  {:status :error :error message})\n\n;; \u30c1\u30a7\u30c3\u30af\u95a2\u6570\n(defn ok? [result]\n  (= (:status result) :ok))\n\n(defn error? [result]\n  (= (:status result) :error))\n\n;; \u4f7f\u7528\u4f8b\n(ok 42)           ; =&gt; {:status :ok, :value 42}\n(error \"Failed\")  ; =&gt; {:status :error, :error \"Failed\"}\n</code></pre>"},{"location":"clojure/part-3/#73-result","title":"7.3 Result \u306e\u64cd\u4f5c","text":"<pre><code>;; map: \u6210\u529f\u6642\u306e\u307f\u5024\u3092\u5909\u63db\n(defn result-map [f result]\n  (if (ok? result)\n    (ok (f (:value result)))\n    result))\n\n(result-map #(* % 2) (ok 5))      ; =&gt; {:status :ok, :value 10}\n(result-map #(* % 2) (error \"e\")) ; =&gt; {:status :error, :error \"e\"}\n\n;; flatmap: Result \u3092\u8fd4\u3059\u95a2\u6570\u3092\u9069\u7528\n(defn result-flatmap [f result]\n  (if (ok? result)\n    (f (:value result))\n    result))\n\n;; or-else: \u30a8\u30e9\u30fc\u6642\u306b\u4ee3\u66ff\u3092\u4f7f\u7528\n(defn result-or-else [result alternative]\n  (if (ok? result)\n    result\n    alternative))\n\n;; get-or-else: \u5024\u3092\u53d6\u5f97\u3001\u30a8\u30e9\u30fc\u6642\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\n(defn result-get-or-else [result default]\n  (if (ok? result)\n    (:value result)\n    default))\n</code></pre>"},{"location":"clojure/part-3/#74-tvresult","title":"7.4 TV\u756a\u7d44\u30d1\u30fc\u30b9\uff08Result \u7248\uff09","text":"<pre><code>(defn parse-int-result [s]\n  (try\n    (ok (Integer/parseInt (clojure.string/trim s)))\n    (catch Exception _\n      (error (str \"Cannot parse '\" s \"' as integer\")))))\n\n(defn extract-name-result [raw-show]\n  (if-let [bracket-open (.indexOf raw-show \"(\")]\n    (if (pos? bracket-open)\n      (ok (clojure.string/trim (subs raw-show 0 bracket-open)))\n      (error (str \"Can't extract name from \" raw-show)))\n    (error (str \"Can't extract name from \" raw-show))))\n\n(extract-name-result \"The Wire (2002-2008)\")\n; =&gt; {:status :ok, :value \"The Wire\"}\n\n(extract-name-result \"(2022)\")\n; =&gt; {:status :error, :error \"Can't extract name from (2022)\"}\n</code></pre>"},{"location":"clojure/part-3/#75-adt","title":"7.5 \u4ee3\u6570\u7684\u30c7\u30fc\u30bf\u578b\uff08ADT\uff09","text":"<p>Clojure \u3067\u306f\u30de\u30c3\u30d7 + <code>:type</code> \u30bf\u30b0\u3067 ADT \u3092\u8868\u73fe\u3057\u307e\u3059\u3002</p>"},{"location":"clojure/part-3/#sum-type","title":"\u76f4\u548c\u578b\uff08Sum Type\uff09","text":"<pre><code>;; \u6d3b\u52d5\u671f\u9593\u3092\u8868\u3059\u76f4\u548c\u578b\n(defn still-active [since]\n  {:type :still-active :since since})\n\n(defn active-between [start end]\n  {:type :active-between :start start :end end})\n\n;; \u4f7f\u7528\u4f8b\n(still-active 1981)\n; =&gt; {:type :still-active, :since 1981}\n\n(active-between 1968 1980)\n; =&gt; {:type :active-between, :start 1968, :end 1980}\n</code></pre>"},{"location":"clojure/part-3/#product-type","title":"\u76f4\u7a4d\u578b\uff08Product Type\uff09","text":"<pre><code>;; \u30a2\u30fc\u30c6\u30a3\u30b9\u30c8\u3092\u8868\u3059\u76f4\u7a4d\u578b\n(defn artist [name genre origin years-active]\n  {:name name\n   :genre genre\n   :origin origin\n   :years-active years-active})\n\n(def metallica\n  (artist \"Metallica\" :heavy-metal \"U.S.\" (still-active 1981)))\n\n(def led-zeppelin\n  (artist \"Led Zeppelin\" :hard-rock \"England\" (active-between 1968 1980)))\n</code></pre>"},{"location":"clojure/part-3/#76","title":"7.6 \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0","text":"<p><code>case</code> \u3092\u4f7f\u3063\u3066\u76f4\u548c\u578b\u3092\u51e6\u7406\u3057\u307e\u3059\u3002</p> <pre><code>(defn was-artist-active? [artist year-start year-end]\n  (let [years (:years-active artist)]\n    (case (:type years)\n      :still-active (&lt;= (:since years) year-end)\n      :active-between (and (&lt;= (:start years) year-end)\n                           (&gt;= (:end years) year-start)))))\n\n(was-artist-active? metallica 1990 2000)    ; =&gt; true\n(was-artist-active? led-zeppelin 1990 2000) ; =&gt; false\n\n(defn active-length [artist current-year]\n  (let [years (:years-active artist)]\n    (case (:type years)\n      :still-active (- current-year (:since years))\n      :active-between (- (:end years) (:start years)))))\n\n(active-length metallica 2024)     ; =&gt; 43\n(active-length led-zeppelin 2024)  ; =&gt; 12\n</code></pre>"},{"location":"clojure/part-3/#77","title":"7.7 \u691c\u7d22\u6761\u4ef6\u306e\u30e2\u30c7\u30ea\u30f3\u30b0","text":"<pre><code>;; \u691c\u7d22\u6761\u4ef6\uff08\u76f4\u548c\u578b\uff09\n(defn search-by-genre [genres]\n  {:type :by-genre :genres (set genres)})\n\n(defn search-by-origin [locations]\n  {:type :by-origin :locations (set locations)})\n\n(defn search-by-active-years [start end]\n  {:type :by-active-years :start start :end end})\n\n;; \u6761\u4ef6\u30de\u30c3\u30c1\u30f3\u30b0\n(defn matches-condition? [artist condition]\n  (case (:type condition)\n    :by-genre (contains? (:genres condition) (:genre artist))\n    :by-origin (contains? (:locations condition) (:origin artist))\n    :by-active-years (was-artist-active? artist\n                                         (:start condition)\n                                         (:end condition))))\n\n;; \u691c\u7d22\n(defn search-artists [artists conditions]\n  (filter (fn [artist]\n            (every? #(matches-condition? artist %) conditions))\n          artists))\n\n(search-artists sample-artists\n                [(search-by-genre [:heavy-metal])\n                 (search-by-origin [\"U.S.\"])])\n; =&gt; [{:name \"Metallica\", ...}]\n</code></pre>"},{"location":"clojure/part-3/#78","title":"7.8 \u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3","text":"<pre><code>(defn validate-not-empty [field-name value]\n  (if (and value (not (clojure.string/blank? value)))\n    (ok value)\n    (error (str field-name \" cannot be empty\"))))\n\n(defn validate-email [email]\n  (if (re-matches #\".+@.+\\..+\" email)\n    (ok email)\n    (error \"Invalid email format\")))\n\n(defn validate-age [age]\n  (cond\n    (not (integer? age)) (error \"Age must be an integer\")\n    (neg? age) (error \"Age cannot be negative\")\n    (&gt; age 150) (error \"Age seems unrealistic\")\n    :else (ok age)))\n\n(defn validate-user [user]\n  (let [name-result (validate-not-empty \"Name\" (:name user))\n        email-result (validate-email (or (:email user) \"\"))\n        age-result (validate-age (:age user))]\n    (if (and (ok? name-result) (ok? email-result) (ok? age-result))\n      (ok user)\n      (error {:errors (remove nil?\n                        [(when (error? name-result) (:error name-result))\n                         (when (error? email-result) (:error email-result))\n                         (when (error? age-result) (:error age-result))])}))))\n\n(validate-user {:name \"Alice\" :email \"alice@example.com\" :age 30})\n; =&gt; {:status :ok, :value {...}}\n\n(validate-user {:name \"\" :email \"invalid\" :age -1})\n; =&gt; {:status :error, :error {:errors [\"Name cannot be empty\" \"Invalid email format\" \"Age cannot be negative\"]}}\n</code></pre>"},{"location":"clojure/part-3/#79-every-some","title":"7.9 every? \u3068 some","text":"<pre><code>;; every?: \u3059\u3079\u3066\u304c\u6761\u4ef6\u3092\u6e80\u305f\u3059\n(every? pos? [1 2 3 4 5])  ; =&gt; true\n(every? pos? [1 -2 3])     ; =&gt; false\n\n;; some: \u3044\u305a\u308c\u304b\u304c\u6761\u4ef6\u3092\u6e80\u305f\u3059\uff08\u6700\u521d\u306e\u30de\u30c3\u30c1\u3092\u8fd4\u3059\uff09\n(some neg? [1 2 -3 4])     ; =&gt; true (-3 \u304c\u30de\u30c3\u30c1)\n(some neg? [1 2 3])        ; =&gt; nil\n\n;; not-any?: \u3069\u308c\u3082\u6761\u4ef6\u3092\u6e80\u305f\u3055\u306a\u3044\n(not-any? neg? [1 2 3])    ; =&gt; true\n\n;; not-every?: \u3059\u3079\u3066\u304c\u6761\u4ef6\u3092\u6e80\u305f\u3059\u308f\u3051\u3067\u306f\u306a\u3044\n(not-every? pos? [1 -2 3]) ; =&gt; true\n</code></pre>"},{"location":"clojure/part-3/#710-ex-info","title":"7.10 ex-info \u306b\u3088\u308b\u4f8b\u5916\u51e6\u7406","text":"<pre><code>;; ex-info: \u30c7\u30fc\u30bf\u4ed8\u304d\u4f8b\u5916\u3092\u4f5c\u6210\n(defn divide-or-throw [a b]\n  (if (zero? b)\n    (throw (ex-info \"Division by zero\" {:a a :b b}))\n    (/ a b)))\n\n;; Result \u306b\u5909\u63db\n(defn try-result [f]\n  (try\n    (ok (f))\n    (catch Exception e\n      (error {:message (ex-message e)\n              :data (ex-data e)}))))\n\n(try-result #(divide-or-throw 10 2))\n; =&gt; {:status :ok, :value 5}\n\n(try-result #(divide-or-throw 10 0))\n; =&gt; {:status :error, :error {:message \"Division by zero\", :data {:a 10, :b 0}}}\n</code></pre>"},{"location":"clojure/part-3/#_1","title":"\u307e\u3068\u3081","text":""},{"location":"clojure/part-3/#part-iii","title":"Part III \u3067\u5b66\u3093\u3060\u3053\u3068","text":"\u7ae0 \u4e3b\u8981\u6982\u5ff5 \u30ad\u30fc\u64cd\u4f5c \u7b2c6\u7ae0 nil \u306e\u6271\u3044 <code>some?</code>, <code>nil?</code>, <code>some-&gt;</code>, <code>when-let</code> \u7b2c7\u7ae0 Result \u30d1\u30bf\u30fc\u30f3 <code>ok</code>, <code>error</code>, <code>case</code>, ADT"},{"location":"clojure/part-3/#scala","title":"Scala \u3068\u306e\u6bd4\u8f03","text":"\u6982\u5ff5 Scala Clojure \u5024\u306e\u6709\u7121 <code>Option[A]</code> <code>nil</code> / \u5024 \u6210\u529f/\u5931\u6557 <code>Either[E, A]</code> <code>{:status :ok/:error ...}</code> \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1 <code>match</code> <code>case</code>, <code>cond</code> \u30c1\u30a7\u30fc\u30f3 <code>flatMap</code> <code>some-&gt;</code>, <code>some-&gt;&gt;</code> \u30c7\u30d5\u30a9\u30eb\u30c8\u5024 <code>getOrElse</code> <code>or</code>, <code>get</code>, <code>fnil</code>"},{"location":"clojure/part-3/#_2","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>nil \u306e\u660e\u793a\u7684\u306a\u6271\u3044: <code>some?</code>, <code>nil?</code> \u3067\u30c1\u30a7\u30c3\u30af</li> <li>some-&gt; \u30de\u30af\u30ed: nil \u3067\u4e2d\u65ad\u3059\u308b\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3</li> <li>Result \u30d1\u30bf\u30fc\u30f3: \u30a8\u30e9\u30fc\u60c5\u5831\u3092\u4fdd\u6301\u3059\u308b <code>:ok/:error</code> \u30de\u30c3\u30d7</li> <li>ADT: <code>:type</code> \u30bf\u30b0\u3067\u76f4\u548c\u578b\u3092\u8868\u73fe</li> <li>case \u306b\u3088\u308b\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1: \u76f4\u548c\u578b\u3092\u5b89\u5168\u306b\u51e6\u7406</li> </ol>"},{"location":"clojure/part-3/#_3","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part IV: \u526f\u4f5c\u7528\u306e\u7ba1\u7406 \u3067\u306f\u3001\u4ee5\u4e0b\u3092\u5b66\u3073\u307e\u3059\uff1a</p> <ul> <li>atom \u3068 ref \u306b\u3088\u308b\u72b6\u614b\u7ba1\u7406</li> <li>STM\uff08Software Transactional Memory\uff09</li> <li>core.async \u306b\u3088\u308b\u975e\u540c\u671f\u51e6\u7406</li> </ul>"},{"location":"clojure/part-4/","title":"Part IV: \u72b6\u614b\u7ba1\u7406\u3068\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406\uff08Clojure \u7248\uff09","text":"<p>\u672c\u7ae0\u3067\u306f\u3001Clojure \u306b\u304a\u3051\u308b\u526f\u4f5c\u7528\u306e\u6271\u3044\u65b9\u3092\u5b66\u3073\u307e\u3059\u3002atom \u306b\u3088\u308b\u72b6\u614b\u7ba1\u7406\u3001\u9045\u5ef6\u8a55\u4fa1\u3001\u975e\u540c\u671f\u51e6\u7406\u3001\u305d\u3057\u3066\u9045\u5ef6\u30b7\u30fc\u30b1\u30f3\u30b9\u3068\u30c8\u30e9\u30f3\u30b9\u30c7\u30e5\u30fc\u30b5\u30fc\u306b\u3088\u308b\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"clojure/part-4/#8","title":"\u7b2c8\u7ae0: \u72b6\u614b\u7ba1\u7406\u3068\u526f\u4f5c\u7528","text":""},{"location":"clojure/part-4/#81","title":"8.1 \u526f\u4f5c\u7528\u306e\u554f\u984c","text":"<p>\u7d14\u7c8b\u95a2\u6570\u306f\u526f\u4f5c\u7528\u3092\u6301\u3061\u307e\u305b\u3093\u3002\u3057\u304b\u3057\u3001\u5b9f\u969b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u306b\u306f\u526f\u4f5c\u7528\u304c\u5fc5\u8981\u3067\u3059:</p> <ul> <li>\u72b6\u614b\u306e\u5909\u66f4</li> <li>\u30d5\u30a1\u30a4\u30eb\u306e\u8aad\u307f\u66f8\u304d</li> <li>\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u901a\u4fe1</li> <li>\u4e71\u6570\u751f\u6210</li> <li>\u73fe\u5728\u6642\u523b\u306e\u53d6\u5f97</li> </ul> <p></p>"},{"location":"clojure/part-4/#82-clojure","title":"8.2 Clojure \u306e\u526f\u4f5c\u7528\u7ba1\u7406","text":"<p>Clojure \u306b\u306f\u526f\u4f5c\u7528\u3092\u7ba1\u7406\u3059\u308b\u305f\u3081\u306e\u8907\u6570\u306e\u30e1\u30ab\u30cb\u30ba\u30e0\u304c\u3042\u308a\u307e\u3059\u3002</p> <p></p>"},{"location":"clojure/part-4/#83","title":"8.3 \u30b5\u30a4\u30b3\u30ed\u3092\u632f\u308b\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/clojure/src/ch08/state_management.clj</code></p>"},{"location":"clojure/part-4/#_1","title":"\u4e0d\u7d14\u306a\u95a2\u6570\uff08\u526f\u4f5c\u7528\u3042\u308a\uff09","text":"<pre><code>(defn cast-the-die-impure!\n  \"\u30b5\u30a4\u30b3\u30ed\u3092\u632f\u308b\uff08\u4e0d\u7d14\uff09\"\n  []\n  (inc (rand-int 6)))\n\n;; \u547c\u3073\u51fa\u3059\u305f\u3073\u306b\u7570\u306a\u308b\u5024\u304c\u8fd4\u308b\n(cast-the-die-impure!) ; =&gt; 3\n(cast-the-die-impure!) ; =&gt; 5\n(cast-the-die-impure!) ; =&gt; 1\n</code></pre>"},{"location":"clojure/part-4/#delay","title":"delay \u3092\u4f7f\u3063\u305f\u9045\u5ef6\u8a55\u4fa1","text":"<pre><code>(defn cast-the-die\n  \"\u30b5\u30a4\u30b3\u30ed\u3092\u632f\u308b\uff08\u9045\u5ef6\uff09\"\n  []\n  (delay (cast-the-die-impure!)))\n\n;; delay \u3092\u4f5c\u6210\u3057\u305f\u3060\u3051\u3067\u306f\u5b9f\u884c\u3055\u308c\u306a\u3044\n(def die-cast (cast-the-die))\ndie-cast ; =&gt; #&lt;Delay@...&gt;\n\n;; force \u3067\u5b9f\u884c\n(force die-cast) ; =&gt; 4\n</code></pre> <p>\u6ce8\u610f: <code>delay</code> \u306f\u4e00\u5ea6\u3060\u3051\u8a55\u4fa1\u3055\u308c\u3001\u7d50\u679c\u304c\u30ad\u30e3\u30c3\u30b7\u30e5\u3055\u308c\u307e\u3059\u3002\u6bce\u56de\u5b9f\u884c\u3059\u308b\u306b\u306f\u65b0\u3057\u3044 <code>delay</code> \u3092\u4f5c\u6210\u3059\u308b\u304b\u3001\u95a2\u6570\u3067\u30e9\u30c3\u30d7\u3057\u307e\u3059\u3002</p>"},{"location":"clojure/part-4/#84-atom","title":"8.4 atom \u306b\u3088\u308b\u72b6\u614b\u7ba1\u7406","text":"<p>atom \u306f Clojure \u306e\u6700\u3082\u57fa\u672c\u7684\u306a\u72b6\u614b\u7ba1\u7406\u30d7\u30ea\u30df\u30c6\u30a3\u30d6\u3067\u3059\u3002Scala \u306e <code>Ref</code> \u306b\u76f8\u5f53\u3057\u307e\u3059\u3002</p> <p></p> <pre><code>;; atom \u3092\u4f5c\u6210\n(def counter (atom 0))\n\n;; \u5024\u3092\u8aad\u307f\u53d6\u308a\n@counter            ; =&gt; 0\n(deref counter)     ; =&gt; 0\n\n;; swap! \u3067\u95a2\u6570\u3092\u9069\u7528\u3057\u3066\u66f4\u65b0\n(swap! counter inc) ; =&gt; 1\n(swap! counter + 5) ; =&gt; 6\n\n;; reset! \u3067\u5024\u3092\u76f4\u63a5\u8a2d\u5b9a\n(reset! counter 0)  ; =&gt; 0\n</code></pre>"},{"location":"clojure/part-4/#85-atom","title":"8.5 atom \u306e\u9ad8\u5ea6\u306a\u64cd\u4f5c","text":"<pre><code>;; compare-and-set! \u306f\u671f\u5f85\u5024\u3068\u4e00\u81f4\u3059\u308b\u5834\u5408\u306e\u307f\u66f4\u65b0\n(def a (atom 5))\n(compare-and-set! a 5 10) ; =&gt; true, @a = 10\n(compare-and-set! a 5 20) ; =&gt; false, @a = 10\uff08\u5909\u66f4\u3055\u308c\u306a\u3044\uff09\n\n;; \u8907\u6570\u306e\u5024\u3092\u6301\u3064 atom\n(def game-state (atom {:rolls [] :total 0}))\n\n(defn roll-die!\n  \"\u30b5\u30a4\u30b3\u30ed\u3092\u632f\u3063\u3066\u72b6\u614b\u3092\u66f4\u65b0\"\n  []\n  (let [roll (cast-the-die-impure!)]\n    (swap! game-state\n           (fn [state]\n             (-&gt; state\n                 (update :rolls conj roll)\n                 (update :total + roll))))\n    roll))\n</code></pre>"},{"location":"clojure/part-4/#86-future","title":"8.6 future \u306b\u3088\u308b\u975e\u540c\u671f\u51e6\u7406","text":"<p>future \u306f\u5225\u30b9\u30ec\u30c3\u30c9\u3067\u8a08\u7b97\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002</p> <pre><code>;; future \u3092\u4f5c\u6210\n(def f (future\n         (Thread/sleep 1000)\n         (+ 1 2)))\n\n;; deref \u3067\u7d50\u679c\u3092\u53d6\u5f97\uff08\u5b8c\u4e86\u307e\u3067\u5f85\u6a5f\uff09\n@f ; =&gt; 3\n\n;; \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u4ed8\u304d\u3067\u53d6\u5f97\n(deref f 500 :timeout) ; =&gt; :timeout \u307e\u305f\u306f\u7d50\u679c\n</code></pre>"},{"location":"clojure/part-4/#api","title":"\u4e26\u5217 API \u547c\u3073\u51fa\u3057","text":"<pre><code>(defn async-api-call\n  \"\u975e\u540c\u671f API \u547c\u3073\u51fa\u3057\u3092\u30b7\u30df\u30e5\u30ec\u30fc\u30c8\"\n  [name delay-ms]\n  (future\n    (Thread/sleep delay-ms)\n    {:name name :result (str \"Result for \" name)}))\n\n(defn parallel-api-calls\n  \"\u4e26\u5217\u3067 API \u3092\u547c\u3073\u51fa\u3059\"\n  [names]\n  (let [futures (mapv #(async-api-call % 100) names)]\n    (mapv deref futures)))\n\n(parallel-api-calls [\"a\" \"b\" \"c\"])\n; =&gt; [{:name \"a\" ...} {:name \"b\" ...} {:name \"c\" ...}]\n</code></pre>"},{"location":"clojure/part-4/#87-promise","title":"8.7 promise \u306b\u3088\u308b\u540c\u671f","text":"<p>promise \u306f\u4e00\u5ea6\u3060\u3051\u5024\u3092\u8a2d\u5b9a\u3067\u304d\u308b\u30b3\u30f3\u30c6\u30ca\u3067\u3059\u3002</p> <pre><code>;; promise \u3092\u4f5c\u6210\n(def p (promise))\n\n;; \u5024\u3092\u8a2d\u5b9a\n(deliver p 42)\n\n;; \u5024\u3092\u53d6\u5f97\n@p ; =&gt; 42\n\n;; \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u4ed8\u304d\n(deref p 100 :default) ; =&gt; 42 \u307e\u305f\u306f :default\n</code></pre>"},{"location":"clojure/part-4/#88","title":"8.8 \u30df\u30fc\u30c6\u30a3\u30f3\u30b0\u30b9\u30b1\u30b8\u30e5\u30fc\u30ea\u30f3\u30b0\u306e\u4f8b","text":"<pre><code>(defn meeting-time [start-hour end-hour]\n  {:start-hour start-hour :end-hour end-hour})\n\n(defn meetings-overlap?\n  \"2\u3064\u306e\u30df\u30fc\u30c6\u30a3\u30f3\u30b0\u304c\u91cd\u8907\u3059\u308b\u304b\"\n  [m1 m2]\n  (not (or (&gt;= (:start-hour m1) (:end-hour m2))\n           (&gt;= (:start-hour m2) (:end-hour m1)))))\n\n(defn possible-meetings\n  \"\u7a7a\u304d\u6642\u9593\u3092\u8a08\u7b97\uff08\u7d14\u7c8b\u95a2\u6570\uff09\"\n  [existing-meetings start-hour end-hour length-hours]\n  (let [slots (for [start (range start-hour (- end-hour length-hours -1))]\n                (meeting-time start (+ start length-hours)))]\n    (filter (fn [slot]\n              (not-any? #(meetings-overlap? % slot) existing-meetings))\n            slots)))\n</code></pre>"},{"location":"clojure/part-4/#89","title":"8.9 \u30ea\u30c8\u30e9\u30a4\u6226\u7565","text":"<pre><code>(defn retry\n  \"\u30a2\u30af\u30b7\u30e7\u30f3\u3092 n \u56de\u30ea\u30c8\u30e9\u30a4\"\n  [action max-retries]\n  (loop [attempts 0]\n    (let [result (try\n                   {:ok (action)}\n                   (catch Exception e\n                     {:error (.getMessage e)}))]\n      (if (or (:ok result) (&gt;= attempts max-retries))\n        result\n        (recur (inc attempts))))))\n\n(defn retry-with-delay\n  \"\u9045\u5ef6\u4ed8\u304d\u3067\u30ea\u30c8\u30e9\u30a4\"\n  [action max-retries delay-ms]\n  (loop [attempts 0]\n    (let [result (try\n                   {:ok (action)}\n                   (catch Exception e\n                     {:error (.getMessage e)}))]\n      (if (or (:ok result) (&gt;= attempts max-retries))\n        result\n        (do\n          (Thread/sleep delay-ms)\n          (recur (inc attempts)))))))\n</code></pre>"},{"location":"clojure/part-4/#810","title":"8.10 \u526f\u4f5c\u7528\u306e\u5206\u96e2\u30d1\u30bf\u30fc\u30f3","text":"<pre><code>;; \u7d14\u7c8b\u306a\u30b3\u30a2\u30ed\u30b8\u30c3\u30af\n(defn calculate-discount [price discount-rate]\n  (* price (- 1 discount-rate)))\n\n(defn calculate-total [items]\n  (reduce + (map :price items)))\n\n;; \u526f\u4f5c\u7528\u3092\u6301\u3064\u30b7\u30a7\u30eb\n(def order-db (atom {}))\n\n(defn save-order! [order-id order]\n  (swap! order-db assoc order-id order)\n  order-id)\n\n;; \u526f\u4f5c\u7528\u3092\u5206\u96e2\u3057\u305f\u51e6\u7406\n(defn process-order! [order-id items discount-rate]\n  (let [subtotal (calculate-total items)          ; \u7d14\u7c8b\n        total (calculate-discount subtotal discount-rate)]  ; \u7d14\u7c8b\n    (save-order! order-id {:items items          ; \u526f\u4f5c\u7528\n                           :subtotal subtotal\n                           :total total})))\n</code></pre>"},{"location":"clojure/part-4/#9","title":"\u7b2c9\u7ae0: \u9045\u5ef6\u30b7\u30fc\u30b1\u30f3\u30b9\u3068\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406","text":""},{"location":"clojure/part-4/#91","title":"9.1 \u9045\u5ef6\u30b7\u30fc\u30b1\u30f3\u30b9\u3068\u306f","text":"<p>Clojure \u306e\u30b7\u30fc\u30b1\u30f3\u30b9\u306f\u9045\u5ef6\u8a55\u4fa1\u3055\u308c\u307e\u3059\u3002\u8981\u7d20\u306f\u5fc5\u8981\u306b\u306a\u308b\u307e\u3067\u8a08\u7b97\u3055\u308c\u307e\u305b\u3093\u3002</p> <p></p>"},{"location":"clojure/part-4/#92-lazy-seq","title":"9.2 lazy-seq \u306b\u3088\u308b\u9045\u5ef6\u30b7\u30fc\u30b1\u30f3\u30b9","text":"<pre><code>(defn lazy-range\n  \"\u9045\u5ef6\u7bc4\u56f2\u30b7\u30fc\u30b1\u30f3\u30b9\"\n  [start end]\n  (lazy-seq\n   (when (&lt; start end)\n     (cons start (lazy-range (inc start) end)))))\n\n;; range \u306f\u9045\u5ef6\u30b7\u30fc\u30b1\u30f3\u30b9\n(def numbers (range 1 11))\n;; \u307e\u3060\u8a55\u4fa1\u3055\u308c\u3066\u3044\u306a\u3044\n\n;; take \u3067\u5fc5\u8981\u306a\u5206\u3060\u3051\u53d6\u5f97\n(take 3 numbers)  ; =&gt; (1 2 3)\n</code></pre>"},{"location":"clojure/part-4/#93","title":"9.3 \u7121\u9650\u30b7\u30fc\u30b1\u30f3\u30b9","text":"<p>Clojure \u306b\u306f\u7121\u9650\u30b7\u30fc\u30b1\u30f3\u30b9\u3092\u751f\u6210\u3059\u308b\u95a2\u6570\u304c\u3042\u308a\u307e\u3059\u3002</p> \u95a2\u6570 \u8aac\u660e \u4f8b <code>repeat</code> \u540c\u3058\u5024\u3092\u7121\u9650\u306b\u7e70\u308a\u8fd4\u3059 <code>(take 5 (repeat 1))</code> =&gt; <code>(1 1 1 1 1)</code> <code>iterate</code> \u95a2\u6570\u3092\u7e70\u308a\u8fd4\u3057\u9069\u7528 <code>(take 5 (iterate inc 0))</code> =&gt; <code>(0 1 2 3 4)</code> <code>cycle</code> \u30b7\u30fc\u30b1\u30f3\u30b9\u3092\u7121\u9650\u306b\u7e70\u308a\u8fd4\u3059 <code>(take 5 (cycle [1 2]))</code> =&gt; <code>(1 2 1 2 1)</code> <code>repeatedly</code> \u95a2\u6570\u3092\u7121\u9650\u306b\u547c\u3073\u51fa\u3059 <code>(take 3 (repeatedly rand))</code> <pre><code>;; 2\u306e\u3079\u304d\u4e57\n(def powers-of-2 (iterate #(* 2 %) 1))\n(take 10 powers-of-2)\n; =&gt; (1 2 4 8 16 32 64 128 256 512)\n\n;; \u7121\u9650\u306e\u30b5\u30a4\u30b3\u30ed\n(def infinite-die-rolls (repeatedly #(inc (rand-int 6))))\n(take 5 infinite-die-rolls) ; =&gt; (3 1 5 2 4)\n</code></pre>"},{"location":"clojure/part-4/#94","title":"9.4 \u9045\u5ef6\u30b7\u30fc\u30b1\u30f3\u30b9\u306e\u64cd\u4f5c","text":"<pre><code>(defn process-stream\n  \"\u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u51e6\u7406\"\n  [stream]\n  (-&gt;&gt; stream\n       (filter odd?)\n       (map #(* % %))\n       (take 5)))\n\n(process-stream (range))\n; =&gt; (1 9 25 49 81)\n\n;; take-while: \u6761\u4ef6\u3092\u6e80\u305f\u3059\u9593\u53d6\u5f97\n(take-while pos? [1 2 3 -1 4 5])\n; =&gt; (1 2 3)\n\n;; drop-while: \u6761\u4ef6\u3092\u6e80\u305f\u3059\u9593\u30b9\u30ad\u30c3\u30d7\n(drop-while #(&lt; % 5) [1 2 3 4 5 6 7])\n; =&gt; (5 6 7)\n</code></pre>"},{"location":"clojure/part-4/#95","title":"9.5 \u30b9\u30e9\u30a4\u30c7\u30a3\u30f3\u30b0\u30a6\u30a3\u30f3\u30c9\u30a6","text":"<pre><code>;; partition: \u6307\u5b9a\u30b5\u30a4\u30ba\u3067\u5206\u5272\n(partition 3 (range 10))\n; =&gt; ((0 1 2) (3 4 5) (6 7 8))\n\n;; partition-all: \u7aef\u6570\u3082\u542b\u3081\u308b\n(partition-all 3 (range 10))\n; =&gt; ((0 1 2) (3 4 5) (6 7 8) (9))\n\n;; partition with step: \u30b9\u30e9\u30a4\u30c7\u30a3\u30f3\u30b0\u30a6\u30a3\u30f3\u30c9\u30a6\n(defn sliding-window [n coll]\n  (partition n 1 coll))\n\n(sliding-window 3 [1 2 3 4 5])\n; =&gt; ((1 2 3) (2 3 4) (3 4 5))\n</code></pre>"},{"location":"clojure/part-4/#96","title":"9.6 \u30c8\u30ec\u30f3\u30c9\u691c\u51fa","text":"<p>\u70ba\u66ff\u30ec\u30fc\u30c8\u306e\u4e0a\u6607\u30fb\u4e0b\u964d\u30c8\u30ec\u30f3\u30c9\u3092\u691c\u51fa\u3057\u307e\u3059\u3002</p> <pre><code>(defn trending?\n  \"\u4e0a\u6607\u30c8\u30ec\u30f3\u30c9\u304b\u3069\u3046\u304b\"\n  [rates]\n  (and (&gt; (count rates) 1)\n       (every? (fn [[prev curr]] (&lt; prev curr))\n               (partition 2 1 rates))))\n\n(trending? [0.81 0.82 0.83])  ; =&gt; true\n(trending? [0.81 0.84 0.83])  ; =&gt; false\n\n(defn declining?\n  \"\u4e0b\u964d\u30c8\u30ec\u30f3\u30c9\u304b\u3069\u3046\u304b\"\n  [rates]\n  (and (&gt; (count rates) 1)\n       (every? (fn [[prev curr]] (&gt; prev curr))\n               (partition 2 1 rates))))\n\n(defn find-trend\n  \"\u30c8\u30ec\u30f3\u30c9\u3092\u691c\u51fa\"\n  [window-size stream]\n  (-&gt;&gt; stream\n       (sliding-window window-size)\n       (map (fn [window]\n              {:rates (vec window)\n               :trending? (trending? window)\n               :declining? (declining? window)}))))\n</code></pre>"},{"location":"clojure/part-4/#97-reductions","title":"9.7 reductions\uff08\u30b9\u30ad\u30e3\u30f3\u64cd\u4f5c\uff09","text":"<p><code>reductions</code> \u306f <code>reduce</code> \u306e\u4e2d\u9593\u7d50\u679c\u3092\u3059\u3079\u3066\u8fd4\u3057\u307e\u3059\u3002Scala \u306e <code>scanLeft</code> \u306b\u76f8\u5f53\u3057\u307e\u3059\u3002</p> <pre><code>;; \u7d2f\u7a4d\u548c\n(reductions + (range 1 6))\n; =&gt; (1 3 6 10 15)\n\n;; \u79fb\u52d5\u5e73\u5747\n(defn moving-average [window-size coll]\n  (-&gt;&gt; coll\n       (sliding-window window-size)\n       (map #(/ (reduce + %) (count %)))))\n\n(moving-average 3 [1 2 3 4 5 6 7 8 9 10])\n; =&gt; (2 3 4 5 6 7 8 9)\n</code></pre>"},{"location":"clojure/part-4/#98","title":"9.8 \u30c8\u30e9\u30f3\u30b9\u30c7\u30e5\u30fc\u30b5\u30fc","text":"<p>\u30c8\u30e9\u30f3\u30b9\u30c7\u30e5\u30fc\u30b5\u30fc\u306f\u5909\u63db\u3092\u5408\u6210\u3059\u308b\u52b9\u7387\u7684\u306a\u65b9\u6cd5\u3067\u3059\u3002\u4e2d\u9593\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u3092\u4f5c\u3089\u305a\u306b\u51e6\u7406\u3067\u304d\u307e\u3059\u3002</p> <p></p> <pre><code>;; \u30c8\u30e9\u30f3\u30b9\u30c7\u30e5\u30fc\u30b5\u30fc\u3092\u5408\u6210\n(def xform\n  (comp\n   (filter odd?)\n   (map #(* % %))\n   (take 5)))\n\n;; into \u3067\u4f7f\u7528\n(into [] xform (range 20))\n; =&gt; [1 9 25 49 81]\n\n;; sequence \u3067\u9045\u5ef6\u51e6\u7406\n(sequence xform (range 20))\n; =&gt; (1 9 25 49 81)\n</code></pre>"},{"location":"clojure/part-4/#99-eduction","title":"9.9 eduction","text":"<p><code>eduction</code> \u306f\u30c8\u30e9\u30f3\u30b9\u30c7\u30e5\u30fc\u30b5\u30fc\u3092\u4f7f\u3063\u305f\u52b9\u7387\u7684\u306a\u9045\u5ef6\u51e6\u7406\u3067\u3059\u3002</p> <pre><code>(defn efficient-process [coll]\n  (eduction\n   (filter odd?)\n   (map #(* % %))\n   (take 5)\n   coll))\n\n;; reduce, into, run! \u306a\u3069\u3068\u7d44\u307f\u5408\u308f\u305b\u3066\u4f7f\u7528\n(into [] (efficient-process (range 20)))\n; =&gt; [1 9 25 49 81]\n</code></pre>"},{"location":"clojure/part-4/#910","title":"9.10 \u5b9f\u8df5\u4f8b\uff1a\u30ed\u30b0\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406","text":"<pre><code>(def log-levels #{:debug :info :warn :error})\n\n(defn generate-log-entry []\n  {:timestamp (System/currentTimeMillis)\n   :level (rand-nth (vec log-levels))\n   :message (str \"Log message \" (rand-int 1000))})\n\n(def log-stream (repeatedly generate-log-entry))\n\n(defn filter-errors [logs]\n  (filter #(= :error (:level %)) logs))\n\n(defn count-by-level [logs]\n  (frequencies (map :level logs)))\n\n(defn recent-errors [n logs]\n  (-&gt;&gt; logs\n       filter-errors\n       (take n)))\n</code></pre>"},{"location":"clojure/part-4/#911","title":"9.11 \u5b9f\u8df5\u4f8b\uff1a\u30bb\u30f3\u30b5\u30fc\u30c7\u30fc\u30bf\u30b9\u30c8\u30ea\u30fc\u30e0","text":"<pre><code>(defn sensor-stream [base-value variance]\n  (repeatedly #(+ base-value (* (- (rand) 0.5) variance))))\n\n(defn detect-anomalies [threshold stream]\n  (filter #(&gt; (Math/abs (- % 50)) threshold) stream))\n\n(defn alert-on-anomaly [threshold n stream]\n  (-&gt;&gt; stream\n       (detect-anomalies threshold)\n       (take n)\n       (map (fn [value]\n              {:type :anomaly\n               :value value\n               :timestamp (System/currentTimeMillis)}))))\n</code></pre>"},{"location":"clojure/part-4/#912","title":"9.12 \u30d0\u30c3\u30c1\u51e6\u7406","text":"<pre><code>(defn process-in-batches [batch-size process-fn coll]\n  (-&gt;&gt; coll\n       (partition-all batch-size)\n       (map process-fn)))\n\n(defn batch-sum [batch-size coll]\n  (process-in-batches batch-size #(reduce + %) coll))\n\n(batch-sum 3 [1 2 3 4 5 6 7 8 9 10])\n; =&gt; (6 15 24 10)\n</code></pre>"},{"location":"clojure/part-4/#913","title":"9.13 \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u51e6\u7406","text":"<pre><code>(defn pipeline [&amp; fns]\n  (fn [coll]\n    (reduce (fn [acc f] (f acc)) coll fns)))\n\n(def my-pipeline\n  (pipeline\n   (partial filter odd?)\n   (partial map #(* % 2))\n   (partial take 5)))\n\n(my-pipeline (range 20))\n; =&gt; (2 6 10 14 18)\n</code></pre>"},{"location":"clojure/part-4/#_2","title":"\u307e\u3068\u3081","text":""},{"location":"clojure/part-4/#clojure-vs-scala","title":"Clojure vs Scala \u306e\u6bd4\u8f03","text":"\u6982\u5ff5 Scala (cats-effect) Clojure \u526f\u4f5c\u7528\u306e\u9045\u5ef6 <code>IO.delay</code> <code>delay</code> / \u95a2\u6570 \u72b6\u614b\u7ba1\u7406 <code>Ref[IO, A]</code> <code>atom</code> \u975e\u540c\u671f\u51e6\u7406 <code>IO.async</code> <code>future</code> \u540c\u671f\u30d7\u30ea\u30df\u30c6\u30a3\u30d6 <code>Deferred</code> <code>promise</code> \u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406 fs2 <code>Stream</code> \u9045\u5ef6\u30b7\u30fc\u30b1\u30f3\u30b9 \u5909\u63db\u306e\u5408\u6210 \u30d1\u30a4\u30d7\u6f14\u7b97\u5b50 \u30c8\u30e9\u30f3\u30b9\u30c7\u30e5\u30fc\u30b5\u30fc"},{"location":"clojure/part-4/#_3","title":"\u5b66\u3093\u3060\u3053\u3068","text":"<ol> <li>\u72b6\u614b\u7ba1\u7406: atom \u3092\u4f7f\u3063\u305f\u5b89\u5168\u306a\u72b6\u614b\u7ba1\u7406</li> <li>\u9045\u5ef6\u8a55\u4fa1: delay \u3068 force \u306b\u3088\u308b\u9045\u5ef6\u5b9f\u884c</li> <li>\u975e\u540c\u671f\u51e6\u7406: future \u3068 promise \u306b\u3088\u308b\u4e26\u884c\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0</li> <li>\u9045\u5ef6\u30b7\u30fc\u30b1\u30f3\u30b9: \u7121\u9650\u30b7\u30fc\u30b1\u30f3\u30b9\u3068\u9045\u5ef6\u8a55\u4fa1</li> <li>\u30c8\u30e9\u30f3\u30b9\u30c7\u30e5\u30fc\u30b5\u30fc: \u52b9\u7387\u7684\u306a\u5909\u63db\u306e\u5408\u6210</li> <li>\u526f\u4f5c\u7528\u306e\u5206\u96e2: \u7d14\u7c8b\u306a\u30b3\u30a2\u3068\u526f\u4f5c\u7528\u3092\u6301\u3064\u30b7\u30a7\u30eb</li> </ol>"},{"location":"clojure/part-4/#_4","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<ul> <li>Part V \u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u9ad8\u5ea6\u306a\u30c6\u30af\u30cb\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059</li> <li>Part VI \u3067\u306f\u3001\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u958b\u767a\u3092\u884c\u3044\u307e\u3059</li> </ul>"},{"location":"clojure/part-5/","title":"Part V: \u4e26\u884c\u51e6\u7406\uff08Clojure \u7248\uff09","text":"<p>\u672c\u7ae0\u3067\u306f\u3001Clojure \u306b\u304a\u3051\u308b\u4e26\u884c\u51e6\u7406\u3092\u5b66\u3073\u307e\u3059\u3002atom/ref/agent \u306b\u3088\u308b\u5171\u6709\u72b6\u614b\u7ba1\u7406\u3001pmap \u306b\u3088\u308b\u4e26\u5217\u51e6\u7406\u3001\u305d\u3057\u3066 core.async \u3092\u4f7f\u3063\u305f CSP\uff08Communicating Sequential Processes\uff09\u30b9\u30bf\u30a4\u30eb\u306e\u4e26\u884c\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"clojure/part-5/#10","title":"\u7b2c10\u7ae0: \u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406\u306e\u57fa\u790e","text":""},{"location":"clojure/part-5/#101","title":"10.1 \u4e26\u884c\u51e6\u7406\u306e\u8ab2\u984c","text":"<p>\u5f93\u6765\u306e\u4e26\u884c\u51e6\u7406\u306b\u306f\u591a\u304f\u306e\u8ab2\u984c\u304c\u3042\u308a\u307e\u3059:</p> <ul> <li>\u30c7\u30c3\u30c9\u30ed\u30c3\u30af</li> <li>\u7af6\u5408\u72b6\u614b\uff08Race Condition\uff09</li> <li>\u5171\u6709\u72b6\u614b\u306e\u7ba1\u7406\u306e\u8907\u96d1\u3055</li> <li>\u30b9\u30ec\u30c3\u30c9\u306e\u30aa\u30fc\u30d0\u30fc\u30d8\u30c3\u30c9</li> </ul> <p></p>"},{"location":"clojure/part-5/#102-clojure","title":"10.2 Clojure \u306e\u4e26\u884c\u30d7\u30ea\u30df\u30c6\u30a3\u30d6","text":"<p>Clojure \u306b\u306f\u8907\u6570\u306e\u4e26\u884c\u30d7\u30ea\u30df\u30c6\u30a3\u30d6\u304c\u3042\u308a\u307e\u3059\u3002</p> <p></p>"},{"location":"clojure/part-5/#103","title":"10.3 \u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u306e\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u96c6\u8a08","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/clojure/src/ch10/concurrency.clj</code></p> <p>\u90fd\u5e02\u3078\u306e\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u3092\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u3067\u96c6\u8a08\u3057\u3001\u30e9\u30f3\u30ad\u30f3\u30b0\u3092\u66f4\u65b0\u3059\u308b\u4f8b\u3092\u898b\u3066\u3044\u304d\u307e\u3059\u3002</p> <pre><code>(defrecord City [name])\n(defrecord CityStats [city check-ins])\n\n(defn city [name]\n  (-&gt;City name))\n\n(defn city-stats [city check-ins]\n  (-&gt;CityStats city check-ins))\n</code></pre>"},{"location":"clojure/part-5/#_1","title":"\u30c8\u30c3\u30d7\u90fd\u5e02\u306e\u8a08\u7b97\uff08\u7d14\u7c8b\u95a2\u6570\uff09","text":"<pre><code>(defn top-cities\n  \"\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u6570\u3067\u30c8\u30c3\u30d7N\u90fd\u5e02\u3092\u8a08\u7b97\uff08\u7d14\u7c8b\u95a2\u6570\uff09\"\n  [city-check-ins n]\n  (-&gt;&gt; city-check-ins\n       (map (fn [[city check-ins]] (city-stats city check-ins)))\n       (sort-by :check-ins &gt;)\n       (take n)))\n</code></pre>"},{"location":"clojure/part-5/#104-vs","title":"10.4 \u9010\u6b21\u51e6\u7406 vs \u4e26\u884c\u51e6\u7406","text":"<pre><code>;; \u9010\u6b21\u51e6\u7406\u7248\n(defn process-check-ins-sequential\n  \"\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u3092\u9010\u6b21\u51e6\u7406\"\n  [check-ins]\n  (reduce\n   (fn [city-check-ins city]\n     (update city-check-ins city (fnil inc 0)))\n   {}\n   check-ins))\n\n;; \u4e26\u884c\u51e6\u7406\u7248\uff08atom + pmap\uff09\n(defn process-check-ins-concurrent\n  \"\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u3092\u4e26\u884c\u51e6\u7406\"\n  [check-ins]\n  (let [stored-check-ins (atom {})]\n    (dorun (pmap #(store-check-in! stored-check-ins %) check-ins))\n    @stored-check-ins))\n</code></pre>"},{"location":"clojure/part-5/#105-atom-","title":"10.5 atom - \u30a2\u30c8\u30df\u30c3\u30af\u306a\u5171\u6709\u72b6\u614b","text":"<p>atom \u306f Clojure \u306e\u6700\u3082\u57fa\u672c\u7684\u306a\u4e26\u884c\u30d7\u30ea\u30df\u30c6\u30a3\u30d6\u3067\u3059\u3002Scala \u306e <code>Ref</code> \u306b\u76f8\u5f53\u3057\u307e\u3059\u3002</p> <pre><code>;; atom \u3092\u4f5c\u6210\n(def stored-check-ins (atom {}))\n\n;; swap! \u3067\u30a2\u30c8\u30df\u30c3\u30af\u306b\u66f4\u65b0\n(defn store-check-in! [stored-check-ins city]\n  (swap! stored-check-ins update city (fnil inc 0)))\n\n;; \u5024\u3092\u8aad\u307f\u53d6\u308a\n@stored-check-ins  ; \u307e\u305f\u306f (deref stored-check-ins)\n</code></pre>"},{"location":"clojure/part-5/#atom","title":"atom \u306e\u4e3b\u8981\u30e1\u30bd\u30c3\u30c9","text":"\u30e1\u30bd\u30c3\u30c9 \u8aac\u660e \u4f8b <code>atom</code> \u521d\u671f\u5024\u3067 atom \u3092\u4f5c\u6210 <code>(atom {})</code> <code>deref</code> / <code>@</code> \u73fe\u5728\u306e\u5024\u3092\u53d6\u5f97 <code>@counter</code> <code>reset!</code> \u5024\u3092\u8a2d\u5b9a <code>(reset! counter 0)</code> <code>swap!</code> \u30a2\u30c8\u30df\u30c3\u30af\u306b\u66f4\u65b0 <code>(swap! counter inc)</code> <code>compare-and-set!</code> CAS \u64cd\u4f5c <code>(compare-and-set! a old new)</code>"},{"location":"clojure/part-5/#106-pmap-","title":"10.6 pmap - \u4e26\u5217\u30de\u30c3\u30d7\u51e6\u7406","text":"<p><code>pmap</code> \u306f <code>map</code> \u306e\u4e26\u5217\u7248\u3067\u3059\u3002Scala \u306e <code>parSequence</code> \u306b\u76f8\u5f53\u3057\u307e\u3059\u3002</p> <pre><code>;; \u9806\u6b21\u5b9f\u884c\n(defn sequential-process [coll]\n  (mapv slow-operation coll))\n\n;; \u4e26\u5217\u5b9f\u884c\n(defn parallel-process [coll]\n  (vec (pmap slow-operation coll)))\n</code></pre> <p></p>"},{"location":"clojure/part-5/#107","title":"10.7 \u30b5\u30a4\u30b3\u30ed\u3092\u4e26\u884c\u3057\u3066\u632f\u308b","text":"<pre><code>(defn cast-the-die []\n  (inc (rand-int 6)))\n\n;; \u8907\u6570\u306e\u30b5\u30a4\u30b3\u30ed\u3092\u4e26\u884c\u3057\u3066\u632f\u308b\n(defn cast-dice-concurrent [n]\n  (vec (pmap (fn [_] (cast-the-die)) (range n))))\n\n;; \u7d50\u679c\u3092 atom \u306b\u4fdd\u5b58\n(defn cast-dice-with-storage! [n]\n  (let [stored-casts (atom [])]\n    (dorun\n     (pmap\n      (fn [_]\n        (let [result (cast-the-die)]\n          (swap! stored-casts conj result)))\n      (range n)))\n    @stored-casts))\n</code></pre>"},{"location":"clojure/part-5/#108-agent-","title":"10.8 agent - \u975e\u540c\u671f\u72b6\u614b\u66f4\u65b0","text":"<p>agent \u306f\u975e\u540c\u671f\u306b\u72b6\u614b\u3092\u66f4\u65b0\u3057\u307e\u3059\u3002\u66f4\u65b0\u306f\u30ad\u30e5\u30fc\u306b\u5165\u308c\u3089\u308c\u3001\u9806\u6b21\u51e6\u7406\u3055\u308c\u307e\u3059\u3002</p> <pre><code>(def check-in-agent (agent {}))\n\n;; send \u3067\u975e\u540c\u671f\u66f4\u65b0\n(defn agent-store-check-in! [city]\n  (send check-in-agent update city (fnil inc 0)))\n\n;; \u5024\u3092\u8aad\u307f\u53d6\u308a\uff08\u5373\u5ea7\u306b\u8fd4\u308b\uff09\n@check-in-agent\n\n;; \u66f4\u65b0\u5b8c\u4e86\u3092\u5f85\u6a5f\n(await check-in-agent)\n</code></pre> <p></p>"},{"location":"clojure/part-5/#109-ref-stmsoftware-transactional-memory","title":"10.9 ref \u3068 STM\uff08Software Transactional Memory\uff09","text":"<p>ref \u306f\u8907\u6570\u306e\u5024\u3092\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u3067\u66f4\u65b0\u3057\u307e\u3059\u3002</p> <pre><code>(def check-in-ref (ref {}))\n(def ranking-ref (ref []))\n\n;; dosync \u3067\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\n(defn stm-store-check-in! [city]\n  (dosync\n   (alter check-in-ref update city (fnil inc 0))))\n\n;; \u8907\u6570\u306e ref \u3092\u4e00\u7dd2\u306b\u66f4\u65b0\n(defn stm-transfer-check-ins! [from-city to-city amount]\n  (dosync\n   (let [from-count (get @check-in-ref from-city 0)]\n     (when (&gt;= from-count amount)\n       (alter check-in-ref update from-city - amount)\n       (alter check-in-ref update to-city (fnil + 0) amount)\n       true))))\n</code></pre> <p></p>"},{"location":"clojure/part-5/#1010-future","title":"10.10 future \u306b\u3088\u308b\u975e\u540c\u671f\u51e6\u7406","text":"<pre><code>(defn async-api-call [name delay-ms]\n  (future\n    (Thread/sleep delay-ms)\n    {:name name :result (str \"Result for \" name)}))\n\n(defn parallel-api-calls [names]\n  (let [futures (mapv #(async-api-call % 100) names)]\n    (mapv deref futures)))\n\n;; \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u4ed8\u304d\n(defn parallel-api-calls-with-timeout [names timeout-ms]\n  (let [futures (mapv #(async-api-call % 100) names)]\n    (mapv #(deref % timeout-ms {:error \"timeout\"}) futures)))\n</code></pre>"},{"location":"clojure/part-5/#1011","title":"10.11 \u5b9f\u8df5\u4f8b\uff1a\u4e26\u884c\u30ad\u30e3\u30c3\u30b7\u30e5","text":"<pre><code>(defn create-cache []\n  (let [cache (atom {})\n        hits (atom 0)\n        misses (atom 0)]\n    {:get (fn [key compute-fn]\n            (if-let [value (get @cache key)]\n              (do (swap! hits inc) value)\n              (let [value (compute-fn)]\n                (swap! misses inc)\n                (swap! cache assoc key value)\n                value)))\n     :invalidate (fn [key]\n                   (swap! cache dissoc key))\n     :stats (fn []\n              {:size (count @cache)\n               :hits @hits\n               :misses @misses})}))\n</code></pre>"},{"location":"clojure/part-5/#11-coreasync-csp","title":"\u7b2c11\u7ae0: core.async \u3068 CSP","text":""},{"location":"clojure/part-5/#111-cspcommunicating-sequential-processes","title":"11.1 CSP\uff08Communicating Sequential Processes\uff09","text":"<p>core.async \u306f CSP \u30b9\u30bf\u30a4\u30eb\u306e\u4e26\u884c\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u3092\u63d0\u4f9b\u3057\u307e\u3059\u3002Go \u8a00\u8a9e\u306e goroutine \u3068 channel \u306b\u4f3c\u3066\u3044\u307e\u3059\u3002</p> <p></p>"},{"location":"clojure/part-5/#112","title":"11.2 \u30c1\u30e3\u30cd\u30eb\u306e\u57fa\u672c","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/clojure/src/ch11/core_async.clj</code></p> <pre><code>(require '[clojure.core.async :as async\n           :refer [chan go go-loop &lt;! &gt;! &lt;!! &gt;!! close!\n                   timeout put! take!]])\n\n;; \u30c1\u30e3\u30cd\u30eb\u3092\u4f5c\u6210\n(def ch (chan))        ; \u30d0\u30c3\u30d5\u30a1\u306a\u3057\n(def ch (chan 10))     ; \u30d0\u30c3\u30d5\u30a1\u30b5\u30a4\u30ba 10\n\n;; \u30d6\u30ed\u30c3\u30ad\u30f3\u30b0\u64cd\u4f5c\uff08\u30e1\u30a4\u30f3\u30b9\u30ec\u30c3\u30c9\u7528\uff09\n(&gt;!! ch value)  ; \u9001\u4fe1\n(&lt;!! ch)        ; \u53d7\u4fe1\n\n;; \u30ce\u30f3\u30d6\u30ed\u30c3\u30ad\u30f3\u30b0\u64cd\u4f5c\uff08go \u30d6\u30ed\u30c3\u30af\u5185\uff09\n(go (&gt;! ch value))  ; \u9001\u4fe1\n(go (&lt;! ch))        ; \u53d7\u4fe1\n</code></pre>"},{"location":"clojure/part-5/#_2","title":"\u30c1\u30e3\u30cd\u30eb\u306e\u7a2e\u985e","text":"\u7a2e\u985e \u8aac\u660e \u4f5c\u6210\u65b9\u6cd5 \u30d0\u30c3\u30d5\u30a1\u306a\u3057 \u9001\u53d7\u4fe1\u304c\u540c\u671f <code>(chan)</code> \u56fa\u5b9a\u30d0\u30c3\u30d5\u30a1 \u6307\u5b9a\u30b5\u30a4\u30ba <code>(chan 10)</code> \u30b9\u30e9\u30a4\u30c7\u30a3\u30f3\u30b0 \u53e4\u3044\u5024\u3092\u7834\u68c4 <code>(chan (sliding-buffer 10))</code> \u30c9\u30ed\u30c3\u30d4\u30f3\u30b0 \u65b0\u3057\u3044\u5024\u3092\u7834\u68c4 <code>(chan (dropping-buffer 10))</code>"},{"location":"clojure/part-5/#113-go","title":"11.3 go \u30d6\u30ed\u30c3\u30af\uff08\u8efd\u91cf\u30b9\u30ec\u30c3\u30c9\uff09","text":"<p>go \u30d6\u30ed\u30c3\u30af\u306f\u8efd\u91cf\u306a\u300c\u64ec\u4f3c\u30b9\u30ec\u30c3\u30c9\u300d\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002Scala \u306e Fiber \u306b\u76f8\u5f53\u3057\u307e\u3059\u3002</p> <pre><code>;; go \u30d6\u30ed\u30c3\u30af\u306f\u5373\u5ea7\u306b\u8fd4\u308b\n(go\n  (println \"Starting...\")\n  (&lt;! (timeout 1000))\n  (println \"Done!\"))\n\n;; go-loop \u306f\u518d\u5e30\u7684\u306a\u51e6\u7406\u306b\u4fbf\u5229\n(go-loop [i 0]\n  (when (&lt; i 5)\n    (println i)\n    (&lt;! (timeout 100))\n    (recur (inc i))))\n</code></pre> <p></p>"},{"location":"clojure/part-5/#114","title":"11.4 \u30d7\u30ed\u30c7\u30e5\u30fc\u30b5\u30fc/\u30b3\u30f3\u30b7\u30e5\u30fc\u30de\u30fc\u30d1\u30bf\u30fc\u30f3","text":"<pre><code>(defn simple-producer\n  \"\u30b7\u30f3\u30d7\u30eb\u306a\u30d7\u30ed\u30c7\u30e5\u30fc\u30b5\u30fc\"\n  [ch values]\n  (go\n    (doseq [v values]\n      (&gt;! ch v))\n    (close! ch)))\n\n(defn simple-consumer\n  \"\u30b7\u30f3\u30d7\u30eb\u306a\u30b3\u30f3\u30b7\u30e5\u30fc\u30de\u30fc\"\n  [ch]\n  (go-loop [results []]\n    (if-let [v (&lt;! ch)]\n      (recur (conj results v))\n      results)))\n\n;; \u4f7f\u7528\u4f8b\n(let [ch (chan 10)]\n  (simple-producer ch [1 2 3 4 5])\n  (&lt;!! (simple-consumer ch)))\n; =&gt; [1 2 3 4 5]\n</code></pre>"},{"location":"clojure/part-5/#115","title":"11.5 \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u30d1\u30bf\u30fc\u30f3","text":"<pre><code>(defn map-pipeline\n  \"\u30de\u30c3\u30d4\u30f3\u30b0\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\"\n  [f in-ch]\n  (let [out-ch (chan)]\n    (go-loop []\n      (if-let [v (&lt;! in-ch)]\n        (do\n          (&gt;! out-ch (f v))\n          (recur))\n        (close! out-ch)))\n    out-ch))\n\n(defn filter-pipeline\n  \"\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\"\n  [pred in-ch]\n  (let [out-ch (chan)]\n    (go-loop []\n      (if-let [v (&lt;! in-ch)]\n        (do\n          (when (pred v)\n            (&gt;! out-ch v))\n          (recur))\n        (close! out-ch)))\n    out-ch))\n</code></pre>"},{"location":"clojure/part-5/#116-fan-out-fan-in","title":"11.6 Fan-out / Fan-in \u30d1\u30bf\u30fc\u30f3","text":"<pre><code>;; Fan-out: 1\u3064\u306e\u30c1\u30e3\u30cd\u30eb\u304b\u3089\u8907\u6570\u306b\u5206\u914d\n(defn fan-out [in-ch out-chs]\n  (go-loop []\n    (when-let [v (&lt;! in-ch)]\n      (doseq [out-ch out-chs]\n        (&gt;! out-ch v))\n      (recur))))\n\n;; Fan-in: \u8907\u6570\u306e\u30c1\u30e3\u30cd\u30eb\u304b\u30891\u3064\u306b\u96c6\u7d04\n(defn fan-in [in-chs]\n  (let [out-ch (chan)]\n    (doseq [in-ch in-chs]\n      (go-loop []\n        (when-let [v (&lt;! in-ch)]\n          (&gt;! out-ch v)\n          (recur))))\n    out-ch))\n</code></pre>"},{"location":"clojure/part-5/#117-alts","title":"11.7 alts! \u306b\u3088\u308b\u30bb\u30ec\u30af\u30c8","text":"<p><code>alts!</code> \u306f\u8907\u6570\u306e\u30c1\u30e3\u30cd\u30eb\u304b\u3089\u6700\u521d\u306b\u5024\u304c\u6765\u305f\u3082\u306e\u3092\u9078\u629e\u3057\u307e\u3059\u3002</p> <pre><code>(defn with-timeout [ch timeout-ms default]\n  (let [timeout-ch (timeout timeout-ms)]\n    (go\n      (let [[v ch] (alts! [ch timeout-ch])]\n        (if (= ch timeout-ch)\n          default\n          v)))))\n\n(defn first-response [chs]\n  (go\n    (let [[v _] (alts! chs)]\n      v)))\n</code></pre>"},{"location":"clojure/part-5/#118","title":"11.8 \u30ef\u30fc\u30ab\u30fc\u30d7\u30fc\u30eb","text":"<pre><code>(defn worker [id work-ch result-ch]\n  (go-loop []\n    (when-let [work (&lt;! work-ch)]\n      (let [result (work)]\n        (&gt;! result-ch {:worker id :result result}))\n      (recur))))\n\n(defn create-worker-pool [n work-ch result-ch]\n  (dotimes [i n]\n    (worker i work-ch result-ch)))\n\n;; \u4f7f\u7528\u4f8b\n(let [work-ch (chan 10)\n      result-ch (chan 10)]\n  (create-worker-pool 3 work-ch result-ch)\n  (put! work-ch (fn [] (* 2 21)))\n  (&lt;!! result-ch))\n; =&gt; {:worker 0 :result 42}\n</code></pre>"},{"location":"clojure/part-5/#119-pubsub","title":"11.9 pub/sub \u30d1\u30bf\u30fc\u30f3","text":"<pre><code>(defn create-pub-sub []\n  (let [pub-ch (chan)\n        subscribers (atom {})]\n    {:publish (fn [topic message]\n                (put! pub-ch {:topic topic :message message}))\n     :subscribe (fn [topic]\n                  (let [sub-ch (chan)]\n                    (swap! subscribers update topic (fnil conj []) sub-ch)\n                    sub-ch))\n     :start (fn []\n              (go-loop []\n                (when-let [{:keys [topic message]} (&lt;! pub-ch)]\n                  (doseq [sub-ch (get @subscribers topic [])]\n                    (&gt;! sub-ch message))\n                  (recur))))}))\n</code></pre>"},{"location":"clojure/part-5/#1110","title":"11.10 \u30ec\u30fc\u30c8\u30ea\u30df\u30c3\u30bf\u30fc","text":"<pre><code>(defn create-rate-limiter [rate-per-second]\n  (let [interval-ms (/ 1000 rate-per-second)\n        token-ch (chan 1)]\n    ;; \u30c8\u30fc\u30af\u30f3\u3092\u5b9a\u671f\u7684\u306b\u4f9b\u7d66\n    (go-loop []\n      (&gt;! token-ch :token)\n      (&lt;! (timeout interval-ms))\n      (recur))\n    {:acquire (fn []\n                (&lt;!! token-ch))\n     :try-acquire (fn [timeout-ms]\n                    (let [[v _] (alts!! [token-ch (timeout timeout-ms)])]\n                      (some? v)))}))\n</code></pre>"},{"location":"clojure/part-5/#1111","title":"11.11 \u30bb\u30de\u30d5\u30a9","text":"<pre><code>(defn create-semaphore [permits]\n  (let [sem-ch (chan permits)]\n    ;; \u521d\u671f\u8a31\u53ef\u3092\u8ffd\u52a0\n    (dotimes [_ permits]\n      (put! sem-ch :permit))\n    {:acquire (fn []\n                (&lt;!! sem-ch))\n     :release (fn []\n                (put! sem-ch :permit))\n     :with-permit (fn [f]\n                    (&lt;!! sem-ch)\n                    (try\n                      (f)\n                      (finally\n                        (put! sem-ch :permit))))}))\n</code></pre>"},{"location":"clojure/part-5/#1112","title":"11.12 \u5b9f\u8df5\u4f8b\uff1a\u4e26\u884c\u30c0\u30a6\u30f3\u30ed\u30fc\u30c0\u30fc","text":"<pre><code>(defn concurrent-downloader [urls max-concurrent]\n  (let [result-ch (chan (count urls))\n        semaphore (chan max-concurrent)]\n    ;; \u30bb\u30de\u30d5\u30a9\u3092\u521d\u671f\u5316\n    (dotimes [_ max-concurrent]\n      (put! semaphore :permit))\n\n    ;; \u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3092\u958b\u59cb\n    (doseq [url urls]\n      (go\n        (&lt;! semaphore)  ; \u8a31\u53ef\u3092\u53d6\u5f97\n        (let [result (&lt;! (simulate-download url))]\n          (&gt;! result-ch result)\n          (&gt;! semaphore :permit))))  ; \u8a31\u53ef\u3092\u8fd4\u5374\n\n    result-ch))\n</code></pre>"},{"location":"clojure/part-5/#_3","title":"\u307e\u3068\u3081","text":""},{"location":"clojure/part-5/#clojure-vs-scala","title":"Clojure vs Scala \u306e\u6bd4\u8f03","text":"\u6982\u5ff5 Scala (cats-effect) Clojure \u30a2\u30c8\u30df\u30c3\u30af\u53c2\u7167 <code>Ref[IO, A]</code> <code>atom</code> \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3 \u306a\u3057\uff08\u5225\u30e9\u30a4\u30d6\u30e9\u30ea\uff09 <code>ref</code> + STM \u975e\u540c\u671f\u66f4\u65b0 \u306a\u3057\uff08\u76f4\u63a5\u5bfe\u5fdc\u306a\u3057\uff09 <code>agent</code> \u8efd\u91cf\u30b9\u30ec\u30c3\u30c9 <code>Fiber</code> <code>go</code> \u30d6\u30ed\u30c3\u30af \u30c1\u30e3\u30cd\u30eb fs2 <code>Queue</code> <code>chan</code> \u4e26\u5217\u5b9f\u884c <code>parSequence</code> <code>pmap</code> \u30bb\u30ec\u30af\u30c8 <code>race</code> <code>alts!</code>"},{"location":"clojure/part-5/#_4","title":"\u4e26\u884c\u30d7\u30ea\u30df\u30c6\u30a3\u30d6\u306e\u4f7f\u3044\u5206\u3051","text":""},{"location":"clojure/part-5/#_5","title":"\u5b66\u3093\u3060\u3053\u3068","text":"<ol> <li>atom: \u5358\u4e00\u5024\u306e\u30a2\u30c8\u30df\u30c3\u30af\u306a\u540c\u671f\u66f4\u65b0</li> <li>ref + STM: \u8907\u6570\u5024\u306e\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u7ba1\u7406</li> <li>agent: \u975e\u540c\u671f\u72b6\u614b\u66f4\u65b0</li> <li>pmap: \u4e26\u5217\u30de\u30c3\u30d7\u51e6\u7406</li> <li>core.async: CSP \u30b9\u30bf\u30a4\u30eb\u306e\u4e26\u884c\u51e6\u7406</li> <li>go \u30d6\u30ed\u30c3\u30af: \u8efd\u91cf\u306a\u64ec\u4f3c\u30b9\u30ec\u30c3\u30c9</li> <li>\u30c1\u30e3\u30cd\u30eb: \u30d7\u30ed\u30bb\u30b9\u9593\u901a\u4fe1</li> </ol>"},{"location":"clojure/part-5/#_6","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<ul> <li>Part VI \u3067\u306f\u3001\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u3092\u884c\u3044\u307e\u3059</li> </ul>"},{"location":"clojure/part-6/","title":"Part VI: \u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u3068\u30c6\u30b9\u30c8\uff08Clojure \u7248\uff09","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u3053\u308c\u307e\u3067\u5b66\u3093\u3060\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u6982\u5ff5\u3092\u7d71\u5408\u3057\u3001\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002\u307e\u305f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u30c6\u30b9\u30c8\u6226\u7565\u306b\u3064\u3044\u3066\u3082\u5b66\u3073\u307e\u3059\u3002</p>"},{"location":"clojure/part-6/#12","title":"\u7b2c12\u7ae0: \u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9","text":""},{"location":"clojure/part-6/#121-travelguide","title":"12.1 TravelGuide \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/clojure/src/ch12/travel_guide.clj</code></p> <p>\u65c5\u884c\u30ac\u30a4\u30c9\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f8b\u306b\u3001\u5b9f\u8df5\u7684\u306a FP \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u69cb\u7bc9\u65b9\u6cd5\u3092\u5b66\u3073\u307e\u3059\u3002</p> <p></p>"},{"location":"clojure/part-6/#122","title":"12.2 \u30c9\u30e1\u30a4\u30f3\u30e2\u30c7\u30eb\u306e\u5b9a\u7fa9","text":"<pre><code>;; \u30ec\u30b3\u30fc\u30c9\u5b9a\u7fa9\n(defrecord Location [id name population])\n(defrecord Attraction [name description location])\n(defrecord MusicArtist [name genre origin])\n(defrecord Movie [name year director])\n(defrecord Hotel [name rating location])\n(defrecord SearchReport [attractions-searched errors])\n(defrecord TravelGuide [attraction subjects search-report])\n\n;; \u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u95a2\u6570\n(defn location [id name population]\n  (-&gt;Location id name population))\n\n(defn attraction\n  ([name location]\n   (-&gt;Attraction name nil location))\n  ([name description location]\n   (-&gt;Attraction name description location)))\n\n(defn travel-guide [attraction subjects search-report]\n  (-&gt;TravelGuide attraction subjects search-report))\n</code></pre>"},{"location":"clojure/part-6/#123","title":"12.3 \u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\u5c64\u306e\u62bd\u8c61\u5316","text":"<p>\u30d7\u30ed\u30c8\u30b3\u30eb\u3092\u4f7f\u7528\u3057\u3066\u5916\u90e8\u30c7\u30fc\u30bf\u30bd\u30fc\u30b9\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u62bd\u8c61\u5316\u3057\u307e\u3059\u3002</p> <pre><code>(defprotocol DataAccess\n  \"\u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\u5c64\u306e\u62bd\u8c61\u5316\"\n  (find-attractions [this name ordering limit]\n    \"\u30a2\u30c8\u30e9\u30af\u30b7\u30e7\u30f3\u3092\u691c\u7d22\")\n  (find-artists-from-location [this location-id limit]\n    \"\u30ed\u30b1\u30fc\u30b7\u30e7\u30f3\u304b\u3089\u30a2\u30fc\u30c6\u30a3\u30b9\u30c8\u3092\u691c\u7d22\")\n  (find-movies-about-location [this location-id limit]\n    \"\u30ed\u30b1\u30fc\u30b7\u30e7\u30f3\u306b\u95a2\u3059\u308b\u6620\u753b\u3092\u691c\u7d22\")\n  (find-hotels-near-location [this location-id limit]\n    \"\u30ed\u30b1\u30fc\u30b7\u30e7\u30f3\u8fd1\u304f\u306e\u30db\u30c6\u30eb\u3092\u691c\u7d22\"))\n</code></pre> <p></p>"},{"location":"clojure/part-6/#124-result","title":"12.4 Result \u578b\u306b\u3088\u308b\u30a8\u30e9\u30fc\u51e6\u7406","text":"<pre><code>;; Result \u30e6\u30fc\u30c6\u30a3\u30ea\u30c6\u30a3\n(defn ok? [result]\n  (contains? result :ok))\n\n(defn error? [result]\n  (contains? result :error))\n\n(defn get-value [result default]\n  (if (ok? result)\n    (:ok result)\n    default))\n\n(defn get-error [result]\n  (:error result))\n</code></pre>"},{"location":"clojure/part-6/#125","title":"12.5 \u30c6\u30b9\u30c8\u7528\u30b9\u30bf\u30d6\u5b9f\u88c5","text":"<pre><code>(defrecord TestDataAccess [attractions artists movies hotels]\n  DataAccess\n  (find-attractions [_ name ordering limit]\n    {:ok (take limit (filter #(clojure.string/includes?\n                               (clojure.string/lower-case (:name %))\n                               (clojure.string/lower-case name))\n                             attractions))})\n\n  (find-artists-from-location [_ location-id limit]\n    {:ok (take limit artists)})\n\n  (find-movies-about-location [_ location-id limit]\n    {:ok (take limit movies)})\n\n  (find-hotels-near-location [_ location-id limit]\n    {:ok (take limit hotels)}))\n\n(defn create-test-data-access []\n  (-&gt;TestDataAccess\n   [test-attraction ...]\n   [test-artist ...]\n   [test-movie ...]\n   [test-hotel ...]))\n</code></pre>"},{"location":"clojure/part-6/#126","title":"12.6 \u30a8\u30e9\u30fc\u51e6\u7406\u4ed8\u304d\u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9","text":"<pre><code>(defrecord FailingDataAccess []\n  DataAccess\n  (find-attractions [_ name ordering limit]\n    {:ok [(attraction \"Fallback Attraction\" nil test-location)]})\n\n  (find-artists-from-location [_ location-id limit]\n    {:error \"Network error: Failed to fetch artists\"})\n\n  (find-movies-about-location [_ location-id limit]\n    {:error \"Timeout: Failed to fetch movies\"})\n\n  (find-hotels-near-location [_ location-id limit]\n    {:error \"Service unavailable\"}))\n</code></pre>"},{"location":"clojure/part-6/#127-travelguide","title":"12.7 TravelGuide \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u69cb\u7bc9","text":"<pre><code>(defn build-travel-guide\n  \"\u65c5\u884c\u30ac\u30a4\u30c9\u3092\u69cb\u7bc9\"\n  [data-access attraction-name]\n  (let [attractions-result (find-attractions data-access attraction-name by-population 3)]\n    (if (error? attractions-result)\n      {:error (get-error attractions-result)}\n      (let [attractions (get-value attractions-result [])]\n        (map (fn [attr]\n               (let [location-id (get-in attr [:location :id])\n                     artists-result (find-artists-from-location data-access location-id 2)\n                     movies-result (find-movies-about-location data-access location-id 2)\n\n                     ;; \u30a8\u30e9\u30fc\u3092\u53ce\u96c6\n                     errors (cond-&gt; []\n                              (error? artists-result) (conj (get-error artists-result))\n                              (error? movies-result) (conj (get-error movies-result)))\n\n                     ;; \u7d50\u679c\u3092\u53d6\u5f97\uff08\u30a8\u30e9\u30fc\u6642\u306f\u7a7a\u30ea\u30b9\u30c8\uff09\n                     artists (get-value artists-result [])\n                     movies (get-value movies-result [])\n\n                     ;; \u30b5\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u69cb\u7bc9\n                     subjects (concat (map :name artists) (map :name movies))]\n                 (travel-guide\n                  attr\n                  (vec subjects)\n                  (search-report (count attractions) errors))))\n             attractions)))))\n</code></pre>"},{"location":"clojure/part-6/#128","title":"12.8 \u30ad\u30e3\u30c3\u30b7\u30e5\u4ed8\u304d\u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9","text":"<p><code>atom</code> \u3092\u4f7f\u7528\u3057\u305f\u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u5b9f\u88c5:</p> <pre><code>(defn create-cached-data-access\n  \"\u30ad\u30e3\u30c3\u30b7\u30e5\u4ed8\u304d\u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\u3092\u4f5c\u6210\"\n  [underlying-data-access]\n  (let [attractions-cache (atom {})\n        artists-cache (atom {})\n        movies-cache (atom {})\n        hotels-cache (atom {})]\n    (reify DataAccess\n      (find-attractions [_ name ordering limit]\n        (let [cache-key (str name \"-\" ordering \"-\" limit)]\n          (if-let [cached (get @attractions-cache cache-key)]\n            {:ok cached}\n            (let [result (find-attractions underlying-data-access name ordering limit)]\n              (when (ok? result)\n                (swap! attractions-cache assoc cache-key (:ok result)))\n              result))))\n      ;; \u4ed6\u306e\u30e1\u30bd\u30c3\u30c9\u3082\u540c\u69d8...\n      )))\n</code></pre> <p></p>"},{"location":"clojure/part-6/#129","title":"12.9 \u30ea\u30bd\u30fc\u30b9\u7ba1\u7406","text":"<p>\u5b89\u5168\u306a\u30ea\u30bd\u30fc\u30b9\u7ba1\u7406\u30d1\u30bf\u30fc\u30f3:</p> <pre><code>(defn with-resource\n  \"\u30ea\u30bd\u30fc\u30b9\u3092\u5b89\u5168\u306b\u4f7f\u7528\uff08try-with-resources \u30d1\u30bf\u30fc\u30f3\uff09\"\n  [acquire release use-fn]\n  (let [resource (acquire)]\n    (try\n      (use-fn resource)\n      (finally\n        (release resource)))))\n\n(defn make-resource\n  \"\u30ea\u30bd\u30fc\u30b9\u3092\u4f5c\u6210\"\n  [acquire release]\n  {:acquire acquire\n   :release release})\n\n;; \u30d5\u30a1\u30a4\u30eb\u30ea\u30bd\u30fc\u30b9\u306e\u4f8b\n(defn file-resource [path]\n  (make-resource\n   #(clojure.java.io/reader path)\n   #(.close %)))\n\n(defn read-lines [path]\n  (use-resource\n   (file-resource path)\n   (fn [reader]\n     (vec (line-seq reader)))))\n</code></pre>"},{"location":"clojure/part-6/#1210","title":"12.10 \u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3","text":"<pre><code>(defn validate-attraction-name [name]\n  (cond\n    (nil? name)\n    {:error \"Attraction name cannot be nil\"}\n\n    (clojure.string/blank? name)\n    {:error \"Attraction name cannot be empty\"}\n\n    (&gt; (count name) 100)\n    {:error \"Attraction name too long\"}\n\n    :else\n    {:ok name}))\n\n(defn validate-limit [limit]\n  (cond\n    (nil? limit)\n    {:error \"Limit cannot be nil\"}\n\n    (not (integer? limit))\n    {:error \"Limit must be an integer\"}\n\n    (&lt;= limit 0)\n    {:error \"Limit must be positive\"}\n\n    (&gt; limit 100)\n    {:error \"Limit cannot exceed 100\"}\n\n    :else\n    {:ok limit}))\n</code></pre>"},{"location":"clojure/part-6/#13","title":"\u7b2c13\u7ae0: \u30c6\u30b9\u30c8\u6226\u7565","text":""},{"location":"clojure/part-6/#131","title":"13.1 \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u30c6\u30b9\u30c8","text":"<p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u3067\u306f\u3001\u7d14\u7c8b\u95a2\u6570\u306e\u304a\u304b\u3052\u3067\u30c6\u30b9\u30c8\u304c\u975e\u5e38\u306b\u7c21\u5358\u306b\u306a\u308a\u307e\u3059\u3002</p> <p></p>"},{"location":"clojure/part-6/#132","title":"13.2 \u7d14\u7c8b\u95a2\u6570\u306e\u30c6\u30b9\u30c8","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/clojure/test/ch12/travel_guide_test.clj</code></p> <p>\u7d14\u7c8b\u95a2\u6570\u306f\u5165\u529b\u3068\u51fa\u529b\u306e\u307f\u3067\u30c6\u30b9\u30c8\u3067\u304d\u307e\u3059\u3002</p> <pre><code>(deftest filter-popular-locations-tests\n  (testing \"filters by minimum population\"\n    (let [locations [(location \"Q1\" \"Small\" 1000)\n                     (location \"Q2\" \"Medium\" 100000)\n                     (location \"Q3\" \"Large\" 1000000)]\n          result (filter-popular-locations locations 50000)]\n      (is (= 2 (count result)))\n      (is (every? #(&gt;= (:population %) 50000) result)))))\n\n(deftest calculate-average-rating-tests\n  (testing \"calculates average\"\n    (let [loc (location \"Q1\" \"City\" 100000)\n          hotels [(hotel \"H1\" 4.0 loc)\n                  (hotel \"H2\" 5.0 loc)\n                  (hotel \"H3\" 3.0 loc)]]\n      (is (= 4.0 (calculate-average-rating hotels)))))\n\n  (testing \"returns 0 for empty list\"\n    (is (= 0.0 (calculate-average-rating [])))))\n</code></pre>"},{"location":"clojure/part-6/#133","title":"13.3 \u30b9\u30bf\u30d6\u3092\u4f7f\u7528\u3057\u305f\u30c6\u30b9\u30c8","text":"<pre><code>(deftest test-data-access-tests\n  (let [data-access (create-test-data-access)]\n\n    (testing \"find-attractions returns matching attractions\"\n      (let [result (find-attractions data-access \"Test\" by-name 10)]\n        (is (ok? result))\n        (is (= 1 (count (:ok result))))))\n\n    (testing \"find-artists-from-location\"\n      (let [result (find-artists-from-location data-access \"Test City\" 10)]\n        (is (ok? result))))))\n\n(deftest failing-data-access-tests\n  (let [data-access (create-failing-data-access)]\n\n    (testing \"find-artists-from-location returns error\"\n      (let [result (find-artists-from-location data-access \"Q123\" 10)]\n        (is (error? result))))))\n</code></pre>"},{"location":"clojure/part-6/#134","title":"13.4 \u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8","text":"<p>\u30e9\u30f3\u30c0\u30e0\u306a\u5165\u529b\u3067\u4e0d\u5909\u6761\u4ef6\u3092\u691c\u8a3c\u3057\u307e\u3059\u3002</p> <pre><code>;; \u30e9\u30f3\u30c0\u30e0\u30c7\u30fc\u30bf\u751f\u6210\n(defn random-location []\n  (location\n   (str \"Q\" (rand-int 10000))\n   (random-string 10)\n   (rand-int 10000000)))\n\n(defn random-attractions [n]\n  (repeatedly n random-attraction))\n\n;; \u30d7\u30ed\u30d1\u30c6\u30a3\u30c6\u30b9\u30c8\n(deftest property-filter-popular-locations-tests\n  (testing \"result size is at most input size\"\n    (dotimes [_ 100]\n      (let [n (inc (rand-int 20))\n            locations (repeatedly n random-location)\n            min-pop (rand-int 10000000)\n            result (filter-popular-locations locations min-pop)]\n        (is (&lt;= (count result) n)))))\n\n  (testing \"all results meet minimum population\"\n    (dotimes [_ 100]\n      (let [locations (repeatedly 10 random-location)\n            min-pop (rand-int 10000000)\n            result (filter-popular-locations locations min-pop)]\n        (is (every? #(&gt;= (:population %) min-pop) result))))))\n</code></pre> <p></p>"},{"location":"clojure/part-6/#135","title":"13.5 \u7d71\u5408\u30c6\u30b9\u30c8","text":"<pre><code>(deftest integration-travel-guide-tests\n  (testing \"end-to-end travel guide workflow\"\n    (let [data-access (create-cached-data-access (create-test-data-access))\n          ;; \u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\n          validation (validate-search-params \"Test\" 3)]\n      (is (ok? validation))\n\n      ;; \u30ac\u30a4\u30c9\u53d6\u5f97\n      (let [result (get-travel-guide data-access \"Test\")]\n        (is (ok? result))\n        (let [guide (:ok result)]\n          (is (some? (:attraction guide)))\n          (is (vector? (:subjects guide)))\n          (is (some? (:search-report guide)))))))\n\n  (testing \"workflow with partial failure\"\n    (let [data-access (create-failing-data-access)\n          result (get-travel-guide data-access \"Test\")]\n      (is (ok? result))\n      (let [guide (:ok result)]\n        (is (= 2 (count (get-in guide [:search-report :errors]))))))))\n</code></pre>"},{"location":"clojure/part-6/#136","title":"13.6 \u30c6\u30b9\u30c8\u30d4\u30e9\u30df\u30c3\u30c9","text":""},{"location":"clojure/part-6/#_1","title":"\u307e\u3068\u3081","text":""},{"location":"clojure/part-6/#part-vi","title":"Part VI \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"clojure/part-6/#clojure-vs-scala","title":"Clojure vs Scala \u306e\u6bd4\u8f03","text":"\u6982\u5ff5 Scala Clojure \u30c9\u30e1\u30a4\u30f3\u30e2\u30c7\u30eb case class defrecord \u62bd\u8c61\u5316 trait defprotocol \u30ea\u30bd\u30fc\u30b9\u7ba1\u7406 Resource with-resource \u30ad\u30e3\u30c3\u30b7\u30e5 Ref atom \u30a8\u30e9\u30fc\u51e6\u7406 Either {:ok ...} / {:error ...} \u30c6\u30b9\u30c8 ScalaTest clojure.test"},{"location":"clojure/part-6/#_2","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>\u30d7\u30ed\u30c8\u30b3\u30eb\u306b\u3088\u308b\u62bd\u8c61\u5316: DataAccess \u3067\u5916\u90e8\u4f9d\u5b58\u3092\u62bd\u8c61\u5316</li> <li>with-resource \u3067\u30ea\u30bd\u30fc\u30b9\u7ba1\u7406: \u5b89\u5168\u306a\u30ea\u30bd\u30fc\u30b9\u306e\u53d6\u5f97\u3068\u89e3\u653e</li> <li>atom \u3067\u30ad\u30e3\u30c3\u30b7\u30e5: \u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u72b6\u614b\u7ba1\u7406</li> <li>Result \u30de\u30c3\u30d7\u3067\u30a8\u30e9\u30fc\u51e6\u7406: \u660e\u793a\u7684\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0</li> <li>SearchReport: \u30c6\u30b9\u30c8\u53ef\u80fd\u6027\u3068\u53ef\u89b3\u6e2c\u6027\u306e\u5411\u4e0a</li> <li>\u30b9\u30bf\u30d6: \u5916\u90e8\u4f9d\u5b58\u3092\u5dee\u3057\u66ff\u3048\u3066\u30c6\u30b9\u30c8</li> <li>\u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8: \u30e9\u30f3\u30c0\u30e0\u5165\u529b\u3067\u4e0d\u5909\u6761\u4ef6\u3092\u691c\u8a3c</li> </ol>"},{"location":"clojure/part-6/#_3","title":"\u5b66\u7fd2\u306e\u7dcf\u62ec","text":""},{"location":"clojure/part-6/#_4","title":"\u30b7\u30ea\u30fc\u30ba\u5168\u4f53\u306e\u7dcf\u62ec","text":"<p>\u672c\u30b7\u30ea\u30fc\u30ba\u3067\u306f\u3001\u300cGrokking Functional Programming\u300d\u306e\u5185\u5bb9\u306b\u6cbf\u3063\u3066\u3001Clojure \u3067\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u790e\u304b\u3089\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u307e\u3067\u3092\u5b66\u3073\u307e\u3057\u305f\u3002</p>"},{"location":"clojure/part-6/#_5","title":"\u5b66\u3093\u3060\u4e3b\u306a\u6982\u5ff5","text":"Part \u7ae0 \u4e3b\u306a\u6982\u5ff5 I 1-2 \u7d14\u7c8b\u95a2\u6570\u3001\u53c2\u7167\u900f\u904e\u6027 II 3-5 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u3001\u9ad8\u968e\u95a2\u6570\u3001mapcat III 6-7 nil \u5b89\u5168\u6027\u3001Result \u30d1\u30bf\u30fc\u30f3\u3001ADT IV 8-9 \u72b6\u614b\u7ba1\u7406\u3001\u9045\u5ef6\u30b7\u30fc\u30b1\u30f3\u30b9\u3001\u30c8\u30e9\u30f3\u30b9\u30c7\u30e5\u30fc\u30b5\u30fc V 10-11 atom/ref/agent\u3001core.async VI 12-13 \u5b9f\u8df5\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3001\u30c6\u30b9\u30c8"},{"location":"clojure/part-6/#clojure","title":"Clojure \u306b\u304a\u3051\u308b\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u5229\u70b9","text":"<ol> <li>\u30b7\u30f3\u30d7\u30eb\u3055: Lisp \u306e S \u5f0f\u306b\u3088\u308b\u4e00\u8cab\u3057\u305f\u69cb\u6587</li> <li>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u304c\u30c7\u30d5\u30a9\u30eb\u30c8: \u6c38\u7d9a\u30c7\u30fc\u30bf\u69cb\u9020</li> <li>\u8c4a\u5bcc\u306a\u4e26\u884c\u30d7\u30ea\u30df\u30c6\u30a3\u30d6: atom, ref, agent, core.async</li> <li>\u9045\u5ef6\u8a55\u4fa1: \u52b9\u7387\u7684\u306a\u30b7\u30fc\u30b1\u30f3\u30b9\u51e6\u7406</li> <li>REPL \u99c6\u52d5\u958b\u767a: \u30a4\u30f3\u30bf\u30e9\u30af\u30c6\u30a3\u30d6\u306a\u958b\u767a\u4f53\u9a13</li> <li>Java \u76f8\u4e92\u904b\u7528: \u8c4a\u5bcc\u306a\u30a8\u30b3\u30b7\u30b9\u30c6\u30e0\u3078\u306e\u30a2\u30af\u30bb\u30b9</li> </ol>"},{"location":"clojure/part-6/#_6","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<ul> <li>spec \u3084 malli \u306b\u3088\u308b\u4ed5\u69d8\u8a18\u8ff0\u3068\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3</li> <li>Component \u3084 Integrant \u306b\u3088\u308b\u30b7\u30b9\u30c6\u30e0\u69cb\u6210</li> <li>re-frame \u3084 Fulcro \u306b\u3088\u308b\u30d5\u30ed\u30f3\u30c8\u30a8\u30f3\u30c9\u958b\u767a</li> <li>\u5b9f\u969b\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067 Clojure \u3092\u9069\u7528\u3059\u308b</li> </ul>"},{"location":"csharp/","title":"Grokking Functional Programming \u65e5\u672c\u8a9e\u89e3\u8aac\uff08C# \u7248\uff09","text":"<p>\u672c\u30b7\u30ea\u30fc\u30ba\u306f\u300cGrokking Functional Programming\u300d\uff08Micha\u0142 P\u0142achta \u8457\uff09\u306e\u5b66\u7fd2\u30b3\u30f3\u30d1\u30cb\u30aa\u30f3\u3068\u3057\u3066\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u6982\u5ff5\u3092 C# \u3068 LanguageExt \u30e9\u30a4\u30d6\u30e9\u30ea\u3067\u5b9f\u88c5\u3057\u306a\u304c\u3089\u65e5\u672c\u8a9e\u3067\u89e3\u8aac\u3057\u307e\u3059\u3002</p>"},{"location":"csharp/#_1","title":"\u5bfe\u8c61\u8aad\u8005","text":"<ul> <li>C# \u306e\u7d4c\u9a13\u304c\u3042\u308a\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u8208\u5473\u304c\u3042\u308b\u958b\u767a\u8005</li> <li>\u65e2\u5b58\u306e C# \u30b3\u30fc\u30c9\u30d9\u30fc\u30b9\u306b FP \u306e\u6982\u5ff5\u3092\u5c0e\u5165\u3057\u305f\u3044\u65b9</li> <li>LanguageExt \u3092\u4f7f\u3063\u305f\u5b9f\u8df5\u7684\u306a FP \u3092\u5b66\u3073\u305f\u3044 .NET \u30a8\u30f3\u30b8\u30cb\u30a2</li> </ul>"},{"location":"csharp/#_2","title":"\u8a18\u4e8b\u4e00\u89a7","text":""},{"location":"csharp/#part-i","title":"Part I: \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u790e","text":"<p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u672c\u6982\u5ff5\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c1\u7ae0 \u547d\u4ee4\u578b vs \u95a2\u6570\u578b\u3001C# \u3067\u306e FP \u57fa\u672c\u69cb\u6587 \u7b2c2\u7ae0 \u7d14\u7c8b\u95a2\u6570\u3001\u526f\u4f5c\u7528\u306e\u6392\u9664\u3001\u30c6\u30b9\u30c8\u306e\u5bb9\u6613\u3055 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: \u7d14\u7c8b\u95a2\u6570\u3001\u53c2\u7167\u900f\u904e\u6027\u3001\u526f\u4f5c\u7528\u3001\u5f0f\u30d9\u30fc\u30b9\u306e\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0</p>"},{"location":"csharp/#part-ii","title":"Part II: \u95a2\u6570\u578b\u30b9\u30bf\u30a4\u30eb\u306e\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0","text":"<p>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c\u3068\u9ad8\u968e\u95a2\u6570\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c3\u7ae0 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u3001Seq \u64cd\u4f5c \u7b2c4\u7ae0 \u9ad8\u968e\u95a2\u6570\u3001Map/Filter/Fold \u7b2c5\u7ae0 Bind\uff08flatMap\uff09\u3001LINQ \u30af\u30a8\u30ea\u5f0f <p>\u30ad\u30fc\u30ef\u30fc\u30c9: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u3001\u9ad8\u968e\u95a2\u6570\u3001Seq\u3001LINQ</p>"},{"location":"csharp/#part-iii-optioneither","title":"Part III: \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3068 Option/Either","text":"<p>\u578b\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c6\u7ae0 Option \u578b\u3001Some/None \u7b2c7\u7ae0 Either \u578b\u3001Union \u578b\u3001\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: Option\u3001Either\u3001Union\uff08\u5224\u5225\u5171\u7528\u4f53\uff09\u3001\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0</p>"},{"location":"csharp/#part-iv-io","title":"Part IV: IO \u3068\u526f\u4f5c\u7528\u306e\u7ba1\u7406","text":"<p>\u526f\u4f5c\u7528\u306e\u7ba1\u7406\u3068\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c8\u7ae0 Eff \u30e2\u30ca\u30c9\u3001\u526f\u4f5c\u7528\u306e\u9045\u5ef6\u5b9f\u884c \u7b2c9\u7ae0 StreamT\u3001\u975e\u540c\u671f\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: Eff\u3001IO \u30e2\u30ca\u30c9\u3001\u9045\u5ef6\u8a55\u4fa1\u3001\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406</p>"},{"location":"csharp/#part-v","title":"Part V: \u4e26\u884c\u51e6\u7406","text":"<p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u4e26\u884c\u51e6\u7406\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c10\u7ae0 Atom\uff08\u30a2\u30c8\u30df\u30c3\u30af\u53c2\u7167\uff09\u3001\u4e26\u5217\u51e6\u7406 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: \u4e26\u884c\u51e6\u7406\u3001Atom\u3001Aff\u3001\u4e26\u5217\u5b9f\u884c</p>"},{"location":"csharp/#part-vi","title":"Part VI: \u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u3068\u30c6\u30b9\u30c8","text":"<p>\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u3068\u30c6\u30b9\u30c8\u6226\u7565\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c11\u7ae0 TravelGuide \u30a2\u30d7\u30ea\u3001Resource \u7ba1\u7406 \u7b2c12\u7ae0 \u30c6\u30b9\u30c8\u6226\u7565\u3001\u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: Resource \u7ba1\u7406\u3001\u4f9d\u5b58\u6027\u6ce8\u5165\u3001FsCheck/Hedgehog</p>"},{"location":"csharp/#_3","title":"\u5b66\u7fd2\u30d1\u30b9","text":""},{"location":"csharp/#_4","title":"\u4f7f\u7528\u30e9\u30a4\u30d6\u30e9\u30ea","text":"\u30e9\u30a4\u30d6\u30e9\u30ea \u7528\u9014 \u5bfe\u5fdc\u7ae0 C# 12 / .NET 8 \u8a00\u8a9e\u30fb\u30e9\u30f3\u30bf\u30a4\u30e0 \u5168\u7ae0 LanguageExt \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u30e9\u30a4\u30d6\u30e9\u30ea \u5168\u7ae0 FsCheck \u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8 Part VI"},{"location":"csharp/#languageext","title":"LanguageExt \u3068\u306f","text":"<p>LanguageExt \u306f C# \u3067\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u3092\u5b9f\u73fe\u3059\u308b\u305f\u3081\u306e\u5f37\u529b\u306a\u30e9\u30a4\u30d6\u30e9\u30ea\u3067\u3059\u3002</p>"},{"location":"csharp/#_5","title":"\u4e3b\u8981\u306a\u6a5f\u80fd","text":"\u6a5f\u80fd \u8aac\u660e Option&lt;A&gt; null \u5b89\u5168\u306a\u5024\u306e\u8868\u73fe Either&lt;L, R&gt; \u6210\u529f/\u5931\u6557\u3092\u578b\u3067\u8868\u73fe Seq&lt;A&gt; \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30b7\u30fc\u30b1\u30f3\u30b9 Map&lt;K, V&gt; \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u8f9e\u66f8 Eff&lt;A&gt; / Aff&lt;A&gt; \u526f\u4f5c\u7528\u306e\u7ba1\u7406\uff08\u540c\u671f/\u975e\u540c\u671f\uff09 Atom&lt;A&gt; \u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u72b6\u614b\u7ba1\u7406 Record \u578b \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30ec\u30b3\u30fc\u30c9"},{"location":"csharp/#_6","title":"\u30ea\u30dd\u30b8\u30c8\u30ea\u69cb\u6210","text":"<pre><code>grokkingfp-examples/\n\u251c\u2500\u2500 app/csharp/src/           # C# \u306e\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n\u2502   \u251c\u2500\u2500 Ch01/                 # \u7b2c1\u7ae0: FP \u5165\u9580\n\u2502   \u251c\u2500\u2500 Ch02/                 # \u7b2c2\u7ae0: \u7d14\u7c8b\u95a2\u6570\n\u2502   \u251c\u2500\u2500 Ch03/                 # \u7b2c3\u7ae0: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\n\u2502   \u251c\u2500\u2500 Ch04/                 # \u7b2c4\u7ae0: \u9ad8\u968e\u95a2\u6570\n\u2502   \u251c\u2500\u2500 Ch05/                 # \u7b2c5\u7ae0: Bind\n\u2502   \u251c\u2500\u2500 Ch06/                 # \u7b2c6\u7ae0: Option\n\u2502   \u251c\u2500\u2500 Ch07/                 # \u7b2c7\u7ae0: Either\n\u2502   \u251c\u2500\u2500 Ch08/                 # \u7b2c8\u7ae0: Eff\n\u2502   \u251c\u2500\u2500 Ch09/                 # \u7b2c9\u7ae0: Stream\n\u2502   \u251c\u2500\u2500 Ch10/                 # \u7b2c10\u7ae0: \u4e26\u884c\u51e6\u7406\n\u2502   \u251c\u2500\u2500 Ch11/                 # \u7b2c11\u7ae0: \u5b9f\u8df5\u30a2\u30d7\u30ea\n\u2502   \u2514\u2500\u2500 Ch12/                 # \u7b2c12\u7ae0: \u30c6\u30b9\u30c8\n\u251c\u2500\u2500 app/csharp/tests/         # \u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\n\u2514\u2500\u2500 docs/article/csharp/      # \u89e3\u8aac\u8a18\u4e8b\uff08\u672c\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\uff09\n    \u251c\u2500\u2500 index.md              # \u3053\u306e\u8a18\u4e8b\n    \u251c\u2500\u2500 part-1.md             # Part I\n    \u251c\u2500\u2500 part-2.md             # Part II\n    \u251c\u2500\u2500 part-3.md             # Part III\n    \u251c\u2500\u2500 part-4.md             # Part IV\n    \u251c\u2500\u2500 part-5.md             # Part V\n    \u2514\u2500\u2500 part-6.md             # Part VI\n</code></pre>"},{"location":"csharp/#c","title":"C# \u3067\u306e\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0","text":"<p>C# \u306f\u5143\u3005\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u6307\u5411\u8a00\u8a9e\u3067\u3059\u304c\u3001\u8fd1\u5e74\u306e\u9032\u5316\u306b\u3088\u308a\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u30b5\u30dd\u30fc\u30c8\u304c\u5f37\u5316\u3055\u308c\u3066\u3044\u307e\u3059:</p>"},{"location":"csharp/#_7","title":"\u8a00\u8a9e\u6a5f\u80fd\u306e\u9032\u5316","text":"\u30d0\u30fc\u30b8\u30e7\u30f3 \u6a5f\u80fd C# 3.0 LINQ\u3001\u30e9\u30e0\u30c0\u5f0f C# 6.0 \u5f0f\u5f62\u5f0f\u30e1\u30f3\u30d0\u30fc C# 7.0 \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3001\u30bf\u30d7\u30eb C# 8.0 switch \u5f0f\u3001null \u8a31\u5bb9\u53c2\u7167\u578b C# 9.0 record \u578b\u3001init-only \u30d7\u30ed\u30d1\u30c6\u30a3 C# 10.0 record struct\u3001global using C# 11.0 \u30ea\u30b9\u30c8 \u30d1\u30bf\u30fc\u30f3 C# 12.0 \u30d7\u30e9\u30a4\u30de\u30ea\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u3001\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u5f0f"},{"location":"csharp/#languageext_1","title":"LanguageExt \u304c\u88dc\u5b8c\u3059\u308b\u6a5f\u80fd","text":"<p>C# \u6a19\u6e96\u3067\u306f\u4e0d\u8db3\u3057\u3066\u3044\u308b\u4ee5\u4e0b\u306e\u6a5f\u80fd\u3092 LanguageExt \u304c\u63d0\u4f9b:</p> \u4e0d\u8db3\u6a5f\u80fd LanguageExt \u3067\u306e\u89e3\u6c7a Option \u578b <code>Option&lt;A&gt;</code> Either \u578b <code>Either&lt;L, R&gt;</code> \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30b3\u30ec\u30af\u30b7\u30e7\u30f3 <code>Seq&lt;A&gt;</code>, <code>Map&lt;K, V&gt;</code>, <code>Set&lt;A&gt;</code> IO \u30e2\u30ca\u30c9 <code>Eff&lt;A&gt;</code>, <code>Aff&lt;A&gt;</code> \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50 \u62e1\u5f35\u30e1\u30bd\u30c3\u30c9 <code>.Map()</code>, <code>.Bind()</code> \u90e8\u5206\u9069\u7528 <code>fun</code>, <code>curry</code> \u95a2\u6570"},{"location":"csharp/#_8","title":"\u4ed6\u8a00\u8a9e\u3068\u306e\u6bd4\u8f03","text":"\u6982\u5ff5 Scala F# C# + LanguageExt \u8a00\u8a9e\u30d1\u30e9\u30c0\u30a4\u30e0 \u30de\u30eb\u30c1\u30d1\u30e9\u30c0\u30a4\u30e0 \u95a2\u6570\u578b\u30d5\u30a1\u30fc\u30b9\u30c8 OOP + FP \u30e9\u30a4\u30d6\u30e9\u30ea \u5b9f\u884c\u74b0\u5883 JVM .NET (CLR) .NET (CLR) Option \u578b <code>Option[A]</code> <code>Option&lt;'a&gt;</code> <code>Option&lt;A&gt;</code> Either/Result <code>Either[E, A]</code> <code>Result&lt;'a, 'e&gt;</code> <code>Either&lt;L, R&gt;</code> ADT <code>sealed trait</code> \u5224\u5225\u5171\u7528\u4f53 <code>Union</code> / <code>record</code> for \u5185\u5305\u8868\u8a18 <code>for { ... } yield</code> \u30b3\u30f3\u30d4\u30e5\u30c6\u30fc\u30b7\u30e7\u30f3\u5f0f LINQ \u30af\u30a8\u30ea\u5f0f \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3 \u30e1\u30bd\u30c3\u30c9\u30c1\u30a7\u30fc\u30f3 <code>\\|&gt;</code> \u6f14\u7b97\u5b50 <code>.Map().Bind()</code> IO \u30e2\u30ca\u30c9 <code>IO[A]</code> (cats-effect) <code>Async&lt;'a&gt;</code> <code>Eff&lt;A&gt;</code> / <code>Aff&lt;A&gt;</code> \u30a2\u30c8\u30df\u30c3\u30af\u53c2\u7167 <code>Ref[IO, A]</code> <code>ref</code> <code>Atom&lt;A&gt;</code>"},{"location":"csharp/#_9","title":"\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u5229\u70b9","text":"<p>\u672c\u30b7\u30ea\u30fc\u30ba\u3092\u901a\u3058\u3066\u3001\u4ee5\u4e0b\u306e\u5229\u70b9\u3092\u5b9f\u611f\u3067\u304d\u307e\u3059:</p> <ol> <li>\u4e88\u6e2c\u53ef\u80fd\u6027 - \u7d14\u7c8b\u95a2\u6570\u306f\u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b</li> <li>\u30c6\u30b9\u30c8\u5bb9\u6613\u6027 - \u526f\u4f5c\u7528\u304c\u306a\u3044\u305f\u3081\u30c6\u30b9\u30c8\u304c\u7c21\u5358</li> <li>\u5408\u6210\u53ef\u80fd\u6027 - \u5c0f\u3055\u306a\u95a2\u6570\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u8907\u96d1\u306a\u51e6\u7406\u3092\u69cb\u7bc9</li> <li>\u4e26\u884c\u5b89\u5168\u6027 - \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u306f\u7af6\u5408\u72b6\u614b\u3092\u9632\u3050</li> <li>\u578b\u5b89\u5168\u6027 - Option\u3001Either \u3067 null \u3084\u4f8b\u5916\u3092\u578b\u3067\u8868\u73fe</li> </ol>"},{"location":"csharp/#_10","title":"\u53c2\u8003\u8cc7\u6599","text":"<ul> <li>Grokking Functional Programming - \u539f\u8457</li> <li>LanguageExt GitHub - LanguageExt \u30ea\u30dd\u30b8\u30c8\u30ea</li> <li>LanguageExt \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8 - \u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8</li> <li>C# \u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8</li> <li>Functional Programming in C# - C# \u3067\u306e FP \u66f8\u7c4d</li> </ul>"},{"location":"csharp/part-1/","title":"Part I: \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u790e","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\uff08FP\uff09\u306e\u57fa\u672c\u6982\u5ff5\u3092 C# \u3068 LanguageExt \u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u4f7f\u3063\u3066\u5b66\u3073\u307e\u3059\u3002\u547d\u4ee4\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u3068\u306e\u9055\u3044\u3092\u7406\u89e3\u3057\u3001\u7d14\u7c8b\u95a2\u6570\u306e\u5229\u70b9\u3092\u5b9f\u611f\u3059\u308b\u3053\u3068\u304c\u76ee\u6a19\u3067\u3059\u3002</p>"},{"location":"csharp/part-1/#1","title":"\u7b2c1\u7ae0: \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u5165\u9580","text":""},{"location":"csharp/part-1/#11-vs","title":"1.1 \u547d\u4ee4\u578b vs \u95a2\u6570\u578b","text":"<p>\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u306f\u5927\u304d\u304f\u5206\u3051\u30662\u3064\u306e\u30d1\u30e9\u30c0\u30a4\u30e0\u304c\u3042\u308a\u307e\u3059\u3002</p> <p></p> <p>\u547d\u4ee4\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306f\u300c\u3069\u3046\u3084\u308b\u304b\u300d\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002</p> <pre><code>// \u547d\u4ee4\u578b\u3067\u30ef\u30fc\u30c9\u30b9\u30b3\u30a2\u3092\u8a08\u7b97\npublic static int WordScoreImperative(string word)\n{\n    var score = 0;\n    foreach (var _ in word)\n    {\n        score = score + 1;\n    }\n    return score;\n}\n</code></pre> <p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306f\u300c\u4f55\u3092\u3059\u308b\u304b\u300d\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002</p> <pre><code>// \u95a2\u6570\u578b\u3067\u30ef\u30fc\u30c9\u30b9\u30b3\u30a2\u3092\u8a08\u7b97\npublic static int WordScore(string word) =&gt; word.Length;\n</code></pre>"},{"location":"csharp/part-1/#12-c","title":"1.2 C# \u3067\u306e\u57fa\u672c\u7684\u306a\u95a2\u6570\u5b9a\u7fa9","text":"<p>C# \u3067\u306f\u5f0f\u5f62\u5f0f\u30e1\u30f3\u30d0\u30fc\uff08expression-bodied member\uff09\u3092\u4f7f\u3063\u3066\u7c21\u6f54\u306b\u95a2\u6570\u3092\u5b9a\u7fa9\u3067\u304d\u307e\u3059\u3002</p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/csharp/src/Ch01/IntroCSharp.cs</code></p> <pre><code>/// &lt;summary&gt;\n/// \u6570\u5024\u3092\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\n/// &lt;/summary&gt;\npublic static int Increment(int x) =&gt; x + 1;\n\n/// &lt;summary&gt;\n/// \u6587\u5b57\u5217\u306e\u6700\u521d\u306e\u6587\u5b57\u3092\u53d6\u5f97\n/// &lt;/summary&gt;\npublic static char GetFirstCharacter(string s) =&gt; s[0];\n\n/// &lt;summary&gt;\n/// \u5358\u8a9e\u306e\u30b9\u30b3\u30a2\u3092\u8a08\u7b97\uff08\u6587\u5b57\u6570\uff09\n/// &lt;/summary&gt;\npublic static int WordScore(string word) =&gt; word.Length;\n\n/// &lt;summary&gt;\n/// 2\u3064\u306e\u6570\u5024\u3092\u52a0\u7b97\n/// &lt;/summary&gt;\npublic static int Add(int a, int b) =&gt; a + b;\n\n/// &lt;summary&gt;\n/// \u6570\u5024\u30922\u500d\u306b\u3059\u308b\n/// &lt;/summary&gt;\npublic static int Double(int x) =&gt; x * 2;\n\n/// &lt;summary&gt;\n/// \u6570\u5024\u304c\u5076\u6570\u304b\u3069\u3046\u304b\u3092\u5224\u5b9a\n/// &lt;/summary&gt;\npublic static bool IsEven(int n) =&gt; n % 2 == 0;\n</code></pre>"},{"location":"csharp/part-1/#13","title":"1.3 \u95a2\u6570\u306e\u69cb\u9020","text":""},{"location":"csharp/part-1/#14-languageext","title":"1.4 LanguageExt \u306b\u3088\u308b\u30ab\u30ea\u30fc\u5316\u3068\u90e8\u5206\u9069\u7528","text":"<p>C# \u3067\u306f\u6a19\u6e96\u3067\u306f\u30ab\u30ea\u30fc\u5316\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u307e\u305b\u3093\u304c\u3001LanguageExt \u3092\u4f7f\u3046\u3053\u3068\u3067\u5b9f\u73fe\u3067\u304d\u307e\u3059\u3002</p> <pre><code>using LanguageExt;\nusing static LanguageExt.Prelude;\n\n/// &lt;summary&gt;\n/// \u30ab\u30ea\u30fc\u5316\u3055\u308c\u305f\u52a0\u7b97\u95a2\u6570\n/// curry \u3092\u4f7f\u7528\u3057\u3066 (int, int) -&gt; int \u3092 int -&gt; int -&gt; int \u306b\u5909\u63db\n/// &lt;/summary&gt;\npublic static Func&lt;int, Func&lt;int, int&gt;&gt; AddCurried =&gt;\n    curry&lt;int, int, int&gt;((a, b) =&gt; a + b);\n\n/// &lt;summary&gt;\n/// \u90e8\u5206\u9069\u7528: 5\u3092\u52a0\u7b97\u3059\u308b\u95a2\u6570\n/// &lt;/summary&gt;\npublic static Func&lt;int, int&gt; AddFive =&gt; AddCurried(5);\n\n// \u4f7f\u7528\u4f8b\nvar result = AddFive(3);  // 8\n</code></pre>"},{"location":"csharp/part-1/#15-languageext-seq","title":"1.5 LanguageExt \u306e Seq \u3092\u4f7f\u3063\u305f\u64cd\u4f5c","text":"<p>LanguageExt \u306e <code>Seq&lt;T&gt;</code> \u306f\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30b7\u30fc\u30b1\u30f3\u30b9\u3067\u3059\u3002</p> <pre><code>using LanguageExt;\nusing static LanguageExt.Prelude;\n\n/// &lt;summary&gt;\n/// Seq \u3092\u4f7f\u3063\u305f\u5ba3\u8a00\u7684\u306a\u30ea\u30b9\u30c8\u64cd\u4f5c\n/// &lt;/summary&gt;\npublic static Seq&lt;int&gt; DoubleAll(Seq&lt;int&gt; numbers) =&gt;\n    numbers.Map(x =&gt; x * 2);\n\n/// &lt;summary&gt;\n/// \u5076\u6570\u306e\u307f\u3092\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\n/// &lt;/summary&gt;\npublic static Seq&lt;int&gt; FilterEvens(Seq&lt;int&gt; numbers) =&gt;\n    numbers.Filter(IsEven);\n\n/// &lt;summary&gt;\n/// \u5408\u8a08\u3092\u8a08\u7b97\n/// &lt;/summary&gt;\npublic static int Sum(Seq&lt;int&gt; numbers) =&gt;\n    numbers.Fold(0, (acc, x) =&gt; acc + x);\n\n// \u4f7f\u7528\u4f8b\nvar numbers = Seq(1, 2, 3, 4, 5);\nvar doubled = DoubleAll(numbers);     // Seq(2, 4, 6, 8, 10)\nvar evens = FilterEvens(numbers);     // Seq(2, 4)\nvar total = Sum(numbers);             // 15\n</code></pre>"},{"location":"csharp/part-1/#16-option","title":"1.6 Option \u3092\u4f7f\u3063\u305f\u5b89\u5168\u306a\u64cd\u4f5c","text":"<p>LanguageExt \u306e <code>Option&lt;T&gt;</code> \u306f\u5024\u306e\u6709\u7121\u3092\u578b\u3067\u8868\u73fe\u3057\u307e\u3059\u3002</p> <pre><code>using LanguageExt;\nusing static LanguageExt.Prelude;\n\n/// &lt;summary&gt;\n/// \u5b89\u5168\u306b\u6700\u521d\u306e\u6587\u5b57\u3092\u53d6\u5f97\uff08\u7a7a\u6587\u5b57\u5217\u306e\u5834\u5408\u306f None\uff09\n/// &lt;/summary&gt;\npublic static Option&lt;char&gt; GetFirstCharacterSafe(string s) =&gt;\n    string.IsNullOrEmpty(s)\n        ? None\n        : Some(s[0]);\n\n/// &lt;summary&gt;\n/// \u5b89\u5168\u306a\u9664\u7b97\uff08\u30bc\u30ed\u9664\u7b97\u3092\u9632\u3050\uff09\n/// &lt;/summary&gt;\npublic static Option&lt;int&gt; SafeDivide(int a, int b) =&gt;\n    b == 0\n        ? None\n        : Some(a / b);\n\n// \u4f7f\u7528\u4f8b\nvar result = SafeDivide(10, 2);  // Some(5)\nvar error = SafeDivide(10, 0);   // None\n\n// \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3067\u51e6\u7406\nresult.Match(\n    Some: x =&gt; Console.WriteLine($\"\u7d50\u679c: {x}\"),\n    None: () =&gt; Console.WriteLine(\"\u9664\u7b97\u30a8\u30e9\u30fc\")\n);\n</code></pre>"},{"location":"csharp/part-1/#17","title":"1.7 \u95a2\u6570\u306e\u5408\u6210","text":"<p>\u8907\u6570\u306e\u95a2\u6570\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u65b0\u3057\u3044\u95a2\u6570\u3092\u4f5c\u6210\u3067\u304d\u307e\u3059\u3002</p> <pre><code>/// &lt;summary&gt;\n/// 2\u3064\u306e\u95a2\u6570\u3092\u5408\u6210\n/// &lt;/summary&gt;\npublic static Func&lt;A, C&gt; Compose&lt;A, B, C&gt;(Func&lt;A, B&gt; f, Func&lt;B, C&gt; g) =&gt;\n    x =&gt; g(f(x));\n\n/// &lt;summary&gt;\n/// \u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\u3057\u30662\u500d\u306b\u3059\u308b\u5408\u6210\u95a2\u6570\n/// &lt;/summary&gt;\npublic static Func&lt;int, int&gt; IncrementThenDouble =&gt;\n    Compose&lt;int, int, int&gt;(Increment, Double);\n\n/// &lt;summary&gt;\n/// 2\u500d\u306b\u3057\u3066\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\u3059\u308b\u5408\u6210\u95a2\u6570\n/// &lt;/summary&gt;\npublic static Func&lt;int, int&gt; DoubleThenIncrement =&gt;\n    Compose&lt;int, int, int&gt;(Double, Increment);\n\n// \u4f7f\u7528\u4f8b\nvar r1 = IncrementThenDouble(3);  // (3 + 1) * 2 = 8\nvar r2 = DoubleThenIncrement(3);  // (3 * 2) + 1 = 7\n</code></pre>"},{"location":"csharp/part-1/#18","title":"1.8 \u5b66\u7fd2\u30dd\u30a4\u30f3\u30c8","text":"\u6982\u5ff5 \u547d\u4ee4\u578b \u95a2\u6570\u578b \u7126\u70b9 \u624b\u9806\uff08How\uff09 \u7d50\u679c\uff08What\uff09 \u72b6\u614b \u5909\u66f4\u3059\u308b \u5909\u63db\u3059\u308b \u30eb\u30fc\u30d7 for/while Map/Filter/Fold \u30c7\u30fc\u30bf \u30df\u30e5\u30fc\u30bf\u30d6\u30eb \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb \u95a2\u6570 \u30e1\u30bd\u30c3\u30c9\u547c\u3073\u51fa\u3057 \u5f0f\u3068\u5408\u6210"},{"location":"csharp/part-1/#19-f-scala","title":"1.9 F# / Scala \u3068\u306e\u6bd4\u8f03","text":"\u6a5f\u80fd C# + LanguageExt F# Scala \u95a2\u6570\u5b9a\u7fa9 <code>int F(int x) =&gt; ...</code> <code>let f x = ...</code> <code>def f(x: Int) = ...</code> \u578b\u6ce8\u91c8 <code>(int x)</code> <code>(x: int)</code> <code>(x: Int)</code> \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3 <code>.Map().Filter()</code> <code>x \\|&gt; f</code> \u30e1\u30bd\u30c3\u30c9\u30c1\u30a7\u30fc\u30f3 \u90e8\u5206\u9069\u7528 <code>curry</code> \u3067\u5909\u63db \u30c7\u30d5\u30a9\u30eb\u30c8 <code>.curried</code> \u3067\u5909\u63db Option <code>Option&lt;T&gt;</code> <code>Option&lt;'a&gt;</code> <code>Option[A]</code> Seq <code>Seq&lt;T&gt;</code> <code>Seq&lt;'a&gt;</code> <code>Seq[A]</code>"},{"location":"csharp/part-1/#2","title":"\u7b2c2\u7ae0: \u7d14\u7c8b\u95a2\u6570\u3068\u30c6\u30b9\u30c8","text":""},{"location":"csharp/part-1/#21","title":"2.1 \u7d14\u7c8b\u95a2\u6570\u3068\u306f","text":"<p>\u7d14\u7c8b\u95a2\u6570\uff08Pure Function\uff09\u306f\u4ee5\u4e0b\u306e\u7279\u5fb4\u3092\u6301\u3064\u95a2\u6570\u3067\u3059:</p> <ol> <li>\u540c\u3058\u5165\u529b\u306b\u306f\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3059</li> <li>\u526f\u4f5c\u7528\u304c\u306a\u3044\uff08\u5916\u90e8\u72b6\u614b\u3092\u5909\u66f4\u3057\u306a\u3044\uff09</li> </ol> <p></p>"},{"location":"csharp/part-1/#22","title":"2.2 \u7d14\u7c8b\u95a2\u6570\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/csharp/src/Ch02/PureFunctions.cs</code></p> <pre><code>/// &lt;summary&gt;\n/// \u6570\u5024\u3092\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\uff08\u7d14\u7c8b\u95a2\u6570\uff09\n/// &lt;/summary&gt;\npublic static int Increment(int x) =&gt; x + 1;\n\n/// &lt;summary&gt;\n/// 2\u3064\u306e\u6570\u5024\u3092\u52a0\u7b97\uff08\u7d14\u7c8b\u95a2\u6570\uff09\n/// &lt;/summary&gt;\npublic static int Add(int a, int b) =&gt; a + b;\n\n/// &lt;summary&gt;\n/// \u6570\u5024\u30922\u500d\u306b\u3059\u308b\uff08\u7d14\u7c8b\u95a2\u6570\uff09\n/// &lt;/summary&gt;\npublic static int Double(int x) =&gt; x * 2;\n\n/// &lt;summary&gt;\n/// \u6570\u5024\u304c\u5076\u6570\u304b\u3069\u3046\u304b\u3092\u5224\u5b9a\uff08\u7d14\u7c8b\u95a2\u6570\uff09\n/// &lt;/summary&gt;\npublic static bool IsEven(int n) =&gt; n % 2 == 0;\n\n/// &lt;summary&gt;\n/// \u6587\u5b57\u5217\u3092\u5927\u6587\u5b57\u306b\u5909\u63db\uff08\u7d14\u7c8b\u95a2\u6570\uff09\n/// &lt;/summary&gt;\npublic static string ToUpperCase(string s) =&gt; s.ToUpper();\n\n/// &lt;summary&gt;\n/// \u6587\u5b57\u5217\u3092\u53cd\u8ee2\uff08\u7d14\u7c8b\u95a2\u6570\uff09\n/// &lt;/summary&gt;\npublic static string Reverse(string s) =&gt;\n    new string(s.Reverse().ToArray());\n</code></pre> <p>\u7d14\u7c8b\u3067\u306f\u306a\u3044\u95a2\u6570\u306e\u4f8b:</p> <pre><code>/// &lt;summary&gt;\n/// \u4e0d\u7d14\u306a\u95a2\u6570 - \u6bce\u56de\u7570\u306a\u308b\u5024\u3092\u8fd4\u3059\n/// &lt;/summary&gt;\npublic static double RandomPart(double x) =&gt;\n    x * Random.Shared.NextDouble();\n\n/// &lt;summary&gt;\n/// \u4e0d\u7d14\u306a\u95a2\u6570 - \u73fe\u5728\u6642\u523b\u3092\u8fd4\u3059\n/// &lt;/summary&gt;\npublic static long CurrentTime() =&gt;\n    DateTimeOffset.UtcNow.ToUnixTimeMilliseconds();\n</code></pre>"},{"location":"csharp/part-1/#23","title":"2.3 \u30b7\u30e7\u30c3\u30d4\u30f3\u30b0\u30ab\u30fc\u30c8\u306e\u4f8b","text":"<p>\u72b6\u614b\u3092\u6301\u3064\u30af\u30e9\u30b9\u306e\u554f\u984c\u70b9\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p>"},{"location":"csharp/part-1/#_1","title":"\u554f\u984c\u306e\u3042\u308b\u30b3\u30fc\u30c9\uff08\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u6307\u5411\u7684\u306a\u30a2\u30d7\u30ed\u30fc\u30c1\uff09","text":"<pre><code>// \u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u72b6\u614b\u3092\u6301\u3064\u554f\u984c\u306e\u3042\u308b\u30a2\u30d7\u30ed\u30fc\u30c1\npublic class ShoppingCartBad\n{\n    private List&lt;string&gt; items = new();\n    private bool bookAdded = false;\n\n    public void AddItem(string item)\n    {\n        items.Add(item);\n        if (item == \"Book\")\n            bookAdded = true;\n    }\n\n    public int GetDiscountPercentage() =&gt;\n        bookAdded ? 5 : 0;\n\n    public List&lt;string&gt; GetItems() =&gt; items;  // \u554f\u984c: \u5185\u90e8\u72b6\u614b\u3078\u306e\u53c2\u7167\n}\n</code></pre>"},{"location":"csharp/part-1/#_2","title":"\u7d14\u7c8b\u95a2\u6570\u306b\u3088\u308b\u89e3\u6c7a","text":"<pre><code>using LanguageExt;\nusing static LanguageExt.Prelude;\n\n/// &lt;summary&gt;\n/// \u30ab\u30fc\u30c8\u5185\u306e\u5546\u54c1\u30ea\u30b9\u30c8\u304b\u3089\u5272\u5f15\u7387\u3092\u8a08\u7b97\n/// Book \u304c\u542b\u307e\u308c\u3066\u3044\u308c\u3070 5%\u3001\u305d\u308c\u4ee5\u5916\u306f 0%\n/// &lt;/summary&gt;\npublic static int GetDiscountPercentage(Seq&lt;string&gt; items) =&gt;\n    items.Exists(x =&gt; x == \"Book\") ? 5 : 0;\n\n/// &lt;summary&gt;\n/// \u5546\u54c1\u3092\u8ffd\u52a0\u3057\u305f\u65b0\u3057\u3044\u30ab\u30fc\u30c8\u3092\u8fd4\u3059\n/// &lt;/summary&gt;\npublic static Seq&lt;string&gt; AddItem(Seq&lt;string&gt; items, string item) =&gt;\n    items.Add(item);\n\n/// &lt;summary&gt;\n/// \u5546\u54c1\u3092\u524a\u9664\u3057\u305f\u65b0\u3057\u3044\u30ab\u30fc\u30c8\u3092\u8fd4\u3059\n/// &lt;/summary&gt;\npublic static Seq&lt;string&gt; RemoveItem(Seq&lt;string&gt; items, string item) =&gt;\n    items.Filter(i =&gt; i != item);\n</code></pre>"},{"location":"csharp/part-1/#24","title":"2.4 \u8907\u6570\u6761\u4ef6\u306b\u3088\u308b\u5272\u5f15\u8a08\u7b97","text":"<p>C# \u306e\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\uff08switch \u5f0f\uff09\u3092\u4f7f\u3063\u305f\u8907\u96d1\u306a\u30d3\u30b8\u30cd\u30b9\u30ed\u30b8\u30c3\u30af\u306e\u5b9f\u88c5:</p> <pre><code>/// &lt;summary&gt;\n/// \u8907\u6570\u306e\u6761\u4ef6\u306b\u3088\u308b\u5272\u5f15\u8a08\u7b97\n/// &lt;/summary&gt;\npublic static int GetAdvancedDiscountPercentage(Seq&lt;string&gt; items)\n{\n    var hasBook = items.Exists(x =&gt; x == \"Book\");\n    var hasElectronics = items.Exists(item =&gt;\n        item == \"Laptop\" || item == \"Phone\" || item == \"Tablet\");\n    var itemCount = items.Count;\n\n    return (hasBook, hasElectronics, itemCount) switch\n    {\n        (true, true, _) =&gt; 15,      // Book + \u96fb\u5b50\u6a5f\u5668 \u2192 15%\n        (true, _, &gt;= 5) =&gt; 10,      // Book + 5\u500b\u4ee5\u4e0a \u2192 10%\n        (true, _, _) =&gt; 5,          // Book \u306e\u307f \u2192 5%\n        (_, true, &gt;= 3) =&gt; 7,       // \u96fb\u5b50\u6a5f\u5668 + 3\u500b\u4ee5\u4e0a \u2192 7%\n        (_, _, &gt;= 10) =&gt; 5,         // 10\u500b\u4ee5\u4e0a \u2192 5%\n        _ =&gt; 0                      // \u305d\u308c\u4ee5\u5916 \u2192 0%\n    };\n}\n</code></pre>"},{"location":"csharp/part-1/#25","title":"2.5 \u30c1\u30c3\u30d7\u8a08\u7b97\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/csharp/src/Ch02/PureFunctions.cs</code></p> <pre><code>/// &lt;summary&gt;\n/// \u30b0\u30eb\u30fc\u30d7\u30b5\u30a4\u30ba\u306b\u5fdc\u3058\u305f\u30c1\u30c3\u30d7\u7387\u3092\u8a08\u7b97\n/// 6\u4eba\u4ee5\u4e0a \u2192 20%\n/// 1-5\u4eba \u2192 10%\n/// 0\u4eba \u2192 0%\n/// &lt;/summary&gt;\npublic static int GetTipPercentage(Seq&lt;string&gt; names)\n{\n    var size = names.Count;\n    if (size &gt; 5) return 20;\n    if (size &gt; 0) return 10;\n    return 0;\n}\n\n/// &lt;summary&gt;\n/// \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u4f7f\u7528\u3057\u305f\u30c1\u30c3\u30d7\u7387\u8a08\u7b97\n/// &lt;/summary&gt;\npublic static int GetTipPercentageMatch(Seq&lt;string&gt; names) =&gt;\n    names.Count switch\n    {\n        &gt; 5 =&gt; 20,\n        &gt; 0 =&gt; 10,\n        _ =&gt; 0\n    };\n</code></pre>"},{"location":"csharp/part-1/#option","title":"Option \u578b\u306b\u3088\u308b\u30bc\u30ed\u9664\u7b97\u306e\u9632\u6b62","text":"<pre><code>/// &lt;summary&gt;\n/// \u4e00\u4eba\u5f53\u305f\u308a\u306e\u652f\u6255\u984d\u3092\u8a08\u7b97\uff08\u30c1\u30c3\u30d7\u8fbc\u307f\uff09\n/// Option \u3092\u4f7f\u3063\u3066\u30bc\u30ed\u9664\u7b97\u3092\u9632\u3050\n/// &lt;/summary&gt;\npublic static Option&lt;decimal&gt; CalculatePerPerson(\n    decimal billAmount,\n    Seq&lt;string&gt; names)\n{\n    var size = names.Count;\n    if (size == 0)\n        return None;\n\n    var tip = CalculateTip(billAmount, names);\n    var total = billAmount + tip;\n    return Some(total / size);\n}\n</code></pre>"},{"location":"csharp/part-1/#26","title":"2.6 \u7d14\u7c8b\u95a2\u6570\u306e\u30c6\u30b9\u30c8","text":"<p>\u7d14\u7c8b\u95a2\u6570\u306f\u975e\u5e38\u306b\u30c6\u30b9\u30c8\u3057\u3084\u3059\u3044\u3067\u3059\u3002</p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/csharp/tests/Ch02/PureFunctionsTests.cs</code></p> <pre><code>[Fact]\npublic void Increment_AddsOneToNumber()\n{\n    Assert.Equal(7, PureFunctions.Increment(6));\n    Assert.Equal(1, PureFunctions.Increment(0));\n    Assert.Equal(-5, PureFunctions.Increment(-6));\n    Assert.Equal(int.MaxValue, PureFunctions.Increment(int.MaxValue - 1));\n}\n\n[Fact]\npublic void GetDiscountPercentage_Returns5WhenBookExists()\n{\n    var items = Seq(\"Apple\", \"Book\", \"Pen\");\n    Assert.Equal(5, ShoppingCart.GetDiscountPercentage(items));\n}\n\n[Fact]\npublic void SafeDivide_ReturnsNoneForDivisionByZero()\n{\n    Assert.True(PureFunctions.SafeDivide(10, 0).IsNone);\n}\n</code></pre> <p></p>"},{"location":"csharp/part-1/#27-a","title":"2.7 \u6587\u5b57 'a' \u3092\u9664\u5916\u3059\u308b\u30ef\u30fc\u30c9\u30b9\u30b3\u30a2","text":"<p>\u3088\u308a\u8907\u96d1\u306a\u4f8b\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p> <pre><code>/// &lt;summary&gt;\n/// 'a' \u3092\u9664\u5916\u3057\u305f\u6587\u5b57\u6570\u3092\u30b9\u30b3\u30a2\u3068\u3057\u3066\u8fd4\u3059\n/// &lt;/summary&gt;\npublic static int WordScore(string word) =&gt;\n    word.Replace(\"a\", \"\").Length;\n\n/// &lt;summary&gt;\n/// \u5927\u6587\u5b57\u5c0f\u6587\u5b57\u3092\u533a\u5225\u305b\u305a\u306b 'a' \u3092\u9664\u5916\n/// &lt;/summary&gt;\npublic static int WordScoreIgnoreCase(string word) =&gt;\n    word.Where(c =&gt; c != 'a' &amp;&amp; c != 'A').Count();\n</code></pre> <pre><code>// \u30c6\u30b9\u30c8\n[Fact]\npublic void WordScore_ExcludesLetterA()\n{\n    Assert.Equal(3, PureFunctions.WordScore(\"Scala\"));  // \"Scl\" \u2192 3\n    Assert.Equal(8, PureFunctions.WordScore(\"function\")); // 'a' \u306a\u3057 \u2192 8\n    Assert.Equal(0, PureFunctions.WordScore(\"\"));        // \u7a7a\u6587\u5b57 \u2192 0\n    Assert.Equal(0, PureFunctions.WordScore(\"aaa\"));     // \u3059\u3079\u3066 'a' \u2192 0\n}\n</code></pre>"},{"location":"csharp/part-1/#28","title":"2.8 \u53c2\u7167\u900f\u904e\u6027","text":"<p>\u7d14\u7c8b\u95a2\u6570\u306f\u53c2\u7167\u900f\u904e\u6027\uff08Referential Transparency\uff09\u3092\u6301\u3061\u307e\u3059\u3002</p> <p>\u5f0f\u3092\u305d\u306e\u8a55\u4fa1\u7d50\u679c\u3067\u7f6e\u304d\u63db\u3048\u3066\u3082\u3001\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u610f\u5473\u304c\u5909\u308f\u3089\u306a\u3044\u3053\u3068</p> <pre><code>// \u53c2\u7167\u900f\u904e\u6027\u306e\u4f8b\nvar score1 = WordScore(\"Scala\");\nvar score2 = WordScore(\"Scala\");\n// score1 \u3068 score2 \u306f\u5e38\u306b\u540c\u3058\u5024\uff083\uff09\n\n// \u4ee5\u4e0b\u306e2\u3064\u306f\u540c\u7b49\nvar total1 = WordScore(\"Scala\") + WordScore(\"Java\");\nvar total2 = 3 + 2;  // WordScore \u306e\u7d50\u679c\u3067\u7f6e\u304d\u63db\u3048\u53ef\u80fd\n</code></pre>"},{"location":"csharp/part-1/#_3","title":"\u307e\u3068\u3081","text":""},{"location":"csharp/part-1/#part-i_1","title":"Part I \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"csharp/part-1/#_4","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306f\u300c\u4f55\u3092\u3059\u308b\u304b\u300d\u3092\u5ba3\u8a00\u7684\u306b\u8a18\u8ff0\u3059\u308b</li> <li>\u5f0f\u5f62\u5f0f\u30e1\u30f3\u30d0\u30fc (<code>=&gt;</code>) \u3067\u7c21\u6f54\u306a\u95a2\u6570\u5b9a\u7fa9\u304c\u3067\u304d\u308b</li> <li>LanguageExt \u3067 C# \u306b\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u6a5f\u80fd\u3092\u8ffd\u52a0\u3067\u304d\u308b</li> <li>\u7d14\u7c8b\u95a2\u6570\u306f\u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3059</li> <li>\u526f\u4f5c\u7528\u3092\u907f\u3051\u308b\u3053\u3068\u3067\u30b3\u30fc\u30c9\u306e\u4e88\u6e2c\u53ef\u80fd\u6027\u304c\u5411\u4e0a\u3059\u308b</li> <li>switch \u5f0f\u3067\u8907\u96d1\u306a\u6761\u4ef6\u5206\u5c90\u3092\u7c21\u6f54\u306b\u8a18\u8ff0\u3067\u304d\u308b</li> <li>Option \u578b\u3067 null \u5b89\u5168\u306a\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u304c\u3067\u304d\u308b</li> <li>\u7d14\u7c8b\u95a2\u6570\u306f\u30c6\u30b9\u30c8\u304c\u975e\u5e38\u306b\u7c21\u5358</li> <li>\u53c2\u7167\u900f\u904e\u6027\u306b\u3088\u308a\u3001\u30b3\u30fc\u30c9\u306e\u7406\u89e3\u3068\u63a8\u8ad6\u304c\u5bb9\u6613\u306b\u306a\u308b</li> </ol>"},{"location":"csharp/part-1/#_5","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part II \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c</li> <li>\u9ad8\u968e\u95a2\u6570\uff08\u95a2\u6570\u3092\u5024\u3068\u3057\u3066\u6271\u3046\uff09</li> <li><code>Bind</code>\uff08flatMap\uff09\u3068\u30cd\u30b9\u30c8\u69cb\u9020\u306e\u5e73\u5766\u5316</li> <li>LINQ \u30af\u30a8\u30ea\u5f0f</li> </ul>"},{"location":"csharp/part-1/#_6","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"csharp/part-1/#1_1","title":"\u554f\u984c 1: \u7d14\u7c8b\u95a2\u6570\u306e\u8b58\u5225","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u306e\u3046\u3061\u3001\u7d14\u7c8b\u95a2\u6570\u306f\u3069\u308c\u3067\u3059\u304b?</p> <pre><code>// A\npublic static int Double(int x) =&gt; x * 2;\n\n// B\nprivate static int counter = 0;\npublic static int IncrementCounter()\n{\n    counter++;\n    return counter;\n}\n\n// C\npublic static string Greet(string name) =&gt; $\"Hello, {name}!\";\n\n// D\npublic static long CurrentTime() =&gt; DateTimeOffset.UtcNow.ToUnixTimeMilliseconds();\n</code></pre> \u89e3\u7b54  **A \u3068 C \u306f\u7d14\u7c8b\u95a2\u6570**\u3067\u3059\u3002  - A: \u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3057\u3001\u526f\u4f5c\u7528\u304c\u306a\u3044 - B: \u5916\u90e8\u5909\u6570 `counter` \u3092\u5909\u66f4\u3059\u308b\u526f\u4f5c\u7528\u304c\u3042\u308b\uff08\u4e0d\u7d14\uff09 - C: \u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3057\u3001\u526f\u4f5c\u7528\u304c\u306a\u3044 - D: \u547c\u3073\u51fa\u3059\u305f\u3073\u306b\u7570\u306a\u308b\u5024\u3092\u8fd4\u3059\uff08\u4e0d\u7d14\uff09"},{"location":"csharp/part-1/#2_1","title":"\u554f\u984c 2: \u7d14\u7c8b\u95a2\u6570\u3078\u306e\u66f8\u304d\u63db\u3048","text":"<p>\u4ee5\u4e0b\u306e\u4e0d\u7d14\u306a\u30af\u30e9\u30b9\u3092\u7d14\u7c8b\u95a2\u6570\u306b\u66f8\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>public class Counter\n{\n    private int value = 0;\n\n    public int Increment()\n    {\n        value++;\n        return value;\n    }\n}\n</code></pre> \u89e3\u7b54 <pre><code>public static int Increment(int value) =&gt; value + 1;\n\n// \u4f7f\u7528\u4f8b\nvar v1 = 0;\nvar v2 = Increment(v1);  // 1\nvar v3 = Increment(v2);  // 2\n</code></pre>  \u72b6\u614b\u3092\u5916\u90e8\u306b\u6301\u3061\u3001\u95a2\u6570\u306f\u5024\u3092\u53d7\u3051\u53d6\u3063\u3066\u65b0\u3057\u3044\u5024\u3092\u8fd4\u3059\u3060\u3051\u306b\u3057\u307e\u3059\u3002"},{"location":"csharp/part-1/#3","title":"\u554f\u984c 3: \u30c6\u30b9\u30c8\u3092\u66f8\u304f","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u306b\u5bfe\u3059\u308b\u30c6\u30b9\u30c8\u30b1\u30fc\u30b9\u3092\u8003\u3048\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>public static bool IsEven(int n) =&gt; n % 2 == 0;\n</code></pre> \u89e3\u7b54 <pre><code>// \u57fa\u672c\u30b1\u30fc\u30b9\nAssert.True(IsEven(0));\nAssert.True(IsEven(2));\nAssert.True(IsEven(4));\n\n// \u5947\u6570\nAssert.False(IsEven(1));\nAssert.False(IsEven(3));\n\n// \u8ca0\u306e\u6570\nAssert.True(IsEven(-2));\nAssert.False(IsEven(-3));\n\n// \u5883\u754c\u5024\nAssert.False(IsEven(int.MaxValue));\nAssert.True(IsEven(int.MinValue));\n</code></pre>"},{"location":"csharp/part-1/#4-option","title":"\u554f\u984c 4: Option \u578b\u3092\u4f7f\u3046","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092 <code>Option</code> \u578b\u3092\u4f7f\u3063\u3066\u5b89\u5168\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>public static int Divide(int a, int b) =&gt; a / b;  // b \u304c 0 \u306e\u5834\u5408\u306b\u4f8b\u5916\n</code></pre> \u89e3\u7b54 <pre><code>public static Option&lt;int&gt; Divide(int a, int b) =&gt;\n    b == 0 ? None : Some(a / b);\n\n// \u4f7f\u7528\u4f8b\nvar result = Divide(10, 2);\nresult.Match(\n    Some: r =&gt; Console.WriteLine($\"\u7d50\u679c: {r}\"),\n    None: () =&gt; Console.WriteLine(\"0\u3067\u9664\u7b97\u3067\u304d\u307e\u305b\u3093\")\n);\n</code></pre>  `Option` \u578b\u3092\u4f7f\u3046\u3053\u3068\u3067\u3001\u30a8\u30e9\u30fc\u30b1\u30fc\u30b9\u3092\u578b\u3067\u8868\u73fe\u3057\u3001\u547c\u3073\u51fa\u3057\u5074\u306b\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3092\u5f37\u5236\u3067\u304d\u307e\u3059\u3002"},{"location":"csharp/part-1/#5","title":"\u554f\u984c 5: \u95a2\u6570\u5408\u6210","text":"<p><code>Increment</code> \u3068 <code>Double</code> \u3092\u4f7f\u3063\u3066\u3001\u300c2\u500d\u3057\u3066\u304b\u3089\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\u300d\u3059\u308b\u95a2\u6570\u3092\u4f5c\u6210\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> \u89e3\u7b54 <pre><code>public static Func&lt;A, C&gt; Compose&lt;A, B, C&gt;(Func&lt;A, B&gt; f, Func&lt;B, C&gt; g) =&gt;\n    x =&gt; g(f(x));\n\npublic static Func&lt;int, int&gt; DoubleThenIncrement =&gt;\n    Compose&lt;int, int, int&gt;(Double, Increment);\n\n// \u4f7f\u7528\u4f8b\nvar result = DoubleThenIncrement(3);  // (3 * 2) + 1 = 7\n</code></pre>"},{"location":"csharp/part-2/","title":"Part II: \u95a2\u6570\u578b\u30b9\u30bf\u30a4\u30eb\u306e\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u6838\u5fc3\u3068\u306a\u308b\u30c6\u30af\u30cb\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059\u3002\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c\u3001\u9ad8\u968e\u95a2\u6570\u3001\u305d\u3057\u3066 <code>Bind</code>\uff08flatMap \u76f8\u5f53\uff09\u306b\u3088\u308b\u8907\u96d1\u306a\u30c7\u30fc\u30bf\u5909\u63db\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"csharp/part-2/#3","title":"\u7b2c3\u7ae0: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c","text":""},{"location":"csharp/part-2/#31","title":"3.1 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u3068\u306f","text":"<p>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\uff08\u4e0d\u5909\uff09\u3068\u306f\u3001\u4e00\u5ea6\u4f5c\u6210\u3055\u308c\u305f\u30c7\u30fc\u30bf\u304c\u5909\u66f4\u3055\u308c\u306a\u3044\u3053\u3068\u3092\u610f\u5473\u3057\u307e\u3059\u3002\u30c7\u30fc\u30bf\u3092\u300c\u5909\u66f4\u300d\u3059\u308b\u4ee3\u308f\u308a\u306b\u3001\u65b0\u3057\u3044\u30c7\u30fc\u30bf\u3092\u300c\u4f5c\u6210\u300d\u3057\u307e\u3059\u3002</p> <p></p>"},{"location":"csharp/part-2/#32-seq","title":"3.2 Seq \u306e\u57fa\u672c\u64cd\u4f5c","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/csharp/src/Ch03/ImmutableOperations.cs</code></p>"},{"location":"csharp/part-2/#_1","title":"\u8981\u7d20\u306e\u8ffd\u52a0","text":"<p>LanguageExt \u306e <code>Seq&lt;T&gt;</code> \u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u3067\u3059\u3002\u8981\u7d20\u3092\u8ffd\u52a0\u3059\u308b\u3068\u65b0\u3057\u3044 Seq \u304c\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002</p> <pre><code>using LanguageExt;\nusing static LanguageExt.Prelude;\n\nvar appleBook = Seq(\"Apple\", \"Book\");\nvar appleBookMango = appleBook.Add(\"Mango\");\n\n// \u5143\u306e Seq \u306f\u5909\u308f\u3089\u306a\u3044\nDebug.Assert(appleBook.Count == 2);\n// \u65b0\u3057\u3044 Seq \u304c\u4f5c\u6210\u3055\u308c\u308b\nDebug.Assert(appleBookMango.Count == 3);\nDebug.Assert(appleBookMango.SequenceEqual(Seq(\"Apple\", \"Book\", \"Mango\")));\n</code></pre>"},{"location":"csharp/part-2/#_2","title":"\u30b9\u30e9\u30a4\u30b9\u64cd\u4f5c","text":"<pre><code>/// &lt;summary&gt;\n/// Seq \u306e\u5148\u982d n \u500b\u306e\u8981\u7d20\u3092\u53d6\u5f97\n/// &lt;/summary&gt;\npublic static Seq&lt;T&gt; FirstN&lt;T&gt;(Seq&lt;T&gt; seq, int n) =&gt;\n    seq.Take(n);\n\n/// &lt;summary&gt;\n/// Seq \u306e\u672b\u5c3e n \u500b\u306e\u8981\u7d20\u3092\u53d6\u5f97\n/// &lt;/summary&gt;\npublic static Seq&lt;T&gt; LastN&lt;T&gt;(Seq&lt;T&gt; seq, int n)\n{\n    var skipCount = Math.Max(0, seq.Count - n);\n    return seq.Skip(skipCount);\n}\n\n/// &lt;summary&gt;\n/// Seq \u306e\u6700\u521d\u306e 2 \u8981\u7d20\u3092\u53d6\u5f97\n/// &lt;/summary&gt;\npublic static Seq&lt;T&gt; FirstTwo&lt;T&gt;(Seq&lt;T&gt; seq) =&gt;\n    FirstN(seq, 2);\n\n/// &lt;summary&gt;\n/// Seq \u306e\u6700\u5f8c\u306e 2 \u8981\u7d20\u3092\u53d6\u5f97\n/// &lt;/summary&gt;\npublic static Seq&lt;T&gt; LastTwo&lt;T&gt;(Seq&lt;T&gt; seq) =&gt;\n    LastN(seq, 2);\n</code></pre>"},{"location":"csharp/part-2/#33-seq","title":"3.3 Seq \u306e\u5909\u63db\u4f8b","text":"<pre><code>/// &lt;summary&gt;\n/// \u6700\u521d\u306e 2 \u8981\u7d20\u3092\u672b\u5c3e\u306b\u79fb\u52d5\n/// &lt;/summary&gt;\npublic static Seq&lt;T&gt; MoveFirstTwoToEnd&lt;T&gt;(Seq&lt;T&gt; seq)\n{\n    var first = FirstTwo(seq);\n    var rest = seq.Skip(2);\n    return rest.Concat(first);\n}\n\n// \u4f7f\u7528\u4f8b\nDebug.Assert(MoveFirstTwoToEnd(Seq(\"a\", \"b\", \"c\")).SequenceEqual(Seq(\"c\", \"a\", \"b\")));\n\n/// &lt;summary&gt;\n/// \u6700\u5f8c\u306e\u8981\u7d20\u306e\u524d\u306b\u65b0\u3057\u3044\u8981\u7d20\u3092\u633f\u5165\n/// &lt;/summary&gt;\npublic static Seq&lt;T&gt; InsertBeforeLast&lt;T&gt;(Seq&lt;T&gt; seq, T element)\n{\n    var withoutLast = seq.Take(seq.Count - 1);\n    var last = LastN(seq, 1);\n    return withoutLast.Add(element).Concat(last);\n}\n\nDebug.Assert(InsertBeforeLast(Seq(\"a\", \"b\"), \"c\").SequenceEqual(Seq(\"a\", \"c\", \"b\")));\n</code></pre>"},{"location":"csharp/part-2/#34","title":"3.4 \u65c5\u7a0b\u306e\u518d\u8a08\u753b","text":"<p>\u65c5\u884c\u306e\u8a08\u753b\u5909\u66f4\u3092\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306b\u884c\u3046\u4f8b\u3067\u3059\u3002</p> <pre><code>/// &lt;summary&gt;\n/// \u6307\u5b9a\u3057\u305f\u90fd\u5e02\u306e\u524d\u306b\u65b0\u3057\u3044\u90fd\u5e02\u3092\u633f\u5165\n/// &lt;/summary&gt;\npublic static Seq&lt;string&gt; Replan(Seq&lt;string&gt; plan, string newCity, string beforeCity)\n{\n    var index = plan.ToList().FindIndex(c =&gt; c == beforeCity);\n    if (index &lt; 0) index = plan.Count;\n\n    var citiesBefore = plan.Take(index);\n    var citiesAfter = plan.Skip(index);\n    return citiesBefore.Add(newCity).Concat(citiesAfter);\n}\n\nvar planA = Seq(\"Paris\", \"Berlin\", \"Krak\u00f3w\");\nvar planB = Replan(planA, \"Vienna\", \"Krak\u00f3w\");\n\nDebug.Assert(planB.SequenceEqual(Seq(\"Paris\", \"Berlin\", \"Vienna\", \"Krak\u00f3w\")));\nDebug.Assert(planA.SequenceEqual(Seq(\"Paris\", \"Berlin\", \"Krak\u00f3w\"))); // \u5143\u306e\u8a08\u753b\u306f\u5909\u308f\u3089\u306a\u3044!\n</code></pre> <p></p>"},{"location":"csharp/part-2/#35-string-seq","title":"3.5 String \u3068 Seq \u306e\u985e\u4f3c\u6027","text":"<p>String \u3068 Seq \u306f\u4f3c\u305f\u64cd\u4f5c\u304c\u3067\u304d\u307e\u3059\u3002</p> \u64cd\u4f5c C# Seq C# String \u7d50\u5408 <code>Concat</code> \u307e\u305f\u306f <code>Add</code> <code>+</code> \u307e\u305f\u306f <code>String.Concat</code> \u5207\u308a\u51fa\u3057 <code>Skip</code>, <code>Take</code> <code>Substring</code> \u30b5\u30a4\u30ba <code>Count</code> <code>Length</code> <pre><code>// Seq \u306e\u64cd\u4f5c\nvar abSeq = Seq(\"a\", \"b\");\nvar cdSeq = Seq(\"c\", \"d\");\nvar abcdSeq = abSeq.Concat(cdSeq);\nDebug.Assert(abcdSeq.SequenceEqual(Seq(\"a\", \"b\", \"c\", \"d\")));\n\n// String \u306e\u64cd\u4f5c\nvar abStr = \"ab\";\nvar cdStr = \"cd\";\nvar abcdStr = abStr + cdStr;\nDebug.Assert(abcdStr == \"abcd\");\n</code></pre>"},{"location":"csharp/part-2/#36","title":"3.6 \u540d\u524d\u306e\u7701\u7565","text":"<pre><code>/// &lt;summary&gt;\n/// \u540d\u524d\u3092\u7701\u7565\u5f62\u306b\u5909\u63db\uff08\u4f8b: \"Alonzo Church\" -&gt; \"A. Church\"\uff09\n/// &lt;/summary&gt;\npublic static string Abbreviate(string name)\n{\n    var initial = name.Substring(0, 1);\n    var separatorIndex = name.IndexOf(' ');\n    if (separatorIndex &lt; 0)\n        return name;\n\n    var lastName = name.Substring(separatorIndex + 1);\n    return $\"{initial}. {lastName}\";\n}\n\nDebug.Assert(Abbreviate(\"Alonzo Church\") == \"A. Church\");\nDebug.Assert(Abbreviate(\"A. Church\") == \"A. Church\");\n</code></pre>"},{"location":"csharp/part-2/#4","title":"\u7b2c4\u7ae0: \u95a2\u6570\u3092\u5024\u3068\u3057\u3066\u6271\u3046","text":""},{"location":"csharp/part-2/#41","title":"4.1 \u9ad8\u968e\u95a2\u6570\u3068\u306f","text":"<p>\u9ad8\u968e\u95a2\u6570\uff08Higher-Order Function\uff09\u3068\u306f\u3001\u4ee5\u4e0b\u306e\u3044\u305a\u308c\u304b\u3092\u6e80\u305f\u3059\u95a2\u6570\u3067\u3059:</p> <ol> <li>\u95a2\u6570\u3092\u5f15\u6570\u3068\u3057\u3066\u53d7\u3051\u53d6\u308b</li> <li>\u95a2\u6570\u3092\u623b\u308a\u5024\u3068\u3057\u3066\u8fd4\u3059</li> </ol> <p></p>"},{"location":"csharp/part-2/#42","title":"4.2 \u95a2\u6570\u3092\u5f15\u6570\u3068\u3057\u3066\u6e21\u3059","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/csharp/src/Ch04/HigherOrderFunctions.cs</code></p>"},{"location":"csharp/part-2/#orderby-","title":"OrderBy - \u30bd\u30fc\u30c8\u57fa\u6e96\u3092\u95a2\u6570\u3067\u6307\u5b9a","text":"<pre><code>public static int WordScore(string word) =&gt;\n    word.Replace(\"a\", \"\").Length;\n\nvar words = Seq(\"rust\", \"java\");\nvar sortedWords = toSeq(words.OrderBy(WordScore));\n\nDebug.Assert(sortedWords.SequenceEqual(Seq(\"java\", \"rust\")));\n// java: 2\u6587\u5b57 (j, v), rust: 4\u6587\u5b57 (r, u, s, t)\n</code></pre>"},{"location":"csharp/part-2/#map-","title":"Map - \u5404\u8981\u7d20\u3092\u5909\u63db","text":"<pre><code>public static int Len(string s) =&gt; s.Length;\n\nvar lengths = Seq(\"scala\", \"rust\", \"ada\").Map(Len);\nDebug.Assert(lengths.SequenceEqual(Seq(5, 4, 3)));\n\npublic static int Double(int i) =&gt; i * 2;\nvar doubles = Seq(5, 1, 2, 4, 0).Map(Double);\nDebug.Assert(doubles.SequenceEqual(Seq(10, 2, 4, 8, 0)));\n</code></pre>"},{"location":"csharp/part-2/#filter-","title":"Filter - \u6761\u4ef6\u306b\u5408\u3046\u8981\u7d20\u3092\u62bd\u51fa","text":"<pre><code>public static bool IsOdd(int i) =&gt; i % 2 == 1;\n\nvar odds = Seq(5, 1, 2, 4, 0).Filter(IsOdd);\nDebug.Assert(odds.SequenceEqual(Seq(5, 1)));\n\nvar large = Seq(5, 1, 2, 4, 0).Filter(i =&gt; i &gt; 4);\nDebug.Assert(large.SequenceEqual(Seq(5)));\n</code></pre>"},{"location":"csharp/part-2/#fold-","title":"Fold - \u7573\u307f\u8fbc\u307f","text":"<pre><code>var sum = Seq(5, 1, 2, 4, 100).Fold(0, (acc, i) =&gt; acc + i);\nDebug.Assert(sum == 112);\n\nvar maximum = Seq(5, 1, 2, 4, 15).Fold(int.MinValue, (maxVal, i) =&gt;\n    i &gt; maxVal ? i : maxVal);\nDebug.Assert(maximum == 15);\n</code></pre>"},{"location":"csharp/part-2/#43","title":"4.3 \u30ec\u30b3\u30fc\u30c9\u578b\u3068\u30d1\u30bf\u30fc\u30f3","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/csharp/src/Ch04/HigherOrderFunctions.cs</code></p> <pre><code>/// &lt;summary&gt;\n/// \u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u8a00\u8a9e\u3092\u8868\u3059\u30ec\u30b3\u30fc\u30c9\u578b\n/// &lt;/summary&gt;\npublic record ProgrammingLanguage(string Name, int Year);\n\nvar javaLang = new ProgrammingLanguage(\"Java\", 1995);\nvar scalaLang = new ProgrammingLanguage(\"Scala\", 2004);\n\nvar languages = Seq(javaLang, scalaLang);\n\n// \u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u30a2\u30af\u30bb\u30b9\nvar names = languages.Map(lang =&gt; lang.Name);\nDebug.Assert(names.SequenceEqual(Seq(\"Java\", \"Scala\")));\n\n// \u6761\u4ef6\u3067\u30d5\u30a3\u30eb\u30bf\nvar young = languages.Filter(lang =&gt; lang.Year &gt; 2000);\nDebug.Assert(young.SequenceEqual(Seq(scalaLang)));\n</code></pre>"},{"location":"csharp/part-2/#44","title":"4.4 \u95a2\u6570\u3092\u8fd4\u3059\u95a2\u6570","text":"<pre><code>/// &lt;summary&gt;\n/// n \u3088\u308a\u5927\u304d\u3044\u304b\u3092\u5224\u5b9a\u3059\u308b\u95a2\u6570\u3092\u8fd4\u3059\n/// &lt;/summary&gt;\npublic static Func&lt;int, bool&gt; LargerThan(int n) =&gt;\n    i =&gt; i &gt; n;\n\nvar large = Seq(5, 1, 2, 4, 0).Filter(LargerThan(4));\nDebug.Assert(large.SequenceEqual(Seq(5)));\n\nvar medium = Seq(5, 1, 2, 4, 0).Filter(LargerThan(1));\nDebug.Assert(medium.SequenceEqual(Seq(5, 2, 4)));\n</code></pre>"},{"location":"csharp/part-2/#45","title":"4.5 \u30ab\u30ea\u30fc\u5316\u3068\u90e8\u5206\u9069\u7528","text":"<p>LanguageExt \u306e <code>curry</code> \u95a2\u6570\u3092\u4f7f\u3063\u3066\u30ab\u30ea\u30fc\u5316\u3067\u304d\u307e\u3059\u3002</p> <pre><code>using static LanguageExt.Prelude;\n\n// \u30ab\u30ea\u30fc\u5316\u3055\u308c\u305f\u52a0\u7b97\u95a2\u6570\npublic static Func&lt;int, Func&lt;int, int&gt;&gt; AddCurried =&gt;\n    curry&lt;int, int, int&gt;((a, b) =&gt; a + b);\n\n// \u90e8\u5206\u9069\u7528: 5\u3092\u8db3\u3059\u95a2\u6570\npublic static Func&lt;int, int&gt; AddFive =&gt; AddCurried(5);\n\nDebug.Assert(AddFive(3) == 8);\nDebug.Assert(AddFive(10) == 15);\n</code></pre> <p></p>"},{"location":"csharp/part-2/#46","title":"4.6 \u30ef\u30fc\u30c9\u30b9\u30b3\u30a2\u30ea\u30f3\u30b0\u306e\u4f8b","text":"<p>\u8907\u6570\u306e\u30b9\u30b3\u30a2\u30ea\u30f3\u30b0\u30ed\u30b8\u30c3\u30af\u3092\u7d44\u307f\u5408\u308f\u305b\u308b\u4f8b\u3067\u3059\u3002</p> <pre><code>public static int WordScore(string word) =&gt; word.Replace(\"a\", \"\").Length;\npublic static int Bonus(string word) =&gt; word.Contains('c') ? 5 : 0;\npublic static int Penalty(string word) =&gt; word.Contains('s') ? 7 : 0;\n\nvar words = Seq(\"ada\", \"haskell\", \"scala\", \"java\", \"rust\");\n\n/// &lt;summary&gt;\n/// \u6307\u5b9a\u3057\u305f\u30b9\u30b3\u30a2\u95a2\u6570\u3067\u30ef\u30fc\u30c9\u3092\u30e9\u30f3\u30ad\u30f3\u30b0\n/// &lt;/summary&gt;\npublic static Seq&lt;string&gt; RankedWords(Seq&lt;string&gt; words, Func&lt;string, int&gt; scoreFn) =&gt;\n    toSeq(words.OrderByDescending(scoreFn));\n\n// \u57fa\u672c\u30b9\u30b3\u30a2\u3067\u30e9\u30f3\u30ad\u30f3\u30b0\nvar ranking1 = RankedWords(words, WordScore);\nDebug.Assert(ranking1.Head == \"haskell\");\n\n// \u30dc\u30fc\u30ca\u30b9\u4ed8\u304d\u30b9\u30b3\u30a2\u3067\u30e9\u30f3\u30ad\u30f3\u30b0\nvar ranking2 = RankedWords(words, w =&gt; WordScore(w) + Bonus(w));\n// scala: 3 + 5 = 8, haskell: 7 + 0 = 7\nDebug.Assert(ranking2.Head == \"scala\");\n\n// \u30dc\u30fc\u30ca\u30b9\u3068\u30da\u30ca\u30eb\u30c6\u30a3\u4ed8\u304d\u30b9\u30b3\u30a2\u3067\u30e9\u30f3\u30ad\u30f3\u30b0\nvar ranking3 = RankedWords(words, w =&gt; WordScore(w) + Bonus(w) - Penalty(w));\n// java: 2, scala: 1, ada: 0, haskell: 0, rust: -3\nDebug.Assert(ranking3.Head == \"java\");\n</code></pre>"},{"location":"csharp/part-2/#5-bind","title":"\u7b2c5\u7ae0: Bind \u3068\u30cd\u30b9\u30c8\u69cb\u9020","text":""},{"location":"csharp/part-2/#51-flatten-bind","title":"5.1 Flatten \u3068 Bind","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/csharp/src/Ch05/FlatMapOperations.cs</code></p>"},{"location":"csharp/part-2/#bind-seq","title":"Bind - \u30cd\u30b9\u30c8\u3057\u305f Seq \u3092\u5e73\u5766\u5316","text":"<pre><code>public record Book(string Title, Seq&lt;string&gt; Authors);\n\nvar books = Seq(\n    new Book(\"FP in Scala\", Seq(\"Chiusano\", \"Bjarnason\")),\n    new Book(\"The Hobbit\", Seq(\"Tolkien\"))\n);\n\n// Map \u3060\u3051\u3060\u3068\u30cd\u30b9\u30c8\u3059\u308b\nvar authorSeqs = books.Map(b =&gt; b.Authors);\n// Seq&lt;Seq&lt;string&gt;&gt;: [ [\"Chiusano\", \"Bjarnason\"], [\"Tolkien\"] ]\n\n// Bind \u3067\u5e73\u5766\u5316\u3057\u306a\u304c\u3089\u5909\u63db\nvar authors = books.Bind(b =&gt; b.Authors);\n// Seq&lt;string&gt;: [\"Chiusano\", \"Bjarnason\", \"Tolkien\"]\n</code></pre>"},{"location":"csharp/part-2/#bind-map-flatten","title":"Bind = Map + Flatten","text":"<p>C# \u306e LanguageExt \u306b\u304a\u3051\u308b <code>Bind</code> \u306f Scala \u306e <code>flatMap</code> \u306b\u76f8\u5f53\u3057\u307e\u3059\u3002</p> <pre><code>// Map \u3057\u3066 Flatten\nvar authors1 = books.Map(b =&gt; b.Authors).Bind(x =&gt; x);\n\n// Bind \u3067\u540c\u3058\u3053\u3068\u30921\u884c\u3067\nvar authors2 = books.Bind(b =&gt; b.Authors);\n\nDebug.Assert(authors1.SequenceEqual(authors2));\n// [\"Chiusano\", \"Bjarnason\", \"Tolkien\"]\n</code></pre>"},{"location":"csharp/part-2/#52-bind","title":"5.2 Bind \u306b\u3088\u308b\u30ea\u30b9\u30c8\u30b5\u30a4\u30ba\u306e\u5909\u5316","text":"<pre><code>// \u8981\u7d20\u6570\u304c\u5897\u3048\u308b\nvar duplicate = Seq(1, 2, 3).Bind(i =&gt; Seq(i, i + 10));\n// [1, 11, 2, 12, 3, 13] - 6\u8981\u7d20\n\n// \u8981\u7d20\u6570\u304c\u540c\u3058\nvar doubled = Seq(1, 2, 3).Bind(i =&gt; Seq(i * 2));\n// [2, 4, 6] - 3\u8981\u7d20\n\n// \u8981\u7d20\u6570\u304c\u6e1b\u308b\uff08\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u52b9\u679c\uff09\nvar evens = Seq(1, 2, 3).Bind(i =&gt;\n    i % 2 == 0 ? Seq(i) : Empty);\n// [2] - 1\u8981\u7d20\n</code></pre>"},{"location":"csharp/part-2/#53-bind","title":"5.3 \u30cd\u30b9\u30c8\u3057\u305f Bind","text":"<p>\u8907\u6570\u306e Seq \u3092\u7d44\u307f\u5408\u308f\u305b\u308b\u5834\u5408\u3001Bind \u3092\u30cd\u30b9\u30c8\u3057\u307e\u3059\u3002</p> <pre><code>public record Movie(string Title);\n\npublic static Seq&lt;Movie&gt; BookAdaptations(string author) =&gt;\n    author == \"Tolkien\"\n        ? Seq(new Movie(\"An Unexpected Journey\"), new Movie(\"The Desolation of Smaug\"))\n        : Empty;\n\nvar books = Seq(\n    new Book(\"FP in Scala\", Seq(\"Chiusano\", \"Bjarnason\")),\n    new Book(\"The Hobbit\", Seq(\"Tolkien\"))\n);\n\n// \u30cd\u30b9\u30c8\u3057\u305f Bind\nvar recommendations = books.Bind(book =&gt;\n    book.Authors.Bind(author =&gt;\n        BookAdaptations(author).Map(movie =&gt;\n            $\"You may like {movie.Title}, because you liked {author}'s {book.Title}\")));\n\n// \u7d50\u679c:\n// [ \"You may like An Unexpected Journey, because you liked Tolkien's The Hobbit\"\n//   \"You may like The Desolation of Smaug, because you liked Tolkien's The Hobbit\" ]\n</code></pre> <p></p>"},{"location":"csharp/part-2/#54-linq","title":"5.4 LINQ \u30af\u30a8\u30ea\u5f0f","text":"<p>C# \u306e LINQ \u30af\u30a8\u30ea\u5f0f\u306f\u3001\u30cd\u30b9\u30c8\u3057\u305f Bind \u3092\u8aad\u307f\u3084\u3059\u304f\u66f8\u3051\u307e\u3059\u3002</p> <pre><code>// Bind/Map \u7248\nvar c1 = books.Bind(book =&gt;\n    book.Authors.Bind(author =&gt;\n        BookAdaptations(author).Map(movie =&gt;\n            $\"You may like {movie.Title}, because you liked {author}'s {book.Title}\")));\n\n// LINQ \u30af\u30a8\u30ea\u5f0f\u7248\uff08\u7b49\u4fa1\uff09\nvar c2 = (from book in books\n          from author in book.Authors\n          from movie in BookAdaptations(author)\n          select $\"You may like {movie.Title}, because you liked {author}'s {book.Title}\").ToSeq();\n\nDebug.Assert(c1.SequenceEqual(c2));\n</code></pre> <p></p>"},{"location":"csharp/part-2/#55","title":"5.5 \u5186\u5185\u306e\u70b9\u306e\u5224\u5b9a","text":"<p>LINQ \u30af\u30a8\u30ea\u5f0f\u3067\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u3082\u884c\u3046\u4f8b\u3067\u3059\u3002</p> <pre><code>public record Point(int X, int Y);\n\nvar points = Seq(new Point(5, 2), new Point(1, 1));\nvar radiuses = Seq(2, 1);\n\npublic static bool IsInside(Point point, int radius) =&gt;\n    radius * radius &gt;= point.X * point.X + point.Y * point.Y;\n\n// \u5168\u7d44\u307f\u5408\u308f\u305b\u3092\u751f\u6210\nvar allCombinations = (from r in radiuses\n                       from point in points\n                       select $\"Point({point.X},{point.Y}) is within a radius of {r}: {IsInside(point, r)}\").ToSeq();\n\n// \u7d50\u679c:\n// [ \"Point(5,2) is within a radius of 2: false\"\n//   \"Point(1,1) is within a radius of 2: true\"\n//   \"Point(5,2) is within a radius of 1: false\"\n//   \"Point(1,1) is within a radius of 1: false\" ]\n</code></pre>"},{"location":"csharp/part-2/#where","title":"where \u306b\u3088\u308b\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0","text":"<pre><code>// where \u3092\u4f7f\u3063\u305f\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\nvar insidePoints = (from r in radiuses\n                    from point in points\n                    where IsInside(point, r)\n                    select $\"Point({point.X},{point.Y}) is within a radius of {r}\").ToSeq();\n\n// \u7d50\u679c: [ \"Point(1,1) is within a radius of 2\" ]\n</code></pre>"},{"location":"csharp/part-2/#56-linq","title":"5.6 LINQ \u306e\u67d4\u8edf\u6027","text":"<p>C# \u306e LINQ \u30af\u30a8\u30ea\u5f0f\u306f\u3001<code>Seq</code>\u3001<code>IEnumerable</code>\u3001\u305d\u306e\u4ed6\u306e LINQ \u5bfe\u5fdc\u578b\u3067\u4f7f\u3048\u307e\u3059\u3002</p> <pre><code>// Seq \u3092\u4f7f\u3063\u305f LINQ\nvar seqResult = (from a in Seq(1, 2)\n                 from b in Seq(2, 1)\n                 select a * b).ToSeq();\n// [2, 1, 4, 2] - \u91cd\u8907\u3042\u308a\u3001\u9806\u5e8f\u3042\u308a\n\n// HashSet \u3078\u306e\u5909\u63db\nvar hashSetResult = new System.Collections.Generic.HashSet&lt;int&gt;(seqResult);\n// {1, 2, 4} - \u91cd\u8907\u306a\u3057\n</code></pre>"},{"location":"csharp/part-2/#_3","title":"\u307e\u3068\u3081","text":""},{"location":"csharp/part-2/#part-ii_1","title":"Part II \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"csharp/part-2/#_4","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"\u7ae0 \u4e3b\u8981\u6982\u5ff5 \u30ad\u30fc\u64cd\u4f5c \u7b2c3\u7ae0 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb <code>Concat</code>, <code>Add</code>, <code>Skip</code>, <code>Take</code> \u7b2c4\u7ae0 \u9ad8\u968e\u95a2\u6570 <code>Map</code>, <code>Filter</code>, <code>Fold</code>, <code>OrderBy</code> \u7b2c5\u7ae0 \u5e73\u5766\u5316 <code>Bind</code>, LINQ \u30af\u30a8\u30ea\u5f0f"},{"location":"csharp/part-2/#clanguageext-scalaf","title":"C#/LanguageExt \u3068 Scala/F# \u306e\u5bfe\u5fdc","text":"\u64cd\u4f5c C# (LanguageExt) Scala F# \u5e73\u5766\u5316 <code>Bind(x =&gt; x)</code> <code>flatten</code> <code>List.concat</code> flatMap <code>Bind</code> <code>flatMap</code> <code>List.collect</code> \u5185\u5305\u8868\u8a18 LINQ <code>from ... select</code> <code>for { x &lt;- xs } yield ...</code> <code>[ for x in xs do ... ]</code> \u7573\u307f\u8fbc\u307f <code>Fold</code> <code>foldLeft</code> <code>List.fold</code> \u30d5\u30a3\u30eb\u30bf <code>Filter</code> <code>filter</code> <code>List.filter</code>"},{"location":"csharp/part-2/#_5","title":"\u91cd\u8981\u306a\u6cd5\u5247","text":"<ol> <li>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf: \u5143\u306e\u30c7\u30fc\u30bf\u306f\u5909\u66f4\u305b\u305a\u3001\u65b0\u3057\u3044\u30c7\u30fc\u30bf\u3092\u4f5c\u6210\u3059\u308b</li> <li>\u95a2\u6570\u306f\u5024: \u95a2\u6570\u3092\u5f15\u6570\u3068\u3057\u3066\u6e21\u3057\u305f\u308a\u3001\u623b\u308a\u5024\u3068\u3057\u3066\u8fd4\u3057\u305f\u308a\u3067\u304d\u308b</li> <li>Bind \u30d1\u30bf\u30fc\u30f3: \u30cd\u30b9\u30c8\u3057\u305f\u69cb\u9020\u3092\u5e73\u5766\u5316\u3057\u306a\u304c\u3089\u5909\u63db\u3059\u308b</li> <li>LINQ \u30af\u30a8\u30ea\u5f0f: Bind/Map \u306e\u7cd6\u8863\u69cb\u6587\u3068\u3057\u3066\u4f7f\u3048\u308b</li> <li>\u30e1\u30bd\u30c3\u30c9\u30c1\u30a7\u30fc\u30f3: <code>.</code> \u3067\u95a2\u6570\u3092\u9023\u9396\u3055\u305b\u3066\u8aad\u307f\u3084\u3059\u304f\u3059\u308b</li> </ol>"},{"location":"csharp/part-2/#_6","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part III \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li><code>Option&lt;T&gt;</code> \u578b\u306b\u3088\u308b\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0</li> <li><code>Either&lt;L, R&gt;</code> / <code>Result</code> \u578b\u3068\u8907\u5408\u7684\u306a\u30a8\u30e9\u30fc\u51e6\u7406</li> </ul>"},{"location":"csharp/part-2/#_7","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"csharp/part-2/#1","title":"\u554f\u984c 1: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u64cd\u4f5c","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002Seq \u306e\u4e2d\u592e\u306b\u8981\u7d20\u3092\u633f\u5165\u3059\u308b\u95a2\u6570\u3067\u3059\u3002</p> <pre><code>public static Seq&lt;T&gt; InsertAtMiddle&lt;T&gt;(Seq&lt;T&gt; seq, T element) =&gt; ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nDebug.Assert(InsertAtMiddle(Seq(\"a\", \"b\", \"c\", \"d\"), \"X\").SequenceEqual(Seq(\"a\", \"b\", \"X\", \"c\", \"d\")));\nDebug.Assert(InsertAtMiddle(Seq(\"a\", \"b\"), \"X\").SequenceEqual(Seq(\"a\", \"X\", \"b\")));\n</code></pre> \u89e3\u7b54 <pre><code>public static Seq&lt;T&gt; InsertAtMiddle&lt;T&gt;(Seq&lt;T&gt; seq, T element)\n{\n    var middle = seq.Count / 2;\n    var before = seq.Take(middle);\n    var after = seq.Skip(middle);\n    return before.Add(element).Concat(after);\n}\n</code></pre>"},{"location":"csharp/part-2/#2","title":"\u554f\u984c 2: \u9ad8\u968e\u95a2\u6570","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u6761\u4ef6\u3092\u6e80\u305f\u3059\u8981\u7d20\u306e\u6570\u3092\u30ab\u30a6\u30f3\u30c8\u3059\u308b\u95a2\u6570\u3067\u3059\u3002</p> <pre><code>public static int CountWhere&lt;T&gt;(Seq&lt;T&gt; seq, Func&lt;T, bool&gt; predicate) =&gt; ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nDebug.Assert(CountWhere(Seq(1, 2, 3, 4, 5), i =&gt; i &gt; 3) == 2);\nDebug.Assert(CountWhere(Seq(\"a\", \"bb\", \"ccc\"), s =&gt; s.Length &gt; 1) == 2);\n</code></pre> \u89e3\u7b54 <pre><code>public static int CountWhere&lt;T&gt;(Seq&lt;T&gt; seq, Func&lt;T, bool&gt; predicate) =&gt;\n    seq.Filter(predicate).Count;\n\n// \u307e\u305f\u306f Fold \u3092\u4f7f\u3063\u3066\npublic static int CountWhere2&lt;T&gt;(Seq&lt;T&gt; seq, Func&lt;T, bool&gt; predicate) =&gt;\n    seq.Fold(0, (count, elem) =&gt; predicate(elem) ? count + 1 : count);\n</code></pre>"},{"location":"csharp/part-2/#3-linq","title":"\u554f\u984c 3: LINQ \u30af\u30a8\u30ea\u5f0f","text":"<p>\u4ee5\u4e0b\u306e\u30cd\u30b9\u30c8\u3057\u305f Bind \u3092 LINQ \u30af\u30a8\u30ea\u5f0f\u3067\u66f8\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>var result = Seq(1, 2).Bind(x =&gt;\n    Seq(10, 20).Bind(y =&gt;\n        Seq(100, 200).Map(z =&gt;\n            x + y + z)));\n</code></pre> \u89e3\u7b54 <pre><code>var result = (from x in Seq(1, 2)\n              from y in Seq(10, 20)\n              from z in Seq(100, 200)\n              select x + y + z).ToSeq();\n\n// \u7d50\u679c: [111, 211, 121, 221, 112, 212, 122, 222]\n</code></pre>"},{"location":"csharp/part-2/#4-bind","title":"\u554f\u984c 4: Bind \u306b\u3088\u308b\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0","text":"<p>LINQ \u30af\u30a8\u30ea\u5f0f\u306e <code>where</code> \u3092\u4f7f\u308f\u305a\u306b\u3001Bind \u3060\u3051\u3067\u5076\u6570\u306e\u307f\u3092\u62bd\u51fa\u3059\u308b\u30b3\u30fc\u30c9\u3092\u66f8\u3044\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>var numbers = Seq(1, 2, 3, 4, 5, 6);\n// \u5076\u6570\u306e\u307f\u3092\u62bd\u51fa: Seq(2, 4, 6)\n</code></pre> \u89e3\u7b54 <pre><code>var evenNumbers = numbers.Bind(n =&gt;\n    n % 2 == 0 ? Seq(n) : Empty);\n\n// \u307e\u305f\u306f\u95a2\u6570\u306b\u5206\u96e2\nSeq&lt;int&gt; EvenFilter(int n) =&gt;\n    n % 2 == 0 ? Seq(n) : Empty;\n\nvar evenNumbers2 = numbers.Bind(EvenFilter);\n</code></pre>"},{"location":"csharp/part-2/#5","title":"\u554f\u984c 5: \u30e1\u30bd\u30c3\u30c9\u30c1\u30a7\u30fc\u30f3\u3067\u66f8\u304d\u63db\u3048","text":"<p>\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u30e1\u30bd\u30c3\u30c9\u30c1\u30a7\u30fc\u30f3\u3092\u4f7f\u3063\u3066\u66f8\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>var result = CountWhere(\n    Filter(\n        Map(Seq(1, -2, 3, -4, 5), x =&gt; x * 2),\n        x =&gt; x &gt; 0),\n    x =&gt; true);\n</code></pre> \u89e3\u7b54 <pre><code>var result = Seq(1, -2, 3, -4, 5)\n    .Map(x =&gt; x * 2)\n    .Filter(x =&gt; x &gt; 0)\n    .Count;\n\n// \u7d50\u679c: 3 (2, 6, 10 \u306e3\u3064)\n</code></pre>  \u30e1\u30bd\u30c3\u30c9\u30c1\u30a7\u30fc\u30f3\u3092\u4f7f\u3046\u3068\u3001\u30c7\u30fc\u30bf\u306e\u5909\u63db\u904e\u7a0b\u304c\u4e0a\u304b\u3089\u4e0b\u306b\u8aad\u3081\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002"},{"location":"csharp/part-3/","title":"Part III: \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3068 Option/Either","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3092\u5b66\u3073\u307e\u3059\u3002<code>null</code> \u3084\u4f8b\u5916\u306b\u983c\u3089\u305a\u3001<code>Option</code> \u3068 <code>Either</code> \u3092\u4f7f\u3063\u3066\u578b\u5b89\u5168\u306b\u30a8\u30e9\u30fc\u3092\u6271\u3046\u65b9\u6cd5\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"csharp/part-3/#6-option","title":"\u7b2c6\u7ae0: Option \u578b\u306b\u3088\u308b\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":""},{"location":"csharp/part-3/#61-option","title":"6.1 \u306a\u305c Option \u304c\u5fc5\u8981\u304b","text":"<p>\u5f93\u6765\u306e\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u306b\u306f\u554f\u984c\u304c\u3042\u308a\u307e\u3059\u3002</p> <p></p>"},{"location":"csharp/part-3/#62-option","title":"6.2 Option \u306e\u57fa\u672c","text":"<p>LanguageExt \u306e <code>Option&lt;T&gt;</code> \u306f\u300c<code>T</code> \u578b\u306e\u5024\u304c\u3042\u308b\u304b\u3001\u306a\u3044\u304b\u300d\u3092\u8868\u3059\u578b\u3067\u3059\u3002</p> <p></p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/csharp/src/Ch06/OptionHandling.cs</code></p>"},{"location":"csharp/part-3/#63-tv","title":"6.3 TV\u756a\u7d44\u306e\u30d1\u30fc\u30b9\u4f8b","text":"<p>TV\u756a\u7d44\u306e\u6587\u5b57\u5217\u3092\u30d1\u30fc\u30b9\u3059\u308b\u4f8b\u3067 Option \u306e\u4f7f\u3044\u65b9\u3092\u5b66\u3073\u307e\u3059\u3002</p> <pre><code>using LanguageExt;\nusing static LanguageExt.Prelude;\n\npublic record TvShow(string Title, int Start, int End);\n\n// \u5165\u529b\u4f8b: \"Breaking Bad (2008-2013)\"\n// \u671f\u5f85\u3059\u308b\u51fa\u529b: new TvShow(\"Breaking Bad\", 2008, 2013)\n</code></pre>"},{"location":"csharp/part-3/#_1","title":"\u4f8b\u5916\u3092\u4f7f\u3046\u65b9\u6cd5\uff08\u554f\u984c\u3042\u308a\uff09","text":"<pre><code>public static TvShow ParseShowUnsafe(string rawShow)\n{\n    var bracketOpen = rawShow.IndexOf('(');\n    var bracketClose = rawShow.IndexOf(')');\n    var dash = rawShow.IndexOf('-');\n\n    var name = rawShow.Substring(0, bracketOpen).Trim();\n    var yearStart = int.Parse(rawShow.Substring(bracketOpen + 1, dash - bracketOpen - 1));\n    var yearEnd = int.Parse(rawShow.Substring(dash + 1, bracketClose - dash - 1));\n\n    return new TvShow(name, yearStart, yearEnd);\n}\n\n// \u6b63\u5e38\u30b1\u30fc\u30b9\nParseShowUnsafe(\"Breaking Bad (2008-2013)\");\n// new TvShow(\"Breaking Bad\", 2008, 2013)\n\n// \u7570\u5e38\u30b1\u30fc\u30b9 \u2192 \u4f8b\u5916\u304c\u30b9\u30ed\u30fc\u3055\u308c\u308b!\nParseShowUnsafe(\"Chernobyl (2019)\");        // ArgumentOutOfRangeException\nParseShowUnsafe(\"The Wire 2002-2008\");      // ArgumentOutOfRangeException\n</code></pre>"},{"location":"csharp/part-3/#option","title":"Option \u3092\u4f7f\u3046\u65b9\u6cd5","text":"<pre><code>public static Option&lt;TvShow&gt; ParseShow(string rawShow) =&gt;\n    ExtractName(rawShow).Bind(name =&gt;\n    {\n        var yearStart = ExtractYearStart(rawShow) || ExtractSingleYear(rawShow);\n        var yearEnd = ExtractYearEnd(rawShow) || ExtractSingleYear(rawShow);\n\n        return from start in yearStart\n               from endYear in yearEnd\n               select new TvShow(name, start, endYear);\n    });\n\n// \u6b63\u5e38\u30b1\u30fc\u30b9\nParseShow(\"Breaking Bad (2008-2013)\");\n// Some(new TvShow(\"Breaking Bad\", 2008, 2013))\n\n// \u7570\u5e38\u30b1\u30fc\u30b9 \u2192 None \u304c\u8fd4\u3055\u308c\u308b\uff08\u4f8b\u5916\u306a\u3057\uff09\nParseShow(\"The Wire 2002-2008\");  // None\n</code></pre>"},{"location":"csharp/part-3/#64","title":"6.4 \u5c0f\u3055\u306a\u95a2\u6570\u304b\u3089\u7d44\u307f\u7acb\u3066\u308b","text":"<p>\u8907\u96d1\u306a\u30d1\u30fc\u30b9\u51e6\u7406\u3092\u5c0f\u3055\u306a\u95a2\u6570\u306b\u5206\u89e3\u3057\u307e\u3059\u3002</p> <pre><code>/// &lt;summary&gt;\n/// \u6587\u5b57\u5217\u3092\u5b89\u5168\u306b\u6574\u6570\u306b\u5909\u63db\n/// &lt;/summary&gt;\npublic static Option&lt;int&gt; TryParseInt(string s) =&gt;\n    int.TryParse(s, out var result) ? Some(result) : None;\n\n/// &lt;summary&gt;\n/// \u540d\u524d\u3092\u62bd\u51fa\n/// &lt;/summary&gt;\npublic static Option&lt;string&gt; ExtractName(string rawShow)\n{\n    var bracketOpen = rawShow.IndexOf('(');\n    return bracketOpen &gt; 0\n        ? Some(rawShow.Substring(0, bracketOpen).Trim())\n        : None;\n}\n\n/// &lt;summary&gt;\n/// \u958b\u59cb\u5e74\u3092\u62bd\u51fa\n/// &lt;/summary&gt;\npublic static Option&lt;int&gt; ExtractYearStart(string rawShow)\n{\n    var bracketOpen = rawShow.IndexOf('(');\n    var dash = rawShow.IndexOf('-');\n    if (bracketOpen != -1 &amp;&amp; dash &gt; bracketOpen + 1)\n    {\n        var yearStr = rawShow.Substring(bracketOpen + 1, dash - bracketOpen - 1);\n        return TryParseInt(yearStr);\n    }\n    return None;\n}\n\n/// &lt;summary&gt;\n/// \u7d42\u4e86\u5e74\u3092\u62bd\u51fa\n/// &lt;/summary&gt;\npublic static Option&lt;int&gt; ExtractYearEnd(string rawShow)\n{\n    var dash = rawShow.IndexOf('-');\n    var bracketClose = rawShow.IndexOf(')');\n    if (dash != -1 &amp;&amp; bracketClose &gt; dash + 1)\n    {\n        var yearStr = rawShow.Substring(dash + 1, bracketClose - dash - 1);\n        return TryParseInt(yearStr);\n    }\n    return None;\n}\n</code></pre> <p></p>"},{"location":"csharp/part-3/#65-option-orelse","title":"6.5 Option \u306e OrElse \u306b\u3088\u308b\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af","text":"<p>LanguageExt \u3067\u306f <code>||</code> \u6f14\u7b97\u5b50\u307e\u305f\u306f <code>OrElse</code> \u3092\u4f7f\u3063\u3066\u3001\u6700\u521d\u306e Option \u304c <code>None</code> \u306e\u5834\u5408\u306b\u4ee3\u66ff\u3092\u8a66\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>var seven = Some(7);\nvar eight = Some(8);\nOption&lt;int&gt; none = None;\n\nseven || eight;    // Some(7) - \u6700\u521d\u304c Some \u306a\u306e\u3067\u305d\u306e\u307e\u307e\nnone || eight;     // Some(8) - \u6700\u521d\u304c None \u306a\u306e\u3067\u4ee3\u66ff\u3092\u4f7f\u7528\nseven || none;     // Some(7)\nnone || none;      // None\n</code></pre>"},{"location":"csharp/part-3/#_2","title":"\u5358\u5e74\u306e\u756a\u7d44\u306b\u5bfe\u5fdc\u3059\u308b","text":"<p>\u300cChernobyl (2019)\u300d\u306e\u3088\u3046\u306a\u5358\u5e74\u306e\u756a\u7d44\u3092\u30d1\u30fc\u30b9\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002</p> <pre><code>/// &lt;summary&gt;\n/// \u5358\u5e74\u3092\u62bd\u51fa\n/// &lt;/summary&gt;\npublic static Option&lt;int&gt; ExtractSingleYear(string rawShow)\n{\n    var dash = rawShow.IndexOf('-');\n    var bracketOpen = rawShow.IndexOf('(');\n    var bracketClose = rawShow.IndexOf(')');\n    if (dash == -1 &amp;&amp; bracketOpen != -1 &amp;&amp; bracketClose &gt; bracketOpen + 1)\n    {\n        var yearStr = rawShow.Substring(bracketOpen + 1, bracketClose - bracketOpen - 1);\n        return TryParseInt(yearStr);\n    }\n    return None;\n}\n\npublic static Option&lt;TvShow&gt; ParseShow(string rawShow) =&gt;\n    ExtractName(rawShow).Bind(name =&gt;\n    {\n        var yearStart = ExtractYearStart(rawShow) || ExtractSingleYear(rawShow);\n        var yearEnd = ExtractYearEnd(rawShow) || ExtractSingleYear(rawShow);\n\n        return from start in yearStart\n               from endYear in yearEnd\n               select new TvShow(name, start, endYear);\n    });\n\n// \u3053\u308c\u3067\u5358\u5e74\u306e\u756a\u7d44\u3082\u30d1\u30fc\u30b9\u3067\u304d\u308b\nParseShow(\"Chernobyl (2019)\");\n// Some(new TvShow(\"Chernobyl\", 2019, 2019))\n</code></pre> <p></p>"},{"location":"csharp/part-3/#66-option","title":"6.6 Option \u306e\u4e3b\u8981\u30e1\u30bd\u30c3\u30c9","text":"\u30e1\u30bd\u30c3\u30c9 \u8aac\u660e \u4f8b <code>Map</code> \u5024\u304c\u3042\u308c\u3070\u5909\u63db <code>Some(5).Map(x =&gt; x * 2)</code> \u2192 <code>Some(10)</code> <code>Bind</code> \u5024\u304c\u3042\u308c\u3070 Option \u3092\u8fd4\u3059\u95a2\u6570\u3092\u9069\u7528 <code>Some(5).Bind(x =&gt; Some(x * 2))</code> \u2192 <code>Some(10)</code> <code>Filter</code> \u6761\u4ef6\u3092\u6e80\u305f\u3055\u306a\u3051\u308c\u3070 None <code>Some(5).Filter(x =&gt; x &gt; 10)</code> \u2192 <code>None</code> <code>\\|\\|</code> None \u306a\u3089\u4ee3\u66ff\u3092\u4f7f\u7528 <code>None \\|\\| Some(5)</code> \u2192 <code>Some(5)</code> <code>IfNone</code> None \u306a\u3089\u30c7\u30d5\u30a9\u30eb\u30c8\u5024 <code>None.IfNone(0)</code> \u2192 <code>0</code> <code>ToSeq</code> Seq \u306b\u5909\u63db <code>Some(5).ToSeq()</code> \u2192 <code>Seq(5)</code> <pre><code>Option&lt;int&gt; year = Some(996);\nOption&lt;int&gt; noYear = None;\n\n// Map\nyear.Map(x =&gt; x * 2);     // Some(1992)\nnoYear.Map(x =&gt; x * 2);   // None\n\n// Bind\nyear.Bind(y =&gt; Some(y * 2));     // Some(1992)\nnoYear.Bind(y =&gt; Some(y * 2));   // None\n\n// Filter\nyear.Filter(x =&gt; x &lt; 2020);   // Some(996)\nyear.Filter(x =&gt; x &gt; 2020);   // None\n\n// || (OrElse)\nyear || Some(2020);     // Some(996)\nnoYear || Some(2020);   // Some(2020)\n</code></pre>"},{"location":"csharp/part-3/#67","title":"6.7 \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u6226\u7565","text":"<p>\u8907\u6570\u306e\u8981\u7d20\u3092\u30d1\u30fc\u30b9\u3059\u308b\u5834\u5408\u30012\u3064\u306e\u6226\u7565\u304c\u3042\u308a\u307e\u3059\u3002</p> <p></p>"},{"location":"csharp/part-3/#best-effort","title":"Best-effort \u6226\u7565","text":"<pre><code>public static Seq&lt;TvShow&gt; ParseShowsBestEffort(Seq&lt;string&gt; rawShows) =&gt;\n    rawShows.Bind(raw =&gt; ParseShow(raw).ToSeq());\n\nvar rawShows = Seq(\n    \"Breaking Bad (2008-2013)\",\n    \"The Wire 2002 2008\",        // \u7121\u52b9\u306a\u5f62\u5f0f\n    \"Mad Men (2007-2015)\"\n);\n\nParseShowsBestEffort(rawShows);\n// Seq(TvShow(\"Breaking Bad\", ...), TvShow(\"Mad Men\", ...))\n// \u7121\u52b9\u306a\u3082\u306e\u306f\u7121\u8996\u3055\u308c\u308b\n</code></pre>"},{"location":"csharp/part-3/#all-or-nothing","title":"All-or-nothing \u6226\u7565","text":"<pre><code>public static Option&lt;Seq&lt;TvShow&gt;&gt; ParseShowsAllOrNothing(Seq&lt;string&gt; rawShows)\n{\n    var parsed = rawShows.Map(ParseShow);\n    return parsed.ForAll(opt =&gt; opt.IsSome)\n        ? Some(parsed.Bind(opt =&gt; opt.ToSeq()))\n        : None;\n}\n\n// \u5168\u90e8\u6210\u529f \u2192 Some(...)\nParseShowsAllOrNothing(Seq(\"Breaking Bad (2008-2013)\", \"Mad Men (2007-2015)\"));\n// Some(Seq(TvShow(\"Breaking Bad\", ...), TvShow(\"Mad Men\", ...)))\n\n// \u4e00\u3064\u3067\u3082\u5931\u6557 \u2192 None\nParseShowsAllOrNothing(Seq(\"Breaking Bad (2008-2013)\", \"Invalid\"));\n// None\n</code></pre>"},{"location":"csharp/part-3/#68-forall-exists","title":"6.8 ForAll \u3068 Exists","text":"<p>Option \u3067\u6761\u4ef6\u5224\u5b9a\u3092\u3059\u308b\u969b\u306b\u4fbf\u5229\u306a\u30e1\u30bd\u30c3\u30c9\u3067\u3059\u3002</p> \u30e1\u30bd\u30c3\u30c9 \u52d5\u4f5c <code>ForAll(p)</code> None \u2192 true, Some(x) \u2192 p(x) <code>Exists(p)</code> None \u2192 false, Some(x) \u2192 p(x) <pre><code>Option&lt;int&gt; year = Some(996);\nOption&lt;int&gt; noYear = None;\n\n// ForAll - \u300c\u5168\u3066\u300d\u307e\u305f\u306f\u300c\u5b58\u5728\u3057\u306a\u3044\u300d\nyear.ForAll(x =&gt; x &lt; 2020);     // true (996 &lt; 2020)\nnoYear.ForAll(x =&gt; x &lt; 2020);   // true (\u5024\u304c\u306a\u3044\u306e\u3067\u300c\u5168\u3066\u300d\u304c\u81ea\u660e\u306b\u771f)\nyear.ForAll(x =&gt; x &gt; 2020);     // false\n\n// Exists - \u300c\u5b58\u5728\u3057\u3066\u6761\u4ef6\u3092\u6e80\u305f\u3059\u300d\nyear.Exists(x =&gt; x &lt; 2020);     // true\nnoYear.Exists(x =&gt; x &lt; 2020);   // false (\u5024\u304c\u306a\u3044\u306e\u3067\u5b58\u5728\u3057\u306a\u3044)\n</code></pre>"},{"location":"csharp/part-3/#_3","title":"\u5b9f\u7528\u4f8b: \u30e6\u30fc\u30b6\u30fc\u306e\u30e1\u30fc\u30eb\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0","text":"<pre><code>public record User(string Name, Option&lt;string&gt; Email, int Age);\n\nvar users = Seq(\n    new User(\"Alice\", Some(\"alice@example.com\"), 25),\n    new User(\"Bob\", None, 30),\n    new User(\"Charlie\", Some(\"charlie@test.com\"), 17)\n);\n\n// \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u304b\u3001example.com \u30c9\u30e1\u30a4\u30f3\npublic static Seq&lt;User&gt; FilterByEmailDomain(Seq&lt;User&gt; users, string domain) =&gt;\n    users.Filter(user =&gt;\n        user.Email.ForAll(email =&gt; email.EndsWith(domain)));\n\nFilterByEmailDomain(users, \"@example.com\");\n// Seq(Alice, Bob) - Bob \u306f None \u306a\u306e\u3067 ForAll = true\n\n// \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u3066\u3001test.com \u30c9\u30e1\u30a4\u30f3\npublic static Seq&lt;User&gt; FilterByEmailDomainExists(Seq&lt;User&gt; users, string domain) =&gt;\n    users.Filter(user =&gt;\n        user.Email.Exists(email =&gt; email.EndsWith(domain)));\n\nFilterByEmailDomainExists(users, \"@test.com\");\n// Seq(Charlie)\n</code></pre>"},{"location":"csharp/part-3/#7-either","title":"\u7b2c7\u7ae0: Either \u578b\u3068\u8907\u5408\u7684\u306a\u30a8\u30e9\u30fc\u51e6\u7406","text":""},{"location":"csharp/part-3/#71-option","title":"7.1 Option \u306e\u9650\u754c","text":"<p><code>Option</code> \u306f\u300c\u5024\u304c\u3042\u308b\u304b\u306a\u3044\u304b\u300d\u3057\u304b\u8868\u73fe\u3067\u304d\u307e\u305b\u3093\u3002\u306a\u305c\u5931\u6557\u3057\u305f\u306e\u304b\u3092\u4f1d\u3048\u3089\u308c\u307e\u305b\u3093\u3002</p> <p></p>"},{"location":"csharp/part-3/#72-either","title":"7.2 Either \u306e\u57fa\u672c","text":"<p>LanguageExt \u306e <code>Either&lt;L, R&gt;</code> \u306f\u300c<code>R</code> \u578b\u306e\u6210\u529f\u5024\u304b\u3001<code>L</code> \u578b\u306e\u30a8\u30e9\u30fc\u304b\u300d\u3092\u8868\u3059\u578b\u3067\u3059\u3002</p> <ul> <li><code>Right(value)</code>: \u6210\u529f</li> <li><code>Left(error)</code>: \u5931\u6557\uff08\u30a8\u30e9\u30fc\u60c5\u5831\u3092\u4fdd\u6301\uff09</li> </ul> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/csharp/src/Ch07/ResultHandling.cs</code></p> <pre><code>using LanguageExt;\nusing static LanguageExt.Prelude;\n\npublic static Either&lt;string, string&gt; ExtractName(string rawShow)\n{\n    var bracketOpen = rawShow.IndexOf('(');\n    return bracketOpen &gt; 0\n        ? Right(rawShow.Substring(0, bracketOpen).Trim())\n        : Left($\"Can't extract name from '{rawShow}'\");\n}\n\nExtractName(\"The Wire (2002-2008)\");  // Right(\"The Wire\")\nExtractName(\"(2022)\");                // Left(\"Can't extract name from '(2022)'\")\n</code></pre>"},{"location":"csharp/part-3/#73-either","title":"7.3 Either \u3092\u4f7f\u3063\u305f\u30d1\u30fc\u30b9","text":"<pre><code>public static Either&lt;string, int&gt; ExtractYearStart(string rawShow)\n{\n    var bracketOpen = rawShow.IndexOf('(');\n    var dash = rawShow.IndexOf('-');\n    if (bracketOpen != -1 &amp;&amp; dash &gt; bracketOpen + 1)\n    {\n        var yearStr = rawShow.Substring(bracketOpen + 1, dash - bracketOpen - 1);\n        return TryParseInt(yearStr);\n    }\n    return Left($\"Can't extract start year from '{rawShow}'\");\n}\n\nExtractYearStart(\"The Wire (2002-2008)\");  // Right(2002)\nExtractYearStart(\"The Wire (-2008)\");      // Left(\"Can't extract start year from 'The Wire (-2008)'\")\nExtractYearStart(\"The Wire (oops-2008)\");  // Left(\"Can't parse 'oops' as integer\")\n</code></pre>"},{"location":"csharp/part-3/#74-either-orelse","title":"7.4 Either \u306e OrElse \u306b\u3088\u308b\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af","text":"<pre><code>public static Either&lt;L, R&gt; OrElse&lt;L, R&gt;(this Either&lt;L, R&gt; either, Either&lt;L, R&gt; alternative) =&gt;\n    either.IsRight ? either : alternative;\n\nvar first = Right&lt;string, int&gt;(42);\nvar alternative = Right&lt;string, int&gt;(100);\nvar error = Left&lt;string, int&gt;(\"error\");\n\nfirst.OrElse(alternative);      // Right(42) - \u6700\u521d\u304c Right \u306a\u306e\u3067\u305d\u306e\u307e\u307e\nerror.OrElse(alternative);      // Right(100) - \u6700\u521d\u304c Left \u306a\u306e\u3067\u4ee3\u66ff\u3092\u4f7f\u7528\n</code></pre>"},{"location":"csharp/part-3/#75-either","title":"7.5 Either \u306b\u3088\u308b\u5b8c\u5168\u306a\u30d1\u30fc\u30b5\u30fc","text":"<pre><code>public static Either&lt;string, TvShow&gt; ParseShow(string rawShow) =&gt;\n    ExtractName(rawShow).Bind(name =&gt;\n    {\n        var yearStart = ExtractYearStart(rawShow).OrElse(ExtractSingleYear(rawShow));\n        var yearEnd = ExtractYearEnd(rawShow).OrElse(ExtractSingleYear(rawShow));\n\n        return from start in yearStart\n               from endYear in yearEnd\n               select new TvShow(name, start, endYear);\n    });\n\nParseShow(\"The Wire (2002-2008)\");  // Right(TvShow(\"The Wire\", 2002, 2008))\nParseShow(\"Mad Men ()\");            // Left(\"Can't extract single year from 'Mad Men ()'\")\nParseShow(\"(2002-2008)\");           // Left(\"Can't extract name from '(2002-2008)'\")\n</code></pre>"},{"location":"csharp/part-3/#76","title":"7.6 \u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3","text":"<p>Either \u306f\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u306b\u6700\u9069\u3067\u3059\u3002</p> <pre><code>public static Either&lt;string, int&gt; ValidateAge(int age) =&gt;\n    age &lt; 0 ? Left(\"Age cannot be negative\")\n    : age &gt; 150 ? Left(\"Age cannot be greater than 150\")\n    : Right(age);\n\npublic static Either&lt;string, string&gt; ValidateName(string name) =&gt;\n    string.IsNullOrWhiteSpace(name) ? Left(\"Name cannot be empty\")\n    : name.Length &gt; 100 ? Left(\"Name cannot be longer than 100 characters\")\n    : Right(name);\n\npublic static Either&lt;string, string&gt; ValidateEmail(string email) =&gt;\n    string.IsNullOrWhiteSpace(email) ? Left(\"Email cannot be empty\")\n    : !email.Contains('@') ? Left(\"Email must contain @\")\n    : Right(email);\n</code></pre>"},{"location":"csharp/part-3/#77-adt","title":"7.7 \u4ee3\u6570\u7684\u30c7\u30fc\u30bf\u578b\uff08ADT\uff09","text":"<p>C# \u3067\u306f\u3001abstract record \u3068 record \u3092\u4f7f\u3063\u3066\u76f4\u548c\u578b\u3092\u8868\u73fe\u3057\u307e\u3059\u3002</p>"},{"location":"csharp/part-3/#product-type","title":"\u76f4\u7a4d\u578b\uff08Product Type\uff09","text":"<p>\u8907\u6570\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u3092AND\u3067\u7d44\u307f\u5408\u308f\u305b\u308b\u578b\u3067\u3059\u3002</p> <pre><code>/// &lt;summary&gt;\n/// \u30a2\u30fc\u30c6\u30a3\u30b9\u30c8\uff08\u76f4\u7a4d\u578b\uff09\n/// &lt;/summary&gt;\npublic record Artist(string Name, MusicGenre Genre, Location Origin, YearsActive YearsActive);\n</code></pre>"},{"location":"csharp/part-3/#sum-type","title":"\u76f4\u548c\u578b\uff08Sum Type\uff09","text":"<p>\u8907\u6570\u306e\u9078\u629e\u80a2\u3092OR\u3067\u8868\u3059\u578b\u3067\u3059\u3002</p> <pre><code>/// &lt;summary&gt;\n/// \u97f3\u697d\u30b8\u30e3\u30f3\u30eb\uff08\u76f4\u548c\u578b\u3092 enum \u3067\u8868\u73fe\uff09\n/// &lt;/summary&gt;\npublic enum MusicGenre\n{\n    HeavyMetal,\n    Pop,\n    HardRock,\n    Jazz,\n    Classical\n}\n\n/// &lt;summary&gt;\n/// \u6d3b\u52d5\u671f\u9593\uff08\u76f4\u548c\u578b\u3092\u62bd\u8c61\u30af\u30e9\u30b9\u3067\u8868\u73fe\uff09\n/// &lt;/summary&gt;\npublic abstract record YearsActive;\npublic record StillActive(int Since) : YearsActive;\npublic record ActiveBetween(int Start, int EndYear) : YearsActive;\n\n/// &lt;summary&gt;\n/// \u5730\u57df\uff08\u76f4\u548c\u578b\u3092\u62bd\u8c61\u30af\u30e9\u30b9\u3067\u8868\u73fe\uff09\n/// &lt;/summary&gt;\npublic abstract record Location;\npublic record US() : Location;\npublic record UK() : Location;\npublic record Japan() : Location;\npublic record OtherLocation(string Name) : Location;\n</code></pre> <p></p>"},{"location":"csharp/part-3/#78","title":"7.8 \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0","text":"<p>C# \u3067\u306f switch \u5f0f \u3067\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u884c\u3044\u307e\u3059\u3002</p> <pre><code>public static bool WasArtistActive(Artist artist, int yearStart, int yearEnd) =&gt;\n    artist.YearsActive switch\n    {\n        StillActive sa =&gt; sa.Since &lt;= yearEnd,\n        ActiveBetween ab =&gt; ab.Start &lt;= yearEnd &amp;&amp; ab.EndYear &gt;= yearStart,\n        _ =&gt; false\n    };\n\npublic static int ActiveLength(Artist artist, int currentYear) =&gt;\n    artist.YearsActive switch\n    {\n        StillActive sa =&gt; currentYear - sa.Since,\n        ActiveBetween ab =&gt; ab.EndYear - ab.Start,\n        _ =&gt; 0\n    };\n\npublic static string DescribeActivity(YearsActive yearsActive) =&gt;\n    yearsActive switch\n    {\n        StillActive sa =&gt; $\"Active since {sa.Since}\",\n        ActiveBetween ab =&gt; $\"Active from {ab.Start} to {ab.EndYear}\",\n        _ =&gt; \"Unknown\"\n    };\n</code></pre> <p></p>"},{"location":"csharp/part-3/#79","title":"7.9 \u691c\u7d22\u6761\u4ef6\u306e\u30e2\u30c7\u30ea\u30f3\u30b0","text":"<p>\u691c\u7d22\u6761\u4ef6\u3082 ADT \u3067\u30e2\u30c7\u30ea\u30f3\u30b0\u3067\u304d\u307e\u3059\u3002</p> <pre><code>public abstract record SearchCondition;\npublic record SearchByGenre(Seq&lt;MusicGenre&gt; Genres) : SearchCondition;\npublic record SearchByOrigin(Seq&lt;Location&gt; Locations) : SearchCondition;\npublic record SearchByActiveYears(int Start, int EndYear) : SearchCondition;\n\npublic static bool MatchesCondition(Artist artist, SearchCondition condition) =&gt;\n    condition switch\n    {\n        SearchByGenre sg =&gt; sg.Genres.Exists(g =&gt; g == artist.Genre),\n        SearchByOrigin so =&gt; so.Locations.Exists(l =&gt; l == artist.Origin),\n        SearchByActiveYears say =&gt; WasArtistActive(artist, say.Start, say.EndYear),\n        _ =&gt; false\n    };\n\npublic static Seq&lt;Artist&gt; SearchArtists(Seq&lt;Artist&gt; artists, Seq&lt;SearchCondition&gt; conditions) =&gt;\n    artists.Filter(artist =&gt;\n        conditions.ForAll(condition =&gt; MatchesCondition(artist, condition)));\n</code></pre>"},{"location":"csharp/part-3/#710","title":"7.10 \u652f\u6255\u3044\u65b9\u6cd5\u306e\u4f8b","text":"<pre><code>public abstract record PaymentMethod;\npublic record CreditCard(string Number, string Expiry) : PaymentMethod;\npublic record BankTransfer(string AccountNumber) : PaymentMethod;\npublic record Cash() : PaymentMethod;\n\npublic static string DescribePayment(PaymentMethod method) =&gt;\n    method switch\n    {\n        CreditCard cc =&gt; $\"Credit card ending in {cc.Number}\",\n        BankTransfer bt =&gt; $\"Bank transfer to account {bt.AccountNumber}\",\n        Cash =&gt; \"Cash payment\",\n        _ =&gt; \"Unknown payment method\"\n    };\n\npublic static bool IsValidPayment(PaymentMethod method) =&gt;\n    method switch\n    {\n        CreditCard cc =&gt; cc.Number.Length &gt;= 4 &amp;&amp; cc.Expiry.Contains('/'),\n        BankTransfer bt =&gt; bt.AccountNumber.Length &gt; 0,\n        Cash =&gt; true,\n        _ =&gt; false\n    };\n</code></pre>"},{"location":"csharp/part-3/#_4","title":"\u307e\u3068\u3081","text":""},{"location":"csharp/part-3/#part-iii","title":"Part III \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"csharp/part-3/#option-vs-either","title":"Option vs Either \u306e\u4f7f\u3044\u5206\u3051","text":"\u72b6\u6cc1 \u4f7f\u7528\u3059\u308b\u578b \u5024\u304c\u3042\u308b\u304b\u306a\u3044\u304b\u3060\u3051\u304c\u91cd\u8981 <code>Option&lt;T&gt;</code> \u5931\u6557\u7406\u7531\u3092\u4f1d\u3048\u308b\u5fc5\u8981\u304c\u3042\u308b <code>Either&lt;string, T&gt;</code> \u691c\u7d22\u7d50\u679c\u304c\u898b\u3064\u304b\u3089\u306a\u3044 <code>Option&lt;T&gt;</code> \u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u30a8\u30e9\u30fc\u3092\u4f1d\u3048\u308b <code>Either&lt;string, T&gt;</code> \u8907\u6570\u306e\u30a8\u30e9\u30fc\u7a2e\u5225\u304c\u3042\u308b <code>Either&lt;ErrorType, T&gt;</code>"},{"location":"csharp/part-3/#f-scala-c","title":"F# / Scala / C# \u306e\u5bfe\u5fdc","text":"\u6982\u5ff5 F# Scala C# (LanguageExt) \u5024\u306e\u6709\u7121 <code>option</code> <code>Option</code> <code>Option&lt;T&gt;</code> \u6210\u529f/\u5931\u6557 <code>Result</code> <code>Either</code> <code>Either&lt;L, R&gt;</code> \u5024\u3042\u308a <code>Some</code> <code>Some</code> <code>Some(value)</code> \u5024\u306a\u3057 <code>None</code> <code>None</code> <code>None</code> \u6210\u529f <code>Ok</code> <code>Right</code> <code>Right(value)</code> \u5931\u6557 <code>Error</code> <code>Left</code> <code>Left(error)</code> \u76f4\u548c\u578b \u5224\u5225\u5171\u7528\u4f53 sealed trait abstract record"},{"location":"csharp/part-3/#_5","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>Option: \u5024\u306e\u6709\u7121\u3092\u578b\u3067\u8868\u73fe\u3059\u308b</li> <li>Either: \u6210\u529f/\u5931\u6557\u3068\u30a8\u30e9\u30fc\u60c5\u5831\u3092\u578b\u3067\u8868\u73fe\u3059\u308b</li> <li>\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0: switch \u5f0f\u3067 Option/Either \u3092\u5b89\u5168\u306b\u51e6\u7406\u3059\u308b</li> <li>OrElse (||): \u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u3092\u63d0\u4f9b\u3059\u308b</li> <li>ADT: \u76f4\u7a4d\u578b\u3068\u76f4\u548c\u578b\u3067\u30c9\u30e1\u30a4\u30f3\u3092\u6b63\u78ba\u306b\u30e2\u30c7\u30ea\u30f3\u30b0</li> <li>ForAll/Exists: Option \u3067\u306e\u6761\u4ef6\u5224\u5b9a\u306b\u4fbf\u5229</li> </ol>"},{"location":"csharp/part-3/#_6","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part IV \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li>\u526f\u4f5c\u7528\u306e\u7ba1\u7406</li> <li>\u975e\u540c\u671f\u51e6\u7406</li> <li>\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406</li> </ul>"},{"location":"csharp/part-3/#_7","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"csharp/part-3/#1-option","title":"\u554f\u984c 1: Option \u306e\u57fa\u672c","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>public static Option&lt;int&gt; SafeDivide(int a, int b)\n{\n    // TODO: \u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\n}\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nAssert.Equal(Some(5), SafeDivide(10, 2));\nAssert.Equal(None, SafeDivide(10, 0));\nAssert.Equal(Some(3), SafeDivide(7, 2));\n</code></pre> \u89e3\u7b54 <pre><code>public static Option&lt;int&gt; SafeDivide(int a, int b) =&gt;\n    b == 0 ? None : Some(a / b);\n</code></pre>"},{"location":"csharp/part-3/#2-option","title":"\u554f\u984c 2: Option \u306e\u5408\u6210","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u30022\u3064\u306e\u6570\u5024\u6587\u5b57\u5217\u3092\u53d7\u3051\u53d6\u308a\u3001\u305d\u306e\u5408\u8a08\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>public static Option&lt;int&gt; AddStrings(string a, string b)\n{\n    // TODO: \u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\n}\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nAssert.Equal(Some(30), AddStrings(\"10\", \"20\"));\nAssert.Equal(None, AddStrings(\"10\", \"abc\"));\nAssert.Equal(None, AddStrings(\"xyz\", \"20\"));\n</code></pre> \u89e3\u7b54 <pre><code>public static Option&lt;int&gt; TryParseInt(string s) =&gt;\n    int.TryParse(s, out var result) ? Some(result) : None;\n\npublic static Option&lt;int&gt; AddStrings(string a, string b) =&gt;\n    from x in TryParseInt(a)\n    from y in TryParseInt(b)\n    select x + y;\n</code></pre>"},{"location":"csharp/part-3/#3-either","title":"\u554f\u984c 3: Either \u306b\u3088\u308b\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u5e74\u9f62\u3092\u691c\u8a3c\u3057\u3001\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>public static Either&lt;string, int&gt; ValidateAge(int age)\n{\n    // TODO: \u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\n}\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nAssert.True(ValidateAge(25).IsRight);\nAssert.Equal(Left(\"Age cannot be negative\"), ValidateAge(-5));\nAssert.Equal(Left(\"Age cannot be greater than 150\"), ValidateAge(200));\n</code></pre> \u89e3\u7b54 <pre><code>public static Either&lt;string, int&gt; ValidateAge(int age) =&gt;\n    age &lt; 0 ? Left(\"Age cannot be negative\")\n    : age &gt; 150 ? Left(\"Age cannot be greater than 150\")\n    : Right(age);\n</code></pre>"},{"location":"csharp/part-3/#4","title":"\u554f\u984c 4: \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0","text":"<p>\u4ee5\u4e0b\u306e\u76f4\u548c\u578b\u3068\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u4f7f\u3063\u305f\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>public abstract record PaymentMethod;\npublic record CreditCard(string Number, string Expiry) : PaymentMethod;\npublic record BankTransfer(string AccountNumber) : PaymentMethod;\npublic record Cash() : PaymentMethod;\n\npublic static string DescribePayment(PaymentMethod method)\n{\n    // TODO: \u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\n}\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nAssert.Equal(\"Credit card ending in 1234\", DescribePayment(new CreditCard(\"1234\", \"12/25\")));\nAssert.Equal(\"Bank transfer to account 9876\", DescribePayment(new BankTransfer(\"9876\")));\nAssert.Equal(\"Cash payment\", DescribePayment(new Cash()));\n</code></pre> \u89e3\u7b54 <pre><code>public static string DescribePayment(PaymentMethod method) =&gt;\n    method switch\n    {\n        CreditCard cc =&gt; $\"Credit card ending in {cc.Number}\",\n        BankTransfer bt =&gt; $\"Bank transfer to account {bt.AccountNumber}\",\n        Cash =&gt; \"Cash payment\",\n        _ =&gt; \"Unknown payment method\"\n    };\n</code></pre>"},{"location":"csharp/part-3/#5-forall-exists","title":"\u554f\u984c 5: ForAll \u3068 Exists","text":"<p>\u4ee5\u4e0b\u306e\u6761\u4ef6\u306b\u5408\u3046\u30e6\u30fc\u30b6\u30fc\u3092\u62bd\u51fa\u3059\u308b\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>public record User(string Name, Option&lt;string&gt; Email, int Age);\n\nvar users = Seq(\n    new User(\"Alice\", Some(\"alice@example.com\"), 25),\n    new User(\"Bob\", None, 30),\n    new User(\"Charlie\", Some(\"charlie@test.com\"), 17)\n);\n\n// 1. \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u304b\u3001example.com \u30c9\u30e1\u30a4\u30f3\u306e\u30e6\u30fc\u30b6\u30fc\npublic static Seq&lt;User&gt; F1(Seq&lt;User&gt; users)\n{\n    // TODO: \u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\n}\n\n// 2. \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u3066\u3001test.com \u30c9\u30e1\u30a4\u30f3\u306e\u30e6\u30fc\u30b6\u30fc\npublic static Seq&lt;User&gt; F2(Seq&lt;User&gt; users)\n{\n    // TODO: \u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\n}\n</code></pre> \u89e3\u7b54 <pre><code>// 1. \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u304b\u3001example.com \u30c9\u30e1\u30a4\u30f3\npublic static Seq&lt;User&gt; F1(Seq&lt;User&gt; users) =&gt;\n    users.Filter(user =&gt;\n        user.Email.ForAll(email =&gt; email.EndsWith(\"@example.com\")));\n// Seq(Alice, Bob)\n\n// 2. \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u3066\u3001test.com \u30c9\u30e1\u30a4\u30f3\npublic static Seq&lt;User&gt; F2(Seq&lt;User&gt; users) =&gt;\n    users.Filter(user =&gt;\n        user.Email.Exists(email =&gt; email.EndsWith(\"@test.com\")));\n// Seq(Charlie)\n</code></pre>"},{"location":"csharp/part-4/","title":"Part IV: \u975e\u540c\u671f\u51e6\u7406\u3068\u30b9\u30c8\u30ea\u30fc\u30e0","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u526f\u4f5c\u7528\u306e\u6271\u3044\u65b9\u3092\u5b66\u3073\u307e\u3059\u3002C# \u306e Task \u3068 LanguageExt \u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u4f7f\u3063\u3066\u526f\u4f5c\u7528\u3092\u7d14\u7c8b\u95a2\u6570\u5185\u3067\u5b89\u5168\u306b\u8a18\u8ff0\u3057\u3001IEnumerable/Seq \u3067\u7121\u9650\u306e\u30c7\u30fc\u30bf\u3092\u6271\u3046\u65b9\u6cd5\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"csharp/part-4/#8-task","title":"\u7b2c8\u7ae0: Task \u306b\u3088\u308b\u975e\u540c\u671f\u51e6\u7406","text":""},{"location":"csharp/part-4/#81","title":"8.1 \u526f\u4f5c\u7528\u306e\u554f\u984c","text":"<p>\u7d14\u7c8b\u95a2\u6570\u306f\u526f\u4f5c\u7528\u3092\u6301\u3061\u307e\u305b\u3093\u3002\u3057\u304b\u3057\u3001\u5b9f\u969b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u306b\u306f\u526f\u4f5c\u7528\u304c\u5fc5\u8981\u3067\u3059:</p> <ul> <li>\u30d5\u30a1\u30a4\u30eb\u306e\u8aad\u307f\u66f8\u304d</li> <li>\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u901a\u4fe1</li> <li>\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30a2\u30af\u30bb\u30b9</li> <li>\u4e71\u6570\u751f\u6210</li> <li>\u73fe\u5728\u6642\u523b\u306e\u53d6\u5f97</li> </ul> <p></p>"},{"location":"csharp/part-4/#82-c-task","title":"8.2 C# \u306e Task \u3068\u306f","text":"<p>Task\uff08\u30bf\u30b9\u30af\uff09\u306f\u300c\u526f\u4f5c\u7528\u3092\u6301\u3064\u8a08\u7b97\u306e\u8a18\u8ff0\u300d\u3092\u8868\u3059\u578b\u3067\u3059\u3002</p> <ul> <li><code>Task&lt;T&gt;</code> \u306f\u300c\u5b9f\u884c\u3059\u308b\u3068 <code>T</code> \u578b\u306e\u5024\u3092\u8fd4\u3059\u526f\u4f5c\u7528\u306e\u3042\u308b\u8a08\u7b97\u300d</li> <li>Task \u3092\u4f5c\u6210\u3057\u305f\u3060\u3051\u3067\u306f\u526f\u4f5c\u7528\u306f\u767a\u751f\u3057\u306a\u3044\uff08<code>Task.Run</code> \u3092\u9664\u304f\uff09</li> <li><code>await</code> \u307e\u305f\u306f <code>.GetAwaiter().GetResult()</code> \u3067\u5b9f\u969b\u306b\u5b9f\u884c\u3055\u308c\u308b</li> </ul> <p></p>"},{"location":"csharp/part-4/#83","title":"8.3 \u30b5\u30a4\u30b3\u30ed\u3092\u632f\u308b\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/csharp/src/Ch08/AsyncIO.cs</code></p>"},{"location":"csharp/part-4/#_1","title":"\u4e0d\u7d14\u306a\u95a2\u6570\uff08\u526f\u4f5c\u7528\u3042\u308a\uff09","text":"<pre><code>using System;\n\npublic static int CastTheDieImpure()\n{\n    var random = new Random();\n    return random.Next(1, 7);\n}\n\n// \u547c\u3073\u51fa\u3059\u305f\u3073\u306b\u7570\u306a\u308b\u5024\u304c\u8fd4\u308b\nConsole.WriteLine(CastTheDieImpure());  // 3\nConsole.WriteLine(CastTheDieImpure());  // 5\nConsole.WriteLine(CastTheDieImpure());  // 1\n</code></pre>"},{"location":"csharp/part-4/#task","title":"Task \u3092\u4f7f\u3063\u305f\u7d14\u7c8b\u306a\u8a18\u8ff0","text":"<pre><code>public static Task&lt;int&gt; CastTheDie() =&gt;\n    Task.Run(CastTheDieImpure);\n\n// Task \u5024\u3092\u4f5c\u6210\uff08\u3053\u306e\u6642\u70b9\u3067\u306f\u5b9f\u884c\u3055\u308c\u306a\u3044\uff09\nTask&lt;int&gt; dieCast = CastTheDie();\nConsole.WriteLine(dieCast);  // Task&lt;int&gt; - \u307e\u3060\u5b9f\u884c\u3055\u308c\u3066\u3044\u306a\u3044\n\n// \u5b9f\u969b\u306b\u5b9f\u884c\nConsole.WriteLine(await dieCast);  // 4\n</code></pre>"},{"location":"csharp/part-4/#84-task","title":"8.4 Task \u306e\u4f5c\u6210\u65b9\u6cd5","text":"\u65b9\u6cd5 \u7528\u9014 \u4f8b <code>Task.FromResult(value)</code> \u65e2\u5b58\u306e\u5024\u3092\u30e9\u30c3\u30d7\uff08\u526f\u4f5c\u7528\u306a\u3057\uff09 <code>Task.FromResult(42)</code> <code>Task.Run(() =&gt; expr)</code> \u526f\u4f5c\u7528\u306e\u3042\u308b\u5f0f\u3092\u30e9\u30c3\u30d7 <code>Task.Run(() =&gt; CastTheDieImpure())</code> <code>Task.FromResult(Unit.Default)</code> \u4f55\u3082\u3057\u306a\u3044 Task <code>Task.FromResult(unit)</code> <pre><code>using LanguageExt;\nusing static LanguageExt.Prelude;\n\n// \u526f\u4f5c\u7528\u3092\u9045\u5ef6\u5b9f\u884c\npublic static Task&lt;T&gt; DelayEffect&lt;T&gt;(Func&lt;T&gt; effect) =&gt;\n    Task.Run(effect);\n\n// \u7d14\u7c8b\u306a\u5024\u3092\u30e9\u30c3\u30d7\npublic static Task&lt;T&gt; PureAsync&lt;T&gt;(T value) =&gt;\n    Task.FromResult(value);\n\n// Unit \u3092\u8fd4\u3059 Task\npublic static Task&lt;Unit&gt; UnitAsync =&gt;\n    Task.FromResult(unit);\n</code></pre>"},{"location":"csharp/part-4/#85-task","title":"8.5 Task \u306e\u5408\u6210","text":"<p>Task \u5024\u306f <code>async/await</code> \u3092\u4f7f\u3063\u3066\u5408\u6210\u3067\u304d\u307e\u3059\u3002</p> <pre><code>public static async Task&lt;int&gt; CastTheDieTwice()\n{\n    var first = await CastTheDie();\n    var second = await CastTheDie();\n    return first + second;\n}\n\n// \u307e\u3060\u5b9f\u884c\u3055\u308c\u3066\u3044\u306a\u3044\nTask&lt;int&gt; program = CastTheDieTwice();\n\n// \u5b9f\u884c\nint result = await program;\n</code></pre> <p></p>"},{"location":"csharp/part-4/#86","title":"8.6 \u30df\u30fc\u30c6\u30a3\u30f3\u30b0\u30b9\u30b1\u30b8\u30e5\u30fc\u30ea\u30f3\u30b0\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/csharp/src/Ch08/AsyncIO.cs</code></p> <p>\u3088\u308a\u5b9f\u8df5\u7684\u306a\u4f8b\u3068\u3057\u3066\u3001\u30df\u30fc\u30c6\u30a3\u30f3\u30b0\u306e\u30b9\u30b1\u30b8\u30e5\u30fc\u30ea\u30f3\u30b0\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p> <pre><code>public record MeetingTime(int StartHour, int EndHour);\n\n// \u526f\u4f5c\u7528\u306e\u3042\u308b API \u547c\u3073\u51fa\u3057\u3092 Task \u3067\u30e9\u30c3\u30d7\npublic static Task&lt;Seq&lt;MeetingTime&gt;&gt; CalendarEntries(string name) =&gt;\n    Task.Run(() =&gt; CalendarEntriesApiCall(name));\n</code></pre>"},{"location":"csharp/part-4/#_2","title":"\u4e88\u5b9a\u306e\u53d6\u5f97","text":"<pre><code>public static async Task&lt;Seq&lt;MeetingTime&gt;&gt; ScheduledMeetings(string person1, string person2)\n{\n    var entries1 = await CalendarEntries(person1);\n    var entries2 = await CalendarEntries(person2);\n    return entries1.Concat(entries2);\n}\n</code></pre>"},{"location":"csharp/part-4/#_3","title":"\u7a7a\u304d\u6642\u9593\u306e\u8a08\u7b97\uff08\u7d14\u7c8b\u95a2\u6570\uff09","text":"<pre><code>public static Seq&lt;MeetingTime&gt; PossibleMeetings(\n    Seq&lt;MeetingTime&gt; existingMeetings,\n    int startHour,\n    int endHour,\n    int lengthHours)\n{\n    return toSeq(Enumerable.Range(startHour, endHour - lengthHours - startHour + 1)\n        .Select(start =&gt; new MeetingTime(start, start + lengthHours))\n        .Where(slot =&gt; existingMeetings.ForAll(meeting =&gt; !MeetingsOverlap(meeting, slot))));\n}\n</code></pre>"},{"location":"csharp/part-4/#87-orelse","title":"8.7 OrElse \u306b\u3088\u308b\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":"<p>\u5931\u6557\u6642\u306e\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002</p> <pre><code>public static async Task&lt;T&gt; OrElse&lt;T&gt;(this Task&lt;T&gt; primary, Task&lt;T&gt; fallback)\n{\n    try\n    {\n        return await primary;\n    }\n    catch\n    {\n        return await fallback;\n    }\n}\n\n// \u4f7f\u7528\u4f8b\nvar year = await SucceedingAsync(996).OrElse(SucceedingAsync(2020));    // 996\nvar noYear = await FailingAsync(\"error\").OrElse(SucceedingAsync(2020));  // 2020\n</code></pre> <p></p>"},{"location":"csharp/part-4/#_4","title":"\u30ea\u30c8\u30e9\u30a4\u6226\u7565","text":"<pre><code>// API \u547c\u3073\u51fa\u3057\u30923\u56de\u307e\u3067\u30ea\u30c8\u30e9\u30a4\nawait CalendarEntries(\"Alice\")\n    .OrElse(CalendarEntries(\"Alice\"))\n    .OrElse(CalendarEntries(\"Alice\"))\n    .OrElse(Task.FromResult(Seq&lt;MeetingTime&gt;()));  // \u5168\u90e8\u5931\u6557\u3057\u305f\u3089\u7a7a\u30ea\u30b9\u30c8\n</code></pre>"},{"location":"csharp/part-4/#_5","title":"\u6c4e\u7528\u30ea\u30c8\u30e9\u30a4\u95a2\u6570","text":"<pre><code>public static async Task&lt;T&gt; Retry&lt;T&gt;(int maxRetries, Func&lt;Task&lt;T&gt;&gt; action)\n{\n    var remaining = maxRetries;\n    while (true)\n    {\n        try\n        {\n            return await action();\n        }\n        catch when (remaining &gt; 0)\n        {\n            remaining--;\n        }\n    }\n}\n\n// \u4f7f\u7528\u4f8b\nawait Retry(10, () =&gt; CalendarEntries(\"Alice\"));\n</code></pre>"},{"location":"csharp/part-4/#88-sequence-task","title":"8.8 Sequence \u306b\u3088\u308b Task \u306e\u30ea\u30b9\u30c8\u51e6\u7406","text":"<p><code>Seq&lt;Task&lt;T&gt;&gt;</code> \u3092 <code>Task&lt;Seq&lt;T&gt;&gt;</code> \u306b\u5909\u63db\u3059\u308b\u306b\u306f Sequence \u3092\u4f7f\u3044\u307e\u3059\u3002</p> <pre><code>public static async Task&lt;Seq&lt;T&gt;&gt; Sequence&lt;T&gt;(Seq&lt;Task&lt;T&gt;&gt; tasks)\n{\n    var results = new List&lt;T&gt;();\n    foreach (var task in tasks)\n    {\n        results.Add(await task);\n    }\n    return toSeq(results);\n}\n\nvar actions = Seq(\n    Task.FromResult(1),\n    Task.FromResult(2),\n    Task.FromResult(3)\n);\nvar combined = await Sequence(actions);  // Seq(1, 2, 3)\n</code></pre>"},{"location":"csharp/part-4/#_6","title":"\u8907\u6570\u4eba\u306e\u4e88\u5b9a\u3092\u53d6\u5f97","text":"<pre><code>public static async Task&lt;Seq&lt;MeetingTime&gt;&gt; ScheduledMeetingsMultiple(Seq&lt;string&gt; attendees)\n{\n    var tasks = attendees.Map(CalendarEntries);\n    var allMeetings = await Sequence(tasks);\n    return allMeetings.Bind(x =&gt; x);\n}\n</code></pre>"},{"location":"csharp/part-4/#89","title":"8.9 \u4e26\u5217\u5b9f\u884c","text":"<p>C# \u3067\u306f <code>Task.WhenAll</code> \u3067\u8907\u6570\u306e Task \u3092\u4e26\u5217\u5b9f\u884c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>public static async Task&lt;(T1, T2)&gt; Parallel2&lt;T1, T2&gt;(Task&lt;T1&gt; task1, Task&lt;T2&gt; task2)\n{\n    await Task.WhenAll(task1, task2);\n    return (task1.Result, task2.Result);\n}\n\npublic static async Task&lt;Seq&lt;T&gt;&gt; ParallelAll&lt;T&gt;(Seq&lt;Task&lt;T&gt;&gt; tasks)\n{\n    var results = await Task.WhenAll(tasks);\n    return toSeq(results);\n}\n\n// \u4f7f\u7528\u4f8b\nvar tasks = Seq(CalendarEntries(\"Alice\"), CalendarEntries(\"Bob\"), CalendarEntries(\"Charlie\"));\nvar allResults = await ParallelAll(tasks);\n</code></pre>"},{"location":"csharp/part-4/#9","title":"\u7b2c9\u7ae0: \u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406","text":""},{"location":"csharp/part-4/#91-ienumerable-seq","title":"9.1 IEnumerable \u3068 Seq \u3068\u306f","text":"<p>IEnumerable/Seq\uff08\u30b7\u30fc\u30b1\u30f3\u30b9\uff09\u306f\u3001\u8981\u7d20\u306e\uff08\u6f5c\u5728\u7684\u306b\u7121\u9650\u306e\uff09\u30b7\u30fc\u30b1\u30f3\u30b9\u3092\u8868\u3057\u307e\u3059\u3002</p> <p></p>"},{"location":"csharp/part-4/#92","title":"9.2 \u7d14\u7c8b\u306a\u30b7\u30fc\u30b1\u30f3\u30b9","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/csharp/src/Ch09/StreamProcessing.cs</code></p> <pre><code>using LanguageExt;\nusing static LanguageExt.Prelude;\n\n// \u6709\u9650\u30b7\u30fc\u30b1\u30f3\u30b9\nSeq&lt;int&gt; numbers = Seq(1, 2, 3);\n\n// List \u306b\u5909\u63db\nnumbers.ToList();  // [1, 2, 3]\n\n// \u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\nvar oddNumbers = numbers.Filter(n =&gt; n % 2 != 0);\noddNumbers.ToList();  // [1, 3]\n</code></pre>"},{"location":"csharp/part-4/#93","title":"9.3 \u7121\u9650\u30b7\u30fc\u30b1\u30f3\u30b9","text":"<pre><code>// repeat \u3067\u7121\u9650\u306b\u7e70\u308a\u8fd4\u3057\npublic static IEnumerable&lt;T&gt; Repeat&lt;T&gt;(IEnumerable&lt;T&gt; elements)\n{\n    while (true)\n    {\n        foreach (var element in elements)\n        {\n            yield return element;\n        }\n    }\n}\n\nIEnumerable&lt;int&gt; infinite123s = Repeat(new[] { 1, 2, 3 });\n\n// Take \u3067\u6709\u9650\u500b\u3092\u53d6\u5f97\ninfinite123s.Take(8).ToList();  // [1, 2, 3, 1, 2, 3, 1, 2]\n</code></pre>"},{"location":"csharp/part-4/#94","title":"9.4 \u30b5\u30a4\u30b3\u30ed\u3092\u632f\u308b\u30b9\u30c8\u30ea\u30fc\u30e0","text":"<pre><code>private static readonly Random _random = new();\n\nprivate static int CastTheDieImpure() =&gt;\n    _random.Next(1, 7);\n\n// \u30b5\u30a4\u30b3\u30ed\u3092\u7121\u9650\u306b\u632f\u308b\u30b9\u30c8\u30ea\u30fc\u30e0\npublic static IEnumerable&lt;int&gt; InfiniteDieCasts\n{\n    get\n    {\n        while (true)\n        {\n            yield return CastTheDieImpure();\n        }\n    }\n}\n\n// \u6700\u521d\u306e3\u56de\u3092\u53d6\u5f97\nInfiniteDieCasts.Take(3).ToList();  // [4, 2, 6]\n\n// 6 \u304c\u51fa\u308b\u307e\u3067\u632f\u308a\u7d9a\u3051\u308b\npublic static IEnumerable&lt;int&gt; CastUntil(int target)\n{\n    while (true)\n    {\n        var n = CastTheDieImpure();\n        yield return n;\n        if (n == target) yield break;\n    }\n}\n</code></pre>"},{"location":"csharp/part-4/#95","title":"9.5 \u30b7\u30fc\u30b1\u30f3\u30b9\u306e\u4e3b\u8981\u64cd\u4f5c","text":"\u64cd\u4f5c \u8aac\u660e \u4f8b <code>.Take(n)</code> \u6700\u521d\u306e n \u8981\u7d20\u3092\u53d6\u5f97 <code>stream.Take(3)</code> <code>.Where(p)</code> \u6761\u4ef6\u3092\u6e80\u305f\u3059\u8981\u7d20\u306e\u307f <code>stream.Where(x =&gt; x &gt; 0)</code> <code>.Select(f)</code> \u5404\u8981\u7d20\u3092\u5909\u63db <code>stream.Select(x =&gt; x * 2)</code> <code>.Concat(s2)</code> 2\u3064\u306e\u30b7\u30fc\u30b1\u30f3\u30b9\u3092\u7d50\u5408 <code>s1.Concat(s2)</code> <code>Sliding(n, stream)</code> \u30b9\u30e9\u30a4\u30c7\u30a3\u30f3\u30b0\u30a6\u30a3\u30f3\u30c9\u30a6 <code>Sliding(3, stream)</code>"},{"location":"csharp/part-4/#96","title":"9.6 \u901a\u8ca8\u4ea4\u63db\u30ec\u30fc\u30c8\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/csharp/src/Ch09/StreamProcessing.cs</code></p> <p>\u70ba\u66ff\u30ec\u30fc\u30c8\u3092\u76e3\u8996\u3057\u3066\u3001\u4e0a\u6607\u30c8\u30ec\u30f3\u30c9\u3092\u691c\u51fa\u3059\u308b\u4f8b\u3067\u3059\u3002</p>"},{"location":"csharp/part-4/#_7","title":"\u30c8\u30ec\u30f3\u30c9\u5224\u5b9a\uff08\u7d14\u7c8b\u95a2\u6570\uff09","text":"<pre><code>public static bool Trending(Seq&lt;decimal&gt; rates) =&gt;\n    rates.Count &gt; 1 &amp;&amp;\n    Pairwise(rates).All(pair =&gt; pair.Item2 &gt; pair.Item1);\n\nTrending(Seq(0.81m, 0.82m, 0.83m));  // true (\u4e0a\u6607\u30c8\u30ec\u30f3\u30c9)\nTrending(Seq(0.81m, 0.84m, 0.83m));  // false\n</code></pre>"},{"location":"csharp/part-4/#_8","title":"\u30ec\u30fc\u30c8\u306e\u30b9\u30c8\u30ea\u30fc\u30e0","text":"<pre><code>public enum Currency { USD, EUR, GBP, JPY }\n\npublic static IEnumerable&lt;decimal&gt; Rates(Currency from, Currency to)\n{\n    while (true)\n    {\n        yield return GetExchangeRate(from, to);\n    }\n}\n</code></pre>"},{"location":"csharp/part-4/#97","title":"9.7 \u30b9\u30e9\u30a4\u30c7\u30a3\u30f3\u30b0\u30a6\u30a3\u30f3\u30c9\u30a6","text":"<p><code>Sliding</code> \u3067\u9023\u7d9a\u3059\u308b\u8981\u7d20\u3092\u30b0\u30eb\u30fc\u30d7\u5316\u3067\u304d\u307e\u3059\u3002</p> <pre><code>public static IEnumerable&lt;Seq&lt;T&gt;&gt; Sliding&lt;T&gt;(int windowSize, IEnumerable&lt;T&gt; stream)\n{\n    var window = new Queue&lt;T&gt;();\n    foreach (var item in stream)\n    {\n        window.Enqueue(item);\n        if (window.Count == windowSize)\n        {\n            yield return toSeq(window);\n            window.Dequeue();\n        }\n    }\n}\n\nvar stream = new[] { 1, 2, 3, 4, 5 };\nSliding(3, stream).ToList();\n// [Seq(1, 2, 3), Seq(2, 3, 4), Seq(3, 4, 5)]\n</code></pre> <p></p>"},{"location":"csharp/part-4/#_9","title":"\u30c8\u30ec\u30f3\u30c9\u3092\u691c\u51fa\u3057\u3066\u4ea4\u63db","text":"<pre><code>public static Option&lt;decimal&gt; ExchangeIfTrending(\n    decimal amount,\n    Currency from,\n    Currency to,\n    int windowSize)\n{\n    var rateWindow = Sliding(windowSize, Rates(from, to))\n        .Where(window =&gt; Trending(window))\n        .Take(1)\n        .FirstOrDefault();\n\n    if (rateWindow.IsEmpty)\n        return None;\n\n    var lastRate = rateWindow[rateWindow.Count - 1];\n    return Some(amount * lastRate);\n}\n</code></pre>"},{"location":"csharp/part-4/#98","title":"9.8 \u30b7\u30fc\u30b1\u30f3\u30b9\u306e\u7d50\u5408","text":"<p>2\u3064\u306e\u30b7\u30fc\u30b1\u30f3\u30b9\u3092 <code>Zip</code> \u3067\u7d50\u5408\u3067\u304d\u307e\u3059\u3002</p> <pre><code>public static IEnumerable&lt;(T1, T2)&gt; Zip&lt;T1, T2&gt;(\n    IEnumerable&lt;T1&gt; stream1,\n    IEnumerable&lt;T2&gt; stream2) =&gt;\n    stream1.Zip(stream2);\n\nvar s1 = new[] { 1, 2, 3 };\nvar s2 = new[] { \"a\", \"b\", \"c\" };\n\nZip(s1, s2).ToList();  // [(1, \"a\"), (2, \"b\"), (3, \"c\")]\n\n// \u5de6\u5074\u306e\u5024\u306e\u307f\u3092\u8fd4\u3059\npublic static IEnumerable&lt;T1&gt; ZipLeft&lt;T1, T2&gt;(\n    IEnumerable&lt;T1&gt; stream1,\n    IEnumerable&lt;T2&gt; stream2) =&gt;\n    Zip(stream1, stream2).Select(pair =&gt; pair.Item1);\n</code></pre> <p></p>"},{"location":"csharp/part-4/#99","title":"9.9 \u5b9f\u7528\u7684\u306a\u30b9\u30c8\u30ea\u30fc\u30e0\u64cd\u4f5c","text":"<pre><code>// \u7d2f\u7a4d\u548c\npublic static IEnumerable&lt;int&gt; RunningSum(IEnumerable&lt;int&gt; stream)\n{\n    var sum = 0;\n    foreach (var item in stream)\n    {\n        sum += item;\n        yield return sum;\n    }\n}\n\nRunningSum(new[] { 1, 2, 3, 4, 5 }).ToList();  // [1, 3, 6, 10, 15]\n\n// \u79fb\u52d5\u5e73\u5747\npublic static IEnumerable&lt;decimal&gt; MovingAverage(int windowSize, IEnumerable&lt;decimal&gt; stream) =&gt;\n    Sliding(windowSize, stream)\n        .Select(window =&gt; Enumerable.Sum(window) / windowSize);\n\n// \u9023\u7d9a\u3059\u308b\u91cd\u8907\u3092\u9664\u53bb\npublic static IEnumerable&lt;T&gt; DistinctConsecutive&lt;T&gt;(IEnumerable&lt;T&gt; stream)\n{\n    var first = true;\n    T? prev = default;\n    foreach (var item in stream)\n    {\n        if (first || !EqualityComparer&lt;T&gt;.Default.Equals(prev, item))\n        {\n            yield return item;\n            prev = item;\n            first = false;\n        }\n    }\n}\n</code></pre>"},{"location":"csharp/part-4/#910-iasyncenumerable","title":"9.10 \u975e\u540c\u671f\u30b9\u30c8\u30ea\u30fc\u30e0\uff08IAsyncEnumerable\uff09","text":"<p>C# 8.0 \u4ee5\u964d\u3067\u306f <code>IAsyncEnumerable&lt;T&gt;</code> \u3092\u4f7f\u3063\u3066\u975e\u540c\u671f\u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u6271\u3048\u307e\u3059\u3002</p> <pre><code>public static async IAsyncEnumerable&lt;T&gt; RepeatWithDelay&lt;T&gt;(int delayMs, T value)\n{\n    while (true)\n    {\n        await Task.Delay(delayMs);\n        yield return value;\n    }\n}\n\npublic static async IAsyncEnumerable&lt;T&gt; Take&lt;T&gt;(int n, IAsyncEnumerable&lt;T&gt; stream)\n{\n    var count = 0;\n    await foreach (var item in stream)\n    {\n        if (count &gt;= n) yield break;\n        yield return item;\n        count++;\n    }\n}\n\npublic static async Task&lt;Seq&lt;T&gt;&gt; ToSeqAsync&lt;T&gt;(IAsyncEnumerable&lt;T&gt; stream)\n{\n    var results = new List&lt;T&gt;();\n    await foreach (var item in stream)\n    {\n        results.Add(item);\n    }\n    return toSeq(results);\n}\n</code></pre>"},{"location":"csharp/part-4/#scala","title":"Scala \u3068\u306e\u6bd4\u8f03","text":""},{"location":"csharp/part-4/#io-task","title":"IO \u3068 Task \u306e\u6bd4\u8f03","text":"Scala (Cats Effect) C# \u8aac\u660e <code>IO[A]</code> <code>Task&lt;T&gt;</code> \u526f\u4f5c\u7528\u3092\u8a18\u8ff0\u3059\u308b\u578b <code>IO.delay(expr)</code> <code>Task.Run(() =&gt; expr)</code> \u526f\u4f5c\u7528\u3092\u30e9\u30c3\u30d7 <code>IO.pure(value)</code> <code>Task.FromResult(value)</code> \u7d14\u7c8b\u306a\u5024\u3092\u30e9\u30c3\u30d7 <code>for { a &lt;- io1; b &lt;- io2 } yield ...</code> <code>async { var a = await io1; var b = await io2; return ... }</code> \u5408\u6210 <code>io.unsafeRunSync()</code> <code>task.GetAwaiter().GetResult()</code> \u540c\u671f\u5b9f\u884c <code>io1.orElse(io2)</code> <code>task1.OrElse(task2)</code> \u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af <code>ios.sequence</code> <code>Sequence(tasks)</code> \u30ea\u30b9\u30c8\u306e\u5909\u63db"},{"location":"csharp/part-4/#stream-ienumerableseq","title":"Stream \u3068 IEnumerable/Seq \u306e\u6bd4\u8f03","text":"Scala (fs2) C# \u8aac\u660e <code>Stream[Pure, A]</code> <code>IEnumerable&lt;T&gt;</code> / <code>Seq&lt;T&gt;</code> \u7d14\u7c8b\u306a\u30b9\u30c8\u30ea\u30fc\u30e0 <code>Stream.eval(io)</code> <code>IAsyncEnumerable&lt;T&gt;</code> IO \u3092\u542b\u3080\u30b9\u30c8\u30ea\u30fc\u30e0 <code>stream.repeat</code> <code>Repeat(stream)</code> \u7121\u9650\u7e70\u308a\u8fd4\u3057 <code>stream.take(n)</code> <code>stream.Take(n)</code> \u6700\u521d\u306e n \u8981\u7d20 <code>stream.filter(p)</code> <code>stream.Where(p)</code> \u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0 <code>stream.sliding(n)</code> <code>Sliding(n, stream)</code> \u30b9\u30e9\u30a4\u30c7\u30a3\u30f3\u30b0\u30a6\u30a3\u30f3\u30c9\u30a6"},{"location":"csharp/part-4/#_10","title":"\u307e\u3068\u3081","text":""},{"location":"csharp/part-4/#part-iv_1","title":"Part IV \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"csharp/part-4/#task-ienumerable","title":"Task \u3068 IEnumerable \u306e\u6bd4\u8f03","text":"\u7279\u6027 Task IEnumerable \u8981\u7d20\u6570 1\u3064 0\u500b\u4ee5\u4e0a\uff08\u7121\u9650\u3082\u53ef\uff09 \u5b9f\u884c <code>await</code> / <code>GetResult()</code> <code>ToList()</code> \u7528\u9014 \u5358\u4e00\u306e\u526f\u4f5c\u7528 \u9023\u7d9a\u3057\u305f\u8981\u7d20\u306e\u51e6\u7406"},{"location":"csharp/part-4/#_11","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>Task: \u526f\u4f5c\u7528\u3092\u300c\u8a18\u8ff0\u300d\u3068\u3057\u3066\u6271\u3044\u3001\u5b9f\u884c\u3092\u9045\u5ef6\u3055\u305b\u308b</li> <li>Task.Run / Task.FromResult: \u526f\u4f5c\u7528\u306e\u3042\u308b\u5f0f\u3084\u7d14\u7c8b\u306a\u5024\u3092 Task \u306b\u30e9\u30c3\u30d7</li> <li>async/await: Task \u3092\u5408\u6210\uff08Scala \u306e flatMap \u76f8\u5f53\uff09</li> <li>OrElse: \u5931\u6557\u6642\u306e\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u3092\u6307\u5b9a</li> <li>Sequence: <code>Seq&lt;Task&lt;T&gt;&gt;</code> \u2192 <code>Task&lt;Seq&lt;T&gt;&gt;</code></li> <li>IEnumerable/Seq: \u6f5c\u5728\u7684\u306b\u7121\u9650\u306e\u30b7\u30fc\u30b1\u30f3\u30b9\u3092\u9045\u5ef6\u8a55\u4fa1\u3067\u51e6\u7406</li> <li>Sliding: \u9023\u7d9a\u3059\u308b\u8981\u7d20\u3092\u30b0\u30eb\u30fc\u30d7\u5316\u3057\u3066\u30d1\u30bf\u30fc\u30f3\u3092\u691c\u51fa</li> <li>IAsyncEnumerable: \u975e\u540c\u671f\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406</li> </ol>"},{"location":"csharp/part-4/#_12","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part V \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li>\u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406</li> <li>\u5171\u6709\u72b6\u614b\u306e\u7ba1\u7406</li> <li>\u4e26\u884c\u30b3\u30ec\u30af\u30b7\u30e7\u30f3</li> </ul>"},{"location":"csharp/part-4/#_13","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"csharp/part-4/#1-task","title":"\u554f\u984c 1: Task \u306e\u57fa\u672c","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>public static Task&lt;string&gt; PrintAndReturn(string message) =&gt; ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\n// await PrintAndReturn(\"Hello\") \u306f\n// \"Hello\" \u3092\u30b3\u30f3\u30bd\u30fc\u30eb\u306b\u51fa\u529b\u3057\u3001\"Hello\" \u3092\u8fd4\u3059\n</code></pre> \u89e3\u7b54 <pre><code>public static Task&lt;string&gt; PrintAndReturn(string message) =&gt;\n    Task.Run(() =&gt;\n    {\n        Console.WriteLine(message);\n        return message;\n    });\n</code></pre>"},{"location":"csharp/part-4/#2-task","title":"\u554f\u984c 2: Task \u306e\u5408\u6210","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u30022\u3064\u306e Task \u3092\u9806\u756a\u306b\u5b9f\u884c\u3057\u3001\u7d50\u679c\u3092\u7d50\u5408\u3057\u307e\u3059\u3002</p> <pre><code>public static async Task&lt;C&gt; CombineAsync&lt;A, B, C&gt;(\n    Task&lt;A&gt; task1,\n    Task&lt;B&gt; task2,\n    Func&lt;A, B, C&gt; f) =&gt; ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nvar result = await CombineAsync(\n    Task.FromResult(1),\n    Task.FromResult(2),\n    (a, b) =&gt; a + b);  // 3\n</code></pre> \u89e3\u7b54 <pre><code>public static async Task&lt;C&gt; CombineAsync&lt;A, B, C&gt;(\n    Task&lt;A&gt; task1,\n    Task&lt;B&gt; task2,\n    Func&lt;A, B, C&gt; f)\n{\n    var a = await task1;\n    var b = await task2;\n    return f(a, b);\n}\n</code></pre>"},{"location":"csharp/part-4/#3","title":"\u554f\u984c 3: \u30ea\u30c8\u30e9\u30a4","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u6307\u5b9a\u56de\u6570\u30ea\u30c8\u30e9\u30a4\u3057\u3001\u5168\u90e8\u5931\u6557\u3057\u305f\u3089\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>public static async Task&lt;T&gt; RetryWithDefault&lt;T&gt;(\n    int maxRetries,\n    T defaultValue,\n    Func&lt;Task&lt;T&gt;&gt; action) =&gt; ???\n</code></pre> \u89e3\u7b54 <pre><code>public static async Task&lt;T&gt; RetryWithDefault&lt;T&gt;(\n    int maxRetries,\n    T defaultValue,\n    Func&lt;Task&lt;T&gt;&gt; action)\n{\n    try\n    {\n        return await Retry(maxRetries, action);\n    }\n    catch\n    {\n        return defaultValue;\n    }\n}\n</code></pre>"},{"location":"csharp/part-4/#4","title":"\u554f\u984c 4: \u30b7\u30fc\u30b1\u30f3\u30b9\u64cd\u4f5c","text":"<p>\u4ee5\u4e0b\u306e\u30b7\u30fc\u30b1\u30f3\u30b9\u3092\u4f5c\u6210\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>// 1. 1\u304b\u308910\u307e\u3067\u306e\u5076\u6570\u306e\u30b7\u30fc\u30b1\u30f3\u30b9\nIEnumerable&lt;int&gt; evens = ???\n\n// 2. \u7121\u9650\u306b\u4ea4\u4e92\u306b true/false \u3092\u8fd4\u3059\u30b7\u30fc\u30b1\u30f3\u30b9\nIEnumerable&lt;bool&gt; alternating = ???\n\n// 3. \u6700\u521d\u306e5\u3064\u306e\u8981\u7d20\u306e\u5408\u8a08\u3092\u8a08\u7b97\nint sum = new[] { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 }.Take(5).???\n</code></pre> \u89e3\u7b54 <pre><code>// 1. 1\u304b\u308910\u307e\u3067\u306e\u5076\u6570\nIEnumerable&lt;int&gt; evens = Enumerable.Range(1, 10).Where(n =&gt; n % 2 == 0);\n// \u307e\u305f\u306f\nIEnumerable&lt;int&gt; evens = new[] { 2, 4, 6, 8, 10 };\n\n// 2. \u7121\u9650\u306b\u4ea4\u4e92\u306b true/false\nIEnumerable&lt;bool&gt; alternating = Alternating();\n\nstatic IEnumerable&lt;bool&gt; Alternating()\n{\n    while (true)\n    {\n        yield return true;\n        yield return false;\n    }\n}\n\n// 3. \u6700\u521d\u306e5\u3064\u306e\u8981\u7d20\u306e\u5408\u8a08\nint sum = new[] { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 }\n    .Take(5)\n    .Sum();  // 15\n</code></pre>"},{"location":"csharp/part-4/#5","title":"\u554f\u984c 5: \u30c8\u30ec\u30f3\u30c9\u691c\u51fa","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u76f4\u8fd13\u3064\u306e\u5024\u304c\u5168\u3066\u540c\u3058\u304b\u3069\u3046\u304b\u3092\u5224\u5b9a\u3057\u307e\u3059\u3002</p> <pre><code>public static bool IsStable(Seq&lt;int&gt; values) =&gt; ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nDebug.Assert(IsStable(Seq(5, 5, 5)) == true);\nDebug.Assert(IsStable(Seq(5, 5, 6)) == false);\nDebug.Assert(IsStable(Seq(5, 6, 5)) == false);\nDebug.Assert(IsStable(Seq(5)) == false);  // 3\u3064\u672a\u6e80\u306f false\n</code></pre> \u89e3\u7b54 <pre><code>public static bool IsStable(Seq&lt;int&gt; values) =&gt;\n    values.Count &gt;= 3 &amp;&amp;\n    Enumerable.Count(values.Distinct()) == 1;\n\n// \u307e\u305f\u306f\npublic static bool IsStable(Seq&lt;int&gt; values) =&gt;\n    values.Count &gt;= 3 &amp;&amp;\n    Pairwise(values).All(pair =&gt; pair.Item1 == pair.Item2);\n</code></pre>"},{"location":"csharp/part-5/","title":"Part V: \u4e26\u884c\u51e6\u7406","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u4e26\u884c\u51e6\u7406\u3092\u5b66\u3073\u307e\u3059\u3002Ref \u306b\u3088\u308b\u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u5171\u6709\u72b6\u614b\u7ba1\u7406\u3001Task.WhenAll \u306b\u3088\u308b\u4e26\u5217\u5b9f\u884c\u3001\u305d\u3057\u3066 Channel \u3092\u4f7f\u3063\u305f\u30a8\u30fc\u30b8\u30a7\u30f3\u30c8\u306b\u3088\u308b\u8efd\u91cf\u4e26\u884c\u51e6\u7406\u306e\u69cb\u7bc9\u65b9\u6cd5\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"csharp/part-5/#10","title":"\u7b2c10\u7ae0: \u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406","text":""},{"location":"csharp/part-5/#101","title":"10.1 \u4e26\u884c\u51e6\u7406\u306e\u8ab2\u984c","text":"<p>\u5f93\u6765\u306e\u4e26\u884c\u51e6\u7406\u306b\u306f\u591a\u304f\u306e\u8ab2\u984c\u304c\u3042\u308a\u307e\u3059:</p> <ul> <li>\u30c7\u30c3\u30c9\u30ed\u30c3\u30af</li> <li>\u7af6\u5408\u72b6\u614b\uff08Race Condition\uff09</li> <li>\u5171\u6709\u72b6\u614b\u306e\u7ba1\u7406\u306e\u8907\u96d1\u3055</li> <li>\u30b9\u30ec\u30c3\u30c9\u306e\u30aa\u30fc\u30d0\u30fc\u30d8\u30c3\u30c9</li> </ul> <p></p>"},{"location":"csharp/part-5/#102","title":"10.2 \u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u306e\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u96c6\u8a08","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/csharp/src/Ch10/ConcurrentProcessing.cs</code></p> <p>\u90fd\u5e02\u3078\u306e\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u3092\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u3067\u96c6\u8a08\u3057\u3001\u30e9\u30f3\u30ad\u30f3\u30b0\u3092\u66f4\u65b0\u3059\u308b\u4f8b\u3092\u898b\u3066\u3044\u304d\u307e\u3059\u3002</p> <pre><code>public record City(string Name);\npublic record CityStats(City City, int CheckIns);\n\n// \u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u306e\u30b7\u30fc\u30b1\u30f3\u30b9\npublic static IEnumerable&lt;City&gt; CheckIns()\n{\n    for (int i = 0; i &lt; 100000; i++)\n    {\n        yield return new City(\"Sydney\");\n        yield return new City(\"Dublin\");\n        yield return new City(\"Cape Town\");\n        yield return new City(\"Lima\");\n        yield return new City(\"Singapore\");\n    }\n}\n</code></pre>"},{"location":"csharp/part-5/#3","title":"\u30c8\u30c3\u30d73\u90fd\u5e02\u306e\u8a08\u7b97\uff08\u7d14\u7c8b\u95a2\u6570\uff09","text":"<pre><code>public static List&lt;CityStats&gt; TopCities(int n, Dictionary&lt;City, int&gt; cityCheckIns) =&gt;\n    cityCheckIns\n        .Select(kvp =&gt; new CityStats(kvp.Key, kvp.Value))\n        .OrderByDescending(stats =&gt; stats.CheckIns)\n        .Take(n)\n        .ToList();\n</code></pre>"},{"location":"csharp/part-5/#103-ref-","title":"10.3 Ref - \u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u5171\u6709\u72b6\u614b","text":"<p>Ref \u306f\u3001\u8907\u6570\u306e\u4e26\u884c\u51e6\u7406\u304b\u3089\u5b89\u5168\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u53c2\u7167\u3067\u3059\u3002C# \u3067\u306f <code>lock</code> \u3092\u4f7f\u3063\u3066\u5b9f\u88c5\u3057\u307e\u3059\u3002</p> <pre><code>public class Ref&lt;T&gt;\n{\n    private T _value;\n    private readonly object _lock = new();\n\n    private Ref(T initialValue) =&gt; _value = initialValue;\n\n    /// &lt;summary&gt;\u521d\u671f\u5024\u3067 Ref \u3092\u4f5c\u6210&lt;/summary&gt;\n    public static Ref&lt;T&gt; Of(T initialValue) =&gt; new(initialValue);\n\n    /// &lt;summary&gt;\u73fe\u5728\u306e\u5024\u3092\u53d6\u5f97&lt;/summary&gt;\n    public T Get()\n    {\n        lock (_lock) { return _value; }\n    }\n\n    /// &lt;summary&gt;\u5024\u3092\u8a2d\u5b9a&lt;/summary&gt;\n    public void Set(T newValue)\n    {\n        lock (_lock) { _value = newValue; }\n    }\n\n    /// &lt;summary&gt;\u30a2\u30c8\u30df\u30c3\u30af\u306b\u66f4\u65b0&lt;/summary&gt;\n    public void Update(Func&lt;T, T&gt; f)\n    {\n        lock (_lock) { _value = f(_value); }\n    }\n}\n</code></pre> <p></p>"},{"location":"csharp/part-5/#ref","title":"Ref \u306e\u4e3b\u8981\u30e1\u30bd\u30c3\u30c9","text":"\u30e1\u30bd\u30c3\u30c9 \u8aac\u660e \u4f8b <code>Ref&lt;T&gt;.Of(initial)</code> \u521d\u671f\u5024\u3067 Ref \u3092\u4f5c\u6210 <code>Ref&lt;int&gt;.Of(0)</code> <code>ref.Get()</code> \u73fe\u5728\u306e\u5024\u3092\u53d6\u5f97 <code>counter.Get()</code> <code>ref.Set(value)</code> \u5024\u3092\u8a2d\u5b9a <code>counter.Set(10)</code> <code>ref.Update(f)</code> \u30a2\u30c8\u30df\u30c3\u30af\u306b\u66f4\u65b0 <code>counter.Update(n =&gt; n + 1)</code> <code>ref.GetAndUpdate(f)</code> \u66f4\u65b0\u3057\u3066\u53e4\u3044\u5024\u3092\u8fd4\u3059 <code>counter.GetAndUpdate(n =&gt; n + 1)</code> <code>ref.UpdateAndGet(f)</code> \u66f4\u65b0\u3057\u3066\u65b0\u3057\u3044\u5024\u3092\u8fd4\u3059 <code>counter.UpdateAndGet(n =&gt; n + 1)</code> <code>ref.Modify(f)</code> \u66f4\u65b0\u3057\u3066\u7d50\u679c\u3092\u8fd4\u3059 <code>counter.Modify(n =&gt; (n + 1, n * 2))</code>"},{"location":"csharp/part-5/#_1","title":"\u4f7f\u7528\u4f8b","text":"<pre><code>var counter = Ref&lt;int&gt;.Of(0);\ncounter.Update(n =&gt; n + 3);  // \u30a2\u30c8\u30df\u30c3\u30af\u306b\u66f4\u65b0\ncounter.Get();                // 3\n</code></pre>"},{"location":"csharp/part-5/#104-parsequence-","title":"10.4 ParSequence - \u4e26\u5217\u5b9f\u884c","text":"<p>C# \u3067\u306f <code>Task.WhenAll</code> \u3092\u4f7f\u3063\u3066\u8907\u6570\u306e Task \u3092\u4e26\u5217\u5b9f\u884c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>/// &lt;summary&gt;Task \u306e\u30ea\u30b9\u30c8\u3092\u4e26\u5217\u5b9f\u884c&lt;/summary&gt;\npublic static async Task&lt;Seq&lt;T&gt;&gt; ParSequence&lt;T&gt;(Seq&lt;Task&lt;T&gt;&gt; tasks)\n{\n    var results = await Task.WhenAll(tasks);\n    return toSeq(results);\n}\n\n// \u4f7f\u7528\u4f8b\nvar tasks = Seq(\n    Task.FromResult(1),\n    Task.FromResult(2),\n    Task.FromResult(3)\n);\nvar result = await ParSequence(tasks);  // Seq(1, 2, 3)\n</code></pre> <p></p>"},{"location":"csharp/part-5/#task","title":"\u8907\u6570\u306e Task \u3092\u4e26\u5217\u5b9f\u884c","text":"<pre><code>/// &lt;summary&gt;2\u3064\u306e Task \u3092\u4e26\u5217\u5b9f\u884c&lt;/summary&gt;\npublic static async Task&lt;(T1, T2)&gt; ParTuple2&lt;T1, T2&gt;(Task&lt;T1&gt; task1, Task&lt;T2&gt; task2)\n{\n    await Task.WhenAll(task1, task2);\n    return (task1.Result, task2.Result);\n}\n\n/// &lt;summary&gt;3\u3064\u306e Task \u3092\u4e26\u5217\u5b9f\u884c&lt;/summary&gt;\npublic static async Task&lt;(T1, T2, T3)&gt; ParTuple3&lt;T1, T2, T3&gt;(\n    Task&lt;T1&gt; task1, Task&lt;T2&gt; task2, Task&lt;T3&gt; task3)\n{\n    await Task.WhenAll(task1, task2, task3);\n    return (task1.Result, task2.Result, task3.Result);\n}\n</code></pre>"},{"location":"csharp/part-5/#105","title":"10.5 \u30b5\u30a4\u30b3\u30ed\u3092\u4e26\u884c\u3057\u3066\u632f\u308b","text":"<pre><code>private static readonly Random _random = new();\n\npublic static Task&lt;int&gt; CastTheDie() =&gt;\n    Task.Run(() =&gt; _random.Next(1, 7));\n\n/// &lt;summary&gt;N \u500b\u306e\u30b5\u30a4\u30b3\u30ed\u3092\u4e26\u884c\u3057\u3066\u632f\u308b&lt;/summary&gt;\npublic static async Task&lt;Seq&lt;int&gt;&gt; CastDiceConcurrently(int n)\n{\n    var tasks = Enumerable.Range(0, n).Select(_ =&gt; CastTheDie());\n    var results = await Task.WhenAll(tasks);\n    return toSeq(results);\n}\n\n/// &lt;summary&gt;N \u500b\u306e\u30b5\u30a4\u30b3\u30ed\u3092\u4e26\u884c\u3057\u3066\u632f\u308a\u3001\u5408\u8a08\u3092\u8fd4\u3059&lt;/summary&gt;\npublic static async Task&lt;int&gt; CastDiceAndSum(int n)\n{\n    var results = await CastDiceConcurrently(n);\n    return Enumerable.Sum(results);\n}\n</code></pre>"},{"location":"csharp/part-5/#106-fiber-","title":"10.6 Fiber - \u30ad\u30e3\u30f3\u30bb\u30eb\u53ef\u80fd\u306a\u975e\u540c\u671f\u30bf\u30b9\u30af","text":"<p>Fiber \u306f\u3001\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u5b9f\u884c\u3055\u308c\u308b\u30ad\u30e3\u30f3\u30bb\u30eb\u53ef\u80fd\u306a\u975e\u540c\u671f\u30bf\u30b9\u30af\u3067\u3059\u3002</p> <pre><code>public class Fiber&lt;T&gt;\n{\n    /// &lt;summary&gt;\u30bf\u30b9\u30af\u306e\u7d50\u679c\u3092\u5f85\u6a5f&lt;/summary&gt;\n    public Task&lt;T&gt; Join { get; }\n\n    /// &lt;summary&gt;\u30bf\u30b9\u30af\u3092\u30ad\u30e3\u30f3\u30bb\u30eb&lt;/summary&gt;\n    public Action Cancel { get; }\n\n    public Fiber(Task&lt;T&gt; join, Action cancel)\n    {\n        Join = join;\n        Cancel = cancel;\n    }\n}\n\n/// &lt;summary&gt;\u30ad\u30e3\u30f3\u30bb\u30eb\u53ef\u80fd\u306a\u975e\u540c\u671f\u30bf\u30b9\u30af\u3092\u8d77\u52d5&lt;/summary&gt;\npublic static Fiber&lt;T&gt; Start&lt;T&gt;(Func&lt;CancellationToken, Task&lt;T&gt;&gt; computation)\n{\n    var cts = new CancellationTokenSource();\n    var task = Task.Run(() =&gt; computation(cts.Token), cts.Token);\n    return new Fiber&lt;T&gt;(task, () =&gt; cts.Cancel());\n}\n</code></pre> <p></p>"},{"location":"csharp/part-5/#repeatn-n","title":"RepeatN - N \u56de\u7e70\u308a\u8fd4\u3059","text":"<pre><code>/// &lt;summary&gt;\u30a2\u30af\u30b7\u30e7\u30f3\u3092 N \u56de\u7e70\u308a\u8fd4\u3059&lt;/summary&gt;\npublic static async Task&lt;Seq&lt;T&gt;&gt; RepeatN&lt;T&gt;(int n, Func&lt;Task&lt;T&gt;&gt; action)\n{\n    var results = new List&lt;T&gt;();\n    for (var i = 0; i &lt; n; i++)\n    {\n        results.Add(await action());\n    }\n    return toSeq(results);\n}\n</code></pre>"},{"location":"csharp/part-5/#107","title":"10.7 \u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u51e6\u7406\u306e\u4e26\u884c\u7248","text":"<p>\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u306e\u4fdd\u5b58\u3068\u30e9\u30f3\u30ad\u30f3\u30b0\u306e\u66f4\u65b0\u3092\u4e26\u884c\u3057\u3066\u5b9f\u884c\u3057\u307e\u3059\u3002</p>"},{"location":"csharp/part-5/#_2","title":"\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u306e\u4fdd\u5b58","text":"<pre><code>public static void StoreCheckIn(Ref&lt;Dictionary&lt;City, int&gt;&gt; storedCheckIns, City city)\n{\n    storedCheckIns.Update(dict =&gt;\n    {\n        var newDict = new Dictionary&lt;City, int&gt;(dict);\n        if (newDict.TryGetValue(city, out var count))\n            newDict[city] = count + 1;\n        else\n            newDict[city] = 1;\n        return newDict;\n    });\n}\n</code></pre>"},{"location":"csharp/part-5/#_3","title":"\u30e9\u30f3\u30ad\u30f3\u30b0\u306e\u7d99\u7d9a\u7684\u306a\u66f4\u65b0","text":"<pre><code>public static void UpdateRanking(\n    Ref&lt;Dictionary&lt;City, int&gt;&gt; storedCheckIns,\n    Ref&lt;List&lt;CityStats&gt;&gt; storedRanking)\n{\n    var checkIns = storedCheckIns.Get();\n    var ranking = TopCities(3, checkIns);\n    storedRanking.Set(ranking);\n}\n</code></pre>"},{"location":"csharp/part-5/#108","title":"10.8 \u547c\u3073\u51fa\u3057\u5143\u306b\u5236\u5fa1\u3092\u8fd4\u3059","text":"<p>\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u51e6\u7406\u3092\u7d9a\u3051\u3064\u3064\u3001\u547c\u3073\u51fa\u3057\u5143\u306b\u5236\u5fa1\u3092\u8fd4\u3059\u8a2d\u8a08\u304c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>public class ProcessingCheckIns\n{\n    private readonly Ref&lt;List&lt;CityStats&gt;&gt; _storedRanking;\n    private readonly CancellationTokenSource _cts;\n\n    public ProcessingCheckIns(Ref&lt;List&lt;CityStats&gt;&gt; storedRanking, CancellationTokenSource cts)\n    {\n        _storedRanking = storedRanking;\n        _cts = cts;\n    }\n\n    /// &lt;summary&gt;\u73fe\u5728\u306e\u30e9\u30f3\u30ad\u30f3\u30b0\u3092\u53d6\u5f97&lt;/summary&gt;\n    public List&lt;CityStats&gt; CurrentRanking() =&gt; _storedRanking.Get();\n\n    /// &lt;summary&gt;\u51e6\u7406\u3092\u505c\u6b62&lt;/summary&gt;\n    public void Stop() =&gt; _cts.Cancel();\n}\n\npublic static ProcessingCheckIns StartCheckInProcessing(IEnumerable&lt;City&gt; checkIns)\n{\n    var storedCheckIns = Ref&lt;Dictionary&lt;City, int&gt;&gt;.Of(new Dictionary&lt;City, int&gt;());\n    var storedRanking = Ref&lt;List&lt;CityStats&gt;&gt;.Of(new List&lt;CityStats&gt;());\n    var cts = new CancellationTokenSource();\n\n    // \u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u51e6\u7406\u3092\u958b\u59cb\n    Task.Run(() =&gt;\n    {\n        foreach (var city in checkIns)\n        {\n            if (cts.Token.IsCancellationRequested) break;\n            StoreCheckIn(storedCheckIns, city);\n        }\n    }, cts.Token);\n\n    // \u30e9\u30f3\u30ad\u30f3\u30b0\u66f4\u65b0\u3092\u958b\u59cb\n    Task.Run(async () =&gt;\n    {\n        while (!cts.Token.IsCancellationRequested)\n        {\n            UpdateRanking(storedCheckIns, storedRanking);\n            await Task.Delay(10, cts.Token);\n        }\n    }, cts.Token);\n\n    return new ProcessingCheckIns(storedRanking, cts);\n}\n</code></pre>"},{"location":"csharp/part-5/#_4","title":"\u4f7f\u7528\u4f8b","text":"<pre><code>var cities = new[]\n{\n    new City(\"Tokyo\"),\n    new City(\"Sydney\"),\n    new City(\"Tokyo\"),\n    new City(\"London\"),\n    new City(\"Tokyo\")\n};\n\nvar processing = StartCheckInProcessing(cities);\n\n// \u5c11\u3057\u5f85\u3063\u3066\u304b\u3089\u30e9\u30f3\u30ad\u30f3\u30b0\u3092\u53d6\u5f97\nawait Task.Delay(100);\nvar ranking = processing.CurrentRanking();\n\n// \u51e6\u7406\u3092\u505c\u6b62\nprocessing.Stop();\n</code></pre>"},{"location":"csharp/part-5/#109-channel-agent","title":"10.9 Channel \u3092\u4f7f\u3063\u305f Agent \u306b\u3088\u308b\u4e26\u884c\u51e6\u7406","text":"<p>C# \u3067\u306f\u3001Channel \u3092\u4f7f\u3063\u305f\u30e1\u30c3\u30bb\u30fc\u30b8\u30d1\u30c3\u30b7\u30f3\u30b0\u65b9\u5f0f\u306e\u4e26\u884c\u51e6\u7406\u304c\u53ef\u80fd\u3067\u3059\u3002</p> <p></p>"},{"location":"csharp/part-5/#_5","title":"\u30ab\u30a6\u30f3\u30bf\u30fc\u30a8\u30fc\u30b8\u30a7\u30f3\u30c8","text":"<pre><code>public record Increment;\npublic record Decrement;\npublic record GetValue(TaskCompletionSource&lt;int&gt; Reply);\npublic record Reset;\n\npublic class Agent&lt;TState, TMessage&gt; : IDisposable\n{\n    private readonly Channel&lt;TMessage&gt; _channel;\n    private readonly CancellationTokenSource _cts;\n    private TState _state;\n\n    public Agent(TState initialState, Func&lt;TState, TMessage, TState&gt; handler)\n    {\n        _channel = Channel.CreateUnbounded&lt;TMessage&gt;();\n        _cts = new CancellationTokenSource();\n        _state = initialState;\n\n        Task.Run(async () =&gt;\n        {\n            await foreach (var message in _channel.Reader.ReadAllAsync(_cts.Token))\n            {\n                _state = handler(_state, message);\n            }\n        });\n    }\n\n    public void Send(TMessage message) =&gt;\n        _channel.Writer.TryWrite(message);\n\n    public void Dispose()\n    {\n        _cts.Cancel();\n        _channel.Writer.Complete();\n    }\n}\n</code></pre>"},{"location":"csharp/part-5/#_6","title":"\u30ab\u30a6\u30f3\u30bf\u30fc\u306e\u4f7f\u7528","text":"<pre><code>using var counter = AgentBasedConcurrency.CreateCounter(0);\n\n// \u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\uff08Fire-and-forget\uff09\nAgentBasedConcurrency.IncrementCounter(counter);\nAgentBasedConcurrency.IncrementCounter(counter);\n\n// \u5024\u3092\u53d6\u5f97\uff08\u540c\u671f\uff09\nvar value = AgentBasedConcurrency.GetCounterValue(counter);  // 2\n\n// \u30c7\u30af\u30ea\u30e1\u30f3\u30c8\nAgentBasedConcurrency.DecrementCounter(counter);\nvar newValue = AgentBasedConcurrency.GetCounterValue(counter);  // 1\n</code></pre>"},{"location":"csharp/part-5/#_7","title":"\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u30a8\u30fc\u30b8\u30a7\u30f3\u30c8","text":"<pre><code>public record AddCheckInMsg(City City);\npublic record GetStatsMsg(TaskCompletionSource&lt;List&lt;CityStats&gt;&gt; Reply);\npublic record GetTotalMsg(TaskCompletionSource&lt;int&gt; Reply);\n\npublic static Agent&lt;Dictionary&lt;City, int&gt;, object&gt; CreateCheckInAgent() =&gt;\n    new(new Dictionary&lt;City, int&gt;(), (state, message) =&gt; message switch\n    {\n        AddCheckInMsg msg =&gt; UpdateCheckIns(state, msg.City),\n        GetStatsMsg msg =&gt;\n        {\n            msg.Reply.SetResult(TopCities(3, state));\n            return state;\n        },\n        GetTotalMsg msg =&gt;\n        {\n            msg.Reply.SetResult(state.Values.Sum());\n            return state;\n        },\n        _ =&gt; state\n    });\n</code></pre>"},{"location":"csharp/part-5/#1010","title":"10.10 \u4e26\u5217\u51e6\u7406\u30e6\u30fc\u30c6\u30a3\u30ea\u30c6\u30a3","text":"<pre><code>/// &lt;summary&gt;\u30ea\u30b9\u30c8\u306e\u5404\u8981\u7d20\u306b\u95a2\u6570\u3092\u4e26\u5217\u9069\u7528&lt;/summary&gt;\npublic static Seq&lt;TResult&gt; ParMap&lt;T, TResult&gt;(Func&lt;T, TResult&gt; f, Seq&lt;T&gt; list)\n{\n    var tasks = list.Map(x =&gt; Task.Run(() =&gt; f(x)));\n    return toSeq(Task.WhenAll(tasks).Result);\n}\n\n/// &lt;summary&gt;\u6761\u4ef6\u3092\u6e80\u305f\u3059\u8981\u7d20\u3092\u4e26\u5217\u3067\u30d5\u30a3\u30eb\u30bf&lt;/summary&gt;\npublic static Seq&lt;T&gt; ParFilter&lt;T&gt;(Func&lt;T, bool&gt; predicate, Seq&lt;T&gt; list)\n{\n    var tasks = list.Map(x =&gt; Task.Run(() =&gt; (x, predicate(x))));\n    var results = Task.WhenAll(tasks).Result;\n    return toSeq(results.Where(r =&gt; r.Item2).Select(r =&gt; r.x));\n}\n\n/// &lt;summary&gt;\u4e26\u5217\u3067\u96c6\u7d04&lt;/summary&gt;\npublic static Option&lt;T&gt; ParReduce&lt;T&gt;(Func&lt;T, T, T&gt; combine, Seq&lt;T&gt; list)\n{\n    if (list.IsEmpty) return None;\n    if (list.Count == 1) return Some(list[0]);\n\n    Seq&lt;T&gt; ReduceLevel(Seq&lt;T&gt; items)\n    {\n        if (items.Count &lt;= 1) return items;\n\n        var chunks = toSeq(items.Chunk(2));\n        var tasks = chunks.Map(chunk =&gt;\n        {\n            var arr = chunk.ToArray();\n            return Task.Run(() =&gt; arr.Length == 2 ? combine(arr[0], arr[1]) : arr[0]);\n        });\n\n        return toSeq(Task.WhenAll(tasks).Result);\n    }\n\n    var current = list;\n    while (current.Count &gt; 1)\n    {\n        current = ReduceLevel(current);\n    }\n\n    return Some(current[0]);\n}\n</code></pre>"},{"location":"csharp/part-5/#1011","title":"10.11 \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u4ed8\u304d\u5b9f\u884c","text":"<pre><code>/// &lt;summary&gt;\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u4ed8\u304d\u3067 Task \u3092\u5b9f\u884c&lt;/summary&gt;\npublic static async Task&lt;Option&lt;T&gt;&gt; WithTimeout&lt;T&gt;(int timeoutMs, Task&lt;T&gt; task)\n{\n    var timeoutTask = Task.Delay(timeoutMs);\n    var completedTask = await Task.WhenAny(task, timeoutTask);\n    if (completedTask == task)\n    {\n        return Some(await task);\n    }\n    return None;\n}\n</code></pre>"},{"location":"csharp/part-5/#1012","title":"10.12 \u5076\u6570\u30ab\u30a6\u30f3\u30c8\uff08\u4e26\u884c\u7248\uff09","text":"<pre><code>/// &lt;summary&gt;\u4e26\u884c\u3057\u3066\u5b9f\u884c\u3057\u3001\u5076\u6570\u306e\u6570\u3092\u30ab\u30a6\u30f3\u30c8&lt;/summary&gt;\npublic static async Task&lt;int&gt; CountEvens(Seq&lt;Task&lt;int&gt;&gt; asyncInts)\n{\n    var counter = Ref&lt;int&gt;.Of(0);\n    var tasks = asyncInts.Map(async asyncInt =&gt;\n    {\n        var n = await asyncInt;\n        if (n % 2 == 0)\n        {\n            counter.Update(c =&gt; c + 1);\n        }\n    });\n    await Task.WhenAll(tasks);\n    return counter.Get();\n}\n</code></pre>"},{"location":"csharp/part-5/#scala","title":"Scala \u3068\u306e\u6bd4\u8f03","text":""},{"location":"csharp/part-5/#ref_1","title":"Ref \u306e\u6bd4\u8f03","text":"Scala (Cats Effect) C# \u8aac\u660e <code>Ref.of[IO, A](initial)</code> <code>Ref&lt;T&gt;.Of(initial)</code> \u521d\u671f\u5024\u3067 Ref \u3092\u4f5c\u6210 <code>ref.get</code> <code>ref.Get()</code> \u73fe\u5728\u306e\u5024\u3092\u53d6\u5f97 <code>ref.set(value)</code> <code>ref.Set(value)</code> \u5024\u3092\u8a2d\u5b9a <code>ref.update(f)</code> <code>ref.Update(f)</code> \u30a2\u30c8\u30df\u30c3\u30af\u306b\u66f4\u65b0 <code>ref.modify(f)</code> <code>ref.Modify(f)</code> \u66f4\u65b0\u3057\u3066\u7d50\u679c\u3092\u8fd4\u3059"},{"location":"csharp/part-5/#_8","title":"\u4e26\u5217\u5b9f\u884c\u306e\u6bd4\u8f03","text":"Scala (Cats Effect) C# \u8aac\u660e <code>ios.parSequence</code> <code>ParSequence(tasks)</code> \u4e26\u5217\u5b9f\u884c <code>ios.sequence</code> \u9806\u6b21 await \u9806\u6b21\u5b9f\u884c <code>(io1, io2).parTupled</code> <code>ParTuple2(task1, task2)</code> 2\u3064\u3092\u4e26\u5217\u5b9f\u884c"},{"location":"csharp/part-5/#fiber","title":"Fiber \u306e\u6bd4\u8f03","text":"Scala (Cats Effect) C# \u8aac\u660e <code>io.start</code> <code>Start(computation)</code> Fiber \u3092\u8d77\u52d5 <code>fiber.join</code> <code>fiber.Join</code> \u7d50\u679c\u3092\u5f85\u6a5f <code>fiber.cancel</code> <code>fiber.Cancel()</code> \u30ad\u30e3\u30f3\u30bb\u30eb <code>io.foreverM</code> while \u30eb\u30fc\u30d7 \u6c38\u9060\u306b\u7e70\u308a\u8fd4\u3059"},{"location":"csharp/part-5/#agentactor","title":"Agent\uff08Actor\uff09\u306e\u6bd4\u8f03","text":"Scala (Akka) C# \u8aac\u660e <code>Actor</code> <code>Agent&lt;TState, TMessage&gt;</code> \u30e1\u30c3\u30bb\u30fc\u30b8\u30d9\u30fc\u30b9\u306e\u4e26\u884c\u51e6\u7406 <code>actorRef ! message</code> <code>agent.Send(message)</code> \u30e1\u30c3\u30bb\u30fc\u30b8\u9001\u4fe1\uff08\u975e\u540c\u671f\uff09 <code>actorRef ? message</code> TaskCompletionSource \u3092\u4f7f\u7528 \u30e1\u30c3\u30bb\u30fc\u30b8\u9001\u4fe1\uff08\u540c\u671f\uff09"},{"location":"csharp/part-5/#_9","title":"\u307e\u3068\u3081","text":""},{"location":"csharp/part-5/#part-v_1","title":"Part V \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"csharp/part-5/#_10","title":"\u4e3b\u8981\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8","text":"\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8 \u7528\u9014 <code>Ref&lt;T&gt;</code> \u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u5171\u6709\u72b6\u614b <code>ParSequence</code> Task \u306e\u30ea\u30b9\u30c8\u3092\u4e26\u5217\u5b9f\u884c <code>Fiber&lt;T&gt;</code> \u30ad\u30e3\u30f3\u30bb\u30eb\u53ef\u80fd\u306a\u975e\u540c\u671f\u30bf\u30b9\u30af <code>Start</code> Fiber \u3092\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u8d77\u52d5 <code>RepeatN</code> N \u56de\u7e70\u308a\u8fd4\u3057\u5b9f\u884c <code>Agent&lt;TState, TMessage&gt;</code> \u30e1\u30c3\u30bb\u30fc\u30b8\u30d9\u30fc\u30b9\u306e\u4e26\u884c\u51e6\u7406"},{"location":"csharp/part-5/#_11","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>Ref: \u8907\u6570\u306e\u4e26\u884c\u51e6\u7406\u304b\u3089\u5b89\u5168\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u53c2\u7167</li> <li>ParSequence: Task \u306e\u30ea\u30b9\u30c8\u3092\u4e26\u5217\u5b9f\u884c\u3057\u3066\u7d50\u679c\u3092\u96c6\u7d04</li> <li>Fiber: \u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u5b9f\u884c\u3055\u308c\u308b\u30ad\u30e3\u30f3\u30bb\u30eb\u53ef\u80fd\u306a\u30bf\u30b9\u30af</li> <li>Agent: Channel \u3092\u4f7f\u3063\u305f\u30e1\u30c3\u30bb\u30fc\u30b8\u30d1\u30c3\u30b7\u30f3\u30b0\u65b9\u5f0f\u306e\u4e26\u884c\u51e6\u7406</li> <li>Task.WhenAll: \u7d44\u307f\u8fbc\u307f\u306e\u4e26\u5217\u5b9f\u884c\u6a5f\u80fd</li> </ol>"},{"location":"csharp/part-5/#_12","title":"\u8a2d\u8a08\u30d1\u30bf\u30fc\u30f3","text":""},{"location":"csharp/part-5/#_13","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"csharp/part-5/#1-ref","title":"\u554f\u984c 1: Ref \u306e\u57fa\u672c","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u30ab\u30a6\u30f3\u30bf\u30fc\u3092 0 \u304b\u3089\u59cb\u3081\u3066\u30013\u56de\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\u3057\u305f\u7d50\u679c\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>public static int IncrementThreeTimes() =&gt; ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nIncrementThreeTimes()  // 3\n</code></pre> \u89e3\u7b54 <pre><code>public static int IncrementThreeTimes()\n{\n    var counter = Ref&lt;int&gt;.Of(0);\n    counter.Update(n =&gt; n + 1);\n    counter.Update(n =&gt; n + 1);\n    counter.Update(n =&gt; n + 1);\n    return counter.Get();\n}\n</code></pre>"},{"location":"csharp/part-5/#2","title":"\u554f\u984c 2: \u4e26\u5217\u5b9f\u884c","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u30023\u3064\u306e Task \u3092\u4e26\u5217\u5b9f\u884c\u3057\u3001\u7d50\u679c\u306e\u5408\u8a08\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>public static async Task&lt;int&gt; SumParallel(\n    Task&lt;int&gt; task1, Task&lt;int&gt; task2, Task&lt;int&gt; task3) =&gt; ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nawait SumParallel(\n    Task.FromResult(1),\n    Task.FromResult(2),\n    Task.FromResult(3))  // 6\n</code></pre> \u89e3\u7b54 <pre><code>public static async Task&lt;int&gt; SumParallel(\n    Task&lt;int&gt; task1, Task&lt;int&gt; task2, Task&lt;int&gt; task3)\n{\n    var results = await Task.WhenAll(task1, task2, task3);\n    return results.Sum();\n}\n</code></pre>"},{"location":"csharp/part-5/#3_1","title":"\u554f\u984c 3: \u4e26\u884c\u30ab\u30a6\u30f3\u30c8","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002Task \u306e\u30ea\u30b9\u30c8\u3092\u4e26\u884c\u5b9f\u884c\u3057\u3001\u305d\u306e\u3046\u3061\u5076\u6570\u3092\u8fd4\u3057\u305f\u56de\u6570\u3092\u30ab\u30a6\u30f3\u30c8\u3057\u307e\u3059\u3002</p> <pre><code>public static async Task&lt;int&gt; CountEvensInList(Seq&lt;Task&lt;int&gt;&gt; asyncInts) =&gt; ???\n\n// \u4f7f\u7528\u4f8b\nvar asyncInts = Seq(\n    Task.FromResult(2),\n    Task.FromResult(3),\n    Task.FromResult(4),\n    Task.FromResult(5),\n    Task.FromResult(6)\n);\nawait CountEvensInList(asyncInts)  // 3\n</code></pre> \u89e3\u7b54 <pre><code>public static async Task&lt;int&gt; CountEvensInList(Seq&lt;Task&lt;int&gt;&gt; asyncInts)\n{\n    var counter = Ref&lt;int&gt;.Of(0);\n    var tasks = asyncInts.Map(async asyncInt =&gt;\n    {\n        var n = await asyncInt;\n        if (n % 2 == 0)\n        {\n            counter.Update(c =&gt; c + 1);\n        }\n    });\n    await Task.WhenAll(tasks);\n    return counter.Get();\n}\n</code></pre>"},{"location":"csharp/part-5/#4-agent","title":"\u554f\u984c 4: Agent","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u53d7\u3051\u53d6\u3063\u3066\u30ea\u30b9\u30c8\u306b\u8ffd\u52a0\u3057\u3001\u30ea\u30b9\u30c8\u3092\u53d6\u5f97\u3067\u304d\u308b Agent \u3092\u4f5c\u6210\u3057\u307e\u3059\u3002</p> <pre><code>public record AddItem&lt;T&gt;(T Item);\npublic record GetAll&lt;T&gt;(TaskCompletionSource&lt;List&lt;T&gt;&gt; Reply);\n\npublic static Agent&lt;List&lt;T&gt;, object&gt; CreateListAgent&lt;T&gt;() =&gt; ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nusing var agent = CreateListAgent&lt;int&gt;();\nagent.Send(new AddItem&lt;int&gt;(1));\nagent.Send(new AddItem&lt;int&gt;(2));\nagent.Send(new AddItem&lt;int&gt;(3));\n// GetAll \u3067 [1, 2, 3] \u3092\u53d6\u5f97\n</code></pre> \u89e3\u7b54 <pre><code>public record AddItem&lt;T&gt;(T Item);\npublic record GetAll&lt;T&gt;(TaskCompletionSource&lt;List&lt;T&gt;&gt; Reply);\n\npublic static Agent&lt;List&lt;T&gt;, object&gt; CreateListAgent&lt;T&gt;() =&gt;\n    new(new List&lt;T&gt;(), (state, message) =&gt; message switch\n    {\n        AddItem&lt;T&gt; msg =&gt;\n        {\n            state.Add(msg.Item);\n            return state;\n        },\n        GetAll&lt;T&gt; msg =&gt;\n        {\n            msg.Reply.SetResult(new List&lt;T&gt;(state));\n            return state;\n        },\n        _ =&gt; state\n    });\n</code></pre>"},{"location":"csharp/part-5/#5","title":"\u554f\u984c 5: \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u4ed8\u304d\u53ce\u96c6","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u6307\u5b9a\u6642\u9593\u5f8c\u306b\u51e6\u7406\u3092\u505c\u6b62\u3057\u3001\u305d\u308c\u307e\u3067\u306b\u84c4\u7a4d\u3055\u308c\u305f\u7d50\u679c\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>public static List&lt;int&gt; CollectFor(int durationMs, Func&lt;int&gt; producer) =&gt; ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\n// 100ms\u3054\u3068\u306b\u4e71\u6570\u3092\u751f\u6210\u3057\u3066\u30011\u79d2\u9593\u53ce\u96c6\n// \u7d0410\u500b\u306e\u8981\u7d20\u304c\u8fd4\u3055\u308c\u308b\nCollectFor(1000, () =&gt; random.Next(100))\n</code></pre> \u89e3\u7b54 <pre><code>public static List&lt;int&gt; CollectFor(int durationMs, Func&lt;int&gt; producer)\n{\n    var collected = Ref&lt;List&lt;int&gt;&gt;.Of(new List&lt;int&gt;());\n    var cts = new CancellationTokenSource();\n\n    // 100ms\u3054\u3068\u306b\u5024\u3092\u8ffd\u52a0\u3059\u308b\u30bf\u30b9\u30af\n    Task.Run(async () =&gt;\n    {\n        while (!cts.Token.IsCancellationRequested)\n        {\n            await Task.Delay(100, cts.Token);\n            var value = producer();\n            collected.Update(list =&gt;\n            {\n                var newList = new List&lt;int&gt;(list) { value };\n                return newList;\n            });\n        }\n    }, cts.Token);\n\n    // \u6307\u5b9a\u6642\u9593\u5f85\u6a5f\n    Thread.Sleep(durationMs);\n\n    // \u30ad\u30e3\u30f3\u30bb\u30eb\n    cts.Cancel();\n\n    // \u7d50\u679c\u3092\u53d6\u5f97\n    return collected.Get();\n}\n</code></pre>"},{"location":"csharp/part-6/","title":"Part VI: \u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u3068\u30c6\u30b9\u30c8","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u3053\u308c\u307e\u3067\u5b66\u3093\u3060\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u6982\u5ff5\u3092\u7d71\u5408\u3057\u3001\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002\u307e\u305f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u30c6\u30b9\u30c8\u6226\u7565\u306b\u3064\u3044\u3066\u3082\u5b66\u3073\u307e\u3059\u3002</p>"},{"location":"csharp/part-6/#11","title":"\u7b2c11\u7ae0: \u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9","text":""},{"location":"csharp/part-6/#111-travelguide","title":"11.1 TravelGuide \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3","text":"<p>\u65c5\u884c\u30ac\u30a4\u30c9\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f8b\u306b\u3001\u5b9f\u8df5\u7684\u306a FP \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u69cb\u7bc9\u65b9\u6cd5\u3092\u5b66\u3073\u307e\u3059\u3002</p> <p></p>"},{"location":"csharp/part-6/#112","title":"11.2 \u30c9\u30e1\u30a4\u30f3\u30e2\u30c7\u30eb\u306e\u5b9a\u7fa9","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/csharp/src/Ch11/TravelGuide.cs</code></p> <pre><code>/// &lt;summary&gt;\n/// \u30ed\u30b1\u30fc\u30b7\u30e7\u30f3 ID\uff08\u5024\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\uff09\n/// &lt;/summary&gt;\npublic readonly record struct LocationId(string Value)\n{\n    public static LocationId Create(string id) =&gt; new(id);\n    public override string ToString() =&gt; Value;\n}\n\n/// &lt;summary&gt;\n/// \u30ed\u30b1\u30fc\u30b7\u30e7\u30f3\n/// &lt;/summary&gt;\npublic record Location(LocationId Id, string Name, int Population);\n\n/// &lt;summary&gt;\n/// \u30a2\u30c8\u30e9\u30af\u30b7\u30e7\u30f3\uff08\u89b3\u5149\u5730\uff09\n/// &lt;/summary&gt;\npublic record Attraction(string Name, Option&lt;string&gt; Description, Location Location);\n\n/// &lt;summary&gt;\n/// \u30df\u30e5\u30fc\u30b8\u30c3\u30af\u30a2\u30fc\u30c6\u30a3\u30b9\u30c8\n/// &lt;/summary&gt;\npublic record MusicArtist(string Name, Option&lt;string&gt; Genre);\n\n/// &lt;summary&gt;\n/// \u6620\u753b\n/// &lt;/summary&gt;\npublic record Movie(string Name, Option&lt;int&gt; BoxOffice);\n\n/// &lt;summary&gt;\n/// \u65c5\u884c\u30ac\u30a4\u30c9\n/// &lt;/summary&gt;\npublic record TravelGuide(Attraction Attraction, Seq&lt;string&gt; Subjects);\n</code></pre>"},{"location":"csharp/part-6/#113","title":"11.3 \u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\u5c64\u306e\u62bd\u8c61\u5316","text":"<p>\u5916\u90e8\u30c7\u30fc\u30bf\u30bd\u30fc\u30b9\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3067\u62bd\u8c61\u5316\u3057\u307e\u3059\u3002</p> <pre><code>/// &lt;summary&gt;\n/// \u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\n/// &lt;/summary&gt;\npublic interface IDataAccess\n{\n    Task&lt;Seq&lt;Attraction&gt;&gt; FindAttractions(string name, AttractionOrdering ordering, int limit);\n    Task&lt;Seq&lt;MusicArtist&gt;&gt; FindArtistsFromLocation(LocationId locationId, int limit);\n    Task&lt;Seq&lt;Movie&gt;&gt; FindMoviesAboutLocation(LocationId locationId, int limit);\n}\n</code></pre> <p></p>"},{"location":"csharp/part-6/#114-resource","title":"11.4 Resource \u306b\u3088\u308b\u30ea\u30bd\u30fc\u30b9\u7ba1\u7406","text":"<p>C# \u3067\u306f <code>IDisposable</code> \u30d1\u30bf\u30fc\u30f3\u3068 <code>using</code> \u30b9\u30c6\u30fc\u30c8\u30e1\u30f3\u30c8\u3067\u30ea\u30bd\u30fc\u30b9\u3092\u7ba1\u7406\u3067\u304d\u307e\u3059\u304c\u3001\u3088\u308a\u95a2\u6570\u578b\u7684\u306a <code>Resource&lt;T&gt;</code> \u578b\u3092\u5b9f\u88c5\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002</p> <pre><code>/// &lt;summary&gt;\n/// \u30ea\u30bd\u30fc\u30b9\u3092\u5b89\u5168\u306b\u7ba1\u7406\u3059\u308b\u305f\u3081\u306e\u578b\n/// &lt;/summary&gt;\npublic class Resource&lt;T&gt;\n{\n    private readonly Func&lt;Task&lt;T&gt;&gt; _acquire;\n    private readonly Func&lt;T, Task&gt; _release;\n\n    private Resource(Func&lt;Task&lt;T&gt;&gt; acquire, Func&lt;T, Task&gt; release)\n    {\n        _acquire = acquire;\n        _release = release;\n    }\n\n    /// &lt;summary&gt;\n    /// \u30ea\u30bd\u30fc\u30b9\u3092\u4f5c\u6210\n    /// &lt;/summary&gt;\n    public static Resource&lt;T&gt; Make(Func&lt;Task&lt;T&gt;&gt; acquire, Func&lt;T, Task&gt; release)\n        =&gt; new(acquire, release);\n\n    /// &lt;summary&gt;\n    /// \u30ea\u30bd\u30fc\u30b9\u3092\u4f7f\u7528\u3057\u3066\u64cd\u4f5c\u3092\u5b9f\u884c\n    /// &lt;/summary&gt;\n    public async Task&lt;TResult&gt; UseAsync&lt;TResult&gt;(Func&lt;T, Task&lt;TResult&gt;&gt; f)\n    {\n        var resource = await _acquire();\n        try\n        {\n            return await f(resource);\n        }\n        finally\n        {\n            await _release(resource);\n        }\n    }\n}\n</code></pre> <p></p>"},{"location":"csharp/part-6/#115","title":"11.5 \u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u5b9f\u88c5","text":"<p><code>Ref&lt;T&gt;</code> \u3092\u4f7f\u7528\u3057\u305f\u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u5b9f\u88c5:</p> <pre><code>/// &lt;summary&gt;\n/// \u30ad\u30e3\u30c3\u30b7\u30e5\u4ed8\u304d\u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\u3092\u4f5c\u6210\n/// &lt;/summary&gt;\npublic static IDataAccess CachedDataAccess(IDataAccess dataAccess)\n{\n    var attractionCache = ConcurrentProcessing.Ref&lt;Map&lt;string, Seq&lt;Attraction&gt;&gt;&gt;.Of(\n        Map&lt;string, Seq&lt;Attraction&gt;&gt;());\n    var artistCache = ConcurrentProcessing.Ref&lt;Map&lt;string, Seq&lt;MusicArtist&gt;&gt;&gt;.Of(\n        Map&lt;string, Seq&lt;MusicArtist&gt;&gt;());\n    var movieCache = ConcurrentProcessing.Ref&lt;Map&lt;string, Seq&lt;Movie&gt;&gt;&gt;.Of(\n        Map&lt;string, Seq&lt;Movie&gt;&gt;());\n\n    return new CachedDataAccessImpl(dataAccess, attractionCache, artistCache, movieCache);\n}\n\nprivate class CachedDataAccessImpl : IDataAccess\n{\n    // \u30ad\u30e3\u30c3\u30b7\u30e5\u30ed\u30b8\u30c3\u30af: \u30ad\u30fc\u304c\u3042\u308c\u3070\u30ad\u30e3\u30c3\u30b7\u30e5\u304b\u3089\u8fd4\u5374\u3001\u306a\u3051\u308c\u3070\u53d6\u5f97\u3057\u3066\u4fdd\u5b58\n    public async Task&lt;Seq&lt;Attraction&gt;&gt; FindAttractions(string name, AttractionOrdering ordering, int limit)\n    {\n        var key = $\"{name}-{ordering}-{limit}\";\n        var cached = _attractionCache.Get().Find(key);\n        if (cached.IsSome)\n        {\n            return cached.IfNone(Seq&lt;Attraction&gt;());\n        }\n\n        var attractions = await _dataAccess.FindAttractions(name, ordering, limit);\n        _attractionCache.Update(cache =&gt; cache.Add(key, attractions));\n        return attractions;\n    }\n    // \u4ed6\u306e\u30e1\u30bd\u30c3\u30c9\u3082\u540c\u69d8\u306b\u5b9f\u88c5...\n}\n</code></pre> <p></p>"},{"location":"csharp/part-6/#116","title":"11.6 \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u7d44\u307f\u7acb\u3066","text":"<p>\u3059\u3079\u3066\u306e\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002</p> <pre><code>/// &lt;summary&gt;\n/// \u65c5\u884c\u30ac\u30a4\u30c9\u3092\u751f\u6210\n/// &lt;/summary&gt;\npublic static async Task&lt;Option&lt;TravelGuide&gt;&gt; GetTravelGuide(IDataAccess data, string attractionName)\n{\n    var attractions = await data.FindAttractions(attractionName, AttractionOrdering.ByLocationPopulation, 1);\n    if (attractions.IsEmpty)\n    {\n        return None;\n    }\n\n    var attraction = attractions.First();\n    var artists = await data.FindArtistsFromLocation(attraction.Location.Id, 2);\n    var movies = await data.FindMoviesAboutLocation(attraction.Location.Id, 2);\n\n    var subjects = artists.Map(a =&gt; a.Name).Concat(movies.Map(m =&gt; m.Name));\n\n    return Some(new TravelGuide(attraction, subjects));\n}\n\n/// &lt;summary&gt;\n/// \u8907\u6570\u306e\u30a2\u30c8\u30e9\u30af\u30b7\u30e7\u30f3\u304b\u3089\u65c5\u884c\u30ac\u30a4\u30c9\u3092\u751f\u6210\n/// &lt;/summary&gt;\npublic static async Task&lt;Seq&lt;TravelGuide&gt;&gt; GetTravelGuides(IDataAccess data, string attractionName, int limit)\n{\n    var attractions = await data.FindAttractions(attractionName, AttractionOrdering.ByLocationPopulation, limit);\n\n    var guideTasks = attractions.Map(async attraction =&gt;\n    {\n        var artists = await data.FindArtistsFromLocation(attraction.Location.Id, 2);\n        var movies = await data.FindMoviesAboutLocation(attraction.Location.Id, 2);\n        var subjects = artists.Map(a =&gt; a.Name).Concat(movies.Map(m =&gt; m.Name));\n        return new TravelGuide(attraction, subjects);\n    });\n\n    var guides = await Task.WhenAll(guideTasks);\n    return toSeq(guides);\n}\n</code></pre> <p></p>"},{"location":"csharp/part-6/#12","title":"\u7b2c12\u7ae0: \u30c6\u30b9\u30c8\u6226\u7565","text":""},{"location":"csharp/part-6/#121","title":"12.1 \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u30c6\u30b9\u30c8","text":"<p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u3067\u306f\u3001\u7d14\u7c8b\u95a2\u6570\u306e\u304a\u304b\u3052\u3067\u30c6\u30b9\u30c8\u304c\u975e\u5e38\u306b\u7c21\u5358\u306b\u306a\u308a\u307e\u3059\u3002</p> <p></p>"},{"location":"csharp/part-6/#122","title":"12.2 \u30c6\u30b9\u30c8\u7528\u30b9\u30bf\u30d6\u306e\u5b9f\u88c5","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/csharp/tests/Ch11/TravelGuideTests.cs</code></p> <p>\u30c6\u30b9\u30c8\u53ef\u80fd\u6027\u3092\u9ad8\u3081\u308b\u305f\u3081\u3001\u30c6\u30b9\u30c8\u7528\u306e\u30b9\u30bf\u30d6\u5b9f\u88c5\u3092\u7528\u610f\u3057\u307e\u3059\u3002</p> <pre><code>/// &lt;summary&gt;\n/// \u30c6\u30b9\u30c8\u7528\u306e\u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\u5b9f\u88c5\n/// &lt;/summary&gt;\npublic static IDataAccess TestDataAccess(\n    Seq&lt;Attraction&gt; testAttractions,\n    Seq&lt;MusicArtist&gt; testArtists,\n    Seq&lt;Movie&gt; testMovies)\n{\n    return new TestDataAccessImpl(testAttractions, testArtists, testMovies);\n}\n\nprivate class TestDataAccessImpl : IDataAccess\n{\n    private readonly Seq&lt;Attraction&gt; _attractions;\n    private readonly Seq&lt;MusicArtist&gt; _artists;\n    private readonly Seq&lt;Movie&gt; _movies;\n\n    public TestDataAccessImpl(Seq&lt;Attraction&gt; attractions, Seq&lt;MusicArtist&gt; artists, Seq&lt;Movie&gt; movies)\n    {\n        _attractions = attractions;\n        _artists = artists;\n        _movies = movies;\n    }\n\n    public Task&lt;Seq&lt;Attraction&gt;&gt; FindAttractions(string name, AttractionOrdering ordering, int limit)\n    {\n        var filtered = _attractions\n            .Filter(a =&gt; a.Name.Contains(name))\n            .Take(limit);\n        return Task.FromResult(filtered);\n    }\n\n    public Task&lt;Seq&lt;MusicArtist&gt;&gt; FindArtistsFromLocation(LocationId locationId, int limit)\n    {\n        return Task.FromResult(_artists.Take(limit));\n    }\n\n    public Task&lt;Seq&lt;Movie&gt;&gt; FindMoviesAboutLocation(LocationId locationId, int limit)\n    {\n        return Task.FromResult(_movies.Take(limit));\n    }\n}\n</code></pre>"},{"location":"csharp/part-6/#123","title":"12.3 \u5358\u4f53\u30c6\u30b9\u30c8\u306e\u5b9f\u88c5","text":"<pre><code>public class GetTravelGuideTests\n{\n    [Fact]\n    public async Task GetTravelGuide_ReturnsGuideForValidAttraction()\n    {\n        var testLocation = new Location(\n            LocationId.Create(\"Q123\"),\n            \"Test City\",\n            100000\n        );\n        var testAttractions = Seq(\n            new Attraction(\"Test Tower\", Some(\"A tower\"), testLocation)\n        );\n        var testArtists = Seq(\n            new MusicArtist(\"Artist1\", None),\n            new MusicArtist(\"Artist2\", Some(\"Rock\"))\n        );\n        var testMovies = Seq(\n            new Movie(\"Movie1\", None)\n        );\n\n        var dataAccess = TestDataAccess(testAttractions, testArtists, testMovies);\n        var result = await GetTravelGuide(dataAccess, \"Test\");\n\n        Assert.True(result.IsSome);\n        var guide = result.IfNone(() =&gt; throw new Exception(\"Expected Some\"));\n        Assert.Equal(\"Test Tower\", guide.Attraction.Name);\n        Assert.Equal(3, guide.Subjects.Count); // 2 artists + 1 movie\n    }\n\n    [Fact]\n    public async Task GetTravelGuide_ReturnsNoneWhenNotFound()\n    {\n        var dataAccess = TestDataAccess(Seq&lt;Attraction&gt;(), Seq&lt;MusicArtist&gt;(), Seq&lt;Movie&gt;());\n        var result = await GetTravelGuide(dataAccess, \"NonExistent\");\n\n        Assert.True(result.IsNone);\n    }\n}\n</code></pre>"},{"location":"csharp/part-6/#124","title":"12.4 \u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u30c6\u30b9\u30c8","text":"<pre><code>public class CachedDataAccessTests\n{\n    [Fact]\n    public async Task CachedDataAccess_CachesData()\n    {\n        var callCount = 0;\n        var testLocation = new Location(\n            LocationId.Create(\"Q123\"),\n            \"Test City\",\n            100000\n        );\n        var testAttractions = Seq(\n            new Attraction(\"Test Tower\", None, testLocation)\n        );\n\n        var countingDataAccess = new CountingDataAccess(\n            testAttractions,\n            Seq&lt;MusicArtist&gt;(),\n            Seq&lt;Movie&gt;(),\n            () =&gt; callCount++\n        );\n\n        var cached = CachedDataAccess(countingDataAccess);\n\n        // First call\n        _ = await cached.FindAttractions(\"Test\", AttractionOrdering.ByName, 10);\n        Assert.Equal(1, callCount);\n\n        // Second call (should be cached)\n        _ = await cached.FindAttractions(\"Test\", AttractionOrdering.ByName, 10);\n        Assert.Equal(1, callCount); // Call count should not increase\n\n        // Different parameters\n        _ = await cached.FindAttractions(\"Other\", AttractionOrdering.ByName, 10);\n        Assert.Equal(2, callCount);\n    }\n}\n</code></pre>"},{"location":"csharp/part-6/#125-resource","title":"12.5 Resource \u306e\u30c6\u30b9\u30c8","text":"<pre><code>public class ResourceTests\n{\n    [Fact]\n    public async Task Resource_Make_CreatesResource()\n    {\n        var acquired = false;\n        var released = false;\n\n        var resource = Resource.Make(\n            async () =&gt;\n            {\n                acquired = true;\n                return \"resource\";\n            },\n            async r =&gt; { released = true; }\n        );\n\n        var result = await resource.UseAsync(async r =&gt; r + \"-used\");\n\n        Assert.Equal(\"resource-used\", result);\n        Assert.True(acquired);\n        Assert.True(released);\n    }\n\n    [Fact]\n    public async Task Resource_ReleasesEvenOnException()\n    {\n        var released = false;\n\n        var resource = Resource.Make(\n            async () =&gt; \"resource\",\n            async r =&gt; { released = true; }\n        );\n\n        try\n        {\n            await resource.UseAsync&lt;string&gt;(async r =&gt; throw new Exception(\"Test error\"));\n        }\n        catch\n        {\n            // Expected\n        }\n\n        Assert.True(released);\n    }\n}\n</code></pre>"},{"location":"csharp/part-6/#126","title":"12.6 \u30c6\u30b9\u30c8\u30d4\u30e9\u30df\u30c3\u30c9","text":""},{"location":"csharp/part-6/#_1","title":"\u307e\u3068\u3081","text":""},{"location":"csharp/part-6/#part-vi_1","title":"Part VI \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"csharp/part-6/#_2","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>\u62bd\u8c61\u5316\u306e\u91cd\u8981\u6027: IDataAccess \u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3067\u5916\u90e8\u4f9d\u5b58\u3092\u62bd\u8c61\u5316</li> <li>Resource \u3067\u30ea\u30bd\u30fc\u30b9\u7ba1\u7406: \u5b89\u5168\u306a\u30ea\u30bd\u30fc\u30b9\u306e\u53d6\u5f97\u3068\u89e3\u653e</li> <li>Ref \u3067\u30ad\u30e3\u30c3\u30b7\u30e5: \u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u72b6\u614b\u7ba1\u7406</li> <li>Option \u3067\u30a8\u30e9\u30fc\u51e6\u7406: \u660e\u793a\u7684\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0</li> <li>\u30b9\u30bf\u30d6: \u5916\u90e8\u4f9d\u5b58\u3092\u5dee\u3057\u66ff\u3048\u3066\u30c6\u30b9\u30c8</li> <li>record \u578b: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c9\u30e1\u30a4\u30f3\u30e2\u30c7\u30eb</li> </ol>"},{"location":"csharp/part-6/#_3","title":"\u5b66\u7fd2\u306e\u7dcf\u62ec","text":""},{"location":"csharp/part-6/#_4","title":"\u30b7\u30ea\u30fc\u30ba\u5168\u4f53\u306e\u7dcf\u62ec","text":"<p>\u672c\u30b7\u30ea\u30fc\u30ba\u3067\u306f\u3001\u300cGrokking Functional Programming\u300d\u306e\u5185\u5bb9\u306b\u6cbf\u3063\u3066\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u790e\u304b\u3089\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u307e\u3067\u3092 C# \u3068 LanguageExt \u30e9\u30a4\u30d6\u30e9\u30ea\u3067\u5b66\u3073\u307e\u3057\u305f\u3002</p>"},{"location":"csharp/part-6/#_5","title":"\u5b66\u3093\u3060\u4e3b\u306a\u6982\u5ff5","text":"Part \u7ae0 \u4e3b\u306a\u6982\u5ff5 I 1-2 \u7d14\u7c8b\u95a2\u6570\u3001\u53c2\u7167\u900f\u904e\u6027 II 3-5 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u3001\u9ad8\u968e\u95a2\u6570\u3001Bind III 6-7 Option\u3001Either/Fin IV 8-9 Task\uff08\u975e\u540c\u671f\uff09\u3001IAsyncEnumerable\uff08\u30b9\u30c8\u30ea\u30fc\u30e0\uff09 V 10 \u4e26\u884c\u51e6\u7406\u3001Ref\u3001Agent VI 11 \u5b9f\u8df5\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3001\u30c6\u30b9\u30c8"},{"location":"csharp/part-6/#_6","title":"\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u5229\u70b9","text":"<ol> <li>\u4e88\u6e2c\u53ef\u80fd\u6027: \u7d14\u7c8b\u95a2\u6570\u306f\u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b</li> <li>\u30c6\u30b9\u30c8\u5bb9\u6613\u6027: \u526f\u4f5c\u7528\u304c\u306a\u3044\u305f\u3081\u30c6\u30b9\u30c8\u304c\u7c21\u5358</li> <li>\u5408\u6210\u53ef\u80fd\u6027: \u5c0f\u3055\u306a\u95a2\u6570\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u8907\u96d1\u306a\u51e6\u7406\u3092\u69cb\u7bc9</li> <li>\u4e26\u884c\u5b89\u5168\u6027: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u306f\u7af6\u5408\u72b6\u614b\u3092\u9632\u3050</li> <li>\u578b\u5b89\u5168\u6027: Option\u3001Either \u3067 null \u3084\u4f8b\u5916\u3092\u578b\u3067\u8868\u73fe</li> </ol>"},{"location":"csharp/part-6/#c-languageext","title":"C# + LanguageExt \u306e\u7279\u5fb4","text":"<p>C# \u306f .NET \u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u4e0a\u3067\u52d5\u4f5c\u3059\u308b\u30de\u30eb\u30c1\u30d1\u30e9\u30c0\u30a4\u30e0\u8a00\u8a9e\u3067\u3001LanguageExt \u30e9\u30a4\u30d6\u30e9\u30ea\u3068\u7d44\u307f\u5408\u308f\u305b\u308b\u3053\u3068\u3067\u4ee5\u4e0b\u306e\u7279\u5fb4\u3092\u6301\u3061\u307e\u3059:</p> <ul> <li>Option: null \u5b89\u5168\u306a\u30aa\u30d7\u30b7\u30e7\u30f3\u578b <li>Either: \u6210\u529f/\u5931\u6557\u3092\u578b\u3067\u8868\u73fe <li>Seq: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30b7\u30fc\u30b1\u30f3\u30b9 <li>Map: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u8f9e\u66f8 <li>\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0: switch \u5f0f\u3067\u95a2\u6570\u578b\u30b9\u30bf\u30a4\u30eb\u306e\u5206\u5c90</li> <li>record \u578b: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u578b</li>"},{"location":"csharp/part-6/#_7","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<ul> <li>C# \u306e\u9ad8\u5ea6\u306a\u6a5f\u80fd\uff08Source Generators\u3001\u62e1\u5f35\u30e1\u30bd\u30c3\u30c9\uff09\u3092\u5b66\u3076</li> <li>ASP.NET Core \u3067 FP \u30b9\u30bf\u30a4\u30eb\u306e Web API \u3092\u69cb\u7bc9</li> <li>\u3088\u308a\u9ad8\u5ea6\u306a LanguageExt \u6a5f\u80fd\uff08Eff, Aff\uff09\u3092\u63a2\u7d22</li> <li>\u5b9f\u969b\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067 FP \u3092\u9069\u7528\u3059\u308b</li> </ul>"},{"location":"elixir/","title":"Grokking Functional Programming - Elixir \u7248","text":"<p>\u672c\u30b7\u30ea\u30fc\u30ba\u306f\u300cGrokking Functional Programming\u300d\uff08Micha\u0142 P\u0142achta \u8457\uff09\u306e\u5b66\u7fd2\u30b3\u30f3\u30d1\u30cb\u30aa\u30f3\u3068\u3057\u3066\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u6982\u5ff5\u3092 Elixir \u3067\u5b9f\u88c5\u3057\u306a\u304c\u3089\u65e5\u672c\u8a9e\u3067\u89e3\u8aac\u3057\u307e\u3059\u3002</p>"},{"location":"elixir/#_1","title":"\u5bfe\u8c61\u8aad\u8005","text":"<ul> <li>\u4ed6\u306e\u8a00\u8a9e\uff08Ruby, Python, JavaScript \u7b49\uff09\u306e\u7d4c\u9a13\u304c\u3042\u308a\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u8208\u5473\u304c\u3042\u308b\u958b\u767a\u8005</li> <li>Elixir \u3092\u5b66\u3073\u305f\u3044\u304c\u3001FP \u306e\u6982\u5ff5\u304b\u3089\u7406\u89e3\u3057\u305f\u3044\u65b9</li> <li>\u5b9f\u8df5\u7684\u306a FP \u306e\u9069\u7528\u65b9\u6cd5\u3092\u77e5\u308a\u305f\u3044\u30a8\u30f3\u30b8\u30cb\u30a2</li> </ul>"},{"location":"elixir/#elixir","title":"Elixir \u3068\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0","text":"<p>Elixir \u306f Erlang VM\uff08BEAM\uff09\u4e0a\u3067\u52d5\u4f5c\u3059\u308b\u95a2\u6570\u578b\u8a00\u8a9e\u3067\u3001\u4ee5\u4e0b\u306e\u7279\u5fb4\u304c\u3042\u308a\u307e\u3059:</p> <ul> <li>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf: \u3059\u3079\u3066\u306e\u30c7\u30fc\u30bf\u306f\u4e0d\u5909</li> <li>\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0: \u5f37\u529b\u306a\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u69cb\u6587</li> <li>\u30d1\u30a4\u30d7\u6f14\u7b97\u5b50: <code>|&gt;</code> \u306b\u3088\u308b\u95a2\u6570\u306e\u9023\u9396</li> <li>\u30d7\u30ed\u30bb\u30b9: \u8efd\u91cf\u306a\u4e26\u884c\u51e6\u7406\u30e2\u30c7\u30eb</li> <li>OTP: \u5805\u7262\u306a\u5206\u6563\u30b7\u30b9\u30c6\u30e0\u69cb\u7bc9\u306e\u305f\u3081\u306e\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af</li> </ul>"},{"location":"elixir/#_2","title":"\u8a18\u4e8b\u4e00\u89a7","text":""},{"location":"elixir/#part-i","title":"Part I: \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u790e","text":"<p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u672c\u6982\u5ff5\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c1\u7ae0 \u547d\u4ee4\u578b vs \u95a2\u6570\u578b\u3001Elixir \u57fa\u672c\u69cb\u6587 \u7b2c2\u7ae0 \u7d14\u7c8b\u95a2\u6570\u3001\u526f\u4f5c\u7528\u306e\u6392\u9664\u3001\u30c6\u30b9\u30c8\u306e\u5bb9\u6613\u3055 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: \u7d14\u7c8b\u95a2\u6570\u3001\u53c2\u7167\u900f\u904e\u6027\u3001\u526f\u4f5c\u7528\u3001\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0</p>"},{"location":"elixir/#part-ii","title":"Part II: \u95a2\u6570\u578b\u30b9\u30bf\u30a4\u30eb\u306e\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0","text":"<p>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c\u3068\u9ad8\u968e\u95a2\u6570\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c3\u7ae0 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u3001\u30ea\u30b9\u30c8\u64cd\u4f5c \u7b2c4\u7ae0 \u9ad8\u968e\u95a2\u6570\u3001Enum \u30e2\u30b8\u30e5\u30fc\u30eb \u7b2c5\u7ae0 flat_map\u3001for \u5185\u5305\u8868\u8a18 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u3001\u9ad8\u968e\u95a2\u6570\u3001Enum\u3001\u30d1\u30a4\u30d7\u6f14\u7b97\u5b50</p>"},{"location":"elixir/#part-iii","title":"Part III: \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":"<p>\u578b\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c6\u7ae0 nil \u306e\u6271\u3044\u3001\u30ac\u30fc\u30c9\u7bc0 \u7b2c7\u7ae0 {:ok, value} / {:error, reason}\u3001with \u5f0f <p>\u30ad\u30fc\u30ef\u30fc\u30c9: \u30bf\u30d7\u30eb\u306b\u3088\u308b\u30a8\u30e9\u30fc\u51e6\u7406\u3001with \u5f0f\u3001\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0</p>"},{"location":"elixir/#part-iv","title":"Part IV: \u30d7\u30ed\u30bb\u30b9\u3068\u72b6\u614b\u7ba1\u7406","text":"<p>Elixir \u306e\u30d7\u30ed\u30bb\u30b9\u30e2\u30c7\u30eb\u3068\u72b6\u614b\u7ba1\u7406\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c8\u7ae0 Agent\u3001GenServer \u7b2c9\u7ae0 Stream\u3001\u9045\u5ef6\u8a55\u4fa1 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: Agent\u3001GenServer\u3001Stream\u3001\u9045\u5ef6\u8a55\u4fa1</p>"},{"location":"elixir/#part-v-otp","title":"Part V: \u4e26\u884c\u51e6\u7406\u3068 OTP","text":"<p>Elixir/OTP \u306b\u304a\u3051\u308b\u4e26\u884c\u51e6\u7406\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c10\u7ae0 Task\u3001\u4e26\u5217\u51e6\u7406 \u7b2c11\u7ae0 Supervisor\u3001OTP \u30d1\u30bf\u30fc\u30f3 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: Task\u3001Supervisor\u3001OTP\u3001\u30d5\u30a9\u30fc\u30eb\u30c8\u30c8\u30ec\u30e9\u30f3\u30b9</p>"},{"location":"elixir/#part-vi","title":"Part VI: \u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u3068\u30c6\u30b9\u30c8","text":"<p>\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u3068\u30c6\u30b9\u30c8\u6226\u7565\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c12\u7ae0 TravelGuide \u30a2\u30d7\u30ea\u3001Behaviour\u3001\u30ad\u30e3\u30c3\u30b7\u30e5 \u7b2c13\u7ae0 \u30c6\u30b9\u30c8\u6226\u7565\u3001ExUnit\u3001\u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: Behaviour\u3001ExUnit\u3001StreamData</p>"},{"location":"elixir/#_3","title":"\u5b66\u7fd2\u30d1\u30b9","text":""},{"location":"elixir/#scala-vs-elixir","title":"Scala vs Elixir \u5bfe\u5fdc\u8868","text":"\u6982\u5ff5 Scala Elixir \u57fa\u672c\u5358\u4f4d \u30af\u30e9\u30b9/\u30aa\u30d6\u30b8\u30a7\u30af\u30c8 \u30e2\u30b8\u30e5\u30fc\u30eb/\u95a2\u6570 \u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u64cd\u4f5c map/filter/foldLeft Enum.map/filter/reduce \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3 \u30e1\u30bd\u30c3\u30c9\u30c1\u30a7\u30fc\u30f3 \u30d1\u30a4\u30d7\u6f14\u7b97\u5b50 <code>\\|&gt;</code> Option Option[A] nil \u307e\u305f\u306f\u30bf\u30d7\u30eb Either Either[E, A] {:ok, value} / {:error, reason} IO \u30e2\u30ca\u30c9 IO[A] (cats-effect) \u526f\u4f5c\u7528\u306f\u76f4\u63a5\u5b9f\u884c \u72b6\u614b\u7ba1\u7406 Ref Agent / GenServer \u4e26\u884c\u51e6\u7406 Fiber Process / Task \u30b9\u30c8\u30ea\u30fc\u30e0 fs2 Stream Stream"},{"location":"elixir/#_4","title":"\u4f7f\u7528\u30e9\u30a4\u30d6\u30e9\u30ea","text":"\u30e9\u30a4\u30d6\u30e9\u30ea \u7528\u9014 \u5bfe\u5fdc\u7ae0 Elixir 1.15+ \u8a00\u8a9e \u5168\u7ae0 ExUnit \u30c6\u30b9\u30c8\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af \u5168\u7ae0 StreamData \u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8 Part VI"},{"location":"elixir/#_5","title":"\u30ea\u30dd\u30b8\u30c8\u30ea\u69cb\u6210","text":"<pre><code>grokkingfp-examples/\n\u251c\u2500\u2500 app/elixir/                  # Elixir \u306e\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n\u2502   \u251c\u2500\u2500 lib/\n\u2502   \u2502   \u251c\u2500\u2500 ch01/               # \u7b2c1\u7ae0\n\u2502   \u2502   \u251c\u2500\u2500 ch02/               # \u7b2c2\u7ae0\n\u2502   \u2502   \u2514\u2500\u2500 ...\n\u2502   \u251c\u2500\u2500 test/                   # \u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\n\u2502   \u2514\u2500\u2500 mix.exs                 # \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u8a2d\u5b9a\n\u251c\u2500\u2500 docs/article/elixir/        # \u89e3\u8aac\u8a18\u4e8b\uff08\u672c\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\uff09\n\u2502   \u251c\u2500\u2500 index.md                # \u3053\u306e\u8a18\u4e8b\n\u2502   \u251c\u2500\u2500 part-1.md               # Part I\n\u2502   \u251c\u2500\u2500 part-2.md               # Part II\n\u2502   \u251c\u2500\u2500 part-3.md               # Part III\n\u2502   \u251c\u2500\u2500 part-4.md               # Part IV\n\u2502   \u251c\u2500\u2500 part-5.md               # Part V\n\u2502   \u2514\u2500\u2500 part-6.md               # Part VI\n\u2514\u2500\u2500 ...\n</code></pre>"},{"location":"elixir/#elixir_1","title":"Elixir \u306b\u304a\u3051\u308b\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u5229\u70b9","text":"<p>\u672c\u30b7\u30ea\u30fc\u30ba\u3092\u901a\u3058\u3066\u3001\u4ee5\u4e0b\u306e\u5229\u70b9\u3092\u5b9f\u611f\u3067\u304d\u307e\u3059:</p> <ol> <li>\u4e88\u6e2c\u53ef\u80fd\u6027 - \u7d14\u7c8b\u95a2\u6570\u306f\u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b</li> <li>\u30c6\u30b9\u30c8\u5bb9\u6613\u6027 - \u526f\u4f5c\u7528\u304c\u306a\u3044\u305f\u3081\u30c6\u30b9\u30c8\u304c\u7c21\u5358</li> <li>\u5408\u6210\u53ef\u80fd\u6027 - \u30d1\u30a4\u30d7\u6f14\u7b97\u5b50\u3067\u95a2\u6570\u3092\u81ea\u7136\u306b\u9023\u9396</li> <li>\u4e26\u884c\u5b89\u5168\u6027 - \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u3068\u30a2\u30af\u30bf\u30fc\u30e2\u30c7\u30eb</li> <li>\u30d5\u30a9\u30fc\u30eb\u30c8\u30c8\u30ec\u30e9\u30f3\u30b9 - OTP \u306b\u3088\u308b\u5805\u7262\u306a\u30b7\u30b9\u30c6\u30e0\u69cb\u7bc9</li> <li>\u30b9\u30b1\u30fc\u30e9\u30d3\u30ea\u30c6\u30a3 - BEAM VM \u306b\u3088\u308b\u5206\u6563\u51e6\u7406</li> </ol>"},{"location":"elixir/#_6","title":"\u53c2\u8003\u8cc7\u6599","text":"<ul> <li>Grokking Functional Programming - \u539f\u8457</li> <li>Elixir \u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8</li> <li>Elixir School - \u65e5\u672c\u8a9e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb</li> <li>Hex.pm - Elixir \u30d1\u30c3\u30b1\u30fc\u30b8\u30ea\u30dd\u30b8\u30c8\u30ea</li> </ul>"},{"location":"elixir/part-1/","title":"Part I: \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u790e","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\uff08FP\uff09\u306e\u57fa\u672c\u6982\u5ff5\u3092\u5b66\u3073\u307e\u3059\u3002\u547d\u4ee4\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u3068\u306e\u9055\u3044\u3092\u7406\u89e3\u3057\u3001\u7d14\u7c8b\u95a2\u6570\u306e\u5229\u70b9\u3092\u5b9f\u611f\u3059\u308b\u3053\u3068\u304c\u76ee\u6a19\u3067\u3059\u3002</p>"},{"location":"elixir/part-1/#1","title":"\u7b2c1\u7ae0: \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u5165\u9580","text":""},{"location":"elixir/part-1/#11-vs","title":"1.1 \u547d\u4ee4\u578b vs \u95a2\u6570\u578b","text":"<p>\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u306f\u5927\u304d\u304f\u5206\u3051\u30662\u3064\u306e\u30d1\u30e9\u30c0\u30a4\u30e0\u304c\u3042\u308a\u307e\u3059\u3002</p> <p></p> <p>\u547d\u4ee4\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306f\u300c\u3069\u3046\u3084\u308b\u304b\u300d\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002</p> <pre><code>// Java: \u547d\u4ee4\u578b\u3067\u30ef\u30fc\u30c9\u30b9\u30b3\u30a2\u3092\u8a08\u7b97\npublic static int calculateScore(String word) {\n    int score = 0;\n    for(char c : word.toCharArray()) {\n        score++;\n    }\n    return score;\n}\n</code></pre> <p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306f\u300c\u4f55\u3092\u3059\u308b\u304b\u300d\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002</p> <pre><code># Elixir: \u95a2\u6570\u578b\u3067\u30ef\u30fc\u30c9\u30b9\u30b3\u30a2\u3092\u8a08\u7b97\ndef word_score(word), do: String.length(word)\n</code></pre>"},{"location":"elixir/part-1/#12-elixir","title":"1.2 Elixir \u306e\u57fa\u672c\u69cb\u6587","text":"<p>Elixir \u3067\u306e\u95a2\u6570\u5b9a\u7fa9\u306e\u57fa\u672c\u5f62\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/elixir/lib/ch01/intro.ex</code></p> <pre><code>defmodule Ch01.Intro do\n  # \u6570\u5024\u30921\u5897\u52a0\u3055\u305b\u308b\n  def increment(x), do: x + 1\n\n  # \u6587\u5b57\u5217\u306e\u6700\u521d\u306e\u6587\u5b57\u3092\u53d6\u5f97\n  def get_first_character(s), do: String.first(s)\n\n  # \u5358\u8a9e\u306e\u30b9\u30b3\u30a2\u3092\u8a08\u7b97\uff08\u6587\u5b57\u6570\uff09\n  def word_score(word), do: String.length(word)\nend\n</code></pre>"},{"location":"elixir/part-1/#13","title":"1.3 \u95a2\u6570\u306e\u69cb\u9020","text":""},{"location":"elixir/part-1/#14-elixir","title":"1.4 Elixir \u306e\u95a2\u6570\u5b9a\u7fa9\u30b9\u30bf\u30a4\u30eb","text":"<p>Elixir \u3067\u306f\u8907\u6570\u306e\u95a2\u6570\u5b9a\u7fa9\u30b9\u30bf\u30a4\u30eb\u304c\u3042\u308a\u307e\u3059\u3002</p> <pre><code># 1\u884c\u5f62\u5f0f\uff08\u77ed\u3044\u95a2\u6570\u5411\u3051\uff09\ndef increment(x), do: x + 1\n\n# \u30d6\u30ed\u30c3\u30af\u5f62\u5f0f\uff08\u8907\u6570\u884c\u306e\u51e6\u7406\u5411\u3051\uff09\ndef increment(x) do\n  x + 1\nend\n\n# \u8907\u6570\u7bc0\uff08\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\uff09\ndef head([]), do: {:error, :empty_list}\ndef head([h | _t]), do: {:ok, h}\n</code></pre>"},{"location":"elixir/part-1/#15","title":"1.5 \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0","text":"<p>Elixir \u306e\u5f37\u529b\u306a\u6a5f\u80fd\u306e\u4e00\u3064\u304c\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3067\u3059\u3002</p> <pre><code># \u30bf\u30d7\u30eb\u304b\u3089\u30c7\u30fc\u30bf\u3092\u62bd\u51fa\ndef extract_name({:user, name, _age}), do: name\n\n# \u30ea\u30b9\u30c8\u306e\u5148\u982d\u3068\u672b\u5c3e\u3092\u53d6\u5f97\ndef head([h | _t]), do: {:ok, h}\ndef tail([_h | t]), do: {:ok, t}\n\n# \u4f7f\u7528\u4f8b\niex&gt; extract_name({:user, \"Alice\", 30})\n\"Alice\"\n\niex&gt; head([1, 2, 3])\n{:ok, 1}\n</code></pre> <p></p>"},{"location":"elixir/part-1/#16","title":"1.6 \u30d1\u30a4\u30d7\u6f14\u7b97\u5b50","text":"<p>Elixir \u306e\u7279\u5fb4\u7684\u306a\u6a5f\u80fd\u304c\u30d1\u30a4\u30d7\u6f14\u7b97\u5b50\uff08<code>|&gt;</code>\uff09\u3067\u3059\u3002</p> <pre><code># \u30d1\u30a4\u30d7\u6f14\u7b97\u5b50\u306a\u3057\uff08\u30cd\u30b9\u30c8\u304c\u6df1\u3044\uff09\nlength(String.split(String.upcase(text)))\n\n# \u30d1\u30a4\u30d7\u6f14\u7b97\u5b50\u3042\u308a\uff08\u8aad\u307f\u3084\u3059\u3044\uff09\ntext\n|&gt; String.upcase()\n|&gt; String.split()\n|&gt; length()\n</code></pre> <p></p>"},{"location":"elixir/part-1/#17","title":"1.7 \u30ac\u30fc\u30c9\u7bc0","text":"<p>\u6761\u4ef6\u5206\u5c90\u3092\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3068\u7d44\u307f\u5408\u308f\u305b\u3089\u308c\u307e\u3059\u3002</p> <pre><code>def describe_number(n) when n &gt; 0, do: \"positive\"\ndef describe_number(n) when n &lt; 0, do: \"negative\"\ndef describe_number(0), do: \"zero\"\n\ndef describe_type(value) when is_binary(value), do: \"string\"\ndef describe_type(value) when is_integer(value), do: \"integer\"\ndef describe_type(value) when is_float(value), do: \"float\"\ndef describe_type(value) when is_list(value), do: \"list\"\ndef describe_type(_value), do: \"unknown\"\n</code></pre>"},{"location":"elixir/part-1/#18","title":"1.8 \u5b66\u7fd2\u30dd\u30a4\u30f3\u30c8","text":"\u6982\u5ff5 \u547d\u4ee4\u578b Elixir\uff08\u95a2\u6570\u578b\uff09 \u7126\u70b9 \u624b\u9806\uff08How\uff09 \u7d50\u679c\uff08What\uff09 \u72b6\u614b \u5909\u66f4\u3059\u308b \u5909\u63db\u3059\u308b \u30eb\u30fc\u30d7 for/while Enum/\u518d\u5e30 \u30c7\u30fc\u30bf \u30df\u30e5\u30fc\u30bf\u30d6\u30eb \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb \u5206\u5c90 if/switch \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0 \u5408\u6210 \u30e1\u30bd\u30c3\u30c9\u30c1\u30a7\u30fc\u30f3 \u30d1\u30a4\u30d7\u6f14\u7b97\u5b50"},{"location":"elixir/part-1/#2","title":"\u7b2c2\u7ae0: \u7d14\u7c8b\u95a2\u6570\u3068\u30c6\u30b9\u30c8","text":""},{"location":"elixir/part-1/#21","title":"2.1 \u7d14\u7c8b\u95a2\u6570\u3068\u306f","text":"<p>\u7d14\u7c8b\u95a2\u6570\uff08Pure Function\uff09\u306f\u4ee5\u4e0b\u306e\u7279\u5fb4\u3092\u6301\u3064\u95a2\u6570\u3067\u3059:</p> <ol> <li>\u540c\u3058\u5165\u529b\u306b\u306f\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3059</li> <li>\u526f\u4f5c\u7528\u304c\u306a\u3044\uff08\u5916\u90e8\u72b6\u614b\u3092\u5909\u66f4\u3057\u306a\u3044\uff09</li> </ol> <p></p>"},{"location":"elixir/part-1/#22","title":"2.2 \u7d14\u7c8b\u95a2\u6570\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/elixir/lib/ch02/pure_functions.ex</code></p> <pre><code>defmodule Ch02.PureFunctions do\n  # \u7d14\u7c8b\u95a2\u6570\u306e\u4f8b\n  def increment(x), do: x + 1\n  def add(a, b), do: a + b\n  def double(x), do: x * 2\n\n  # \u6587\u5b57 'a' \u3092\u9664\u5916\u3057\u305f\u30b9\u30b3\u30a2\n  def word_score_without_a(word) do\n    word\n    |&gt; String.replace(\"a\", \"\")\n    |&gt; String.length()\n  end\n\n  # \u5076\u6570\u5224\u5b9a\n  def even?(n), do: rem(n, 2) == 0\nend\n</code></pre> <p>\u7d14\u7c8b\u3067\u306f\u306a\u3044\u95a2\u6570\u306e\u4f8b:</p> <pre><code># \u4e0d\u7d14\u306a\u95a2\u6570 - \u6bce\u56de\u7570\u306a\u308b\u5024\u3092\u8fd4\u3059\ndef random_part(x), do: x * :rand.uniform()\n\n# \u4e0d\u7d14\u306a\u95a2\u6570 - \u5916\u90e8\u72b6\u614b\u306b\u4f9d\u5b58\ndef get_current_time(), do: DateTime.utc_now()\n</code></pre>"},{"location":"elixir/part-1/#23","title":"2.3 \u30b7\u30e7\u30c3\u30d4\u30f3\u30b0\u30ab\u30fc\u30c8\u306e\u4f8b","text":"<p>\u72b6\u614b\u3092\u6301\u3064\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u6307\u5411\u7684\u306a\u30a2\u30d7\u30ed\u30fc\u30c1\u306e\u554f\u984c\u70b9\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/elixir/lib/ch02/shopping_cart.ex</code></p>"},{"location":"elixir/part-1/#_1","title":"\u554f\u984c\u306e\u3042\u308b\u30b3\u30fc\u30c9\uff08\u4ed6\u8a00\u8a9e\u3067\u306e\u4f8b\uff09","text":"<pre><code>// Java: \u72b6\u614b\u3092\u6301\u3064\u30af\u30e9\u30b9\nclass ShoppingCartBad {\n    private List&lt;String&gt; items = new ArrayList&lt;&gt;();\n    private boolean bookAdded = false;\n\n    public void addItem(String item) {\n        items.add(item);\n        if(item.equals(\"Book\")) {\n            bookAdded = true;\n        }\n    }\n\n    public int getDiscountPercentage() {\n        if(bookAdded) {\n            return 5;\n        } else {\n            return 0;\n        }\n    }\n\n    public List&lt;String&gt; getItems() {\n        return items;  // \u554f\u984c: \u5185\u90e8\u72b6\u614b\u3078\u306e\u53c2\u7167\u3092\u8fd4\u3057\u3066\u3044\u308b\n    }\n}\n</code></pre>"},{"location":"elixir/part-1/#_2","title":"\u7d14\u7c8b\u95a2\u6570\u306b\u3088\u308b\u89e3\u6c7a","text":"<pre><code>defmodule Ch02.ShoppingCart do\n  # \u7d14\u7c8b\u95a2\u6570: \u72b6\u614b\u3092\u6301\u305f\u305a\u3001\u5165\u529b\u304b\u3089\u51fa\u529b\u3092\u8a08\u7b97\n  def get_discount_percentage(items) do\n    if \"Book\" in items, do: 5, else: 0\n  end\n\n  # \u30ab\u30fc\u30c8\u306b\u30a2\u30a4\u30c6\u30e0\u3092\u8ffd\u52a0\uff08\u65b0\u3057\u3044\u30ea\u30b9\u30c8\u3092\u8fd4\u3059\uff09\n  def add_item(items, item), do: items ++ [item]\n\n  # \u30ab\u30fc\u30c8\u304b\u3089\u30a2\u30a4\u30c6\u30e0\u3092\u524a\u9664\uff08\u65b0\u3057\u3044\u30ea\u30b9\u30c8\u3092\u8fd4\u3059\uff09\n  def remove_item(items, item), do: List.delete(items, item)\nend\n</code></pre>"},{"location":"elixir/part-1/#24","title":"2.4 \u30c1\u30c3\u30d7\u8a08\u7b97\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/elixir/lib/ch02/tip_calculator.ex</code></p> <pre><code>defmodule Ch02.TipCalculator do\n  def get_tip_percentage(names) do\n    count = length(names)\n\n    cond do\n      count &gt; 5 -&gt; 20\n      count &gt; 0 -&gt; 10\n      true -&gt; 0\n    end\n  end\n\n  def calculate_tip(bill_amount, names) do\n    bill_amount * get_tip_percentage(names) / 100\n  end\nend\n</code></pre> <p>\u3053\u306e\u95a2\u6570\u306f: - 6\u4eba\u4ee5\u4e0a\u306e\u30b0\u30eb\u30fc\u30d7 \u2192 20% \u306e\u30c1\u30c3\u30d7 - 1-5\u4eba\u306e\u30b0\u30eb\u30fc\u30d7 \u2192 10% \u306e\u30c1\u30c3\u30d7 - 0\u4eba\uff08\u7a7a\u30ea\u30b9\u30c8\uff09 \u2192 0% \u306e\u30c1\u30c3\u30d7</p>"},{"location":"elixir/part-1/#25","title":"2.5 \u7d14\u7c8b\u95a2\u6570\u306e\u30c6\u30b9\u30c8","text":"<p>\u7d14\u7c8b\u95a2\u6570\u306f\u975e\u5e38\u306b\u30c6\u30b9\u30c8\u3057\u3084\u3059\u3044\u3067\u3059\u3002</p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/elixir/test/ch02/pure_functions_test.exs</code></p> <pre><code>defmodule Ch02.PureFunctionsTest do\n  use ExUnit.Case\n\n  test \"increment \u306f\u6b63\u3057\u304f\u52d5\u4f5c\u3059\u308b\" do\n    assert Ch02.PureFunctions.increment(6) == 7\n    assert Ch02.PureFunctions.increment(0) == 1\n    assert Ch02.PureFunctions.increment(-6) == -5\n  end\n\n  test \"word_score_without_a \u306f 'a' \u3092\u9664\u5916\u3057\u3066\u30ab\u30a6\u30f3\u30c8\" do\n    assert Ch02.PureFunctions.word_score_without_a(\"Scala\") == 3\n    assert Ch02.PureFunctions.word_score_without_a(\"banana\") == 3\n  end\n\n  test \"\u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b\uff08\u53c2\u7167\u900f\u904e\u6027\uff09\" do\n    for _ &lt;- 1..100 do\n      assert Ch02.PureFunctions.increment(5) == 6\n    end\n  end\nend\n</code></pre> <p></p>"},{"location":"elixir/part-1/#26","title":"2.6 \u53c2\u7167\u900f\u904e\u6027","text":"<p>\u7d14\u7c8b\u95a2\u6570\u306f\u53c2\u7167\u900f\u904e\u6027\uff08Referential Transparency\uff09\u3092\u6301\u3061\u307e\u3059\u3002</p> <p>\u5f0f\u3092\u305d\u306e\u8a55\u4fa1\u7d50\u679c\u3067\u7f6e\u304d\u63db\u3048\u3066\u3082\u3001\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u610f\u5473\u304c\u5909\u308f\u3089\u306a\u3044\u3053\u3068</p> <pre><code># \u53c2\u7167\u900f\u904e\u6027\u306e\u4f8b\nscore1 = Ch02.PureFunctions.word_score_without_a(\"Scala\")\nscore2 = Ch02.PureFunctions.word_score_without_a(\"Scala\")\n# score1 \u3068 score2 \u306f\u5e38\u306b\u540c\u3058\u5024\uff083\uff09\n\n# \u4ee5\u4e0b\u306e2\u3064\u306f\u540c\u7b49\ntotal1 = Ch02.PureFunctions.word_score_without_a(\"Elixir\") +\n         Ch02.PureFunctions.word_score_without_a(\"Scala\")\ntotal2 = 6 + 3  # word_score_without_a \u306e\u7d50\u679c\u3067\u7f6e\u304d\u63db\u3048\u53ef\u80fd\n</code></pre> <p></p>"},{"location":"elixir/part-1/#scala-vs-elixir","title":"Scala vs Elixir \u6bd4\u8f03","text":"\u6982\u5ff5 Scala Elixir \u95a2\u6570\u5b9a\u7fa9 <code>def f(x: Int): Int = x + 1</code> <code>def f(x), do: x + 1</code> \u578b\u30a2\u30ce\u30c6\u30fc\u30b7\u30e7\u30f3 \u5fc5\u9808/\u63a8\u8ad6 \u30aa\u30d7\u30b7\u30e7\u30f3\uff08@spec\uff09 \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1 <code>case x match { ... }</code> <code>case x do ... end</code> \u307e\u305f\u306f\u95a2\u6570\u7bc0 \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3 <code>.</code> \u30c1\u30a7\u30fc\u30f3 <code>\\|&gt;</code> \u6f14\u7b97\u5b50 \u30ac\u30fc\u30c9 <code>if</code> \u5f0f <code>when</code> \u30ac\u30fc\u30c9\u7bc0 \u30c6\u30b9\u30c8\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af ScalaTest ExUnit \u30a4\u30df\u30e5\u30fc\u30bf\u30d3\u30ea\u30c6\u30a3 <code>val</code> \u3067\u4e0d\u5909 \u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u4e0d\u5909"},{"location":"elixir/part-1/#_3","title":"\u307e\u3068\u3081","text":""},{"location":"elixir/part-1/#part-i_1","title":"Part I \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"elixir/part-1/#_4","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306f\u300c\u4f55\u3092\u3059\u308b\u304b\u300d\u3092\u5ba3\u8a00\u7684\u306b\u8a18\u8ff0\u3059\u308b</li> <li>\u7d14\u7c8b\u95a2\u6570\u306f\u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3059</li> <li>\u526f\u4f5c\u7528\u3092\u907f\u3051\u308b\u3053\u3068\u3067\u30b3\u30fc\u30c9\u306e\u4e88\u6e2c\u53ef\u80fd\u6027\u304c\u5411\u4e0a\u3059\u308b</li> <li>\u30d1\u30a4\u30d7\u6f14\u7b97\u5b50\u3067\u95a2\u6570\u3092\u81ea\u7136\u306b\u9023\u9396\u3067\u304d\u308b</li> <li>\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3067\u30c7\u30fc\u30bf\u306e\u5206\u89e3\u3068\u6761\u4ef6\u5206\u5c90\u3092\u7c21\u6f54\u306b\u8a18\u8ff0</li> <li>\u7d14\u7c8b\u95a2\u6570\u306f\u30c6\u30b9\u30c8\u304c\u975e\u5e38\u306b\u7c21\u5358</li> <li>\u53c2\u7167\u900f\u904e\u6027\u306b\u3088\u308a\u3001\u30b3\u30fc\u30c9\u306e\u7406\u89e3\u3068\u63a8\u8ad6\u304c\u5bb9\u6613\u306b\u306a\u308b</li> </ol>"},{"location":"elixir/part-1/#elixir","title":"Elixir \u306e\u7279\u5fb4","text":"<ul> <li>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf: \u3059\u3079\u3066\u306e\u30c7\u30fc\u30bf\u304c\u4e0d\u5909</li> <li>\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0: \u5f37\u529b\u306a\u30c7\u30fc\u30bf\u5206\u89e3\u6a5f\u80fd</li> <li>\u30d1\u30a4\u30d7\u6f14\u7b97\u5b50: \u95a2\u6570\u5408\u6210\u3092\u8aad\u307f\u3084\u3059\u304f</li> <li>\u8efd\u91cf\u30d7\u30ed\u30bb\u30b9: \u4e26\u884c\u51e6\u7406\u304c\u5f97\u610f\uff08\u5f8c\u306e\u7ae0\u3067\u8a73\u8ff0\uff09</li> <li>OTP: \u5805\u7262\u306a\u30b7\u30b9\u30c6\u30e0\u69cb\u7bc9\u306e\u305f\u3081\u306e\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af</li> </ul>"},{"location":"elixir/part-1/#_5","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part II \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c</li> <li>\u9ad8\u968e\u95a2\u6570\uff08\u95a2\u6570\u3092\u5024\u3068\u3057\u3066\u6271\u3046\uff09</li> <li>Enum \u30e2\u30b8\u30e5\u30fc\u30eb\uff08map, filter, reduce\uff09</li> <li>for \u5185\u5305\u8868\u8a18</li> </ul>"},{"location":"elixir/part-1/#_6","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"elixir/part-1/#1_1","title":"\u554f\u984c 1: \u7d14\u7c8b\u95a2\u6570\u306e\u8b58\u5225","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u306e\u3046\u3061\u3001\u7d14\u7c8b\u95a2\u6570\u306f\u3069\u308c\u3067\u3059\u304b?</p> <pre><code># A\ndef double(x), do: x * 2\n\n# B\ndef increment_counter() do\n  Agent.update(:counter, &amp;(&amp;1 + 1))\n  Agent.get(:counter, &amp; &amp;1)\nend\n\n# C\ndef greet(name), do: \"Hello, #{name}!\"\n\n# D\ndef current_time(), do: DateTime.utc_now()\n</code></pre> \u89e3\u7b54  **A \u3068 C \u306f\u7d14\u7c8b\u95a2\u6570**\u3067\u3059\u3002  - A: \u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3057\u3001\u526f\u4f5c\u7528\u304c\u306a\u3044 - B: Agent \u306e\u72b6\u614b\u3092\u5909\u66f4\u3059\u308b\u526f\u4f5c\u7528\u304c\u3042\u308b\uff08\u4e0d\u7d14\uff09 - C: \u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3057\u3001\u526f\u4f5c\u7528\u304c\u306a\u3044 - D: \u547c\u3073\u51fa\u3059\u305f\u3073\u306b\u7570\u306a\u308b\u5024\u3092\u8fd4\u3059\uff08\u4e0d\u7d14\uff09"},{"location":"elixir/part-1/#2_1","title":"\u554f\u984c 2: \u30d1\u30a4\u30d7\u6f14\u7b97\u5b50\u3067\u66f8\u304d\u63db\u3048","text":"<p>\u4ee5\u4e0b\u306e\u30cd\u30b9\u30c8\u3057\u305f\u95a2\u6570\u547c\u3073\u51fa\u3057\u3092\u30d1\u30a4\u30d7\u6f14\u7b97\u5b50\u3092\u4f7f\u3063\u3066\u66f8\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>String.trim(String.downcase(String.reverse(\"  HELLO  \")))\n</code></pre> \u89e3\u7b54 <pre><code>\"  HELLO  \"\n|&gt; String.reverse()\n|&gt; String.downcase()\n|&gt; String.trim()\n</code></pre>  \u7d50\u679c: `\"olleh\"`"},{"location":"elixir/part-1/#3","title":"\u554f\u984c 3: \u30c6\u30b9\u30c8\u3092\u66f8\u304f","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u306b\u5bfe\u3059\u308b\u30c6\u30b9\u30c8\u30b1\u30fc\u30b9\u3092\u8003\u3048\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>def is_even?(n), do: rem(n, 2) == 0\n</code></pre> \u89e3\u7b54 <pre><code>defmodule IsEvenTest do\n  use ExUnit.Case\n\n  test \"\u5076\u6570\u306e\u5834\u5408 true \u3092\u8fd4\u3059\" do\n    assert is_even?(0) == true\n    assert is_even?(2) == true\n    assert is_even?(4) == true\n  end\n\n  test \"\u5947\u6570\u306e\u5834\u5408 false \u3092\u8fd4\u3059\" do\n    assert is_even?(1) == false\n    assert is_even?(3) == false\n  end\n\n  test \"\u8ca0\u306e\u5076\u6570\u3082 true \u3092\u8fd4\u3059\" do\n    assert is_even?(-2) == true\n  end\n\n  test \"\u8ca0\u306e\u5947\u6570\u3082 false \u3092\u8fd4\u3059\" do\n    assert is_even?(-3) == false\n  end\nend\n</code></pre>"},{"location":"elixir/part-1/#4","title":"\u554f\u984c 4: \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3067\u5b9f\u88c5","text":"<p>\u30ea\u30b9\u30c8\u306e2\u756a\u76ee\u306e\u8981\u7d20\u3092\u53d6\u5f97\u3059\u308b\u95a2\u6570 <code>second/1</code> \u3092\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3067\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> \u89e3\u7b54 <pre><code>def second([]), do: {:error, :empty_list}\ndef second([_]), do: {:error, :too_short}\ndef second([_, second | _]), do: {:ok, second}\n\n# \u4f7f\u7528\u4f8b\niex&gt; second([1, 2, 3])\n{:ok, 2}\n\niex&gt; second([1])\n{:error, :too_short}\n\niex&gt; second([])\n{:error, :empty_list}\n</code></pre>"},{"location":"elixir/part-2/","title":"Part II: \u95a2\u6570\u578b\u30b9\u30bf\u30a4\u30eb\u306e\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u6838\u5fc3\u3068\u306a\u308b\u30c6\u30af\u30cb\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059\u3002\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c\u3001\u9ad8\u968e\u95a2\u6570\u3001\u305d\u3057\u3066 <code>flat_map</code> \u3068 for \u5185\u5305\u8868\u8a18\u306b\u3088\u308b\u8907\u96d1\u306a\u30c7\u30fc\u30bf\u5909\u63db\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"elixir/part-2/#3","title":"\u7b2c3\u7ae0: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c","text":""},{"location":"elixir/part-2/#31","title":"3.1 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u3068\u306f","text":"<p>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\uff08\u4e0d\u5909\uff09\u3068\u306f\u3001\u4e00\u5ea6\u4f5c\u6210\u3055\u308c\u305f\u30c7\u30fc\u30bf\u304c\u5909\u66f4\u3055\u308c\u306a\u3044\u3053\u3068\u3092\u610f\u5473\u3057\u307e\u3059\u3002Elixir \u3067\u306f\u3059\u3079\u3066\u306e\u30c7\u30fc\u30bf\u304c\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u3067\u3059\u3002\u30c7\u30fc\u30bf\u3092\u300c\u5909\u66f4\u300d\u3059\u308b\u4ee3\u308f\u308a\u306b\u3001\u65b0\u3057\u3044\u30c7\u30fc\u30bf\u3092\u300c\u4f5c\u6210\u300d\u3057\u307e\u3059\u3002</p> <p></p>"},{"location":"elixir/part-2/#32","title":"3.2 \u30ea\u30b9\u30c8\u306e\u57fa\u672c\u64cd\u4f5c","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/elixir/lib/ch03/immutable_data.ex</code></p>"},{"location":"elixir/part-2/#_1","title":"\u8981\u7d20\u306e\u8ffd\u52a0","text":"<pre><code># \u672b\u5c3e\u306b\u8ffd\u52a0\ndef append(list, element), do: list ++ [element]\n\n# \u5148\u982d\u306b\u8ffd\u52a0\uff08\u52b9\u7387\u7684\uff09\ndef prepend(list, element), do: [element | list]\n\n# \u4f7f\u7528\u4f8b\niex&gt; append([\"Apple\", \"Book\"], \"Mango\")\n[\"Apple\", \"Book\", \"Mango\"]\n\niex&gt; prepend([\"Apple\", \"Book\"], \"Mango\")\n[\"Mango\", \"Apple\", \"Book\"]\n</code></pre>"},{"location":"elixir/part-2/#_2","title":"\u30b9\u30e9\u30a4\u30b9\u64cd\u4f5c","text":"<pre><code># \u6700\u521d\u306e N \u8981\u7d20\ndef first_n(list, n), do: Enum.take(list, n)\n\n# \u6700\u5f8c\u306e N \u8981\u7d20\ndef last_n(list, n), do: Enum.take(list, -n)\n\n# \u6700\u521d\u306e N \u8981\u7d20\u3092\u9664\u304f\ndef drop_first_n(list, n), do: Enum.drop(list, n)\n\n# \u4f7f\u7528\u4f8b\niex&gt; first_n([\"a\", \"b\", \"c\", \"d\"], 2)\n[\"a\", \"b\"]\n\niex&gt; last_n([\"a\", \"b\", \"c\", \"d\"], 2)\n[\"c\", \"d\"]\n</code></pre>"},{"location":"elixir/part-2/#33","title":"3.3 \u30ea\u30b9\u30c8\u306e\u5909\u63db\u4f8b","text":"<pre><code># \u6700\u521d\u306e2\u8981\u7d20\u3092\u672b\u5c3e\u306b\u79fb\u52d5\ndef move_first_two_to_end(list) do\n  first_two = Enum.take(list, 2)\n  without_first_two = Enum.drop(list, 2)\n  without_first_two ++ first_two\nend\n\niex&gt; move_first_two_to_end([\"a\", \"b\", \"c\"])\n[\"c\", \"a\", \"b\"]\n\n# \u4e2d\u592e\u306b\u8981\u7d20\u3092\u633f\u5165\ndef insert_at_middle(list, element) do\n  middle = div(length(list), 2)\n  before = Enum.take(list, middle)\n  after_middle = Enum.drop(list, middle)\n  before ++ [element] ++ after_middle\nend\n\niex&gt; insert_at_middle([\"a\", \"b\", \"c\", \"d\"], \"X\")\n[\"a\", \"b\", \"X\", \"c\", \"d\"]\n</code></pre>"},{"location":"elixir/part-2/#34","title":"3.4 \u65c5\u7a0b\u306e\u518d\u8a08\u753b","text":"<p>\u65c5\u884c\u306e\u8a08\u753b\u5909\u66f4\u3092\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306b\u884c\u3046\u4f8b\u3067\u3059\u3002</p> <pre><code>def replan(plan, new_city, before_city) do\n  before_city_index = Enum.find_index(plan, &amp;(&amp;1 == before_city))\n  cities_before = Enum.take(plan, before_city_index)\n  cities_after = Enum.drop(plan, before_city_index)\n  cities_before ++ [new_city] ++ cities_after\nend\n\niex&gt; plan_a = [\"Paris\", \"Berlin\", \"Krak\u00f3w\"]\niex&gt; plan_b = replan(plan_a, \"Vienna\", \"Krak\u00f3w\")\n[\"Paris\", \"Berlin\", \"Vienna\", \"Krak\u00f3w\"]\niex&gt; plan_a  # \u5143\u306e\u8a08\u753b\u306f\u5909\u308f\u3089\u306a\u3044!\n[\"Paris\", \"Berlin\", \"Krak\u00f3w\"]\n</code></pre> <p></p>"},{"location":"elixir/part-2/#35","title":"3.5 \u6587\u5b57\u5217\u64cd\u4f5c","text":"<p>\u6587\u5b57\u5217\u3082 Elixir \u3067\u306f\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u3067\u3059\u3002</p> <pre><code>def abbreviate(name) do\n  initial = String.first(name)\n  separator_index = :binary.match(name, \" \")\n\n  case separator_index do\n    {pos, _} -&gt;\n      last_name = String.slice(name, (pos + 1)..-1//1)\n      \"#{initial}. #{last_name}\"\n    :nomatch -&gt;\n      name\n  end\nend\n\niex&gt; abbreviate(\"Alonzo Church\")\n\"A. Church\"\n</code></pre>"},{"location":"elixir/part-2/#36","title":"3.6 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306e\u5229\u70b9","text":"\u5229\u70b9 \u8aac\u660e \u4e88\u6e2c\u53ef\u80fd\u6027 \u30c7\u30fc\u30bf\u304c\u5909\u308f\u3089\u306a\u3044\u306e\u3067\u8ffd\u8de1\u304c\u5bb9\u6613 \u4e26\u884c\u5b89\u5168\u6027 \u7af6\u5408\u72b6\u614b\u304c\u767a\u751f\u3057\u306a\u3044 \u30c6\u30b9\u30c8\u5bb9\u6613\u6027 \u72b6\u614b\u3092\u6c17\u306b\u305b\u305a\u30c6\u30b9\u30c8\u3067\u304d\u308b \u30c7\u30d0\u30c3\u30b0\u5bb9\u6613\u6027 \u5909\u66f4\u5c65\u6b74\u3092\u8ffd\u3044\u3084\u3059\u3044"},{"location":"elixir/part-2/#4","title":"\u7b2c4\u7ae0: \u95a2\u6570\u3092\u5024\u3068\u3057\u3066\u6271\u3046","text":""},{"location":"elixir/part-2/#41","title":"4.1 \u9ad8\u968e\u95a2\u6570\u3068\u306f","text":"<p>\u9ad8\u968e\u95a2\u6570\uff08Higher-Order Function\uff09\u3068\u306f:</p> <ol> <li>\u95a2\u6570\u3092\u5f15\u6570\u3068\u3057\u3066\u53d7\u3051\u53d6\u308b</li> <li>\u95a2\u6570\u3092\u623b\u308a\u5024\u3068\u3057\u3066\u8fd4\u3059</li> </ol> <p></p>"},{"location":"elixir/part-2/#42-enummap-","title":"4.2 Enum.map - \u5404\u8981\u7d20\u3092\u5909\u63db","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/elixir/lib/ch04/higher_order_functions.ex</code></p> <pre><code># \u9577\u3055\u3092\u53d6\u5f97\niex&gt; Enum.map([\"elixir\", \"rust\", \"ada\"], &amp;String.length/1)\n[6, 4, 3]\n\n# 2\u500d\u306b\u3059\u308b\niex&gt; Enum.map([5, 1, 2, 4, 0], &amp;(&amp;1 * 2))\n[10, 2, 4, 8, 0]\n\n# \u7701\u7565\u8a18\u6cd5\uff08\u30ad\u30e3\u30d7\u30c1\u30e3\u6f14\u7b97\u5b50\uff09\niex&gt; Enum.map([1, 2, 3], &amp;(&amp;1 * 2))\n[2, 4, 6]\n</code></pre> <p></p>"},{"location":"elixir/part-2/#43-enumfilter-","title":"4.3 Enum.filter - \u6761\u4ef6\u306b\u5408\u3046\u8981\u7d20\u3092\u62bd\u51fa","text":"<pre><code># \u5947\u6570\u3092\u62bd\u51fa\niex&gt; Enum.filter([5, 1, 2, 4, 0], &amp;(rem(&amp;1, 2) == 1))\n[5, 1]\n\n# 4\u3088\u308a\u5927\u304d\u3044\u8981\u7d20\niex&gt; Enum.filter([5, 1, 2, 4, 0], &amp;(&amp;1 &gt; 4))\n[5]\n</code></pre>"},{"location":"elixir/part-2/#44-enumreduce-","title":"4.4 Enum.reduce - \u7573\u307f\u8fbc\u307f","text":"<pre><code># \u5408\u8a08\niex&gt; Enum.reduce([5, 1, 2, 4, 100], 0, &amp;(&amp;1 + &amp;2))\n112\n\n# \u6700\u5927\u5024\niex&gt; Enum.reduce([5, 1, 2, 4, 15], 0, fn i, max -&gt;\n...&gt;   if i &gt; max, do: i, else: max\n...&gt; end)\n15\n</code></pre>"},{"location":"elixir/part-2/#45","title":"4.5 \u95a2\u6570\u3092\u8fd4\u3059\u95a2\u6570","text":"<pre><code># N \u3088\u308a\u5927\u304d\u3044\u304b\u3092\u5224\u5b9a\u3059\u308b\u95a2\u6570\u3092\u8fd4\u3059\ndef larger_than(n), do: fn i -&gt; i &gt; n end\n\niex&gt; larger = larger_than(4)\niex&gt; larger.(5)\ntrue\niex&gt; larger.(3)\nfalse\n\n# \u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u306b\u4f7f\u7528\niex&gt; Enum.filter([5, 1, 2, 4, 0], larger_than(4))\n[5]\n</code></pre>"},{"location":"elixir/part-2/#46","title":"4.6 \u30ef\u30fc\u30c9\u30b9\u30b3\u30a2\u30ea\u30f3\u30b0\u306e\u4f8b","text":"<p>\u8907\u6570\u306e\u30b9\u30b3\u30a2\u30ea\u30f3\u30b0\u30ed\u30b8\u30c3\u30af\u3092\u7d44\u307f\u5408\u308f\u305b\u308b\u4f8b\u3067\u3059\u3002</p> <pre><code>def score(word), do: word |&gt; String.replace(\"a\", \"\") |&gt; String.length()\ndef bonus(word), do: if String.contains?(word, \"c\"), do: 5, else: 0\ndef penalty(word), do: if String.contains?(word, \"s\"), do: 7, else: 0\n\n# \u30b9\u30b3\u30a2\u95a2\u6570\u3067\u30e9\u30f3\u30ad\u30f3\u30b0\u3092\u4f5c\u6210\ndef ranked_words(word_score, words) do\n  words\n  |&gt; Enum.sort_by(word_score)\n  |&gt; Enum.reverse()\nend\n\nwords = [\"ada\", \"haskell\", \"scala\", \"java\", \"rust\"]\n\n# \u57fa\u672c\u30b9\u30b3\u30a2\u3067\u30e9\u30f3\u30ad\u30f3\u30b0\nranked_words(&amp;score/1, words)\n# [\"haskell\", \"rust\", \"scala\", \"java\", \"ada\"]\n\n# \u30dc\u30fc\u30ca\u30b9\u4ed8\u304d\u30b9\u30b3\u30a2\u3067\u30e9\u30f3\u30ad\u30f3\u30b0\nranked_words(fn w -&gt; score(w) + bonus(w) end, words)\n# [\"scala\", \"haskell\", \"rust\", \"java\", \"ada\"]\n\n# \u30dc\u30fc\u30ca\u30b9\u3068\u30da\u30ca\u30eb\u30c6\u30a3\u4ed8\u304d\u30b9\u30b3\u30a2\u3067\u30e9\u30f3\u30ad\u30f3\u30b0\nranked_words(fn w -&gt; score(w) + bonus(w) - penalty(w) end, words)\n# [\"java\", \"scala\", \"ada\", \"haskell\", \"rust\"]\n</code></pre>"},{"location":"elixir/part-2/#47-elixir","title":"4.7 Elixir \u306e\u30ad\u30e3\u30d7\u30c1\u30e3\u6f14\u7b97\u5b50","text":"<p>Elixir \u3067\u306f <code>&amp;</code> \u3092\u4f7f\u3063\u3066\u95a2\u6570\u3092\u7c21\u6f54\u306b\u53c2\u7167\u30fb\u5b9a\u7fa9\u3067\u304d\u307e\u3059\u3002</p> <pre><code># \u540d\u524d\u4ed8\u304d\u95a2\u6570\u306e\u53c2\u7167\n&amp;String.length/1\n\n# \u7121\u540d\u95a2\u6570\u306e\u77ed\u7e2e\u5f62\n&amp;(&amp;1 * 2)          # fn x -&gt; x * 2 end \u3068\u540c\u7b49\n&amp;(&amp;1 + &amp;2)         # fn a, b -&gt; a + b end \u3068\u540c\u7b49\n&amp;String.upcase(&amp;1) # fn s -&gt; String.upcase(s) end \u3068\u540c\u7b49\n</code></pre>"},{"location":"elixir/part-2/#5-flat_map","title":"\u7b2c5\u7ae0: flat_map \u3068\u30cd\u30b9\u30c8\u69cb\u9020","text":""},{"location":"elixir/part-2/#51-flatten-flat_map","title":"5.1 flatten \u3068 flat_map","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/elixir/lib/ch05/flat_map_and_comprehensions.ex</code></p>"},{"location":"elixir/part-2/#listflatten-","title":"List.flatten - \u30cd\u30b9\u30c8\u3057\u305f\u30ea\u30b9\u30c8\u3092\u5e73\u5766\u5316","text":"<pre><code>iex&gt; List.flatten([[1, 2], [3], [4, 5]])\n[1, 2, 3, 4, 5]\n\n# \u66f8\u7c4d\u30ea\u30b9\u30c8\u304b\u3089\u5168\u8457\u8005\u3092\u62bd\u51fa\nbooks = [\n  %{title: \"FP in Scala\", authors: [\"Chiusano\", \"Bjarnason\"]},\n  %{title: \"The Hobbit\", authors: [\"Tolkien\"]}\n]\n\nbooks\n|&gt; Enum.map(&amp; &amp;1.authors)\n|&gt; List.flatten()\n# [\"Chiusano\", \"Bjarnason\", \"Tolkien\"]\n</code></pre>"},{"location":"elixir/part-2/#enumflat_map-map-flatten","title":"Enum.flat_map = map + flatten","text":"<pre><code># map \u3057\u3066 flatten\nbooks |&gt; Enum.map(&amp; &amp;1.authors) |&gt; List.flatten()\n\n# flat_map \u3067\u540c\u3058\u3053\u3068\u30921\u884c\u3067\nbooks |&gt; Enum.flat_map(&amp; &amp;1.authors)\n# [\"Chiusano\", \"Bjarnason\", \"Tolkien\"]\n</code></pre>"},{"location":"elixir/part-2/#52-flat_map","title":"5.2 flat_map \u306b\u3088\u308b\u30ea\u30b9\u30c8\u30b5\u30a4\u30ba\u306e\u5909\u5316","text":"<pre><code># \u8981\u7d20\u6570\u304c\u5897\u3048\u308b\nEnum.flat_map([1, 2, 3], fn i -&gt; [i, i + 10] end)\n# [1, 11, 2, 12, 3, 13] - 6\u8981\u7d20\n\n# \u8981\u7d20\u6570\u304c\u540c\u3058\nEnum.flat_map([1, 2, 3], fn i -&gt; [i * 2] end)\n# [2, 4, 6] - 3\u8981\u7d20\n\n# \u8981\u7d20\u6570\u304c\u6e1b\u308b\uff08\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u52b9\u679c\uff09\nEnum.flat_map([1, 2, 3], fn i -&gt;\n  if rem(i, 2) == 0, do: [i], else: []\nend)\n# [2] - 1\u8981\u7d20\n</code></pre>"},{"location":"elixir/part-2/#53-flat_map","title":"5.3 \u30cd\u30b9\u30c8\u3057\u305f flat_map","text":"<p>\u8907\u6570\u306e\u30ea\u30b9\u30c8\u3092\u7d44\u307f\u5408\u308f\u305b\u308b\u5834\u5408\u3001flat_map \u3092\u30cd\u30b9\u30c8\u3057\u307e\u3059\u3002</p> <pre><code>defmodule Book do\n  defstruct [:title, :authors]\nend\n\ndefmodule Movie do\n  defstruct [:title]\nend\n\ndef book_adaptations(\"Tolkien\") do\n  [%Movie{title: \"An Unexpected Journey\"}, %Movie{title: \"The Desolation of Smaug\"}]\nend\ndef book_adaptations(_), do: []\n\nbooks = [\n  %Book{title: \"FP in Scala\", authors: [\"Chiusano\", \"Bjarnason\"]},\n  %Book{title: \"The Hobbit\", authors: [\"Tolkien\"]}\n]\n\n# \u30cd\u30b9\u30c8\u3057\u305f flat_map\nEnum.flat_map(books, fn book -&gt;\n  Enum.flat_map(book.authors, fn author -&gt;\n    Enum.map(book_adaptations(author), fn movie -&gt;\n      \"You may like #{movie.title}, because you liked #{author}'s #{book.title}\"\n    end)\n  end)\nend)\n# [\"You may like An Unexpected Journey, because you liked Tolkien's The Hobbit\",\n#  \"You may like The Desolation of Smaug, because you liked Tolkien's The Hobbit\"]\n</code></pre>"},{"location":"elixir/part-2/#54-for","title":"5.4 for \u5185\u5305\u8868\u8a18","text":"<p>\u30cd\u30b9\u30c8\u3057\u305f flat_map \u306f for \u5185\u5305\u8868\u8a18\u3067\u8aad\u307f\u3084\u3059\u304f\u66f8\u3051\u307e\u3059\u3002</p> <pre><code># flat_map/map \u7248\nEnum.flat_map(books, fn book -&gt;\n  Enum.flat_map(book.authors, fn author -&gt;\n    Enum.map(book_adaptations(author), fn movie -&gt;\n      \"You may like #{movie.title}, because you liked #{author}'s #{book.title}\"\n    end)\n  end)\nend)\n\n# for \u5185\u5305\u8868\u8a18\u7248\uff08\u7b49\u4fa1\uff09\nfor book &lt;- books,\n    author &lt;- book.authors,\n    movie &lt;- book_adaptations(author) do\n  \"You may like #{movie.title}, because you liked #{author}'s #{book.title}\"\nend\n</code></pre> <p></p>"},{"location":"elixir/part-2/#55","title":"5.5 \u30ac\u30fc\u30c9\u5f0f\u306b\u3088\u308b\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0","text":"<p>for \u5185\u5305\u8868\u8a18\u3067\u306f\u6761\u4ef6\u3067\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u3082\u3067\u304d\u307e\u3059\u3002</p> <pre><code>defmodule Point do\n  defstruct [:x, :y]\nend\n\ndef inside?(%Point{x: x, y: y}, radius) do\n  radius * radius &gt;= x * x + y * y\nend\n\npoints = [%Point{x: 5, y: 2}, %Point{x: 1, y: 1}]\nradiuses = [2, 1]\n\n# \u5168\u7d44\u307f\u5408\u308f\u305b\u3092\u751f\u6210\nfor r &lt;- radiuses,\n    point &lt;- points do\n  \"Point(#{point.x}, #{point.y}) is within a radius of #{r}: #{inside?(point, r)}\"\nend\n\n# \u5186\u5185\u306e\u70b9\u306e\u307f\u62bd\u51fa\uff08\u30ac\u30fc\u30c9\u5f0f\u4f7f\u7528\uff09\nfor r &lt;- radiuses,\n    point &lt;- points,\n    inside?(point, r) do  # \u30d5\u30a3\u30eb\u30bf\u6761\u4ef6\n  \"Point(#{point.x}, #{point.y}) is within a radius of #{r}\"\nend\n# [\"Point(1, 1) is within a radius of 2\"]\n</code></pre>"},{"location":"elixir/part-2/#56-for","title":"5.6 for \u5185\u5305\u8868\u8a18\u3068\u7d50\u679c\u306e\u578b","text":"<p>Elixir \u306e for \u5185\u5305\u8868\u8a18\u306f <code>into:</code> \u30aa\u30d7\u30b7\u30e7\u30f3\u3067\u51fa\u529b\u5148\u3092\u5909\u66f4\u3067\u304d\u307e\u3059\u3002</p> <pre><code># \u30c7\u30d5\u30a9\u30eb\u30c8: \u30ea\u30b9\u30c8\u3092\u8fd4\u3059\nfor i &lt;- [1, 2, 3], do: i * 2\n# [2, 4, 6]\n\n# MapSet \u3092\u8fd4\u3059\nfor item &lt;- [1, 2, 2, 3], into: MapSet.new(), do: item\n# MapSet.new([1, 2, 3])\n\n# Map \u3092\u8fd4\u3059\nfor s &lt;- [\"a\", \"bb\", \"ccc\"], into: %{}, do: {s, String.length(s)}\n# %{\"a\" =&gt; 1, \"bb\" =&gt; 2, \"ccc\" =&gt; 3}\n\n# \u6587\u5b57\u5217\u3092\u8fd4\u3059\nfor &lt;&lt;c &lt;- \"hello\"&gt;&gt;, into: \"\", do: &lt;&lt;c + 1&gt;&gt;\n# \"ifmmp\"\n</code></pre> <p></p>"},{"location":"elixir/part-2/#scala-vs-elixir","title":"Scala vs Elixir \u6bd4\u8f03","text":"\u64cd\u4f5c Scala Elixir \u672b\u5c3e\u8ffd\u52a0 <code>list.appended(x)</code> <code>list ++ [x]</code> \u5148\u982d\u8ffd\u52a0 <code>x :: list</code> <code>[x \\| list]</code> \u30b9\u30e9\u30a4\u30b9 <code>list.slice(a, b)</code> <code>Enum.slice(list, a, b-a)</code> map <code>list.map(f)</code> <code>Enum.map(list, f)</code> filter <code>list.filter(f)</code> <code>Enum.filter(list, f)</code> foldLeft <code>list.foldLeft(init)(f)</code> <code>Enum.reduce(list, init, f)</code> flatMap <code>list.flatMap(f)</code> <code>Enum.flat_map(list, f)</code> flatten <code>list.flatten</code> <code>List.flatten(list)</code> for \u5185\u5305\u8868\u8a18 <code>for { x &lt;- xs } yield f(x)</code> <code>for x &lt;- xs, do: f(x)</code>"},{"location":"elixir/part-2/#_3","title":"\u307e\u3068\u3081","text":""},{"location":"elixir/part-2/#part-ii_1","title":"Part II \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"elixir/part-2/#_4","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"\u7ae0 \u4e3b\u8981\u6982\u5ff5 \u30ad\u30fc\u64cd\u4f5c \u7b2c3\u7ae0 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb <code>++</code>, <code>Enum.take</code>, <code>Enum.drop</code>, <code>Enum.slice</code> \u7b2c4\u7ae0 \u9ad8\u968e\u95a2\u6570 <code>Enum.map</code>, <code>Enum.filter</code>, <code>Enum.reduce</code>, <code>Enum.sort_by</code> \u7b2c5\u7ae0 \u5e73\u5766\u5316 <code>List.flatten</code>, <code>Enum.flat_map</code>, <code>for</code> \u5185\u5305\u8868\u8a18"},{"location":"elixir/part-2/#_5","title":"\u91cd\u8981\u306a\u6cd5\u5247","text":"<ol> <li>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf: \u5143\u306e\u30c7\u30fc\u30bf\u306f\u5909\u66f4\u305b\u305a\u3001\u65b0\u3057\u3044\u30c7\u30fc\u30bf\u3092\u4f5c\u6210\u3059\u308b</li> <li>\u95a2\u6570\u306f\u5024: \u95a2\u6570\u3092\u5f15\u6570\u3068\u3057\u3066\u6e21\u3057\u305f\u308a\u3001\u623b\u308a\u5024\u3068\u3057\u3066\u8fd4\u3057\u305f\u308a\u3067\u304d\u308b</li> <li>flat_map \u30d1\u30bf\u30fc\u30f3: \u30cd\u30b9\u30c8\u3057\u305f\u69cb\u9020\u3092\u5e73\u5766\u5316\u3057\u306a\u304c\u3089\u5909\u63db\u3059\u308b</li> <li>for \u5185\u5305\u8868\u8a18: flat_map/map \u306e\u7cd6\u8863\u69cb\u6587\u3068\u3057\u3066\u4f7f\u3048\u308b</li> <li>\u30d1\u30a4\u30d7\u6f14\u7b97\u5b50: \u30c7\u30fc\u30bf\u5909\u63db\u3092\u8aad\u307f\u3084\u3059\u304f\u9023\u9396\u3055\u305b\u308b</li> </ol>"},{"location":"elixir/part-2/#_6","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part III \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li>nil \u306e\u5b89\u5168\u306a\u6271\u3044</li> <li><code>{:ok, value}</code> / <code>{:error, reason}</code> \u30d1\u30bf\u30fc\u30f3</li> <li><code>with</code> \u5f0f\u306b\u3088\u308b\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0</li> </ul>"},{"location":"elixir/part-2/#_7","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"elixir/part-2/#1","title":"\u554f\u984c 1: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u64cd\u4f5c","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u30ea\u30b9\u30c8\u306e\u6700\u521d\u3068\u6700\u5f8c\u306e\u8981\u7d20\u3092\u5165\u308c\u66ff\u3048\u308b\u95a2\u6570\u3067\u3059\u3002</p> <pre><code>def swap_first_last(list)\n\n# \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nswap_first_last([1, 2, 3, 4]) == [4, 2, 3, 1]\nswap_first_last([1, 2]) == [2, 1]\n</code></pre> \u89e3\u7b54 <pre><code>def swap_first_last([]), do: []\ndef swap_first_last([x]), do: [x]\ndef swap_first_last([first | rest]) do\n  last = List.last(rest)\n  middle = Enum.drop(rest, -1)\n  [last | middle] ++ [first]\nend\n</code></pre>"},{"location":"elixir/part-2/#2","title":"\u554f\u984c 2: \u9ad8\u968e\u95a2\u6570","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u6761\u4ef6\u3092\u6e80\u305f\u3059\u8981\u7d20\u306e\u6570\u3092\u30ab\u30a6\u30f3\u30c8\u3059\u308b\u95a2\u6570\u3067\u3059\u3002</p> <pre><code>def count_where(list, predicate)\n\n# \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\ncount_where([1, 2, 3, 4, 5], &amp;(&amp;1 &gt; 3)) == 2\ncount_where([\"a\", \"bb\", \"ccc\"], &amp;(String.length(&amp;1) &gt; 1)) == 2\n</code></pre> \u89e3\u7b54 <pre><code>def count_where(list, predicate) do\n  Enum.count(list, predicate)\nend\n\n# \u307e\u305f\u306f filter \u3092\u4f7f\u3063\u3066\ndef count_where(list, predicate) do\n  list |&gt; Enum.filter(predicate) |&gt; length()\nend\n\n# \u307e\u305f\u306f reduce \u3092\u4f7f\u3063\u3066\ndef count_where(list, predicate) do\n  Enum.reduce(list, 0, fn elem, count -&gt;\n    if predicate.(elem), do: count + 1, else: count\n  end)\nend\n</code></pre>"},{"location":"elixir/part-2/#3-for","title":"\u554f\u984c 3: for \u5185\u5305\u8868\u8a18","text":"<p>\u4ee5\u4e0b\u306e\u30cd\u30b9\u30c8\u3057\u305f flat_map \u3092 for \u5185\u5305\u8868\u8a18\u3067\u66f8\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>Enum.flat_map([1, 2], fn x -&gt;\n  Enum.flat_map([10, 20], fn y -&gt;\n    Enum.map([100, 200], fn z -&gt;\n      x + y + z\n    end)\n  end)\nend)\n</code></pre> \u89e3\u7b54 <pre><code>for x &lt;- [1, 2],\n    y &lt;- [10, 20],\n    z &lt;- [100, 200] do\n  x + y + z\nend\n\n# \u7d50\u679c: [111, 211, 121, 221, 112, 212, 122, 222]\n</code></pre>"},{"location":"elixir/part-2/#4-flat_map","title":"\u554f\u984c 4: flat_map \u306b\u3088\u308b\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0","text":"<p>for \u5185\u5305\u8868\u8a18\u306e\u30ac\u30fc\u30c9\u5f0f\u3092\u4f7f\u308f\u305a\u306b\u3001flat_map \u3060\u3051\u3067\u5076\u6570\u306e\u307f\u3092\u62bd\u51fa\u3059\u308b\u30b3\u30fc\u30c9\u3092\u66f8\u3044\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>numbers = [1, 2, 3, 4, 5, 6]\n# \u5076\u6570\u306e\u307f\u3092\u62bd\u51fa: [2, 4, 6]\n</code></pre> \u89e3\u7b54 <pre><code>Enum.flat_map(numbers, fn n -&gt;\n  if rem(n, 2) == 0, do: [n], else: []\nend)\n\n# \u307e\u305f\u306f\u95a2\u6570\u306b\u5206\u96e2\ndef even_filter(n) do\n  if rem(n, 2) == 0, do: [n], else: []\nend\n\nEnum.flat_map(numbers, &amp;even_filter/1)\n</code></pre>"},{"location":"elixir/part-3/","title":"Part III: \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3068 nil / Result \u30d1\u30bf\u30fc\u30f3","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3092\u5b66\u3073\u307e\u3059\u3002\u4f8b\u5916\u306b\u983c\u3089\u305a\u3001<code>nil</code> \u3068 <code>{:ok, value} / {:error, reason}</code> \u30d1\u30bf\u30fc\u30f3\u3092\u4f7f\u3063\u3066\u578b\u5b89\u5168\u306b\u30a8\u30e9\u30fc\u3092\u6271\u3046\u65b9\u6cd5\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"elixir/part-3/#6-nil","title":"\u7b2c6\u7ae0: nil \u306e\u5b89\u5168\u306a\u6271\u3044","text":""},{"location":"elixir/part-3/#61-nil","title":"6.1 \u306a\u305c nil \u3092\u5b89\u5168\u306b\u6271\u3046\u5fc5\u8981\u304c\u3042\u308b\u304b","text":"<p>\u5f93\u6765\u306e\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u306b\u306f\u554f\u984c\u304c\u3042\u308a\u307e\u3059\u3002</p> <p></p>"},{"location":"elixir/part-3/#62-elixir-nil","title":"6.2 Elixir \u306b\u304a\u3051\u308b nil","text":"<p>Elixir \u3067\u306f <code>nil</code> \u306f\u7279\u5225\u306a\u5024\u3068\u3057\u3066\u6271\u308f\u308c\u307e\u3059\u3002Scala \u306e <code>Option</code> \u306e\u3088\u3046\u306a\u5c02\u7528\u306e\u578b\u306f\u3042\u308a\u307e\u305b\u3093\u304c\u3001\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3068 <code>with</code> \u5f0f\u3092\u4f7f\u3063\u3066\u5b89\u5168\u306b\u6271\u3048\u307e\u3059\u3002</p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/elixir/lib/ch06/nil_handling.ex</code></p>"},{"location":"elixir/part-3/#63-tv","title":"6.3 TV\u756a\u7d44\u306e\u30d1\u30fc\u30b9\u4f8b","text":"<p>TV\u756a\u7d44\u306e\u6587\u5b57\u5217\u3092\u30d1\u30fc\u30b9\u3059\u308b\u4f8b\u3067 nil \u306e\u5b89\u5168\u306a\u6271\u3044\u65b9\u3092\u5b66\u3073\u307e\u3059\u3002</p> <pre><code>defmodule TvShow do\n  defstruct [:title, :start, :end_year]\nend\n\n# \u5165\u529b\u4f8b: \"Breaking Bad (2008-2013)\"\n# \u671f\u5f85\u3059\u308b\u51fa\u529b: %TvShow{title: \"Breaking Bad\", start: 2008, end_year: 2013}\n</code></pre>"},{"location":"elixir/part-3/#_1","title":"\u4f8b\u5916\u3092\u4f7f\u3046\u65b9\u6cd5\uff08\u554f\u984c\u3042\u308a\uff09","text":"<pre><code>def parse_show_unsafe!(raw_show) do\n  bracket_open = find_index(raw_show, \"(\")\n  bracket_close = find_index(raw_show, \")\")\n  dash = find_index(raw_show, \"-\")\n\n  name = raw_show |&gt; String.slice(0, bracket_open) |&gt; String.trim()\n  year_start = raw_show |&gt; String.slice((bracket_open + 1)..(dash - 1)) |&gt; String.to_integer()\n  year_end = raw_show |&gt; String.slice((dash + 1)..(bracket_close - 1)) |&gt; String.to_integer()\n\n  %TvShow{title: name, start: year_start, end_year: year_end}\nend\n\n# \u6b63\u5e38\u30b1\u30fc\u30b9\nparse_show_unsafe!(\"Breaking Bad (2008-2013)\")\n# =&gt; %TvShow{title: \"Breaking Bad\", start: 2008, end_year: 2013}\n\n# \u7570\u5e38\u30b1\u30fc\u30b9 \u2192 \u4f8b\u5916\u304c\u30b9\u30ed\u30fc\u3055\u308c\u308b!\nparse_show_unsafe!(\"Chernobyl (2019)\")    # FunctionClauseError\nparse_show_unsafe!(\"The Wire 2002-2008\")  # FunctionClauseError\n</code></pre>"},{"location":"elixir/part-3/#nil","title":"nil \u3092\u8fd4\u3059\u5b89\u5168\u306a\u65b9\u6cd5","text":"<pre><code>def parse_show(raw_show) do\n  name = extract_name(raw_show)\n  year_start = or_else(extract_year_start(raw_show), fn -&gt; extract_single_year(raw_show) end)\n  year_end = or_else(extract_year_end(raw_show), fn -&gt; extract_single_year(raw_show) end)\n\n  if name &amp;&amp; year_start &amp;&amp; year_end do\n    %TvShow{title: name, start: year_start, end_year: year_end}\n  else\n    nil\n  end\nend\n\n# \u6b63\u5e38\u30b1\u30fc\u30b9\nparse_show(\"Breaking Bad (2008-2013)\")\n# =&gt; %TvShow{title: \"Breaking Bad\", start: 2008, end_year: 2013}\n\n# \u7570\u5e38\u30b1\u30fc\u30b9 \u2192 nil \u304c\u8fd4\u3055\u308c\u308b\uff08\u4f8b\u5916\u306a\u3057\uff09\nparse_show(\"The Wire 2002-2008\")  # =&gt; nil\n</code></pre>"},{"location":"elixir/part-3/#64","title":"6.4 \u5c0f\u3055\u306a\u95a2\u6570\u304b\u3089\u7d44\u307f\u7acb\u3066\u308b","text":"<p>\u8907\u96d1\u306a\u30d1\u30fc\u30b9\u51e6\u7406\u3092\u5c0f\u3055\u306a\u95a2\u6570\u306b\u5206\u89e3\u3057\u307e\u3059\u3002</p> <pre><code># \u540d\u524d\u3092\u62bd\u51fa\ndef extract_name(raw_show) do\n  bracket_open = find_index(raw_show, \"(\")\n\n  if bracket_open &gt; 0 do\n    raw_show |&gt; String.slice(0, bracket_open) |&gt; String.trim()\n  else\n    nil\n  end\nend\n\n# \u958b\u59cb\u5e74\u3092\u62bd\u51fa\uff08with \u5f0f\u3092\u4f7f\u7528\uff09\ndef extract_year_start(raw_show) do\n  bracket_open = find_index(raw_show, \"(\")\n  dash = find_index(raw_show, \"-\")\n\n  with true &lt;- bracket_open != -1 &amp;&amp; dash &gt; bracket_open + 1,\n       year_str &lt;- String.slice(raw_show, (bracket_open + 1)..(dash - 1)),\n       {year, \"\"} &lt;- Integer.parse(year_str) do\n    year\n  else\n    _ -&gt; nil\n  end\nend\n\n# \u7d42\u4e86\u5e74\u3092\u62bd\u51fa\ndef extract_year_end(raw_show) do\n  dash = find_index(raw_show, \"-\")\n  bracket_close = find_index(raw_show, \")\")\n\n  with true &lt;- dash != -1 &amp;&amp; bracket_close &gt; dash + 1,\n       year_str &lt;- String.slice(raw_show, (dash + 1)..(bracket_close - 1)),\n       {year, \"\"} &lt;- Integer.parse(year_str) do\n    year\n  else\n    _ -&gt; nil\n  end\nend\n</code></pre> <p></p>"},{"location":"elixir/part-3/#65-or_else","title":"6.5 or_else \u306b\u3088\u308b\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af","text":"<p><code>or_else</code> \u3092\u4f7f\u3063\u3066\u3001\u6700\u521d\u306e\u5024\u304c <code>nil</code> \u306e\u5834\u5408\u306b\u4ee3\u66ff\u3092\u8a66\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>def or_else(nil, fallback) when is_function(fallback, 0), do: fallback.()\ndef or_else(nil, fallback), do: fallback\ndef or_else(value, _fallback), do: value\n\n# \u4f7f\u7528\u4f8b\nor_else(10, 42)     # =&gt; 10\uff08\u5024\u304c\u3042\u308b\u306e\u3067\u305d\u306e\u307e\u307e\uff09\nor_else(nil, 42)    # =&gt; 42\uff08nil \u306a\u306e\u3067\u4ee3\u66ff\u3092\u4f7f\u7528\uff09\nor_else(nil, fn -&gt; 100 end)  # =&gt; 100\uff08\u9045\u5ef6\u8a55\u4fa1\uff09\n</code></pre>"},{"location":"elixir/part-3/#_2","title":"\u5358\u5e74\u306e\u756a\u7d44\u306b\u5bfe\u5fdc\u3059\u308b","text":"<p>\u300cChernobyl (2019)\u300d\u306e\u3088\u3046\u306a\u5358\u5e74\u306e\u756a\u7d44\u3092\u30d1\u30fc\u30b9\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002</p> <pre><code>def extract_single_year(raw_show) do\n  dash = find_index(raw_show, \"-\")\n  bracket_open = find_index(raw_show, \"(\")\n  bracket_close = find_index(raw_show, \")\")\n\n  with true &lt;- dash == -1 &amp;&amp; bracket_open != -1 &amp;&amp; bracket_close &gt; bracket_open + 1,\n       year_str &lt;- String.slice(raw_show, (bracket_open + 1)..(bracket_close - 1)),\n       {year, \"\"} &lt;- Integer.parse(year_str) do\n    year\n  else\n    _ -&gt; nil\n  end\nend\n\ndef parse_show(raw_show) do\n  name = extract_name(raw_show)\n  year_start = or_else(extract_year_start(raw_show), fn -&gt; extract_single_year(raw_show) end)\n  year_end = or_else(extract_year_end(raw_show), fn -&gt; extract_single_year(raw_show) end)\n\n  if name &amp;&amp; year_start &amp;&amp; year_end do\n    %TvShow{title: name, start: year_start, end_year: year_end}\n  else\n    nil\n  end\nend\n\n# \u3053\u308c\u3067\u5358\u5e74\u306e\u756a\u7d44\u3082\u30d1\u30fc\u30b9\u3067\u304d\u308b\nparse_show(\"Chernobyl (2019)\")\n# =&gt; %TvShow{title: \"Chernobyl\", start: 2019, end_year: 2019}\n</code></pre> <p></p>"},{"location":"elixir/part-3/#66-nil","title":"6.6 nil \u5b89\u5168\u306a\u64cd\u4f5c\u95a2\u6570","text":"\u95a2\u6570 \u8aac\u660e \u4f8b <code>nil_map</code> \u5024\u304c\u3042\u308c\u3070\u5909\u63db <code>nil_map(5, &amp;(&amp;1 * 2))</code> \u2192 <code>10</code> <code>nil_flat_map</code> \u5024\u304c\u3042\u308c\u3070 nil \u3092\u8fd4\u3059\u53ef\u80fd\u6027\u306e\u3042\u308b\u95a2\u6570\u3092\u9069\u7528 <code>nil_flat_map(5, fn x -&gt; x end)</code> \u2192 <code>5</code> <code>or_else</code> nil \u306a\u3089\u4ee3\u66ff\u3092\u4f7f\u7528 <code>or_else(nil, 5)</code> \u2192 <code>5</code> <code>to_list</code> \u30ea\u30b9\u30c8\u306b\u5909\u63db <code>to_list(5)</code> \u2192 <code>[5]</code>, <code>to_list(nil)</code> \u2192 <code>[]</code> <pre><code># nil_map\ndef nil_map(nil, _func), do: nil\ndef nil_map(value, func), do: func.(value)\n\nnil_map(5, &amp;(&amp;1 * 2))   # =&gt; 10\nnil_map(nil, &amp;(&amp;1 * 2)) # =&gt; nil\n\n# nil_flat_map\ndef nil_flat_map(nil, _func), do: nil\ndef nil_flat_map(value, func), do: func.(value)\n\nnil_flat_map(5, fn x -&gt; if x &gt; 0, do: x * 2, else: nil end)  # =&gt; 10\nnil_flat_map(nil, fn x -&gt; x * 2 end)  # =&gt; nil\n\n# to_list\ndef to_list(nil), do: []\ndef to_list(value), do: [value]\n\nto_list(42)   # =&gt; [42]\nto_list(nil)  # =&gt; []\n</code></pre>"},{"location":"elixir/part-3/#67","title":"6.7 \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u6226\u7565","text":"<p>\u8907\u6570\u306e\u8981\u7d20\u3092\u30d1\u30fc\u30b9\u3059\u308b\u5834\u5408\u30012\u3064\u306e\u6226\u7565\u304c\u3042\u308a\u307e\u3059\u3002</p> <p></p>"},{"location":"elixir/part-3/#best-effort","title":"Best-effort \u6226\u7565","text":"<pre><code>def parse_shows_best_effort(raw_shows) do\n  raw_shows\n  |&gt; Enum.map(&amp;parse_show/1)\n  |&gt; Enum.reject(&amp;is_nil/1)\nend\n\nraw_shows = [\n  \"Breaking Bad (2008-2013)\",\n  \"The Wire 2002 2008\",        # \u7121\u52b9\u306a\u5f62\u5f0f\n  \"Mad Men (2007-2015)\"\n]\n\nparse_shows_best_effort(raw_shows)\n# =&gt; [%TvShow{title: \"Breaking Bad\", ...}, %TvShow{title: \"Mad Men\", ...}]\n# \u7121\u52b9\u306a\u3082\u306e\u306f\u9664\u5916\u3055\u308c\u308b\n</code></pre>"},{"location":"elixir/part-3/#all-or-nothing","title":"All-or-nothing \u6226\u7565","text":"<pre><code>def parse_shows_all_or_nothing(raw_shows) do\n  parsed = Enum.map(raw_shows, &amp;parse_show/1)\n\n  if Enum.any?(parsed, &amp;is_nil/1) do\n    nil\n  else\n    {:ok, parsed}\n  end\nend\n\n# \u5168\u90e8\u6210\u529f \u2192 {:ok, [...]}\nparse_shows_all_or_nothing([\"Breaking Bad (2008-2013)\", \"Mad Men (2007-2015)\"])\n# =&gt; {:ok, [%TvShow{...}, %TvShow{...}]}\n\n# \u4e00\u3064\u3067\u3082\u5931\u6557 \u2192 nil\nparse_shows_all_or_nothing([\"Breaking Bad (2008-2013)\", \"Invalid\"])\n# =&gt; nil\n</code></pre>"},{"location":"elixir/part-3/#68-nil_forall-nil_exists","title":"6.8 nil_forall \u3068 nil_exists","text":"<p>nil \u306b\u5bfe\u3059\u308b\u6761\u4ef6\u5224\u5b9a\u3092\u884c\u3046\u4fbf\u5229\u306a\u95a2\u6570\u3067\u3059\u3002</p> <pre><code># nil_forall - nil \u306f\u5e38\u306b true\uff08\u5b58\u5728\u3057\u306a\u3044\u306e\u3067\u300c\u3059\u3079\u3066\u304c\u771f\u300d\uff09\ndef nil_forall(nil, _predicate), do: true\ndef nil_forall(value, predicate), do: predicate.(value)\n\nnil_forall(5, fn x -&gt; x &gt; 0 end)    # =&gt; true\nnil_forall(nil, fn x -&gt; x &gt; 0 end)  # =&gt; true\nnil_forall(-1, fn x -&gt; x &gt; 0 end)   # =&gt; false\n\n# nil_exists - nil \u306f\u5e38\u306b false\uff08\u5b58\u5728\u3057\u306a\u3044\u306e\u3067\u300c\u5b58\u5728\u3057\u306a\u3044\u300d\uff09\ndef nil_exists(nil, _predicate), do: false\ndef nil_exists(value, predicate), do: predicate.(value)\n\nnil_exists(5, fn x -&gt; x &gt; 0 end)    # =&gt; true\nnil_exists(nil, fn x -&gt; x &gt; 0 end)  # =&gt; false\nnil_exists(-1, fn x -&gt; x &gt; 0 end)   # =&gt; false\n</code></pre>"},{"location":"elixir/part-3/#7-ok-value-error-reason","title":"\u7b2c7\u7ae0: {:ok, value} / {:error, reason} \u30d1\u30bf\u30fc\u30f3\u3068\u4ee3\u6570\u7684\u30c7\u30fc\u30bf\u578b","text":""},{"location":"elixir/part-3/#71-nil","title":"7.1 nil \u306e\u9650\u754c","text":"<p><code>nil</code> \u306f\u300c\u5024\u304c\u3042\u308b\u304b\u306a\u3044\u304b\u300d\u3057\u304b\u8868\u73fe\u3067\u304d\u307e\u305b\u3093\u3002\u306a\u305c\u5931\u6557\u3057\u305f\u306e\u304b\u3092\u4f1d\u3048\u3089\u308c\u307e\u305b\u3093\u3002</p> <p></p>"},{"location":"elixir/part-3/#72-result","title":"7.2 Result \u30d1\u30bf\u30fc\u30f3\u306e\u57fa\u672c","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/elixir/lib/ch07/error_handling.ex</code></p> <p>Elixir \u3067\u306f <code>{:ok, value}</code> \u3068 <code>{:error, reason}</code> \u306e\u30bf\u30d7\u30eb\u3092\u4f7f\u3063\u3066\u30a8\u30e9\u30fc\u3092\u8868\u73fe\u3057\u307e\u3059\u3002</p> <ul> <li><code>{:ok, value}</code>: \u6210\u529f</li> <li><code>{:error, reason}</code>: \u5931\u6557\uff08\u30a8\u30e9\u30fc\u60c5\u5831\u3092\u4fdd\u6301\uff09</li> </ul> <pre><code>def extract_name(raw_show) do\n  bracket_open = find_index(raw_show, \"(\")\n\n  if bracket_open &gt; 0 do\n    {:ok, raw_show |&gt; String.slice(0, bracket_open) |&gt; String.trim()}\n  else\n    {:error, \"Can't extract name from #{raw_show}\"}\n  end\nend\n\nextract_name(\"The Wire (2002-2008)\")  # =&gt; {:ok, \"The Wire\"}\nextract_name(\"(2022)\")                # =&gt; {:error, \"Can't extract name from (2022)\"}\n</code></pre>"},{"location":"elixir/part-3/#73-with","title":"7.3 with \u5f0f\u3092\u4f7f\u3063\u305f\u30d1\u30fc\u30b9","text":"<p><code>with</code> \u5f0f\u3092\u4f7f\u3046\u3068\u3001\u8907\u6570\u306e Result \u3092\u5b89\u5168\u306b\u5408\u6210\u3067\u304d\u307e\u3059\u3002</p> <pre><code>def extract_year_start(raw_show) do\n  bracket_open = find_index(raw_show, \"(\")\n  dash = find_index(raw_show, \"-\")\n\n  with true &lt;- bracket_open != -1 &amp;&amp; dash &gt; bracket_open + 1,\n       year_str &lt;- String.slice(raw_show, (bracket_open + 1)..(dash - 1)),\n       {:ok, year} &lt;- parse_int(year_str) do\n    {:ok, year}\n  else\n    false -&gt; {:error, \"Can't extract start year from #{raw_show}\"}\n    {:error, reason} -&gt; {:error, reason}\n  end\nend\n\ndefp parse_int(str) do\n  case Integer.parse(str) do\n    {value, \"\"} -&gt; {:ok, value}\n    _ -&gt; {:error, \"Can't parse '#{str}' as integer\"}\n  end\nend\n\nextract_year_start(\"The Wire (2002-2008)\")   # =&gt; {:ok, 2002}\nextract_year_start(\"The Wire (-2008)\")       # =&gt; {:error, \"Can't extract start year from ...\"}\nextract_year_start(\"The Wire (oops-2008)\")   # =&gt; {:error, \"Can't parse 'oops' as integer\"}\n</code></pre>"},{"location":"elixir/part-3/#74-result","title":"7.4 Result \u578b\u306e\u30e6\u30fc\u30c6\u30a3\u30ea\u30c6\u30a3\u95a2\u6570","text":"<pre><code># or_else - \u5931\u6557\u6642\u306b\u4ee3\u66ff\u3092\u8a66\u3059\ndef or_else({:ok, _} = result, _fallback), do: result\ndef or_else({:error, _}, fallback), do: fallback.()\n\nor_else({:ok, 1}, fn -&gt; {:ok, 2} end)        # =&gt; {:ok, 1}\nor_else({:error, \"failed\"}, fn -&gt; {:ok, 2} end)  # =&gt; {:ok, 2}\n\n# result_map - \u6210\u529f\u5024\u3092\u5909\u63db\ndef result_map({:ok, value}, func), do: {:ok, func.(value)}\ndef result_map({:error, _} = error, _func), do: error\n\nresult_map({:ok, 5}, &amp;(&amp;1 * 2))      # =&gt; {:ok, 10}\nresult_map({:error, \"oops\"}, &amp;(&amp;1 * 2))  # =&gt; {:error, \"oops\"}\n\n# result_flat_map - \u6210\u529f\u5024\u306b Result \u3092\u8fd4\u3059\u95a2\u6570\u3092\u9069\u7528\ndef result_flat_map({:ok, value}, func), do: func.(value)\ndef result_flat_map({:error, _} = error, _func), do: error\n\nresult_flat_map({:ok, 5}, fn x -&gt; {:ok, x * 2} end)  # =&gt; {:ok, 10}\nresult_flat_map({:ok, 5}, fn _x -&gt; {:error, \"failed\"} end)  # =&gt; {:error, \"failed\"}\n</code></pre>"},{"location":"elixir/part-3/#75-with","title":"7.5 \u5b8c\u5168\u306a\u30d1\u30fc\u30b5\u30fc\uff08with \u5f0f\u7248\uff09","text":"<pre><code>def parse_show(raw_show) do\n  with {:ok, name} &lt;- extract_name(raw_show),\n       {:ok, year_start} &lt;- or_else(extract_year_start(raw_show),\n                                     fn -&gt; extract_single_year(raw_show) end),\n       {:ok, year_end} &lt;- or_else(extract_year_end(raw_show),\n                                   fn -&gt; extract_single_year(raw_show) end) do\n    {:ok, %TvShow{title: name, start: year_start, end_year: year_end}}\n  end\nend\n\nparse_show(\"The Wire (2002-2008)\")  # =&gt; {:ok, %TvShow{...}}\nparse_show(\"Mad Men ()\")            # =&gt; {:error, \"Can't extract single year from Mad Men ()\"}\nparse_show(\"(2002-2008)\")           # =&gt; {:error, \"Can't extract name from (2002-2008)\"}\n</code></pre>"},{"location":"elixir/part-3/#76-result","title":"7.6 Result \u30d1\u30bf\u30fc\u30f3\u306e\u4e3b\u8981\u64cd\u4f5c","text":"\u64cd\u4f5c \u8aac\u660e \u4f8b <code>result_map</code> \u6210\u529f\u5024\u3092\u5909\u63db <code>result_map({:ok, 5}, &amp;(&amp;1 * 2))</code> \u2192 <code>{:ok, 10}</code> <code>result_flat_map</code> \u6210\u529f\u306a\u3089 Result \u3092\u8fd4\u3059\u95a2\u6570\u3092\u9069\u7528 <code>result_flat_map({:ok, 5}, fn x -&gt; {:ok, x * 2} end)</code> <code>or_else</code> \u5931\u6557\u306a\u3089\u4ee3\u66ff\u3092\u4f7f\u7528 <code>or_else({:error, \"err\"}, fn -&gt; {:ok, 5} end)</code> <code>result_to_nil</code> nil \u306b\u5909\u63db <code>result_to_nil({:ok, 5})</code> \u2192 <code>5</code> <code>nil_to_result</code> Result \u306b\u5909\u63db <code>nil_to_result(5, \"error\")</code> \u2192 <code>{:ok, 5}</code>"},{"location":"elixir/part-3/#77","title":"7.7 \u97f3\u697d\u30a2\u30fc\u30c6\u30a3\u30b9\u30c8\u691c\u7d22\u306e\u4f8b","text":"<p>\u3088\u308a\u8907\u96d1\u306a\u4f8b\u3068\u3057\u3066\u3001\u97f3\u697d\u30a2\u30fc\u30c6\u30a3\u30b9\u30c8\u306e\u691c\u7d22\u6a5f\u80fd\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p>"},{"location":"elixir/part-3/#adt","title":"\u4ee3\u6570\u7684\u30c7\u30fc\u30bf\u578b\uff08ADT\uff09\u306b\u3088\u308b\u30e2\u30c7\u30ea\u30f3\u30b0","text":"<p>Elixir \u3067\u306f\u30bf\u30d7\u30eb\u3068\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u4f7f\u3063\u3066\u76f4\u548c\u578b\u3092\u8868\u73fe\u3057\u307e\u3059\u3002</p> <pre><code># \u6d3b\u52d5\u671f\u9593\u306e\u76f4\u548c\u578b\n# {:still_active, since} - \u73fe\u5728\u3082\u6d3b\u52d5\u4e2d\n# {:active_between, start, end_year} - \u904e\u53bb\u306b\u6d3b\u52d5\n\ndefmodule Artist do\n  defstruct [:name, :genre, :origin, :years_active]\nend\n\n# \u4f7f\u7528\u4f8b\nmetallica = %Artist{\n  name: \"Metallica\",\n  genre: :heavy_metal,\n  origin: \"U.S.\",\n  years_active: {:still_active, 1981}\n}\n\nled_zeppelin = %Artist{\n  name: \"Led Zeppelin\",\n  genre: :hard_rock,\n  origin: \"England\",\n  years_active: {:active_between, 1968, 1980}\n}\n</code></pre> <p></p>"},{"location":"elixir/part-3/#78","title":"7.8 \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0","text":"<p>\u76f4\u548c\u578b\u306f\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3067\u51e6\u7406\u3057\u307e\u3059\u3002</p> <pre><code>def was_artist_active?(%Artist{years_active: years_active}, year_start, year_end) do\n  case years_active do\n    {:still_active, since} -&gt; since &lt;= year_end\n    {:active_between, start, active_end} -&gt; start &lt;= year_end &amp;&amp; active_end &gt;= year_start\n  end\nend\n\ndef active_length(%Artist{years_active: years_active}, current_year) do\n  case years_active do\n    {:still_active, since} -&gt; current_year - since\n    {:active_between, start, active_end} -&gt; active_end - start\n  end\nend\n\n# \u4f7f\u7528\u4f8b\nwas_artist_active?(metallica, 2019, 2022)     # =&gt; true\nwas_artist_active?(led_zeppelin, 1990, 2000)  # =&gt; false\n\nactive_length(metallica, 2022)     # =&gt; 41\nactive_length(led_zeppelin, 2022)  # =&gt; 12\n</code></pre> <p></p>"},{"location":"elixir/part-3/#79","title":"7.9 \u691c\u7d22\u6761\u4ef6\u306e\u30e2\u30c7\u30ea\u30f3\u30b0","text":"<p>\u691c\u7d22\u6761\u4ef6\u3082\u76f4\u548c\u578b\u3067\u30e2\u30c7\u30ea\u30f3\u30b0\u3067\u304d\u307e\u3059\u3002</p> <pre><code># \u691c\u7d22\u6761\u4ef6\u306e\u76f4\u548c\u578b\n# {:by_genre, [genre]} - \u30b8\u30e3\u30f3\u30eb\u3067\u691c\u7d22\n# {:by_origin, [location]} - \u51fa\u8eab\u5730\u3067\u691c\u7d22\n# {:by_active_years, start, end} - \u6d3b\u52d5\u671f\u9593\u3067\u691c\u7d22\n\ndef search_artists(artists, conditions) do\n  Enum.filter(artists, fn artist -&gt;\n    Enum.all?(conditions, fn condition -&gt;\n      matches_condition?(artist, condition)\n    end)\n  end)\nend\n\ndefp matches_condition?(artist, condition) do\n  case condition do\n    {:by_genre, genres} -&gt; artist.genre in genres\n    {:by_origin, locations} -&gt; artist.origin in locations\n    {:by_active_years, start_year, end_year} -&gt; was_artist_active?(artist, start_year, end_year)\n  end\nend\n\n# \u4f7f\u7528\u4f8b\nartists = [metallica, led_zeppelin, bee_gees]\n\nsearch_artists(artists, [{:by_genre, [:pop]}, {:by_origin, [\"England\"]}])\n# =&gt; [%Artist{name: \"Bee Gees\", ...}]\n\nsearch_artists(artists, [{:by_active_years, 2019, 2022}])\n# =&gt; [%Artist{name: \"Metallica\", ...}]\n</code></pre>"},{"location":"elixir/part-3/#710","title":"7.10 \u30d7\u30ec\u30a4\u30ea\u30b9\u30c8\u306e\u4f8b","text":"<p>\u30d7\u30ec\u30a4\u30ea\u30b9\u30c8\u306e\u7a2e\u985e\u3082\u76f4\u548c\u578b\u3067\u8868\u73fe\u3067\u304d\u307e\u3059\u3002</p> <pre><code>defmodule Song do\n  defstruct [:artist, :title]\nend\n\ndefmodule Playlist do\n  defstruct [:name, :kind, :songs]\nend\n\n# \u30d7\u30ec\u30a4\u30ea\u30b9\u30c8\u306e\u7a2e\u985e\n# {:curated_by_user, user} - \u30e6\u30fc\u30b6\u30fc\u304c\u30ad\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\n# {:based_on_artist, artist} - \u30a2\u30fc\u30c6\u30a3\u30b9\u30c8\u30d9\u30fc\u30b9\n# {:based_on_genres, MapSet.t(genre)} - \u30b8\u30e3\u30f3\u30eb\u30d9\u30fc\u30b9\n\ndef gather_songs(playlists, artist, genre) do\n  Enum.flat_map(playlists, fn playlist -&gt;\n    case playlist.kind do\n      {:curated_by_user, _user} -&gt;\n        Enum.filter(playlist.songs, fn song -&gt; song.artist == artist end)\n\n      {:based_on_artist, playlist_artist} -&gt;\n        if playlist_artist == artist, do: playlist.songs, else: []\n\n      {:based_on_genres, genres} -&gt;\n        if MapSet.member?(genres, genre), do: playlist.songs, else: []\n    end\n  end)\nend\n</code></pre>"},{"location":"elixir/part-3/#711-nil-result","title":"7.11 nil \u3068 Result \u306e\u76f8\u4e92\u5909\u63db","text":"<pre><code># nil \u3092 Result \u306b\u5909\u63db\ndef nil_to_result(nil, error_msg), do: {:error, error_msg}\ndef nil_to_result(value, _error_msg), do: {:ok, value}\n\nnil_to_result(42, \"no value\")   # =&gt; {:ok, 42}\nnil_to_result(nil, \"no value\")  # =&gt; {:error, \"no value\"}\n\n# Result \u3092 nil \u306b\u5909\u63db\ndef result_to_nil({:ok, value}), do: value\ndef result_to_nil({:error, _}), do: nil\n\nresult_to_nil({:ok, 42})        # =&gt; 42\nresult_to_nil({:error, \"failed\"})  # =&gt; nil\n</code></pre>"},{"location":"elixir/part-3/#scala","title":"Scala \u3068\u306e\u6bd4\u8f03","text":""},{"location":"elixir/part-3/#option-vs-nil","title":"Option \u578b vs nil","text":"Scala Elixir \u8aac\u660e <code>Option[A]</code> <code>value \\| nil</code> \u5024\u304c\u3042\u308b\u304b\u306a\u3044\u304b <code>Some(value)</code> <code>value</code> \u5024\u304c\u3042\u308b <code>None</code> <code>nil</code> \u5024\u304c\u306a\u3044 <code>opt.map(f)</code> <code>nil_map(value, f)</code> \u5024\u304c\u3042\u308c\u3070\u5909\u63db <code>opt.flatMap(f)</code> <code>nil_flat_map(value, f)</code> \u30c1\u30a7\u30fc\u30f3 <code>opt.orElse(alt)</code> <code>or_else(value, alt)</code> \u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af <code>opt.getOrElse(default)</code> <code>value \\|\\| default</code> \u30c7\u30d5\u30a9\u30eb\u30c8\u5024"},{"location":"elixir/part-3/#either-vs-result","title":"Either \u578b vs Result \u30d1\u30bf\u30fc\u30f3","text":"Scala Elixir \u8aac\u660e <code>Either[E, A]</code> <code>{:ok, value} \\| {:error, reason}</code> \u6210\u529f\u304b\u5931\u6557 <code>Right(value)</code> <code>{:ok, value}</code> \u6210\u529f <code>Left(error)</code> <code>{:error, reason}</code> \u5931\u6557 <code>either.map(f)</code> <code>result_map(result, f)</code> \u6210\u529f\u5024\u3092\u5909\u63db <code>either.flatMap(f)</code> <code>result_flat_map(result, f)</code> \u30c1\u30a7\u30fc\u30f3 <code>either.orElse(alt)</code> <code>or_else(result, alt)</code> \u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af <code>for {...} yield</code> <code>with {...} do</code> \u5408\u6210"},{"location":"elixir/part-3/#_3","title":"\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0","text":"<pre><code>// Scala\nartist.yearsActive match {\n  case StillActive(since)        =&gt; since &lt;= yearEnd\n  case ActiveBetween(start, end) =&gt; start &lt;= yearEnd &amp;&amp; end &gt;= yearStart\n}\n</code></pre> <pre><code># Elixir\ncase artist.years_active do\n  {:still_active, since} -&gt; since &lt;= year_end\n  {:active_between, start, active_end} -&gt; start &lt;= year_end &amp;&amp; active_end &gt;= year_start\nend\n</code></pre>"},{"location":"elixir/part-3/#_4","title":"\u307e\u3068\u3081","text":""},{"location":"elixir/part-3/#part-iii","title":"Part III \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"elixir/part-3/#nil-vs-result","title":"nil vs Result \u30d1\u30bf\u30fc\u30f3\u306e\u4f7f\u3044\u5206\u3051","text":"\u72b6\u6cc1 \u4f7f\u7528\u3059\u308b\u30d1\u30bf\u30fc\u30f3 \u5024\u304c\u3042\u308b\u304b\u306a\u3044\u304b\u3060\u3051\u304c\u91cd\u8981 <code>nil</code> \u5931\u6557\u7406\u7531\u3092\u4f1d\u3048\u308b\u5fc5\u8981\u304c\u3042\u308b <code>{:ok, value} / {:error, reason}</code> \u691c\u7d22\u7d50\u679c\u304c\u898b\u3064\u304b\u3089\u306a\u3044 <code>nil</code> \u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u30a8\u30e9\u30fc\u3092\u4f1d\u3048\u308b <code>{:error, reason}</code> \u5916\u90e8 API \u547c\u3073\u51fa\u3057 <code>{:ok, value} / {:error, reason}</code>"},{"location":"elixir/part-3/#_5","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>nil: \u5024\u306e\u6709\u7121\u3092\u8868\u73fe\u3059\u308b\u6700\u3082\u30b7\u30f3\u30d7\u30eb\u306a\u65b9\u6cd5</li> <li>Result \u30d1\u30bf\u30fc\u30f3: \u6210\u529f/\u5931\u6557\u3068\u30a8\u30e9\u30fc\u60c5\u5831\u3092\u8868\u73fe</li> <li>with \u5f0f: Result \u30d1\u30bf\u30fc\u30f3\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u4f7f\u3046</li> <li>or_else: \u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u3092\u63d0\u4f9b\u3059\u308b</li> <li>ADT: \u76f4\u7a4d\u578b\uff08struct\uff09\u3068\u76f4\u548c\u578b\uff08\u30bf\u30d7\u30eb\uff09\u3067\u30c9\u30e1\u30a4\u30f3\u3092\u6b63\u78ba\u306b\u30e2\u30c7\u30ea\u30f3\u30b0</li> <li>\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0: \u76f4\u548c\u578b\u3092\u5b89\u5168\u306b\u51e6\u7406\u3059\u308b</li> </ol>"},{"location":"elixir/part-3/#_6","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part IV \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li>IO \u3068\u30d7\u30ed\u30bb\u30b9</li> <li>\u526f\u4f5c\u7528\u306e\u7ba1\u7406</li> <li>GenServer \u3068\u30b9\u30c6\u30fc\u30c8\u7ba1\u7406</li> </ul>"},{"location":"elixir/part-3/#_7","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"elixir/part-3/#1-nil","title":"\u554f\u984c 1: nil \u306e\u57fa\u672c","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>def safe_divide(a, b)\n\n# \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert safe_divide(10, 2) == 5\nassert safe_divide(10, 0) == nil\nassert safe_divide(7, 2) == 3\n</code></pre> \u89e3\u7b54 <pre><code>def safe_divide(_a, 0), do: nil\ndef safe_divide(a, b), do: div(a, b)\n</code></pre>"},{"location":"elixir/part-3/#2-nil","title":"\u554f\u984c 2: nil \u306e\u5408\u6210","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u30022\u3064\u306e\u6570\u5024\u6587\u5b57\u5217\u3092\u53d7\u3051\u53d6\u308a\u3001\u305d\u306e\u5408\u8a08\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>def add_strings(a, b)\n\n# \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert add_strings(\"10\", \"20\") == 30\nassert add_strings(\"10\", \"abc\") == nil\nassert add_strings(\"xyz\", \"20\") == nil\n</code></pre> \u89e3\u7b54 <pre><code>def add_strings(a, b) do\n  with {x, \"\"} &lt;- Integer.parse(a),\n       {y, \"\"} &lt;- Integer.parse(b) do\n    x + y\n  else\n    _ -&gt; nil\n  end\nend\n</code></pre>"},{"location":"elixir/part-3/#3-result","title":"\u554f\u984c 3: Result \u30d1\u30bf\u30fc\u30f3\u306b\u3088\u308b\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u5e74\u9f62\u3092\u691c\u8a3c\u3057\u3001\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>def validate_age(age)\n\n# \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert validate_age(25) == {:ok, 25}\nassert validate_age(-5) == {:error, \"Age cannot be negative\"}\nassert validate_age(200) == {:error, \"Age cannot be greater than 150\"}\n</code></pre> \u89e3\u7b54 <pre><code>def validate_age(age) when age &lt; 0 do\n  {:error, \"Age cannot be negative\"}\nend\n\ndef validate_age(age) when age &gt; 150 do\n  {:error, \"Age cannot be greater than 150\"}\nend\n\ndef validate_age(age) do\n  {:ok, age}\nend\n</code></pre>"},{"location":"elixir/part-3/#4","title":"\u554f\u984c 4: \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0","text":"<p>\u4ee5\u4e0b\u306e\u76f4\u548c\u578b\u3068\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u4f7f\u3063\u305f\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code># \u652f\u6255\u3044\u65b9\u6cd5\n# {:credit_card, number, expiry}\n# {:bank_transfer, account_number}\n# :cash\n\ndef describe_payment(method)\n\n# \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert describe_payment({:credit_card, \"1234\", \"12/25\"}) == \"Credit card ending in 1234\"\nassert describe_payment({:bank_transfer, \"9876\"}) == \"Bank transfer to account 9876\"\nassert describe_payment(:cash) == \"Cash payment\"\n</code></pre> \u89e3\u7b54 <pre><code>def describe_payment({:credit_card, number, _expiry}) do\n  \"Credit card ending in #{number}\"\nend\n\ndef describe_payment({:bank_transfer, account}) do\n  \"Bank transfer to account #{account}\"\nend\n\ndef describe_payment(:cash) do\n  \"Cash payment\"\nend\n</code></pre>"},{"location":"elixir/part-3/#5-nil_forall-nil_exists","title":"\u554f\u984c 5: nil_forall \u3068 nil_exists","text":"<p>\u4ee5\u4e0b\u306e\u6761\u4ef6\u306b\u5408\u3046\u30e6\u30fc\u30b6\u30fc\u3092\u62bd\u51fa\u3059\u308b\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>defmodule User do\n  defstruct [:name, :email, :age]\nend\n\nusers = [\n  %User{name: \"Alice\", email: \"alice@example.com\", age: 25},\n  %User{name: \"Bob\", email: nil, age: 30},\n  %User{name: \"Charlie\", email: \"charlie@test.com\", age: 17}\n]\n\n# 1. \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u304b\u3001example.com \u30c9\u30e1\u30a4\u30f3\u306e\u30e6\u30fc\u30b6\u30fc\ndef f1(users)\n\n# 2. \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u3066\u3001test.com \u30c9\u30e1\u30a4\u30f3\u306e\u30e6\u30fc\u30b6\u30fc\ndef f2(users)\n</code></pre> \u89e3\u7b54 <pre><code># 1. \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u304b\u3001example.com \u30c9\u30e1\u30a4\u30f3\ndef f1(users) do\n  Enum.filter(users, fn user -&gt;\n    nil_forall(user.email, &amp;String.ends_with?(&amp;1, \"@example.com\"))\n  end)\nend\n# =&gt; [%User{name: \"Alice\", ...}, %User{name: \"Bob\", ...}]\n\n# 2. \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u3066\u3001test.com \u30c9\u30e1\u30a4\u30f3\ndef f2(users) do\n  Enum.filter(users, fn user -&gt;\n    nil_exists(user.email, &amp;String.ends_with?(&amp;1, \"@test.com\"))\n  end)\nend\n# =&gt; [%User{name: \"Charlie\", ...}]\n</code></pre>"},{"location":"elixir/part-4/","title":"Part IV: IO \u3068\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u526f\u4f5c\u7528\u306e\u6271\u3044\u65b9\u3092\u5b66\u3073\u307e\u3059\u3002Elixir \u306e\u7121\u540d\u95a2\u6570\u3092\u4f7f\u3063\u3066\u526f\u4f5c\u7528\u3092\u9045\u5ef6\u5b9f\u884c\u3057\u3001Stream \u30e2\u30b8\u30e5\u30fc\u30eb\u3067\u7121\u9650\u306e\u30c7\u30fc\u30bf\u3092\u52b9\u7387\u7684\u306b\u6271\u3046\u65b9\u6cd5\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"elixir/part-4/#8-io","title":"\u7b2c8\u7ae0: IO \u30d1\u30bf\u30fc\u30f3\u3068\u30d7\u30ed\u30bb\u30b9","text":""},{"location":"elixir/part-4/#81","title":"8.1 \u526f\u4f5c\u7528\u306e\u554f\u984c","text":"<p>\u7d14\u7c8b\u95a2\u6570\u306f\u526f\u4f5c\u7528\u3092\u6301\u3061\u307e\u305b\u3093\u3002\u3057\u304b\u3057\u3001\u5b9f\u969b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u306b\u306f\u526f\u4f5c\u7528\u304c\u5fc5\u8981\u3067\u3059:</p> <ul> <li>\u30d5\u30a1\u30a4\u30eb\u306e\u8aad\u307f\u66f8\u304d</li> <li>\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u901a\u4fe1</li> <li>\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30a2\u30af\u30bb\u30b9</li> <li>\u4e71\u6570\u751f\u6210</li> <li>\u73fe\u5728\u6642\u523b\u306e\u53d6\u5f97</li> </ul> <p></p>"},{"location":"elixir/part-4/#82-elixir-io","title":"8.2 Elixir \u306b\u304a\u3051\u308b IO \u30d1\u30bf\u30fc\u30f3","text":"<p>Scala \u306e <code>IO</code> \u30e2\u30ca\u30c9\u306b\u76f8\u5f53\u3059\u308b\u6982\u5ff5\u3092\u3001Elixir \u3067\u306f\u7121\u540d\u95a2\u6570\u3092\u4f7f\u3063\u3066\u8868\u73fe\u3057\u307e\u3059\u3002</p> <ul> <li><code>fn -&gt; expr end</code> \u306f\u300c\u5b9f\u884c\u3059\u308b\u3068\u7d50\u679c\u3092\u8fd4\u3059\u526f\u4f5c\u7528\u306e\u3042\u308b\u8a08\u7b97\u300d</li> <li>\u95a2\u6570\u3092\u4f5c\u6210\u3057\u305f\u3060\u3051\u3067\u306f\u526f\u4f5c\u7528\u306f\u767a\u751f\u3057\u306a\u3044</li> <li>\u95a2\u6570\u3092\u547c\u3073\u51fa\u3059\u3053\u3068\u3067\u5b9f\u969b\u306b\u5b9f\u884c\u3055\u308c\u308b</li> </ul> <p></p>"},{"location":"elixir/part-4/#83","title":"8.3 \u30b5\u30a4\u30b3\u30ed\u3092\u632f\u308b\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/elixir/lib/ch08/io_and_processes.ex</code></p>"},{"location":"elixir/part-4/#_1","title":"\u4e0d\u7d14\u306a\u95a2\u6570\uff08\u526f\u4f5c\u7528\u3042\u308a\uff09","text":"<pre><code>def cast_the_die_impure do\n  :rand.uniform(6)\nend\n\n# \u547c\u3073\u51fa\u3059\u305f\u3073\u306b\u7570\u306a\u308b\u5024\u304c\u8fd4\u308b\nIO.inspect(cast_the_die_impure())  # 3\nIO.inspect(cast_the_die_impure())  # 5\nIO.inspect(cast_the_die_impure())  # 1\n</code></pre>"},{"location":"elixir/part-4/#_2","title":"\u9045\u5ef6\u5b9f\u884c\u30d1\u30bf\u30fc\u30f3","text":"<pre><code>@spec delay((-&gt; any())) :: (-&gt; any())\ndef delay(f) when is_function(f, 0), do: f\n\n@spec run((-&gt; any())) :: any()\ndef run(f) when is_function(f, 0), do: f.()\n\ndef cast_the_die do\n  delay(fn -&gt; cast_the_die_impure() end)\nend\n\n# \u95a2\u6570\u3092\u4f5c\u6210\uff08\u3053\u306e\u6642\u70b9\u3067\u306f\u5b9f\u884c\u3055\u308c\u306a\u3044\uff09\ndie_cast = cast_the_die()\nIO.inspect(die_cast)  # #Function&lt;...&gt; - \u307e\u3060\u5b9f\u884c\u3055\u308c\u3066\u3044\u306a\u3044\n\n# \u5b9f\u969b\u306b\u5b9f\u884c\nIO.inspect(run(die_cast))  # 4\n</code></pre>"},{"location":"elixir/part-4/#84-io","title":"8.4 IO \u306e\u4f5c\u6210\u65b9\u6cd5","text":"\u95a2\u6570 \u7528\u9014 \u4f8b <code>delay(f)</code> \u526f\u4f5c\u7528\u306e\u3042\u308b\u5f0f\u3092\u30e9\u30c3\u30d7 <code>delay(fn -&gt; IO.puts(\"hello\") end)</code> <code>pure(value)</code> \u65e2\u5b58\u306e\u5024\u3092\u30e9\u30c3\u30d7\uff08\u526f\u4f5c\u7528\u306a\u3057\uff09 <code>pure(42)</code> <pre><code># delay: \u526f\u4f5c\u7528\u3092\u9045\u5ef6\u5b9f\u884c\ndelayed_print = delay(fn -&gt; IO.puts(\"Hello\") end)\n# IO.puts \u306f\u307e\u3060\u5b9f\u884c\u3055\u308c\u3066\u3044\u306a\u3044\n\n# pure: \u65e2\u5b58\u306e\u5024\u3092\u30e9\u30c3\u30d7\npure_value = pure(42)\n# \u526f\u4f5c\u7528\u306a\u3057\u3001\u5373\u5ea7\u306b 42 \u304c\u78ba\u5b9a\n</code></pre>"},{"location":"elixir/part-4/#85-io","title":"8.5 IO \u306e\u5408\u6210","text":"<p>IO \u5024\u306f <code>flat_map</code> \u3067\u30c1\u30a7\u30fc\u30f3\u3067\u304d\u307e\u3059\u3002Scala \u306e <code>for</code> \u5185\u5305\u8868\u8a18\u306b\u76f8\u5f53\u3057\u307e\u3059\u3002</p> <pre><code>@spec flat_map((-&gt; any()), (any() -&gt; (-&gt; any()))) :: (-&gt; any())\ndef flat_map(io, f) do\n  fn -&gt;\n    result = run(io)\n    run(f.(result))\n  end\nend\n\ndef cast_the_die_twice do\n  flat_map(cast_the_die(), fn first -&gt;\n    map(cast_the_die(), fn second -&gt;\n      first + second\n    end)\n  end)\nend\n\n# \u307e\u3060\u5b9f\u884c\u3055\u308c\u3066\u3044\u306a\u3044\nprogram = cast_the_die_twice()\n\n# \u5b9f\u884c\nresult = run(program)  # 2\u301c12 \u306e\u5024\n</code></pre> <p></p>"},{"location":"elixir/part-4/#86","title":"8.6 \u30df\u30fc\u30c6\u30a3\u30f3\u30b0\u30b9\u30b1\u30b8\u30e5\u30fc\u30ea\u30f3\u30b0\u306e\u4f8b","text":"<p>\u3088\u308a\u5b9f\u8df5\u7684\u306a\u4f8b\u3068\u3057\u3066\u3001\u30df\u30fc\u30c6\u30a3\u30f3\u30b0\u306e\u30b9\u30b1\u30b8\u30e5\u30fc\u30ea\u30f3\u30b0\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p> <pre><code>defmodule MeetingTime do\n  defstruct [:start_hour, :end_hour]\nend\n\n# \u526f\u4f5c\u7528\u306e\u3042\u308b API \u547c\u3073\u51fa\u3057\u3092\u9045\u5ef6\u5b9f\u884c\ndef calendar_entries(name) do\n  delay(fn -&gt;\n    # \u30e2\u30c3\u30af\u30c7\u30fc\u30bf\uff08\u5b9f\u969b\u306b\u306f API \u547c\u3073\u51fa\u3057\uff09\n    case name do\n      \"Alice\" -&gt; [%MeetingTime{start_hour: 9, end_hour: 10}, ...]\n      \"Bob\" -&gt; [%MeetingTime{start_hour: 10, end_hour: 11}, ...]\n      _ -&gt; []\n    end\n  end)\nend\n</code></pre>"},{"location":"elixir/part-4/#_3","title":"\u4e88\u5b9a\u306e\u53d6\u5f97","text":"<pre><code>def scheduled_meetings(person1, person2) do\n  flat_map(calendar_entries(person1), fn entries1 -&gt;\n    map(calendar_entries(person2), fn entries2 -&gt;\n      entries1 ++ entries2\n    end)\n  end)\nend\n\n# \u4f7f\u7528\u4f8b\nio = scheduled_meetings(\"Alice\", \"Bob\")\nmeetings = run(io)  # 4\u4ef6\u306e\u4e88\u5b9a\n</code></pre>"},{"location":"elixir/part-4/#_4","title":"\u7a7a\u304d\u6642\u9593\u306e\u8a08\u7b97\uff08\u7d14\u7c8b\u95a2\u6570\uff09","text":"<pre><code>def possible_meetings(existing_meetings, start_hour, end_hour, length_hours) do\n  slots =\n    start_hour..(end_hour - length_hours)\n    |&gt; Enum.map(fn start -&gt;\n      %MeetingTime{start_hour: start, end_hour: start + length_hours}\n    end)\n\n  Enum.filter(slots, fn slot -&gt;\n    Enum.all?(existing_meetings, fn meeting -&gt;\n      not meetings_overlap?(meeting, slot)\n    end)\n  end)\nend\n\n# \u30df\u30fc\u30c6\u30a3\u30f3\u30b0\u304c\u91cd\u306a\u308b\u304b\u30c1\u30a7\u30c3\u30af\ndef meetings_overlap?(m1, m2) do\n  m1.start_hour &lt; m2.end_hour &amp;&amp; m2.start_hour &lt; m1.end_hour\nend\n</code></pre>"},{"location":"elixir/part-4/#87-or_else","title":"8.7 or_else \u306b\u3088\u308b\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":"<p><code>or_else</code> \u95a2\u6570\u3067\u3001\u5931\u6557\u6642\u306e\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002</p> <pre><code>def or_else(io, fallback) do\n  fn -&gt;\n    try do\n      run(io)\n    rescue\n      _ -&gt; run(fallback)\n    end\n  end\nend\n\nsuccess = pure(42)\nfallback = pure(0)\nrun(or_else(success, fallback))  # 42\n\nfailing = fn -&gt; raise \"error\" end\nrun(or_else(failing, fallback))  # 0\n</code></pre> <p></p>"},{"location":"elixir/part-4/#_5","title":"\u30ea\u30c8\u30e9\u30a4\u6226\u7565","text":"<pre><code>def retry(io, max_retries) do\n  fn -&gt;\n    do_retry(io, max_retries, nil)\n  end\nend\n\ndefp do_retry(_io, 0, last_error), do: raise(last_error || \"Max retries exceeded\")\n\ndefp do_retry(io, retries_left, _last_error) do\n  try do\n    run(io)\n  rescue\n    e -&gt; do_retry(io, retries_left - 1, e)\n  end\nend\n\n# \u4f7f\u7528\u4f8b\uff1aAPI \u547c\u3073\u51fa\u3057\u30925\u56de\u307e\u3067\u30ea\u30c8\u30e9\u30a4\nresult = retry(calendar_entries(\"Alice\"), 5)\n</code></pre>"},{"location":"elixir/part-4/#88-sequence-io","title":"8.8 sequence \u306b\u3088\u308b IO \u306e\u30ea\u30b9\u30c8\u51e6\u7406","text":"<p><code>[IO]</code> \u3092 <code>IO[List]</code> \u306b\u5909\u63db\u3059\u308b\u306b\u306f <code>sequence</code> \u3092\u4f7f\u3044\u307e\u3059\u3002</p> <pre><code>def sequence(ios) do\n  fn -&gt; Enum.map(ios, &amp;run/1) end\nend\n\nios = [pure(1), pure(2), pure(3)]\ncombined = sequence(ios)\nrun(combined)  # [1, 2, 3]\n</code></pre>"},{"location":"elixir/part-4/#_6","title":"\u8907\u6570\u4eba\u306e\u4e88\u5b9a\u3092\u53d6\u5f97","text":"<pre><code>def scheduled_meetings_for(attendees) do\n  attendees\n  |&gt; Enum.map(&amp;calendar_entries/1)\n  |&gt; sequence()\n  |&gt; map(&amp;List.flatten/1)\nend\n\n# \u4f7f\u7528\u4f8b\nio = scheduled_meetings_for([\"Alice\", \"Bob\"])\nmeetings = run(io)  # 4\u4ef6\u306e\u4e88\u5b9a\n</code></pre>"},{"location":"elixir/part-4/#89-agent","title":"8.9 Agent \u306b\u3088\u308b\u72b6\u614b\u7ba1\u7406","text":"<p>Elixir \u3067\u306f <code>Agent</code> \u3092\u4f7f\u3063\u3066\u72b6\u614b\u3092\u5b89\u5168\u306b\u7ba1\u7406\u3067\u304d\u307e\u3059\u3002</p> <pre><code>def create_counter(initial_value) do\n  Agent.start_link(fn -&gt; initial_value end)\nend\n\ndef get_count(counter) do\n  Agent.get(counter, &amp; &amp;1)\nend\n\ndef increment(counter) do\n  Agent.update(counter, &amp;(&amp;1 + 1))\nend\n\n# \u4f7f\u7528\u4f8b\n{:ok, counter} = create_counter(0)\nget_count(counter)  # 0\nincrement(counter)\nget_count(counter)  # 1\n</code></pre>"},{"location":"elixir/part-4/#810-task","title":"8.10 Task \u306b\u3088\u308b\u975e\u540c\u671f\u51e6\u7406","text":"<p><code>Task</code> \u3092\u4f7f\u3063\u3066\u975e\u540c\u671f\u51e6\u7406\u3092\u5b9f\u884c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>def async_calendar_entries(name) do\n  Task.async(fn -&gt; run(calendar_entries(name)) end)\nend\n\ndef parallel_calendar_entries(names) do\n  names\n  |&gt; Enum.map(&amp;async_calendar_entries/1)\n  |&gt; Task.await_many()\n  |&gt; List.flatten()\nend\n\n# \u4f7f\u7528\u4f8b\uff1a\u4e26\u884c\u3067\u30ab\u30ec\u30f3\u30c0\u30fc\u3092\u53d6\u5f97\nentries = parallel_calendar_entries([\"Alice\", \"Bob\"])  # 4\u4ef6\n</code></pre>"},{"location":"elixir/part-4/#9","title":"\u7b2c9\u7ae0: \u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406","text":""},{"location":"elixir/part-4/#91","title":"9.1 \u30b9\u30c8\u30ea\u30fc\u30e0\u3068\u306f","text":"<p>\u30b9\u30c8\u30ea\u30fc\u30e0\u306f\u3001\u8981\u7d20\u306e\uff08\u6f5c\u5728\u7684\u306b\u7121\u9650\u306e\uff09\u30b7\u30fc\u30b1\u30f3\u30b9\u3092\u9045\u5ef6\u8a55\u4fa1\u3067\u8868\u3057\u307e\u3059\u3002Elixir \u306e <code>Stream</code> \u30e2\u30b8\u30e5\u30fc\u30eb\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002</p> <p></p>"},{"location":"elixir/part-4/#92","title":"9.2 \u57fa\u672c\u7684\u306a\u30b9\u30c8\u30ea\u30fc\u30e0\u64cd\u4f5c","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/elixir/lib/ch09/streams.ex</code></p> <pre><code># \u6709\u9650\u30b9\u30c8\u30ea\u30fc\u30e0\ndef finite_stream(list), do: Stream.map(list, &amp; &amp;1)\n\nstream = finite_stream([1, 2, 3])\nEnum.to_list(stream)  # [1, 2, 3]\n\n# \u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\ndef filter_stream(stream, predicate), do: Stream.filter(stream, predicate)\n\nodd_numbers = filter_stream([1, 2, 3, 4, 5], &amp;(rem(&amp;1, 2) != 0))\nEnum.to_list(odd_numbers)  # [1, 3, 5]\n</code></pre>"},{"location":"elixir/part-4/#93","title":"9.3 \u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0","text":"<pre><code># \u7121\u9650\u306b\u7e70\u308a\u8fd4\u3057\ndef repeat(list), do: Stream.cycle(list)\n\ninfinite = repeat([1, 2, 3])\nEnum.take(infinite, 8)  # [1, 2, 3, 1, 2, 3, 1, 2]\n\n# \u751f\u6210\u95a2\u6570\u3092\u4f7f\u7528\ndef generate(f), do: Stream.repeatedly(f)\n\nstream = generate(fn -&gt; :rand.uniform(6) end)\nEnum.take(stream, 5)  # [4, 2, 6, 1, 3]\n\n# \u30ab\u30a6\u30f3\u30c8\u30a2\u30c3\u30d7\ndef count_from(start), do: Stream.iterate(start, &amp;(&amp;1 + 1))\n\nstream = count_from(1)\nEnum.take(stream, 5)  # [1, 2, 3, 4, 5]\n</code></pre>"},{"location":"elixir/part-4/#94","title":"9.4 \u30b5\u30a4\u30b3\u30ed\u30b9\u30c8\u30ea\u30fc\u30e0","text":"<pre><code>def die_casts do\n  Stream.repeatedly(fn -&gt; :rand.uniform(6) end)\nend\n\n# \u6700\u521d\u306e3\u56de\u3092\u53d6\u5f97\ndie_casts() |&gt; Enum.take(3)  # [4, 2, 6]\n\n# 6 \u304c\u51fa\u308b\u307e\u3067\u632f\u308a\u7d9a\u3051\u308b\ndef roll_until(target) do\n  die_casts()\n  |&gt; Stream.take_while(fn x -&gt; x != target end)\n  |&gt; Enum.to_list()\n  |&gt; Kernel.++([target])\nend\n\nroll_until(6)  # [2, 4, 1, 3, 6]\n\n# \u6307\u5b9a\u56de\u6570\u632f\u3063\u3066\u5408\u8a08\ndef roll_and_sum(n) do\n  die_casts()\n  |&gt; Enum.take(n)\n  |&gt; Enum.sum()\nend\n\nroll_and_sum(3)  # 3\u301c18 \u306e\u5024\n</code></pre>"},{"location":"elixir/part-4/#95","title":"9.5 \u30b9\u30c8\u30ea\u30fc\u30e0\u306e\u4e3b\u8981\u64cd\u4f5c","text":"\u64cd\u4f5c \u8aac\u660e \u4f8b <code>Stream.take(n)</code> \u6700\u521d\u306e n \u8981\u7d20\u3092\u53d6\u5f97 <code>stream \\|&gt; Stream.take(3)</code> <code>Stream.filter(p)</code> \u6761\u4ef6\u3092\u6e80\u305f\u3059\u8981\u7d20\u306e\u307f <code>stream \\|&gt; Stream.filter(&amp;(&amp;1 &gt; 0))</code> <code>Stream.map(f)</code> \u5404\u8981\u7d20\u3092\u5909\u63db <code>stream \\|&gt; Stream.map(&amp;(&amp;1 * 2))</code> <code>Stream.concat(s)</code> \u5225\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u7d50\u5408 <code>Stream.concat(s1, s2)</code> <code>Stream.cycle(list)</code> \u7121\u9650\u306b\u7e70\u308a\u8fd4\u3057 <code>Stream.cycle([1, 2, 3])</code> <code>Stream.chunk_every(n, step)</code> \u30b9\u30e9\u30a4\u30c7\u30a3\u30f3\u30b0\u30a6\u30a3\u30f3\u30c9\u30a6 <code>stream \\|&gt; Stream.chunk_every(3, 1)</code>"},{"location":"elixir/part-4/#96","title":"9.6 \u901a\u8ca8\u4ea4\u63db\u30ec\u30fc\u30c8\u306e\u4f8b","text":"<p>\u70ba\u66ff\u30ec\u30fc\u30c8\u3092\u76e3\u8996\u3057\u3066\u3001\u4e0a\u6607\u30c8\u30ec\u30f3\u30c9\u3092\u691c\u51fa\u3059\u308b\u4f8b\u3067\u3059\u3002</p>"},{"location":"elixir/part-4/#_7","title":"\u30c8\u30ec\u30f3\u30c9\u5224\u5b9a\uff08\u7d14\u7c8b\u95a2\u6570\uff09","text":"<pre><code>def trending?(rates) when length(rates) &lt;= 1, do: false\n\ndef trending?(rates) do\n  rates\n  |&gt; Enum.zip(Enum.drop(rates, 1))\n  |&gt; Enum.all?(fn {prev, curr} -&gt; curr &gt; prev end)\nend\n\ntrending?([0.81, 0.82, 0.83])  # true (\u4e0a\u6607\u30c8\u30ec\u30f3\u30c9)\ntrending?([0.81, 0.84, 0.83])  # false\n\ndef declining?(rates) when length(rates) &lt;= 1, do: false\n\ndef declining?(rates) do\n  rates\n  |&gt; Enum.zip(Enum.drop(rates, 1))\n  |&gt; Enum.all?(fn {prev, curr} -&gt; curr &lt; prev end)\nend\n\ndeclining?([0.83, 0.82, 0.81])  # true (\u4e0b\u964d\u30c8\u30ec\u30f3\u30c9)\n\ndef stable?(values) when length(values) &lt; 3, do: false\n\ndef stable?(values) do\n  values |&gt; Enum.uniq() |&gt; length() == 1\nend\n\nstable?([5, 5, 5])  # true (\u5b89\u5b9a)\n</code></pre>"},{"location":"elixir/part-4/#_8","title":"\u30ec\u30fc\u30c8\u306e\u30b9\u30c8\u30ea\u30fc\u30e0","text":"<pre><code>def exchange_rate(from, to) do\n  # \u30e2\u30c3\u30af\u306e\u70ba\u66ff\u30ec\u30fc\u30c8\uff08\u5b9f\u969b\u306b\u306f API \u3092\u547c\u3073\u51fa\u3059\uff09\n  base_rates = %{\n    {:usd, :eur} =&gt; 0.85,\n    {:usd, :gbp} =&gt; 0.73,\n    # ...\n  }\n\n  base_rate = Map.get(base_rates, {from, to}, 1.0)\n  variation = (:rand.uniform() - 0.5) * 0.02\n  base_rate * (1 + variation)\nend\n\ndef rate_stream(from, to) do\n  Stream.repeatedly(fn -&gt; exchange_rate(from, to) end)\nend\n\n# \u4f7f\u7528\u4f8b\nrate_stream(:usd, :eur) |&gt; Enum.take(3)\n# [0.8493, 0.8521, 0.8478]\n</code></pre>"},{"location":"elixir/part-4/#97","title":"9.7 \u30b9\u30e9\u30a4\u30c7\u30a3\u30f3\u30b0\u30a6\u30a3\u30f3\u30c9\u30a6","text":"<p><code>Stream.chunk_every/4</code> \u3067\u9023\u7d9a\u3059\u308b\u8981\u7d20\u3092\u30b0\u30eb\u30fc\u30d7\u5316\u3067\u304d\u307e\u3059\u3002</p> <pre><code>def sliding(stream, size) do\n  Stream.chunk_every(stream, size, 1, :discard)\nend\n\nsliding([1, 2, 3, 4, 5], 3) |&gt; Enum.to_list()\n# [[1, 2, 3], [2, 3, 4], [3, 4, 5]]\n</code></pre> <p></p>"},{"location":"elixir/part-4/#_9","title":"\u30c8\u30ec\u30f3\u30c9\u3092\u691c\u51fa\u3057\u3066\u4ea4\u63db","text":"<pre><code>def exchange_if_trending(amount, from, to, window_size, max_attempts) do\n  result =\n    rate_stream(from, to)\n    |&gt; sliding(window_size)\n    |&gt; Stream.filter(&amp;trending?/1)     # \u4e0a\u6607\u30c8\u30ec\u30f3\u30c9\u3092\u691c\u51fa\n    |&gt; Stream.map(&amp;List.last/1)        # \u6700\u65b0\u306e\u30ec\u30fc\u30c8\u3092\u53d6\u5f97\n    |&gt; Stream.take(1)\n    |&gt; Enum.take(max_attempts)\n    |&gt; List.first()\n\n  case result do\n    nil -&gt; {:error, \"No trending pattern found\"}\n    rate -&gt; {:ok, rate * amount}\n  end\nend\n\n# \u4f7f\u7528\u4f8b\nexchange_if_trending(100.0, :usd, :eur, 3, 1000)\n# {:ok, 85.23}\n</code></pre>"},{"location":"elixir/part-4/#98","title":"9.8 \u30b9\u30c8\u30ea\u30fc\u30e0\u306e\u7d50\u5408","text":"<p>2\u3064\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\u3092 <code>Stream.zip</code> \u3067\u7d50\u5408\u3067\u304d\u307e\u3059\u3002</p> <pre><code>def zip_streams(stream1, stream2) do\n  Stream.zip(stream1, stream2)\nend\n\nzip_streams([1, 2, 3], [\"a\", \"b\", \"c\"]) |&gt; Enum.to_list()\n# [{1, \"a\"}, {2, \"b\"}, {3, \"c\"}]\n\n# \u5de6\u5074\u306e\u5024\u3060\u3051\u8fd4\u3059\ndef zip_left(stream1, stream2) do\n  Stream.zip(stream1, stream2)\n  |&gt; Stream.map(fn {left, _right} -&gt; left end)\nend\n\n# \u30a4\u30f3\u30bf\u30fc\u30d0\u30eb\u4ed8\u304d\u3067\u51e6\u7406\ndef with_interval(stream, interval_ms) do\n  Stream.map(stream, fn item -&gt;\n    Process.sleep(interval_ms)\n    item\n  end)\nend\n\n# \u30ec\u30fc\u30c8\u30921\u79d2\u9593\u9694\u3067\u53d6\u5f97\nrate_stream(:usd, :eur)\n|&gt; with_interval(1000)\n|&gt; Enum.take(5)\n</code></pre> <p></p>"},{"location":"elixir/part-4/#99","title":"9.9 \u96c6\u8a08\u64cd\u4f5c","text":"<pre><code># \u5408\u8a08\ndef sum_stream(stream), do: Enum.sum(stream)\n\nsum_stream([1, 2, 3, 4, 5])  # 15\n\n# \u5e73\u5747\ndef average_stream(stream) do\n  {sum, count} =\n    Enum.reduce(stream, {0, 0}, fn x, {sum, count} -&gt;\n      {sum + x, count + 1}\n    end)\n\n  if count == 0, do: 0.0, else: sum / count\nend\n\naverage_stream([1, 2, 3, 4, 5])  # 3.0\n\n# \u79fb\u52d5\u5e73\u5747\ndef moving_average(stream, window_size) do\n  stream\n  |&gt; sliding(window_size)\n  |&gt; Stream.map(&amp;average_stream/1)\nend\n\nmoving_average([1, 2, 3, 4, 5], 3) |&gt; Enum.to_list()\n# [2.0, 3.0, 4.0]\n</code></pre>"},{"location":"elixir/part-4/#910-unfold","title":"9.10 unfold \u306b\u3088\u308b\u30b9\u30c8\u30ea\u30fc\u30e0\u751f\u6210","text":"<p><code>Stream.unfold/2</code> \u3067\u72b6\u614b\u3092\u6301\u3064\u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u751f\u6210\u3067\u304d\u307e\u3059\u3002</p> <pre><code># \u30d5\u30a3\u30dc\u30ca\u30c3\u30c1\u6570\u5217\ndef fibonacci do\n  Stream.unfold({0, 1}, fn {a, b} -&gt;\n    {a, {b, a + b}}\n  end)\nend\n\nfibonacci() |&gt; Enum.take(10)\n# [0, 1, 1, 2, 3, 5, 8, 13, 21, 34]\n\n# \u7b49\u6bd4\u6570\u5217\ndef geometric_series(start, ratio) do\n  Stream.unfold(start, fn current -&gt;\n    {current, current * ratio}\n  end)\nend\n\ngeometric_series(1, 2) |&gt; Enum.take(5)\n# [1, 2, 4, 8, 16]\n\n# \u7b49\u5dee\u6570\u5217\ndef arithmetic_series(start, diff) do\n  Stream.unfold(start, fn current -&gt;\n    {current, current + diff}\n  end)\nend\n\narithmetic_series(1, 3) |&gt; Enum.take(5)\n# [1, 4, 7, 10, 13]\n</code></pre>"},{"location":"elixir/part-4/#_10","title":"\u307e\u3068\u3081","text":""},{"location":"elixir/part-4/#part-iv","title":"Part IV \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"elixir/part-4/#scala","title":"Scala \u3068\u306e\u5bfe\u5fdc","text":"Scala Elixir <code>IO[A]</code> <code>(-&gt; any())</code> (\u7121\u540d\u95a2\u6570) <code>IO.delay(expr)</code> <code>delay(fn -&gt; expr end)</code> <code>IO.pure(value)</code> <code>pure(value)</code> <code>unsafeRunSync()</code> <code>run(io)</code> <code>flatMap</code> <code>flat_map/2</code> <code>orElse</code> <code>or_else/2</code> <code>sequence</code> <code>sequence/1</code> <code>fs2.Stream</code> <code>Stream</code> \u30e2\u30b8\u30e5\u30fc\u30eb <code>Stream.eval</code> <code>Stream.repeatedly</code> <code>sliding(n)</code> <code>Stream.chunk_every(n, 1, :discard)</code> <code>zipLeft</code> <code>zip_left/2</code>"},{"location":"elixir/part-4/#_11","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>\u9045\u5ef6\u5b9f\u884c\u30d1\u30bf\u30fc\u30f3: \u526f\u4f5c\u7528\u3092\u300c\u8a18\u8ff0\u300d\u3068\u3057\u3066\u6271\u3044\u3001\u5b9f\u884c\u3092\u9045\u5ef6\u3055\u305b\u308b</li> <li>delay/run: \u526f\u4f5c\u7528\u306e\u3042\u308b\u5f0f\u3092\u9045\u5ef6\u5b9f\u884c</li> <li>or_else: \u5931\u6557\u6642\u306e\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u3092\u6307\u5b9a</li> <li>sequence: <code>[IO]</code> \u2192 <code>IO[List]</code></li> <li>Stream: \u6f5c\u5728\u7684\u306b\u7121\u9650\u306e\u30b7\u30fc\u30b1\u30f3\u30b9\u3092\u9045\u5ef6\u8a55\u4fa1\u3067\u51e6\u7406</li> <li>sliding: \u9023\u7d9a\u3059\u308b\u8981\u7d20\u3092\u30b0\u30eb\u30fc\u30d7\u5316\u3057\u3066\u30d1\u30bf\u30fc\u30f3\u3092\u691c\u51fa</li> <li>unfold: \u72b6\u614b\u3092\u6301\u3064\u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u751f\u6210</li> </ol>"},{"location":"elixir/part-4/#elixir","title":"Elixir \u306e\u7279\u5fb4","text":"<ul> <li>Agent: \u30d7\u30ed\u30bb\u30b9\u30d9\u30fc\u30b9\u306e\u72b6\u614b\u7ba1\u7406</li> <li>Task: \u7c21\u5358\u306a\u975e\u540c\u671f\u51e6\u7406</li> <li>Stream: \u7d44\u307f\u8fbc\u307f\u306e\u9045\u5ef6\u8a55\u4fa1\u30b9\u30c8\u30ea\u30fc\u30e0</li> </ul>"},{"location":"elixir/part-4/#_12","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part V \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li>\u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406</li> <li>GenServer \u306b\u3088\u308b\u72b6\u614b\u7ba1\u7406</li> <li>Supervisor \u306b\u3088\u308b\u8010\u969c\u5bb3\u6027</li> </ul>"},{"location":"elixir/part-4/#_13","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"elixir/part-4/#1-io","title":"\u554f\u984c 1: IO \u306e\u57fa\u672c","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>def print_and_return(message) do\n  # \u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u51fa\u529b\u3057\u3066\u3001\u305d\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8fd4\u3059 IO \u3092\u4f5c\u6210\n  ???\nend\n\n# \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\n# io = print_and_return(\"Hello\")\n# run(io) \u306f \"Hello\" \u3092\u30b3\u30f3\u30bd\u30fc\u30eb\u306b\u51fa\u529b\u3057\u3001\"Hello\" \u3092\u8fd4\u3059\n</code></pre> \u89e3\u7b54 <pre><code>def print_and_return(message) do\n  delay(fn -&gt;\n    IO.puts(message)\n    message\n  end)\nend\n</code></pre>"},{"location":"elixir/part-4/#2-io","title":"\u554f\u984c 2: IO \u306e\u5408\u6210","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u30022\u3064\u306e IO \u3092\u9806\u756a\u306b\u5b9f\u884c\u3057\u3001\u7d50\u679c\u3092\u7d50\u5408\u3057\u307e\u3059\u3002</p> <pre><code>def combine_io(io1, io2, f) do\n  # io1 \u3068 io2 \u3092\u5b9f\u884c\u3057\u3001\u7d50\u679c\u3092 f \u3067\u7d50\u5408\n  ???\nend\n\n# \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\n# io = combine_io(pure(1), pure(2), &amp;(&amp;1 + &amp;2))\n# run(io)  # 3\n</code></pre> \u89e3\u7b54 <pre><code>def combine_io(io1, io2, f) do\n  flat_map(io1, fn a -&gt;\n    map(io2, fn b -&gt;\n      f.(a, b)\n    end)\n  end)\nend\n</code></pre>"},{"location":"elixir/part-4/#3","title":"\u554f\u984c 3: \u30ea\u30c8\u30e9\u30a4","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u6307\u5b9a\u56de\u6570\u30ea\u30c8\u30e9\u30a4\u3057\u3001\u5168\u90e8\u5931\u6557\u3057\u305f\u3089\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>def retry_with_default(io, max_retries, default) do\n  ???\nend\n</code></pre> \u89e3\u7b54 <pre><code>def retry_with_default(io, max_retries, default) do\n  fn -&gt;\n    try do\n      run(retry(io, max_retries))\n    rescue\n      _ -&gt; default\n    end\n  end\nend\n</code></pre>"},{"location":"elixir/part-4/#4","title":"\u554f\u984c 4: \u30b9\u30c8\u30ea\u30fc\u30e0\u64cd\u4f5c","text":"<p>\u4ee5\u4e0b\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u4f5c\u6210\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code># 1. 1\u304b\u308910\u307e\u3067\u306e\u5076\u6570\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\nevens = ???\n\n# 2. \u7121\u9650\u306b\u4ea4\u4e92\u306b true/false \u3092\u8fd4\u3059\u30b9\u30c8\u30ea\u30fc\u30e0\nalternating = ???\n\n# 3. \u6700\u521d\u306e5\u3064\u306e\u8981\u7d20\u306e\u5408\u8a08\u3092\u8a08\u7b97\nsum = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] |&gt; Stream.take(5) |&gt; ???\n</code></pre> \u89e3\u7b54 <pre><code># 1. 1\u304b\u308910\u307e\u3067\u306e\u5076\u6570\nevens = 1..10 |&gt; Stream.filter(&amp;(rem(&amp;1, 2) == 0))\n# \u307e\u305f\u306f\nevens = Stream.iterate(2, &amp;(&amp;1 + 2)) |&gt; Stream.take_while(&amp;(&amp;1 &lt;= 10))\n\n# 2. \u7121\u9650\u306b\u4ea4\u4e92\u306b true/false\nalternating = Stream.cycle([true, false])\n\n# 3. \u6700\u521d\u306e5\u3064\u306e\u8981\u7d20\u306e\u5408\u8a08\nsum = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] |&gt; Stream.take(5) |&gt; Enum.sum()  # 15\n</code></pre>"},{"location":"elixir/part-4/#5","title":"\u554f\u984c 5: \u30c8\u30ec\u30f3\u30c9\u691c\u51fa","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u76f4\u8fd13\u3064\u306e\u5024\u304c\u5168\u3066\u540c\u3058\u304b\u3069\u3046\u304b\u3092\u5224\u5b9a\u3057\u307e\u3059\u3002</p> <pre><code>def stable?(values) do\n  ???\nend\n\n# \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert stable?([5, 5, 5]) == true\nassert stable?([5, 5, 6]) == false\nassert stable?([5, 6, 5]) == false\nassert stable?([5]) == false  # 3\u3064\u672a\u6e80\u306f false\n</code></pre> \u89e3\u7b54 <pre><code>def stable?(values) when length(values) &lt; 3, do: false\n\ndef stable?(values) do\n  values |&gt; Enum.uniq() |&gt; length() == 1\nend\n</code></pre>"},{"location":"elixir/part-5/","title":"Part V: \u4e26\u884c\u51e6\u7406\u3068 OTP","text":"<p>\u672c\u7ae0\u3067\u306f\u3001Elixir \u306b\u304a\u3051\u308b\u4e26\u884c\u51e6\u7406\u3092\u5b66\u3073\u307e\u3059\u3002\u8efd\u91cf\u30d7\u30ed\u30bb\u30b9\u306b\u3088\u308b\u4e26\u884c\u5b9f\u884c\u3001Agent/Task \u306b\u3088\u308b\u5b89\u5168\u306a\u72b6\u614b\u7ba1\u7406\u3068\u975e\u540c\u671f\u51e6\u7406\u3001\u305d\u3057\u3066 OTP \u30d1\u30bf\u30fc\u30f3\uff08GenServer\u3001Supervisor\uff09\u306b\u3088\u308b\u5805\u7262\u306a\u4e26\u884c\u30b7\u30b9\u30c6\u30e0\u306e\u69cb\u7bc9\u65b9\u6cd5\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"elixir/part-5/#10","title":"\u7b2c10\u7ae0: \u4e26\u884c\u51e6\u7406","text":""},{"location":"elixir/part-5/#101","title":"10.1 \u4e26\u884c\u51e6\u7406\u306e\u8ab2\u984c","text":"<p>\u5f93\u6765\u306e\u4e26\u884c\u51e6\u7406\u306b\u306f\u591a\u304f\u306e\u8ab2\u984c\u304c\u3042\u308a\u307e\u3059:</p> <ul> <li>\u30c7\u30c3\u30c9\u30ed\u30c3\u30af</li> <li>\u7af6\u5408\u72b6\u614b\uff08Race Condition\uff09</li> <li>\u5171\u6709\u72b6\u614b\u306e\u7ba1\u7406\u306e\u8907\u96d1\u3055</li> <li>\u30b9\u30ec\u30c3\u30c9\u306e\u30aa\u30fc\u30d0\u30fc\u30d8\u30c3\u30c9</li> </ul> <p></p>"},{"location":"elixir/part-5/#102-elixir","title":"10.2 Elixir \u306e\u4e26\u884c\u30e2\u30c7\u30eb","text":"<p>Elixir \u306f \u30a2\u30af\u30bf\u30fc\u30e2\u30c7\u30eb \u306b\u57fa\u3065\u3044\u305f\u4e26\u884c\u51e6\u7406\u3092\u63d0\u4f9b\u3057\u307e\u3059:</p> <ul> <li>\u5404\u30d7\u30ed\u30bb\u30b9\u306f\u72ec\u7acb\u3057\u305f\u72b6\u614b\u3092\u6301\u3064</li> <li>\u30d7\u30ed\u30bb\u30b9\u9593\u306f\u30e1\u30c3\u30bb\u30fc\u30b8\u3067\u901a\u4fe1</li> <li>\u30d7\u30ed\u30bb\u30b9\u306f\u975e\u5e38\u306b\u8efd\u91cf\uff08\u6570 KB\uff09</li> <li>\u6570\u767e\u4e07\u306e\u30d7\u30ed\u30bb\u30b9\u3092\u540c\u6642\u306b\u5b9f\u884c\u53ef\u80fd</li> </ul> <p></p>"},{"location":"elixir/part-5/#103","title":"10.3 \u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u306e\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u96c6\u8a08","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/elixir/lib/ch10/concurrency.ex</code></p> <p>\u90fd\u5e02\u3078\u306e\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u3092\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u3067\u96c6\u8a08\u3057\u3001\u30e9\u30f3\u30ad\u30f3\u30b0\u3092\u66f4\u65b0\u3059\u308b\u4f8b\u3092\u898b\u3066\u3044\u304d\u307e\u3059\u3002</p> <pre><code>defmodule City do\n  defstruct [:name]\nend\n\ndefmodule CityStats do\n  defstruct [:city, :check_ins]\nend\n</code></pre>"},{"location":"elixir/part-5/#n","title":"\u30c8\u30c3\u30d7 N \u90fd\u5e02\u306e\u8a08\u7b97\uff08\u7d14\u7c8b\u95a2\u6570\uff09","text":"<pre><code>def top_cities(city_check_ins, n \\\\ 3) do\n  city_check_ins\n  |&gt; Enum.map(fn {city, check_ins} -&gt;\n    %CityStats{city: city, check_ins: check_ins}\n  end)\n  |&gt; Enum.sort_by(&amp; &amp;1.check_ins, :desc)\n  |&gt; Enum.take(n)\nend\n</code></pre>"},{"location":"elixir/part-5/#104-agent-","title":"10.4 Agent - \u5171\u6709\u72b6\u614b\u306e\u7ba1\u7406","text":"<p>Agent \u306f\u3001\u30d7\u30ed\u30bb\u30b9\u30d9\u30fc\u30b9\u306e\u72b6\u614b\u7ba1\u7406\u3092\u63d0\u4f9b\u3057\u307e\u3059\u3002Scala \u306e <code>Ref</code> \u306b\u76f8\u5f53\u3057\u307e\u3059\u3002</p> <pre><code># Agent \u306e\u4f5c\u6210\n{:ok, counter} = Agent.start_link(fn -&gt; 0 end)\n\n# \u5024\u306e\u53d6\u5f97\nAgent.get(counter, &amp; &amp;1)  # 0\n\n# \u30a2\u30c8\u30df\u30c3\u30af\u306a\u66f4\u65b0\nAgent.update(counter, &amp;(&amp;1 + 1))\nAgent.get(counter, &amp; &amp;1)  # 1\n\n# \u505c\u6b62\nAgent.stop(counter)\n</code></pre> <p></p>"},{"location":"elixir/part-5/#agent","title":"Agent \u306e\u4e3b\u8981\u95a2\u6570","text":"\u95a2\u6570 \u8aac\u660e \u4f8b <code>Agent.start_link(fun)</code> \u521d\u671f\u5024\u3067 Agent \u3092\u4f5c\u6210 <code>Agent.start_link(fn -&gt; 0 end)</code> <code>Agent.get(agent, fun)</code> \u73fe\u5728\u306e\u5024\u3092\u53d6\u5f97 <code>Agent.get(counter, &amp; &amp;1)</code> <code>Agent.update(agent, fun)</code> \u30a2\u30c8\u30df\u30c3\u30af\u306b\u66f4\u65b0 <code>Agent.update(counter, &amp;(&amp;1 + 1))</code> <code>Agent.get_and_update(agent, fun)</code> \u53d6\u5f97\u3068\u66f4\u65b0\u3092\u540c\u6642\u306b <code>Agent.get_and_update(counter, &amp;{&amp;1, &amp;1 + 1})</code>"},{"location":"elixir/part-5/#_1","title":"\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u30b9\u30c8\u30a2\u306e\u5b9f\u88c5","text":"<pre><code>def create_check_in_store do\n  Agent.start_link(fn -&gt; %{} end)\nend\n\ndef store_check_in(agent, city) do\n  Agent.update(agent, fn state -&gt;\n    Map.update(state, city, 1, &amp;(&amp;1 + 1))\n  end)\nend\n\ndef get_check_ins(agent) do\n  Agent.get(agent, &amp; &amp;1)\nend\n</code></pre>"},{"location":"elixir/part-5/#105-task-","title":"10.5 Task - \u4e26\u5217\u5b9f\u884c","text":"<p><code>Task</code> \u3092\u4f7f\u3063\u3066\u51e6\u7406\u3092\u4e26\u5217\u306b\u5b9f\u884c\u3067\u304d\u307e\u3059\u3002Scala \u306e <code>parSequence</code> \u306b\u76f8\u5f53\u3057\u307e\u3059\u3002</p> <pre><code># \u8907\u6570\u306e\u30bf\u30b9\u30af\u3092\u4e26\u5217\u5b9f\u884c\ntasks = [fn -&gt; 1 end, fn -&gt; 2 end, fn -&gt; 3 end]\n\nresults =\n  tasks\n  |&gt; Enum.map(&amp;Task.async/1)\n  |&gt; Task.await_many()\n\n# [1, 2, 3]\n</code></pre> <p></p>"},{"location":"elixir/part-5/#_2","title":"\u4e26\u5217\u30de\u30c3\u30d4\u30f3\u30b0","text":"<pre><code>def parallel_map(items, f) do\n  items\n  |&gt; Enum.map(fn item -&gt; Task.async(fn -&gt; f.(item) end) end)\n  |&gt; Task.await_many()\nend\n\n# \u4f7f\u7528\u4f8b\nparallel_map([1, 2, 3], &amp;(&amp;1 * 2))  # [2, 4, 6]\n</code></pre>"},{"location":"elixir/part-5/#106","title":"10.6 \u30b5\u30a4\u30b3\u30ed\u3092\u4e26\u884c\u3057\u3066\u632f\u308b","text":"<pre><code>def cast_the_die do\n  :rand.uniform(6)\nend\n\ndef cast_dice_parallel(n) do\n  1..n\n  |&gt; Enum.map(fn _ -&gt; Task.async(&amp;cast_the_die/0) end)\n  |&gt; Task.await_many()\n  |&gt; Enum.sum()\nend\n\n# 3\u3064\u306e\u30b5\u30a4\u30b3\u30ed\u3092\u4e26\u884c\u3057\u3066\u632f\u3063\u3066\u5408\u8a08\ncast_dice_parallel(3)  # 3\u301c18 \u306e\u5024\n</code></pre>"},{"location":"elixir/part-5/#agent-task","title":"Agent \u3068 Task \u306e\u7d44\u307f\u5408\u308f\u305b","text":"<pre><code>def cast_dice_and_store(n, agent) do\n  tasks =\n    1..n\n    |&gt; Enum.map(fn _ -&gt;\n      Task.async(fn -&gt;\n        result = cast_the_die()\n        Agent.update(agent, &amp;[result | &amp;1])\n        result\n      end)\n    end)\n\n  Task.await_many(tasks)\n  :ok\nend\n\n# \u4f7f\u7528\u4f8b\n{:ok, agent} = Agent.start_link(fn -&gt; [] end)\ncast_dice_and_store(5, agent)\nresults = Agent.get(agent, &amp; &amp;1)  # 5\u3064\u306e\u30b5\u30a4\u30b3\u30ed\u306e\u7d50\u679c\n</code></pre>"},{"location":"elixir/part-5/#107","title":"10.7 \u30d7\u30ed\u30bb\u30b9\u306b\u3088\u308b\u8efd\u91cf\u30b9\u30ec\u30c3\u30c9","text":"<p>Elixir \u306e\u30d7\u30ed\u30bb\u30b9\u306f\u3001Scala \u306e <code>Fiber</code> \u306b\u76f8\u5f53\u3059\u308b\u8efd\u91cf\u306a\u5b9f\u884c\u5358\u4f4d\u3067\u3059\u3002</p> <p></p>"},{"location":"elixir/part-5/#_3","title":"\u30d7\u30ed\u30bb\u30b9\u306e\u8d77\u52d5\u3068\u30ad\u30e3\u30f3\u30bb\u30eb","text":"<pre><code>def start_background(f) do\n  pid = spawn(f)\n  {:ok, pid}\nend\n\ndef cancel(pid) do\n  Process.exit(pid, :kill)\n  :ok\nend\n\n# \u4f7f\u7528\u4f8b\n{:ok, pid} = start_background(fn -&gt;\n  Process.sleep(1000)\n  IO.puts(\"done\")\nend)\n\n# \u9014\u4e2d\u3067\u30ad\u30e3\u30f3\u30bb\u30eb\ncancel(pid)\n</code></pre>"},{"location":"elixir/part-5/#_4","title":"\u7e70\u308a\u8fd4\u3057\u5b9f\u884c\u3059\u308b\u30d7\u30ed\u30bb\u30b9","text":"<pre><code>def start_repeating(f, interval_ms) do\n  pid =\n    spawn(fn -&gt;\n      repeat_forever(f, interval_ms)\n    end)\n\n  {:ok, pid}\nend\n\ndefp repeat_forever(f, interval_ms) do\n  f.()\n  Process.sleep(interval_ms)\n  repeat_forever(f, interval_ms)\nend\n\n# 100ms \u3054\u3068\u306b\u30ab\u30a6\u30f3\u30c8\u30a2\u30c3\u30d7\n{:ok, agent} = Agent.start_link(fn -&gt; 0 end)\n{:ok, pid} = start_repeating(fn -&gt; Agent.update(agent, &amp;(&amp;1 + 1)) end, 100)\n</code></pre>"},{"location":"elixir/part-5/#108","title":"10.8 \u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u51e6\u7406\u306e\u4e26\u884c\u7248","text":"<pre><code>defmodule ProcessingCheckIns do\n  defstruct [:check_in_store, :ranking_store, :ranking_updater_pid, :check_in_processor_pid]\nend\n\ndef start_processing(cities) do\n  {:ok, check_in_store} = create_check_in_store()\n  {:ok, ranking_store} = create_ranking_store()\n\n  # \u30e9\u30f3\u30ad\u30f3\u30b0\u66f4\u65b0\u30d7\u30ed\u30bb\u30b9\u3092\u8d77\u52d5\n  {:ok, ranking_updater_pid} =\n    start_repeating(\n      fn -&gt;\n        check_ins = get_check_ins(check_in_store)\n        ranking = top_cities(check_ins)\n        update_ranking(ranking_store, ranking)\n      end,\n      10\n    )\n\n  # \u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u51e6\u7406\u30d7\u30ed\u30bb\u30b9\u3092\u8d77\u52d5\n  check_in_processor_pid =\n    spawn(fn -&gt;\n      Enum.each(cities, fn city -&gt;\n        store_check_in(check_in_store, city)\n      end)\n    end)\n\n  {:ok, %ProcessingCheckIns{...}}\nend\n\ndef current_ranking(processing) do\n  get_ranking(processing.ranking_store)\nend\n\ndef stop_processing(processing) do\n  cancel(processing.ranking_updater_pid)\n  cancel(processing.check_in_processor_pid)\n  Agent.stop(processing.check_in_store)\n  Agent.stop(processing.ranking_store)\n  :ok\nend\n</code></pre>"},{"location":"elixir/part-5/#109","title":"10.9 \u4e26\u884c\u30ab\u30a6\u30f3\u30c8","text":"<pre><code>def count_evens(ios) do\n  {:ok, counter} = Agent.start_link(fn -&gt; 0 end)\n\n  ios\n  |&gt; Enum.map(fn io -&gt;\n    Task.async(fn -&gt;\n      n = io.()\n\n      if rem(n, 2) == 0 do\n        Agent.update(counter, &amp;(&amp;1 + 1))\n      end\n    end)\n  end)\n  |&gt; Task.await_many()\n\n  result = Agent.get(counter, &amp; &amp;1)\n  Agent.stop(counter)\n  result\nend\n\n# \u4f7f\u7528\u4f8b\nios = Enum.map(1..100, fn n -&gt; fn -&gt; n end end)\ncount_evens(ios)  # 50\n</code></pre>"},{"location":"elixir/part-5/#1010-processsleep","title":"10.10 Process.sleep \u306e\u7279\u6027","text":"<p>Elixir \u306e <code>Process.sleep</code> \u306f\u4ed6\u306e\u30d7\u30ed\u30bb\u30b9\u3092\u30d6\u30ed\u30c3\u30af\u3057\u307e\u305b\u3093\u3002</p> \u7279\u6027 Process.sleep Thread.sleep (Java) \u30d6\u30ed\u30c3\u30af\u5bfe\u8c61 \u73fe\u5728\u306e\u30d7\u30ed\u30bb\u30b9\u306e\u307f OS \u30b9\u30ec\u30c3\u30c9 \u30ea\u30bd\u30fc\u30b9 \u8efd\u91cf \u91cd\u3044 \u4e26\u884c\u6027 \u4ed6\u306e\u30d7\u30ed\u30bb\u30b9\u306f\u5b9f\u884c\u53ef\u80fd \u30b9\u30ec\u30c3\u30c9\u304c\u30d6\u30ed\u30c3\u30af <pre><code># 3\u3064\u306e\u30d7\u30ed\u30bb\u30b9\u3067\u4e26\u5217\u30b9\u30ea\u30fc\u30d7 \u2192 \u7d04100ms\u3067\u5b8c\u4e86\n{time, _} = :timer.tc(fn -&gt;\n  1..3\n  |&gt; Enum.map(fn _ -&gt; Task.async(fn -&gt; Process.sleep(100) end) end)\n  |&gt; Task.await_many()\nend)\n\ntime &lt; 200_000  # true\uff08200ms\u672a\u6e80\uff09\n</code></pre>"},{"location":"elixir/part-5/#11-otp","title":"\u7b2c11\u7ae0: OTP \u30d1\u30bf\u30fc\u30f3","text":""},{"location":"elixir/part-5/#111-otp","title":"11.1 OTP \u3068\u306f","text":"<p>OTP (Open Telecom Platform) \u306f\u3001Erlang/Elixir \u3067\u5805\u7262\u306a\u4e26\u884c\u30b7\u30b9\u30c6\u30e0\u3092\u69cb\u7bc9\u3059\u308b\u305f\u3081\u306e\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3067\u3059\u3002</p> <p>\u4e3b\u306a\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8: - GenServer: \u6c4e\u7528\u30b5\u30fc\u30d0\u30fc\u30d7\u30ed\u30bb\u30b9 - Supervisor: \u30d7\u30ed\u30bb\u30b9\u306e\u76e3\u8996\u3068\u518d\u8d77\u52d5 - Application: \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u7ba1\u7406</p> <p></p>"},{"location":"elixir/part-5/#112-genserver","title":"11.2 GenServer \u306b\u3088\u308b\u30ab\u30a6\u30f3\u30bf\u30fc","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/elixir/lib/ch11/otp_patterns.ex</code></p> <p>GenServer \u306f\u3001\u72b6\u614b\u3092\u6301\u3064\u30b5\u30fc\u30d0\u30fc\u30d7\u30ed\u30bb\u30b9\u3092\u7c21\u5358\u306b\u5b9f\u88c5\u3067\u304d\u307e\u3059\u3002</p> <pre><code>defmodule Counter do\n  use GenServer\n\n  # \u30af\u30e9\u30a4\u30a2\u30f3\u30c8 API\n\n  def start_link(initial_value \\\\ 0) do\n    GenServer.start_link(__MODULE__, initial_value)\n  end\n\n  def get(counter) do\n    GenServer.call(counter, :get)\n  end\n\n  def increment(counter) do\n    GenServer.cast(counter, :increment)\n  end\n\n  def add(counter, value) do\n    GenServer.cast(counter, {:add, value})\n  end\n\n  # \u30b5\u30fc\u30d0\u30fc\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\n\n  @impl true\n  def init(initial_value) do\n    {:ok, initial_value}\n  end\n\n  @impl true\n  def handle_call(:get, _from, state) do\n    {:reply, state, state}\n  end\n\n  @impl true\n  def handle_cast(:increment, state) do\n    {:noreply, state + 1}\n  end\n\n  @impl true\n  def handle_cast({:add, value}, state) do\n    {:noreply, state + value}\n  end\nend\n</code></pre> <pre><code># \u4f7f\u7528\u4f8b\n{:ok, counter} = Counter.start_link(0)\nCounter.get(counter)      # 0\nCounter.increment(counter)\nCounter.get(counter)      # 1\nCounter.add(counter, 10)\nCounter.get(counter)      # 11\nGenServer.stop(counter)\n</code></pre> <p></p>"},{"location":"elixir/part-5/#113-genserver","title":"11.3 GenServer \u306b\u3088\u308b\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u30b9\u30c8\u30a2","text":"<pre><code>defmodule CheckInStore do\n  use GenServer\n\n  # \u30af\u30e9\u30a4\u30a2\u30f3\u30c8 API\n\n  def start_link(opts \\\\ []) do\n    GenServer.start_link(__MODULE__, %{}, opts)\n  end\n\n  def check_in(store, city) do\n    GenServer.cast(store, {:check_in, city})\n  end\n\n  def get_count(store, city) do\n    GenServer.call(store, {:get_count, city})\n  end\n\n  def get_all(store) do\n    GenServer.call(store, :get_all)\n  end\n\n  def top_cities(store, n \\\\ 3) do\n    GenServer.call(store, {:top_cities, n})\n  end\n\n  # \u30b5\u30fc\u30d0\u30fc\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\n\n  @impl true\n  def init(state) do\n    {:ok, state}\n  end\n\n  @impl true\n  def handle_cast({:check_in, city}, state) do\n    new_state = Map.update(state, city, 1, &amp;(&amp;1 + 1))\n    {:noreply, new_state}\n  end\n\n  @impl true\n  def handle_call({:get_count, city}, _from, state) do\n    {:reply, Map.get(state, city, 0), state}\n  end\n\n  @impl true\n  def handle_call(:get_all, _from, state) do\n    {:reply, state, state}\n  end\n\n  @impl true\n  def handle_call({:top_cities, n}, _from, state) do\n    top =\n      state\n      |&gt; Enum.sort_by(fn {_city, count} -&gt; count end, :desc)\n      |&gt; Enum.take(n)\n\n    {:reply, top, state}\n  end\nend\n</code></pre>"},{"location":"elixir/part-5/#114","title":"11.4 \u5b9a\u671f\u5b9f\u884c\u30bf\u30b9\u30af","text":"<pre><code>defmodule PeriodicTask do\n  use GenServer\n\n  def start_link(task_fn, interval_ms) do\n    GenServer.start_link(__MODULE__, {task_fn, interval_ms})\n  end\n\n  @impl true\n  def init({task_fn, interval_ms}) do\n    schedule_work(interval_ms)\n    {:ok, %{task_fn: task_fn, interval_ms: interval_ms}}\n  end\n\n  @impl true\n  def handle_info(:work, %{task_fn: task_fn, interval_ms: interval_ms} = state) do\n    task_fn.()\n    schedule_work(interval_ms)\n    {:noreply, state}\n  end\n\n  defp schedule_work(interval_ms) do\n    Process.send_after(self(), :work, interval_ms)\n  end\nend\n\n# \u4f7f\u7528\u4f8b\uff1a100ms \u3054\u3068\u306b\u30bf\u30b9\u30af\u3092\u5b9f\u884c\n{:ok, agent} = Agent.start_link(fn -&gt; 0 end)\n{:ok, task} = PeriodicTask.start_link(\n  fn -&gt; Agent.update(agent, &amp;(&amp;1 + 1)) end,\n  100\n)\n</code></pre>"},{"location":"elixir/part-5/#115","title":"11.5 \u72b6\u614b\u30de\u30b7\u30f3","text":"<p>GenServer \u3067\u72b6\u614b\u30de\u30b7\u30f3\u3092\u5b9f\u88c5\u3067\u304d\u307e\u3059\u3002</p> <pre><code>defmodule TrafficLight do\n  use GenServer\n\n  def start_link do\n    GenServer.start_link(__MODULE__, :red)\n  end\n\n  def current(light) do\n    GenServer.call(light, :current)\n  end\n\n  def next(light) do\n    GenServer.cast(light, :next)\n  end\n\n  @impl true\n  def init(initial_state) do\n    {:ok, initial_state}\n  end\n\n  @impl true\n  def handle_call(:current, _from, state) do\n    {:reply, state, state}\n  end\n\n  @impl true\n  def handle_cast(:next, state) do\n    next_state =\n      case state do\n        :red -&gt; :green\n        :green -&gt; :yellow\n        :yellow -&gt; :red\n      end\n\n    {:noreply, next_state}\n  end\nend\n</code></pre> <p></p>"},{"location":"elixir/part-5/#116","title":"11.6 \u30b8\u30e7\u30d6\u30ad\u30e5\u30fc","text":"<pre><code>defmodule JobQueue do\n  use GenServer\n\n  def start_link do\n    GenServer.start_link(__MODULE__, :queue.new())\n  end\n\n  def enqueue(queue, job) do\n    GenServer.cast(queue, {:enqueue, job})\n  end\n\n  def dequeue(queue) do\n    GenServer.call(queue, :dequeue)\n  end\n\n  def size(queue) do\n    GenServer.call(queue, :size)\n  end\n\n  @impl true\n  def init(queue), do: {:ok, queue}\n\n  @impl true\n  def handle_cast({:enqueue, job}, queue) do\n    {:noreply, :queue.in(job, queue)}\n  end\n\n  @impl true\n  def handle_call(:dequeue, _from, queue) do\n    case :queue.out(queue) do\n      {{:value, job}, new_queue} -&gt; {:reply, {:ok, job}, new_queue}\n      {:empty, queue} -&gt; {:reply, :empty, queue}\n    end\n  end\n\n  @impl true\n  def handle_call(:size, _from, queue) do\n    {:reply, :queue.len(queue), queue}\n  end\nend\n</code></pre>"},{"location":"elixir/part-5/#117-supervisor","title":"11.7 Supervisor \u306b\u3088\u308b\u8010\u969c\u5bb3\u6027","text":"<p>Supervisor \u306f\u5b50\u30d7\u30ed\u30bb\u30b9\u3092\u76e3\u8996\u3057\u3001\u30af\u30e9\u30c3\u30b7\u30e5\u6642\u306b\u81ea\u52d5\u518d\u8d77\u52d5\u3057\u307e\u3059\u3002</p> <pre><code>defmodule CounterSupervisor do\n  use Supervisor\n\n  def start_link do\n    Supervisor.start_link(__MODULE__, :ok)\n  end\n\n  def get_counter(supervisor) do\n    [{_, counter, _, _}] = Supervisor.which_children(supervisor)\n    counter\n  end\n\n  @impl true\n  def init(:ok) do\n    children = [\n      {Counter, 0}\n    ]\n\n    Supervisor.init(children, strategy: :one_for_one)\n  end\nend\n</code></pre> <p></p>"},{"location":"elixir/part-5/#118-dynamicsupervisor","title":"11.8 DynamicSupervisor","text":"<p>\u52d5\u7684\u306b\u30d7\u30ed\u30bb\u30b9\u3092\u8ffd\u52a0\u30fb\u524a\u9664\u3067\u304d\u308b Supervisor \u3067\u3059\u3002</p> <pre><code>defmodule WorkerSupervisor do\n  use DynamicSupervisor\n\n  def start_link do\n    DynamicSupervisor.start_link(__MODULE__, :ok)\n  end\n\n  def start_worker(supervisor, initial_value) do\n    spec = {Counter, initial_value}\n    DynamicSupervisor.start_child(supervisor, spec)\n  end\n\n  def stop_worker(supervisor, worker) do\n    DynamicSupervisor.terminate_child(supervisor, worker)\n  end\n\n  def count_workers(supervisor) do\n    DynamicSupervisor.count_children(supervisor).active\n  end\n\n  @impl true\n  def init(:ok) do\n    DynamicSupervisor.init(strategy: :one_for_one)\n  end\nend\n\n# \u4f7f\u7528\u4f8b\n{:ok, sup} = WorkerSupervisor.start_link()\n{:ok, worker1} = WorkerSupervisor.start_worker(sup, 0)\n{:ok, worker2} = WorkerSupervisor.start_worker(sup, 100)\n\nCounter.increment(worker1)\nCounter.get(worker1)  # 1\nCounter.get(worker2)  # 100\n\nWorkerSupervisor.count_workers(sup)  # 2\n</code></pre>"},{"location":"elixir/part-5/#119-tasksupervisor","title":"11.9 Task.Supervisor","text":"<p>Task \u3092\u76e3\u8996\u4ed8\u304d\u3067\u5b9f\u884c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>defmodule TaskRunner do\n  def start_link do\n    Task.Supervisor.start_link()\n  end\n\n  def run_async(supervisor, task_fn) do\n    Task.Supervisor.async(supervisor, task_fn)\n  end\n\n  def run_all(supervisor, task_fns) do\n    task_fns\n    |&gt; Enum.map(&amp;Task.Supervisor.async(supervisor, &amp;1))\n    |&gt; Task.await_many()\n  end\n\n  def run_with_timeout(supervisor, task_fn, timeout_ms) do\n    task = Task.Supervisor.async_nolink(supervisor, task_fn)\n\n    case Task.yield(task, timeout_ms) do\n      {:ok, result} -&gt; {:ok, result}\n      nil -&gt;\n        Task.shutdown(task, :brutal_kill)\n        {:error, :timeout}\n    end\n  end\nend\n\n# \u4f7f\u7528\u4f8b\n{:ok, runner} = TaskRunner.start_link()\nresults = TaskRunner.run_all(runner, [fn -&gt; 1 end, fn -&gt; 2 end, fn -&gt; 3 end])\n# [1, 2, 3]\n</code></pre>"},{"location":"elixir/part-5/#1110-pubsub","title":"11.10 PubSub \u30d1\u30bf\u30fc\u30f3","text":"<p>Publish/Subscribe \u30d1\u30bf\u30fc\u30f3\u306e\u5b9f\u88c5\u3067\u3059\u3002</p> <pre><code>defmodule PubSub do\n  use GenServer\n\n  def start_link do\n    GenServer.start_link(__MODULE__, %{})\n  end\n\n  def subscribe(server, topic) do\n    GenServer.call(server, {:subscribe, topic, self()})\n  end\n\n  def unsubscribe(server, topic) do\n    GenServer.call(server, {:unsubscribe, topic, self()})\n  end\n\n  def publish(server, topic, message) do\n    GenServer.cast(server, {:publish, topic, message})\n  end\n\n  @impl true\n  def init(state), do: {:ok, state}\n\n  @impl true\n  def handle_call({:subscribe, topic, pid}, _from, state) do\n    subscribers = Map.get(state, topic, MapSet.new())\n    new_subscribers = MapSet.put(subscribers, pid)\n    {:reply, :ok, Map.put(state, topic, new_subscribers)}\n  end\n\n  @impl true\n  def handle_cast({:publish, topic, message}, state) do\n    subscribers = Map.get(state, topic, MapSet.new())\n\n    Enum.each(subscribers, fn pid -&gt;\n      send(pid, {:pubsub, topic, message})\n    end)\n\n    {:noreply, state}\n  end\nend\n\n# \u4f7f\u7528\u4f8b\n{:ok, pubsub} = PubSub.start_link()\nPubSub.subscribe(pubsub, \"events\")\nPubSub.publish(pubsub, \"events\", :hello)\n\nreceive do\n  {:pubsub, \"events\", message} -&gt; IO.inspect(message)  # :hello\nend\n</code></pre>"},{"location":"elixir/part-5/#_5","title":"\u307e\u3068\u3081","text":""},{"location":"elixir/part-5/#part-v","title":"Part V \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"elixir/part-5/#scala","title":"Scala \u3068\u306e\u5bfe\u5fdc","text":"Scala Elixir <code>Ref[IO, A]</code> <code>Agent</code> <code>parSequence</code> <code>Task.await_many</code> <code>Fiber</code> \u30d7\u30ed\u30bb\u30b9\uff08<code>spawn</code>\uff09 <code>fiber.start</code> <code>spawn</code> / <code>Task.async</code> <code>fiber.cancel</code> <code>Process.exit(pid, :kill)</code> <code>foreverM</code> \u518d\u5e30\u7684\u30d7\u30ed\u30bb\u30b9 - <code>GenServer</code> - <code>Supervisor</code>"},{"location":"elixir/part-5/#_6","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>Agent: \u30d7\u30ed\u30bb\u30b9\u30d9\u30fc\u30b9\u306e\u72b6\u614b\u7ba1\u7406\uff08Ref \u76f8\u5f53\uff09</li> <li>Task: \u975e\u540c\u671f\u30bf\u30b9\u30af\u306e\u5b9f\u884c\u3068\u7d50\u679c\u306e\u53d6\u5f97</li> <li>\u30d7\u30ed\u30bb\u30b9: \u8efd\u91cf\u306a\u5b9f\u884c\u5358\u4f4d\uff08\u6570\u767e\u4e07\u3082\u53ef\u80fd\uff09</li> <li>GenServer: \u6c4e\u7528\u7684\u306a\u30b5\u30fc\u30d0\u30fc\u30d7\u30ed\u30bb\u30b9</li> <li>Supervisor: \u30d7\u30ed\u30bb\u30b9\u306e\u76e3\u8996\u3068\u81ea\u52d5\u518d\u8d77\u52d5</li> <li>DynamicSupervisor: \u52d5\u7684\u306a\u30d7\u30ed\u30bb\u30b9\u7ba1\u7406</li> </ol>"},{"location":"elixir/part-5/#_7","title":"\u8a2d\u8a08\u30d1\u30bf\u30fc\u30f3","text":""},{"location":"elixir/part-5/#_8","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part VI \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li>\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9</li> <li>\u5916\u90e8 API \u3068\u306e\u9023\u643a</li> <li>\u30c6\u30b9\u30c8\u6226\u7565</li> </ul>"},{"location":"elixir/part-5/#_9","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"elixir/part-5/#1-agent","title":"\u554f\u984c 1: Agent \u306e\u57fa\u672c","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u30ab\u30a6\u30f3\u30bf\u30fc\u3092 0 \u304b\u3089\u59cb\u3081\u3066\u30013\u56de\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\u3057\u305f\u7d50\u679c\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>def increment_three_times do\n  ???\nend\n\n# \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nincrement_three_times()  # 3\n</code></pre> \u89e3\u7b54 <pre><code>def increment_three_times do\n  {:ok, counter} = Agent.start_link(fn -&gt; 0 end)\n  Agent.update(counter, &amp;(&amp;1 + 1))\n  Agent.update(counter, &amp;(&amp;1 + 1))\n  Agent.update(counter, &amp;(&amp;1 + 1))\n  result = Agent.get(counter, &amp; &amp;1)\n  Agent.stop(counter)\n  result\nend\n</code></pre>"},{"location":"elixir/part-5/#2","title":"\u554f\u984c 2: \u4e26\u5217\u5b9f\u884c","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u30023\u3064\u306e\u30bf\u30b9\u30af\u3092\u4e26\u5217\u5b9f\u884c\u3057\u3001\u7d50\u679c\u306e\u5408\u8a08\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>def sum_parallel(tasks) do\n  ???\nend\n\n# \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nsum_parallel([fn -&gt; 1 end, fn -&gt; 2 end, fn -&gt; 3 end])  # 6\n</code></pre> \u89e3\u7b54 <pre><code>def sum_parallel(tasks) do\n  tasks\n  |&gt; Enum.map(&amp;Task.async/1)\n  |&gt; Task.await_many()\n  |&gt; Enum.sum()\nend\n</code></pre>"},{"location":"elixir/part-5/#3-genserver","title":"\u554f\u984c 3: GenServer","text":"<p>\u4ee5\u4e0b\u306e GenServer \u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u30ea\u30b9\u30c8\u3092\u7ba1\u7406\u3057\u3001\u8981\u7d20\u306e\u8ffd\u52a0\u3068\u53d6\u5f97\u304c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>defmodule ListStore do\n  use GenServer\n\n  # ???\nend\n\n# \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\n{:ok, store} = ListStore.start_link()\nListStore.add(store, 1)\nListStore.add(store, 2)\nListStore.add(store, 3)\nListStore.get_all(store)  # [1, 2, 3]\n</code></pre> \u89e3\u7b54 <pre><code>defmodule ListStore do\n  use GenServer\n\n  def start_link do\n    GenServer.start_link(__MODULE__, [])\n  end\n\n  def add(store, item) do\n    GenServer.cast(store, {:add, item})\n  end\n\n  def get_all(store) do\n    GenServer.call(store, :get_all)\n  end\n\n  @impl true\n  def init(state), do: {:ok, state}\n\n  @impl true\n  def handle_cast({:add, item}, state) do\n    {:noreply, state ++ [item]}\n  end\n\n  @impl true\n  def handle_call(:get_all, _from, state) do\n    {:reply, state, state}\n  end\nend\n</code></pre>"},{"location":"elixir/part-5/#4","title":"\u554f\u984c 4: \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u4ed8\u304d\u53ce\u96c6","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u6307\u5b9a\u6642\u9593\u5f8c\u306b\u30d7\u30ed\u30bb\u30b9\u3092\u505c\u6b62\u3057\u3001\u305d\u308c\u307e\u3067\u306b\u84c4\u7a4d\u3055\u308c\u305f\u7d50\u679c\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>def collect_for(duration_ms, interval_ms, generator) do\n  ???\nend\n\n# \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\n# 100ms \u9593\u300110ms \u3054\u3068\u306b\u4e71\u6570\u3092\u751f\u6210\nresults = collect_for(100, 10, fn -&gt; :rand.uniform(100) end)\n# \u7d0410\u500b\u306e\u8981\u7d20\u304c\u8fd4\u3055\u308c\u308b\n</code></pre> \u89e3\u7b54 <pre><code>def collect_for(duration_ms, interval_ms, generator) do\n  {:ok, collected} = Agent.start_link(fn -&gt; [] end)\n\n  {:ok, producer_pid} =\n    start_repeating(\n      fn -&gt;\n        value = generator.()\n        Agent.update(collected, &amp;[value | &amp;1])\n      end,\n      interval_ms\n    )\n\n  Process.sleep(duration_ms)\n  cancel(producer_pid)\n\n  result = Agent.get(collected, &amp;Enum.reverse/1)\n  Agent.stop(collected)\n  result\nend\n</code></pre>"},{"location":"elixir/part-5/#5-supervisor","title":"\u554f\u984c 5: Supervisor","text":"<p>\u4ee5\u4e0b\u306e Supervisor \u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u30022\u3064\u306e\u30ab\u30a6\u30f3\u30bf\u30fc\u3092\u76e3\u8996\u3057\u307e\u3059\u3002</p> <pre><code>defmodule DualCounterSupervisor do\n  use Supervisor\n\n  # ???\nend\n\n# \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\n{:ok, sup} = DualCounterSupervisor.start_link()\n{counter1, counter2} = DualCounterSupervisor.get_counters(sup)\nCounter.increment(counter1)\nCounter.get(counter1)  # 1\nCounter.get(counter2)  # 0\n</code></pre> \u89e3\u7b54 <pre><code>defmodule DualCounterSupervisor do\n  use Supervisor\n\n  def start_link do\n    Supervisor.start_link(__MODULE__, :ok)\n  end\n\n  def get_counters(supervisor) do\n    children = Supervisor.which_children(supervisor)\n    [{:counter1, c1, _, _}, {:counter2, c2, _, _}] = children\n    {c1, c2}\n  end\n\n  @impl true\n  def init(:ok) do\n    children = [\n      Supervisor.child_spec({Counter, 0}, id: :counter1),\n      Supervisor.child_spec({Counter, 0}, id: :counter2)\n    ]\n\n    Supervisor.init(children, strategy: :one_for_one)\n  end\nend\n</code></pre>"},{"location":"elixir/part-6/","title":"Part VI: \u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u3068\u30c6\u30b9\u30c8","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u3053\u308c\u307e\u3067\u5b66\u3093\u3060\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u6982\u5ff5\u3092\u7d71\u5408\u3057\u3001\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002\u307e\u305f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u30c6\u30b9\u30c8\u6226\u7565\u306b\u3064\u3044\u3066\u3082\u5b66\u3073\u307e\u3059\u3002</p>"},{"location":"elixir/part-6/#12","title":"\u7b2c12\u7ae0: \u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3068\u30c6\u30b9\u30c8\u6226\u7565","text":""},{"location":"elixir/part-6/#121-travelguide","title":"12.1 TravelGuide \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3","text":"<p>\u65c5\u884c\u30ac\u30a4\u30c9\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f8b\u306b\u3001\u5b9f\u8df5\u7684\u306a FP \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u69cb\u7bc9\u65b9\u6cd5\u3092\u5b66\u3073\u307e\u3059\u3002</p> <p></p>"},{"location":"elixir/part-6/#122","title":"12.2 \u30c9\u30e1\u30a4\u30f3\u30e2\u30c7\u30eb\u306e\u5b9a\u7fa9","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/elixir/lib/ch12/travel_guide.ex</code></p> <p>Elixir \u3067\u306f\u69cb\u9020\u4f53\uff08struct\uff09\u3092\u4f7f\u3063\u3066\u30c9\u30e1\u30a4\u30f3\u30e2\u30c7\u30eb\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002</p> <pre><code>defmodule LocationId do\n  @moduledoc \"\u4f4d\u7f6e\u60c5\u5831 ID\uff08Value Object\uff09\"\n  defstruct [:value]\n\n  @type t :: %__MODULE__{value: String.t()}\n\n  @spec new(String.t()) :: t()\n  def new(value), do: %__MODULE__{value: value}\nend\n\ndefmodule Location do\n  @moduledoc \"\u30ed\u30b1\u30fc\u30b7\u30e7\u30f3\"\n  defstruct [:id, :name, :population]\n\n  @type t :: %__MODULE__{\n          id: LocationId.t(),\n          name: String.t(),\n          population: non_neg_integer()\n        }\n\n  @spec new(LocationId.t(), String.t(), non_neg_integer()) :: t()\n  def new(id, name, population) do\n    %__MODULE__{id: id, name: name, population: population}\n  end\nend\n\ndefmodule Attraction do\n  @moduledoc \"\u30a2\u30c8\u30e9\u30af\u30b7\u30e7\u30f3\uff08\u89b3\u5149\u5730\uff09\"\n  defstruct [:name, :description, :location]\n\n  @type t :: %__MODULE__{\n          name: String.t(),\n          description: String.t() | nil,\n          location: Location.t()\n        }\n\n  @spec new(String.t(), String.t() | nil, Location.t()) :: t()\n  def new(name, description, location) do\n    %__MODULE__{name: name, description: description, location: location}\n  end\nend\n</code></pre>"},{"location":"elixir/part-6/#123","title":"12.3 \u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\u5c64\u306e\u62bd\u8c61\u5316","text":"<p>Elixir \u3067\u306f <code>@behaviour</code> \u3092\u4f7f\u7528\u3057\u3066\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002</p> <pre><code>defmodule DataAccess do\n  @moduledoc \"\"\"\n  \u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\u5c64\u306e\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\uff08\u632f\u308b\u821e\u3044\uff09\n\n  \u5b9f\u88c5\u30e2\u30b8\u30e5\u30fc\u30eb\u306f\u3053\u306e\u632f\u308b\u821e\u3044\u3092\u5b9f\u88c5\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n  \"\"\"\n\n  @type ordering :: :by_name | :by_location_population\n\n  @callback find_attractions(String.t(), ordering(), pos_integer()) ::\n              {:ok, [Attraction.t()]} | {:error, String.t()}\n\n  @callback find_artists_from_location(LocationId.t(), pos_integer()) ::\n              {:ok, [MusicArtist.t()]} | {:error, String.t()}\n\n  @callback find_movies_about_location(LocationId.t(), pos_integer()) ::\n              {:ok, [Movie.t()]} | {:error, String.t()}\n\n  @callback find_hotels_near_location(LocationId.t(), pos_integer()) ::\n              {:ok, [Hotel.t()]} | {:error, String.t()}\nend\n</code></pre> <p></p>"},{"location":"elixir/part-6/#124","title":"12.4 \u30b9\u30bf\u30d6\u5b9f\u88c5","text":"<p>\u30c6\u30b9\u30c8\u7528\u306e\u30b9\u30bf\u30d6\u5b9f\u88c5\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002</p> <pre><code>defmodule TestDataAccess do\n  @moduledoc \"\u30c6\u30b9\u30c8\u7528\u306e\u30b9\u30bf\u30d6\u5b9f\u88c5\"\n  @behaviour DataAccess\n\n  @impl true\n  def find_attractions(name, _ordering, limit) do\n    attractions =\n      case name do\n        \"Empty\" -&gt; []\n        _ -&gt;\n          [\n            Attraction.new(\"#{name} Tower\", \"A famous tower\", @test_location),\n            Attraction.new(\"#{name} Park\", \"A beautiful park\", @test_location),\n            Attraction.new(\"#{name} Museum\", \"A great museum\", @test_location)\n          ]\n      end\n\n    {:ok, Enum.take(attractions, limit)}\n  end\n\n  @impl true\n  def find_artists_from_location(_location_id, limit) do\n    artists = [\n      MusicArtist.new(\"Test Artist 1\", \"Pop\"),\n      MusicArtist.new(\"Test Artist 2\", \"Rock\")\n    ]\n\n    {:ok, Enum.take(artists, limit)}\n  end\n\n  # \u4ed6\u306e\u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u3082\u540c\u69d8\u306b\u5b9f\u88c5...\nend\n</code></pre>"},{"location":"elixir/part-6/#125-agent","title":"12.5 Agent \u3092\u4f7f\u7528\u3057\u305f\u30ad\u30e3\u30c3\u30b7\u30e5","text":"<p>Elixir \u306e Agent \u3092\u4f7f\u7528\u3057\u3066\u3001\u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u30ad\u30e3\u30c3\u30b7\u30e5\u3092\u5b9f\u88c5\u3057\u307e\u3059\u3002</p> <pre><code>defmodule CachedDataAccess do\n  @moduledoc \"\"\"\n  Agent \u3092\u4f7f\u3063\u305f\u30ad\u30e3\u30c3\u30b7\u30e5\u4ed8\u304d\u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\n  \"\"\"\n\n  @spec start_link(module()) :: {:ok, pid()}\n  def start_link(data_access_module) do\n    Agent.start_link(fn -&gt;\n      %{\n        module: data_access_module,\n        attractions_cache: %{},\n        artists_cache: %{},\n        movies_cache: %{},\n        hotels_cache: %{}\n      }\n    end)\n  end\n\n  @spec find_attractions(pid(), String.t(), DataAccess.ordering(), pos_integer()) ::\n          {:ok, [Attraction.t()]} | {:error, String.t()}\n  def find_attractions(cache, name, ordering, limit) do\n    key = \"#{name}-#{ordering}-#{limit}\"\n\n    Agent.get_and_update(cache, fn state -&gt;\n      case Map.get(state.attractions_cache, key) do\n        nil -&gt;\n          result = state.module.find_attractions(name, ordering, limit)\n\n          case result do\n            {:ok, attractions} -&gt;\n              new_cache = Map.put(state.attractions_cache, key, attractions)\n              {result, %{state | attractions_cache: new_cache}}\n\n            {:error, _} = error -&gt;\n              {error, state}\n          end\n\n        cached -&gt;\n          {{:ok, cached}, state}\n      end\n    end)\n  end\n\n  # \u4ed6\u306e\u30e1\u30bd\u30c3\u30c9\u3082\u540c\u69d8\u306b\u5b9f\u88c5...\nend\n</code></pre> <p></p>"},{"location":"elixir/part-6/#126","title":"12.6 \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u7d44\u307f\u7acb\u3066","text":"<p>\u3059\u3079\u3066\u306e\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002</p> <pre><code>@spec travel_guide(module(), String.t()) :: {:ok, TravelGuide.t()} | {:error, String.t()}\ndef travel_guide(data_access_module, attraction_name) do\n  case data_access_module.find_attractions(attraction_name, :by_location_population, 1) do\n    {:ok, []} -&gt;\n      {:error, \"No attractions found\"}\n\n    {:ok, [attraction | _]} -&gt;\n      build_guide(data_access_module, attraction, 1)\n\n    {:error, reason} -&gt;\n      {:error, reason}\n  end\nend\n\ndefp build_guide(data_access_module, attraction, attractions_searched) do\n  location_id = attraction.location.id\n\n  artists_result = data_access_module.find_artists_from_location(location_id, 2)\n  movies_result = data_access_module.find_movies_about_location(location_id, 2)\n\n  errors =\n    [artists_result, movies_result]\n    |&gt; Enum.filter(&amp;match?({:error, _}, &amp;1))\n    |&gt; Enum.map(fn {:error, reason} -&gt; reason end)\n\n  artists =\n    case artists_result do\n      {:ok, list} -&gt; list\n      {:error, _} -&gt; []\n    end\n\n  movies =\n    case movies_result do\n      {:ok, list} -&gt; list\n      {:error, _} -&gt; []\n    end\n\n  subjects = Enum.map(artists, &amp; &amp;1.name) ++ Enum.map(movies, &amp; &amp;1.name)\n  report = SearchReport.new(attractions_searched, errors)\n\n  {:ok, TravelGuide.new(attraction, subjects, report)}\nend\n</code></pre> <p></p>"},{"location":"elixir/part-6/#127-searchreport","title":"12.7 SearchReport \u306e\u5c0e\u5165","text":"<p>\u30c6\u30b9\u30c8\u53ef\u80fd\u6027\u3092\u9ad8\u3081\u308b\u305f\u3081\u3001<code>SearchReport</code> \u3092\u5c0e\u5165\u3057\u307e\u3059\u3002</p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/elixir/lib/ch12/travel_guide.ex</code></p> <pre><code>defmodule SearchReport do\n  @moduledoc \"\u691c\u7d22\u30ec\u30dd\u30fc\u30c8\"\n  defstruct [:attractions_searched, :errors]\n\n  @type t :: %__MODULE__{\n          attractions_searched: non_neg_integer(),\n          errors: [String.t()]\n        }\n\n  @spec new(non_neg_integer(), [String.t()]) :: t()\n  def new(attractions_searched, errors \\\\ []) do\n    %__MODULE__{attractions_searched: attractions_searched, errors: errors}\n  end\n\n  @spec empty() :: t()\n  def empty, do: new(0, [])\n\n  @spec add_error(t(), String.t()) :: t()\n  def add_error(%__MODULE__{} = report, error) do\n    %{report | errors: report.errors ++ [error]}\n  end\nend\n</code></pre> <p></p>"},{"location":"elixir/part-6/#_1","title":"\u30c6\u30b9\u30c8\u6226\u7565","text":""},{"location":"elixir/part-6/#128","title":"12.8 \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u30c6\u30b9\u30c8","text":"<p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u3067\u306f\u3001\u7d14\u7c8b\u95a2\u6570\u306e\u304a\u304b\u3052\u3067\u30c6\u30b9\u30c8\u304c\u975e\u5e38\u306b\u7c21\u5358\u306b\u306a\u308a\u307e\u3059\u3002</p> <p></p>"},{"location":"elixir/part-6/#129","title":"12.9 \u7d14\u7c8b\u95a2\u6570\u306e\u30c6\u30b9\u30c8","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/elixir/lib/ch12/testing.ex</code></p> <p>\u7d14\u7c8b\u95a2\u6570\u306f\u5165\u529b\u3068\u51fa\u529b\u3060\u3051\u3092\u8003\u3048\u308c\u3070\u3088\u3044\u305f\u3081\u3001\u30c6\u30b9\u30c8\u304c\u7c21\u5358\u3067\u3059\u3002</p> <pre><code># \u30c6\u30b9\u30c8\u5bfe\u8c61\u306e\u7d14\u7c8b\u95a2\u6570\n@spec filter_popular_locations([Location.t()], non_neg_integer()) :: [Location.t()]\ndef filter_popular_locations(locations, min_population) do\n  Enum.filter(locations, fn loc -&gt; loc.population &gt;= min_population end)\nend\n\n@spec sort_by_population([Attraction.t()]) :: [Attraction.t()]\ndef sort_by_population(attractions) do\n  Enum.sort_by(attractions, fn a -&gt; a.location.population end, :desc)\nend\n\n@spec aggregate_results([{:ok, any()} | {:error, String.t()}]) ::\n        {[any()], [String.t()]}\ndef aggregate_results(results) do\n  Enum.reduce(results, {[], []}, fn result, {successes, errors} -&gt;\n    case result do\n      {:ok, value} -&gt; {successes ++ [value], errors}\n      {:error, reason} -&gt; {successes, errors ++ [reason]}\n    end\n  end)\nend\n</code></pre>"},{"location":"elixir/part-6/#1210","title":"12.10 \u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/elixir/lib/ch12/testing.ex</code></p> <p>\u30e9\u30f3\u30c0\u30e0\u306a\u5165\u529b\u3092\u751f\u6210\u3057\u3066\u4e0d\u5909\u6761\u4ef6\u3092\u30c6\u30b9\u30c8\u3057\u307e\u3059\u3002</p> <pre><code>@doc \"\"\"\n\u30d7\u30ed\u30d1\u30c6\u30a3\u3092\u30c6\u30b9\u30c8\uff08\u6307\u5b9a\u56de\u6570\u5b9f\u884c\uff09\n\"\"\"\n@spec check_property(pos_integer(), (-&gt; boolean())) :: :ok | {:error, String.t()}\ndef check_property(iterations, property_fn) do\n  results =\n    Enum.map(1..iterations, fn _ -&gt;\n      try do\n        property_fn.()\n      rescue\n        _ -&gt; false\n      end\n    end)\n\n  if Enum.all?(results) do\n    :ok\n  else\n    failed_count = Enum.count(results, &amp;(!&amp;1))\n    {:error, \"Property failed #{failed_count}/#{iterations} times\"}\n  end\nend\n\n@doc \"\"\"\nfilter_popular_locations \u306e\u4e0d\u5909\u6761\u4ef6\u3092\u30c6\u30b9\u30c8\n\"\"\"\n@spec verify_filter_properties(pos_integer()) :: :ok | {:error, String.t()}\ndef verify_filter_properties(iterations) do\n  check_property(iterations, fn -&gt;\n    locations = random_locations(:rand.uniform(20))\n    min_population = random_positive_int(5_000_000)\n\n    result = TravelGuide.filter_popular_locations(locations, min_population)\n\n    # \u30d7\u30ed\u30d1\u30c6\u30a31: \u7d50\u679c\u306e\u30b5\u30a4\u30ba\u306f\u5165\u529b\u4ee5\u4e0b\n    size_property = length(result) &lt;= length(locations)\n\n    # \u30d7\u30ed\u30d1\u30c6\u30a32: \u7d50\u679c\u306e\u3059\u3079\u3066\u306e\u8981\u7d20\u306f\u6761\u4ef6\u3092\u6e80\u305f\u3059\n    all_meet_condition = Enum.all?(result, fn loc -&gt; loc.population &gt;= min_population end)\n\n    # \u30d7\u30ed\u30d1\u30c6\u30a33: \u6761\u4ef6\u3092\u6e80\u305f\u3059\u8981\u7d20\u306f\u3059\u3079\u3066\u7d50\u679c\u306b\u542b\u307e\u308c\u308b\n    qualifying = Enum.filter(locations, fn loc -&gt; loc.population &gt;= min_population end)\n    all_included = Enum.all?(qualifying, fn loc -&gt; loc in result end)\n\n    size_property and all_meet_condition and all_included\n  end)\nend\n</code></pre> <p></p>"},{"location":"elixir/part-6/#1211","title":"12.11 \u30e9\u30f3\u30c0\u30e0\u30c7\u30fc\u30bf\u751f\u6210","text":"<pre><code>@doc \"\"\"\n\u30e9\u30f3\u30c0\u30e0\u306a\u6587\u5b57\u5217\u3092\u751f\u6210\n\"\"\"\n@spec random_string(pos_integer()) :: String.t()\ndef random_string(length) do\n  :crypto.strong_rand_bytes(length)\n  |&gt; Base.encode64()\n  |&gt; binary_part(0, length)\nend\n\n@doc \"\"\"\n\u30e9\u30f3\u30c0\u30e0\u306a Location \u3092\u751f\u6210\n\"\"\"\n@spec random_location() :: Location.t()\ndef random_location do\n  id = LocationId.new(\"Q#{random_positive_int(1_000_000)}\")\n  name = random_string(8)\n  population = random_positive_int(10_000_000)\n  Location.new(id, name, population)\nend\n\n@doc \"\"\"\n\u30e9\u30f3\u30c0\u30e0\u306a Attraction \u3092\u751f\u6210\n\"\"\"\n@spec random_attraction() :: Attraction.t()\ndef random_attraction do\n  name = random_string(10)\n  description = if :rand.uniform(2) == 1, do: random_string(20), else: nil\n  location = random_location()\n  Attraction.new(name, description, location)\nend\n</code></pre>"},{"location":"elixir/part-6/#1212","title":"12.12 \u7d71\u5408\u30c6\u30b9\u30c8","text":"<pre><code>@doc \"\"\"\nTravelGuide \u306e\u7d71\u5408\u30c6\u30b9\u30c8\u3092\u5b9f\u884c\n\"\"\"\n@spec run_integration_tests() :: {:ok, map()}\ndef run_integration_tests do\n  tests = [\n    {:normal_case, fn -&gt;\n      case TravelGuide.travel_guide(TravelGuide.TestDataAccess, \"Tokyo\") do\n        {:ok, guide} -&gt;\n          guide.attraction.name == \"Tokyo Tower\" and\n            length(guide.subjects) &gt; 0 and\n            guide.search_report.errors == []\n\n        _ -&gt;\n          false\n      end\n    end},\n    {:empty_result, fn -&gt;\n      case TravelGuide.travel_guide(TravelGuide.TestDataAccess, \"Empty\") do\n        {:error, \"No attractions found\"} -&gt; true\n        _ -&gt; false\n      end\n    end},\n    {:error_handling, fn -&gt;\n      case TravelGuide.travel_guide(TravelGuide.FailingDataAccess, \"Test\") do\n        {:ok, guide} -&gt;\n          length(guide.search_report.errors) == 2\n\n        _ -&gt;\n          false\n      end\n    end},\n    {:cached_access, fn -&gt;\n      {:ok, cache} = TravelGuide.CachedDataAccess.start_link(TravelGuide.TestDataAccess)\n\n      result1 = TravelGuide.travel_guide_cached(cache, \"Tokyo\")\n      result2 = TravelGuide.travel_guide_cached(cache, \"Tokyo\")\n\n      stats = TravelGuide.CachedDataAccess.cache_stats(cache)\n      Agent.stop(cache)\n\n      case {result1, result2} do\n        {{:ok, g1}, {:ok, g2}} -&gt;\n          g1.attraction.name == g2.attraction.name and\n            stats.attractions &gt; 0\n\n        _ -&gt;\n          false\n      end\n    end}\n  ]\n\n  results =\n    Enum.map(tests, fn {name, test_fn} -&gt;\n      result =\n        try do\n          test_fn.()\n        rescue\n          _ -&gt; false\n        end\n\n      {name, result}\n    end)\n\n  passed = Enum.count(results, fn {_, r} -&gt; r end)\n  failed = Enum.count(results, fn {_, r} -&gt; !r end)\n\n  {:ok, %{passed: passed, failed: failed, results: results}}\nend\n</code></pre>"},{"location":"elixir/part-6/#1213","title":"12.13 \u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u30c6\u30b9\u30c8","text":"<pre><code>@doc \"\"\"\n\u95a2\u6570\u306e\u5b9f\u884c\u6642\u9593\u3092\u8a08\u6e2c\n\"\"\"\n@spec measure_time((-&gt; any())) :: {non_neg_integer(), any()}\ndef measure_time(fun) do\n  {time, result} = :timer.tc(fun)\n  {time, result}\nend\n\n@doc \"\"\"\n\u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u52b9\u679c\u3092\u6e2c\u5b9a\n\"\"\"\n@spec measure_cache_effect(pos_integer()) :: {:ok, map()}\ndef measure_cache_effect(iterations) do\n  # \u30ad\u30e3\u30c3\u30b7\u30e5\u306a\u3057\u306e\u6642\u9593\n  {uncached_time, _} =\n    measure_time(fn -&gt;\n      Enum.each(1..iterations, fn _ -&gt;\n        TravelGuide.travel_guide(TravelGuide.TestDataAccess, \"Tokyo\")\n      end)\n    end)\n\n  # \u30ad\u30e3\u30c3\u30b7\u30e5\u3042\u308a\u306e\u6642\u9593\n  {:ok, cache} = TravelGuide.CachedDataAccess.start_link(TravelGuide.TestDataAccess)\n\n  {cached_time, _} =\n    measure_time(fn -&gt;\n      Enum.each(1..iterations, fn _ -&gt;\n        TravelGuide.travel_guide_cached(cache, \"Tokyo\")\n      end)\n    end)\n\n  Agent.stop(cache)\n\n  {:ok,\n   %{\n     uncached_time: uncached_time,\n     cached_time: cached_time,\n     speedup: uncached_time / max(cached_time, 1)\n   }}\nend\n</code></pre>"},{"location":"elixir/part-6/#1214","title":"12.14 \u30c6\u30b9\u30c8\u30d4\u30e9\u30df\u30c3\u30c9","text":""},{"location":"elixir/part-6/#_2","title":"\u307e\u3068\u3081","text":""},{"location":"elixir/part-6/#part-vi_1","title":"Part VI \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"elixir/part-6/#_3","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>@behaviour \u306b\u3088\u308b\u62bd\u8c61\u5316: DataAccess \u632f\u308b\u821e\u3044\u3067\u5916\u90e8\u4f9d\u5b58\u3092\u62bd\u8c61\u5316</li> <li>Agent \u3067\u30ad\u30e3\u30c3\u30b7\u30e5: \u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u72b6\u614b\u7ba1\u7406</li> <li>\u30bf\u30d7\u30eb\u3067\u30a8\u30e9\u30fc\u51e6\u7406: <code>{:ok, value}</code> / <code>{:error, reason}</code> \u3067\u660e\u793a\u7684\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0</li> <li>SearchReport: \u30c6\u30b9\u30c8\u53ef\u80fd\u6027\u3068\u53ef\u89b3\u6e2c\u6027\u306e\u5411\u4e0a</li> <li>\u30b9\u30bf\u30d6: \u5916\u90e8\u4f9d\u5b58\u3092\u5dee\u3057\u66ff\u3048\u3066\u30c6\u30b9\u30c8</li> <li>\u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8: \u30e9\u30f3\u30c0\u30e0\u5165\u529b\u3067\u4e0d\u5909\u6761\u4ef6\u3092\u691c\u8a3c</li> </ol>"},{"location":"elixir/part-6/#scala","title":"Scala \u3068\u306e\u5bfe\u6bd4","text":"\u6982\u5ff5 Scala Elixir \u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9 <code>trait</code> <code>@behaviour</code> \u72b6\u614b\u7ba1\u7406 <code>Ref[IO, A]</code> <code>Agent</code> \u30ea\u30bd\u30fc\u30b9\u7ba1\u7406 <code>Resource[IO, A]</code> \u30d7\u30ed\u30bb\u30b9 / <code>with</code> \u30a8\u30e9\u30fc\u51e6\u7406 <code>Either[E, A]</code> <code>{:ok, a} \\| {:error, e}</code> \u975e\u540c\u671f\u51e6\u7406 <code>IO[A]</code> <code>Task</code> / <code>GenServer</code> \u30ad\u30e3\u30c3\u30b7\u30e5 <code>Ref</code> + <code>Map</code> <code>Agent</code> + <code>Map</code>"},{"location":"elixir/part-6/#_4","title":"\u5b66\u7fd2\u306e\u7dcf\u62ec","text":""},{"location":"elixir/part-6/#_5","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"elixir/part-6/#1-dataaccess","title":"\u554f\u984c 1: DataAccess \u306e\u62e1\u5f35","text":"<p>\u4ee5\u4e0b\u306e\u8981\u4ef6\u3067 <code>DataAccess</code> \u3092\u62e1\u5f35\u3057\u3066\u304f\u3060\u3055\u3044: - \u65b0\u3057\u3044\u30b3\u30fc\u30eb\u30d0\u30c3\u30af <code>find_restaurants_near_location</code> \u3092\u8ffd\u52a0 - \u623b\u308a\u5024\u306f <code>{:ok, [Restaurant.t()]} | {:error, String.t()}</code></p> \u89e3\u7b54 <pre><code>defmodule Restaurant do\n  defstruct [:name, :cuisine, :rating, :location]\n\n  @type t :: %__MODULE__{\n          name: String.t(),\n          cuisine: String.t(),\n          rating: float(),\n          location: Location.t()\n        }\n\n  @spec new(String.t(), String.t(), float(), Location.t()) :: t()\n  def new(name, cuisine, rating, location) do\n    %__MODULE__{name: name, cuisine: cuisine, rating: rating, location: location}\n  end\nend\n\n# DataAccess \u306b\u8ffd\u52a0\n@callback find_restaurants_near_location(LocationId.t(), pos_integer()) ::\n            {:ok, [Restaurant.t()]} | {:error, String.t()}\n\n# TestDataAccess \u306e\u5b9f\u88c5\n@impl true\ndef find_restaurants_near_location(_location_id, limit) do\n  restaurants = [\n    Restaurant.new(\"Test Restaurant 1\", \"Japanese\", 4.5, @test_location),\n    Restaurant.new(\"Test Restaurant 2\", \"Italian\", 4.0, @test_location)\n  ]\n\n  {:ok, Enum.take(restaurants, limit)}\nend\n</code></pre>"},{"location":"elixir/part-6/#2","title":"\u554f\u984c 2: \u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u306b\u5bfe\u3059\u308b\u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8\u3092\u66f8\u3044\u3066\u304f\u3060\u3055\u3044:</p> <pre><code>def merge_subjects(artists, movies) do\n  Enum.map(artists, &amp; &amp;1.name) ++ Enum.map(movies, &amp; &amp;1.name)\nend\n</code></pre> \u89e3\u7b54 <pre><code>@spec verify_merge_properties(pos_integer()) :: :ok | {:error, String.t()}\ndef verify_merge_properties(iterations) do\n  check_property(iterations, fn -&gt;\n    artist_count = :rand.uniform(10)\n    movie_count = :rand.uniform(10)\n\n    artists = Enum.map(1..artist_count, fn i -&gt;\n      MusicArtist.new(\"Artist #{i}\", nil)\n    end)\n\n    movies = Enum.map(1..movie_count, fn i -&gt;\n      Movie.new(\"Movie #{i}\", nil)\n    end)\n\n    result = TravelGuide.merge_subjects(artists, movies)\n\n    # \u30d7\u30ed\u30d1\u30c6\u30a31: \u7d50\u679c\u306e\u9577\u3055\u306f\u5165\u529b\u306e\u5408\u8a08\n    length_property = length(result) == artist_count + movie_count\n\n    # \u30d7\u30ed\u30d1\u30c6\u30a32: \u3059\u3079\u3066\u306e\u30a2\u30fc\u30c6\u30a3\u30b9\u30c8\u540d\u304c\u542b\u307e\u308c\u308b\n    artist_names = Enum.map(artists, &amp; &amp;1.name)\n    artists_included = Enum.all?(artist_names, fn n -&gt; n in result end)\n\n    # \u30d7\u30ed\u30d1\u30c6\u30a33: \u3059\u3079\u3066\u306e\u6620\u753b\u540d\u304c\u542b\u307e\u308c\u308b\n    movie_names = Enum.map(movies, &amp; &amp;1.name)\n    movies_included = Enum.all?(movie_names, fn n -&gt; n in result end)\n\n    length_property and artists_included and movies_included\n  end)\nend\n</code></pre>"},{"location":"elixir/part-6/#3","title":"\u554f\u984c 3: \u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u6709\u52b9\u671f\u9650","text":"<p><code>CachedDataAccess</code> \u306b\u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u6709\u52b9\u671f\u9650\u6a5f\u80fd\u3092\u8ffd\u52a0\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> \u89e3\u7b54 <pre><code>defmodule CachedDataAccessWithTTL do\n  @moduledoc \"\"\"\n  TTL\uff08\u6709\u52b9\u671f\u9650\uff09\u4ed8\u304d\u30ad\u30e3\u30c3\u30b7\u30e5\n  \"\"\"\n\n  @default_ttl_ms 60_000  # 60\u79d2\n\n  @spec start_link(module(), pos_integer()) :: {:ok, pid()}\n  def start_link(data_access_module, ttl_ms \\\\ @default_ttl_ms) do\n    Agent.start_link(fn -&gt;\n      %{\n        module: data_access_module,\n        ttl_ms: ttl_ms,\n        attractions_cache: %{}  # key =&gt; {value, timestamp}\n      }\n    end)\n  end\n\n  @spec find_attractions(pid(), String.t(), DataAccess.ordering(), pos_integer()) ::\n          {:ok, [Attraction.t()]} | {:error, String.t()}\n  def find_attractions(cache, name, ordering, limit) do\n    key = \"#{name}-#{ordering}-#{limit}\"\n    now = System.monotonic_time(:millisecond)\n\n    Agent.get_and_update(cache, fn state -&gt;\n      case Map.get(state.attractions_cache, key) do\n        {cached, timestamp} when now - timestamp &lt; state.ttl_ms -&gt;\n          # \u30ad\u30e3\u30c3\u30b7\u30e5\u304c\u6709\u52b9\n          {{:ok, cached}, state}\n\n        _ -&gt;\n          # \u30ad\u30e3\u30c3\u30b7\u30e5\u304c\u7121\u52b9\u307e\u305f\u306f\u5b58\u5728\u3057\u306a\u3044\n          result = state.module.find_attractions(name, ordering, limit)\n\n          case result do\n            {:ok, attractions} -&gt;\n              new_cache = Map.put(state.attractions_cache, key, {attractions, now})\n              {result, %{state | attractions_cache: new_cache}}\n\n            {:error, _} = error -&gt;\n              {error, state}\n          end\n      end\n    end)\n  end\nend\n</code></pre>"},{"location":"elixir/part-6/#_6","title":"\u30b7\u30ea\u30fc\u30ba\u5168\u4f53\u306e\u7dcf\u62ec","text":"<p>\u672c\u30b7\u30ea\u30fc\u30ba\u3067\u306f\u3001\u300cGrokking Functional Programming\u300d\u306e\u5185\u5bb9\u306b\u6cbf\u3063\u3066\u3001Elixir \u306b\u3088\u308b\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u790e\u304b\u3089\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u307e\u3067\u3092\u5b66\u3073\u307e\u3057\u305f\u3002</p>"},{"location":"elixir/part-6/#_7","title":"\u5b66\u3093\u3060\u4e3b\u306a\u6982\u5ff5","text":"Part \u7ae0 \u4e3b\u306a\u6982\u5ff5 I 1-2 \u7d14\u7c8b\u95a2\u6570\u3001\u30a4\u30df\u30e5\u30fc\u30bf\u30d3\u30ea\u30c6\u30a3 II 3-5 \u30d1\u30a4\u30d7\u6f14\u7b97\u5b50\u3001\u9ad8\u968e\u95a2\u6570\u3001Enum III 6-7 \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3001with \u5f0f IV 8-9 Stream\u3001\u518d\u5e30 V 10-11 \u4e26\u884c\u51e6\u7406\u3001OTP \u30d1\u30bf\u30fc\u30f3 VI 12 \u5b9f\u8df5\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3001\u30c6\u30b9\u30c8"},{"location":"elixir/part-6/#_8","title":"\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u5229\u70b9","text":"<ol> <li>\u4e88\u6e2c\u53ef\u80fd\u6027: \u7d14\u7c8b\u95a2\u6570\u306f\u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b</li> <li>\u30c6\u30b9\u30c8\u5bb9\u6613\u6027: \u526f\u4f5c\u7528\u304c\u306a\u3044\u305f\u3081\u30c6\u30b9\u30c8\u304c\u7c21\u5358</li> <li>\u5408\u6210\u53ef\u80fd\u6027: \u30d1\u30a4\u30d7\u6f14\u7b97\u5b50\u3067\u5c0f\u3055\u306a\u95a2\u6570\u3092\u7d44\u307f\u5408\u308f\u305b</li> <li>\u4e26\u884c\u5b89\u5168\u6027: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u306f\u7af6\u5408\u72b6\u614b\u3092\u9632\u3050</li> <li>\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0: \u660e\u78ba\u3067\u5b89\u5168\u306a\u30c7\u30fc\u30bf\u51e6\u7406</li> </ol>"},{"location":"elixir/part-6/#elixir","title":"Elixir \u7279\u6709\u306e\u5229\u70b9","text":"<ol> <li>OTP: \u5805\u7262\u306a\u4e26\u884c\u51e6\u7406\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af</li> <li>BEAM VM: \u8efd\u91cf\u30d7\u30ed\u30bb\u30b9\u3068\u9ad8\u3044\u30b9\u30b1\u30fc\u30e9\u30d3\u30ea\u30c6\u30a3</li> <li>\u30d1\u30a4\u30d7\u6f14\u7b97\u5b50: \u8aad\u307f\u3084\u3059\u3044\u30c7\u30fc\u30bf\u5909\u63db</li> <li>\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0: \u5f37\u529b\u306a\u5206\u5c90\u3068\u30c7\u30b9\u30c8\u30e9\u30af\u30c1\u30e3\u30ea\u30f3\u30b0</li> <li>\u30db\u30c3\u30c8\u30b3\u30fc\u30c9\u30b9\u30ef\u30c3\u30d7: \u7121\u505c\u6b62\u3067\u306e\u30b3\u30fc\u30c9\u66f4\u65b0</li> </ol>"},{"location":"elixir/part-6/#_9","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<ul> <li>Phoenix \u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3067\u306e Web \u958b\u767a</li> <li>Ecto \u3067\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u64cd\u4f5c</li> <li>LiveView \u3067\u306e\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0 UI</li> <li>Nerves \u3067\u306e\u7d44\u307f\u8fbc\u307f\u958b\u767a</li> <li>\u5b9f\u969b\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067 FP \u3092\u9069\u7528\u3059\u308b</li> </ul>"},{"location":"fsharp/","title":"Grokking Functional Programming \u65e5\u672c\u8a9e\u89e3\u8aac\uff08F# \u7248\uff09","text":"<p>\u672c\u30b7\u30ea\u30fc\u30ba\u306f\u300cGrokking Functional Programming\u300d\uff08Micha\u0142 P\u0142achta \u8457\uff09\u306e\u5b66\u7fd2\u30b3\u30f3\u30d1\u30cb\u30aa\u30f3\u3068\u3057\u3066\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u6982\u5ff5\u3092 F# \u3067\u5b9f\u88c5\u3057\u306a\u304c\u3089\u65e5\u672c\u8a9e\u3067\u89e3\u8aac\u3057\u307e\u3059\u3002</p>"},{"location":"fsharp/#_1","title":"\u5bfe\u8c61\u8aad\u8005","text":"<ul> <li>C# \u3084 .NET \u306e\u7d4c\u9a13\u304c\u3042\u308a\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u8208\u5473\u304c\u3042\u308b\u958b\u767a\u8005</li> <li>F# \u3092\u5b66\u3073\u305f\u3044\u304c\u3001FP \u306e\u6982\u5ff5\u304b\u3089\u7406\u89e3\u3057\u305f\u3044\u65b9</li> <li>\u5b9f\u8df5\u7684\u306a FP \u306e\u9069\u7528\u65b9\u6cd5\u3092\u77e5\u308a\u305f\u3044 .NET \u30a8\u30f3\u30b8\u30cb\u30a2</li> </ul>"},{"location":"fsharp/#_2","title":"\u8a18\u4e8b\u4e00\u89a7","text":""},{"location":"fsharp/#part-i","title":"Part I: \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u790e","text":"<p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u672c\u6982\u5ff5\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c1\u7ae0 \u547d\u4ee4\u578b vs \u95a2\u6570\u578b\u3001F# \u57fa\u672c\u69cb\u6587 \u7b2c2\u7ae0 \u7d14\u7c8b\u95a2\u6570\u3001\u526f\u4f5c\u7528\u306e\u6392\u9664\u3001\u30c6\u30b9\u30c8\u306e\u5bb9\u6613\u3055 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: \u7d14\u7c8b\u95a2\u6570\u3001\u53c2\u7167\u900f\u904e\u6027\u3001\u526f\u4f5c\u7528\u3001let \u30d0\u30a4\u30f3\u30c7\u30a3\u30f3\u30b0</p>"},{"location":"fsharp/#part-ii","title":"Part II: \u95a2\u6570\u578b\u30b9\u30bf\u30a4\u30eb\u306e\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0","text":"<p>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c\u3068\u9ad8\u968e\u95a2\u6570\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c3\u7ae0 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u3001List \u64cd\u4f5c \u7b2c4\u7ae0 \u9ad8\u968e\u95a2\u6570\u3001List.map/filter/fold \u7b2c5\u7ae0 \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50\u3001\u30b3\u30f3\u30d4\u30e5\u30c6\u30fc\u30b7\u30e7\u30f3\u5f0f <p>\u30ad\u30fc\u30ef\u30fc\u30c9: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u3001\u9ad8\u968e\u95a2\u6570\u3001\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\uff08|&gt;\uff09\u3001\u30b3\u30f3\u30d4\u30e5\u30c6\u30fc\u30b7\u30e7\u30f3\u5f0f</p>"},{"location":"fsharp/#part-iii-optionresult","title":"Part III: \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3068 Option/Result","text":"<p>\u578b\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c6\u7ae0 Option \u578b\u3001Some/None \u7b2c7\u7ae0 Result \u578b\u3001\u5224\u5225\u5171\u7528\u4f53\u3001\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: Option\u3001Result\u3001\u5224\u5225\u5171\u7528\u4f53\uff08Discriminated Union\uff09</p>"},{"location":"fsharp/#part-iv-async","title":"Part IV: Async \u3068\u526f\u4f5c\u7528\u306e\u7ba1\u7406","text":"<p>\u975e\u540c\u671f\u51e6\u7406\u3068\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c8\u7ae0 Async \u30ef\u30fc\u30af\u30d5\u30ed\u30fc\u3001\u975e\u540c\u671f\u30b3\u30f3\u30d4\u30e5\u30c6\u30fc\u30b7\u30e7\u30f3 \u7b2c9\u7ae0 Seq\uff08\u9045\u5ef6\u30b7\u30fc\u30b1\u30f3\u30b9\uff09\u3001AsyncSeq <p>\u30ad\u30fc\u30ef\u30fc\u30c9: Async\u3001\u9045\u5ef6\u8a55\u4fa1\u3001\u30b7\u30fc\u30b1\u30f3\u30b9\u51e6\u7406</p>"},{"location":"fsharp/#part-v","title":"Part V: \u4e26\u884c\u51e6\u7406","text":"<p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u4e26\u884c\u51e6\u7406\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c10\u7ae0 MailboxProcessor\u3001Async.Parallel <p>\u30ad\u30fc\u30ef\u30fc\u30c9: \u4e26\u884c\u51e6\u7406\u3001MailboxProcessor\uff08Agent\uff09\u3001Async.Parallel</p>"},{"location":"fsharp/#part-vi","title":"Part VI: \u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u3068\u30c6\u30b9\u30c8","text":"<p>\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u3068\u30c6\u30b9\u30c8\u6226\u7565\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c11\u7ae0 TravelGuide \u30a2\u30d7\u30ea\u3001use \u30d0\u30a4\u30f3\u30c7\u30a3\u30f3\u30b0\u3001\u30ad\u30e3\u30c3\u30b7\u30e5 \u7b2c12\u7ae0 \u30c6\u30b9\u30c8\u6226\u7565\u3001FsCheck \u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: use\uff08\u30ea\u30bd\u30fc\u30b9\u7ba1\u7406\uff09\u3001Type Provider\u3001FsCheck</p>"},{"location":"fsharp/#_3","title":"\u5b66\u7fd2\u30d1\u30b9","text":""},{"location":"fsharp/#_4","title":"\u4f7f\u7528\u30e9\u30a4\u30d6\u30e9\u30ea","text":"\u30e9\u30a4\u30d6\u30e9\u30ea \u7528\u9014 \u5bfe\u5fdc\u7ae0 F# 8 \u8a00\u8a9e \u5168\u7ae0 FSharp.Core \u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea \u5168\u7ae0 FSharpPlus \u62e1\u5f35\u95a2\u6570\u578b\u30e9\u30a4\u30d6\u30e9\u30ea Part IV-VI FsCheck \u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8 Part VI"},{"location":"fsharp/#_5","title":"\u30ea\u30dd\u30b8\u30c8\u30ea\u69cb\u6210","text":"<pre><code>grokkingfp-examples/\n\u251c\u2500\u2500 app/fsharp/src/           # F# \u306e\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n\u2502   \u251c\u2500\u2500 Ch03/                 # \u7b2c3\u7ae0: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\n\u2502   \u251c\u2500\u2500 Ch04/                 # \u7b2c4\u7ae0: \u9ad8\u968e\u95a2\u6570\n\u2502   \u251c\u2500\u2500 Ch05/                 # \u7b2c5\u7ae0: \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\n\u2502   \u251c\u2500\u2500 Ch06/                 # \u7b2c6\u7ae0: Option\n\u2502   \u251c\u2500\u2500 Ch07/                 # \u7b2c7\u7ae0: Result\n\u2502   \u251c\u2500\u2500 Ch08/                 # \u7b2c8\u7ae0: Async\n\u2502   \u251c\u2500\u2500 Ch09/                 # \u7b2c9\u7ae0: Seq\n\u2502   \u251c\u2500\u2500 Ch10/                 # \u7b2c10\u7ae0: \u4e26\u884c\u51e6\u7406\n\u2502   \u251c\u2500\u2500 Ch11/                 # \u7b2c11\u7ae0: \u5b9f\u8df5\u30a2\u30d7\u30ea\n\u2502   \u2514\u2500\u2500 Ch12/                 # \u7b2c12\u7ae0: \u30c6\u30b9\u30c8\n\u251c\u2500\u2500 app/fsharp/tests/         # \u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\n\u2514\u2500\u2500 docs/article/fsharp/      # \u89e3\u8aac\u8a18\u4e8b\uff08\u672c\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\uff09\n    \u251c\u2500\u2500 index.md              # \u3053\u306e\u8a18\u4e8b\n    \u251c\u2500\u2500 part-1.md             # Part I\n    \u251c\u2500\u2500 part-2.md             # Part II\n    \u251c\u2500\u2500 part-3.md             # Part III\n    \u251c\u2500\u2500 part-4.md             # Part IV\n    \u251c\u2500\u2500 part-5.md             # Part V\n    \u2514\u2500\u2500 part-6.md             # Part VI\n</code></pre>"},{"location":"fsharp/#f","title":"F# \u306e\u7279\u5fb4","text":"<p>F# \u306f .NET \u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u4e0a\u3067\u52d5\u4f5c\u3059\u308b\u95a2\u6570\u578b\u30d5\u30a1\u30fc\u30b9\u30c8\u306e\u8a00\u8a9e\u3067\u3059:</p>"},{"location":"fsharp/#_6","title":"\u8a00\u8a9e\u306e\u7279\u5fb4","text":"\u7279\u5fb4 \u8aac\u660e \u95a2\u6570\u578b\u30d5\u30a1\u30fc\u30b9\u30c8 \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u3092\u7b2c\u4e00\u306b\u8a2d\u8a08 \u578b\u63a8\u8ad6 \u5f37\u529b\u306a\u578b\u63a8\u8ad6\u306b\u3088\u308a\u7c21\u6f54\u306a\u30b3\u30fc\u30c9 \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3 <code>\\|&gt;</code> \u6f14\u7b97\u5b50\u306b\u3088\u308b\u30c7\u30fc\u30bf\u30d5\u30ed\u30fc\u306e\u8868\u73fe \u5224\u5225\u5171\u7528\u4f53 \u4ee3\u6570\u7684\u30c7\u30fc\u30bf\u578b\u306e\u30cd\u30a4\u30c6\u30a3\u30d6\u30b5\u30dd\u30fc\u30c8 \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0 \u5f37\u529b\u306a\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0 .NET \u4e92\u63db C# \u30e9\u30a4\u30d6\u30e9\u30ea\u3068\u306e\u5b8c\u5168\u306a\u76f8\u4e92\u904b\u7528"},{"location":"fsharp/#scala","title":"Scala \u3068\u306e\u6bd4\u8f03","text":"\u6982\u5ff5 Scala F# \u8a00\u8a9e\u30d1\u30e9\u30c0\u30a4\u30e0 \u30de\u30eb\u30c1\u30d1\u30e9\u30c0\u30a4\u30e0 \u95a2\u6570\u578b\u30d5\u30a1\u30fc\u30b9\u30c8 \u5b9f\u884c\u74b0\u5883 JVM .NET (CLR) Option \u578b <code>Option[A]</code> <code>Option&lt;'a&gt;</code> \u307e\u305f\u306f <code>'a option</code> Either/Result <code>Either[E, A]</code> <code>Result&lt;'a, 'e&gt;</code> ADT <code>sealed trait</code> + <code>case class</code> \u5224\u5225\u5171\u7528\u4f53 for \u5185\u5305\u8868\u8a18 <code>for { ... } yield</code> \u30b3\u30f3\u30d4\u30e5\u30c6\u30fc\u30b7\u30e7\u30f3\u5f0f \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3 \u30e1\u30bd\u30c3\u30c9\u30c1\u30a7\u30fc\u30f3 <code>\\|&gt;</code> \u6f14\u7b97\u5b50 \u975e\u540c\u671f <code>IO[A]</code> (cats-effect) <code>Async&lt;'a&gt;</code> \u30b9\u30c8\u30ea\u30fc\u30e0 <code>fs2.Stream</code> <code>Seq&lt;'a&gt;</code> / <code>AsyncSeq</code>"},{"location":"fsharp/#_7","title":"\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u5229\u70b9","text":"<p>\u672c\u30b7\u30ea\u30fc\u30ba\u3092\u901a\u3058\u3066\u3001\u4ee5\u4e0b\u306e\u5229\u70b9\u3092\u5b9f\u611f\u3067\u304d\u307e\u3059:</p> <ol> <li>\u4e88\u6e2c\u53ef\u80fd\u6027 - \u7d14\u7c8b\u95a2\u6570\u306f\u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b</li> <li>\u30c6\u30b9\u30c8\u5bb9\u6613\u6027 - \u526f\u4f5c\u7528\u304c\u306a\u3044\u305f\u3081\u30c6\u30b9\u30c8\u304c\u7c21\u5358</li> <li>\u5408\u6210\u53ef\u80fd\u6027 - \u5c0f\u3055\u306a\u95a2\u6570\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u8907\u96d1\u306a\u51e6\u7406\u3092\u69cb\u7bc9</li> <li>\u4e26\u884c\u5b89\u5168\u6027 - \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u306f\u7af6\u5408\u72b6\u614b\u3092\u9632\u3050</li> <li>\u578b\u5b89\u5168\u6027 - Option\u3001Result \u3067 null \u3084\u4f8b\u5916\u3092\u578b\u3067\u8868\u73fe</li> </ol>"},{"location":"fsharp/#_8","title":"\u53c2\u8003\u8cc7\u6599","text":"<ul> <li>Grokking Functional Programming - \u539f\u8457</li> <li>F# \u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8</li> <li>F# for Fun and Profit - F# \u5b66\u7fd2\u30b5\u30a4\u30c8</li> <li>FSharpPlus \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8</li> <li>FsCheck \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8</li> </ul>"},{"location":"fsharp/part-1/","title":"Part I: \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u790e","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\uff08FP\uff09\u306e\u57fa\u672c\u6982\u5ff5\u3092\u5b66\u3073\u307e\u3059\u3002\u547d\u4ee4\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u3068\u306e\u9055\u3044\u3092\u7406\u89e3\u3057\u3001\u7d14\u7c8b\u95a2\u6570\u306e\u5229\u70b9\u3092\u5b9f\u611f\u3059\u308b\u3053\u3068\u304c\u76ee\u6a19\u3067\u3059\u3002</p>"},{"location":"fsharp/part-1/#1","title":"\u7b2c1\u7ae0: \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u5165\u9580","text":""},{"location":"fsharp/part-1/#11-vs","title":"1.1 \u547d\u4ee4\u578b vs \u95a2\u6570\u578b","text":"<p>\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u306f\u5927\u304d\u304f\u5206\u3051\u30662\u3064\u306e\u30d1\u30e9\u30c0\u30a4\u30e0\u304c\u3042\u308a\u307e\u3059\u3002</p> <p></p> <p>\u547d\u4ee4\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306f\u300c\u3069\u3046\u3084\u308b\u304b\u300d\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002</p> <pre><code>// F#: \u547d\u4ee4\u578b\u3067\u30ef\u30fc\u30c9\u30b9\u30b3\u30a2\u3092\u8a08\u7b97\nlet wordScoreImperative (word: string) : int =\n    let mutable score = 0\n    for _ in word do\n        score &lt;- score + 1\n    score\n</code></pre> <p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306f\u300c\u4f55\u3092\u3059\u308b\u304b\u300d\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002</p> <pre><code>// F#: \u95a2\u6570\u578b\u3067\u30ef\u30fc\u30c9\u30b9\u30b3\u30a2\u3092\u8a08\u7b97\nlet wordScore (word: string) : int =\n    word.Length\n</code></pre>"},{"location":"fsharp/part-1/#12-f","title":"1.2 F# \u306e\u57fa\u672c\u69cb\u6587","text":"<p>F# \u3067\u306e\u95a2\u6570\u5b9a\u7fa9\u306e\u57fa\u672c\u5f62\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/fsharp/src/Ch01/IntroFSharp.fs</code></p> <pre><code>/// \u6570\u5024\u3092\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\nlet increment (x: int) : int =\n    x + 1\n\n/// \u6587\u5b57\u5217\u306e\u6700\u521d\u306e\u6587\u5b57\u3092\u53d6\u5f97\nlet getFirstCharacter (s: string) : char =\n    s.[0]\n\n/// \u5358\u8a9e\u306e\u30b9\u30b3\u30a2\u3092\u8a08\u7b97\uff08\u6587\u5b57\u6570\uff09\nlet wordScore (word: string) : int =\n    word.Length\n</code></pre>"},{"location":"fsharp/part-1/#13","title":"1.3 \u95a2\u6570\u306e\u69cb\u9020","text":""},{"location":"fsharp/part-1/#14-f","title":"1.4 F# \u306e\u7279\u5fb4\u7684\u306a\u69cb\u6587","text":""},{"location":"fsharp/part-1/#_1","title":"\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50","text":"<p>F# \u3067\u306f <code>|&gt;</code> \u6f14\u7b97\u5b50\u3092\u4f7f\u3063\u3066\u3001\u30c7\u30fc\u30bf\u306e\u6d41\u308c\u3092\u5de6\u304b\u3089\u53f3\u306b\u8a18\u8ff0\u3067\u304d\u307e\u3059\u3002</p> <pre><code>/// \u6587\u5b57\u5217\u3092\u5927\u6587\u5b57\u306b\u5909\u63db\u3057\u3066\u30b9\u30b3\u30a2\u3092\u8a08\u7b97\nlet scoreUpperCase (word: string) : int =\n    word\n    |&gt; fun s -&gt; s.ToUpper()\n    |&gt; fun s -&gt; s.Length\n\n/// \u8907\u6570\u306e\u5909\u63db\u3092\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u9023\u7d50\nlet processWord (word: string) : string =\n    word\n    |&gt; fun s -&gt; s.Trim()\n    |&gt; fun s -&gt; s.ToLower()\n    |&gt; fun s -&gt; s.Replace(\" \", \"\")\n</code></pre>"},{"location":"fsharp/part-1/#_2","title":"\u578b\u63a8\u8ad6","text":"<p>F# \u306f\u5f37\u529b\u306a\u578b\u63a8\u8ad6\u3092\u6301\u3063\u3066\u3044\u307e\u3059\u3002</p> <pre><code>// \u578b\u6ce8\u91c8\u306a\u3057\u3067\u3082\u578b\u63a8\u8ad6\u3055\u308c\u308b\nlet add a b = a + b\n\n// \u660e\u793a\u7684\u306a\u578b\u6ce8\u91c8\nlet addExplicit (a: int) (b: int) : int = a + b\n\n// \u30b8\u30a7\u30cd\u30ea\u30c3\u30af\u95a2\u6570\nlet identity x = x\n</code></pre>"},{"location":"fsharp/part-1/#_3","title":"\u90e8\u5206\u9069\u7528\u3068\u30ab\u30ea\u30fc\u5316","text":"<p>F# \u306e\u95a2\u6570\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u30ab\u30ea\u30fc\u5316\u3055\u308c\u3066\u3044\u307e\u3059\u3002</p> <pre><code>/// 2\u3064\u306e\u6570\u5024\u3092\u52a0\u7b97\nlet addTwo x y = x + y\n\n/// \u90e8\u5206\u9069\u7528: 5\u3092\u52a0\u7b97\u3059\u308b\u95a2\u6570\nlet addFive = addTwo 5\n\n// addFive 3 = 8\n</code></pre>"},{"location":"fsharp/part-1/#15","title":"1.5 \u5b66\u7fd2\u30dd\u30a4\u30f3\u30c8","text":"\u6982\u5ff5 \u547d\u4ee4\u578b \u95a2\u6570\u578b \u7126\u70b9 \u624b\u9806\uff08How\uff09 \u7d50\u679c\uff08What\uff09 \u72b6\u614b \u5909\u66f4\u3059\u308b \u5909\u63db\u3059\u308b \u30eb\u30fc\u30d7 for/while map/filter/reduce \u30c7\u30fc\u30bf \u30df\u30e5\u30fc\u30bf\u30d6\u30eb \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb \u95a2\u6570 \u5f15\u6570\u3092\u4e00\u62ec\u3067\u53d7\u3051\u53d6\u308b \u30ab\u30ea\u30fc\u5316\uff08\u90e8\u5206\u9069\u7528\u53ef\u80fd\uff09"},{"location":"fsharp/part-1/#16-f-scala","title":"1.6 F# \u3068 Scala \u306e\u6bd4\u8f03","text":"\u6a5f\u80fd F# Scala \u95a2\u6570\u5b9a\u7fa9 <code>let f x = ...</code> <code>def f(x: Int) = ...</code> \u578b\u6ce8\u91c8 <code>(x: int)</code> <code>(x: Int)</code> \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3 <code>x \\|&gt; f</code> <code>f(x)</code> \u307e\u305f\u306f\u62e1\u5f35\u30e1\u30bd\u30c3\u30c9 \u90e8\u5206\u9069\u7528 \u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u30ab\u30ea\u30fc\u5316 <code>.curried</code> \u3067\u5909\u63db \u6587\u5b57\u5217\u88dc\u9593 <code>$\"Hello {name}\"</code> <code>s\"Hello $name\"</code>"},{"location":"fsharp/part-1/#2","title":"\u7b2c2\u7ae0: \u7d14\u7c8b\u95a2\u6570\u3068\u30c6\u30b9\u30c8","text":""},{"location":"fsharp/part-1/#21","title":"2.1 \u7d14\u7c8b\u95a2\u6570\u3068\u306f","text":"<p>\u7d14\u7c8b\u95a2\u6570\uff08Pure Function\uff09\u306f\u4ee5\u4e0b\u306e\u7279\u5fb4\u3092\u6301\u3064\u95a2\u6570\u3067\u3059:</p> <ol> <li>\u540c\u3058\u5165\u529b\u306b\u306f\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3059</li> <li>\u526f\u4f5c\u7528\u304c\u306a\u3044\uff08\u5916\u90e8\u72b6\u614b\u3092\u5909\u66f4\u3057\u306a\u3044\uff09</li> </ol> <p></p>"},{"location":"fsharp/part-1/#22","title":"2.2 \u7d14\u7c8b\u95a2\u6570\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/fsharp/src/Ch02/PureFunctions.fs</code></p> <pre><code>/// \u6570\u5024\u3092\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\uff08\u7d14\u7c8b\u95a2\u6570\uff09\nlet increment (x: int) : int =\n    x + 1\n\n/// 2\u3064\u306e\u6570\u5024\u3092\u52a0\u7b97\uff08\u7d14\u7c8b\u95a2\u6570\uff09\nlet add (a: int) (b: int) : int =\n    a + b\n\n/// \u6587\u5b57\u5217\u306e\u6700\u521d\u306e\u6587\u5b57\u3092\u53d6\u5f97\uff08\u7d14\u7c8b\u95a2\u6570\uff09\nlet getFirstCharacter (s: string) : char =\n    s.[0]\n\n/// \u6570\u5024\u30922\u500d\u306b\u3059\u308b\uff08\u7d14\u7c8b\u95a2\u6570\uff09\nlet double (x: int) : int =\n    x * 2\n\n/// \u6570\u5024\u304c\u5076\u6570\u304b\u3069\u3046\u304b\u3092\u5224\u5b9a\uff08\u7d14\u7c8b\u95a2\u6570\uff09\nlet isEven (n: int) : bool =\n    n % 2 = 0\n</code></pre> <p>\u7d14\u7c8b\u3067\u306f\u306a\u3044\u95a2\u6570\u306e\u4f8b:</p> <pre><code>/// \u4e0d\u7d14\u306a\u95a2\u6570 - \u6bce\u56de\u7570\u306a\u308b\u5024\u3092\u8fd4\u3059\nlet randomPart (x: float) : float =\n    x * System.Random().NextDouble()\n\n/// \u4e0d\u7d14\u306a\u95a2\u6570 - \u73fe\u5728\u6642\u523b\u3092\u8fd4\u3059\nlet currentTime () : int64 =\n    System.DateTimeOffset.UtcNow.ToUnixTimeMilliseconds()\n</code></pre>"},{"location":"fsharp/part-1/#23","title":"2.3 \u30b7\u30e7\u30c3\u30d4\u30f3\u30b0\u30ab\u30fc\u30c8\u306e\u4f8b","text":"<p>\u72b6\u614b\u3092\u6301\u3064\u30af\u30e9\u30b9\u306e\u554f\u984c\u70b9\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/fsharp/src/Ch02/ShoppingCart.fs</code></p>"},{"location":"fsharp/part-1/#_4","title":"\u554f\u984c\u306e\u3042\u308b\u30b3\u30fc\u30c9\uff08\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u6307\u5411\u7684\u306a\u30a2\u30d7\u30ed\u30fc\u30c1\uff09","text":"<pre><code>// \u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u72b6\u614b\u3092\u6301\u3064\u554f\u984c\u306e\u3042\u308b\u30a2\u30d7\u30ed\u30fc\u30c1\ntype ShoppingCartBad() =\n    let mutable items = []\n    let mutable bookAdded = false\n\n    member _.AddItem(item: string) =\n        items &lt;- item :: items\n        if item = \"Book\" then\n            bookAdded &lt;- true\n\n    member _.GetDiscountPercentage() =\n        if bookAdded then 5 else 0\n\n    member _.GetItems() = items  // \u554f\u984c: \u5185\u90e8\u72b6\u614b\u3078\u306e\u53c2\u7167\u3092\u8fd4\u3057\u3066\u3044\u308b\n</code></pre>"},{"location":"fsharp/part-1/#_5","title":"\u7d14\u7c8b\u95a2\u6570\u306b\u3088\u308b\u89e3\u6c7a","text":"<pre><code>/// \u30ab\u30fc\u30c8\u5185\u306e\u5546\u54c1\u30ea\u30b9\u30c8\u304b\u3089\u5272\u5f15\u7387\u3092\u8a08\u7b97\n/// Book \u304c\u542b\u307e\u308c\u3066\u3044\u308c\u3070 5%\u3001\u305d\u308c\u4ee5\u5916\u306f 0%\nlet getDiscountPercentage (items: string list) : int =\n    if List.contains \"Book\" items then 5\n    else 0\n</code></pre>"},{"location":"fsharp/part-1/#_6","title":"\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30ab\u30fc\u30c8\u64cd\u4f5c","text":"<pre><code>/// \u5546\u54c1\u3092\u8ffd\u52a0\u3057\u305f\u65b0\u3057\u3044\u30ab\u30fc\u30c8\u3092\u8fd4\u3059\nlet addItem (items: string list) (item: string) : string list =\n    item :: items\n\n/// \u5546\u54c1\u3092\u524a\u9664\u3057\u305f\u65b0\u3057\u3044\u30ab\u30fc\u30c8\u3092\u8fd4\u3059\nlet removeItem (items: string list) (item: string) : string list =\n    items |&gt; List.filter (fun i -&gt; i &lt;&gt; item)\n</code></pre> <p>F# \u306e\u30ea\u30b9\u30c8\u306f\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u306e\u3067\u3001<code>addItem</code> \u3084 <code>removeItem</code> \u306f\u5143\u306e\u30ea\u30b9\u30c8\u3092\u5909\u66f4\u305b\u305a\u3001\u65b0\u3057\u3044\u30ea\u30b9\u30c8\u3092\u8fd4\u3057\u307e\u3059\u3002</p>"},{"location":"fsharp/part-1/#24","title":"2.4 \u8907\u6570\u6761\u4ef6\u306b\u3088\u308b\u5272\u5f15\u8a08\u7b97","text":"<p>\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u4f7f\u3063\u305f\u8907\u96d1\u306a\u30d3\u30b8\u30cd\u30b9\u30ed\u30b8\u30c3\u30af\u306e\u5b9f\u88c5:</p> <pre><code>/// \u8907\u6570\u306e\u6761\u4ef6\u306b\u3088\u308b\u5272\u5f15\u8a08\u7b97\nlet getAdvancedDiscountPercentage (items: string list) : int =\n    let hasBook = List.contains \"Book\" items\n    let hasElectronics = List.exists (fun item -&gt;\n        item = \"Laptop\" || item = \"Phone\" || item = \"Tablet\") items\n    let itemCount = List.length items\n\n    match hasBook, hasElectronics, itemCount with\n    | true, true, _ -&gt; 15      // Book + \u96fb\u5b50\u6a5f\u5668 \u2192 15%\n    | true, _, n when n &gt;= 5 -&gt; 10  // Book + 5\u500b\u4ee5\u4e0a \u2192 10%\n    | true, _, _ -&gt; 5          // Book \u306e\u307f \u2192 5%\n    | _, true, n when n &gt;= 3 -&gt; 7   // \u96fb\u5b50\u6a5f\u5668 + 3\u500b\u4ee5\u4e0a \u2192 7%\n    | _, _, n when n &gt;= 10 -&gt; 5     // 10\u500b\u4ee5\u4e0a \u2192 5%\n    | _ -&gt; 0                   // \u305d\u308c\u4ee5\u5916 \u2192 0%\n</code></pre>"},{"location":"fsharp/part-1/#25","title":"2.5 \u30c1\u30c3\u30d7\u8a08\u7b97\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/fsharp/src/Ch02/TipCalculator.fs</code></p> <pre><code>/// \u30b0\u30eb\u30fc\u30d7\u30b5\u30a4\u30ba\u306b\u5fdc\u3058\u305f\u30c1\u30c3\u30d7\u7387\u3092\u8a08\u7b97\n/// 6\u4eba\u4ee5\u4e0a \u2192 20%\n/// 1-5\u4eba \u2192 10%\n/// 0\u4eba \u2192 0%\nlet getTipPercentage (names: string list) : int =\n    let size = List.length names\n    if size &gt; 5 then 20\n    elif size &gt; 0 then 10\n    else 0\n</code></pre> <p>\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u4f7f\u3063\u305f\u5225\u306e\u5b9f\u88c5:</p> <pre><code>/// \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u4f7f\u7528\u3057\u305f\u30c1\u30c3\u30d7\u7387\u8a08\u7b97\nlet getTipPercentageMatch (names: string list) : int =\n    match List.length names with\n    | n when n &gt; 5 -&gt; 20\n    | n when n &gt; 0 -&gt; 10\n    | _ -&gt; 0\n</code></pre>"},{"location":"fsharp/part-1/#option","title":"Option \u578b\u306b\u3088\u308b\u30bc\u30ed\u9664\u7b97\u306e\u9632\u6b62","text":"<pre><code>/// \u4e00\u4eba\u5f53\u305f\u308a\u306e\u652f\u6255\u984d\u3092\u8a08\u7b97\uff08\u30c1\u30c3\u30d7\u8fbc\u307f\uff09\nlet calculatePerPerson (billAmount: decimal) (names: string list) : decimal option =\n    let size = List.length names\n    if size = 0 then\n        None\n    else\n        let tip = calculateTip billAmount names\n        let total = billAmount + tip\n        Some (total / decimal size)\n</code></pre> <p>F# \u306e <code>Option</code> \u578b\u306f\u3001\u5024\u304c\u5b58\u5728\u3057\u306a\u3044\u53ef\u80fd\u6027\u3092\u578b\u3067\u8868\u73fe\u3057\u307e\u3059\u3002\u3053\u308c\u306b\u3088\u308a\u3001<code>null</code> \u306b\u3088\u308b\u5b9f\u884c\u6642\u30a8\u30e9\u30fc\u3092\u9632\u3052\u307e\u3059\u3002</p>"},{"location":"fsharp/part-1/#26","title":"2.6 \u7d14\u7c8b\u95a2\u6570\u306e\u30c6\u30b9\u30c8","text":"<p>\u7d14\u7c8b\u95a2\u6570\u306f\u975e\u5e38\u306b\u30c6\u30b9\u30c8\u3057\u3084\u3059\u3044\u3067\u3059\u3002</p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/fsharp/tests/Ch02/PureFunctionsTests.fs</code></p> <pre><code>[&lt;Fact&gt;]\nlet ``increment \u306f\u6570\u5024\u30921\u5897\u3084\u3059`` () =\n    Assert.Equal(7, increment 6)\n    Assert.Equal(1, increment 0)\n    Assert.Equal(-5, increment -6)\n    Assert.Equal(System.Int32.MaxValue, increment (System.Int32.MaxValue - 1))\n</code></pre> <p></p>"},{"location":"fsharp/part-1/#27-a","title":"2.7 \u6587\u5b57 'a' \u3092\u9664\u5916\u3059\u308b\u30ef\u30fc\u30c9\u30b9\u30b3\u30a2","text":"<p>\u3088\u308a\u8907\u96d1\u306a\u4f8b\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p> <pre><code>/// 'a' \u3092\u9664\u5916\u3057\u305f\u6587\u5b57\u6570\u3092\u30b9\u30b3\u30a2\u3068\u3057\u3066\u8fd4\u3059\nlet wordScore (word: string) : int =\n    word.Replace(\"a\", \"\").Length\n\n/// \u5927\u6587\u5b57\u5c0f\u6587\u5b57\u3092\u533a\u5225\u305b\u305a\u306b 'a' \u3092\u9664\u5916\nlet wordScoreIgnoreCase (word: string) : int =\n    word\n    |&gt; String.filter (fun c -&gt; c &lt;&gt; 'a' &amp;&amp; c &lt;&gt; 'A')\n    |&gt; String.length\n</code></pre> <pre><code>// \u30c6\u30b9\u30c8\n[&lt;Fact&gt;]\nlet ``wordScore \u306f 'a' \u3092\u9664\u5916\u3057\u305f\u6587\u5b57\u6570\u3092\u8fd4\u3059`` () =\n    Assert.Equal(3, wordScore \"Scala\")  // \"Scl\" \u2192 3\n    Assert.Equal(8, wordScore \"function\") // 'a' \u306a\u3057 \u2192 8\n    Assert.Equal(0, wordScore \"\")        // \u7a7a\u6587\u5b57 \u2192 0\n    Assert.Equal(0, wordScore \"aaa\")     // \u3059\u3079\u3066 'a' \u2192 0\n</code></pre>"},{"location":"fsharp/part-1/#28","title":"2.8 \u53c2\u7167\u900f\u904e\u6027","text":"<p>\u7d14\u7c8b\u95a2\u6570\u306f\u53c2\u7167\u900f\u904e\u6027\uff08Referential Transparency\uff09\u3092\u6301\u3061\u307e\u3059\u3002</p> <p>\u5f0f\u3092\u305d\u306e\u8a55\u4fa1\u7d50\u679c\u3067\u7f6e\u304d\u63db\u3048\u3066\u3082\u3001\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u610f\u5473\u304c\u5909\u308f\u3089\u306a\u3044\u3053\u3068</p> <pre><code>// \u53c2\u7167\u900f\u904e\u6027\u306e\u4f8b\nlet score1 = wordScore \"Scala\"\nlet score2 = wordScore \"Scala\"\n// score1 \u3068 score2 \u306f\u5e38\u306b\u540c\u3058\u5024\uff083\uff09\n\n// \u4ee5\u4e0b\u306e2\u3064\u306f\u540c\u7b49\nlet total1 = wordScore \"Scala\" + wordScore \"Java\"\nlet total2 = 3 + 2  // wordScore \u306e\u7d50\u679c\u3067\u7f6e\u304d\u63db\u3048\u53ef\u80fd\n</code></pre> <p></p>"},{"location":"fsharp/part-1/#_7","title":"\u307e\u3068\u3081","text":""},{"location":"fsharp/part-1/#part-i_1","title":"Part I \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"fsharp/part-1/#_8","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306f\u300c\u4f55\u3092\u3059\u308b\u304b\u300d\u3092\u5ba3\u8a00\u7684\u306b\u8a18\u8ff0\u3059\u308b</li> <li>F# \u306e\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50 (<code>|&gt;</code>) \u3067\u30c7\u30fc\u30bf\u306e\u6d41\u308c\u3092\u76f4\u611f\u7684\u306b\u8868\u73fe\u3067\u304d\u308b</li> <li>\u7d14\u7c8b\u95a2\u6570\u306f\u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3059</li> <li>\u526f\u4f5c\u7528\u3092\u907f\u3051\u308b\u3053\u3068\u3067\u30b3\u30fc\u30c9\u306e\u4e88\u6e2c\u53ef\u80fd\u6027\u304c\u5411\u4e0a\u3059\u308b</li> <li>\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3067\u8907\u96d1\u306a\u6761\u4ef6\u5206\u5c90\u3092\u7c21\u6f54\u306b\u8a18\u8ff0\u3067\u304d\u308b</li> <li>Option \u578b\u3067 null \u5b89\u5168\u306a\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u304c\u3067\u304d\u308b</li> <li>\u7d14\u7c8b\u95a2\u6570\u306f\u30c6\u30b9\u30c8\u304c\u975e\u5e38\u306b\u7c21\u5358</li> <li>\u53c2\u7167\u900f\u904e\u6027\u306b\u3088\u308a\u3001\u30b3\u30fc\u30c9\u306e\u7406\u89e3\u3068\u63a8\u8ad6\u304c\u5bb9\u6613\u306b\u306a\u308b</li> </ol>"},{"location":"fsharp/part-1/#_9","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part II \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c</li> <li>\u9ad8\u968e\u95a2\u6570\uff08\u95a2\u6570\u3092\u5024\u3068\u3057\u3066\u6271\u3046\uff09</li> <li><code>List.collect</code> \u3068\u30cd\u30b9\u30c8\u69cb\u9020\u306e\u5e73\u5766\u5316</li> <li>\u30b3\u30f3\u30d4\u30e5\u30c6\u30fc\u30b7\u30e7\u30f3\u5f0f</li> </ul>"},{"location":"fsharp/part-1/#_10","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"fsharp/part-1/#1_1","title":"\u554f\u984c 1: \u7d14\u7c8b\u95a2\u6570\u306e\u8b58\u5225","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u306e\u3046\u3061\u3001\u7d14\u7c8b\u95a2\u6570\u306f\u3069\u308c\u3067\u3059\u304b?</p> <pre><code>// A\nlet double (x: int) : int = x * 2\n\n// B\nlet mutable counter = 0\nlet incrementCounter () : int =\n    counter &lt;- counter + 1\n    counter\n\n// C\nlet greet (name: string) : string = $\"Hello, {name}!\"\n\n// D\nlet currentTime () : int64 = System.DateTimeOffset.UtcNow.ToUnixTimeMilliseconds()\n</code></pre> \u89e3\u7b54  **A \u3068 C \u306f\u7d14\u7c8b\u95a2\u6570**\u3067\u3059\u3002  - A: \u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3057\u3001\u526f\u4f5c\u7528\u304c\u306a\u3044 - B: \u5916\u90e8\u5909\u6570 `counter` \u3092\u5909\u66f4\u3059\u308b\u526f\u4f5c\u7528\u304c\u3042\u308b\uff08\u4e0d\u7d14\uff09 - C: \u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3057\u3001\u526f\u4f5c\u7528\u304c\u306a\u3044 - D: \u547c\u3073\u51fa\u3059\u305f\u3073\u306b\u7570\u306a\u308b\u5024\u3092\u8fd4\u3059\uff08\u4e0d\u7d14\uff09"},{"location":"fsharp/part-1/#2_1","title":"\u554f\u984c 2: \u7d14\u7c8b\u95a2\u6570\u3078\u306e\u66f8\u304d\u63db\u3048","text":"<p>\u4ee5\u4e0b\u306e\u4e0d\u7d14\u306a\u95a2\u6570\u3092\u7d14\u7c8b\u95a2\u6570\u306b\u66f8\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>type Counter() =\n    let mutable value = 0\n\n    member _.Increment() =\n        value &lt;- value + 1\n        value\n</code></pre> \u89e3\u7b54 <pre><code>let increment (value: int) : int = value + 1\n\n// \u4f7f\u7528\u4f8b\nlet v1 = 0\nlet v2 = increment v1  // 1\nlet v3 = increment v2  // 2\n</code></pre>  \u72b6\u614b\u3092\u5916\u90e8\u306b\u6301\u3061\u3001\u95a2\u6570\u306f\u5024\u3092\u53d7\u3051\u53d6\u3063\u3066\u65b0\u3057\u3044\u5024\u3092\u8fd4\u3059\u3060\u3051\u306b\u3057\u307e\u3059\u3002"},{"location":"fsharp/part-1/#3","title":"\u554f\u984c 3: \u30c6\u30b9\u30c8\u3092\u66f8\u304f","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u306b\u5bfe\u3059\u308b\u30c6\u30b9\u30c8\u30b1\u30fc\u30b9\u3092\u8003\u3048\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>let isEven (n: int) : bool = n % 2 = 0\n</code></pre> \u89e3\u7b54 <pre><code>// \u57fa\u672c\u30b1\u30fc\u30b9\nAssert.True(isEven 0)\nAssert.True(isEven 2)\nAssert.True(isEven 4)\n\n// \u5947\u6570\nAssert.False(isEven 1)\nAssert.False(isEven 3)\n\n// \u8ca0\u306e\u6570\nAssert.True(isEven -2)\nAssert.False(isEven -3)\n\n// \u5883\u754c\u5024\nAssert.False(isEven System.Int32.MaxValue)\nAssert.True(isEven System.Int32.MinValue)\n</code></pre>"},{"location":"fsharp/part-1/#4","title":"\u554f\u984c 4: \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50\u3092\u4f7f\u3046","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50\u3092\u4f7f\u3063\u3066\u66f8\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>let processText (text: string) : int =\n    String.length (text.ToUpper().Trim())\n</code></pre> \u89e3\u7b54 <pre><code>let processText (text: string) : int =\n    text\n    |&gt; fun s -&gt; s.Trim()\n    |&gt; fun s -&gt; s.ToUpper()\n    |&gt; String.length\n</code></pre>  \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50\u3092\u4f7f\u3046\u3068\u3001\u30c7\u30fc\u30bf\u306e\u5909\u63db\u904e\u7a0b\u304c\u4e0a\u304b\u3089\u4e0b\u306b\u8aad\u3081\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002"},{"location":"fsharp/part-1/#5-option","title":"\u554f\u984c 5: Option \u578b\u3092\u4f7f\u3046","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092 <code>Option</code> \u578b\u3092\u4f7f\u3063\u3066\u5b89\u5168\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>let divide (a: int) (b: int) : int = a / b  // b \u304c 0 \u306e\u5834\u5408\u306b\u4f8b\u5916\n</code></pre> \u89e3\u7b54 <pre><code>let divide (a: int) (b: int) : int option =\n    if b = 0 then None\n    else Some (a / b)\n\n// \u4f7f\u7528\u4f8b\nmatch divide 10 2 with\n| Some result -&gt; printfn \"\u7d50\u679c: %d\" result\n| None -&gt; printfn \"0\u3067\u9664\u7b97\u3067\u304d\u307e\u305b\u3093\"\n</code></pre>  `Option` \u578b\u3092\u4f7f\u3046\u3053\u3068\u3067\u3001\u30a8\u30e9\u30fc\u30b1\u30fc\u30b9\u3092\u578b\u3067\u8868\u73fe\u3057\u3001\u547c\u3073\u51fa\u3057\u5074\u306b\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3092\u5f37\u5236\u3067\u304d\u307e\u3059\u3002"},{"location":"fsharp/part-2/","title":"Part II: \u95a2\u6570\u578b\u30b9\u30bf\u30a4\u30eb\u306e\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u6838\u5fc3\u3068\u306a\u308b\u30c6\u30af\u30cb\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059\u3002\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c\u3001\u9ad8\u968e\u95a2\u6570\u3001\u305d\u3057\u3066 <code>List.collect</code>\uff08flatMap \u76f8\u5f53\uff09\u306b\u3088\u308b\u8907\u96d1\u306a\u30c7\u30fc\u30bf\u5909\u63db\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"fsharp/part-2/#3","title":"\u7b2c3\u7ae0: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c","text":""},{"location":"fsharp/part-2/#31","title":"3.1 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u3068\u306f","text":"<p>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\uff08\u4e0d\u5909\uff09\u3068\u306f\u3001\u4e00\u5ea6\u4f5c\u6210\u3055\u308c\u305f\u30c7\u30fc\u30bf\u304c\u5909\u66f4\u3055\u308c\u306a\u3044\u3053\u3068\u3092\u610f\u5473\u3057\u307e\u3059\u3002\u30c7\u30fc\u30bf\u3092\u300c\u5909\u66f4\u300d\u3059\u308b\u4ee3\u308f\u308a\u306b\u3001\u65b0\u3057\u3044\u30c7\u30fc\u30bf\u3092\u300c\u4f5c\u6210\u300d\u3057\u307e\u3059\u3002</p> <p></p>"},{"location":"fsharp/part-2/#32-list","title":"3.2 List \u306e\u57fa\u672c\u64cd\u4f5c","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/fsharp/src/Ch03/ImmutableOperations.fs</code></p>"},{"location":"fsharp/part-2/#_1","title":"\u8981\u7d20\u306e\u8ffd\u52a0","text":"<p>F# \u306e\u30ea\u30b9\u30c8\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u3067\u3059\u3002\u8981\u7d20\u3092\u8ffd\u52a0\u3059\u308b\u3068\u65b0\u3057\u3044\u30ea\u30b9\u30c8\u304c\u4f5c\u6210\u3055\u308c\u307e\u3059\u3002</p> <pre><code>let appleBook = [\"Apple\"; \"Book\"]\nlet appleBookMango = appleBook @ [\"Mango\"]\n\n// \u5143\u306e\u30ea\u30b9\u30c8\u306f\u5909\u308f\u3089\u306a\u3044\nassert (List.length appleBook = 2)\n// \u65b0\u3057\u3044\u30ea\u30b9\u30c8\u304c\u4f5c\u6210\u3055\u308c\u308b\nassert (List.length appleBookMango = 3)\nassert (appleBookMango = [\"Apple\"; \"Book\"; \"Mango\"])\n</code></pre>"},{"location":"fsharp/part-2/#_2","title":"\u30b9\u30e9\u30a4\u30b9\u64cd\u4f5c","text":"<pre><code>/// \u30ea\u30b9\u30c8\u306e\u5148\u982dn\u500b\u306e\u8981\u7d20\u3092\u53d6\u5f97\nlet firstN (n: int) (list: 'a list) : 'a list =\n    list |&gt; List.truncate n\n\n/// \u30ea\u30b9\u30c8\u306e\u672b\u5c3en\u500b\u306e\u8981\u7d20\u3092\u53d6\u5f97\nlet lastN (n: int) (list: 'a list) : 'a list =\n    let skipCount = max 0 (List.length list - n)\n    list |&gt; List.skip skipCount\n\n/// \u30ea\u30b9\u30c8\u306e\u6700\u521d\u306e2\u8981\u7d20\u3092\u53d6\u5f97\nlet firstTwo (list: 'a list) : 'a list =\n    firstN 2 list\n\n/// \u30ea\u30b9\u30c8\u306e\u6700\u5f8c\u306e2\u8981\u7d20\u3092\u53d6\u5f97\nlet lastTwo (list: 'a list) : 'a list =\n    lastN 2 list\n</code></pre>"},{"location":"fsharp/part-2/#33","title":"3.3 \u30ea\u30b9\u30c8\u306e\u5909\u63db\u4f8b","text":"<pre><code>/// \u6700\u521d\u306e2\u8981\u7d20\u3092\u672b\u5c3e\u306b\u79fb\u52d5\nlet moveFirstTwoToEnd (list: 'a list) : 'a list =\n    let first = firstTwo list\n    let rest = list |&gt; List.skip 2\n    rest @ first\n\n// \u4f7f\u7528\u4f8b\nassert (moveFirstTwoToEnd [\"a\"; \"b\"; \"c\"] = [\"c\"; \"a\"; \"b\"])\n\n/// \u6700\u5f8c\u306e\u8981\u7d20\u306e\u524d\u306b\u65b0\u3057\u3044\u8981\u7d20\u3092\u633f\u5165\nlet insertBeforeLast (element: 'a) (list: 'a list) : 'a list =\n    let withoutLast = list |&gt; List.truncate (List.length list - 1)\n    let last = list |&gt; lastN 1\n    withoutLast @ [element] @ last\n\nassert (insertBeforeLast \"c\" [\"a\"; \"b\"] = [\"a\"; \"c\"; \"b\"])\n</code></pre>"},{"location":"fsharp/part-2/#34","title":"3.4 \u65c5\u7a0b\u306e\u518d\u8a08\u753b","text":"<p>\u65c5\u884c\u306e\u8a08\u753b\u5909\u66f4\u3092\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306b\u884c\u3046\u4f8b\u3067\u3059\u3002</p> <pre><code>/// \u6307\u5b9a\u3057\u305f\u90fd\u5e02\u306e\u524d\u306b\u65b0\u3057\u3044\u90fd\u5e02\u3092\u633f\u5165\nlet replan (plan: string list) (newCity: string) (beforeCity: string) : string list =\n    let index =\n        plan\n        |&gt; List.tryFindIndex (fun c -&gt; c = beforeCity)\n        |&gt; Option.defaultValue (List.length plan)\n    let citiesBefore = plan |&gt; List.truncate index\n    let citiesAfter = plan |&gt; List.skip index\n    citiesBefore @ [newCity] @ citiesAfter\n\nlet planA = [\"Paris\"; \"Berlin\"; \"Krak\u00f3w\"]\nlet planB = replan planA \"Vienna\" \"Krak\u00f3w\"\n\nassert (planB = [\"Paris\"; \"Berlin\"; \"Vienna\"; \"Krak\u00f3w\"])\nassert (planA = [\"Paris\"; \"Berlin\"; \"Krak\u00f3w\"])  // \u5143\u306e\u8a08\u753b\u306f\u5909\u308f\u3089\u306a\u3044!\n</code></pre> <p></p>"},{"location":"fsharp/part-2/#35-string-list","title":"3.5 String \u3068 List \u306e\u985e\u4f3c\u6027","text":"<p>String \u3068 List \u306f\u4f3c\u305f\u64cd\u4f5c\u304c\u3067\u304d\u307e\u3059\u3002</p> \u64cd\u4f5c F# List F# String \u7d50\u5408 <code>@</code> \u307e\u305f\u306f <code>List.append</code> <code>+</code> \u307e\u305f\u306f <code>String.concat</code> \u5207\u308a\u51fa\u3057 <code>List.skip</code>, <code>List.truncate</code> <code>Substring</code> \u30b5\u30a4\u30ba <code>List.length</code> <code>String.length</code> <pre><code>// List \u306e\u64cd\u4f5c\nlet abList = [\"a\"; \"b\"]\nlet cdList = [\"c\"; \"d\"]\nlet abcdList = abList @ cdList\nassert (abcdList = [\"a\"; \"b\"; \"c\"; \"d\"])\n\n// String \u306e\u64cd\u4f5c\nlet abStr = \"ab\"\nlet cdStr = \"cd\"\nlet abcdStr = abStr + cdStr\nassert (abcdStr = \"abcd\")\n</code></pre>"},{"location":"fsharp/part-2/#36","title":"3.6 \u540d\u524d\u306e\u7701\u7565","text":"<pre><code>/// \u540d\u524d\u3092\u7701\u7565\u5f62\u306b\u5909\u63db\uff08\u4f8b: \"Alonzo Church\" -&gt; \"A. Church\"\uff09\nlet abbreviate (name: string) : string =\n    let initial = name.Substring(0, 1)\n    let separatorIndex = name.IndexOf(' ')\n    if separatorIndex &lt; 0 then\n        name\n    else\n        let lastName = name.Substring(separatorIndex + 1)\n        $\"{initial}. {lastName}\"\n\nassert (abbreviate \"Alonzo Church\" = \"A. Church\")\nassert (abbreviate \"A. Church\" = \"A. Church\")\n</code></pre>"},{"location":"fsharp/part-2/#4","title":"\u7b2c4\u7ae0: \u95a2\u6570\u3092\u5024\u3068\u3057\u3066\u6271\u3046","text":""},{"location":"fsharp/part-2/#41","title":"4.1 \u9ad8\u968e\u95a2\u6570\u3068\u306f","text":"<p>\u9ad8\u968e\u95a2\u6570\uff08Higher-Order Function\uff09\u3068\u306f\u3001\u4ee5\u4e0b\u306e\u3044\u305a\u308c\u304b\u3092\u6e80\u305f\u3059\u95a2\u6570\u3067\u3059:</p> <ol> <li>\u95a2\u6570\u3092\u5f15\u6570\u3068\u3057\u3066\u53d7\u3051\u53d6\u308b</li> <li>\u95a2\u6570\u3092\u623b\u308a\u5024\u3068\u3057\u3066\u8fd4\u3059</li> </ol> <p></p>"},{"location":"fsharp/part-2/#42","title":"4.2 \u95a2\u6570\u3092\u5f15\u6570\u3068\u3057\u3066\u6e21\u3059","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/fsharp/src/Ch04/HigherOrderFunctions.fs</code></p>"},{"location":"fsharp/part-2/#listsortby-","title":"List.sortBy - \u30bd\u30fc\u30c8\u57fa\u6e96\u3092\u95a2\u6570\u3067\u6307\u5b9a","text":"<pre><code>let wordScore (word: string) : int =\n    word.Replace(\"a\", \"\").Length\n\nlet words = [\"rust\"; \"java\"]\nlet sortedWords = words |&gt; List.sortBy wordScore\n\nassert (sortedWords = [\"java\"; \"rust\"])\n// java: 2\u6587\u5b57 (j, v), rust: 4\u6587\u5b57 (r, u, s, t)\n</code></pre>"},{"location":"fsharp/part-2/#listmap-","title":"List.map - \u5404\u8981\u7d20\u3092\u5909\u63db","text":"<pre><code>let len (s: string) : int = s.Length\n\nlet lengths = [\"scala\"; \"rust\"; \"ada\"] |&gt; List.map len\nassert (lengths = [5; 4; 3])\n\nlet double (i: int) : int = i * 2\nlet doubles = [5; 1; 2; 4; 0] |&gt; List.map double\nassert (doubles = [10; 2; 4; 8; 0])\n</code></pre>"},{"location":"fsharp/part-2/#listfilter-","title":"List.filter - \u6761\u4ef6\u306b\u5408\u3046\u8981\u7d20\u3092\u62bd\u51fa","text":"<pre><code>let isOdd (i: int) : bool = i % 2 = 1\n\nlet odds = [5; 1; 2; 4; 0] |&gt; List.filter isOdd\nassert (odds = [5; 1])\n\nlet largerThan4 (i: int) : bool = i &gt; 4\nlet large = [5; 1; 2; 4; 0] |&gt; List.filter largerThan4\nassert (large = [5])\n</code></pre>"},{"location":"fsharp/part-2/#listfold-","title":"List.fold - \u7573\u307f\u8fbc\u307f","text":"<pre><code>let sum = [5; 1; 2; 4; 100] |&gt; List.fold (fun acc i -&gt; acc + i) 0\nassert (sum = 112)\n\nlet maximum = [5; 1; 2; 4; 15] |&gt; List.fold (fun maxVal i -&gt;\n    if i &gt; maxVal then i else maxVal) System.Int32.MinValue\nassert (maximum = 15)\n</code></pre>"},{"location":"fsharp/part-2/#43","title":"4.3 \u30ec\u30b3\u30fc\u30c9\u578b\u3068\u30d1\u30bf\u30fc\u30f3","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/fsharp/src/Ch04/HigherOrderFunctions.fs</code></p> <pre><code>/// \u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u8a00\u8a9e\u3092\u8868\u3059\u30ec\u30b3\u30fc\u30c9\u578b\ntype ProgrammingLanguage = {\n    Name: string\n    Year: int\n}\n\nlet javalang = { Name = \"Java\"; Year = 1995 }\nlet scalalang = { Name = \"Scala\"; Year = 2004 }\n\nlet languages = [javalang; scalalang]\n\n// \u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u30a2\u30af\u30bb\u30b9\nlet names = languages |&gt; List.map (fun lang -&gt; lang.Name)\nassert (names = [\"Java\"; \"Scala\"])\n\n// \u6761\u4ef6\u3067\u30d5\u30a3\u30eb\u30bf\nlet young = languages |&gt; List.filter (fun lang -&gt; lang.Year &gt; 2000)\nassert (young = [scalalang])\n</code></pre>"},{"location":"fsharp/part-2/#44","title":"4.4 \u95a2\u6570\u3092\u8fd4\u3059\u95a2\u6570","text":"<pre><code>/// n \u3088\u308a\u5927\u304d\u3044\u304b\u3092\u5224\u5b9a\u3059\u308b\u95a2\u6570\u3092\u8fd4\u3059\nlet largerThan (n: int) : int -&gt; bool =\n    fun i -&gt; i &gt; n\n\nlet large = [5; 1; 2; 4; 0] |&gt; List.filter (largerThan 4)\nassert (large = [5])\n\nlet medium = [5; 1; 2; 4; 0] |&gt; List.filter (largerThan 1)\nassert (medium = [5; 2; 4])\n</code></pre>"},{"location":"fsharp/part-2/#45","title":"4.5 \u90e8\u5206\u9069\u7528","text":"<p>F# \u306e\u95a2\u6570\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u30ab\u30ea\u30fc\u5316\u3055\u308c\u3066\u3044\u308b\u305f\u3081\u3001\u90e8\u5206\u9069\u7528\u304c\u81ea\u7136\u306b\u884c\u3048\u307e\u3059\u3002</p> <pre><code>/// 2\u3064\u306e\u5f15\u6570\u3092\u53d6\u308b\u95a2\u6570\nlet add x y = x + y\n\n/// \u90e8\u5206\u9069\u7528: 5\u3092\u8db3\u3059\u95a2\u6570\nlet addFive = add 5\n\nassert (addFive 3 = 8)\nassert (addFive 10 = 15)\n</code></pre> <p></p>"},{"location":"fsharp/part-2/#46","title":"4.6 \u30ef\u30fc\u30c9\u30b9\u30b3\u30a2\u30ea\u30f3\u30b0\u306e\u4f8b","text":"<p>\u8907\u6570\u306e\u30b9\u30b3\u30a2\u30ea\u30f3\u30b0\u30ed\u30b8\u30c3\u30af\u3092\u7d44\u307f\u5408\u308f\u305b\u308b\u4f8b\u3067\u3059\u3002</p> <pre><code>let wordScore (word: string) : int = word.Replace(\"a\", \"\").Length\nlet bonus (word: string) : int = if word.Contains(\"c\") then 5 else 0\nlet penalty (word: string) : int = if word.Contains(\"s\") then 7 else 0\n\nlet words = [\"ada\"; \"haskell\"; \"scala\"; \"java\"; \"rust\"]\n\n/// \u6307\u5b9a\u3057\u305f\u30b9\u30b3\u30a2\u95a2\u6570\u3067\u30ef\u30fc\u30c9\u3092\u30e9\u30f3\u30ad\u30f3\u30b0\nlet rankedWords (scoreFn: string -&gt; int) (words: string list) : string list =\n    words |&gt; List.sortByDescending scoreFn\n\n// \u57fa\u672c\u30b9\u30b3\u30a2\u3067\u30e9\u30f3\u30ad\u30f3\u30b0\nlet ranking1 = rankedWords wordScore words\nassert (ranking1 = [\"haskell\"; \"rust\"; \"scala\"; \"java\"; \"ada\"])\n\n// \u30dc\u30fc\u30ca\u30b9\u4ed8\u304d\u30b9\u30b3\u30a2\u3067\u30e9\u30f3\u30ad\u30f3\u30b0\nlet ranking2 = rankedWords (fun w -&gt; wordScore w + bonus w) words\nassert (ranking2 = [\"scala\"; \"haskell\"; \"rust\"; \"java\"; \"ada\"])\n\n// \u30dc\u30fc\u30ca\u30b9\u3068\u30da\u30ca\u30eb\u30c6\u30a3\u4ed8\u304d\u30b9\u30b3\u30a2\u3067\u30e9\u30f3\u30ad\u30f3\u30b0\nlet ranking3 = rankedWords (fun w -&gt; wordScore w + bonus w - penalty w) words\n// java: 2, scala/ada: 1, haskell: -1, rust: -3\n</code></pre>"},{"location":"fsharp/part-2/#5-listcollect","title":"\u7b2c5\u7ae0: List.collect \u3068\u30cd\u30b9\u30c8\u69cb\u9020","text":""},{"location":"fsharp/part-2/#51-flatten-listcollect","title":"5.1 flatten \u3068 List.collect","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/fsharp/src/Ch05/FlatMapOperations.fs</code></p>"},{"location":"fsharp/part-2/#listconcat-","title":"List.concat - \u30cd\u30b9\u30c8\u3057\u305f\u30ea\u30b9\u30c8\u3092\u5e73\u5766\u5316","text":"<pre><code>type Book = {\n    Title: string\n    Authors: string list\n}\n\nlet books = [\n    { Title = \"FP in Scala\"; Authors = [\"Chiusano\"; \"Bjarnason\"] }\n    { Title = \"The Hobbit\"; Authors = [\"Tolkien\"] }\n]\n\n// List.map \u3060\u3051\u3060\u3068\u30cd\u30b9\u30c8\u3059\u308b\nlet authorLists = books |&gt; List.map (fun b -&gt; b.Authors)\n// [ [\"Chiusano\"; \"Bjarnason\"]; [\"Tolkien\"] ]\n\n// List.concat \u3067\u5e73\u5766\u5316\nlet authors = authorLists |&gt; List.concat\n// [\"Chiusano\"; \"Bjarnason\"; \"Tolkien\"]\n</code></pre>"},{"location":"fsharp/part-2/#listcollect-map-concat","title":"List.collect = map + concat","text":"<p>F# \u306e <code>List.collect</code> \u306f Scala \u306e <code>flatMap</code> \u306b\u76f8\u5f53\u3057\u307e\u3059\u3002</p> <pre><code>// map \u3057\u3066 concat\nlet authors1 = books |&gt; List.map (fun b -&gt; b.Authors) |&gt; List.concat\n\n// List.collect \u3067\u540c\u3058\u3053\u3068\u30921\u884c\u3067\nlet authors2 = books |&gt; List.collect (fun b -&gt; b.Authors)\n\nassert (authors1 = authors2)\n// [\"Chiusano\"; \"Bjarnason\"; \"Tolkien\"]\n</code></pre>"},{"location":"fsharp/part-2/#52-listcollect","title":"5.2 List.collect \u306b\u3088\u308b\u30ea\u30b9\u30c8\u30b5\u30a4\u30ba\u306e\u5909\u5316","text":"<pre><code>// \u8981\u7d20\u6570\u304c\u5897\u3048\u308b\nlet duplicate = [1; 2; 3] |&gt; List.collect (fun i -&gt; [i; i + 10])\n// [1; 11; 2; 12; 3; 13] - 6\u8981\u7d20\n\n// \u8981\u7d20\u6570\u304c\u540c\u3058\nlet doubled = [1; 2; 3] |&gt; List.collect (fun i -&gt; [i * 2])\n// [2; 4; 6] - 3\u8981\u7d20\n\n// \u8981\u7d20\u6570\u304c\u6e1b\u308b\uff08\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u52b9\u679c\uff09\nlet evens = [1; 2; 3] |&gt; List.collect (fun i -&gt;\n    if i % 2 = 0 then [i] else [])\n// [2] - 1\u8981\u7d20\n</code></pre>"},{"location":"fsharp/part-2/#53-listcollect","title":"5.3 \u30cd\u30b9\u30c8\u3057\u305f List.collect","text":"<p>\u8907\u6570\u306e\u30ea\u30b9\u30c8\u3092\u7d44\u307f\u5408\u308f\u305b\u308b\u5834\u5408\u3001List.collect \u3092\u30cd\u30b9\u30c8\u3057\u307e\u3059\u3002</p> <pre><code>type Movie = { Title: string }\n\nlet bookAdaptations (author: string) : Movie list =\n    if author = \"Tolkien\" then\n        [{ Title = \"An Unexpected Journey\" }; { Title = \"The Desolation of Smaug\" }]\n    else\n        []\n\nlet books = [\n    { Title = \"FP in Scala\"; Authors = [\"Chiusano\"; \"Bjarnason\"] }\n    { Title = \"The Hobbit\"; Authors = [\"Tolkien\"] }\n]\n\n// \u30cd\u30b9\u30c8\u3057\u305f List.collect\nlet recommendations =\n    books\n    |&gt; List.collect (fun book -&gt;\n        book.Authors\n        |&gt; List.collect (fun author -&gt;\n            bookAdaptations author\n            |&gt; List.map (fun movie -&gt;\n                $\"You may like {movie.Title}, because you liked {author}'s {book.Title}\")))\n\n// \u7d50\u679c:\n// [ \"You may like An Unexpected Journey, because you liked Tolkien's The Hobbit\"\n//   \"You may like The Desolation of Smaug, because you liked Tolkien's The Hobbit\" ]\n</code></pre> <p></p>"},{"location":"fsharp/part-2/#54","title":"5.4 \u30b7\u30fc\u30b1\u30f3\u30b9\u5f0f\uff08\u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18\uff09","text":"<p>F# \u306e\u30b7\u30fc\u30b1\u30f3\u30b9\u5f0f\u306f\u3001\u30cd\u30b9\u30c8\u3057\u305f List.collect \u3092\u8aad\u307f\u3084\u3059\u304f\u66f8\u3051\u307e\u3059\u3002</p> <pre><code>// List.collect/map \u7248\nlet c1 =\n    books\n    |&gt; List.collect (fun book -&gt;\n        book.Authors\n        |&gt; List.collect (fun author -&gt;\n            bookAdaptations author\n            |&gt; List.map (fun movie -&gt;\n                $\"You may like {movie.Title}, because you liked {author}'s {book.Title}\")))\n\n// \u30b7\u30fc\u30b1\u30f3\u30b9\u5f0f\u7248\uff08\u7b49\u4fa1\uff09\nlet c2 =\n    [ for book in books do\n      for author in book.Authors do\n      for movie in bookAdaptations author do\n      yield $\"You may like {movie.Title}, because you liked {author}'s {book.Title}\" ]\n\nassert (c1 = c2)\n</code></pre> <p></p>"},{"location":"fsharp/part-2/#55","title":"5.5 \u5186\u5185\u306e\u70b9\u306e\u5224\u5b9a","text":"<p>\u30b7\u30fc\u30b1\u30f3\u30b9\u5f0f\u3067\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u3082\u884c\u3046\u4f8b\u3067\u3059\u3002</p> <pre><code>type Point = { X: int; Y: int }\n\nlet points = [{ X = 5; Y = 2 }; { X = 1; Y = 1 }]\nlet radiuses = [2; 1]\n\nlet isInside (point: Point) (radius: int) : bool =\n    radius * radius &gt;= point.X * point.X + point.Y * point.Y\n\n// \u5168\u7d44\u307f\u5408\u308f\u305b\u3092\u751f\u6210\nlet allCombinations =\n    [ for r in radiuses do\n      for point in points do\n      yield $\"Point({point.X},{point.Y}) is within a radius of {r}: {isInside point r}\" ]\n\n// \u7d50\u679c:\n// [ \"Point(5,2) is within a radius of 2: false\"\n//   \"Point(1,1) is within a radius of 2: true\"\n//   \"Point(5,2) is within a radius of 1: false\"\n//   \"Point(1,1) is within a radius of 1: false\" ]\n</code></pre>"},{"location":"fsharp/part-2/#if","title":"if \u306b\u3088\u308b\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0","text":"<pre><code>// if \u3092\u4f7f\u3063\u305f\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\nlet insidePoints =\n    [ for r in radiuses do\n      for point in points do\n      if isInside point r then\n          yield $\"Point({point.X},{point.Y}) is within a radius of {r}\" ]\n\n// \u7d50\u679c: [ \"Point(1,1) is within a radius of 2\" ]\n</code></pre>"},{"location":"fsharp/part-2/#56","title":"5.6 \u30b7\u30fc\u30b1\u30f3\u30b9\u5f0f\u306e\u67d4\u8edf\u6027","text":"<p>F# \u306e\u30b7\u30fc\u30b1\u30f3\u30b9\u5f0f\u306f\u3001\u30ea\u30b9\u30c8 <code>[ ]</code>\u3001\u30b7\u30fc\u30b1\u30f3\u30b9 <code>seq { }</code>\u3001\u914d\u5217 <code>[| |]</code> \u3067\u4f7f\u3048\u307e\u3059\u3002</p> <pre><code>// \u30ea\u30b9\u30c8\nlet listResult =\n    [ for a in [1; 2] do\n      for b in [2; 1] do\n      yield a * b ]\n// [2; 1; 4; 2] - \u91cd\u8907\u3042\u308a\u3001\u9806\u5e8f\u3042\u308a\n\n// \u30bb\u30c3\u30c8\u3078\u306e\u5909\u63db\nlet setResult = listResult |&gt; Set.ofList\n// set [1; 2; 4] - \u91cd\u8907\u306a\u3057\n\n// \u30b7\u30fc\u30b1\u30f3\u30b9\uff08\u9045\u5ef6\u8a55\u4fa1\uff09\nlet seqResult =\n    seq { for a in [1; 2] do\n          for b in [2; 1] do\n          yield a * b }\n</code></pre>"},{"location":"fsharp/part-2/#_3","title":"\u307e\u3068\u3081","text":""},{"location":"fsharp/part-2/#part-ii_1","title":"Part II \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"fsharp/part-2/#_4","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"\u7ae0 \u4e3b\u8981\u6982\u5ff5 \u30ad\u30fc\u64cd\u4f5c \u7b2c3\u7ae0 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb <code>@</code>, <code>List.skip</code>, <code>List.truncate</code> \u7b2c4\u7ae0 \u9ad8\u968e\u95a2\u6570 <code>List.map</code>, <code>List.filter</code>, <code>List.fold</code>, <code>List.sortBy</code> \u7b2c5\u7ae0 \u5e73\u5766\u5316 <code>List.concat</code>, <code>List.collect</code>, \u30b7\u30fc\u30b1\u30f3\u30b9\u5f0f"},{"location":"fsharp/part-2/#f-scala","title":"F# \u3068 Scala \u306e\u5bfe\u5fdc","text":"\u64cd\u4f5c F# Scala \u5e73\u5766\u5316 <code>List.concat</code> <code>flatten</code> flatMap <code>List.collect</code> <code>flatMap</code> \u5185\u5305\u8868\u8a18 <code>[ for x in xs do ... ]</code> <code>for { x &lt;- xs } yield ...</code> \u7573\u307f\u8fbc\u307f <code>List.fold</code> <code>foldLeft</code> \u30d5\u30a3\u30eb\u30bf <code>List.filter</code> <code>filter</code>"},{"location":"fsharp/part-2/#_5","title":"\u91cd\u8981\u306a\u6cd5\u5247","text":"<ol> <li>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf: \u5143\u306e\u30c7\u30fc\u30bf\u306f\u5909\u66f4\u305b\u305a\u3001\u65b0\u3057\u3044\u30c7\u30fc\u30bf\u3092\u4f5c\u6210\u3059\u308b</li> <li>\u95a2\u6570\u306f\u5024: \u95a2\u6570\u3092\u5f15\u6570\u3068\u3057\u3066\u6e21\u3057\u305f\u308a\u3001\u623b\u308a\u5024\u3068\u3057\u3066\u8fd4\u3057\u305f\u308a\u3067\u304d\u308b</li> <li>List.collect \u30d1\u30bf\u30fc\u30f3: \u30cd\u30b9\u30c8\u3057\u305f\u69cb\u9020\u3092\u5e73\u5766\u5316\u3057\u306a\u304c\u3089\u5909\u63db\u3059\u308b</li> <li>\u30b7\u30fc\u30b1\u30f3\u30b9\u5f0f: List.collect/map \u306e\u7cd6\u8863\u69cb\u6587\u3068\u3057\u3066\u4f7f\u3048\u308b</li> <li>\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3: <code>|&gt;</code> \u3067\u95a2\u6570\u3092\u9023\u9396\u3055\u305b\u3066\u8aad\u307f\u3084\u3059\u304f\u3059\u308b</li> </ol>"},{"location":"fsharp/part-2/#_6","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part III \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li><code>Option</code> \u578b\u306b\u3088\u308b\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0</li> <li><code>Result</code> \u578b\u3068\u8907\u5408\u7684\u306a\u30a8\u30e9\u30fc\u51e6\u7406</li> </ul>"},{"location":"fsharp/part-2/#_7","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"fsharp/part-2/#1","title":"\u554f\u984c 1: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u64cd\u4f5c","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u30ea\u30b9\u30c8\u306e\u4e2d\u592e\u306b\u8981\u7d20\u3092\u633f\u5165\u3059\u308b\u95a2\u6570\u3067\u3059\u3002</p> <pre><code>let insertAtMiddle (element: 'a) (list: 'a list) : 'a list = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert (insertAtMiddle \"X\" [\"a\"; \"b\"; \"c\"; \"d\"] = [\"a\"; \"b\"; \"X\"; \"c\"; \"d\"])\nassert (insertAtMiddle \"X\" [\"a\"; \"b\"] = [\"a\"; \"X\"; \"b\"])\n</code></pre> \u89e3\u7b54 <pre><code>let insertAtMiddle (element: 'a) (list: 'a list) : 'a list =\n    let middle = List.length list / 2\n    let before = list |&gt; List.truncate middle\n    let after = list |&gt; List.skip middle\n    before @ [element] @ after\n</code></pre>"},{"location":"fsharp/part-2/#2","title":"\u554f\u984c 2: \u9ad8\u968e\u95a2\u6570","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u6761\u4ef6\u3092\u6e80\u305f\u3059\u8981\u7d20\u306e\u6570\u3092\u30ab\u30a6\u30f3\u30c8\u3059\u308b\u95a2\u6570\u3067\u3059\u3002</p> <pre><code>let countWhere (predicate: 'a -&gt; bool) (list: 'a list) : int = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert (countWhere (fun i -&gt; i &gt; 3) [1; 2; 3; 4; 5] = 2)\nassert (countWhere (fun (s: string) -&gt; s.Length &gt; 1) [\"a\"; \"bb\"; \"ccc\"] = 2)\n</code></pre> \u89e3\u7b54 <pre><code>let countWhere (predicate: 'a -&gt; bool) (list: 'a list) : int =\n    list |&gt; List.filter predicate |&gt; List.length\n\n// \u307e\u305f\u306f List.fold \u3092\u4f7f\u3063\u3066\nlet countWhere2 (predicate: 'a -&gt; bool) (list: 'a list) : int =\n    list |&gt; List.fold (fun count elem -&gt;\n        if predicate elem then count + 1 else count) 0\n</code></pre>"},{"location":"fsharp/part-2/#3_1","title":"\u554f\u984c 3: \u30b7\u30fc\u30b1\u30f3\u30b9\u5f0f","text":"<p>\u4ee5\u4e0b\u306e\u30cd\u30b9\u30c8\u3057\u305f List.collect \u3092\u30b7\u30fc\u30b1\u30f3\u30b9\u5f0f\u3067\u66f8\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>let result =\n    [1; 2]\n    |&gt; List.collect (fun x -&gt;\n        [10; 20]\n        |&gt; List.collect (fun y -&gt;\n            [100; 200]\n            |&gt; List.map (fun z -&gt;\n                x + y + z)))\n</code></pre> \u89e3\u7b54 <pre><code>let result =\n    [ for x in [1; 2] do\n      for y in [10; 20] do\n      for z in [100; 200] do\n      yield x + y + z ]\n\n// \u7d50\u679c: [111; 211; 121; 221; 112; 212; 122; 222]\n</code></pre>"},{"location":"fsharp/part-2/#4-listcollect","title":"\u554f\u984c 4: List.collect \u306b\u3088\u308b\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0","text":"<p>\u30b7\u30fc\u30b1\u30f3\u30b9\u5f0f\u306e <code>if</code> \u3092\u4f7f\u308f\u305a\u306b\u3001List.collect \u3060\u3051\u3067\u5076\u6570\u306e\u307f\u3092\u62bd\u51fa\u3059\u308b\u30b3\u30fc\u30c9\u3092\u66f8\u3044\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>let numbers = [1; 2; 3; 4; 5; 6]\n// \u5076\u6570\u306e\u307f\u3092\u62bd\u51fa: [2; 4; 6]\n</code></pre> \u89e3\u7b54 <pre><code>let evenNumbers =\n    numbers\n    |&gt; List.collect (fun n -&gt;\n        if n % 2 = 0 then [n] else [])\n\n// \u307e\u305f\u306f\u95a2\u6570\u306b\u5206\u96e2\nlet evenFilter (n: int) : int list =\n    if n % 2 = 0 then [n] else []\n\nlet evenNumbers2 = numbers |&gt; List.collect evenFilter\n</code></pre>"},{"location":"fsharp/part-2/#5","title":"\u554f\u984c 5: \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u3067\u66f8\u304d\u63db\u3048","text":"<p>\u4ee5\u4e0b\u306e\u30b3\u30fc\u30c9\u3092\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50\u3092\u4f7f\u3063\u3066\u66f8\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>let result = List.length (List.filter (fun x -&gt; x &gt; 0) (List.map (fun x -&gt; x * 2) [1; -2; 3; -4; 5]))\n</code></pre> \u89e3\u7b54 <pre><code>let result =\n    [1; -2; 3; -4; 5]\n    |&gt; List.map (fun x -&gt; x * 2)\n    |&gt; List.filter (fun x -&gt; x &gt; 0)\n    |&gt; List.length\n\n// \u7d50\u679c: 3 (2, 6, 10 \u306e3\u3064)\n</code></pre>  \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50\u3092\u4f7f\u3046\u3068\u3001\u30c7\u30fc\u30bf\u306e\u5909\u63db\u904e\u7a0b\u304c\u4e0a\u304b\u3089\u4e0b\u306b\u8aad\u3081\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002"},{"location":"fsharp/part-3/","title":"Part III: \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3068 Option/Result","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3092\u5b66\u3073\u307e\u3059\u3002<code>null</code> \u3084\u4f8b\u5916\u306b\u983c\u3089\u305a\u3001<code>Option</code> \u3068 <code>Result</code> \u3092\u4f7f\u3063\u3066\u578b\u5b89\u5168\u306b\u30a8\u30e9\u30fc\u3092\u6271\u3046\u65b9\u6cd5\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"fsharp/part-3/#6-option","title":"\u7b2c6\u7ae0: Option \u578b\u306b\u3088\u308b\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":""},{"location":"fsharp/part-3/#61-option","title":"6.1 \u306a\u305c Option \u304c\u5fc5\u8981\u304b","text":"<p>\u5f93\u6765\u306e\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u306b\u306f\u554f\u984c\u304c\u3042\u308a\u307e\u3059\u3002</p> <p></p>"},{"location":"fsharp/part-3/#62-option","title":"6.2 Option \u306e\u57fa\u672c","text":"<p><code>'a option</code> \u306f\u300c<code>'a</code> \u578b\u306e\u5024\u304c\u3042\u308b\u304b\u3001\u306a\u3044\u304b\u300d\u3092\u8868\u3059\u578b\u3067\u3059\u3002</p> <p></p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/fsharp/src/Ch06/OptionHandling.fs</code></p>"},{"location":"fsharp/part-3/#63-tv","title":"6.3 TV\u756a\u7d44\u306e\u30d1\u30fc\u30b9\u4f8b","text":"<p>TV\u756a\u7d44\u306e\u6587\u5b57\u5217\u3092\u30d1\u30fc\u30b9\u3059\u308b\u4f8b\u3067 Option \u306e\u4f7f\u3044\u65b9\u3092\u5b66\u3073\u307e\u3059\u3002</p> <pre><code>type TvShow = {\n    Title: string\n    Start: int\n    End: int\n}\n\n// \u5165\u529b\u4f8b: \"Breaking Bad (2008-2013)\"\n// \u671f\u5f85\u3059\u308b\u51fa\u529b: { Title = \"Breaking Bad\"; Start = 2008; End = 2013 }\n</code></pre>"},{"location":"fsharp/part-3/#_1","title":"\u4f8b\u5916\u3092\u4f7f\u3046\u65b9\u6cd5\uff08\u554f\u984c\u3042\u308a\uff09","text":"<pre><code>let parseShowUnsafe (rawShow: string) : TvShow =\n    let bracketOpen = rawShow.IndexOf('(')\n    let bracketClose = rawShow.IndexOf(')')\n    let dash = rawShow.IndexOf('-')\n\n    let name = rawShow.Substring(0, bracketOpen).Trim()\n    let yearStart = int (rawShow.Substring(bracketOpen + 1, dash - bracketOpen - 1))\n    let yearEnd = int (rawShow.Substring(dash + 1, bracketClose - dash - 1))\n\n    { Title = name; Start = yearStart; End = yearEnd }\n\n// \u6b63\u5e38\u30b1\u30fc\u30b9\nparseShowUnsafe \"Breaking Bad (2008-2013)\"\n// { Title = \"Breaking Bad\"; Start = 2008; End = 2013 }\n\n// \u7570\u5e38\u30b1\u30fc\u30b9 \u2192 \u4f8b\u5916\u304c\u30b9\u30ed\u30fc\u3055\u308c\u308b!\nparseShowUnsafe \"Chernobyl (2019)\"        // ArgumentOutOfRangeException\nparseShowUnsafe \"The Wire 2002-2008\"      // ArgumentOutOfRangeException\n</code></pre>"},{"location":"fsharp/part-3/#option","title":"Option \u3092\u4f7f\u3046\u65b9\u6cd5","text":"<pre><code>let parseShow (rawShow: string) : TvShow option =\n    match extractName rawShow with\n    | None -&gt; None\n    | Some name -&gt;\n        let yearStart =\n            extractYearStart rawShow\n            |&gt; Option.orElse (extractSingleYear rawShow)\n        let yearEnd =\n            extractYearEnd rawShow\n            |&gt; Option.orElse (extractSingleYear rawShow)\n        match yearStart, yearEnd with\n        | Some start, Some endYear -&gt;\n            Some { Title = name; Start = start; End = endYear }\n        | _ -&gt; None\n\n// \u6b63\u5e38\u30b1\u30fc\u30b9\nparseShow \"Breaking Bad (2008-2013)\"\n// Some { Title = \"Breaking Bad\"; Start = 2008; End = 2013 }\n\n// \u7570\u5e38\u30b1\u30fc\u30b9 \u2192 None \u304c\u8fd4\u3055\u308c\u308b\uff08\u4f8b\u5916\u306a\u3057\uff09\nparseShow \"The Wire 2002-2008\"  // None\n</code></pre>"},{"location":"fsharp/part-3/#64","title":"6.4 \u5c0f\u3055\u306a\u95a2\u6570\u304b\u3089\u7d44\u307f\u7acb\u3066\u308b","text":"<p>\u8907\u96d1\u306a\u30d1\u30fc\u30b9\u51e6\u7406\u3092\u5c0f\u3055\u306a\u95a2\u6570\u306b\u5206\u89e3\u3057\u307e\u3059\u3002</p> <pre><code>/// \u6587\u5b57\u5217\u3092\u5b89\u5168\u306b\u6574\u6570\u306b\u5909\u63db\nlet tryParseInt (s: string) : int option =\n    match System.Int32.TryParse(s) with\n    | true, value -&gt; Some value\n    | false, _ -&gt; None\n\n/// \u540d\u524d\u3092\u62bd\u51fa\nlet extractName (rawShow: string) : string option =\n    let bracketOpen = rawShow.IndexOf('(')\n    if bracketOpen &gt; 0 then\n        Some (rawShow.Substring(0, bracketOpen).Trim())\n    else\n        None\n\n/// \u958b\u59cb\u5e74\u3092\u62bd\u51fa\nlet extractYearStart (rawShow: string) : int option =\n    let bracketOpen = rawShow.IndexOf('(')\n    let dash = rawShow.IndexOf('-')\n    if bracketOpen &lt;&gt; -1 &amp;&amp; dash &gt; bracketOpen + 1 then\n        let yearStr = rawShow.Substring(bracketOpen + 1, dash - bracketOpen - 1)\n        tryParseInt yearStr\n    else\n        None\n\n/// \u7d42\u4e86\u5e74\u3092\u62bd\u51fa\nlet extractYearEnd (rawShow: string) : int option =\n    let dash = rawShow.IndexOf('-')\n    let bracketClose = rawShow.IndexOf(')')\n    if dash &lt;&gt; -1 &amp;&amp; bracketClose &gt; dash + 1 then\n        let yearStr = rawShow.Substring(dash + 1, bracketClose - dash - 1)\n        tryParseInt yearStr\n    else\n        None\n</code></pre> <p></p>"},{"location":"fsharp/part-3/#65-optionorelse","title":"6.5 Option.orElse \u306b\u3088\u308b\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af","text":"<p><code>Option.orElse</code> \u3092\u4f7f\u3063\u3066\u3001\u6700\u521d\u306e Option \u304c <code>None</code> \u306e\u5834\u5408\u306b\u4ee3\u66ff\u3092\u8a66\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>let seven = Some 7\nlet eight = Some 8\nlet none: int option = None\n\nseven |&gt; Option.orElse eight   // Some 7 - \u6700\u521d\u304c Some \u306a\u306e\u3067\u305d\u306e\u307e\u307e\nnone |&gt; Option.orElse eight    // Some 8 - \u6700\u521d\u304c None \u306a\u306e\u3067\u4ee3\u66ff\u3092\u4f7f\u7528\nseven |&gt; Option.orElse none    // Some 7\nnone |&gt; Option.orElse none     // None\n</code></pre>"},{"location":"fsharp/part-3/#_2","title":"\u5358\u5e74\u306e\u756a\u7d44\u306b\u5bfe\u5fdc\u3059\u308b","text":"<p>\u300cChernobyl (2019)\u300d\u306e\u3088\u3046\u306a\u5358\u5e74\u306e\u756a\u7d44\u3092\u30d1\u30fc\u30b9\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002</p> <pre><code>/// \u5358\u5e74\u3092\u62bd\u51fa\nlet extractSingleYear (rawShow: string) : int option =\n    let dash = rawShow.IndexOf('-')\n    let bracketOpen = rawShow.IndexOf('(')\n    let bracketClose = rawShow.IndexOf(')')\n    if dash = -1 &amp;&amp; bracketOpen &lt;&gt; -1 &amp;&amp; bracketClose &gt; bracketOpen + 1 then\n        let yearStr = rawShow.Substring(bracketOpen + 1, bracketClose - bracketOpen - 1)\n        tryParseInt yearStr\n    else\n        None\n\nlet parseShow (rawShow: string) : TvShow option =\n    match extractName rawShow with\n    | None -&gt; None\n    | Some name -&gt;\n        let yearStart =\n            extractYearStart rawShow\n            |&gt; Option.orElse (extractSingleYear rawShow)\n        let yearEnd =\n            extractYearEnd rawShow\n            |&gt; Option.orElse (extractSingleYear rawShow)\n        match yearStart, yearEnd with\n        | Some start, Some endYear -&gt;\n            Some { Title = name; Start = start; End = endYear }\n        | _ -&gt; None\n\n// \u3053\u308c\u3067\u5358\u5e74\u306e\u756a\u7d44\u3082\u30d1\u30fc\u30b9\u3067\u304d\u308b\nparseShow \"Chernobyl (2019)\"\n// Some { Title = \"Chernobyl\"; Start = 2019; End = 2019 }\n</code></pre> <p></p>"},{"location":"fsharp/part-3/#66-option","title":"6.6 Option \u306e\u4e3b\u8981\u30e1\u30bd\u30c3\u30c9","text":"\u95a2\u6570 \u8aac\u660e \u4f8b <code>Option.map</code> \u5024\u304c\u3042\u308c\u3070\u5909\u63db <code>Some 5 \\|&gt; Option.map ((*) 2)</code> \u2192 <code>Some 10</code> <code>Option.bind</code> \u5024\u304c\u3042\u308c\u3070 Option \u3092\u8fd4\u3059\u95a2\u6570\u3092\u9069\u7528 <code>Some 5 \\|&gt; Option.bind (fun x -&gt; Some (x * 2))</code> \u2192 <code>Some 10</code> <code>Option.filter</code> \u6761\u4ef6\u3092\u6e80\u305f\u3055\u306a\u3051\u308c\u3070 None <code>Some 5 \\|&gt; Option.filter (fun x -&gt; x &gt; 10)</code> \u2192 <code>None</code> <code>Option.orElse</code> None \u306a\u3089\u4ee3\u66ff\u3092\u4f7f\u7528 <code>None \\|&gt; Option.orElse (Some 5)</code> \u2192 <code>Some 5</code> <code>Option.defaultValue</code> None \u306a\u3089\u30c7\u30d5\u30a9\u30eb\u30c8\u5024 <code>None \\|&gt; Option.defaultValue 0</code> \u2192 <code>0</code> <code>Option.toList</code> List \u306b\u5909\u63db <code>Some 5 \\|&gt; Option.toList</code> \u2192 <code>[5]</code> <pre><code>let year: int option = Some 996\nlet noYear: int option = None\n\n// map\nyear |&gt; Option.map (fun x -&gt; x * 2)     // Some 1992\nnoYear |&gt; Option.map (fun x -&gt; x * 2)   // None\n\n// bind\nyear |&gt; Option.bind (fun y -&gt; Some (y * 2))     // Some 1992\nnoYear |&gt; Option.bind (fun y -&gt; Some (y * 2))   // None\n\n// filter\nyear |&gt; Option.filter (fun x -&gt; x &lt; 2020)   // Some 996\nyear |&gt; Option.filter (fun x -&gt; x &gt; 2020)   // None\n\n// orElse\nyear |&gt; Option.orElse (Some 2020)     // Some 996\nnoYear |&gt; Option.orElse (Some 2020)   // Some 2020\n</code></pre>"},{"location":"fsharp/part-3/#67","title":"6.7 \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u6226\u7565","text":"<p>\u8907\u6570\u306e\u8981\u7d20\u3092\u30d1\u30fc\u30b9\u3059\u308b\u5834\u5408\u30012\u3064\u306e\u6226\u7565\u304c\u3042\u308a\u307e\u3059\u3002</p> <p></p>"},{"location":"fsharp/part-3/#best-effort","title":"Best-effort \u6226\u7565","text":"<pre><code>let parseShowsBestEffort (rawShows: string list) : TvShow list =\n    rawShows\n    |&gt; List.choose parseShow  // Some \u306e\u3082\u306e\u3060\u3051\u62bd\u51fa\n\nlet rawShows = [\n    \"Breaking Bad (2008-2013)\"\n    \"The Wire 2002 2008\"        // \u7121\u52b9\u306a\u5f62\u5f0f\n    \"Mad Men (2007-2015)\"\n]\n\nparseShowsBestEffort rawShows\n// [{ Title = \"Breaking Bad\"; ... }; { Title = \"Mad Men\"; ... }]\n// \u7121\u52b9\u306a\u3082\u306e\u306f\u7121\u8996\u3055\u308c\u308b\n</code></pre>"},{"location":"fsharp/part-3/#all-or-nothing","title":"All-or-nothing \u6226\u7565","text":"<pre><code>let parseShowsAllOrNothing (rawShows: string list) : TvShow list option =\n    let parsed = rawShows |&gt; List.map parseShow\n    if List.forall Option.isSome parsed then\n        Some (parsed |&gt; List.choose id)\n    else\n        None\n\n// \u5168\u90e8\u6210\u529f \u2192 Some [...]\nparseShowsAllOrNothing [\"Breaking Bad (2008-2013)\"; \"Mad Men (2007-2015)\"]\n// Some [{ Title = \"Breaking Bad\"; ... }; { Title = \"Mad Men\"; ... }]\n\n// \u4e00\u3064\u3067\u3082\u5931\u6557 \u2192 None\nparseShowsAllOrNothing [\"Breaking Bad (2008-2013)\"; \"Invalid\"]\n// None\n</code></pre>"},{"location":"fsharp/part-3/#68-forall-exists","title":"6.8 forall \u3068 exists","text":"<p>Option \u3067\u6761\u4ef6\u5224\u5b9a\u3092\u3059\u308b\u969b\u306b\u4fbf\u5229\u306a\u95a2\u6570\u3067\u3059\u3002</p> \u95a2\u6570 \u52d5\u4f5c <code>Option.forall p</code> None \u2192 true, Some x \u2192 p(x) <code>Option.exists p</code> None \u2192 false, Some x \u2192 p(x) <code>Option.contains x</code> Some x \u3068\u7b49\u3057\u3044\u304b <pre><code>let year = Some 996\nlet noYear: int option = None\n\n// forall - \u300c\u5168\u3066\u300d\u307e\u305f\u306f\u300c\u5b58\u5728\u3057\u306a\u3044\u300d\nyear |&gt; Option.forall (fun x -&gt; x &lt; 2020)     // true (996 &lt; 2020)\nnoYear |&gt; Option.forall (fun x -&gt; x &lt; 2020)   // true (\u5024\u304c\u306a\u3044\u306e\u3067\u300c\u5168\u3066\u300d\u304c\u81ea\u660e\u306b\u771f)\nyear |&gt; Option.forall (fun x -&gt; x &gt; 2020)     // false\n\n// exists - \u300c\u5b58\u5728\u3057\u3066\u6761\u4ef6\u3092\u6e80\u305f\u3059\u300d\nyear |&gt; Option.exists (fun x -&gt; x &lt; 2020)     // true\nnoYear |&gt; Option.exists (fun x -&gt; x &lt; 2020)   // false (\u5024\u304c\u306a\u3044\u306e\u3067\u5b58\u5728\u3057\u306a\u3044)\n</code></pre>"},{"location":"fsharp/part-3/#_3","title":"\u5b9f\u7528\u4f8b: \u30e6\u30fc\u30b6\u30fc\u306e\u30e1\u30fc\u30eb\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0","text":"<pre><code>type User = {\n    Name: string\n    Email: string option\n    Age: int\n}\n\nlet users = [\n    { Name = \"Alice\"; Email = Some \"alice@example.com\"; Age = 25 }\n    { Name = \"Bob\"; Email = None; Age = 30 }\n    { Name = \"Charlie\"; Email = Some \"charlie@test.com\"; Age = 17 }\n]\n\n// \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u304b\u3001example.com \u30c9\u30e1\u30a4\u30f3\nlet filterByDomain domain users =\n    users\n    |&gt; List.filter (fun user -&gt;\n        user.Email |&gt; Option.forall (fun email -&gt; email.EndsWith(domain)))\n\nfilterByDomain \"@example.com\" users\n// [Alice; Bob] - Bob \u306f None \u306a\u306e\u3067 forall = true\n\n// \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u3066\u3001test.com \u30c9\u30e1\u30a4\u30f3\nlet filterByDomainExists domain users =\n    users\n    |&gt; List.filter (fun user -&gt;\n        user.Email |&gt; Option.exists (fun email -&gt; email.EndsWith(domain)))\n\nfilterByDomainExists \"@test.com\" users\n// [Charlie]\n</code></pre>"},{"location":"fsharp/part-3/#7-result","title":"\u7b2c7\u7ae0: Result \u578b\u3068\u8907\u5408\u7684\u306a\u30a8\u30e9\u30fc\u51e6\u7406","text":""},{"location":"fsharp/part-3/#71-option","title":"7.1 Option \u306e\u9650\u754c","text":"<p><code>Option</code> \u306f\u300c\u5024\u304c\u3042\u308b\u304b\u306a\u3044\u304b\u300d\u3057\u304b\u8868\u73fe\u3067\u304d\u307e\u305b\u3093\u3002\u306a\u305c\u5931\u6557\u3057\u305f\u306e\u304b\u3092\u4f1d\u3048\u3089\u308c\u307e\u305b\u3093\u3002</p> <p></p>"},{"location":"fsharp/part-3/#72-result","title":"7.2 Result \u306e\u57fa\u672c","text":"<p><code>Result&lt;'T, 'Error&gt;</code> \u306f\u300c<code>'T</code> \u578b\u306e\u6210\u529f\u5024\u304b\u3001<code>'Error</code> \u578b\u306e\u30a8\u30e9\u30fc\u304b\u300d\u3092\u8868\u3059\u578b\u3067\u3059\u3002</p> <ul> <li><code>Ok value</code>: \u6210\u529f</li> <li><code>Error error</code>: \u5931\u6557\uff08\u30a8\u30e9\u30fc\u60c5\u5831\u3092\u4fdd\u6301\uff09</li> </ul> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/fsharp/src/Ch07/ResultHandling.fs</code></p> <pre><code>let extractName (show: string) : Result&lt;string, string&gt; =\n    let bracketOpen = show.IndexOf('(')\n    if bracketOpen &gt; 0 then\n        Ok (show.Substring(0, bracketOpen).Trim())\n    else\n        Error $\"Can't extract name from '{show}'\"\n\nextractName \"The Wire (2002-2008)\"  // Ok \"The Wire\"\nextractName \"(2022)\"                // Error \"Can't extract name from '(2022)'\"\n</code></pre>"},{"location":"fsharp/part-3/#73-result","title":"7.3 Result \u3092\u4f7f\u3063\u305f\u30d1\u30fc\u30b9","text":"<pre><code>let extractYearStart (rawShow: string) : Result&lt;int, string&gt; =\n    let bracketOpen = rawShow.IndexOf('(')\n    let dash = rawShow.IndexOf('-')\n    if bracketOpen &lt;&gt; -1 &amp;&amp; dash &gt; bracketOpen + 1 then\n        let yearStr = rawShow.Substring(bracketOpen + 1, dash - bracketOpen - 1)\n        tryParseInt yearStr\n    else\n        Error $\"Can't extract start year from '{rawShow}'\"\n\nextractYearStart \"The Wire (2002-2008)\"  // Ok 2002\nextractYearStart \"The Wire (-2008)\"      // Error \"Can't extract start year from 'The Wire (-2008)'\"\nextractYearStart \"The Wire (oops-2008)\"  // Error \"Can't parse 'oops' as integer\"\n</code></pre>"},{"location":"fsharp/part-3/#74-option-result","title":"7.4 Option \u304b\u3089 Result \u3078\u306e\u5909\u63db","text":"<p><code>Option.toResult</code> \u76f8\u5f53\u306e\u5909\u63db\u304c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>let year = Some 996\nlet noYear: int option = None\n\n// Option \u3092 Result \u306b\u5909\u63db\nlet toResult errorMsg opt =\n    match opt with\n    | Some x -&gt; Ok x\n    | None -&gt; Error errorMsg\n\nyear |&gt; toResult \"no year given\"     // Ok 996\nnoYear |&gt; toResult \"no year given\"   // Error \"no year given\"\n</code></pre> <p></p>"},{"location":"fsharp/part-3/#75-result","title":"7.5 Result \u306b\u3088\u308b\u5b8c\u5168\u306a\u30d1\u30fc\u30b5\u30fc","text":"<pre><code>let parseShow (rawShow: string) : Result&lt;TvShow, string&gt; =\n    match extractName rawShow with\n    | Error e -&gt; Error e\n    | Ok name -&gt;\n        let yearStart =\n            extractYearStart rawShow\n            |&gt; orElse (extractSingleYear rawShow)\n        let yearEnd =\n            extractYearEnd rawShow\n            |&gt; orElse (extractSingleYear rawShow)\n        match yearStart, yearEnd with\n        | Ok start, Ok endYear -&gt;\n            Ok { Title = name; Start = start; End = endYear }\n        | Error e, _ -&gt; Error e\n        | _, Error e -&gt; Error e\n\nparseShow \"The Wire (2002-2008)\"  // Ok { Title = \"The Wire\"; Start = 2002; End = 2008 }\nparseShow \"Mad Men ()\"            // Error \"Can't extract single year from 'Mad Men ()'\"\nparseShow \"(2002-2008)\"           // Error \"Can't extract name from '(2002-2008)'\"\n</code></pre>"},{"location":"fsharp/part-3/#76","title":"7.6 \u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3","text":"<p>Result \u306f\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u306b\u6700\u9069\u3067\u3059\u3002</p> <pre><code>let validateAge (age: int) : Result&lt;int, string&gt; =\n    if age &lt; 0 then Error \"Age cannot be negative\"\n    elif age &gt; 150 then Error \"Age cannot be greater than 150\"\n    else Ok age\n\nlet validateName (name: string) : Result&lt;string, string&gt; =\n    if System.String.IsNullOrWhiteSpace(name) then\n        Error \"Name cannot be empty\"\n    elif name.Length &gt; 100 then\n        Error \"Name cannot be longer than 100 characters\"\n    else\n        Ok name\n\nlet validateEmail (email: string) : Result&lt;string, string&gt; =\n    if System.String.IsNullOrWhiteSpace(email) then\n        Error \"Email cannot be empty\"\n    elif not (email.Contains(\"@\")) then\n        Error \"Email must contain @\"\n    else\n        Ok email\n</code></pre>"},{"location":"fsharp/part-3/#77-adt","title":"7.7 \u4ee3\u6570\u7684\u30c7\u30fc\u30bf\u578b\uff08ADT\uff09","text":"<p>F# \u3067\u306f\u3001\u5224\u5225\u5171\u7528\u4f53\uff08Discriminated Union\uff09\u3067\u76f4\u548c\u578b\u3092\u8868\u73fe\u3057\u307e\u3059\u3002</p>"},{"location":"fsharp/part-3/#product-type","title":"\u76f4\u7a4d\u578b\uff08Product Type\uff09","text":"<p>\u8907\u6570\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u3092AND\u3067\u7d44\u307f\u5408\u308f\u305b\u308b\u578b\u3067\u3059\u3002</p> <pre><code>/// \u30a2\u30fc\u30c6\u30a3\u30b9\u30c8\uff08\u76f4\u7a4d\u578b\uff09\ntype Artist = {\n    Name: string\n    Genre: MusicGenre\n    Origin: Location\n    YearsActive: YearsActive\n}\n</code></pre>"},{"location":"fsharp/part-3/#sum-type","title":"\u76f4\u548c\u578b\uff08Sum Type\uff09","text":"<p>\u8907\u6570\u306e\u9078\u629e\u80a2\u3092OR\u3067\u8868\u3059\u578b\u3067\u3059\u3002</p> <pre><code>/// \u97f3\u697d\u30b8\u30e3\u30f3\u30eb\uff08\u76f4\u548c\u578b\uff09\ntype MusicGenre =\n    | HeavyMetal\n    | Pop\n    | HardRock\n    | Jazz\n    | Classical\n\n/// \u6d3b\u52d5\u671f\u9593\uff08\u76f4\u548c\u578b\uff09\ntype YearsActive =\n    | StillActive of since: int\n    | ActiveBetween of start: int * endYear: int\n\n/// \u5730\u57df\uff08\u76f4\u548c\u578b\uff09\ntype Location =\n    | US\n    | UK\n    | England\n    | Japan\n    | Germany\n    | Other of string\n</code></pre> <p></p>"},{"location":"fsharp/part-3/#78","title":"7.8 \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0","text":"<p>\u76f4\u548c\u578b\u306f\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3067\u51e6\u7406\u3057\u307e\u3059\u3002</p> <pre><code>let wasArtistActive (artist: Artist) (yearStart: int) (yearEnd: int) : bool =\n    match artist.YearsActive with\n    | StillActive since -&gt; since &lt;= yearEnd\n    | ActiveBetween (start, endY) -&gt; start &lt;= yearEnd &amp;&amp; endY &gt;= yearStart\n\nlet activeLength (artist: Artist) (currentYear: int) : int =\n    match artist.YearsActive with\n    | StillActive since -&gt; currentYear - since\n    | ActiveBetween (start, endY) -&gt; endY - start\n\nlet describeActivity (yearsActive: YearsActive) : string =\n    match yearsActive with\n    | StillActive since -&gt; $\"Active since {since}\"\n    | ActiveBetween (start, endY) -&gt; $\"Active from {start} to {endY}\"\n</code></pre> <p></p>"},{"location":"fsharp/part-3/#79","title":"7.9 \u691c\u7d22\u6761\u4ef6\u306e\u30e2\u30c7\u30ea\u30f3\u30b0","text":"<p>\u691c\u7d22\u6761\u4ef6\u3082 ADT \u3067\u30e2\u30c7\u30ea\u30f3\u30b0\u3067\u304d\u307e\u3059\u3002</p> <pre><code>type SearchCondition =\n    | SearchByGenre of genres: MusicGenre list\n    | SearchByOrigin of locations: Location list\n    | SearchByActiveYears of start: int * endYear: int\n\nlet matchesCondition (artist: Artist) (condition: SearchCondition) : bool =\n    match condition with\n    | SearchByGenre genres -&gt; List.contains artist.Genre genres\n    | SearchByOrigin locations -&gt; List.contains artist.Origin locations\n    | SearchByActiveYears (start, endY) -&gt; wasArtistActive artist start endY\n\nlet searchArtists (artists: Artist list) (conditions: SearchCondition list) : Artist list =\n    artists\n    |&gt; List.filter (fun artist -&gt;\n        conditions |&gt; List.forall (matchesCondition artist))\n</code></pre>"},{"location":"fsharp/part-3/#710","title":"7.10 \u652f\u6255\u3044\u65b9\u6cd5\u306e\u4f8b","text":"<pre><code>type PaymentMethod =\n    | CreditCard of number: string * expiry: string\n    | BankTransfer of accountNumber: string\n    | Cash\n\nlet describePayment (method: PaymentMethod) : string =\n    match method with\n    | CreditCard (number, _) -&gt; $\"Credit card ending in {number}\"\n    | BankTransfer account -&gt; $\"Bank transfer to account {account}\"\n    | Cash -&gt; \"Cash payment\"\n\nlet isValidPayment (method: PaymentMethod) : bool =\n    match method with\n    | CreditCard (number, expiry) -&gt;\n        number.Length &gt;= 4 &amp;&amp; expiry.Contains(\"/\")\n    | BankTransfer account -&gt;\n        account.Length &gt; 0\n    | Cash -&gt; true\n</code></pre>"},{"location":"fsharp/part-3/#_4","title":"\u307e\u3068\u3081","text":""},{"location":"fsharp/part-3/#part-iii","title":"Part III \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"fsharp/part-3/#option-vs-result","title":"Option vs Result \u306e\u4f7f\u3044\u5206\u3051","text":"\u72b6\u6cc1 \u4f7f\u7528\u3059\u308b\u578b \u5024\u304c\u3042\u308b\u304b\u306a\u3044\u304b\u3060\u3051\u304c\u91cd\u8981 <code>'a option</code> \u5931\u6557\u7406\u7531\u3092\u4f1d\u3048\u308b\u5fc5\u8981\u304c\u3042\u308b <code>Result&lt;'a, string&gt;</code> \u691c\u7d22\u7d50\u679c\u304c\u898b\u3064\u304b\u3089\u306a\u3044 <code>'a option</code> \u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u30a8\u30e9\u30fc\u3092\u4f1d\u3048\u308b <code>Result&lt;'a, string&gt;</code> \u8907\u6570\u306e\u30a8\u30e9\u30fc\u7a2e\u5225\u304c\u3042\u308b <code>Result&lt;'a, ErrorType&gt;</code>"},{"location":"fsharp/part-3/#f-scala","title":"F# \u3068 Scala \u306e\u5bfe\u5fdc","text":"\u6982\u5ff5 F# Scala \u5024\u306e\u6709\u7121 <code>option</code> <code>Option</code> \u6210\u529f/\u5931\u6557 <code>Result</code> <code>Either</code> \u5024\u3042\u308a <code>Some</code> <code>Some</code> \u5024\u306a\u3057 <code>None</code> <code>None</code> \u6210\u529f <code>Ok</code> <code>Right</code> \u5931\u6557 <code>Error</code> <code>Left</code> \u76f4\u548c\u578b \u5224\u5225\u5171\u7528\u4f53 enum / sealed trait"},{"location":"fsharp/part-3/#_5","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>Option: \u5024\u306e\u6709\u7121\u3092\u578b\u3067\u8868\u73fe\u3059\u308b</li> <li>Result: \u6210\u529f/\u5931\u6557\u3068\u30a8\u30e9\u30fc\u60c5\u5831\u3092\u578b\u3067\u8868\u73fe\u3059\u308b</li> <li>\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0: Option/Result \u3092\u5b89\u5168\u306b\u51e6\u7406\u3059\u308b</li> <li>Option.orElse: \u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u3092\u63d0\u4f9b\u3059\u308b</li> <li>ADT: \u76f4\u7a4d\u578b\u3068\u76f4\u548c\u578b\u3067\u30c9\u30e1\u30a4\u30f3\u3092\u6b63\u78ba\u306b\u30e2\u30c7\u30ea\u30f3\u30b0</li> <li>forall/exists: Option \u3067\u306e\u6761\u4ef6\u5224\u5b9a\u306b\u4fbf\u5229</li> </ol>"},{"location":"fsharp/part-3/#_6","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part IV \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li>\u526f\u4f5c\u7528\u306e\u7ba1\u7406</li> <li>\u975e\u540c\u671f\u51e6\u7406</li> <li>\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406</li> </ul>"},{"location":"fsharp/part-3/#_7","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"fsharp/part-3/#1-option","title":"\u554f\u984c 1: Option \u306e\u57fa\u672c","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>let safeDivide (a: int) (b: int) : int option = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert (safeDivide 10 2 = Some 5)\nassert (safeDivide 10 0 = None)\nassert (safeDivide 7 2 = Some 3)\n</code></pre> \u89e3\u7b54 <pre><code>let safeDivide (a: int) (b: int) : int option =\n    if b = 0 then None\n    else Some (a / b)\n</code></pre>"},{"location":"fsharp/part-3/#2-option","title":"\u554f\u984c 2: Option \u306e\u5408\u6210","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u30022\u3064\u306e\u6570\u5024\u6587\u5b57\u5217\u3092\u53d7\u3051\u53d6\u308a\u3001\u305d\u306e\u5408\u8a08\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>let addStrings (a: string) (b: string) : int option = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert (addStrings \"10\" \"20\" = Some 30)\nassert (addStrings \"10\" \"abc\" = None)\nassert (addStrings \"xyz\" \"20\" = None)\n</code></pre> \u89e3\u7b54 <pre><code>let tryParseInt (s: string) : int option =\n    match System.Int32.TryParse(s) with\n    | true, value -&gt; Some value\n    | false, _ -&gt; None\n\nlet addStrings (a: string) (b: string) : int option =\n    match tryParseInt a, tryParseInt b with\n    | Some x, Some y -&gt; Some (x + y)\n    | _ -&gt; None\n</code></pre>"},{"location":"fsharp/part-3/#3-result","title":"\u554f\u984c 3: Result \u306b\u3088\u308b\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u5e74\u9f62\u3092\u691c\u8a3c\u3057\u3001\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>let validateAge (age: int) : Result&lt;int, string&gt; = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert (validateAge 25 = Ok 25)\nassert (validateAge -5 = Error \"Age cannot be negative\")\nassert (validateAge 200 = Error \"Age cannot be greater than 150\")\n</code></pre> \u89e3\u7b54 <pre><code>let validateAge (age: int) : Result&lt;int, string&gt; =\n    if age &lt; 0 then Error \"Age cannot be negative\"\n    elif age &gt; 150 then Error \"Age cannot be greater than 150\"\n    else Ok age\n</code></pre>"},{"location":"fsharp/part-3/#4","title":"\u554f\u984c 4: \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0","text":"<p>\u4ee5\u4e0b\u306e\u5224\u5225\u5171\u7528\u4f53\u3068\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u4f7f\u3063\u305f\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>type PaymentMethod =\n    | CreditCard of number: string * expiry: string\n    | BankTransfer of accountNumber: string\n    | Cash\n\nlet describePayment (method: PaymentMethod) : string = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert (describePayment (CreditCard (\"1234\", \"12/25\")) = \"Credit card ending in 1234\")\nassert (describePayment (BankTransfer \"9876\") = \"Bank transfer to account 9876\")\nassert (describePayment Cash = \"Cash payment\")\n</code></pre> \u89e3\u7b54 <pre><code>let describePayment (method: PaymentMethod) : string =\n    match method with\n    | CreditCard (number, _) -&gt; $\"Credit card ending in {number}\"\n    | BankTransfer account -&gt; $\"Bank transfer to account {account}\"\n    | Cash -&gt; \"Cash payment\"\n</code></pre>"},{"location":"fsharp/part-3/#5-forall-exists","title":"\u554f\u984c 5: forall \u3068 exists","text":"<p>\u4ee5\u4e0b\u306e\u6761\u4ef6\u306b\u5408\u3046\u30e6\u30fc\u30b6\u30fc\u3092\u62bd\u51fa\u3059\u308b\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>type User = {\n    Name: string\n    Email: string option\n    Age: int\n}\n\nlet users = [\n    { Name = \"Alice\"; Email = Some \"alice@example.com\"; Age = 25 }\n    { Name = \"Bob\"; Email = None; Age = 30 }\n    { Name = \"Charlie\"; Email = Some \"charlie@test.com\"; Age = 17 }\n]\n\n// 1. \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u304b\u3001example.com \u30c9\u30e1\u30a4\u30f3\u306e\u30e6\u30fc\u30b6\u30fc\nlet f1 (users: User list) : User list = ???\n\n// 2. \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u3066\u3001test.com \u30c9\u30e1\u30a4\u30f3\u306e\u30e6\u30fc\u30b6\u30fc\nlet f2 (users: User list) : User list = ???\n</code></pre> \u89e3\u7b54 <pre><code>// 1. \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u304b\u3001example.com \u30c9\u30e1\u30a4\u30f3\nlet f1 (users: User list) : User list =\n    users\n    |&gt; List.filter (fun user -&gt;\n        user.Email |&gt; Option.forall (fun email -&gt; email.EndsWith(\"@example.com\")))\n// [Alice; Bob]\n\n// 2. \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u3066\u3001test.com \u30c9\u30e1\u30a4\u30f3\nlet f2 (users: User list) : User list =\n    users\n    |&gt; List.filter (fun user -&gt;\n        user.Email |&gt; Option.exists (fun email -&gt; email.EndsWith(\"@test.com\")))\n// [Charlie]\n</code></pre>"},{"location":"fsharp/part-4/","title":"Part IV: \u975e\u540c\u671f\u51e6\u7406\u3068\u30b9\u30c8\u30ea\u30fc\u30e0","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u526f\u4f5c\u7528\u306e\u6271\u3044\u65b9\u3092\u5b66\u3073\u307e\u3059\u3002F# \u306e Async \u3092\u4f7f\u3063\u3066\u526f\u4f5c\u7528\u3092\u7d14\u7c8b\u95a2\u6570\u5185\u3067\u5b89\u5168\u306b\u8a18\u8ff0\u3057\u3001Seq\uff08\u30b7\u30fc\u30b1\u30f3\u30b9\uff09\u3067\u7121\u9650\u306e\u30c7\u30fc\u30bf\u3092\u6271\u3046\u65b9\u6cd5\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"fsharp/part-4/#8-async","title":"\u7b2c8\u7ae0: Async \u306b\u3088\u308b\u975e\u540c\u671f\u51e6\u7406","text":""},{"location":"fsharp/part-4/#81","title":"8.1 \u526f\u4f5c\u7528\u306e\u554f\u984c","text":"<p>\u7d14\u7c8b\u95a2\u6570\u306f\u526f\u4f5c\u7528\u3092\u6301\u3061\u307e\u305b\u3093\u3002\u3057\u304b\u3057\u3001\u5b9f\u969b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u306b\u306f\u526f\u4f5c\u7528\u304c\u5fc5\u8981\u3067\u3059:</p> <ul> <li>\u30d5\u30a1\u30a4\u30eb\u306e\u8aad\u307f\u66f8\u304d</li> <li>\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u901a\u4fe1</li> <li>\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30a2\u30af\u30bb\u30b9</li> <li>\u4e71\u6570\u751f\u6210</li> <li>\u73fe\u5728\u6642\u523b\u306e\u53d6\u5f97</li> </ul> <p></p>"},{"location":"fsharp/part-4/#82-f-async","title":"8.2 F# \u306e Async \u3068\u306f","text":"<p>Async\uff08\u975e\u540c\u671f\u8a08\u7b97\uff09\u306f\u300c\u526f\u4f5c\u7528\u3092\u6301\u3064\u8a08\u7b97\u306e\u8a18\u8ff0\u300d\u3092\u8868\u3059\u578b\u3067\u3059\u3002</p> <ul> <li><code>Async&lt;'a&gt;</code> \u306f\u300c\u5b9f\u884c\u3059\u308b\u3068 <code>'a</code> \u578b\u306e\u5024\u3092\u8fd4\u3059\u526f\u4f5c\u7528\u306e\u3042\u308b\u8a08\u7b97\u300d</li> <li>Async \u5024\u3092\u4f5c\u6210\u3057\u305f\u3060\u3051\u3067\u306f\u526f\u4f5c\u7528\u306f\u767a\u751f\u3057\u306a\u3044</li> <li><code>Async.RunSynchronously</code> \u3067\u5b9f\u969b\u306b\u5b9f\u884c\u3055\u308c\u308b</li> </ul> <p></p>"},{"location":"fsharp/part-4/#83","title":"8.3 \u30b5\u30a4\u30b3\u30ed\u3092\u632f\u308b\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/fsharp/src/Ch08/AsyncIO.fs</code></p>"},{"location":"fsharp/part-4/#_1","title":"\u4e0d\u7d14\u306a\u95a2\u6570\uff08\u526f\u4f5c\u7528\u3042\u308a\uff09","text":"<pre><code>open System\n\nlet castTheDieImpure () : int =\n    let random = Random()\n    random.Next(1, 7)\n\n// \u547c\u3073\u51fa\u3059\u305f\u3073\u306b\u7570\u306a\u308b\u5024\u304c\u8fd4\u308b\nprintfn \"%d\" (castTheDieImpure ())  // 3\nprintfn \"%d\" (castTheDieImpure ())  // 5\nprintfn \"%d\" (castTheDieImpure ())  // 1\n</code></pre>"},{"location":"fsharp/part-4/#async","title":"Async \u3092\u4f7f\u3063\u305f\u7d14\u7c8b\u306a\u8a18\u8ff0","text":"<pre><code>let castTheDie () : Async&lt;int&gt; =\n    async { return castTheDieImpure () }\n\n// Async \u5024\u3092\u4f5c\u6210\uff08\u3053\u306e\u6642\u70b9\u3067\u306f\u5b9f\u884c\u3055\u308c\u306a\u3044\uff09\nlet dieCast: Async&lt;int&gt; = castTheDie ()\nprintfn \"%A\" dieCast  // Async&lt;int&gt; - \u307e\u3060\u5b9f\u884c\u3055\u308c\u3066\u3044\u306a\u3044\n\n// \u5b9f\u969b\u306b\u5b9f\u884c\nprintfn \"%d\" (Async.RunSynchronously dieCast)  // 4\n</code></pre>"},{"location":"fsharp/part-4/#84-async","title":"8.4 Async \u306e\u4f5c\u6210\u65b9\u6cd5","text":"\u65b9\u6cd5 \u7528\u9014 \u4f8b <code>async { return expr }</code> \u526f\u4f5c\u7528\u306e\u3042\u308b\u5f0f\u3092\u30e9\u30c3\u30d7 <code>async { return castTheDieImpure () }</code> <code>async { return value }</code> \u65e2\u5b58\u306e\u5024\u3092\u30e9\u30c3\u30d7\uff08\u526f\u4f5c\u7528\u306a\u3057\uff09 <code>async { return 42 }</code> <code>async { return () }</code> \u4f55\u3082\u3057\u306a\u3044 Async <code>async { return () }</code> <pre><code>// \u526f\u4f5c\u7528\u3092\u9045\u5ef6\u5b9f\u884c\nlet delayedPrint: Async&lt;unit&gt; = async {\n    printfn \"Hello\"\n    return ()\n}\n// println \u306f\u307e\u3060\u5b9f\u884c\u3055\u308c\u3066\u3044\u306a\u3044\n\n// \u65e2\u5b58\u306e\u5024\u3092\u30e9\u30c3\u30d7\nlet pureValue: Async&lt;int&gt; = async { return 42 }\n// \u526f\u4f5c\u7528\u306a\u3057\u3001\u5373\u5ea7\u306b 42 \u304c\u78ba\u5b9a\n</code></pre>"},{"location":"fsharp/part-4/#85-async","title":"8.5 Async \u306e\u5408\u6210","text":"<p>Async \u5024\u306f <code>let!</code> \u3092\u4f7f\u3063\u3066\u5408\u6210\u3067\u304d\u307e\u3059\u3002</p> <pre><code>let castTheDieTwice () : Async&lt;int&gt; =\n    async {\n        let! firstCast = castTheDie ()\n        let! secondCast = castTheDie ()\n        return firstCast + secondCast\n    }\n\n// \u307e\u3060\u5b9f\u884c\u3055\u308c\u3066\u3044\u306a\u3044\nlet program: Async&lt;int&gt; = castTheDieTwice ()\n\n// \u5b9f\u884c\nlet result: int = Async.RunSynchronously program\n</code></pre> <p></p>"},{"location":"fsharp/part-4/#86","title":"8.6 \u30df\u30fc\u30c6\u30a3\u30f3\u30b0\u30b9\u30b1\u30b8\u30e5\u30fc\u30ea\u30f3\u30b0\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/fsharp/src/Ch08/AsyncIO.fs</code></p> <p>\u3088\u308a\u5b9f\u8df5\u7684\u306a\u4f8b\u3068\u3057\u3066\u3001\u30df\u30fc\u30c6\u30a3\u30f3\u30b0\u306e\u30b9\u30b1\u30b8\u30e5\u30fc\u30ea\u30f3\u30b0\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p> <pre><code>type MeetingTime = { StartHour: int; EndHour: int }\n\n// \u526f\u4f5c\u7528\u306e\u3042\u308b API \u547c\u3073\u51fa\u3057\u3092 Async \u3067\u30e9\u30c3\u30d7\nlet calendarEntries (name: string) : Async&lt;MeetingTime list&gt; =\n    async { return calendarEntriesApiCall name }\n\nlet createMeeting (names: string list) (meeting: MeetingTime) : Async&lt;unit&gt; =\n    async { return createMeetingApiCall names meeting }\n</code></pre>"},{"location":"fsharp/part-4/#_2","title":"\u4e88\u5b9a\u306e\u53d6\u5f97","text":"<pre><code>let scheduledMeetings (person1: string) (person2: string) : Async&lt;MeetingTime list&gt; =\n    async {\n        let! entries1 = calendarEntries person1\n        let! entries2 = calendarEntries person2\n        return entries1 @ entries2\n    }\n</code></pre>"},{"location":"fsharp/part-4/#_3","title":"\u7a7a\u304d\u6642\u9593\u306e\u8a08\u7b97\uff08\u7d14\u7c8b\u95a2\u6570\uff09","text":"<pre><code>let possibleMeetings\n    (existingMeetings: MeetingTime list)\n    (startHour: int)\n    (endHour: int)\n    (lengthHours: int)\n    : MeetingTime list =\n    [ startHour .. (endHour - lengthHours) ]\n    |&gt; List.map (fun start -&gt; { StartHour = start; EndHour = start + lengthHours })\n    |&gt; List.filter (fun slot -&gt;\n        existingMeetings |&gt; List.forall (fun meeting -&gt; not (meetingsOverlap meeting slot)))\n</code></pre>"},{"location":"fsharp/part-4/#87-orelse","title":"8.7 orElse \u306b\u3088\u308b\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":"<p>\u5931\u6557\u6642\u306e\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002</p> <pre><code>let orElse (fallback: Async&lt;'a&gt;) (primary: Async&lt;'a&gt;) : Async&lt;'a&gt; =\n    async {\n        try\n            return! primary\n        with _ -&gt;\n            return! fallback\n    }\n\nlet year: Async&lt;int&gt; = async { return 996 }\nlet noYear: Async&lt;int&gt; = async { return failwith \"no year\" }\n\nyear |&gt; orElse (async { return 2020 }) |&gt; Async.RunSynchronously    // 996\nnoYear |&gt; orElse (async { return 2020 }) |&gt; Async.RunSynchronously  // 2020\n</code></pre> <p></p>"},{"location":"fsharp/part-4/#_4","title":"\u30ea\u30c8\u30e9\u30a4\u6226\u7565","text":"<pre><code>// API \u547c\u3073\u51fa\u3057\u30923\u56de\u307e\u3067\u30ea\u30c8\u30e9\u30a4\ncalendarEntries \"Alice\"\n|&gt; orElse (calendarEntries \"Alice\")\n|&gt; orElse (calendarEntries \"Alice\")\n|&gt; orElse (async { return [] })  // \u5168\u90e8\u5931\u6557\u3057\u305f\u3089\u7a7a\u30ea\u30b9\u30c8\n</code></pre>"},{"location":"fsharp/part-4/#_5","title":"\u6c4e\u7528\u30ea\u30c8\u30e9\u30a4\u95a2\u6570","text":"<pre><code>let retry (maxRetries: int) (action: Async&lt;'a&gt;) : Async&lt;'a&gt; =\n    let rec loop remaining =\n        async {\n            try\n                return! action\n            with ex -&gt;\n                if remaining &gt; 0 then\n                    return! loop (remaining - 1)\n                else\n                    return raise ex\n        }\n    loop maxRetries\n\n// \u4f7f\u7528\u4f8b\nretry 10 (calendarEntries \"Alice\")\n</code></pre>"},{"location":"fsharp/part-4/#88-sequence-async","title":"8.8 sequence \u306b\u3088\u308b Async \u306e\u30ea\u30b9\u30c8\u51e6\u7406","text":"<p><code>Async&lt;'a&gt; list</code> \u3092 <code>Async&lt;'a list&gt;</code> \u306b\u5909\u63db\u3059\u308b\u306b\u306f sequence \u3092\u4f7f\u3044\u307e\u3059\u3002</p> <pre><code>let sequence (asyncList: Async&lt;'a&gt; list) : Async&lt;'a list&gt; =\n    async {\n        let! results =\n            asyncList\n            |&gt; List.map (fun a -&gt; async {\n                let! result = a\n                return result\n            })\n            |&gt; Async.Sequential\n        return results |&gt; Array.toList\n    }\n\nlet actions: Async&lt;int&gt; list = [ async { return 1 }; async { return 2 }; async { return 3 } ]\nlet combined: Async&lt;int list&gt; = sequence actions\n\nAsync.RunSynchronously combined  // [1; 2; 3]\n</code></pre>"},{"location":"fsharp/part-4/#_6","title":"\u8907\u6570\u4eba\u306e\u4e88\u5b9a\u3092\u53d6\u5f97","text":"<pre><code>let scheduledMeetingsMultiple (attendees: string list) : Async&lt;MeetingTime list&gt; =\n    async {\n        let! allMeetings =\n            attendees\n            |&gt; List.map (fun name -&gt; retry 10 (calendarEntries name))\n            |&gt; sequence\n        return allMeetings |&gt; List.concat\n    }\n</code></pre>"},{"location":"fsharp/part-4/#89","title":"8.9 \u4e26\u5217\u5b9f\u884c","text":"<p>F# \u3067\u306f <code>Async.Parallel</code> \u3067\u8907\u6570\u306e Async \u3092\u4e26\u5217\u5b9f\u884c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>let parallelAll (asyncList: Async&lt;'a&gt; list) : Async&lt;'a list&gt; =\n    async {\n        let! results = Async.Parallel asyncList\n        return results |&gt; Array.toList\n    }\n\n// \u4f7f\u7528\u4f8b\nlet tasks = [ calendarEntries \"Alice\"; calendarEntries \"Bob\"; calendarEntries \"Charlie\" ]\nlet allResults = parallelAll tasks |&gt; Async.RunSynchronously\n</code></pre>"},{"location":"fsharp/part-4/#9","title":"\u7b2c9\u7ae0: \u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406","text":""},{"location":"fsharp/part-4/#91-seq","title":"9.1 Seq\uff08\u30b7\u30fc\u30b1\u30f3\u30b9\uff09\u3068\u306f","text":"<p>Seq\uff08\u30b7\u30fc\u30b1\u30f3\u30b9\uff09\u306f\u3001\u8981\u7d20\u306e\uff08\u6f5c\u5728\u7684\u306b\u7121\u9650\u306e\uff09\u30b7\u30fc\u30b1\u30f3\u30b9\u3092\u8868\u3057\u307e\u3059\u3002</p> <p></p>"},{"location":"fsharp/part-4/#92","title":"9.2 \u7d14\u7c8b\u306a\u30b7\u30fc\u30b1\u30f3\u30b9","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/fsharp/src/Ch09/StreamProcessing.fs</code></p> <pre><code>// \u6709\u9650\u30b7\u30fc\u30b1\u30f3\u30b9\nlet numbers: int seq = seq { 1; 2; 3 }\n\n// List \u306b\u5909\u63db\nnumbers |&gt; Seq.toList  // [1; 2; 3]\n\n// \u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\nlet oddNumbers = numbers |&gt; Seq.filter (fun n -&gt; n % 2 &lt;&gt; 0)\noddNumbers |&gt; Seq.toList  // [1; 3]\n</code></pre>"},{"location":"fsharp/part-4/#93","title":"9.3 \u7121\u9650\u30b7\u30fc\u30b1\u30f3\u30b9","text":"<pre><code>// repeat \u3067\u7121\u9650\u306b\u7e70\u308a\u8fd4\u3057\nlet repeat (elements: 'a seq) : 'a seq =\n    seq {\n        while true do\n            yield! elements\n    }\n\nlet infinite123s: int seq = repeat (seq { 1; 2; 3 })\n\n// take \u3067\u6709\u9650\u500b\u3092\u53d6\u5f97\ninfinite123s |&gt; Seq.take 8 |&gt; Seq.toList  // [1; 2; 3; 1; 2; 3; 1; 2]\n</code></pre>"},{"location":"fsharp/part-4/#94","title":"9.4 \u30b5\u30a4\u30b3\u30ed\u3092\u632f\u308b\u30b9\u30c8\u30ea\u30fc\u30e0","text":"<pre><code>let private random = Random()\n\nlet private castTheDieImpure () : int =\n    random.Next(1, 7)\n\n// \u30b5\u30a4\u30b3\u30ed\u3092\u7121\u9650\u306b\u632f\u308b\u30b9\u30c8\u30ea\u30fc\u30e0\nlet infiniteDieCasts : int seq =\n    seq {\n        while true do\n            yield castTheDieImpure ()\n    }\n\n// \u6700\u521d\u306e3\u56de\u3092\u53d6\u5f97\ninfiniteDieCasts |&gt; Seq.take 3 |&gt; Seq.toList  // [4; 2; 6]\n\n// 6 \u304c\u51fa\u308b\u307e\u3067\u632f\u308a\u7d9a\u3051\u308b\nlet castUntil (target: int) : int seq =\n    infiniteDieCasts\n    |&gt; Seq.takeWhile (fun n -&gt; n &lt;&gt; target)\n    |&gt; Seq.append (Seq.singleton target)\n</code></pre>"},{"location":"fsharp/part-4/#95","title":"9.5 \u30b7\u30fc\u30b1\u30f3\u30b9\u306e\u4e3b\u8981\u64cd\u4f5c","text":"\u64cd\u4f5c \u8aac\u660e \u4f8b <code>Seq.take n</code> \u6700\u521d\u306e n \u8981\u7d20\u3092\u53d6\u5f97 <code>seq \\|&gt; Seq.take 3</code> <code>Seq.filter p</code> \u6761\u4ef6\u3092\u6e80\u305f\u3059\u8981\u7d20\u306e\u307f <code>seq \\|&gt; Seq.filter (fun x -&gt; x &gt; 0)</code> <code>Seq.map f</code> \u5404\u8981\u7d20\u3092\u5909\u63db <code>seq \\|&gt; Seq.map (fun x -&gt; x * 2)</code> <code>Seq.append s1 s2</code> 2\u3064\u306e\u30b7\u30fc\u30b1\u30f3\u30b9\u3092\u7d50\u5408 <code>Seq.append s1 s2</code> <code>Seq.windowed n</code> \u30b9\u30e9\u30a4\u30c7\u30a3\u30f3\u30b0\u30a6\u30a3\u30f3\u30c9\u30a6 <code>seq \\|&gt; Seq.windowed 3</code>"},{"location":"fsharp/part-4/#96","title":"9.6 \u901a\u8ca8\u4ea4\u63db\u30ec\u30fc\u30c8\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/fsharp/src/Ch09/StreamProcessing.fs</code></p> <p>\u70ba\u66ff\u30ec\u30fc\u30c8\u3092\u76e3\u8996\u3057\u3066\u3001\u4e0a\u6607\u30c8\u30ec\u30f3\u30c9\u3092\u691c\u51fa\u3059\u308b\u4f8b\u3067\u3059\u3002</p>"},{"location":"fsharp/part-4/#_7","title":"\u30c8\u30ec\u30f3\u30c9\u5224\u5b9a\uff08\u7d14\u7c8b\u95a2\u6570\uff09","text":"<pre><code>let trending (rates: decimal list) : bool =\n    rates.Length &gt; 1 &amp;&amp;\n    rates\n    |&gt; List.pairwise\n    |&gt; List.forall (fun (prev, curr) -&gt; curr &gt; prev)\n\ntrending [0.81m; 0.82m; 0.83m]  // true (\u4e0a\u6607\u30c8\u30ec\u30f3\u30c9)\ntrending [0.81m; 0.84m; 0.83m]  // false\n</code></pre>"},{"location":"fsharp/part-4/#_8","title":"\u30ec\u30fc\u30c8\u306e\u30b9\u30c8\u30ea\u30fc\u30e0","text":"<pre><code>type Currency = USD | EUR | GBP | JPY\n\nlet rates (from: Currency) (toC: Currency) : decimal seq =\n    seq {\n        while true do\n            yield getExchangeRate from toC\n    }\n</code></pre>"},{"location":"fsharp/part-4/#97","title":"9.7 \u30b9\u30e9\u30a4\u30c7\u30a3\u30f3\u30b0\u30a6\u30a3\u30f3\u30c9\u30a6","text":"<p><code>Seq.windowed</code> \u3067\u9023\u7d9a\u3059\u308b\u8981\u7d20\u3092\u30b0\u30eb\u30fc\u30d7\u5316\u3067\u304d\u307e\u3059\u3002</p> <pre><code>let stream = seq { 1; 2; 3; 4; 5 }\n\nstream |&gt; Seq.windowed 3 |&gt; Seq.toList\n// [[|1; 2; 3|]; [|2; 3; 4|]; [|3; 4; 5|]]\n</code></pre> <p></p>"},{"location":"fsharp/part-4/#_9","title":"\u30c8\u30ec\u30f3\u30c9\u3092\u691c\u51fa\u3057\u3066\u4ea4\u63db","text":"<pre><code>let exchangeIfTrending\n    (amount: decimal)\n    (from: Currency)\n    (toC: Currency)\n    (windowSize: int)\n    : decimal option =\n    rates from toC\n    |&gt; Seq.windowed windowSize\n    |&gt; Seq.map Array.toList\n    |&gt; Seq.tryFind trending\n    |&gt; Option.map (fun rateWindow -&gt;\n        let lastRate = rateWindow |&gt; List.last\n        amount * lastRate)\n</code></pre>"},{"location":"fsharp/part-4/#98","title":"9.8 \u30b7\u30fc\u30b1\u30f3\u30b9\u306e\u7d50\u5408","text":"<p>2\u3064\u306e\u30b7\u30fc\u30b1\u30f3\u30b9\u3092 <code>Seq.zip</code> \u3067\u7d50\u5408\u3067\u304d\u307e\u3059\u3002</p> <pre><code>let s1 = seq { 1; 2; 3 }\nlet s2 = seq { \"a\"; \"b\"; \"c\" }\n\nSeq.zip s1 s2 |&gt; Seq.toList  // [(1, \"a\"); (2, \"b\"); (3, \"c\")]\n\n// \u5de6\u5074\u306e\u5024\u306e\u307f\u3092\u8fd4\u3059\nlet zipLeft (stream1: 'a seq) (stream2: 'b seq) : 'a seq =\n    Seq.zip stream1 stream2\n    |&gt; Seq.map fst\n</code></pre> <p></p>"},{"location":"fsharp/part-4/#99","title":"9.9 \u5b9f\u7528\u7684\u306a\u30b9\u30c8\u30ea\u30fc\u30e0\u64cd\u4f5c","text":"<pre><code>// \u7d2f\u7a4d\u548c\nlet runningSum (stream: int seq) : int seq =\n    stream |&gt; Seq.scan (+) 0 |&gt; Seq.skip 1\n\nrunningSum (seq { 1; 2; 3; 4; 5 }) |&gt; Seq.toList  // [1; 3; 6; 10; 15]\n\n// \u79fb\u52d5\u5e73\u5747\nlet movingAverage (windowSize: int) (stream: decimal seq) : decimal seq =\n    stream\n    |&gt; Seq.windowed windowSize\n    |&gt; Seq.map (fun window -&gt;\n        window |&gt; Array.sum |&gt; fun s -&gt; s / decimal windowSize)\n\n// \u9023\u7d9a\u3059\u308b\u91cd\u8907\u3092\u9664\u53bb\nlet distinctConsecutive (stream: 'a seq) : 'a seq =\n    seq {\n        let mutable prev = None\n        for item in stream do\n            match prev with\n            | Some p when p = item -&gt; ()\n            | _ -&gt;\n                yield item\n                prev &lt;- Some item\n    }\n</code></pre>"},{"location":"fsharp/part-4/#scala","title":"Scala \u3068\u306e\u6bd4\u8f03","text":""},{"location":"fsharp/part-4/#io-async","title":"IO \u3068 Async \u306e\u6bd4\u8f03","text":"Scala (Cats Effect) F# \u8aac\u660e <code>IO[A]</code> <code>Async&lt;'a&gt;</code> \u526f\u4f5c\u7528\u3092\u8a18\u8ff0\u3059\u308b\u578b <code>IO.delay(expr)</code> <code>async { return expr }</code> \u526f\u4f5c\u7528\u3092\u30e9\u30c3\u30d7 <code>IO.pure(value)</code> <code>async { return value }</code> \u7d14\u7c8b\u306a\u5024\u3092\u30e9\u30c3\u30d7 <code>for { a &lt;- io1; b &lt;- io2 } yield ...</code> <code>async { let! a = io1; let! b = io2; return ... }</code> \u5408\u6210 <code>io.unsafeRunSync()</code> <code>Async.RunSynchronously io</code> \u540c\u671f\u5b9f\u884c <code>io1.orElse(io2)</code> <code>io1 \\|&gt; orElse io2</code> \u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af <code>ios.sequence</code> <code>sequence ios</code> \u30ea\u30b9\u30c8\u306e\u5909\u63db"},{"location":"fsharp/part-4/#stream-seq","title":"Stream \u3068 Seq \u306e\u6bd4\u8f03","text":"Scala (fs2) F# \u8aac\u660e <code>Stream[Pure, A]</code> <code>'a seq</code> \u7d14\u7c8b\u306a\u30b9\u30c8\u30ea\u30fc\u30e0 <code>Stream.eval(io)</code> <code>async { ... }</code> + \u5909\u63db IO \u3092\u542b\u3080\u30b9\u30c8\u30ea\u30fc\u30e0 <code>stream.repeat</code> <code>repeat stream</code> \u7121\u9650\u7e70\u308a\u8fd4\u3057 <code>stream.take(n)</code> <code>Seq.take n stream</code> \u6700\u521d\u306e n \u8981\u7d20 <code>stream.filter(p)</code> <code>Seq.filter p stream</code> \u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0 <code>stream.sliding(n)</code> <code>Seq.windowed n stream</code> \u30b9\u30e9\u30a4\u30c7\u30a3\u30f3\u30b0\u30a6\u30a3\u30f3\u30c9\u30a6"},{"location":"fsharp/part-4/#_10","title":"\u307e\u3068\u3081","text":""},{"location":"fsharp/part-4/#part-iv_1","title":"Part IV \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"fsharp/part-4/#async-seq","title":"Async \u3068 Seq \u306e\u6bd4\u8f03","text":"\u7279\u6027 Async&lt;'a&gt; 'a seq \u8981\u7d20\u6570 1\u3064 0\u500b\u4ee5\u4e0a\uff08\u7121\u9650\u3082\u53ef\uff09 \u5b9f\u884c <code>Async.RunSynchronously</code> <code>Seq.toList</code> \u7528\u9014 \u5358\u4e00\u306e\u526f\u4f5c\u7528 \u9023\u7d9a\u3057\u305f\u8981\u7d20\u306e\u51e6\u7406"},{"location":"fsharp/part-4/#_11","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>Async: \u526f\u4f5c\u7528\u3092\u300c\u8a18\u8ff0\u300d\u3068\u3057\u3066\u6271\u3044\u3001\u5b9f\u884c\u3092\u9045\u5ef6\u3055\u305b\u308b</li> <li>async { return ... }: \u526f\u4f5c\u7528\u306e\u3042\u308b\u5f0f\u3092 Async \u306b\u30e9\u30c3\u30d7</li> <li>let!: Async \u3092\u5408\u6210\uff08Scala \u306e flatMap \u76f8\u5f53\uff09</li> <li>orElse: \u5931\u6557\u6642\u306e\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u3092\u6307\u5b9a</li> <li>sequence: <code>Async&lt;'a&gt; list</code> \u2192 <code>Async&lt;'a list&gt;</code></li> <li>Seq: \u6f5c\u5728\u7684\u306b\u7121\u9650\u306e\u30b7\u30fc\u30b1\u30f3\u30b9\u3092\u9045\u5ef6\u8a55\u4fa1\u3067\u51e6\u7406</li> <li>Seq.windowed: \u9023\u7d9a\u3059\u308b\u8981\u7d20\u3092\u30b0\u30eb\u30fc\u30d7\u5316\u3057\u3066\u30d1\u30bf\u30fc\u30f3\u3092\u691c\u51fa</li> </ol>"},{"location":"fsharp/part-4/#_12","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part V \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li>\u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406</li> <li>Agent\uff08MailboxProcessor\uff09\u306b\u3088\u308b\u8efd\u91cf\u4e26\u884c\u51e6\u7406</li> <li>\u5171\u6709\u72b6\u614b\u306e\u7ba1\u7406</li> </ul>"},{"location":"fsharp/part-4/#_13","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"fsharp/part-4/#1-async","title":"\u554f\u984c 1: Async \u306e\u57fa\u672c","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>let printAndReturn (message: string) : Async&lt;string&gt; = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\n// printAndReturn \"Hello\" |&gt; Async.RunSynchronously \u306f\n// \"Hello\" \u3092\u30b3\u30f3\u30bd\u30fc\u30eb\u306b\u51fa\u529b\u3057\u3001\"Hello\" \u3092\u8fd4\u3059\n</code></pre> \u89e3\u7b54 <pre><code>let printAndReturn (message: string) : Async&lt;string&gt; =\n    async {\n        printfn \"%s\" message\n        return message\n    }\n</code></pre>"},{"location":"fsharp/part-4/#2-async","title":"\u554f\u984c 2: Async \u306e\u5408\u6210","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u30022\u3064\u306e Async \u3092\u9806\u756a\u306b\u5b9f\u884c\u3057\u3001\u7d50\u679c\u3092\u7d50\u5408\u3057\u307e\u3059\u3002</p> <pre><code>let combineAsync (async1: Async&lt;'a&gt;) (async2: Async&lt;'b&gt;) (f: 'a -&gt; 'b -&gt; 'c) : Async&lt;'c&gt; = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nlet result = combineAsync (async { return 1 }) (async { return 2 }) (+)\nAsync.RunSynchronously result  // 3\n</code></pre> \u89e3\u7b54 <pre><code>let combineAsync (async1: Async&lt;'a&gt;) (async2: Async&lt;'b&gt;) (f: 'a -&gt; 'b -&gt; 'c) : Async&lt;'c&gt; =\n    async {\n        let! a = async1\n        let! b = async2\n        return f a b\n    }\n</code></pre>"},{"location":"fsharp/part-4/#3","title":"\u554f\u984c 3: \u30ea\u30c8\u30e9\u30a4","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u6307\u5b9a\u56de\u6570\u30ea\u30c8\u30e9\u30a4\u3057\u3001\u5168\u90e8\u5931\u6557\u3057\u305f\u3089\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>let retryWithDefault (maxRetries: int) (defaultValue: 'a) (action: Async&lt;'a&gt;) : Async&lt;'a&gt; = ???\n</code></pre> \u89e3\u7b54 <pre><code>let retryWithDefault (maxRetries: int) (defaultValue: 'a) (action: Async&lt;'a&gt;) : Async&lt;'a&gt; =\n    let rec loop remaining =\n        async {\n            try\n                return! action\n            with _ -&gt;\n                if remaining &gt; 0 then\n                    return! loop (remaining - 1)\n                else\n                    return defaultValue\n        }\n    loop maxRetries\n</code></pre>"},{"location":"fsharp/part-4/#4","title":"\u554f\u984c 4: \u30b7\u30fc\u30b1\u30f3\u30b9\u64cd\u4f5c","text":"<p>\u4ee5\u4e0b\u306e\u30b7\u30fc\u30b1\u30f3\u30b9\u3092\u4f5c\u6210\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>// 1. 1\u304b\u308910\u307e\u3067\u306e\u5076\u6570\u306e\u30b7\u30fc\u30b1\u30f3\u30b9\nlet evens: int seq = ???\n\n// 2. \u7121\u9650\u306b\u4ea4\u4e92\u306b true/false \u3092\u8fd4\u3059\u30b7\u30fc\u30b1\u30f3\u30b9\nlet alternating: bool seq = ???\n\n// 3. \u6700\u521d\u306e5\u3064\u306e\u8981\u7d20\u306e\u5408\u8a08\u3092\u8a08\u7b97\nlet sum: int = seq { 1; 2; 3; 4; 5; 6; 7; 8; 9; 10 } |&gt; Seq.take 5 |&gt; ???\n</code></pre> \u89e3\u7b54 <pre><code>// 1. 1\u304b\u308910\u307e\u3067\u306e\u5076\u6570\nlet evens: int seq = seq { 1 .. 10 } |&gt; Seq.filter (fun n -&gt; n % 2 = 0)\n// \u307e\u305f\u306f\nlet evens: int seq = seq { 2; 4; 6; 8; 10 }\n\n// 2. \u7121\u9650\u306b\u4ea4\u4e92\u306b true/false\nlet alternating: bool seq =\n    seq {\n        while true do\n            yield true\n            yield false\n    }\n\n// 3. \u6700\u521d\u306e5\u3064\u306e\u8981\u7d20\u306e\u5408\u8a08\nlet sum: int = seq { 1; 2; 3; 4; 5; 6; 7; 8; 9; 10 }\n              |&gt; Seq.take 5\n              |&gt; Seq.sum  // 15\n</code></pre>"},{"location":"fsharp/part-4/#5","title":"\u554f\u984c 5: \u30c8\u30ec\u30f3\u30c9\u691c\u51fa","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u76f4\u8fd13\u3064\u306e\u5024\u304c\u5168\u3066\u540c\u3058\u304b\u3069\u3046\u304b\u3092\u5224\u5b9a\u3057\u307e\u3059\u3002</p> <pre><code>let isStable (values: int list) : bool = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert (isStable [5; 5; 5] = true)\nassert (isStable [5; 5; 6] = false)\nassert (isStable [5; 6; 5] = false)\nassert (isStable [5] = false)  // 3\u3064\u672a\u6e80\u306f false\n</code></pre> \u89e3\u7b54 <pre><code>let isStable (values: int list) : bool =\n    values.Length &gt;= 3 &amp;&amp;\n    values\n    |&gt; List.pairwise\n    |&gt; List.forall (fun (prev, curr) -&gt; prev = curr)\n\n// \u307e\u305f\u306f\nlet isStable (values: int list) : bool =\n    values.Length &gt;= 3 &amp;&amp; values |&gt; List.distinct |&gt; List.length = 1\n</code></pre>"},{"location":"fsharp/part-5/","title":"Part V: \u4e26\u884c\u51e6\u7406","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u4e26\u884c\u51e6\u7406\u3092\u5b66\u3073\u307e\u3059\u3002Ref \u306b\u3088\u308b\u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u5171\u6709\u72b6\u614b\u7ba1\u7406\u3001Async.Parallel \u306b\u3088\u308b\u4e26\u5217\u5b9f\u884c\u3001\u305d\u3057\u3066 MailboxProcessor\uff08Agent\uff09\u306b\u3088\u308b\u8efd\u91cf\u4e26\u884c\u51e6\u7406\u306e\u69cb\u7bc9\u65b9\u6cd5\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"fsharp/part-5/#10","title":"\u7b2c10\u7ae0: \u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406","text":""},{"location":"fsharp/part-5/#101","title":"10.1 \u4e26\u884c\u51e6\u7406\u306e\u8ab2\u984c","text":"<p>\u5f93\u6765\u306e\u4e26\u884c\u51e6\u7406\u306b\u306f\u591a\u304f\u306e\u8ab2\u984c\u304c\u3042\u308a\u307e\u3059:</p> <ul> <li>\u30c7\u30c3\u30c9\u30ed\u30c3\u30af</li> <li>\u7af6\u5408\u72b6\u614b\uff08Race Condition\uff09</li> <li>\u5171\u6709\u72b6\u614b\u306e\u7ba1\u7406\u306e\u8907\u96d1\u3055</li> <li>\u30b9\u30ec\u30c3\u30c9\u306e\u30aa\u30fc\u30d0\u30fc\u30d8\u30c3\u30c9</li> </ul> <p></p>"},{"location":"fsharp/part-5/#102","title":"10.2 \u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u306e\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u96c6\u8a08","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/fsharp/src/Ch10/ConcurrentProcessing.fs</code></p> <p>\u90fd\u5e02\u3078\u306e\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u3092\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u3067\u96c6\u8a08\u3057\u3001\u30e9\u30f3\u30ad\u30f3\u30b0\u3092\u66f4\u65b0\u3059\u308b\u4f8b\u3092\u898b\u3066\u3044\u304d\u307e\u3059\u3002</p> <pre><code>type City = { Name: string }\ntype CityStats = { City: City; CheckIns: int }\n\n// \u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u306e\u30b7\u30fc\u30b1\u30f3\u30b9\nlet checkIns: City seq =\n    seq {\n        for _ in 1..100000 do\n            yield { Name = \"Sydney\" }\n            yield { Name = \"Dublin\" }\n            yield { Name = \"Cape Town\" }\n            yield { Name = \"Lima\" }\n            yield { Name = \"Singapore\" }\n    }\n</code></pre>"},{"location":"fsharp/part-5/#3","title":"\u30c8\u30c3\u30d73\u90fd\u5e02\u306e\u8a08\u7b97\uff08\u7d14\u7c8b\u95a2\u6570\uff09","text":"<pre><code>let topCities (n: int) (cityCheckIns: Map&lt;City, int&gt;) : CityStats list =\n    cityCheckIns\n    |&gt; Map.toList\n    |&gt; List.map (fun (city, checkIns) -&gt; { City = city; CheckIns = checkIns })\n    |&gt; List.sortByDescending (fun stats -&gt; stats.CheckIns)\n    |&gt; List.truncate n\n</code></pre>"},{"location":"fsharp/part-5/#103-ref-","title":"10.3 Ref - \u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u5171\u6709\u72b6\u614b","text":"<p>Ref \u306f\u3001\u8907\u6570\u306e\u4e26\u884c\u51e6\u7406\u304b\u3089\u5b89\u5168\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u53c2\u7167\u3067\u3059\u3002F# \u3067\u306f <code>lock</code> \u3092\u4f7f\u3063\u3066\u5b9f\u88c5\u3057\u307e\u3059\u3002</p> <pre><code>type Ref&lt;'a&gt; private (initialValue: 'a) =\n    let mutable value = initialValue\n    let lockObj = obj()\n\n    /// \u73fe\u5728\u306e\u5024\u3092\u53d6\u5f97\n    member _.Get() : 'a =\n        lock lockObj (fun () -&gt; value)\n\n    /// \u5024\u3092\u8a2d\u5b9a\n    member _.Set(newValue: 'a) : unit =\n        lock lockObj (fun () -&gt; value &lt;- newValue)\n\n    /// \u30a2\u30c8\u30df\u30c3\u30af\u306b\u66f4\u65b0\n    member _.Update(f: 'a -&gt; 'a) : unit =\n        lock lockObj (fun () -&gt; value &lt;- f value)\n\n    /// \u521d\u671f\u5024\u3067 Ref \u3092\u4f5c\u6210\n    static member Of(initialValue: 'a) : Ref&lt;'a&gt; =\n        Ref(initialValue)\n</code></pre> <p></p>"},{"location":"fsharp/part-5/#ref","title":"Ref \u306e\u4e3b\u8981\u30e1\u30bd\u30c3\u30c9","text":"\u30e1\u30bd\u30c3\u30c9 \u8aac\u660e \u4f8b <code>Ref.Of(initial)</code> \u521d\u671f\u5024\u3067 Ref \u3092\u4f5c\u6210 <code>Ref.Of(0)</code> <code>ref.Get()</code> \u73fe\u5728\u306e\u5024\u3092\u53d6\u5f97 <code>counter.Get()</code> <code>ref.Set(value)</code> \u5024\u3092\u8a2d\u5b9a <code>counter.Set(10)</code> <code>ref.Update(f)</code> \u30a2\u30c8\u30df\u30c3\u30af\u306b\u66f4\u65b0 <code>counter.Update((+) 1)</code> <code>ref.GetAndUpdate(f)</code> \u66f4\u65b0\u3057\u3066\u53e4\u3044\u5024\u3092\u8fd4\u3059 <code>counter.GetAndUpdate((+) 1)</code> <code>ref.UpdateAndGet(f)</code> \u66f4\u65b0\u3057\u3066\u65b0\u3057\u3044\u5024\u3092\u8fd4\u3059 <code>counter.UpdateAndGet((+) 1)</code> <code>ref.Modify(f)</code> \u66f4\u65b0\u3057\u3066\u7d50\u679c\u3092\u8fd4\u3059 <code>counter.Modify(fun n -&gt; (n + 1, n * 2))</code>"},{"location":"fsharp/part-5/#_1","title":"\u4f7f\u7528\u4f8b","text":"<pre><code>let example () =\n    let counter = Ref.Of(0)\n    counter.Update((+) 3)  // \u30a2\u30c8\u30df\u30c3\u30af\u306b\u66f4\u65b0\n    counter.Get()           // 3\n</code></pre>"},{"location":"fsharp/part-5/#104-parsequence-","title":"10.4 parSequence - \u4e26\u5217\u5b9f\u884c","text":"<p>F# \u3067\u306f <code>Async.Parallel</code> \u3092\u4f7f\u3063\u3066\u8907\u6570\u306e Async \u3092\u4e26\u5217\u5b9f\u884c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>/// Async \u306e\u30ea\u30b9\u30c8\u3092\u4e26\u5217\u5b9f\u884c\nlet parSequence (asyncList: Async&lt;'a&gt; list) : Async&lt;'a list&gt; =\n    async {\n        let! results = Async.Parallel asyncList\n        return results |&gt; Array.toList\n    }\n\n// \u4f7f\u7528\u4f8b\nlet parallel =\n    [ async { return 1 }\n      async { return 2 }\n      async { return 3 } ]\n    |&gt; parSequence\n\nparallel |&gt; Async.RunSynchronously  // [1; 2; 3]\n</code></pre> <p></p>"},{"location":"fsharp/part-5/#async","title":"\u8907\u6570\u306e Async \u3092\u4e26\u5217\u5b9f\u884c","text":"<pre><code>/// 2\u3064\u306e Async \u3092\u4e26\u5217\u5b9f\u884c\nlet parTuple2 (async1: Async&lt;'a&gt;) (async2: Async&lt;'b&gt;) : Async&lt;'a * 'b&gt; =\n    async {\n        let! results = Async.Parallel [\n            async { let! a = async1 in return box a }\n            async { let! b = async2 in return box b }\n        ]\n        return (unbox results.[0], unbox results.[1])\n    }\n\n/// 3\u3064\u306e Async \u3092\u4e26\u5217\u5b9f\u884c\nlet parTuple3 (async1: Async&lt;'a&gt;) (async2: Async&lt;'b&gt;) (async3: Async&lt;'c&gt;) : Async&lt;'a * 'b * 'c&gt; =\n    async {\n        let! results = Async.Parallel [\n            async { let! a = async1 in return box a }\n            async { let! b = async2 in return box b }\n            async { let! c = async3 in return box c }\n        ]\n        return (unbox results.[0], unbox results.[1], unbox results.[2])\n    }\n</code></pre>"},{"location":"fsharp/part-5/#105","title":"10.5 \u30b5\u30a4\u30b3\u30ed\u3092\u4e26\u884c\u3057\u3066\u632f\u308b","text":"<pre><code>let private random = Random()\n\nlet castTheDie () : Async&lt;int&gt; =\n    async { return random.Next(1, 7) }\n\n/// N \u500b\u306e\u30b5\u30a4\u30b3\u30ed\u3092\u4e26\u884c\u3057\u3066\u632f\u308b\nlet castDiceConcurrently (n: int) : Async&lt;int list&gt; =\n    [ for _ in 1..n -&gt; castTheDie () ]\n    |&gt; parSequence\n\n/// N \u500b\u306e\u30b5\u30a4\u30b3\u30ed\u3092\u4e26\u884c\u3057\u3066\u632f\u308a\u3001\u5408\u8a08\u3092\u8fd4\u3059\nlet castDiceAndSum (n: int) : Async&lt;int&gt; =\n    async {\n        let! results = castDiceConcurrently n\n        return List.sum results\n    }\n</code></pre>"},{"location":"fsharp/part-5/#106-fiber-","title":"10.6 Fiber - \u30ad\u30e3\u30f3\u30bb\u30eb\u53ef\u80fd\u306a\u975e\u540c\u671f\u30bf\u30b9\u30af","text":"<p>Fiber \u306f\u3001\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u5b9f\u884c\u3055\u308c\u308b\u30ad\u30e3\u30f3\u30bb\u30eb\u53ef\u80fd\u306a\u975e\u540c\u671f\u30bf\u30b9\u30af\u3067\u3059\u3002</p> <pre><code>type Fiber&lt;'a&gt; = {\n    /// \u30bf\u30b9\u30af\u306e\u7d50\u679c\u3092\u5f85\u6a5f\n    Join: Async&lt;'a&gt;\n    /// \u30bf\u30b9\u30af\u3092\u30ad\u30e3\u30f3\u30bb\u30eb\n    Cancel: unit -&gt; unit\n}\n\n/// Async \u3092 Fiber \u3068\u3057\u3066\u8d77\u52d5\uff08\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u5b9f\u884c\uff09\nlet start (computation: Async&lt;'a&gt;) : Fiber&lt;'a&gt; =\n    let cts = new CancellationTokenSource()\n    let tcs = new TaskCompletionSource&lt;'a&gt;()\n\n    Async.Start(\n        async {\n            try\n                let! result = computation\n                tcs.SetResult(result)\n            with\n            | :? OperationCanceledException -&gt;\n                tcs.SetCanceled()\n            | ex -&gt;\n                tcs.SetException(ex)\n        },\n        cts.Token)\n\n    {\n        Join = Async.AwaitTask tcs.Task\n        Cancel = fun () -&gt; cts.Cancel()\n    }\n</code></pre> <p></p>"},{"location":"fsharp/part-5/#foreverm-","title":"foreverM - \u6c38\u9060\u306b\u7e70\u308a\u8fd4\u3059","text":"<pre><code>/// \u6c38\u9060\u306b\u7e70\u308a\u8fd4\u3059\nlet foreverM (action: Async&lt;unit&gt;) : Async&lt;unit&gt; =\n    let rec loop () =\n        async {\n            do! action\n            return! loop ()\n        }\n    loop ()\n</code></pre>"},{"location":"fsharp/part-5/#107","title":"10.7 \u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u51e6\u7406\u306e\u4e26\u884c\u7248","text":"<p>\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u306e\u4fdd\u5b58\u3068\u30e9\u30f3\u30ad\u30f3\u30b0\u306e\u66f4\u65b0\u3092\u4e26\u884c\u3057\u3066\u5b9f\u884c\u3057\u307e\u3059\u3002</p>"},{"location":"fsharp/part-5/#_2","title":"\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u306e\u4fdd\u5b58","text":"<pre><code>let storeCheckIn (storedCheckIns: Ref&lt;Map&lt;City, int&gt;&gt;) (city: City) : unit =\n    storedCheckIns.Update(fun map -&gt;\n        match Map.tryFind city map with\n        | Some count -&gt; Map.add city (count + 1) map\n        | None -&gt; Map.add city 1 map)\n</code></pre>"},{"location":"fsharp/part-5/#_3","title":"\u30e9\u30f3\u30ad\u30f3\u30b0\u306e\u7d99\u7d9a\u7684\u306a\u66f4\u65b0","text":"<pre><code>let updateRanking\n    (storedCheckIns: Ref&lt;Map&lt;City, int&gt;&gt;)\n    (storedRanking: Ref&lt;CityStats list&gt;)\n    : Async&lt;unit&gt; =\n    async {\n        let checkIns = storedCheckIns.Get()\n        let ranking = topCities 3 checkIns\n        storedRanking.Set(ranking)\n    }\n\n/// \u30e9\u30f3\u30ad\u30f3\u30b0\u3092\u7d99\u7d9a\u7684\u306b\u66f4\u65b0\nlet updateRankingForever\n    (storedCheckIns: Ref&lt;Map&lt;City, int&gt;&gt;)\n    (storedRanking: Ref&lt;CityStats list&gt;)\n    : Async&lt;unit&gt; =\n    foreverM (updateRanking storedCheckIns storedRanking)\n</code></pre>"},{"location":"fsharp/part-5/#108","title":"10.8 \u547c\u3073\u51fa\u3057\u5143\u306b\u5236\u5fa1\u3092\u8fd4\u3059","text":"<p>\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u51e6\u7406\u3092\u7d9a\u3051\u3064\u3064\u3001\u547c\u3073\u51fa\u3057\u5143\u306b\u5236\u5fa1\u3092\u8fd4\u3059\u8a2d\u8a08\u304c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>type ProcessingCheckIns = {\n    /// \u73fe\u5728\u306e\u30e9\u30f3\u30ad\u30f3\u30b0\u3092\u53d6\u5f97\n    CurrentRanking: unit -&gt; CityStats list\n    /// \u51e6\u7406\u3092\u505c\u6b62\n    Stop: unit -&gt; unit\n}\n\nlet startCheckInProcessing (checkIns: City seq) : ProcessingCheckIns =\n    let storedCheckIns = Ref.Of(Map.empty&lt;City, int&gt;)\n    let storedRanking = Ref.Of([] : CityStats list)\n    let cts = new CancellationTokenSource()\n\n    // \u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u51e6\u7406\u3092\u958b\u59cb\n    Async.Start(\n        async {\n            for city in checkIns do\n                storeCheckIn storedCheckIns city\n        },\n        cts.Token)\n\n    // \u30e9\u30f3\u30ad\u30f3\u30b0\u66f4\u65b0\u3092\u958b\u59cb\n    Async.Start(\n        async {\n            while not cts.Token.IsCancellationRequested do\n                do! updateRanking storedCheckIns storedRanking\n                do! Async.Sleep 10\n        },\n        cts.Token)\n\n    {\n        CurrentRanking = fun () -&gt; storedRanking.Get()\n        Stop = fun () -&gt; cts.Cancel()\n    }\n</code></pre>"},{"location":"fsharp/part-5/#_4","title":"\u4f7f\u7528\u4f8b","text":"<pre><code>let example () =\n    let cities = [\n        { Name = \"Tokyo\" }\n        { Name = \"Sydney\" }\n        { Name = \"Tokyo\" }\n        { Name = \"London\" }\n        { Name = \"Tokyo\" }\n    ]\n\n    let processing = startCheckInProcessing cities\n\n    // \u5c11\u3057\u5f85\u3063\u3066\u304b\u3089\u30e9\u30f3\u30ad\u30f3\u30b0\u3092\u53d6\u5f97\n    System.Threading.Thread.Sleep(100)\n    let ranking = processing.CurrentRanking()\n    printfn \"%A\" ranking\n\n    // \u51e6\u7406\u3092\u505c\u6b62\n    processing.Stop()\n</code></pre>"},{"location":"fsharp/part-5/#109-mailboxprocessoragent","title":"10.9 MailboxProcessor\uff08Agent\uff09\u306b\u3088\u308b\u4e26\u884c\u51e6\u7406","text":"<p>F# \u3067\u306f\u3001MailboxProcessor\uff08\u5225\u540d Agent\uff09\u3092\u4f7f\u3063\u305f\u30e1\u30c3\u30bb\u30fc\u30b8\u30d1\u30c3\u30b7\u30f3\u30b0\u65b9\u5f0f\u306e\u4e26\u884c\u51e6\u7406\u304c\u4e00\u822c\u7684\u3067\u3059\u3002</p> <p></p>"},{"location":"fsharp/part-5/#_5","title":"\u30ab\u30a6\u30f3\u30bf\u30fc\u30a8\u30fc\u30b8\u30a7\u30f3\u30c8","text":"<pre><code>type CounterMessage =\n    | Increment\n    | Decrement\n    | GetValue of AsyncReplyChannel&lt;int&gt;\n    | Reset\n\nlet createCounter (initialValue: int) : MailboxProcessor&lt;CounterMessage&gt; =\n    MailboxProcessor.Start(fun inbox -&gt;\n        let rec loop count =\n            async {\n                let! msg = inbox.Receive()\n                match msg with\n                | Increment -&gt;\n                    return! loop (count + 1)\n                | Decrement -&gt;\n                    return! loop (count - 1)\n                | GetValue replyChannel -&gt;\n                    replyChannel.Reply(count)\n                    return! loop count\n                | Reset -&gt;\n                    return! loop initialValue\n            }\n        loop initialValue)\n</code></pre>"},{"location":"fsharp/part-5/#_6","title":"\u30ab\u30a6\u30f3\u30bf\u30fc\u306e\u4f7f\u7528","text":"<pre><code>let counter = createCounter 0\n\n// \u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\uff08Fire-and-forget\uff09\ncounter.Post(Increment)\ncounter.Post(Increment)\n\n// \u5024\u3092\u53d6\u5f97\uff08\u540c\u671f\uff09\nlet value = counter.PostAndReply(GetValue)  // 2\n\n// \u30c7\u30af\u30ea\u30e1\u30f3\u30c8\ncounter.Post(Decrement)\nlet newValue = counter.PostAndReply(GetValue)  // 1\n</code></pre>"},{"location":"fsharp/part-5/#_7","title":"\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u30a8\u30fc\u30b8\u30a7\u30f3\u30c8","text":"<pre><code>type CheckInMessage =\n    | AddCheckIn of City\n    | GetStats of AsyncReplyChannel&lt;CityStats list&gt;\n    | GetTotal of AsyncReplyChannel&lt;int&gt;\n\nlet createCheckInAgent () : MailboxProcessor&lt;CheckInMessage&gt; =\n    MailboxProcessor.Start(fun inbox -&gt;\n        let rec loop (checkIns: Map&lt;City, int&gt;) =\n            async {\n                let! msg = inbox.Receive()\n                match msg with\n                | AddCheckIn city -&gt;\n                    let newCheckIns =\n                        match Map.tryFind city checkIns with\n                        | Some count -&gt; Map.add city (count + 1) checkIns\n                        | None -&gt; Map.add city 1 checkIns\n                    return! loop newCheckIns\n                | GetStats replyChannel -&gt;\n                    let stats = topCities 3 checkIns\n                    replyChannel.Reply(stats)\n                    return! loop checkIns\n                | GetTotal replyChannel -&gt;\n                    let total = checkIns |&gt; Map.toList |&gt; List.sumBy snd\n                    replyChannel.Reply(total)\n                    return! loop checkIns\n            }\n        loop Map.empty)\n</code></pre>"},{"location":"fsharp/part-5/#1010","title":"10.10 \u4e26\u5217\u51e6\u7406\u30e6\u30fc\u30c6\u30a3\u30ea\u30c6\u30a3","text":"<pre><code>/// \u30ea\u30b9\u30c8\u306e\u5404\u8981\u7d20\u306b\u95a2\u6570\u3092\u4e26\u5217\u9069\u7528\nlet parMap (f: 'a -&gt; 'b) (list: 'a list) : 'b list =\n    list\n    |&gt; List.map (fun x -&gt; async { return f x })\n    |&gt; parSequence\n    |&gt; Async.RunSynchronously\n\n/// \u6761\u4ef6\u3092\u6e80\u305f\u3059\u8981\u7d20\u3092\u4e26\u5217\u3067\u30d5\u30a3\u30eb\u30bf\nlet parFilter (predicate: 'a -&gt; bool) (list: 'a list) : 'a list =\n    list\n    |&gt; List.map (fun x -&gt; async { return (x, predicate x) })\n    |&gt; parSequence\n    |&gt; Async.RunSynchronously\n    |&gt; List.filter snd\n    |&gt; List.map fst\n\n/// \u4e26\u5217\u3067\u96c6\u7d04\nlet parReduce (combine: 'a -&gt; 'a -&gt; 'a) (list: 'a list) : 'a option =\n    match list with\n    | [] -&gt; None\n    | [x] -&gt; Some x\n    | _ -&gt;\n        let rec reduceLevel (items: 'a list) =\n            match items with\n            | [] -&gt; failwith \"Unexpected empty list\"\n            | [x] -&gt; x\n            | _ -&gt;\n                items\n                |&gt; List.chunkBySize 2\n                |&gt; List.map (fun chunk -&gt;\n                    match chunk with\n                    | [a; b] -&gt; async { return combine a b }\n                    | [a] -&gt; async { return a }\n                    | _ -&gt; failwith \"Unexpected chunk size\")\n                |&gt; parSequence\n                |&gt; Async.RunSynchronously\n                |&gt; reduceLevel\n        Some (reduceLevel list)\n</code></pre>"},{"location":"fsharp/part-5/#1011","title":"10.11 \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u4ed8\u304d\u5b9f\u884c","text":"<pre><code>/// \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u4ed8\u304d\u3067 Async \u3092\u5b9f\u884c\nlet withTimeout (timeoutMs: int) (computation: Async&lt;'a&gt;) : Async&lt;'a option&gt; =\n    async {\n        let! child = Async.StartChild(computation, timeoutMs)\n        try\n            let! result = child\n            return Some result\n        with :? TimeoutException -&gt;\n            return None\n    }\n</code></pre>"},{"location":"fsharp/part-5/#1012","title":"10.12 \u5076\u6570\u30ab\u30a6\u30f3\u30c8\uff08\u4e26\u884c\u7248\uff09","text":"<pre><code>/// \u4e26\u884c\u3057\u3066\u5b9f\u884c\u3057\u3001\u5076\u6570\u306e\u6570\u3092\u30ab\u30a6\u30f3\u30c8\nlet countEvens (asyncInts: Async&lt;int&gt; list) : Async&lt;int&gt; =\n    async {\n        let counter = Ref.Of(0)\n        let tasks =\n            asyncInts\n            |&gt; List.map (fun asyncInt -&gt;\n                async {\n                    let! n = asyncInt\n                    if n % 2 = 0 then\n                        counter.Update((+) 1)\n                })\n        do! parSequence tasks |&gt; Async.Ignore\n        return counter.Get()\n    }\n</code></pre>"},{"location":"fsharp/part-5/#scala","title":"Scala \u3068\u306e\u6bd4\u8f03","text":""},{"location":"fsharp/part-5/#ref_1","title":"Ref \u306e\u6bd4\u8f03","text":"Scala (Cats Effect) F# \u8aac\u660e <code>Ref.of[IO, A](initial)</code> <code>Ref.Of(initial)</code> \u521d\u671f\u5024\u3067 Ref \u3092\u4f5c\u6210 <code>ref.get</code> <code>ref.Get()</code> \u73fe\u5728\u306e\u5024\u3092\u53d6\u5f97 <code>ref.set(value)</code> <code>ref.Set(value)</code> \u5024\u3092\u8a2d\u5b9a <code>ref.update(f)</code> <code>ref.Update(f)</code> \u30a2\u30c8\u30df\u30c3\u30af\u306b\u66f4\u65b0 <code>ref.modify(f)</code> <code>ref.Modify(f)</code> \u66f4\u65b0\u3057\u3066\u7d50\u679c\u3092\u8fd4\u3059"},{"location":"fsharp/part-5/#_8","title":"\u4e26\u5217\u5b9f\u884c\u306e\u6bd4\u8f03","text":"Scala (Cats Effect) F# \u8aac\u660e <code>ios.parSequence</code> <code>parSequence ios</code> \u4e26\u5217\u5b9f\u884c <code>ios.sequence</code> <code>sequence ios</code> \u9806\u6b21\u5b9f\u884c <code>(io1, io2).parTupled</code> <code>parTuple2 io1 io2</code> 2\u3064\u3092\u4e26\u5217\u5b9f\u884c"},{"location":"fsharp/part-5/#fiber","title":"Fiber \u306e\u6bd4\u8f03","text":"Scala (Cats Effect) F# \u8aac\u660e <code>io.start</code> <code>start computation</code> Fiber \u3092\u8d77\u52d5 <code>fiber.join</code> <code>fiber.Join</code> \u7d50\u679c\u3092\u5f85\u6a5f <code>fiber.cancel</code> <code>fiber.Cancel()</code> \u30ad\u30e3\u30f3\u30bb\u30eb <code>io.foreverM</code> <code>foreverM io</code> \u6c38\u9060\u306b\u7e70\u308a\u8fd4\u3059"},{"location":"fsharp/part-5/#agentactor","title":"Agent\uff08Actor\uff09\u306e\u6bd4\u8f03","text":"Scala (Akka) F# \u8aac\u660e <code>Actor</code> <code>MailboxProcessor</code> \u30e1\u30c3\u30bb\u30fc\u30b8\u30d9\u30fc\u30b9\u306e\u4e26\u884c\u51e6\u7406 <code>actorRef ! message</code> <code>agent.Post(message)</code> \u30e1\u30c3\u30bb\u30fc\u30b8\u9001\u4fe1\uff08\u975e\u540c\u671f\uff09 <code>actorRef ? message</code> <code>agent.PostAndReply(f)</code> \u30e1\u30c3\u30bb\u30fc\u30b8\u9001\u4fe1\uff08\u540c\u671f\uff09"},{"location":"fsharp/part-5/#_9","title":"\u307e\u3068\u3081","text":""},{"location":"fsharp/part-5/#part-v_1","title":"Part V \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"fsharp/part-5/#_10","title":"\u4e3b\u8981\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8","text":"\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8 \u7528\u9014 <code>Ref&lt;'a&gt;</code> \u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u5171\u6709\u72b6\u614b <code>parSequence</code> Async \u306e\u30ea\u30b9\u30c8\u3092\u4e26\u5217\u5b9f\u884c <code>Fiber</code> \u30ad\u30e3\u30f3\u30bb\u30eb\u53ef\u80fd\u306a\u975e\u540c\u671f\u30bf\u30b9\u30af <code>start</code> Fiber \u3092\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u8d77\u52d5 <code>foreverM</code> \u6c38\u9060\u306b\u7e70\u308a\u8fd4\u3057\u5b9f\u884c <code>MailboxProcessor</code> \u30e1\u30c3\u30bb\u30fc\u30b8\u30d9\u30fc\u30b9\u306e\u4e26\u884c\u51e6\u7406"},{"location":"fsharp/part-5/#_11","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>Ref: \u8907\u6570\u306e\u4e26\u884c\u51e6\u7406\u304b\u3089\u5b89\u5168\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u53c2\u7167</li> <li>parSequence: Async \u306e\u30ea\u30b9\u30c8\u3092\u4e26\u5217\u5b9f\u884c\u3057\u3066\u7d50\u679c\u3092\u96c6\u7d04</li> <li>Fiber: \u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u5b9f\u884c\u3055\u308c\u308b\u30ad\u30e3\u30f3\u30bb\u30eb\u53ef\u80fd\u306a\u30bf\u30b9\u30af</li> <li>MailboxProcessor: F# \u30cd\u30a4\u30c6\u30a3\u30d6\u306e Actor \u30e2\u30c7\u30eb\u5b9f\u88c5</li> <li>Async.Parallel: \u7d44\u307f\u8fbc\u307f\u306e\u4e26\u5217\u5b9f\u884c\u6a5f\u80fd</li> </ol>"},{"location":"fsharp/part-5/#_12","title":"\u8a2d\u8a08\u30d1\u30bf\u30fc\u30f3","text":""},{"location":"fsharp/part-5/#_13","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"fsharp/part-5/#1-ref","title":"\u554f\u984c 1: Ref \u306e\u57fa\u672c","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u30ab\u30a6\u30f3\u30bf\u30fc\u3092 0 \u304b\u3089\u59cb\u3081\u3066\u30013\u56de\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\u3057\u305f\u7d50\u679c\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>let incrementThreeTimes () : int = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nincrementThreeTimes ()  // 3\n</code></pre> \u89e3\u7b54 <pre><code>let incrementThreeTimes () : int =\n    let counter = Ref.Of(0)\n    counter.Update((+) 1)\n    counter.Update((+) 1)\n    counter.Update((+) 1)\n    counter.Get()\n</code></pre>"},{"location":"fsharp/part-5/#2","title":"\u554f\u984c 2: \u4e26\u5217\u5b9f\u884c","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u30023\u3064\u306e Async \u3092\u4e26\u5217\u5b9f\u884c\u3057\u3001\u7d50\u679c\u306e\u5408\u8a08\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>let sumParallel (async1: Async&lt;int&gt;) (async2: Async&lt;int&gt;) (async3: Async&lt;int&gt;) : Async&lt;int&gt; = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nsumParallel (async { return 1 }) (async { return 2 }) (async { return 3 })\n|&gt; Async.RunSynchronously  // 6\n</code></pre> \u89e3\u7b54 <pre><code>let sumParallel (async1: Async&lt;int&gt;) (async2: Async&lt;int&gt;) (async3: Async&lt;int&gt;) : Async&lt;int&gt; =\n    async {\n        let! results = [ async1; async2; async3 ] |&gt; parSequence\n        return List.sum results\n    }\n</code></pre>"},{"location":"fsharp/part-5/#3_1","title":"\u554f\u984c 3: \u4e26\u884c\u30ab\u30a6\u30f3\u30c8","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002Async \u306e\u30ea\u30b9\u30c8\u3092\u4e26\u884c\u5b9f\u884c\u3057\u3001\u305d\u306e\u3046\u3061\u5076\u6570\u3092\u8fd4\u3057\u305f\u56de\u6570\u3092\u30ab\u30a6\u30f3\u30c8\u3057\u307e\u3059\u3002</p> <pre><code>let countEvensInList (asyncInts: Async&lt;int&gt; list) : Async&lt;int&gt; = ???\n\n// \u4f7f\u7528\u4f8b\nlet asyncInts = [\n    async { return 2 }\n    async { return 3 }\n    async { return 4 }\n    async { return 5 }\n    async { return 6 }\n]\ncountEvensInList asyncInts |&gt; Async.RunSynchronously  // 3\n</code></pre> \u89e3\u7b54 <pre><code>let countEvensInList (asyncInts: Async&lt;int&gt; list) : Async&lt;int&gt; =\n    async {\n        let counter = Ref.Of(0)\n        let tasks =\n            asyncInts\n            |&gt; List.map (fun asyncInt -&gt;\n                async {\n                    let! n = asyncInt\n                    if n % 2 = 0 then\n                        counter.Update((+) 1)\n                })\n        do! parSequence tasks |&gt; Async.Ignore\n        return counter.Get()\n    }\n</code></pre>"},{"location":"fsharp/part-5/#4-mailboxprocessor","title":"\u554f\u984c 4: MailboxProcessor","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u53d7\u3051\u53d6\u3063\u3066\u30ea\u30b9\u30c8\u306b\u8ffd\u52a0\u3057\u3001\u30ea\u30b9\u30c8\u3092\u53d6\u5f97\u3067\u304d\u308b Agent \u3092\u4f5c\u6210\u3057\u307e\u3059\u3002</p> <pre><code>type ListMessage&lt;'a&gt; =\n    | Add of 'a\n    | GetAll of AsyncReplyChannel&lt;'a list&gt;\n\nlet createListAgent&lt;'a&gt; () : MailboxProcessor&lt;ListMessage&lt;'a&gt;&gt; = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nlet agent = createListAgent&lt;int&gt; ()\nagent.Post(Add 1)\nagent.Post(Add 2)\nagent.Post(Add 3)\nagent.PostAndReply(GetAll)  // [1; 2; 3] \u307e\u305f\u306f [3; 2; 1]\n</code></pre> \u89e3\u7b54 <pre><code>type ListMessage&lt;'a&gt; =\n    | Add of 'a\n    | GetAll of AsyncReplyChannel&lt;'a list&gt;\n\nlet createListAgent&lt;'a&gt; () : MailboxProcessor&lt;ListMessage&lt;'a&gt;&gt; =\n    MailboxProcessor.Start(fun inbox -&gt;\n        let rec loop (items: 'a list) =\n            async {\n                let! msg = inbox.Receive()\n                match msg with\n                | Add item -&gt;\n                    return! loop (item :: items)\n                | GetAll replyChannel -&gt;\n                    replyChannel.Reply(List.rev items)\n                    return! loop items\n            }\n        loop [])\n</code></pre>"},{"location":"fsharp/part-5/#5","title":"\u554f\u984c 5: \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u4ed8\u304d\u53ce\u96c6","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u6307\u5b9a\u6642\u9593\u5f8c\u306b\u51e6\u7406\u3092\u505c\u6b62\u3057\u3001\u305d\u308c\u307e\u3067\u306b\u84c4\u7a4d\u3055\u308c\u305f\u7d50\u679c\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>let collectFor (durationMs: int) (producer: unit -&gt; int) : int list = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\n// 100ms\u3054\u3068\u306b\u4e71\u6570\u3092\u751f\u6210\u3057\u3066\u30011\u79d2\u9593\u53ce\u96c6\n// \u7d0410\u500b\u306e\u8981\u7d20\u304c\u8fd4\u3055\u308c\u308b\ncollectFor 1000 (fun () -&gt; random.Next(100))\n</code></pre> \u89e3\u7b54 <pre><code>let collectFor (durationMs: int) (producer: unit -&gt; int) : int list =\n    let collected = Ref.Of([] : int list)\n    let cts = new CancellationTokenSource()\n\n    // 100ms\u3054\u3068\u306b\u5024\u3092\u8ffd\u52a0\u3059\u308b\u30d7\u30ed\u30b0\u30e9\u30e0\n    Async.Start(\n        async {\n            while true do\n                do! Async.Sleep 100\n                let value = producer ()\n                collected.Update(fun list -&gt; value :: list)\n        },\n        cts.Token)\n\n    // \u6307\u5b9a\u6642\u9593\u5f85\u6a5f\n    Thread.Sleep(durationMs)\n\n    // \u30ad\u30e3\u30f3\u30bb\u30eb\n    cts.Cancel()\n\n    // \u7d50\u679c\u3092\u53d6\u5f97\uff08\u9006\u9806\u306b\u3057\u3066\u8fd4\u3059\uff09\n    collected.Get() |&gt; List.rev\n</code></pre>"},{"location":"fsharp/part-6/","title":"Part VI: \u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u3068\u30c6\u30b9\u30c8","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u3053\u308c\u307e\u3067\u5b66\u3093\u3060\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u6982\u5ff5\u3092\u7d71\u5408\u3057\u3001\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002\u307e\u305f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u30c6\u30b9\u30c8\u6226\u7565\u306b\u3064\u3044\u3066\u3082\u5b66\u3073\u307e\u3059\u3002</p>"},{"location":"fsharp/part-6/#11","title":"\u7b2c11\u7ae0: \u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9","text":""},{"location":"fsharp/part-6/#111-travelguide","title":"11.1 TravelGuide \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3","text":"<p>\u65c5\u884c\u30ac\u30a4\u30c9\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f8b\u306b\u3001\u5b9f\u8df5\u7684\u306a FP \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u69cb\u7bc9\u65b9\u6cd5\u3092\u5b66\u3073\u307e\u3059\u3002</p> <p></p>"},{"location":"fsharp/part-6/#112","title":"11.2 \u30c9\u30e1\u30a4\u30f3\u30e2\u30c7\u30eb\u306e\u5b9a\u7fa9","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/fsharp/src/Ch11/TravelGuide.fs</code></p> <pre><code>/// \u30ed\u30b1\u30fc\u30b7\u30e7\u30f3 ID\uff08\u5024\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\uff09\ntype LocationId = LocationId of string\n\nmodule LocationId =\n    let value (LocationId id) = id\n    let create id = LocationId id\n\n/// \u30ed\u30b1\u30fc\u30b7\u30e7\u30f3\ntype Location = {\n    Id: LocationId\n    Name: string\n    Population: int\n}\n\n/// \u30a2\u30c8\u30e9\u30af\u30b7\u30e7\u30f3\uff08\u89b3\u5149\u5730\uff09\ntype Attraction = {\n    Name: string\n    Description: string option\n    Location: Location\n}\n\n/// \u30df\u30e5\u30fc\u30b8\u30c3\u30af\u30a2\u30fc\u30c6\u30a3\u30b9\u30c8\ntype MusicArtist = {\n    Name: string\n    Genre: string option\n}\n\n/// \u6620\u753b\ntype Movie = {\n    Name: string\n    BoxOffice: int option\n}\n\n/// \u65c5\u884c\u30ac\u30a4\u30c9\ntype TravelGuide = {\n    Attraction: Attraction\n    Subjects: string list\n}\n</code></pre>"},{"location":"fsharp/part-6/#113","title":"11.3 \u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\u5c64\u306e\u62bd\u8c61\u5316","text":"<p>\u5916\u90e8\u30c7\u30fc\u30bf\u30bd\u30fc\u30b9\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3067\u62bd\u8c61\u5316\u3057\u307e\u3059\u3002</p> <pre><code>/// \u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\ntype IDataAccess =\n    abstract member FindAttractions:\n        name: string * ordering: AttractionOrdering * limit: int\n        -&gt; Async&lt;Attraction list&gt;\n    abstract member FindArtistsFromLocation:\n        locationId: LocationId * limit: int\n        -&gt; Async&lt;MusicArtist list&gt;\n    abstract member FindMoviesAboutLocation:\n        locationId: LocationId * limit: int\n        -&gt; Async&lt;Movie list&gt;\n</code></pre> <p></p>"},{"location":"fsharp/part-6/#114-resource","title":"11.4 Resource \u306b\u3088\u308b\u30ea\u30bd\u30fc\u30b9\u7ba1\u7406","text":"<p>F# \u3067\u306f <code>IDisposable</code> \u30d1\u30bf\u30fc\u30f3\u3068 <code>use</code> \u30ad\u30fc\u30ef\u30fc\u30c9\u3067\u30ea\u30bd\u30fc\u30b9\u3092\u7ba1\u7406\u3067\u304d\u307e\u3059\u304c\u3001\u3088\u308a\u95a2\u6570\u578b\u7684\u306a <code>Resource</code> \u578b\u3092\u5b9f\u88c5\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002</p> <pre><code>/// \u30ea\u30bd\u30fc\u30b9\u3092\u5b89\u5168\u306b\u7ba1\u7406\u3059\u308b\u305f\u3081\u306e\u578b\ntype Resource&lt;'a&gt; = {\n    Acquire: unit -&gt; Async&lt;'a&gt;\n    Release: 'a -&gt; Async&lt;unit&gt;\n}\n\nmodule Resource =\n    /// \u30ea\u30bd\u30fc\u30b9\u3092\u4f5c\u6210\n    let make (acquire: unit -&gt; Async&lt;'a&gt;) (release: 'a -&gt; Async&lt;unit&gt;) : Resource&lt;'a&gt; =\n        { Acquire = acquire; Release = release }\n\n    /// \u30ea\u30bd\u30fc\u30b9\u3092\u4f7f\u7528\u3057\u3066\u64cd\u4f5c\u3092\u5b9f\u884c\n    let useAsync (f: 'a -&gt; Async&lt;'b&gt;) (resource: Resource&lt;'a&gt;) : Async&lt;'b&gt; =\n        async {\n            let! r = resource.Acquire()\n            try\n                return! f r\n            finally\n                resource.Release r |&gt; Async.RunSynchronously\n        }\n</code></pre> <p></p>"},{"location":"fsharp/part-6/#115","title":"11.5 \u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u5b9f\u88c5","text":"<p><code>Ref</code> \u3092\u4f7f\u7528\u3057\u305f\u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u5b9f\u88c5:</p> <pre><code>/// \u30ad\u30e3\u30c3\u30b7\u30e5\u4ed8\u304d\u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\nlet cachedDataAccess (dataAccess: IDataAccess) : Async&lt;IDataAccess&gt; =\n    async {\n        let attractionCache = Ref.Of(Map.empty&lt;string, Attraction list&gt;)\n        let artistCache = Ref.Of(Map.empty&lt;string, MusicArtist list&gt;)\n        let movieCache = Ref.Of(Map.empty&lt;string, Movie list&gt;)\n\n        return\n            { new IDataAccess with\n                member _.FindAttractions(name, ordering, limit) =\n                    async {\n                        let key = sprintf \"%s-%A-%d\" name ordering limit\n                        let cached = attractionCache.Get() |&gt; Map.tryFind key\n                        match cached with\n                        | Some attractions -&gt; return attractions\n                        | None -&gt;\n                            let! attractions = dataAccess.FindAttractions(name, ordering, limit)\n                            attractionCache.Update(Map.add key attractions)\n                            return attractions\n                    }\n                // \u4ed6\u306e\u30e1\u30bd\u30c3\u30c9\u3082\u540c\u69d8\u306b\u5b9f\u88c5...\n            }\n    }\n</code></pre> <p></p>"},{"location":"fsharp/part-6/#116","title":"11.6 \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u7d44\u307f\u7acb\u3066","text":"<p>\u3059\u3079\u3066\u306e\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002</p> <pre><code>/// \u65c5\u884c\u30ac\u30a4\u30c9\u3092\u751f\u6210\nlet travelGuide (data: IDataAccess) (attractionName: string) : Async&lt;TravelGuide option&gt; =\n    async {\n        let! attractions = data.FindAttractions(attractionName, ByLocationPopulation, 1)\n        match attractions with\n        | [] -&gt; return None\n        | attraction :: _ -&gt;\n            let! artists = data.FindArtistsFromLocation(attraction.Location.Id, 2)\n            let! movies = data.FindMoviesAboutLocation(attraction.Location.Id, 2)\n            let subjects =\n                (artists |&gt; List.map (fun a -&gt; a.Name))\n                @ (movies |&gt; List.map (fun m -&gt; m.Name))\n            return Some {\n                Attraction = attraction\n                Subjects = subjects\n            }\n    }\n</code></pre> <p></p>"},{"location":"fsharp/part-6/#12","title":"\u7b2c12\u7ae0: \u30c6\u30b9\u30c8\u6226\u7565","text":""},{"location":"fsharp/part-6/#121","title":"12.1 \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u30c6\u30b9\u30c8","text":"<p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u3067\u306f\u3001\u7d14\u7c8b\u95a2\u6570\u306e\u304a\u304b\u3052\u3067\u30c6\u30b9\u30c8\u304c\u975e\u5e38\u306b\u7c21\u5358\u306b\u306a\u308a\u307e\u3059\u3002</p> <p></p>"},{"location":"fsharp/part-6/#122-searchreport","title":"12.2 SearchReport \u306e\u5c0e\u5165","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/fsharp/src/Ch12/TravelGuideWithReport.fs</code></p> <p>\u30c6\u30b9\u30c8\u53ef\u80fd\u6027\u3092\u9ad8\u3081\u308b\u305f\u3081\u3001<code>SearchReport</code> \u3092\u5c0e\u5165\u3057\u307e\u3059\u3002</p> <pre><code>/// \u691c\u7d22\u306e\u7d71\u8a08\u60c5\u5831\u3068\u30a8\u30e9\u30fc\u60c5\u5831\ntype SearchReport = {\n    AttractionsSearched: int\n    ArtistsFound: int\n    MoviesFound: int\n    Errors: string list\n}\n\nmodule SearchReport =\n    let empty = {\n        AttractionsSearched = 0\n        ArtistsFound = 0\n        MoviesFound = 0\n        Errors = []\n    }\n\n    let addError error report =\n        { report with Errors = error :: report.Errors }\n\n/// SearchReport \u4ed8\u304d\u306e\u65c5\u884c\u30ac\u30a4\u30c9\ntype TravelGuideWithReport = {\n    Attraction: Attraction\n    Subjects: string list\n    SearchReport: SearchReport\n}\n</code></pre> <p></p>"},{"location":"fsharp/part-6/#123","title":"12.3 \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u306e\u6539\u5584","text":"<pre><code>/// Either \u3092\u4f7f\u7528\u3057\u305f\u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\ntype IDataAccessWithErrors =\n    abstract member FindAttractions:\n        name: string * ordering: AttractionOrdering * limit: int\n        -&gt; Async&lt;Attraction list&gt;\n    abstract member FindArtistsFromLocation:\n        locationId: LocationId * limit: int\n        -&gt; Async&lt;Result&lt;MusicArtist list, string&gt;&gt;\n    abstract member FindMoviesAboutLocation:\n        locationId: LocationId * limit: int\n        -&gt; Async&lt;Result&lt;Movie list, string&gt;&gt;\n</code></pre> <p>Result \u3092\u4f7f\u7528\u3057\u3066\u30a8\u30e9\u30fc\u3092\u660e\u793a\u7684\u306b\u6271\u3044\u307e\u3059:</p> <pre><code>/// \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u4ed8\u304d\u65c5\u884c\u30ac\u30a4\u30c9\u751f\u6210\nlet travelGuideWithReport (data: IDataAccessWithErrors) (attractionName: string)\n    : Async&lt;TravelGuideWithReport option&gt; =\n    async {\n        let! attractions = data.FindAttractions(attractionName, ByLocationPopulation, 1)\n        match attractions with\n        | [] -&gt; return None\n        | attraction :: _ -&gt;\n            let! artistsResult = data.FindArtistsFromLocation(attraction.Location.Id, 2)\n            let! moviesResult = data.FindMoviesAboutLocation(attraction.Location.Id, 2)\n\n            let artistError = match artistsResult with Error e -&gt; Some e | Ok _ -&gt; None\n            let movieError = match moviesResult with Error e -&gt; Some e | Ok _ -&gt; None\n            let errors = [artistError; movieError] |&gt; List.choose id\n\n            let artists = artistsResult |&gt; Result.defaultValue []\n            let movies = moviesResult |&gt; Result.defaultValue []\n\n            let subjects =\n                (artists |&gt; List.map (fun a -&gt; a.Name))\n                @ (movies |&gt; List.map (fun m -&gt; m.Name))\n\n            let report = {\n                AttractionsSearched = 1\n                ArtistsFound = List.length artists\n                MoviesFound = List.length movies\n                Errors = errors\n            }\n\n            return Some {\n                Attraction = attraction\n                Subjects = subjects\n                SearchReport = report\n            }\n    }\n</code></pre>"},{"location":"fsharp/part-6/#124","title":"12.4 \u30b9\u30bf\u30d6\u3092\u4f7f\u7528\u3057\u305f\u30c6\u30b9\u30c8","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/fsharp/tests/Ch12/TravelGuideWithReportTests.fs</code></p> <pre><code>/// \u6210\u529f\u3059\u308b\u30c6\u30b9\u30c8\u7528\u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\nlet successfulDataAccess\n    (testAttractions: Attraction list)\n    (testArtists: MusicArtist list)\n    (testMovies: Movie list)\n    : IDataAccessWithErrors =\n    { new IDataAccessWithErrors with\n        member _.FindAttractions(name, _, limit) =\n            async {\n                return\n                    testAttractions\n                    |&gt; List.filter (fun a -&gt; a.Name.Contains(name))\n                    |&gt; List.truncate limit\n            }\n\n        member _.FindArtistsFromLocation(_, limit) =\n            async { return Ok (testArtists |&gt; List.truncate limit) }\n\n        member _.FindMoviesAboutLocation(_, limit) =\n            async { return Ok (testMovies |&gt; List.truncate limit) }\n    }\n\n/// \u90e8\u5206\u7684\u306b\u5931\u6557\u3059\u308b\u30c6\u30b9\u30c8\u7528\u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\nlet partiallyFailingDataAccess\n    (testAttractions: Attraction list)\n    (artistError: string)\n    (movieError: string)\n    : IDataAccessWithErrors =\n    { new IDataAccessWithErrors with\n        member _.FindAttractions(name, _, limit) =\n            async {\n                return\n                    testAttractions\n                    |&gt; List.filter (fun a -&gt; a.Name.Contains(name))\n                    |&gt; List.truncate limit\n            }\n\n        member _.FindArtistsFromLocation(_, _) =\n            async { return Error artistError }\n\n        member _.FindMoviesAboutLocation(_, _) =\n            async { return Error movieError }\n    }\n</code></pre> <p></p>"},{"location":"fsharp/part-6/#125","title":"12.5 \u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8\u7528\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u30fc","text":"<p>\u30e9\u30f3\u30c0\u30e0\u306a\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u3092\u751f\u6210\u3059\u308b\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u30fc\u3092\u5b9f\u88c5:</p> <pre><code>module Generators =\n    open System\n\n    let private random = Random()\n\n    /// \u30e9\u30f3\u30c0\u30e0\u306a LocationId \u3092\u751f\u6210\n    let locationId () =\n        LocationId (sprintf \"Q%d\" (random.Next(1, 10000)))\n\n    /// \u30e9\u30f3\u30c0\u30e0\u306a Location \u3092\u751f\u6210\n    let location () = {\n        Id = locationId ()\n        Name = sprintf \"City%d\" (random.Next(1, 1000))\n        Population = random.Next(1000, 10000000)\n    }\n\n    /// \u30e9\u30f3\u30c0\u30e0\u306a Attraction \u3092\u751f\u6210\n    let attraction () = {\n        Name = sprintf \"Attraction%d\" (random.Next(1, 1000))\n        Description = if random.Next(2) = 0 then Some \"Description\" else None\n        Location = location ()\n    }\n\n    /// \u30e9\u30f3\u30c0\u30e0\u306a Attraction \u30ea\u30b9\u30c8\u3092\u751f\u6210\n    let attractions (count: int) =\n        [ for _ in 1..count -&gt; attraction () ]\n</code></pre>"},{"location":"fsharp/part-6/#126","title":"12.6 \u4e0d\u5909\u6761\u4ef6\u306e\u30c6\u30b9\u30c8","text":"<pre><code>module Invariants =\n    /// \u7d50\u679c\u306e\u30b5\u30a4\u30ba\u306f limit \u4ee5\u4e0b\n    let resultSizeIsLimited (results: 'a list) (limit: int) : bool =\n        List.length results &lt;= limit\n\n    /// SearchReport \u306e\u30a8\u30e9\u30fc\u6570\u306f\u691c\u7d22\u6570\u4ee5\u4e0b\n    let errorsAreBounded (report: SearchReport) : bool =\n        List.length report.Errors &lt;= 2 // artists + movies \u306e\u6700\u5927\n\n/// \u30e6\u30fc\u30c6\u30a3\u30ea\u30c6\u30a3\u95a2\u6570\nlet filterPopularLocations (locations: Location list) (minPopulation: int) : Location list =\n    locations |&gt; List.filter (fun loc -&gt; loc.Population &gt;= minPopulation)\n</code></pre>"},{"location":"fsharp/part-6/#127","title":"12.7 \u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8\uff08\u7c21\u6613\u7248\uff09","text":"<pre><code>[&lt;Fact&gt;]\nlet ``filterPopularLocations \u306e\u7d50\u679c\u30b5\u30a4\u30ba\u306f\u5165\u529b\u4ee5\u4e0b`` () =\n    for _ in 1..10 do\n        let locations = Generators.attractions 10 |&gt; List.map (fun a -&gt; a.Location)\n        let minPop = System.Random().Next(1, 10000000)\n        let result = filterPopularLocations locations minPop\n        Assert.True(List.length result &lt;= List.length locations)\n\n[&lt;Fact&gt;]\nlet ``filterPopularLocations \u306e\u7d50\u679c\u306f\u3059\u3079\u3066\u6761\u4ef6\u3092\u6e80\u305f\u3059`` () =\n    for _ in 1..10 do\n        let locations = Generators.attractions 10 |&gt; List.map (fun a -&gt; a.Location)\n        let minPop = System.Random().Next(1, 100000)\n        let result = filterPopularLocations locations minPop\n        Assert.True(result |&gt; List.forall (fun loc -&gt; loc.Population &gt;= minPop))\n</code></pre>"},{"location":"fsharp/part-6/#128","title":"12.8 \u7d71\u5408\u30c6\u30b9\u30c8","text":"<pre><code>[&lt;Fact&gt;]\nlet ``\u5b8c\u5168\u306a\u30d5\u30ed\u30fc\u306e\u30c6\u30b9\u30c8 - \u6210\u529f\u30b1\u30fc\u30b9`` () =\n    let testLocation = {\n        Id = LocationId \"Q123\"\n        Name = \"Tokyo\"\n        Population = 14000000\n    }\n    let testAttractions = [\n        { Name = \"Tokyo Tower\"; Description = Some \"Famous landmark\"; Location = testLocation }\n    ]\n    let testArtists = [\n        { Name = \"Hikaru Utada\"; Genre = Some \"Pop\" }\n        { Name = \"Ayumi Hamasaki\"; Genre = Some \"Pop\" }\n    ]\n    let testMovies = [\n        { Name = \"Lost in Translation\"; BoxOffice = Some 44000000 }\n    ]\n\n    let dataAccess = successfulDataAccess testAttractions testArtists testMovies\n    let result = travelGuideWithReport dataAccess \"Tokyo\" |&gt; Async.RunSynchronously\n\n    Assert.True(result.IsSome)\n    let guide = result.Value\n    Assert.Equal(\"Tokyo Tower\", guide.Attraction.Name)\n    Assert.Equal(3, List.length guide.Subjects)\n    Assert.Empty(guide.SearchReport.Errors)\n\n[&lt;Fact&gt;]\nlet ``\u5b8c\u5168\u306a\u30d5\u30ed\u30fc\u306e\u30c6\u30b9\u30c8 - \u90e8\u5206\u7684\u5931\u6557\u30b1\u30fc\u30b9`` () =\n    let testLocation = { Id = LocationId \"Q123\"; Name = \"Tokyo\"; Population = 14000000 }\n    let testAttractions = [\n        { Name = \"Tokyo Tower\"; Description = Some \"Famous landmark\"; Location = testLocation }\n    ]\n\n    let dataAccess = partiallyFailingDataAccess testAttractions \"Network error\" \"Timeout\"\n    let result = travelGuideWithReport dataAccess \"Tokyo\" |&gt; Async.RunSynchronously\n\n    Assert.True(result.IsSome)\n    let guide = result.Value\n    Assert.Equal(2, List.length guide.SearchReport.Errors)\n</code></pre>"},{"location":"fsharp/part-6/#129","title":"12.9 \u30c6\u30b9\u30c8\u30d4\u30e9\u30df\u30c3\u30c9","text":""},{"location":"fsharp/part-6/#_1","title":"\u307e\u3068\u3081","text":""},{"location":"fsharp/part-6/#part-vi_1","title":"Part VI \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"fsharp/part-6/#_2","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>\u62bd\u8c61\u5316\u306e\u91cd\u8981\u6027: IDataAccess \u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3067\u5916\u90e8\u4f9d\u5b58\u3092\u62bd\u8c61\u5316</li> <li>Resource \u3067\u30ea\u30bd\u30fc\u30b9\u7ba1\u7406: \u5b89\u5168\u306a\u30ea\u30bd\u30fc\u30b9\u306e\u53d6\u5f97\u3068\u89e3\u653e</li> <li>Ref \u3067\u30ad\u30e3\u30c3\u30b7\u30e5: \u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u72b6\u614b\u7ba1\u7406</li> <li>Result \u3067\u30a8\u30e9\u30fc\u51e6\u7406: \u660e\u793a\u7684\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0</li> <li>SearchReport: \u30c6\u30b9\u30c8\u53ef\u80fd\u6027\u3068\u53ef\u89b3\u6e2c\u6027\u306e\u5411\u4e0a</li> <li>\u30b9\u30bf\u30d6: \u5916\u90e8\u4f9d\u5b58\u3092\u5dee\u3057\u66ff\u3048\u3066\u30c6\u30b9\u30c8</li> <li>\u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8: \u30e9\u30f3\u30c0\u30e0\u5165\u529b\u3067\u4e0d\u5909\u6761\u4ef6\u3092\u691c\u8a3c</li> </ol>"},{"location":"fsharp/part-6/#_3","title":"\u5b66\u7fd2\u306e\u7dcf\u62ec","text":""},{"location":"fsharp/part-6/#_4","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"fsharp/part-6/#1-dataaccess","title":"\u554f\u984c 1: DataAccess \u306e\u62e1\u5f35","text":"<p>\u4ee5\u4e0b\u306e\u8981\u4ef6\u3067 <code>IDataAccess</code> \u3092\u62e1\u5f35\u3057\u3066\u304f\u3060\u3055\u3044: - \u65b0\u3057\u3044\u30e1\u30bd\u30c3\u30c9 <code>FindHotelsNearLocation</code> \u3092\u8ffd\u52a0 - \u623b\u308a\u5024\u306f <code>Async&lt;Result&lt;Hotel list, string&gt;&gt;</code></p> \u89e3\u7b54 <pre><code>type Hotel = {\n    Name: string\n    Rating: float\n    Location: Location\n}\n\ntype IDataAccessExtended =\n    inherit IDataAccess\n    abstract member FindHotelsNearLocation:\n        locationId: LocationId * limit: int\n        -&gt; Async&lt;Result&lt;Hotel list, string&gt;&gt;\n\n// \u30c6\u30b9\u30c8\u7528\u30b9\u30bf\u30d6\nlet testDataAccessExtended\n    (testAttractions: Attraction list)\n    (testArtists: MusicArtist list)\n    (testMovies: Movie list)\n    (testHotels: Hotel list)\n    : IDataAccessExtended =\n    { new IDataAccessExtended with\n        member _.FindAttractions(name, _, limit) =\n            async { return testAttractions |&gt; List.filter (fun a -&gt; a.Name.Contains(name)) |&gt; List.truncate limit }\n        member _.FindArtistsFromLocation(_, limit) =\n            async { return testArtists |&gt; List.truncate limit }\n        member _.FindMoviesAboutLocation(_, limit) =\n            async { return testMovies |&gt; List.truncate limit }\n        member _.FindHotelsNearLocation(_, limit) =\n            async { return Ok (testHotels |&gt; List.truncate limit) }\n    }\n</code></pre>"},{"location":"fsharp/part-6/#2","title":"\u554f\u984c 2: \u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u306b\u5bfe\u3059\u308b\u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8\u3092\u66f8\u3044\u3066\u304f\u3060\u3055\u3044:</p> <pre><code>let sortAttractionsByPopulation (attractions: Attraction list) : Attraction list =\n    attractions |&gt; List.sortByDescending (fun a -&gt; a.Location.Population)\n</code></pre> \u89e3\u7b54 <pre><code>[&lt;Fact&gt;]\nlet ``sortAttractionsByPopulation \u306f\u964d\u9806\u306b\u306a\u308b`` () =\n    for _ in 1..10 do\n        let attractions = Generators.attractions 5\n        let result = sortAttractionsByPopulation attractions\n        let populations = result |&gt; List.map (fun a -&gt; a.Location.Population)\n        let sorted = populations |&gt; List.sortDescending\n        Assert.Equal&lt;int list&gt;(sorted, populations)\n\n[&lt;Fact&gt;]\nlet ``sortAttractionsByPopulation \u306f\u8981\u7d20\u6570\u3092\u5909\u3048\u306a\u3044`` () =\n    for _ in 1..10 do\n        let attractions = Generators.attractions 5\n        let result = sortAttractionsByPopulation attractions\n        Assert.Equal(List.length attractions, List.length result)\n\n[&lt;Fact&gt;]\nlet ``sortAttractionsByPopulation \u306f\u5168\u8981\u7d20\u3092\u4fdd\u6301\u3059\u308b`` () =\n    for _ in 1..10 do\n        let attractions = Generators.attractions 3\n        let result = sortAttractionsByPopulation attractions\n        let inputNames = attractions |&gt; List.map (fun a -&gt; a.Name) |&gt; Set.ofList\n        let outputNames = result |&gt; List.map (fun a -&gt; a.Name) |&gt; Set.ofList\n        Assert.Equal&lt;Set&lt;string&gt;&gt;(inputNames, outputNames)\n</code></pre>"},{"location":"fsharp/part-6/#3-resource","title":"\u554f\u984c 3: Resource \u306e\u5b9f\u88c5","text":"<p>\u30d5\u30a1\u30a4\u30eb\u3092\u5b89\u5168\u306b\u8aad\u307f\u53d6\u308b <code>Resource</code> \u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> \u89e3\u7b54 <pre><code>open System.IO\n\nlet fileResource (path: string) : Resource&lt;StreamReader&gt; =\n    Resource.make\n        (fun () -&gt; async { return new StreamReader(path) })\n        (fun reader -&gt; async { reader.Dispose() })\n\nlet readAllLines (path: string) : Async&lt;string list&gt; =\n    fileResource path\n    |&gt; Resource.useAsync (fun reader -&gt;\n        async {\n            let lines = ResizeArray&lt;string&gt;()\n            let mutable line = reader.ReadLine()\n            while line &lt;&gt; null do\n                lines.Add(line)\n                line &lt;- reader.ReadLine()\n            return lines |&gt; Seq.toList\n        })\n\n// \u4f7f\u7528\u4f8b\nlet program : Async&lt;unit&gt; =\n    async {\n        let! lines = readAllLines \"data.txt\"\n        printfn \"Read %d lines\" (List.length lines)\n    }\n</code></pre>"},{"location":"fsharp/part-6/#_5","title":"\u30b7\u30ea\u30fc\u30ba\u5168\u4f53\u306e\u7dcf\u62ec","text":"<p>\u672c\u30b7\u30ea\u30fc\u30ba\u3067\u306f\u3001\u300cGrokking Functional Programming\u300d\u306e\u5185\u5bb9\u306b\u6cbf\u3063\u3066\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u790e\u304b\u3089\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u307e\u3067\u3092 F# \u3067\u5b66\u3073\u307e\u3057\u305f\u3002</p>"},{"location":"fsharp/part-6/#_6","title":"\u5b66\u3093\u3060\u4e3b\u306a\u6982\u5ff5","text":"Part \u7ae0 \u4e3b\u306a\u6982\u5ff5 I 1-2 \u7d14\u7c8b\u95a2\u6570\u3001\u53c2\u7167\u900f\u904e\u6027 II 3-5 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u3001\u9ad8\u968e\u95a2\u6570\u3001flatMap III 6-7 Option\u3001Result\u3001\u5224\u5225\u5171\u7528\u4f53 IV 8-9 Async\u3001Seq\uff08\u30b9\u30c8\u30ea\u30fc\u30e0\uff09 V 10 \u4e26\u884c\u51e6\u7406\u3001Ref\u3001MailboxProcessor VI 11-12 \u5b9f\u8df5\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3001\u30c6\u30b9\u30c8"},{"location":"fsharp/part-6/#_7","title":"\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u5229\u70b9","text":"<ol> <li>\u4e88\u6e2c\u53ef\u80fd\u6027: \u7d14\u7c8b\u95a2\u6570\u306f\u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b</li> <li>\u30c6\u30b9\u30c8\u5bb9\u6613\u6027: \u526f\u4f5c\u7528\u304c\u306a\u3044\u305f\u3081\u30c6\u30b9\u30c8\u304c\u7c21\u5358</li> <li>\u5408\u6210\u53ef\u80fd\u6027: \u5c0f\u3055\u306a\u95a2\u6570\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u8907\u96d1\u306a\u51e6\u7406\u3092\u69cb\u7bc9</li> <li>\u4e26\u884c\u5b89\u5168\u6027: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u306f\u7af6\u5408\u72b6\u614b\u3092\u9632\u3050</li> <li>\u578b\u5b89\u5168\u6027: Option\u3001Result \u3067 null \u3084\u4f8b\u5916\u3092\u578b\u3067\u8868\u73fe</li> </ol>"},{"location":"fsharp/part-6/#f","title":"F# \u306e\u7279\u5fb4","text":"<p>F# \u306f .NET \u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u4e0a\u3067\u52d5\u4f5c\u3059\u308b\u95a2\u6570\u578b\u512a\u5148\u8a00\u8a9e\u3067\u3001\u4ee5\u4e0b\u306e\u7279\u5fb4\u304c\u3042\u308a\u307e\u3059:</p> <ul> <li>\u578b\u63a8\u8ad6: \u660e\u793a\u7684\u306a\u578b\u6ce8\u91c8\u306a\u3057\u3067\u3082\u578b\u5b89\u5168</li> <li>\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u6f14\u7b97\u5b50: <code>|&gt;</code> \u3067\u30c7\u30fc\u30bf\u306e\u6d41\u308c\u3092\u76f4\u611f\u7684\u306b\u8868\u73fe</li> <li>\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0: \u5f37\u529b\u306a\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3067\u5206\u5c90\u51e6\u7406</li> <li>\u8a08\u7b97\u5f0f: <code>async { }</code> \u306a\u3069\u3067\u975e\u540c\u671f\u51e6\u7406\u3092\u5ba3\u8a00\u7684\u306b\u8a18\u8ff0</li> <li>\u76f8\u4e92\u904b\u7528\u6027: C# \u3084 .NET \u30e9\u30a4\u30d6\u30e9\u30ea\u3068\u30b7\u30fc\u30e0\u30ec\u30b9\u306b\u9023\u643a</li> </ul>"},{"location":"fsharp/part-6/#_8","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<ul> <li>F# \u306e\u9ad8\u5ea6\u306a\u6a5f\u80fd\uff08\u578b\u30d7\u30ed\u30d0\u30a4\u30c0\u30fc\u3001\u30a2\u30af\u30c6\u30a3\u30d6\u30d1\u30bf\u30fc\u30f3\uff09\u3092\u5b66\u3076</li> <li>Elmish/Bolero \u306a\u3069\u306e F# Web \u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af\u3092\u63a2\u7d22</li> <li>Fable \u3067 F# \u3092 JavaScript \u306b\u30b3\u30f3\u30d1\u30a4\u30eb</li> <li>\u5b9f\u969b\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067 FP \u3092\u9069\u7528\u3059\u308b</li> </ul>"},{"location":"haskell/","title":"Grokking Functional Programming - Haskell \u7248","text":"<p>\u672c\u30b7\u30ea\u30fc\u30ba\u306f\u300cGrokking Functional Programming\u300d\uff08Michal Plachta \u8457\uff09\u306e\u5b66\u7fd2\u30b3\u30f3\u30d1\u30cb\u30aa\u30f3\u3068\u3057\u3066\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u6982\u5ff5\u3092 Haskell \u3067\u89e3\u8aac\u3057\u307e\u3059\u3002</p>"},{"location":"haskell/#_1","title":"\u5bfe\u8c61\u8aad\u8005","text":"<ul> <li>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u672c\u5834\u3067\u3042\u308b Haskell \u3092\u5b66\u3073\u305f\u3044\u958b\u767a\u8005</li> <li>\u4ed6\u306e\u8a00\u8a9e\u3067 FP \u3092\u5b66\u3093\u3060\u304c\u3001\u7d14\u7c8b\u95a2\u6570\u578b\u8a00\u8a9e\u3067\u7406\u89e3\u3092\u6df1\u3081\u305f\u3044\u65b9</li> <li>\u578b\u30af\u30e9\u30b9\u3001\u30e2\u30ca\u30c9\u306a\u3069\u306e\u6982\u5ff5\u3092 Haskell \u3067\u4f53\u9a13\u3057\u305f\u3044\u30a8\u30f3\u30b8\u30cb\u30a2</li> </ul>"},{"location":"haskell/#_2","title":"\u8a18\u4e8b\u4e00\u89a7","text":""},{"location":"haskell/#part-i","title":"Part I: \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u790e","text":"<p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u672c\u6982\u5ff5\u3092 Haskell \u3067\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c1\u7ae0 Haskell \u5165\u9580\u3001\u57fa\u672c\u69cb\u6587\u3001GHCi \u7b2c2\u7ae0 \u7d14\u7c8b\u95a2\u6570\u3001\u53c2\u7167\u900f\u904e\u6027\u3001\u9045\u5ef6\u8a55\u4fa1 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: \u7d14\u7c8b\u95a2\u6570\u3001\u53c2\u7167\u900f\u904e\u6027\u3001\u9045\u5ef6\u8a55\u4fa1\u3001\u578b\u63a8\u8ad6</p>"},{"location":"haskell/#part-ii","title":"Part II: \u95a2\u6570\u578b\u30b9\u30bf\u30a4\u30eb\u306e\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0","text":"<p>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c\u3068\u9ad8\u968e\u95a2\u6570\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c3\u7ae0 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u3001\u30ea\u30b9\u30c8\u64cd\u4f5c \u7b2c4\u7ae0 \u9ad8\u968e\u95a2\u6570\u3001map/filter/fold \u7b2c5\u7ae0 \u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18\u3001concatMap <p>\u30ad\u30fc\u30ef\u30fc\u30c9: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u3001\u9ad8\u968e\u95a2\u6570\u3001\u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18\u3001fold</p>"},{"location":"haskell/#part-iii-maybeeither","title":"Part III: \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3068 Maybe/Either","text":"<p>\u578b\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c6\u7ae0 Maybe \u578b\u3001Just/Nothing \u7b2c7\u7ae0 Either \u578b\u3001\u4ee3\u6570\u7684\u30c7\u30fc\u30bf\u578b\u3001\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: Maybe\u3001Either\u3001\u4ee3\u6570\u7684\u30c7\u30fc\u30bf\u578b\uff08ADT\uff09\u3001\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0</p>"},{"location":"haskell/#part-iv-io","title":"Part IV: IO \u3068\u526f\u4f5c\u7528\u306e\u7ba1\u7406","text":"<p>IO \u30e2\u30ca\u30c9\u3068\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c8\u7ae0 IO \u30e2\u30ca\u30c9\u3001do \u8a18\u6cd5 \u7b2c9\u7ae0 conduit/pipes\u3001\u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: IO \u30e2\u30ca\u30c9\u3001do \u8a18\u6cd5\u3001\u9045\u5ef6\u8a55\u4fa1\u3001\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406</p>"},{"location":"haskell/#part-v","title":"Part V: \u4e26\u884c\u51e6\u7406","text":"<p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u4e26\u884c\u51e6\u7406\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c10\u7ae0 STM\u3001TVar\u3001async <p>\u30ad\u30fc\u30ef\u30fc\u30c9: STM\u3001TVar\u3001async\u3001\u8efd\u91cf\u30b9\u30ec\u30c3\u30c9</p>"},{"location":"haskell/#part-vi","title":"Part VI: \u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u3068\u30c6\u30b9\u30c8","text":"<p>\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u3068\u30c6\u30b9\u30c8\u6226\u7565\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c11\u7ae0 TravelGuide \u30a2\u30d7\u30ea\u3001bracket\u3001\u30ea\u30bd\u30fc\u30b9\u7ba1\u7406 \u7b2c12\u7ae0 \u30c6\u30b9\u30c8\u6226\u7565\u3001QuickCheck <p>\u30ad\u30fc\u30ef\u30fc\u30c9: bracket\u3001\u30ea\u30bd\u30fc\u30b9\u7ba1\u7406\u3001QuickCheck\u3001\u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8</p>"},{"location":"haskell/#_3","title":"\u5b66\u7fd2\u30d1\u30b9","text":""},{"location":"haskell/#haskell","title":"Haskell \u306e\u7279\u5fb4","text":"<p>Haskell \u306f\u7d14\u7c8b\u95a2\u6570\u578b\u8a00\u8a9e\u3068\u3057\u3066\u3001\u4ee5\u4e0b\u306e\u7279\u5fb4\u3092\u6301\u3061\u307e\u3059:</p> \u7279\u5fb4 \u8aac\u660e \u7d14\u7c8b\u6027 \u3059\u3079\u3066\u306e\u95a2\u6570\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u7d14\u7c8b\u3001\u526f\u4f5c\u7528\u306f IO \u3067\u660e\u793a \u9045\u5ef6\u8a55\u4fa1 \u5fc5\u8981\u306b\u306a\u308b\u307e\u3067\u5f0f\u3092\u8a55\u4fa1\u3057\u306a\u3044\uff08\u30c7\u30d5\u30a9\u30eb\u30c8\uff09 \u5f37\u529b\u306a\u578b\u30b7\u30b9\u30c6\u30e0 \u578b\u30af\u30e9\u30b9\u3001\u9ad8\u30ab\u30a4\u30f3\u30c9\u578b\u3001GADT \u306a\u3069 \u578b\u63a8\u8ad6 \u307b\u3068\u3093\u3069\u306e\u578b\u6ce8\u91c8\u3092\u7701\u7565\u53ef\u80fd"},{"location":"haskell/#_4","title":"\u4f7f\u7528\u30e9\u30a4\u30d6\u30e9\u30ea","text":"\u30e9\u30a4\u30d6\u30e9\u30ea \u7528\u9014 \u5bfe\u5fdc\u7ae0 base \u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea \u5168\u7ae0 text \u30c6\u30ad\u30b9\u30c8\u51e6\u7406 \u5168\u7ae0 containers Map\u3001Set \u306a\u3069 Part II-VI mtl \u30e2\u30ca\u30c9\u5909\u63db\u5b50 Part IV-VI async \u975e\u540c\u671f\u51e6\u7406 Part V stm STM Part V conduit \u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406 Part IV QuickCheck \u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8 Part VI hspec \u30c6\u30b9\u30c8\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af Part VI"},{"location":"haskell/#scala","title":"Scala \u3068\u306e\u5bfe\u5fdc","text":"Scala Haskell \u8aac\u660e <code>Option[A]</code> <code>Maybe a</code> \u5024\u306e\u6709\u7121\u3092\u8868\u73fe <code>Either[A, B]</code> <code>Either a b</code> \u6210\u529f/\u5931\u6557\u3092\u8868\u73fe <code>List[A]</code> <code>[a]</code> \u30ea\u30b9\u30c8\u578b <code>map</code> <code>fmap</code> / <code>&lt;$&gt;</code> \u30d5\u30a1\u30f3\u30af\u30bf\u30fc\u306e\u5c04 <code>flatMap</code> <code>&gt;&gt;=</code> (bind) \u30e2\u30ca\u30c9\u306e bind <code>for</code> \u5185\u5305\u8868\u8a18 <code>do</code> \u8a18\u6cd5 \u30e2\u30ca\u30c9\u306e\u7cd6\u8863\u69cb\u6587 <code>IO[A]</code> <code>IO a</code> \u526f\u4f5c\u7528\u3092\u8868\u73fe <code>Ref[IO, A]</code> <code>TVar a</code> \u53ef\u5909\u53c2\u7167\uff08STM\uff09"},{"location":"haskell/#_5","title":"\u30ea\u30dd\u30b8\u30c8\u30ea\u69cb\u6210","text":"<pre><code>grokkingfp-examples/\n\u251c\u2500\u2500 app/haskell/src/           # Haskell \u306e\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n\u2502   \u251c\u2500\u2500 Ch01/                  # \u7b2c1\u7ae0\n\u2502   \u251c\u2500\u2500 Ch02/                  # \u7b2c2\u7ae0\n\u2502   \u2514\u2500\u2500 ...\n\u251c\u2500\u2500 app/haskell/test/          # \u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\n\u251c\u2500\u2500 app/haskell/package.yaml   # Stack \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u8a2d\u5b9a\n\u251c\u2500\u2500 docs/article/              # \u89e3\u8aac\u8a18\u4e8b\n\u2502   \u2514\u2500\u2500 haskell/               # Haskell \u7248\uff08\u672c\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\uff09\n\u2502       \u251c\u2500\u2500 index.md           # \u3053\u306e\u8a18\u4e8b\n\u2502       \u251c\u2500\u2500 part-1.md          # Part I\n\u2502       \u251c\u2500\u2500 part-2.md          # Part II\n\u2502       \u251c\u2500\u2500 part-3.md          # Part III\n\u2502       \u251c\u2500\u2500 part-4.md          # Part IV\n\u2502       \u251c\u2500\u2500 part-5.md          # Part V\n\u2502       \u2514\u2500\u2500 part-6.md          # Part VI\n</code></pre>"},{"location":"haskell/#_6","title":"\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u5229\u70b9","text":"<p>\u672c\u30b7\u30ea\u30fc\u30ba\u3092\u901a\u3058\u3066\u3001\u4ee5\u4e0b\u306e\u5229\u70b9\u3092\u5b9f\u611f\u3067\u304d\u307e\u3059:</p> <ol> <li>\u4e88\u6e2c\u53ef\u80fd\u6027 - \u7d14\u7c8b\u95a2\u6570\u306f\u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b</li> <li>\u30c6\u30b9\u30c8\u5bb9\u6613\u6027 - \u526f\u4f5c\u7528\u304c\u306a\u3044\u305f\u3081\u30c6\u30b9\u30c8\u304c\u7c21\u5358</li> <li>\u5408\u6210\u53ef\u80fd\u6027 - \u5c0f\u3055\u306a\u95a2\u6570\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u8907\u96d1\u306a\u51e6\u7406\u3092\u69cb\u7bc9</li> <li>\u4e26\u884c\u5b89\u5168\u6027 - \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u306f\u7af6\u5408\u72b6\u614b\u3092\u9632\u3050</li> <li>\u578b\u5b89\u5168\u6027 - Maybe\u3001Either \u3067 null \u3084\u4f8b\u5916\u3092\u578b\u3067\u8868\u73fe</li> <li>\u9045\u5ef6\u8a55\u4fa1 - \u7121\u9650\u30c7\u30fc\u30bf\u69cb\u9020\u3084\u52b9\u7387\u7684\u306a\u30e1\u30e2\u30ea\u4f7f\u7528</li> </ol>"},{"location":"haskell/#_7","title":"\u958b\u767a\u74b0\u5883\u306e\u30bb\u30c3\u30c8\u30a2\u30c3\u30d7","text":""},{"location":"haskell/#ghcup","title":"GHCup\uff08\u63a8\u5968\uff09","text":"<pre><code># GHCup \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\ncurl --proto '=https' --tlsv1.2 -sSf https://get-ghcup.haskell.org | sh\n\n# GHC \u3068 Stack \u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\nghcup install ghc 9.4.8\nghcup install stack latest\n\n# \u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u30d3\u30eb\u30c9\ncd app/haskell\nstack build\n\n# \u30c6\u30b9\u30c8\u306e\u5b9f\u884c\nstack test\n\n# REPL \u306e\u8d77\u52d5\nstack ghci\n</code></pre>"},{"location":"haskell/#_8","title":"\u53c2\u8003\u8cc7\u6599","text":"<ul> <li>Grokking Functional Programming - \u539f\u8457</li> <li>Haskell \u516c\u5f0f\u30b5\u30a4\u30c8</li> <li>Learn You a Haskell for Great Good! - \u5165\u9580\u66f8\uff08\u7121\u6599\uff09</li> <li>Real World Haskell - \u5b9f\u8df5\u7684\u306a Haskell</li> <li>Hoogle - Haskell API \u691c\u7d22</li> <li>Hackage - \u30d1\u30c3\u30b1\u30fc\u30b8\u30ea\u30dd\u30b8\u30c8\u30ea</li> </ul>"},{"location":"haskell/part-1/","title":"Part I: \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u790e","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\uff08FP\uff09\u306e\u57fa\u672c\u6982\u5ff5\u3092 Haskell \u3067\u5b66\u3073\u307e\u3059\u3002Haskell \u306f\u7d14\u7c8b\u95a2\u6570\u578b\u8a00\u8a9e\u3067\u3042\u308a\u3001FP \u306e\u6982\u5ff5\u3092\u6700\u3082\u76f4\u63a5\u7684\u306b\u4f53\u9a13\u3067\u304d\u307e\u3059\u3002</p>"},{"location":"haskell/part-1/#1-haskell","title":"\u7b2c1\u7ae0: Haskell \u5165\u9580","text":""},{"location":"haskell/part-1/#11-vs","title":"1.1 \u547d\u4ee4\u578b vs \u95a2\u6570\u578b","text":"<p>\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u306f\u5927\u304d\u304f\u5206\u3051\u30662\u3064\u306e\u30d1\u30e9\u30c0\u30a4\u30e0\u304c\u3042\u308a\u307e\u3059\u3002</p> <p></p> <p>\u547d\u4ee4\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306f\u300c\u3069\u3046\u3084\u308b\u304b\u300d\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002</p> <pre><code>// Java: \u547d\u4ee4\u578b\u3067\u30ef\u30fc\u30c9\u30b9\u30b3\u30a2\u3092\u8a08\u7b97\npublic static int calculateScore(String word) {\n    int score = 0;\n    for(char c : word.toCharArray()) {\n        score++;\n    }\n    return score;\n}\n</code></pre> <p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306f\u300c\u4f55\u3092\u3059\u308b\u304b\u300d\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002</p> <pre><code>-- Haskell: \u95a2\u6570\u578b\u3067\u30ef\u30fc\u30c9\u30b9\u30b3\u30a2\u3092\u8a08\u7b97\nwordScore :: String -&gt; Int\nwordScore word = length word\n</code></pre>"},{"location":"haskell/part-1/#12-haskell","title":"1.2 Haskell \u306e\u57fa\u672c\u69cb\u6587","text":"<p>Haskell \u3067\u306e\u95a2\u6570\u5b9a\u7fa9\u306e\u57fa\u672c\u5f62\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/haskell/src/Ch01/IntroHaskell.hs</code></p> <pre><code>-- \u6570\u5024\u3092\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\u3059\u308b\nincrement :: Int -&gt; Int\nincrement x = x + 1\n\n-- \u6587\u5b57\u5217\u306e\u6700\u521d\u306e\u6587\u5b57\u3092\u53d6\u5f97\u3059\u308b\ngetFirstCharacter :: String -&gt; Char\ngetFirstCharacter s = head s\n\n-- \u5358\u8a9e\u306e\u30b9\u30b3\u30a2\u3092\u8a08\u7b97\u3059\u308b\uff08\u6587\u5b57\u6570\uff09\nwordScore :: String -&gt; Int\nwordScore word = length word\n</code></pre>"},{"location":"haskell/part-1/#13","title":"1.3 \u95a2\u6570\u306e\u69cb\u9020","text":"<p>Haskell \u306e\u95a2\u6570\u5b9a\u7fa9\u306f2\u884c\u3067\u69cb\u6210\u3055\u308c\u307e\u3059:</p> <ol> <li>\u578b\u30b7\u30b0\u30cd\u30c1\u30e3: <code>increment :: Int -&gt; Int</code>\uff08\u7701\u7565\u53ef\u80fd\u3060\u304c\u63a8\u5968\uff09</li> <li>\u5b9a\u7fa9: <code>increment x = x + 1</code></li> </ol>"},{"location":"haskell/part-1/#14-haskell","title":"1.4 Haskell \u306e\u7279\u5fb4","text":"\u7279\u5fb4 \u8aac\u660e \u4f8b \u7d14\u7c8b\u6027 \u3059\u3079\u3066\u306e\u95a2\u6570\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u7d14\u7c8b \u526f\u4f5c\u7528\u306f IO \u3067\u660e\u793a \u9045\u5ef6\u8a55\u4fa1 \u5fc5\u8981\u306b\u306a\u308b\u307e\u3067\u5f0f\u3092\u8a55\u4fa1\u3057\u306a\u3044 \u7121\u9650\u30ea\u30b9\u30c8\u304c\u53ef\u80fd \u5f37\u3044\u578b\u63a8\u8ad6 \u578b\u6ce8\u91c8\u306a\u3057\u3067\u3082\u578b\u3092\u63a8\u8ad6 <code>add a b = a + b</code> \u30ab\u30ea\u30fc\u5316 \u8907\u6570\u5f15\u6570\u306f\u81ea\u52d5\u7684\u306b\u30ab\u30ea\u30fc\u5316 <code>add 1</code> \u306f\u90e8\u5206\u9069\u7528"},{"location":"haskell/part-1/#15","title":"1.5 \u9045\u5ef6\u8a55\u4fa1\u306e\u4f8b","text":"<p>Haskell \u306e\u7279\u5fb4\u7684\u306a\u6a5f\u80fd\u306e\u4e00\u3064\u304c\u9045\u5ef6\u8a55\u4fa1\u3067\u3059\u3002</p> <pre><code>-- \u7121\u9650\u306e 1 \u306e\u30ea\u30b9\u30c8\ninfiniteOnes :: [Int]\ninfiniteOnes = repeat 1\n\n-- \u7121\u9650\u30ea\u30b9\u30c8\u304b\u3089\u6700\u521d\u306e 5 \u8981\u7d20\u3092\u53d6\u5f97\ntakeFive :: [Int]\ntakeFive = take 5 infiniteOnes  -- [1,1,1,1,1]\n</code></pre> <p>\u9045\u5ef6\u8a55\u4fa1\u306b\u3088\u308a\u3001\u7121\u9650\u30c7\u30fc\u30bf\u69cb\u9020\u3092\u6271\u3048\u307e\u3059\u3002\u5fc5\u8981\u306a\u5206\u3060\u3051\u8a55\u4fa1\u3055\u308c\u308b\u305f\u3081\u3001\u30e1\u30e2\u30ea\u52b9\u7387\u3082\u826f\u597d\u3067\u3059\u3002</p>"},{"location":"haskell/part-1/#16","title":"1.6 \u57fa\u672c\u7684\u306a\u95a2\u6570","text":"<pre><code>-- 2\u3064\u306e\u6570\u3092\u52a0\u7b97\u3059\u308b\nadd :: Int -&gt; Int -&gt; Int\nadd a b = a + b\n\n-- 2\u3064\u306e\u6570\u3092\u4e57\u7b97\u3059\u308b\nmultiply :: Int -&gt; Int -&gt; Int\nmultiply a b = a * b\n\n-- \u6570\u5024\u304c\u6b63\u304b\u3069\u3046\u304b\u3092\u5224\u5b9a\u3059\u308b\nisPositive :: Int -&gt; Bool\nisPositive n = n &gt; 0\n\n-- \u540d\u524d\u3067\u6328\u62f6\u3059\u308b\ngreet :: String -&gt; String\ngreet name = \"Hello, \" ++ name ++ \"!\"\n</code></pre>"},{"location":"haskell/part-1/#17","title":"1.7 \u5b66\u7fd2\u30dd\u30a4\u30f3\u30c8","text":"\u6982\u5ff5 \u547d\u4ee4\u578b Haskell \u7126\u70b9 \u624b\u9806\uff08How\uff09 \u7d50\u679c\uff08What\uff09 \u72b6\u614b \u5909\u66f4\u3059\u308b \u5909\u63db\u3059\u308b \u30eb\u30fc\u30d7 for/while map/filter/fold \u30c7\u30fc\u30bf \u30df\u30e5\u30fc\u30bf\u30d6\u30eb \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb \u526f\u4f5c\u7528 \u6697\u9ed9\u7684 IO \u3067\u660e\u793a\u7684"},{"location":"haskell/part-1/#2","title":"\u7b2c2\u7ae0: \u7d14\u7c8b\u95a2\u6570\u3068\u30c6\u30b9\u30c8","text":""},{"location":"haskell/part-1/#21","title":"2.1 \u7d14\u7c8b\u95a2\u6570\u3068\u306f","text":"<p>\u7d14\u7c8b\u95a2\u6570\uff08Pure Function\uff09\u306f\u4ee5\u4e0b\u306e\u7279\u5fb4\u3092\u6301\u3064\u95a2\u6570\u3067\u3059:</p> <ol> <li>\u540c\u3058\u5165\u529b\u306b\u306f\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3059</li> <li>\u526f\u4f5c\u7528\u304c\u306a\u3044\uff08\u5916\u90e8\u72b6\u614b\u3092\u5909\u66f4\u3057\u306a\u3044\uff09</li> </ol> <p></p> <p>Haskell \u3067\u306f\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u3059\u3079\u3066\u306e\u95a2\u6570\u304c\u7d14\u7c8b\u3067\u3059\u3002 \u526f\u4f5c\u7528\u306f <code>IO</code> \u30e2\u30ca\u30c9\u3067\u660e\u793a\u7684\u306b\u6271\u3044\u307e\u3059\u3002</p>"},{"location":"haskell/part-1/#22","title":"2.2 \u7d14\u7c8b\u95a2\u6570\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/haskell/src/Ch02/PureFunctions.hs</code></p> <pre><code>-- \u7d14\u7c8b\u95a2\u6570\u306e\u4f8b\npureIncrement :: Int -&gt; Int\npureIncrement x = x + 1\n\npureAdd :: Int -&gt; Int -&gt; Int\npureAdd a b = a + b\n\npureGetFirstChar :: String -&gt; Char\npureGetFirstChar s = head s\n</code></pre> <p>\u7d14\u7c8b\u3067\u306f\u306a\u3044\u95a2\u6570\u306e\u4f8b\uff08Haskell \u3067\u306f IO \u3092\u4f7f\u3063\u3066\u660e\u793a\uff09:</p> <pre><code>-- \u4e0d\u7d14\u306a\u95a2\u6570 - IO \u30e2\u30ca\u30c9\u3067\u526f\u4f5c\u7528\u3092\u660e\u793a\nimpureRandomPart :: Double -&gt; IO Double\nimpureRandomPart x = do\n    r &lt;- randomIO\n    return (x * r)\n</code></pre>"},{"location":"haskell/part-1/#23","title":"2.3 \u30b7\u30e7\u30c3\u30d4\u30f3\u30b0\u30ab\u30fc\u30c8\u306e\u4f8b","text":"<p>\u72b6\u614b\u3092\u6301\u3064\u30af\u30e9\u30b9\u306e\u554f\u984c\u70b9\u3092\u7d14\u7c8b\u95a2\u6570\u3067\u89e3\u6c7a\u3057\u307e\u3059\u3002</p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/haskell/src/Ch02/PureFunctions.hs</code></p>"},{"location":"haskell/part-1/#java","title":"\u554f\u984c\u306e\u3042\u308b\u30b3\u30fc\u30c9\uff08Java\uff09","text":"<pre><code>class ShoppingCartBad {\n    private List&lt;String&gt; items = new ArrayList&lt;&gt;();\n    private boolean bookAdded = false;\n\n    public void addItem(String item) {\n        items.add(item);\n        if(item.equals(\"Book\")) {\n            bookAdded = true;\n        }\n    }\n\n    public int getDiscountPercentage() {\n        if(bookAdded) {\n            return 5;\n        } else {\n            return 0;\n        }\n    }\n}\n</code></pre>"},{"location":"haskell/part-1/#haskell","title":"\u7d14\u7c8b\u95a2\u6570\u306b\u3088\u308b\u89e3\u6c7a\uff08Haskell\uff09","text":"<pre><code>-- \u30ab\u30fc\u30c8\u5185\u306e\u30a2\u30a4\u30c6\u30e0\u304b\u3089\u5272\u5f15\u7387\u3092\u8a08\u7b97\u3059\u308b\ngetDiscountPercentage :: [String] -&gt; Int\ngetDiscountPercentage items\n    | \"Book\" `elem` items = 5\n    | otherwise           = 0\n\n-- \u5272\u5f15\u984d\u3092\u8a08\u7b97\u3059\u308b\ncalculateDiscount :: Double -&gt; [String] -&gt; Double\ncalculateDiscount price items =\n    price * fromIntegral (getDiscountPercentage items) / 100\n</code></pre>"},{"location":"haskell/part-1/#24","title":"2.4 \u30c1\u30c3\u30d7\u8a08\u7b97\u306e\u4f8b","text":"<pre><code>-- \u30b0\u30eb\u30fc\u30d7\u30b5\u30a4\u30ba\u304b\u3089\u30c1\u30c3\u30d7\u7387\u3092\u8a08\u7b97\u3059\u308b\ngetTipPercentage :: [String] -&gt; Int\ngetTipPercentage names\n    | length names &gt; 5  = 20  -- 6\u4eba\u4ee5\u4e0a \u2192 20%\n    | length names &gt; 0  = 10  -- 1-5\u4eba \u2192 10%\n    | otherwise         = 0   -- 0\u4eba \u2192 0%\n\n-- \u30c1\u30c3\u30d7\u984d\u3092\u8a08\u7b97\u3059\u308b\ncalculateTip :: Double -&gt; [String] -&gt; Double\ncalculateTip bill names =\n    bill * fromIntegral (getTipPercentage names) / 100\n</code></pre>"},{"location":"haskell/part-1/#25","title":"2.5 \u7d14\u7c8b\u95a2\u6570\u306e\u30c6\u30b9\u30c8","text":"<p>\u7d14\u7c8b\u95a2\u6570\u306f\u975e\u5e38\u306b\u30c6\u30b9\u30c8\u3057\u3084\u3059\u3044\u3067\u3059\u3002Haskell \u3067\u306f HSpec \u3068 QuickCheck \u3092\u4f7f\u7528\u3057\u307e\u3059\u3002</p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/haskell/test/Ch02/PureFunctionsSpec.hs</code></p> <pre><code>-- \u5358\u4f53\u30c6\u30b9\u30c8\ndescribe \"pureIncrement\" $ do\n    it \"increments 5 to 6\" $ do\n        pureIncrement 5 `shouldBe` 6\n\n    it \"same input always gives same output\" $ do\n        pureIncrement 10 `shouldBe` pureIncrement 10\n\n-- \u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8\n    it \"property: pureIncrement x == x + 1\" $ property $\n        \\x -&gt; pureIncrement x == x + 1\n</code></pre> <p></p>"},{"location":"haskell/part-1/#26-a","title":"2.6 \u6587\u5b57 'a' \u3092\u9664\u5916\u3059\u308b\u30ef\u30fc\u30c9\u30b9\u30b3\u30a2","text":"<p>\u3088\u308a\u8907\u96d1\u306a\u4f8b\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p> <pre><code>-- 'a' \u3092\u9664\u3044\u305f\u6587\u5b57\u6570\u3092\u30b9\u30b3\u30a2\u3068\u3057\u3066\u8a08\u7b97\nwordScoreWithoutA :: String -&gt; Int\nwordScoreWithoutA word = length $ filter (/= 'a') word\n\n-- \u30c6\u30b9\u30c8\n-- wordScoreWithoutA \"Scala\"   == 3  -- \"Scl\" \u2192 3\u6587\u5b57\n-- wordScoreWithoutA \"Haskell\" == 7  -- 'a' \u306a\u3057 \u2192 7\u6587\u5b57\n-- wordScoreWithoutA \"aaa\"     == 0  -- \u3059\u3079\u3066 'a' \u2192 0\u6587\u5b57\n</code></pre>"},{"location":"haskell/part-1/#27","title":"2.7 \u53c2\u7167\u900f\u904e\u6027","text":"<p>\u7d14\u7c8b\u95a2\u6570\u306f\u53c2\u7167\u900f\u904e\u6027\uff08Referential Transparency\uff09\u3092\u6301\u3061\u307e\u3059\u3002</p> <p>\u5f0f\u3092\u305d\u306e\u8a55\u4fa1\u7d50\u679c\u3067\u7f6e\u304d\u63db\u3048\u3066\u3082\u3001\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u610f\u5473\u304c\u5909\u308f\u3089\u306a\u3044\u3053\u3068</p> <pre><code>-- \u53c2\u7167\u900f\u904e\u6027\u306e\u4f8b\nreferentialTransparencyExample :: Bool\nreferentialTransparencyExample =\n    let score1 = wordScoreWithoutA \"Scala\"  -- \u5e38\u306b 3\n        score2 = wordScoreWithoutA \"Scala\"  -- \u5e38\u306b 3\n        -- score1 \u3068 score2 \u306f\u5e38\u306b\u540c\u3058\u5024\n        total1 = wordScoreWithoutA \"Scala\" + wordScoreWithoutA \"Java\"\n        total2 = 3 + 4  -- \u7f6e\u304d\u63db\u3048\u53ef\u80fd\n    in score1 == score2 &amp;&amp; total1 == total2  -- True\n</code></pre> <p></p>"},{"location":"haskell/part-1/#28-maybe","title":"2.8 Maybe \u578b\u306b\u3088\u308b\u5b89\u5168\u306a\u64cd\u4f5c","text":"<p>Haskell \u3067\u306f <code>null</code> \u306e\u4ee3\u308f\u308a\u306b <code>Maybe</code> \u578b\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002</p> <pre><code>-- \u5b89\u5168\u306a\u5148\u982d\u8981\u7d20\u53d6\u5f97\nsafeHead :: [a] -&gt; Maybe a\nsafeHead []    = Nothing\nsafeHead (x:_) = Just x\n\n-- \u5b89\u5168\u306a\u672b\u5c3e\u53d6\u5f97\nsafeTail :: [a] -&gt; Maybe [a]\nsafeTail []     = Nothing\nsafeTail (_:xs) = Just xs\n\n-- \u4f7f\u7528\u4f8b\n-- safeHead [1,2,3] == Just 1\n-- safeHead []      == Nothing\n</code></pre>"},{"location":"haskell/part-1/#_1","title":"\u307e\u3068\u3081","text":""},{"location":"haskell/part-1/#part-i_1","title":"Part I \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"haskell/part-1/#_2","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306f\u300c\u4f55\u3092\u3059\u308b\u304b\u300d\u3092\u5ba3\u8a00\u7684\u306b\u8a18\u8ff0\u3059\u308b</li> <li>Haskell \u3067\u306f\u3059\u3079\u3066\u306e\u95a2\u6570\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u7d14\u7c8b\uff08\u526f\u4f5c\u7528\u306f IO \u3067\u660e\u793a\uff09</li> <li>\u9045\u5ef6\u8a55\u4fa1\u306b\u3088\u308a\u7121\u9650\u30c7\u30fc\u30bf\u69cb\u9020\u304c\u6271\u3048\u308b</li> <li>\u7d14\u7c8b\u95a2\u6570\u306f\u30c6\u30b9\u30c8\u304c\u975e\u5e38\u306b\u7c21\u5358</li> <li>\u53c2\u7167\u900f\u904e\u6027\u306b\u3088\u308a\u3001\u30b3\u30fc\u30c9\u306e\u7406\u89e3\u3068\u63a8\u8ad6\u304c\u5bb9\u6613</li> <li>Maybe \u578b\u3067 null \u5b89\u5168\u6027\u3092\u578b\u30ec\u30d9\u30eb\u3067\u4fdd\u8a3c</li> </ol>"},{"location":"haskell/part-1/#scala","title":"Scala \u3068\u306e\u5bfe\u5fdc","text":"Scala Haskell \u8aac\u660e <code>def f(x: Int): Int</code> <code>f :: Int -&gt; Int</code> \u578b\u30b7\u30b0\u30cd\u30c1\u30e3 <code>Option[A]</code> <code>Maybe a</code> \u5024\u306e\u6709\u7121\u3092\u8868\u73fe <code>None</code> <code>Nothing</code> \u5024\u304c\u306a\u3044 <code>Some(x)</code> <code>Just x</code> \u5024\u304c\u3042\u308b <code>List[A]</code> <code>[a]</code> \u30ea\u30b9\u30c8\u578b <code>x.length</code> <code>length x</code> \u95a2\u6570\u9069\u7528\uff08\u524d\u7f6e\u8a18\u6cd5\uff09"},{"location":"haskell/part-1/#_3","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part II \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c</li> <li>\u9ad8\u968e\u95a2\u6570\uff08map\u3001filter\u3001fold\uff09</li> <li>\u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18</li> <li>concatMap \u3068 flatMap</li> </ul>"},{"location":"haskell/part-1/#_4","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"haskell/part-1/#1","title":"\u554f\u984c 1: \u7d14\u7c8b\u95a2\u6570\u306e\u8b58\u5225","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u306e\u3046\u3061\u3001\u7d14\u7c8b\u95a2\u6570\u306f\u3069\u308c\u3067\u3059\u304b?</p> <pre><code>-- A\ndouble :: Int -&gt; Int\ndouble x = x * 2\n\n-- B\nincrementCounter :: IORef Int -&gt; IO Int\nincrementCounter ref = do\n    modifyIORef ref (+1)\n    readIORef ref\n\n-- C\ngreet :: String -&gt; String\ngreet name = \"Hello, \" ++ name ++ \"!\"\n\n-- D\ncurrentTime :: IO UTCTime\ncurrentTime = getCurrentTime\n</code></pre> \u89e3\u7b54  **A \u3068 C \u306f\u7d14\u7c8b\u95a2\u6570**\u3067\u3059\u3002  - A: \u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3057\u3001\u526f\u4f5c\u7528\u304c\u306a\u3044 - B: IORef \u3092\u5909\u66f4\u3059\u308b\u526f\u4f5c\u7528\u304c\u3042\u308b\uff08IO \u30e2\u30ca\u30c9\u3067\u660e\u793a\uff09 - C: \u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3057\u3001\u526f\u4f5c\u7528\u304c\u306a\u3044 - D: \u547c\u3073\u51fa\u3059\u305f\u3073\u306b\u7570\u306a\u308b\u5024\u3092\u8fd4\u3059\uff08IO \u30e2\u30ca\u30c9\u3067\u660e\u793a\uff09"},{"location":"haskell/part-1/#2_1","title":"\u554f\u984c 2: \u7d14\u7c8b\u95a2\u6570\u3078\u306e\u66f8\u304d\u63db\u3048","text":"<p>\u4ee5\u4e0b\u306e\u4e0d\u7d14\u306a Java \u30b3\u30fc\u30c9\u3092 Haskell \u306e\u7d14\u7c8b\u95a2\u6570\u306b\u66f8\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>class Counter {\n    private int value = 0;\n\n    public int increment() {\n        value++;\n        return value;\n    }\n}\n</code></pre> \u89e3\u7b54 <pre><code>-- \u72b6\u614b\u3092\u5f15\u6570\u3068\u3057\u3066\u53d7\u3051\u53d6\u308a\u3001\u65b0\u3057\u3044\u72b6\u614b\u3092\u8fd4\u3059\nincrement :: Int -&gt; Int\nincrement value = value + 1\n\n-- \u4f7f\u7528\u4f8b\n-- let v1 = 0\n--     v2 = increment v1  -- 1\n--     v3 = increment v2  -- 2\n</code></pre>  \u72b6\u614b\u3092\u5916\u90e8\u306b\u6301\u3061\u3001\u95a2\u6570\u306f\u5024\u3092\u53d7\u3051\u53d6\u3063\u3066\u65b0\u3057\u3044\u5024\u3092\u8fd4\u3059\u3060\u3051\u306b\u3057\u307e\u3059\u3002"},{"location":"haskell/part-1/#3","title":"\u554f\u984c 3: \u30c6\u30b9\u30c8\u3092\u66f8\u304f","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u306b\u5bfe\u3059\u308b\u30c6\u30b9\u30c8\u30b1\u30fc\u30b9\u3092\u8003\u3048\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>isEven :: Int -&gt; Bool\nisEven n = n `mod` 2 == 0\n</code></pre> \u89e3\u7b54 <pre><code>describe \"isEven\" $ do\n    -- \u57fa\u672c\u30b1\u30fc\u30b9\n    it \"returns True for 0\" $ isEven 0 `shouldBe` True\n    it \"returns True for 2\" $ isEven 2 `shouldBe` True\n    it \"returns True for 4\" $ isEven 4 `shouldBe` True\n\n    -- \u5947\u6570\n    it \"returns False for 1\" $ isEven 1 `shouldBe` False\n    it \"returns False for 3\" $ isEven 3 `shouldBe` False\n\n    -- \u8ca0\u306e\u6570\n    it \"returns True for -2\" $ isEven (-2) `shouldBe` True\n    it \"returns False for -3\" $ isEven (-3) `shouldBe` False\n\n    -- \u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8\n    it \"n and n+2 have same parity\" $ property $\n        \\n -&gt; isEven n == isEven (n + 2)\n</code></pre>"},{"location":"haskell/part-2/","title":"Part II: \u95a2\u6570\u578b\u30b9\u30bf\u30a4\u30eb\u306e\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u6838\u5fc3\u3068\u306a\u308b\u30c6\u30af\u30cb\u30c3\u30af\u3092 Haskell \u3067\u5b66\u3073\u307e\u3059\u3002\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c\u3001\u9ad8\u968e\u95a2\u6570\u3001\u305d\u3057\u3066 <code>concatMap</code>\uff08flatMap\uff09\u306b\u3088\u308b\u8907\u96d1\u306a\u30c7\u30fc\u30bf\u5909\u63db\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"haskell/part-2/#3","title":"\u7b2c3\u7ae0: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c","text":""},{"location":"haskell/part-2/#31","title":"3.1 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u3068\u306f","text":"<p>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\uff08\u4e0d\u5909\uff09\u3068\u306f\u3001\u4e00\u5ea6\u4f5c\u6210\u3055\u308c\u305f\u30c7\u30fc\u30bf\u304c\u5909\u66f4\u3055\u308c\u306a\u3044\u3053\u3068\u3092\u610f\u5473\u3057\u307e\u3059\u3002\u30c7\u30fc\u30bf\u3092\u300c\u5909\u66f4\u300d\u3059\u308b\u4ee3\u308f\u308a\u306b\u3001\u65b0\u3057\u3044\u30c7\u30fc\u30bf\u3092\u300c\u4f5c\u6210\u300d\u3057\u307e\u3059\u3002</p> <p></p> <p>Haskell \u3067\u306f\u3059\u3079\u3066\u306e\u30c7\u30fc\u30bf\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u3067\u3059\u3002</p>"},{"location":"haskell/part-2/#32-list","title":"3.2 List \u306e\u57fa\u672c\u64cd\u4f5c","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/haskell/src/Ch03/ImmutableValues.hs</code></p>"},{"location":"haskell/part-2/#_1","title":"\u8981\u7d20\u306e\u8ffd\u52a0","text":"<pre><code>-- \u8981\u7d20\u3092\u672b\u5c3e\u306b\u8ffd\u52a0\uff08\u65b0\u3057\u3044\u30ea\u30b9\u30c8\u3092\u8fd4\u3059\uff09\nappended :: [a] -&gt; a -&gt; [a]\nappended xs x = xs ++ [x]\n\n-- \u4f7f\u7528\u4f8b\nlet appleBook      = [\"Apple\", \"Book\"]\nlet appleBookMango = appended appleBook \"Mango\"\n\n-- appleBook \u306f [\"Apple\", \"Book\"] \u306e\u307e\u307e\uff08\u5909\u308f\u3089\u306a\u3044\uff09\n-- appleBookMango \u306f [\"Apple\", \"Book\", \"Mango\"]\n</code></pre>"},{"location":"haskell/part-2/#slice-","title":"slice - \u30ea\u30b9\u30c8\u306e\u5207\u308a\u51fa\u3057","text":"<pre><code>-- \u30ea\u30b9\u30c8\u306e\u4e00\u90e8\u3092\u5207\u308a\u51fa\u3059\uff08start &lt;= index &lt; end\uff09\nslice :: Int -&gt; Int -&gt; [a] -&gt; [a]\nslice start end xs = take (end - start) $ drop start xs\n\n-- \u6700\u521d\u306e2\u8981\u7d20\u3092\u53d6\u5f97\nfirstTwo :: [a] -&gt; [a]\nfirstTwo = take 2\n\n-- \u6700\u5f8c\u306e2\u8981\u7d20\u3092\u53d6\u5f97\nlastTwo :: [a] -&gt; [a]\nlastTwo xs = drop (length xs - 2) xs\n\n-- \u4f7f\u7528\u4f8b\nfirstTwo [\"a\", \"b\", \"c\"]  -- [\"a\", \"b\"]\nlastTwo [\"a\", \"b\", \"c\"]   -- [\"b\", \"c\"]\nslice 1 3 [\"a\",\"b\",\"c\",\"d\"]  -- [\"b\", \"c\"]\n</code></pre>"},{"location":"haskell/part-2/#33","title":"3.3 \u30ea\u30b9\u30c8\u306e\u5909\u63db\u4f8b","text":"<pre><code>-- \u6700\u521d\u306e2\u8981\u7d20\u3092\u672b\u5c3e\u306b\u79fb\u52d5\nmovedFirstTwoToTheEnd :: [a] -&gt; [a]\nmovedFirstTwoToTheEnd xs =\n    let first = take 2 xs\n        rest  = drop 2 xs\n    in rest ++ first\n\n-- \u4f7f\u7528\u4f8b\nmovedFirstTwoToTheEnd [\"a\",\"b\",\"c\"]  -- [\"c\",\"a\",\"b\"]\n\n-- \u4e2d\u592e\u306b\u8981\u7d20\u3092\u633f\u5165\ninsertAtMiddle :: [a] -&gt; a -&gt; [a]\ninsertAtMiddle xs element =\n    let middle = length xs `div` 2\n        before = take middle xs\n        after  = drop middle xs\n    in before ++ [element] ++ after\n\n-- \u4f7f\u7528\u4f8b\ninsertAtMiddle [\"a\",\"b\",\"c\",\"d\"] \"X\"  -- [\"a\",\"b\",\"X\",\"c\",\"d\"]\n</code></pre>"},{"location":"haskell/part-2/#34","title":"3.4 \u65c5\u7a0b\u306e\u518d\u8a08\u753b","text":"<p>\u65c5\u884c\u306e\u8a08\u753b\u5909\u66f4\u3092\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306b\u884c\u3046\u4f8b\u3067\u3059\u3002</p> <pre><code>-- \u65c5\u7a0b\u3092\u518d\u8a08\u753b\u3059\u308b\uff08\u6307\u5b9a\u90fd\u5e02\u306e\u524d\u306b\u65b0\u90fd\u5e02\u3092\u633f\u5165\uff09\nreplan :: [String] -&gt; String -&gt; String -&gt; [String]\nreplan plan newCity beforeCity =\n    let beforeCityIndex = findIndex beforeCity plan\n        citiesBefore    = take beforeCityIndex plan\n        citiesAfter     = drop beforeCityIndex plan\n    in citiesBefore ++ [newCity] ++ citiesAfter\n\n-- \u4f7f\u7528\u4f8b\nlet planA = [\"Paris\", \"Berlin\", \"Krakow\"]\nlet planB = replan planA \"Vienna\" \"Krakow\"\n\n-- planA \u306f [\"Paris\", \"Berlin\", \"Krakow\"] \u306e\u307e\u307e\uff01\n-- planB \u306f [\"Paris\", \"Berlin\", \"Vienna\", \"Krakow\"]\n</code></pre> <p></p>"},{"location":"haskell/part-2/#35","title":"3.5 \u540d\u524d\u306e\u7701\u7565","text":"<pre><code>-- \u540d\u524d\u3092\u7701\u7565\u5f62\u306b\u3059\u308b\nabbreviate :: String -&gt; String\nabbreviate name =\n    let initial   = take 1 name\n        separator = findSpaceIndex name\n        lastName  = drop (separator + 1) name\n    in initial ++ \". \" ++ lastName\n\n-- \u4f7f\u7528\u4f8b\nabbreviate \"Alonzo Church\"  -- \"A. Church\"\nabbreviate \"Haskell Curry\"  -- \"H. Curry\"\n</code></pre>"},{"location":"haskell/part-2/#4","title":"\u7b2c4\u7ae0: \u95a2\u6570\u3092\u5024\u3068\u3057\u3066\u6271\u3046","text":""},{"location":"haskell/part-2/#41","title":"4.1 \u9ad8\u968e\u95a2\u6570\u3068\u306f","text":"<p>\u9ad8\u968e\u95a2\u6570\uff08Higher-Order Function\uff09\u3068\u306f\u3001\u4ee5\u4e0b\u306e\u3044\u305a\u308c\u304b\u3092\u6e80\u305f\u3059\u95a2\u6570\u3067\u3059:</p> <ol> <li>\u95a2\u6570\u3092\u5f15\u6570\u3068\u3057\u3066\u53d7\u3051\u53d6\u308b</li> <li>\u95a2\u6570\u3092\u623b\u308a\u5024\u3068\u3057\u3066\u8fd4\u3059</li> </ol> <p></p>"},{"location":"haskell/part-2/#42-map-","title":"4.2 map - \u5404\u8981\u7d20\u3092\u5909\u63db","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/haskell/src/Ch04/FunctionsAsValues.hs</code></p> <pre><code>-- map \u306e\u5b9f\u88c5\nmyMap :: (a -&gt; b) -&gt; [a] -&gt; [b]\nmyMap _ []     = []\nmyMap f (x:xs) = f x : myMap f xs\n\n-- \u4f7f\u7528\u4f8b\nmap (+1) [1, 2, 3]        -- [2, 3, 4]\nmap length [\"scala\", \"rust\", \"ada\"]  -- [5, 4, 3]\nmap (*2) [5, 1, 2, 4, 0]  -- [10, 2, 4, 8, 0]\n</code></pre> <p></p>"},{"location":"haskell/part-2/#43-filter-","title":"4.3 filter - \u6761\u4ef6\u306b\u5408\u3046\u8981\u7d20\u3092\u62bd\u51fa","text":"<pre><code>-- filter \u306e\u5b9f\u88c5\nmyFilter :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\nmyFilter _ []     = []\nmyFilter p (x:xs)\n    | p x       = x : myFilter p xs\n    | otherwise = myFilter p xs\n\n-- \u4f7f\u7528\u4f8b\nfilter odd [5, 1, 2, 4, 0]   -- [5, 1]\nfilter (&gt; 4) [5, 1, 2, 4, 0] -- [5]\nfilter even [1, 2, 3, 4, 5, 6] -- [2, 4, 6]\n</code></pre>"},{"location":"haskell/part-2/#44-foldl-","title":"4.4 foldl - \u7573\u307f\u8fbc\u307f","text":"<pre><code>-- foldl \u306e\u5b9f\u88c5\nmyFoldl :: (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b\nmyFoldl _ acc []     = acc\nmyFoldl f acc (x:xs) = myFoldl f (f acc x) xs\n\n-- \u4f7f\u7528\u4f8b\nfoldl (+) 0 [5, 1, 2, 4, 100]  -- 112\nfoldl max minBound [5, 1, 2, 4, 15]  -- 15\nfoldl (*) 1 [1, 2, 3, 4, 5]  -- 120 (\u968e\u4e57)\n</code></pre>"},{"location":"haskell/part-2/#45","title":"4.5 \u30ef\u30fc\u30c9\u30b9\u30b3\u30a2\u30ea\u30f3\u30b0\u306e\u4f8b","text":"<p>\u8907\u6570\u306e\u30b9\u30b3\u30a2\u30ea\u30f3\u30b0\u30ed\u30b8\u30c3\u30af\u3092\u7d44\u307f\u5408\u308f\u305b\u308b\u4f8b\u3067\u3059\u3002</p> <pre><code>-- 'a' \u3092\u9664\u3044\u305f\u6587\u5b57\u6570\u3092\u30b9\u30b3\u30a2\u3068\u3057\u3066\u8a08\u7b97\nscore :: String -&gt; Int\nscore word = length $ filter (/= 'a') word\n\n-- 'c' \u3092\u542b\u3080\u5834\u5408\u306e\u30dc\u30fc\u30ca\u30b9\nbonus :: String -&gt; Int\nbonus word = if 'c' `elem` word then 5 else 0\n\n-- 's' \u3092\u542b\u3080\u5834\u5408\u306e\u30da\u30ca\u30eb\u30c6\u30a3\npenalty :: String -&gt; Int\npenalty word = if 's' `elem` word then 7 else 0\n\n-- \u30b9\u30b3\u30a2\u95a2\u6570\u3092\u4f7f\u3063\u3066\u5358\u8a9e\u3092\u30e9\u30f3\u30ad\u30f3\u30b0\nrankedWords :: (String -&gt; Int) -&gt; [String] -&gt; [String]\nrankedWords wordScore words =\n    reverse $ sortBy (comparing wordScore) words\n\n-- \u4f7f\u7528\u4f8b\nlet words = [\"ada\", \"haskell\", \"scala\", \"java\", \"rust\"]\n\n-- \u57fa\u672c\u30b9\u30b3\u30a2\u3067\u30e9\u30f3\u30ad\u30f3\u30b0\nrankedWords score words\n-- [\"haskell\", \"rust\", \"scala\", \"java\", \"ada\"]\n\n-- \u30dc\u30fc\u30ca\u30b9\u4ed8\u304d\u30b9\u30b3\u30a2\u3067\u30e9\u30f3\u30ad\u30f3\u30b0\nrankedWords (\\w -&gt; score w + bonus w) words\n-- [\"scala\", \"haskell\", \"rust\", \"java\", \"ada\"]\n\n-- \u30dc\u30fc\u30ca\u30b9\u3068\u30da\u30ca\u30eb\u30c6\u30a3\u4ed8\u304d\u30b9\u30b3\u30a2\u3067\u30e9\u30f3\u30ad\u30f3\u30b0\nrankedWords (\\w -&gt; score w + bonus w - penalty w) words\n-- [\"java\", \"scala\", \"ada\", \"haskell\", \"rust\"]\n</code></pre>"},{"location":"haskell/part-2/#46","title":"4.6 \u95a2\u6570\u3092\u8fd4\u3059\u95a2\u6570","text":"<pre><code>-- n \u3088\u308a\u5927\u304d\u3044\u304b\u3092\u5224\u5b9a\u3059\u308b\u95a2\u6570\u3092\u8fd4\u3059\nlargerThan :: Int -&gt; (Int -&gt; Bool)\nlargerThan n = \\i -&gt; i &gt; n\n\n-- \u4f7f\u7528\u4f8b\nfilter (largerThan 4) [5, 1, 2, 4, 0]  -- [5]\nfilter (largerThan 1) [5, 1, 2, 4, 0]  -- [5, 2, 4]\n\n-- n \u3067\u5272\u308a\u5207\u308c\u308b\u304b\u3092\u5224\u5b9a\u3059\u308b\u95a2\u6570\u3092\u8fd4\u3059\ndivisibleBy :: Int -&gt; (Int -&gt; Bool)\ndivisibleBy n = \\i -&gt; i `mod` n == 0\n\n-- \u4f7f\u7528\u4f8b\nfilter (divisibleBy 3) [1, 2, 3, 6, 9, 10]  -- [3, 6, 9]\n</code></pre>"},{"location":"haskell/part-2/#47","title":"4.7 \u30ab\u30ea\u30fc\u5316","text":"<p>Haskell \u3067\u306f\u3001\u3059\u3079\u3066\u306e\u95a2\u6570\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u30ab\u30ea\u30fc\u5316\u3055\u308c\u3066\u3044\u307e\u3059\u3002</p> <pre><code>-- Haskell \u306e\u95a2\u6570\u306f\u81ea\u52d5\u7684\u306b\u30ab\u30ea\u30fc\u5316\u3055\u308c\u308b\naddCurried :: Int -&gt; Int -&gt; Int\naddCurried a b = a + b\n\n-- \u90e8\u5206\u9069\u7528\nlet add5 = addCurried 5\nadd5 3   -- 8\nadd5 10  -- 15\n\n-- 3\u5f15\u6570\u306e\u95a2\u6570\u3082\u540c\u69d8\nmultiply3 :: Int -&gt; Int -&gt; Int -&gt; Int\nmultiply3 a b c = a * b * c\n\nlet double = multiply3 2 1\ndouble 5  -- 10\ndouble 7  -- 14\n</code></pre> <p></p>"},{"location":"haskell/part-2/#48","title":"4.8 \u30ec\u30b3\u30fc\u30c9\u578b\u3068\u30d1\u30bf\u30fc\u30f3","text":"<pre><code>-- \u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u8a00\u8a9e\u3092\u8868\u3059\u30c7\u30fc\u30bf\u578b\ndata ProgrammingLanguage = ProgrammingLanguage\n    { plName :: String\n    , plYear :: Int\n    } deriving (Show, Eq)\n\nlet java    = ProgrammingLanguage \"Java\" 1995\nlet scala   = ProgrammingLanguage \"Scala\" 2004\nlet haskell = ProgrammingLanguage \"Haskell\" 1990\nlet langs = [java, scala, haskell]\n\n-- \u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u30a2\u30af\u30bb\u30b9\nmap plName langs  -- [\"Java\", \"Scala\", \"Haskell\"]\n\n-- \u6761\u4ef6\u3067\u30d5\u30a3\u30eb\u30bf\nfilter (\\lang -&gt; plYear lang &gt; 2000) langs\n-- [ProgrammingLanguage \"Scala\" 2004]\n\n-- \u5e74\u3067\u30bd\u30fc\u30c8\nsortBy (comparing plYear) langs\n-- [Haskell, Java, Scala]\n</code></pre>"},{"location":"haskell/part-2/#5-concatmap","title":"\u7b2c5\u7ae0: concatMap \u3068\u30cd\u30b9\u30c8\u69cb\u9020","text":""},{"location":"haskell/part-2/#51-concat-concatmap","title":"5.1 concat \u3068 concatMap","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/haskell/src/Ch05/SequentialPrograms.hs</code></p>"},{"location":"haskell/part-2/#concat-","title":"concat - \u30cd\u30b9\u30c8\u3057\u305f\u30ea\u30b9\u30c8\u3092\u5e73\u5766\u5316","text":"<pre><code>-- concat \u306e\u52d5\u4f5c\nconcat [[1, 2], [3], [4, 5, 6]]  -- [1, 2, 3, 4, 5, 6]\nconcat [[\"A\", \"B\"], [\"C\"]]       -- [\"A\", \"B\", \"C\"]\n</code></pre>"},{"location":"haskell/part-2/#concatmap-map-concat-flatmap","title":"concatMap = map + concat\uff08= flatMap\uff09","text":"<pre><code>-- concatMap \u306e\u52d5\u4f5c\n-- Scala \u306e flatMap \u306b\u76f8\u5f53\nconcatMap (\\x -&gt; [x, x + 10]) [1, 2, 3]\n-- [1, 11, 2, 12, 3, 13]\n\n-- \u672c\u306e\u8457\u8005\u3092\u3059\u3079\u3066\u53d6\u5f97\ndata Book = Book { bookTitle :: String, bookAuthors :: [String] }\n\nlet books = [ Book \"FP in Scala\" [\"Chiusano\", \"Bjarnason\"]\n            , Book \"The Hobbit\" [\"Tolkien\"]\n            ]\n\n-- map \u3060\u3051\u3060\u3068\u30cd\u30b9\u30c8\u3059\u308b\nmap bookAuthors books\n-- [[\"Chiusano\", \"Bjarnason\"], [\"Tolkien\"]]\n\n-- concatMap \u3067\u5e73\u5766\u5316\nconcatMap bookAuthors books\n-- [\"Chiusano\", \"Bjarnason\", \"Tolkien\"]\n</code></pre>"},{"location":"haskell/part-2/#52-concatmap","title":"5.2 concatMap \u306b\u3088\u308b\u30ea\u30b9\u30c8\u30b5\u30a4\u30ba\u306e\u5909\u5316","text":"<pre><code>-- \u8981\u7d20\u6570\u304c\u5897\u3048\u308b\nconcatMap (\\i -&gt; [i, i + 10]) [1, 2, 3]\n-- [1, 11, 2, 12, 3, 13] - 6\u8981\u7d20\n\n-- \u8981\u7d20\u6570\u304c\u540c\u3058\nconcatMap (\\i -&gt; [i * 2]) [1, 2, 3]\n-- [2, 4, 6] - 3\u8981\u7d20\n\n-- \u8981\u7d20\u6570\u304c\u6e1b\u308b\uff08\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u52b9\u679c\uff09\nconcatMap (\\i -&gt; if even i then [i] else []) [1, 2, 3]\n-- [2] - 1\u8981\u7d20\n</code></pre>"},{"location":"haskell/part-2/#53-do","title":"5.3 do \u8a18\u6cd5","text":"<p>\u30cd\u30b9\u30c8\u3057\u305f concatMap \u306f do \u8a18\u6cd5\u3067\u8aad\u307f\u3084\u3059\u304f\u66f8\u3051\u307e\u3059\u3002</p> <pre><code>-- \u672c\u306e\u6620\u753b\u5316\u63a8\u5968\u3092\u751f\u6210\ngetRecommendations :: [Book] -&gt; [String]\ngetRecommendations books = do\n    book   &lt;- books\n    author &lt;- bookAuthors book\n    movie  &lt;- bookAdaptations author\n    return $ \"You may like \" ++ movieTitle movie ++\n             \", because you liked \" ++ author ++ \"'s \" ++ bookTitle book\n\n-- concatMap \u7248\uff08\u7b49\u4fa1\uff09\ngetRecommendations' :: [Book] -&gt; [String]\ngetRecommendations' books =\n    concatMap (\\book -&gt;\n        concatMap (\\author -&gt;\n            map (\\movie -&gt;\n                \"You may like \" ++ movieTitle movie ++\n                \", because you liked \" ++ author ++ \"'s \" ++ bookTitle book\n            ) (bookAdaptations author)\n        ) (bookAuthors book)\n    ) books\n</code></pre> <p></p>"},{"location":"haskell/part-2/#54","title":"5.4 \u5186\u5185\u306e\u70b9\u306e\u5224\u5b9a","text":"<p>do \u8a18\u6cd5\u3067\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u3082\u884c\u3046\u4f8b\u3067\u3059\u3002</p> <pre><code>data Point = Point { pointX :: Int, pointY :: Int }\n\n-- \u70b9\u304c\u6307\u5b9a\u534a\u5f84\u306e\u5186\u5185\u306b\u3042\u308b\u304b\u5224\u5b9a\nisInside :: Point -&gt; Int -&gt; Bool\nisInside point radius =\n    radius * radius &gt;= pointX point * pointX point + pointY point * pointY point\n\n-- \u5168\u7d44\u307f\u5408\u308f\u305b\u3092\u751f\u6210\nlet points   = [Point 1 1, Point 5 2]\nlet radiuses = [2, 1]\n\nallCombinations :: [Point] -&gt; [Int] -&gt; [(String, Int, Bool)]\nallCombinations points radiuses = do\n    r     &lt;- radiuses\n    point &lt;- points\n    let desc = \"Point \" ++ show (pointX point) ++ \" \" ++ show (pointY point)\n    return (desc, r, isInside point r)\n\n-- \u7d50\u679c:\n-- [(\"Point 1 1\", 2, True), (\"Point 5 2\", 2, False),\n--  (\"Point 1 1\", 1, False), (\"Point 5 2\", 1, False)]\n</code></pre>"},{"location":"haskell/part-2/#_2","title":"\u30ac\u30fc\u30c9\u5f0f\u306b\u3088\u308b\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0","text":"<pre><code>-- \u5186\u5185\u306b\u3042\u308b\u70b9\u306e\u307f\u3092\u8fd4\u3059\npointsInsideRadius :: [Point] -&gt; Int -&gt; [Point]\npointsInsideRadius points radius = do\n    point &lt;- points\n    if isInside point radius\n        then return point\n        else []\n\n-- \u4f7f\u7528\u4f8b\npointsInsideRadius [Point 1 1, Point 5 2] 2\n-- [Point 1 1]\n</code></pre>"},{"location":"haskell/part-2/#55","title":"5.5 \u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18","text":"<p>Haskell \u306b\u306f do \u8a18\u6cd5\u306e\u4ee3\u308f\u308a\u306b\u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18\u3082\u4f7f\u3048\u307e\u3059\u3002</p> <pre><code>-- do \u8a18\u6cd5\ncombinations :: [a] -&gt; [b] -&gt; [(a, b)]\ncombinations xs ys = do\n    x &lt;- xs\n    y &lt;- ys\n    return (x, y)\n\n-- \u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18\uff08\u7b49\u4fa1\uff09\ncombinations' :: [a] -&gt; [b] -&gt; [(a, b)]\ncombinations' xs ys = [(x, y) | x &lt;- xs, y &lt;- ys]\n\n-- \u30ac\u30fc\u30c9\u4ed8\u304d\u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18\nevenPairs :: [Int] -&gt; [Int] -&gt; [(Int, Int)]\nevenPairs xs ys = [(x, y) | x &lt;- xs, y &lt;- ys, even (x + y)]\n</code></pre>"},{"location":"haskell/part-2/#56","title":"5.6 \u30c7\u30ab\u30eb\u30c8\u7a4d","text":"<pre><code>-- 3\u3064\u306e\u30ea\u30b9\u30c8\u306e\u30c7\u30ab\u30eb\u30c8\u7a4d\ncartesianProduct :: [Int] -&gt; [Int] -&gt; [Int] -&gt; [Int]\ncartesianProduct xs ys zs = do\n    x &lt;- xs\n    y &lt;- ys\n    z &lt;- zs\n    return (x + y + z)\n\n-- \u4f7f\u7528\u4f8b\ncartesianProduct [1, 2] [10, 20] [100, 200]\n-- [111, 211, 121, 221, 112, 212, 122, 222]\n\n-- \u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18\u7248\ncartesianProduct' xs ys zs = [x + y + z | x &lt;- xs, y &lt;- ys, z &lt;- zs]\n</code></pre>"},{"location":"haskell/part-2/#_3","title":"\u307e\u3068\u3081","text":""},{"location":"haskell/part-2/#part-ii_1","title":"Part II \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"haskell/part-2/#_4","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"\u7ae0 \u4e3b\u8981\u6982\u5ff5 \u30ad\u30fc\u64cd\u4f5c \u7b2c3\u7ae0 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb <code>take</code>, <code>drop</code>, <code>(++)</code>, <code>slice</code> \u7b2c4\u7ae0 \u9ad8\u968e\u95a2\u6570 <code>map</code>, <code>filter</code>, <code>foldl</code>, <code>sortBy</code> \u7b2c5\u7ae0 \u5e73\u5766\u5316 <code>concat</code>, <code>concatMap</code>, <code>do</code> \u8a18\u6cd5"},{"location":"haskell/part-2/#scala","title":"Scala \u3068\u306e\u5bfe\u5fdc","text":"Scala Haskell \u8aac\u660e <code>list.appended(x)</code> <code>list ++ [x]</code> \u8981\u7d20\u8ffd\u52a0 <code>list.slice(s, e)</code> <code>take (e-s) $ drop s list</code> \u30b9\u30e9\u30a4\u30b9 <code>list.map(f)</code> <code>map f list</code> \u5909\u63db <code>list.filter(p)</code> <code>filter p list</code> \u30d5\u30a3\u30eb\u30bf <code>list.foldLeft(z)(f)</code> <code>foldl f z list</code> \u7573\u307f\u8fbc\u307f <code>list.flatten</code> <code>concat list</code> \u5e73\u5766\u5316 <code>list.flatMap(f)</code> <code>concatMap f list</code> \u5909\u63db+\u5e73\u5766\u5316 <code>for { ... } yield</code> <code>do { ... }</code> \u307e\u305f\u306f <code>[ | ]</code> \u5185\u5305\u8868\u8a18"},{"location":"haskell/part-2/#_5","title":"\u91cd\u8981\u306a\u6cd5\u5247","text":"<ol> <li>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf: Haskell \u3067\u306f\u3059\u3079\u3066\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb</li> <li>\u95a2\u6570\u306f\u5024: \u95a2\u6570\u3092\u5f15\u6570\u3068\u3057\u3066\u6e21\u3057\u305f\u308a\u3001\u623b\u308a\u5024\u3068\u3057\u3066\u8fd4\u3057\u305f\u308a\u3067\u304d\u308b</li> <li>\u81ea\u52d5\u30ab\u30ea\u30fc\u5316: Haskell \u306e\u3059\u3079\u3066\u306e\u95a2\u6570\u306f\u81ea\u52d5\u7684\u306b\u30ab\u30ea\u30fc\u5316\u3055\u308c\u308b</li> <li>concatMap \u30d1\u30bf\u30fc\u30f3: \u30cd\u30b9\u30c8\u3057\u305f\u69cb\u9020\u3092\u5e73\u5766\u5316\u3057\u306a\u304c\u3089\u5909\u63db\u3059\u308b</li> <li>do \u8a18\u6cd5: concatMap/map \u306e\u7cd6\u8863\u69cb\u6587\u3068\u3057\u3066\u4f7f\u3048\u308b</li> </ol>"},{"location":"haskell/part-2/#_6","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part III \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li><code>Maybe</code> \u578b\u306b\u3088\u308b\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0</li> <li><code>Either</code> \u578b\u3068\u8907\u5408\u7684\u306a\u30a8\u30e9\u30fc\u51e6\u7406</li> </ul>"},{"location":"haskell/part-2/#_7","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"haskell/part-2/#1","title":"\u554f\u984c 1: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u64cd\u4f5c","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u30ea\u30b9\u30c8\u306e\u4e2d\u592e\u306b\u8981\u7d20\u3092\u633f\u5165\u3059\u308b\u95a2\u6570\u3067\u3059\u3002</p> <pre><code>insertAtMiddle :: [a] -&gt; a -&gt; [a]\ninsertAtMiddle = ???\n\n-- \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\ninsertAtMiddle [\"a\",\"b\",\"c\",\"d\"] \"X\" == [\"a\",\"b\",\"X\",\"c\",\"d\"]\ninsertAtMiddle [\"a\",\"b\"] \"X\" == [\"a\",\"X\",\"b\"]\n</code></pre> \u89e3\u7b54 <pre><code>insertAtMiddle :: [a] -&gt; a -&gt; [a]\ninsertAtMiddle xs element =\n    let middle = length xs `div` 2\n        before = take middle xs\n        after  = drop middle xs\n    in before ++ [element] ++ after\n</code></pre>"},{"location":"haskell/part-2/#2","title":"\u554f\u984c 2: \u9ad8\u968e\u95a2\u6570","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u6761\u4ef6\u3092\u6e80\u305f\u3059\u8981\u7d20\u306e\u6570\u3092\u30ab\u30a6\u30f3\u30c8\u3059\u308b\u95a2\u6570\u3067\u3059\u3002</p> <pre><code>countWhere :: (a -&gt; Bool) -&gt; [a] -&gt; Int\ncountWhere = ???\n\n-- \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\ncountWhere (&gt; 3) [1, 2, 3, 4, 5] == 2\ncountWhere (\\s -&gt; length s &gt; 1) [\"a\", \"bb\", \"ccc\"] == 2\n</code></pre> \u89e3\u7b54 <pre><code>countWhere :: (a -&gt; Bool) -&gt; [a] -&gt; Int\ncountWhere p xs = length $ filter p xs\n\n-- \u307e\u305f\u306f foldl \u3092\u4f7f\u3063\u3066\ncountWhere' :: (a -&gt; Bool) -&gt; [a] -&gt; Int\ncountWhere' p = foldl (\\count elem -&gt; if p elem then count + 1 else count) 0\n</code></pre>"},{"location":"haskell/part-2/#3-do","title":"\u554f\u984c 3: do \u8a18\u6cd5","text":"<p>\u4ee5\u4e0b\u306e\u30cd\u30b9\u30c8\u3057\u305f concatMap \u3092 do \u8a18\u6cd5\u3067\u66f8\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>result = concatMap (\\x -&gt;\n    concatMap (\\y -&gt;\n        map (\\z -&gt;\n            x + y + z\n        ) [100, 200]\n    ) [10, 20]\n) [1, 2]\n</code></pre> \u89e3\u7b54 <pre><code>result = do\n    x &lt;- [1, 2]\n    y &lt;- [10, 20]\n    z &lt;- [100, 200]\n    return (x + y + z)\n\n-- \u307e\u305f\u306f\u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18\nresult' = [x + y + z | x &lt;- [1, 2], y &lt;- [10, 20], z &lt;- [100, 200]]\n\n-- \u7d50\u679c: [111, 211, 121, 221, 112, 212, 122, 222]\n</code></pre>"},{"location":"haskell/part-2/#4-concatmap","title":"\u554f\u984c 4: concatMap \u306b\u3088\u308b\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0","text":"<p>do \u8a18\u6cd5\u306e <code>if</code> \u3092\u4f7f\u308f\u305a\u306b\u3001concatMap \u3060\u3051\u3067\u5076\u6570\u306e\u307f\u3092\u62bd\u51fa\u3059\u308b\u30b3\u30fc\u30c9\u3092\u66f8\u3044\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>numbers = [1, 2, 3, 4, 5, 6]\n-- \u5076\u6570\u306e\u307f\u3092\u62bd\u51fa: [2, 4, 6]\n</code></pre> \u89e3\u7b54 <pre><code>evenNumbers = concatMap (\\n -&gt; if even n then [n] else []) numbers\n\n-- \u307e\u305f\u306f\u95a2\u6570\u306b\u5206\u96e2\nevenFilter :: Int -&gt; [Int]\nevenFilter n = if even n then [n] else []\n\nevenNumbers' = concatMap evenFilter numbers\n</code></pre>"},{"location":"haskell/part-3/","title":"Part III: \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3068 Maybe/Either","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3092 Haskell \u3067\u5b66\u3073\u307e\u3059\u3002<code>null</code> \u3084\u4f8b\u5916\u306b\u983c\u3089\u305a\u3001<code>Maybe</code> \u3068 <code>Either</code> \u3092\u4f7f\u3063\u3066\u578b\u5b89\u5168\u306b\u30a8\u30e9\u30fc\u3092\u6271\u3046\u65b9\u6cd5\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"haskell/part-3/#6-maybe","title":"\u7b2c6\u7ae0: Maybe \u578b\u306b\u3088\u308b\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":""},{"location":"haskell/part-3/#61-maybe","title":"6.1 \u306a\u305c Maybe \u304c\u5fc5\u8981\u304b","text":"<p>\u5f93\u6765\u306e\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u306b\u306f\u554f\u984c\u304c\u3042\u308a\u307e\u3059\u3002</p> <p></p> <p>Haskell \u306b\u306f null \u304c\u5b58\u5728\u3057\u307e\u305b\u3093\u3002 \u5024\u304c\u300c\u306a\u3044\u300d\u53ef\u80fd\u6027\u306f <code>Maybe</code> \u578b\u3067\u660e\u793a\u7684\u306b\u8868\u73fe\u3057\u307e\u3059\u3002</p>"},{"location":"haskell/part-3/#62-maybe","title":"6.2 Maybe \u306e\u57fa\u672c","text":"<p><code>Maybe a</code> \u306f\u300c<code>a</code> \u578b\u306e\u5024\u304c\u3042\u308b\u304b\u3001\u306a\u3044\u304b\u300d\u3092\u8868\u3059\u578b\u3067\u3059\u3002</p> <p></p> <pre><code>data Maybe a = Nothing | Just a\n\n-- \u4f7f\u7528\u4f8b\nJust 5    :: Maybe Int     -- \u5024\u304c\u3042\u308b\nNothing   :: Maybe Int     -- \u5024\u304c\u306a\u3044\nJust \"Hi\" :: Maybe String  -- \u6587\u5b57\u5217\u304c\u3042\u308b\n</code></pre> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/haskell/src/Ch06/MaybeHandling.hs</code></p>"},{"location":"haskell/part-3/#63-tv","title":"6.3 TV\u756a\u7d44\u306e\u30d1\u30fc\u30b9\u4f8b","text":"<p>TV\u756a\u7d44\u306e\u6587\u5b57\u5217\u3092\u30d1\u30fc\u30b9\u3059\u308b\u4f8b\u3067 Maybe \u306e\u4f7f\u3044\u65b9\u3092\u5b66\u3073\u307e\u3059\u3002</p> <pre><code>data TvShow = TvShow\n    { tvTitle     :: String\n    , tvStartYear :: Int\n    , tvEndYear   :: Int\n    } deriving (Show, Eq)\n\n-- \u5165\u529b\u4f8b: \"Breaking Bad (2008-2013)\"\n-- \u671f\u5f85\u3059\u308b\u51fa\u529b: TvShow \"Breaking Bad\" 2008 2013\n</code></pre>"},{"location":"haskell/part-3/#_1","title":"\u5b89\u5168\u3067\u306a\u3044\u5b9f\u88c5\uff08\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u306e\u5931\u6557\uff09","text":"<pre><code>parseShow :: String -&gt; TvShow\nparseShow rawShow =\n    let Just name      = extractName rawShow      -- \u5371\u967a\uff01\n        Just yearStart = extractYearStart rawShow -- \u5371\u967a\uff01\n        Just yearEnd   = extractYearEnd rawShow   -- \u5371\u967a\uff01\n    in TvShow name yearStart yearEnd\n\n-- \u6b63\u5e38\u30b1\u30fc\u30b9\nparseShow \"Breaking Bad (2008-2013)\"  -- TvShow \"Breaking Bad\" 2008 2013\n\n-- \u7570\u5e38\u30b1\u30fc\u30b9 \u2192 \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u5931\u6557\u3067\u4f8b\u5916\uff01\nparseShow \"Invalid\"  -- *** Exception: ...\n</code></pre>"},{"location":"haskell/part-3/#maybe","title":"Maybe \u3092\u4f7f\u3063\u305f\u5b89\u5168\u306a\u5b9f\u88c5","text":"<pre><code>parseShowSafe :: String -&gt; Maybe TvShow\nparseShowSafe rawShow = do\n    name      &lt;- extractName rawShow\n    yearStart &lt;- extractYearStart rawShow `orElse` extractSingleYear rawShow\n    yearEnd   &lt;- extractYearEnd rawShow `orElse` extractSingleYear rawShow\n    return $ TvShow name yearStart yearEnd\n\n-- \u6b63\u5e38\u30b1\u30fc\u30b9\nparseShowSafe \"Breaking Bad (2008-2013)\"\n-- Just (TvShow \"Breaking Bad\" 2008 2013)\n\n-- \u7570\u5e38\u30b1\u30fc\u30b9 \u2192 Nothing \u304c\u8fd4\u3055\u308c\u308b\uff08\u4f8b\u5916\u306a\u3057\uff09\nparseShowSafe \"Invalid\"\n-- Nothing\n</code></pre>"},{"location":"haskell/part-3/#64","title":"6.4 \u5c0f\u3055\u306a\u95a2\u6570\u304b\u3089\u7d44\u307f\u7acb\u3066\u308b","text":"<p>\u8907\u96d1\u306a\u30d1\u30fc\u30b9\u51e6\u7406\u3092\u5c0f\u3055\u306a\u95a2\u6570\u306b\u5206\u89e3\u3057\u307e\u3059\u3002</p> <pre><code>-- \u540d\u524d\u3092\u62bd\u51fa\nextractName :: String -&gt; Maybe String\nextractName rawShow =\n    let bracketOpen = elemIndex '(' rawShow\n    in case bracketOpen of\n        Just idx | idx &gt; 0 -&gt; Just $ trim $ take idx rawShow\n        _                  -&gt; Nothing\n\n-- \u958b\u59cb\u5e74\u3092\u62bd\u51fa\nextractYearStart :: String -&gt; Maybe Int\nextractYearStart rawShow = do\n    bracketOpen &lt;- elemIndex '(' rawShow\n    dash        &lt;- elemIndex '-' rawShow\n    if dash &gt; bracketOpen + 1\n        then readMaybe $ take (dash - bracketOpen - 1) $ drop (bracketOpen + 1) rawShow\n        else Nothing\n\n-- \u7d42\u4e86\u5e74\u3092\u62bd\u51fa\nextractYearEnd :: String -&gt; Maybe Int\nextractYearEnd rawShow = do\n    dash         &lt;- elemIndex '-' rawShow\n    bracketClose &lt;- elemIndex ')' rawShow\n    if bracketClose &gt; dash + 1\n        then readMaybe $ take (bracketClose - dash - 1) $ drop (dash + 1) rawShow\n        else Nothing\n</code></pre> <p></p>"},{"location":"haskell/part-3/#65-orelse","title":"6.5 orElse \u306b\u3088\u308b\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af","text":"<p><code>orElse</code> \u3092\u4f7f\u3063\u3066\u3001\u6700\u521d\u306e Maybe \u304c <code>Nothing</code> \u306e\u5834\u5408\u306b\u4ee3\u66ff\u3092\u8a66\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>-- orElse \u306e\u5b9f\u88c5\norElse :: Maybe a -&gt; Maybe a -&gt; Maybe a\norElse (Just x) _ = Just x\norElse Nothing  y = y\n\n-- \u4f7f\u7528\u4f8b\nJust 7 `orElse` Just 8   -- Just 7 (\u6700\u521d\u304c Just \u306a\u306e\u3067\u305d\u306e\u307e\u307e)\nNothing `orElse` Just 8  -- Just 8 (\u6700\u521d\u304c Nothing \u306a\u306e\u3067\u4ee3\u66ff\u3092\u4f7f\u7528)\nJust 7 `orElse` Nothing  -- Just 7\nNothing `orElse` Nothing -- Nothing\n</code></pre>"},{"location":"haskell/part-3/#_2","title":"\u5358\u5e74\u306e\u756a\u7d44\u306b\u5bfe\u5fdc\u3059\u308b","text":"<p>\u300cChernobyl (2019)\u300d\u306e\u3088\u3046\u306a\u5358\u5e74\u306e\u756a\u7d44\u3092\u30d1\u30fc\u30b9\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002</p> <pre><code>extractSingleYear :: String -&gt; Maybe Int\nextractSingleYear rawShow =\n    case (elemIndex '-' rawShow, elemIndex '(' rawShow, elemIndex ')' rawShow) of\n        (Nothing, Just bo, Just bc) | bc &gt; bo + 1 -&gt;\n            readMaybe $ take (bc - bo - 1) $ drop (bo + 1) rawShow\n        _ -&gt; Nothing\n\nparseShowSafe :: String -&gt; Maybe TvShow\nparseShowSafe rawShow = do\n    name      &lt;- extractName rawShow\n    yearStart &lt;- extractYearStart rawShow `orElse` extractSingleYear rawShow\n    yearEnd   &lt;- extractYearEnd rawShow `orElse` extractSingleYear rawShow\n    return $ TvShow name yearStart yearEnd\n\n-- \u3053\u308c\u3067\u5358\u5e74\u306e\u756a\u7d44\u3082\u30d1\u30fc\u30b9\u3067\u304d\u308b\nparseShowSafe \"Chernobyl (2019)\"\n-- Just (TvShow \"Chernobyl\" 2019 2019)\n</code></pre> <p></p>"},{"location":"haskell/part-3/#66-maybe","title":"6.6 Maybe \u306e\u4e3b\u8981\u95a2\u6570","text":"\u95a2\u6570 \u8aac\u660e \u4f8b <code>fmap</code> / <code>&lt;$&gt;</code> \u5024\u304c\u3042\u308c\u3070\u5909\u63db <code>fmap (*2) (Just 5)</code> \u2192 <code>Just 10</code> <code>&gt;&gt;=</code> Maybe \u3092\u8fd4\u3059\u95a2\u6570\u3092\u9069\u7528 <code>Just 5 &gt;&gt;= \\x -&gt; Just (x * 2)</code> \u2192 <code>Just 10</code> <code>&lt;\\|&gt;</code> Nothing \u306a\u3089\u4ee3\u66ff\u3092\u4f7f\u7528 <code>Nothing &lt;\\|&gt; Just 5</code> \u2192 <code>Just 5</code> <code>fromMaybe</code> Nothing \u306a\u3089\u30c7\u30d5\u30a9\u30eb\u30c8\u5024 <code>fromMaybe 0 Nothing</code> \u2192 <code>0</code> <code>maybeToList</code> List \u306b\u5909\u63db <code>maybeToList (Just 5)</code> \u2192 <code>[5]</code> <code>catMaybes</code> Just \u3060\u3051\u62bd\u51fa <code>catMaybes [Just 1, Nothing, Just 3]</code> \u2192 <code>[1,3]</code> <pre><code>import Data.Maybe\n\nlet year   = Just 996\nlet noYear = Nothing :: Maybe Int\n\n-- fmap / &lt;$&gt;\nfmap (*2) year     -- Just 1992\nfmap (*2) noYear   -- Nothing\n(*2) &lt;$&gt; year      -- Just 1992\n\n-- &gt;&gt;= (bind)\nyear &gt;&gt;= \\y -&gt; Just (y * 2)    -- Just 1992\nnoYear &gt;&gt;= \\y -&gt; Just (y * 2)  -- Nothing\n\n-- &lt;|&gt; (Alternative)\nimport Control.Applicative\nyear &lt;|&gt; Just 2020     -- Just 996\nnoYear &lt;|&gt; Just 2020   -- Just 2020\n\n-- fromMaybe\nfromMaybe 0 year    -- 996\nfromMaybe 0 noYear  -- 0\n</code></pre>"},{"location":"haskell/part-3/#67","title":"6.7 \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u6226\u7565","text":"<p>\u8907\u6570\u306e\u8981\u7d20\u3092\u30d1\u30fc\u30b9\u3059\u308b\u5834\u5408\u30012\u3064\u306e\u6226\u7565\u304c\u3042\u308a\u307e\u3059\u3002</p> <p></p>"},{"location":"haskell/part-3/#best-effort","title":"Best-effort \u6226\u7565","text":"<pre><code>parseShowsBestEffort :: [String] -&gt; [TvShow]\nparseShowsBestEffort rawShows =\n    concatMap (maybe [] (:[]) . parseShowSafe) rawShows\n\n-- \u307e\u305f\u306f catMaybes \u3092\u4f7f\u7528\nparseShowsBestEffort' :: [String] -&gt; [TvShow]\nparseShowsBestEffort' = catMaybes . map parseShowSafe\n\nlet rawShows = [ \"Breaking Bad (2008-2013)\"\n               , \"Invalid Format\"\n               , \"Mad Men (2007-2015)\"\n               ]\n\nparseShowsBestEffort rawShows\n-- [TvShow \"Breaking Bad\" 2008 2013, TvShow \"Mad Men\" 2007 2015]\n-- \u7121\u52b9\u306a\u3082\u306e\u306f\u7121\u8996\u3055\u308c\u308b\n</code></pre>"},{"location":"haskell/part-3/#all-or-nothing","title":"All-or-nothing \u6226\u7565","text":"<pre><code>parseShowsAllOrNothing :: [String] -&gt; Maybe [TvShow]\nparseShowsAllOrNothing = traverse parseShowSafe\n\n-- \u5168\u90e8\u6210\u529f \u2192 Just [...]\nparseShowsAllOrNothing [\"Breaking Bad (2008-2013)\", \"Mad Men (2007-2015)\"]\n-- Just [TvShow \"Breaking Bad\" 2008 2013, TvShow \"Mad Men\" 2007 2015]\n\n-- \u4e00\u3064\u3067\u3082\u5931\u6557 \u2192 Nothing\nparseShowsAllOrNothing [\"Breaking Bad (2008-2013)\", \"Invalid\"]\n-- Nothing\n</code></pre>"},{"location":"haskell/part-3/#7-either","title":"\u7b2c7\u7ae0: Either \u578b\u3068\u8907\u5408\u7684\u306a\u30a8\u30e9\u30fc\u51e6\u7406","text":""},{"location":"haskell/part-3/#71-maybe","title":"7.1 Maybe \u306e\u9650\u754c","text":"<p><code>Maybe</code> \u306f\u300c\u5024\u304c\u3042\u308b\u304b\u306a\u3044\u304b\u300d\u3057\u304b\u8868\u73fe\u3067\u304d\u307e\u305b\u3093\u3002\u306a\u305c\u5931\u6557\u3057\u305f\u306e\u304b\u3092\u4f1d\u3048\u3089\u308c\u307e\u305b\u3093\u3002</p> <p></p>"},{"location":"haskell/part-3/#72-either","title":"7.2 Either \u306e\u57fa\u672c","text":"<p><code>Either e a</code> \u306f\u300c<code>e</code> \u578b\u306e\u30a8\u30e9\u30fc\u304b\u3001<code>a</code> \u578b\u306e\u6210\u529f\u5024\u304b\u300d\u3092\u8868\u3059\u578b\u3067\u3059\u3002</p> <ul> <li><code>Right value</code>: \u6210\u529f\uff08\u6163\u4f8b\u7684\u306b\u300c\u6b63\u3057\u3044\u300d= right\uff09</li> <li><code>Left error</code>: \u5931\u6557\uff08\u30a8\u30e9\u30fc\u60c5\u5831\u3092\u4fdd\u6301\uff09</li> </ul> <pre><code>data Either e a = Left e | Right a\n\n-- \u4f7f\u7528\u4f8b\nRight 5     :: Either String Int  -- \u6210\u529f\nLeft \"oops\" :: Either String Int  -- \u5931\u6557\uff08\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u4ed8\u304d\uff09\n</code></pre> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/haskell/src/Ch07/EitherHandling.hs</code></p>"},{"location":"haskell/part-3/#73-either","title":"7.3 Either \u3092\u4f7f\u3063\u305f\u30d1\u30fc\u30b9","text":"<pre><code>extractNameE :: String -&gt; Either String String\nextractNameE rawShow =\n    case elemIndex '(' rawShow of\n        Just idx | idx &gt; 0 -&gt; Right $ trim $ take idx rawShow\n        _                  -&gt; Left $ \"Can't extract name from \" ++ rawShow\n\nextractNameE \"The Wire (2002-2008)\"  -- Right \"The Wire\"\nextractNameE \"(2022)\"                -- Left \"Can't extract name from (2022)\"\n</code></pre>"},{"location":"haskell/part-3/#74-either","title":"7.4 Either \u3092\u4f7f\u3063\u305f\u5b8c\u5168\u306a\u30d1\u30fc\u30b5\u30fc","text":"<pre><code>extractYearStartE :: String -&gt; Either String Int\nextractYearStartE rawShow =\n    case (elemIndex '(' rawShow, elemIndex '-' rawShow) of\n        (Just bo, Just d) | d &gt; bo + 1 -&gt;\n            let yearStr = take (d - bo - 1) $ drop (bo + 1) rawShow\n            in maybeToEither (\"Can't parse year: \" ++ yearStr) (readMaybe yearStr)\n        _ -&gt; Left $ \"Can't extract start year from \" ++ rawShow\n\nextractYearStartE \"The Wire (2002-2008)\"  -- Right 2002\nextractYearStartE \"The Wire (-2008)\"      -- Left \"Can't extract start year from ...\"\nextractYearStartE \"The Wire (oops-2008)\"  -- Left \"Can't parse year: oops\"\n</code></pre>"},{"location":"haskell/part-3/#75-maybe-either","title":"7.5 Maybe \u304b\u3089 Either \u3078\u306e\u5909\u63db","text":"<p><code>maybeToEither</code> \u3067 <code>Maybe</code> \u3092 <code>Either</code> \u306b\u5909\u63db\u3067\u304d\u307e\u3059\u3002</p> <pre><code>maybeToEither :: e -&gt; Maybe a -&gt; Either e a\nmaybeToEither _ (Just x) = Right x\nmaybeToEither e Nothing  = Left e\n\nlet year   = Just 996\nlet noYear = Nothing :: Maybe Int\n\nmaybeToEither \"no year given\" year    -- Right 996\nmaybeToEither \"no year given\" noYear  -- Left \"no year given\"\n</code></pre> <p></p>"},{"location":"haskell/part-3/#76-either","title":"7.6 Either \u306b\u3088\u308b\u5b8c\u5168\u306a\u30d1\u30fc\u30b5\u30fc","text":"<pre><code>parseShowE :: String -&gt; Either String TvShow\nparseShowE rawShow = do\n    name      &lt;- extractNameE rawShow\n    yearStart &lt;- extractYearStartE rawShow `orElseE` extractSingleYearE rawShow\n    yearEnd   &lt;- extractYearEndE rawShow `orElseE` extractSingleYearE rawShow\n    return $ TvShow name yearStart yearEnd\n\nparseShowE \"The Wire (2002-2008)\"  -- Right (TvShow \"The Wire\" 2002 2008)\nparseShowE \"Mad Men ()\"            -- Left \"Can't extract single year from Mad Men ()\"\nparseShowE \"(2002-2008)\"           -- Left \"Can't extract name from (2002-2008)\"\n</code></pre>"},{"location":"haskell/part-3/#77-either","title":"7.7 Either \u306e\u4e3b\u8981\u95a2\u6570","text":"\u95a2\u6570 \u8aac\u660e \u4f8b <code>fmap</code> / <code>&lt;$&gt;</code> Right \u306e\u5024\u3092\u5909\u63db <code>fmap (*2) (Right 5)</code> \u2192 <code>Right 10</code> <code>&gt;&gt;=</code> Right \u306a\u3089 Either \u3092\u8fd4\u3059\u95a2\u6570\u3092\u9069\u7528 <code>Right 5 &gt;&gt;= \\x -&gt; Right (x * 2)</code> \u2192 <code>Right 10</code> <code>either</code> Left/Right \u3067\u7570\u306a\u308b\u51e6\u7406 <code>either show id (Right \"ok\")</code> \u2192 <code>\"ok\"</code> <code>fromRight</code> Left \u306a\u3089\u30c7\u30d5\u30a9\u30eb\u30c8\u5024 <code>fromRight 0 (Left \"err\")</code> \u2192 <code>0</code> <code>partitionEithers</code> Left \u3068 Right \u3092\u5206\u96e2 <code>partitionEithers [Left \"e\", Right 1]</code> \u2192 <code>([\"e\"], [1])</code> <pre><code>import Data.Either\n\nlet year   = Right 996 :: Either String Int\nlet noYear = Left \"no year\" :: Either String Int\n\n-- fmap / &lt;$&gt;\nfmap (*2) year     -- Right 1992\nfmap (*2) noYear   -- Left \"no year\"\n\n-- &gt;&gt;= (bind)\nyear &gt;&gt;= \\y -&gt; Right (y * 2)              -- Right 1992\nnoYear &gt;&gt;= \\y -&gt; Right (y * 2)            -- Left \"no year\"\nyear &gt;&gt;= \\_ -&gt; Left \"can't progress\"      -- Left \"can't progress\"\n\n-- either\neither length id year    -- 996\neither length id noYear  -- 7 (\"no year\" \u306e\u9577\u3055)\n\n-- fromRight\nfromRight 0 year    -- 996\nfromRight 0 noYear  -- 0\n</code></pre>"},{"location":"haskell/part-3/#78","title":"7.8 \u97f3\u697d\u30a2\u30fc\u30c6\u30a3\u30b9\u30c8\u691c\u7d22\u306e\u4f8b","text":"<p>\u3088\u308a\u8907\u96d1\u306a\u4f8b\u3068\u3057\u3066\u3001\u97f3\u697d\u30a2\u30fc\u30c6\u30a3\u30b9\u30c8\u306e\u691c\u7d22\u6a5f\u80fd\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p>"},{"location":"haskell/part-3/#adt","title":"\u4ee3\u6570\u7684\u30c7\u30fc\u30bf\u578b\uff08ADT\uff09\u306b\u3088\u308b\u30e2\u30c7\u30ea\u30f3\u30b0","text":"<pre><code>-- \u97f3\u697d\u30b8\u30e3\u30f3\u30eb\uff08\u76f4\u548c\u578b\uff09\ndata MusicGenre\n    = HeavyMetal\n    | Pop\n    | HardRock\n    | Grunge\n    | Punk\n    deriving (Show, Eq)\n\n-- \u5834\u6240\uff08\u76f4\u548c\u578b\uff09\ndata Location\n    = USA\n    | England\n    | Australia\n    | Canada\n    deriving (Show, Eq)\n\n-- \u6d3b\u52d5\u671f\u9593\uff08\u76f4\u548c\u578b\uff09\ndata YearsActive\n    = StillActive Int           -- \u6d3b\u52d5\u4e2d\uff08\u958b\u59cb\u5e74\uff09\n    | ActiveBetween Int Int     -- \u6d3b\u52d5\u7d42\u4e86\uff08\u958b\u59cb\u5e74\u3001\u7d42\u4e86\u5e74\uff09\n    deriving (Show, Eq)\n\n-- \u30a2\u30fc\u30c6\u30a3\u30b9\u30c8\uff08\u76f4\u7a4d\u578b\uff09\ndata Artist = Artist\n    { artistName        :: String\n    , artistGenre       :: MusicGenre\n    , artistOrigin      :: Location\n    , artistYearsActive :: YearsActive\n    } deriving (Show, Eq)\n</code></pre>"},{"location":"haskell/part-3/#79","title":"7.9 \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0","text":"<p>\u76f4\u548c\u578b\u306f\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3067\u51e6\u7406\u3057\u307e\u3059\u3002</p> <pre><code>wasArtistActive :: Artist -&gt; Int -&gt; Int -&gt; Bool\nwasArtistActive artist yearStart yearEnd =\n    case artistYearsActive artist of\n        StillActive since        -&gt; since &lt;= yearEnd\n        ActiveBetween start end_ -&gt; start &lt;= yearEnd &amp;&amp; end_ &gt;= yearStart\n\nactiveLength :: Artist -&gt; Int -&gt; Int\nactiveLength artist currentYear =\n    case artistYearsActive artist of\n        StillActive since        -&gt; currentYear - since\n        ActiveBetween start end_ -&gt; end_ - start\n</code></pre> <p></p>"},{"location":"haskell/part-3/#710","title":"7.10 \u691c\u7d22\u6761\u4ef6\u306e\u30e2\u30c7\u30ea\u30f3\u30b0","text":"<p>\u691c\u7d22\u6761\u4ef6\u3082 ADT \u3067\u30e2\u30c7\u30ea\u30f3\u30b0\u3067\u304d\u307e\u3059\u3002</p> <pre><code>data SearchCondition\n    = SearchByGenre [MusicGenre]\n    | SearchByOrigin [Location]\n    | SearchByActiveYears Int Int\n    deriving (Show, Eq)\n\nsearchArtists :: [Artist] -&gt; [SearchCondition] -&gt; [Artist]\nsearchArtists artists conditions =\n    filter (satisfiesAll conditions) artists\n  where\n    satisfiesAll conds artist = all (satisfies artist) conds\n\n    satisfies artist (SearchByGenre genres) =\n        artistGenre artist `elem` genres\n    satisfies artist (SearchByOrigin locations) =\n        artistOrigin artist `elem` locations\n    satisfies artist (SearchByActiveYears start end_) =\n        wasArtistActive artist start end_\n\n-- \u4f7f\u7528\u4f8b\nlet metallica = Artist \"Metallica\" HeavyMetal USA (StillActive 1981)\nlet madonna   = Artist \"Madonna\" Pop USA (StillActive 1982)\n\nsearchArtists [metallica, madonna] [SearchByGenre [HeavyMetal]]\n-- [metallica]\n\nsearchArtists [metallica, madonna] [SearchByOrigin [USA], SearchByGenre [Pop]]\n-- [madonna]\n</code></pre>"},{"location":"haskell/part-3/#711","title":"7.11 \u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u306e\u4f8b","text":"<pre><code>validateAge :: Int -&gt; Either String Int\nvalidateAge age\n    | age &lt; 0   = Left \"Age cannot be negative\"\n    | age &gt; 150 = Left \"Age cannot be greater than 150\"\n    | otherwise = Right age\n\nvalidateEmail :: String -&gt; Either String String\nvalidateEmail email\n    | '@' `notElem` email = Left \"Email must contain @\"\n    | '.' `notElem` email = Left \"Email must contain a domain\"\n    | otherwise           = Right email\n\n-- \u7d44\u307f\u5408\u308f\u305b\nvalidateUser :: Int -&gt; String -&gt; Either String (Int, String)\nvalidateUser age email = do\n    validAge   &lt;- validateAge age\n    validEmail &lt;- validateEmail email\n    return (validAge, validEmail)\n\nvalidateUser 25 \"test@example.com\"  -- Right (25, \"test@example.com\")\nvalidateUser (-5) \"test@example.com\" -- Left \"Age cannot be negative\"\nvalidateUser 25 \"invalid\"            -- Left \"Email must contain @\"\n</code></pre>"},{"location":"haskell/part-3/#_3","title":"\u307e\u3068\u3081","text":""},{"location":"haskell/part-3/#part-iii","title":"Part III \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"haskell/part-3/#maybe-vs-either","title":"Maybe vs Either \u306e\u4f7f\u3044\u5206\u3051","text":"\u72b6\u6cc1 \u4f7f\u7528\u3059\u308b\u578b \u5024\u304c\u3042\u308b\u304b\u306a\u3044\u304b\u3060\u3051\u304c\u91cd\u8981 <code>Maybe a</code> \u5931\u6557\u7406\u7531\u3092\u4f1d\u3048\u308b\u5fc5\u8981\u304c\u3042\u308b <code>Either e a</code> \u691c\u7d22\u7d50\u679c\u304c\u898b\u3064\u304b\u3089\u306a\u3044 <code>Maybe a</code> \u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u30a8\u30e9\u30fc\u3092\u4f1d\u3048\u308b <code>Either String a</code> \u8907\u6570\u306e\u30a8\u30e9\u30fc\u7a2e\u5225\u304c\u3042\u308b <code>Either ErrorType a</code>"},{"location":"haskell/part-3/#scala","title":"Scala \u3068\u306e\u5bfe\u5fdc","text":"Scala Haskell \u8aac\u660e <code>Option[A]</code> <code>Maybe a</code> \u5024\u306e\u6709\u7121 <code>Some(x)</code> <code>Just x</code> \u5024\u304c\u3042\u308b <code>None</code> <code>Nothing</code> \u5024\u304c\u306a\u3044 <code>Either[E, A]</code> <code>Either e a</code> \u6210\u529f/\u5931\u6557 <code>Right(x)</code> <code>Right x</code> \u6210\u529f <code>Left(e)</code> <code>Left e</code> \u5931\u6557 <code>opt.getOrElse(d)</code> <code>fromMaybe d opt</code> \u30c7\u30d5\u30a9\u30eb\u30c8\u5024 <code>opt.orElse(alt)</code> <code>opt &lt;\\|&gt; alt</code> \u4ee3\u66ff <code>opt.toRight(e)</code> <code>maybeToEither e opt</code> Maybe\u2192Either"},{"location":"haskell/part-3/#_4","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>Maybe: \u5024\u306e\u6709\u7121\u3092\u578b\u3067\u8868\u73fe\u3059\u308b\uff08Haskell \u306b\u306f null \u304c\u306a\u3044\uff09</li> <li>Either: \u6210\u529f/\u5931\u6557\u3068\u30a8\u30e9\u30fc\u60c5\u5831\u3092\u578b\u3067\u8868\u73fe\u3059\u308b</li> <li>do \u8a18\u6cd5: Maybe/Either \u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u4f7f\u3046</li> <li>orElse / &lt;|&gt;: \u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u3092\u63d0\u4f9b\u3059\u308b</li> <li>ADT: \u76f4\u7a4d\u578b\u3068\u76f4\u548c\u578b\u3067\u30c9\u30e1\u30a4\u30f3\u3092\u6b63\u78ba\u306b\u30e2\u30c7\u30ea\u30f3\u30b0</li> <li>\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0: \u76f4\u548c\u578b\u3092\u5b89\u5168\u306b\u51e6\u7406\u3059\u308b\uff08\u7db2\u7f85\u6027\u30c1\u30a7\u30c3\u30af\u4ed8\u304d\uff09</li> </ol>"},{"location":"haskell/part-3/#_5","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part IV \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li>IO \u30e2\u30ca\u30c9\u306e\u5c0e\u5165</li> <li>\u526f\u4f5c\u7528\u306e\u7ba1\u7406</li> <li>\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406</li> </ul>"},{"location":"haskell/part-3/#_6","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"haskell/part-3/#1-maybe","title":"\u554f\u984c 1: Maybe \u306e\u57fa\u672c","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>safeDivide :: Int -&gt; Int -&gt; Maybe Int\nsafeDivide = ???\n\n-- \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nsafeDivide 10 2 == Just 5\nsafeDivide 10 0 == Nothing\nsafeDivide 7 2 == Just 3\n</code></pre> \u89e3\u7b54 <pre><code>safeDivide :: Int -&gt; Int -&gt; Maybe Int\nsafeDivide _ 0 = Nothing\nsafeDivide a b = Just (a `div` b)\n</code></pre>"},{"location":"haskell/part-3/#2-maybe","title":"\u554f\u984c 2: Maybe \u306e\u5408\u6210","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u30022\u3064\u306e\u6570\u5024\u6587\u5b57\u5217\u3092\u53d7\u3051\u53d6\u308a\u3001\u305d\u306e\u5408\u8a08\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>addStrings :: String -&gt; String -&gt; Maybe Int\naddStrings = ???\n\n-- \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\naddStrings \"10\" \"20\" == Just 30\naddStrings \"10\" \"abc\" == Nothing\naddStrings \"xyz\" \"20\" == Nothing\n</code></pre> \u89e3\u7b54 <pre><code>import Text.Read (readMaybe)\n\naddStrings :: String -&gt; String -&gt; Maybe Int\naddStrings a b = do\n    x &lt;- readMaybe a\n    y &lt;- readMaybe b\n    return (x + y)\n</code></pre>"},{"location":"haskell/part-3/#3-either","title":"\u554f\u984c 3: Either \u306b\u3088\u308b\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u5e74\u9f62\u3092\u691c\u8a3c\u3057\u3001\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>validateAge :: Int -&gt; Either String Int\nvalidateAge = ???\n\n-- \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nvalidateAge 25 == Right 25\nvalidateAge (-5) == Left \"Age cannot be negative\"\nvalidateAge 200 == Left \"Age cannot be greater than 150\"\n</code></pre> \u89e3\u7b54 <pre><code>validateAge :: Int -&gt; Either String Int\nvalidateAge age\n    | age &lt; 0   = Left \"Age cannot be negative\"\n    | age &gt; 150 = Left \"Age cannot be greater than 150\"\n    | otherwise = Right age\n</code></pre>"},{"location":"haskell/part-3/#4","title":"\u554f\u984c 4: \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0","text":"<p>\u4ee5\u4e0b\u306e\u30c7\u30fc\u30bf\u578b\u3068\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u4f7f\u3063\u305f\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>data PaymentMethod\n    = CreditCard String String  -- \u30ab\u30fc\u30c9\u756a\u53f7\u3001\u6709\u52b9\u671f\u9650\n    | BankTransfer String       -- \u53e3\u5ea7\u756a\u53f7\n    | Cash\n    deriving (Show, Eq)\n\ndescribePayment :: PaymentMethod -&gt; String\ndescribePayment = ???\n\n-- \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\ndescribePayment (CreditCard \"1234\" \"12/25\") == \"Credit card ending in 1234\"\ndescribePayment (BankTransfer \"9876\") == \"Bank transfer to account 9876\"\ndescribePayment Cash == \"Cash payment\"\n</code></pre> \u89e3\u7b54 <pre><code>describePayment :: PaymentMethod -&gt; String\ndescribePayment method = case method of\n    CreditCard number _ -&gt; \"Credit card ending in \" ++ number\n    BankTransfer account -&gt; \"Bank transfer to account \" ++ account\n    Cash -&gt; \"Cash payment\"\n</code></pre>"},{"location":"haskell/part-3/#5-all-any","title":"\u554f\u984c 5: all \u3068 any","text":"<p>\u4ee5\u4e0b\u306e\u6761\u4ef6\u306b\u5408\u3046\u30e6\u30fc\u30b6\u30fc\u3092\u62bd\u51fa\u3059\u308b\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>data User = User\n    { userName  :: String\n    , userEmail :: Maybe String\n    , userAge   :: Int\n    } deriving (Show, Eq)\n\nlet users = [ User \"Alice\" (Just \"alice@example.com\") 25\n            , User \"Bob\" Nothing 30\n            , User \"Charlie\" (Just \"charlie@test.com\") 17\n            ]\n\n-- 1. \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u304b\u3001example.com \u30c9\u30e1\u30a4\u30f3\u306e\u30e6\u30fc\u30b6\u30fc\nf1 :: [User] -&gt; [User]\nf1 = ???\n\n-- 2. \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u3066\u3001test.com \u30c9\u30e1\u30a4\u30f3\u306e\u30e6\u30fc\u30b6\u30fc\nf2 :: [User] -&gt; [User]\nf2 = ???\n</code></pre> \u89e3\u7b54 <pre><code>import Data.List (isSuffixOf)\n\n-- 1. \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u304b\u3001example.com \u30c9\u30e1\u30a4\u30f3\n-- maybe True ... \u306f Scala \u306e forall \u306b\u76f8\u5f53\nf1 :: [User] -&gt; [User]\nf1 = filter (\\u -&gt; maybe True (\"@example.com\" `isSuffixOf`) (userEmail u))\n-- [Alice, Bob]\n\n-- 2. \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u3066\u3001test.com \u30c9\u30e1\u30a4\u30f3\n-- maybe False ... \u306f Scala \u306e exists \u306b\u76f8\u5f53\nf2 :: [User] -&gt; [User]\nf2 = filter (\\u -&gt; maybe False (\"@test.com\" `isSuffixOf`) (userEmail u))\n-- [Charlie]\n</code></pre>"},{"location":"haskell/part-4/","title":"Part IV: IO \u3068\u526f\u4f5c\u7528\u306e\u7ba1\u7406","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u526f\u4f5c\u7528\u306e\u6271\u3044\u65b9\u3092\u5b66\u3073\u307e\u3059\u3002Haskell \u3067\u306f IO \u30e2\u30ca\u30c9\u3092\u4f7f\u3063\u3066\u526f\u4f5c\u7528\u3092\u578b\u30b7\u30b9\u30c6\u30e0\u3067\u7ba1\u7406\u3057\u3001\u9045\u5ef6\u30ea\u30b9\u30c8\u3067\u7121\u9650\u306e\u30c7\u30fc\u30bf\u3092\u6271\u3046\u65b9\u6cd5\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"haskell/part-4/#8-io","title":"\u7b2c8\u7ae0: IO \u30e2\u30ca\u30c9\u306e\u5c0e\u5165","text":""},{"location":"haskell/part-4/#81","title":"8.1 \u526f\u4f5c\u7528\u306e\u554f\u984c","text":"<p>\u7d14\u7c8b\u95a2\u6570\u306f\u526f\u4f5c\u7528\u3092\u6301\u3061\u307e\u305b\u3093\u3002\u3057\u304b\u3057\u3001\u5b9f\u969b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u306b\u306f\u526f\u4f5c\u7528\u304c\u5fc5\u8981\u3067\u3059:</p> <ul> <li>\u30d5\u30a1\u30a4\u30eb\u306e\u8aad\u307f\u66f8\u304d</li> <li>\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u901a\u4fe1</li> <li>\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30a2\u30af\u30bb\u30b9</li> <li>\u4e71\u6570\u751f\u6210</li> <li>\u73fe\u5728\u6642\u523b\u306e\u53d6\u5f97</li> </ul> <p></p>"},{"location":"haskell/part-4/#82-io","title":"8.2 IO \u30e2\u30ca\u30c9\u3068\u306f","text":"<p>Haskell \u306e IO \u30e2\u30ca\u30c9\u306f\u300c\u526f\u4f5c\u7528\u3092\u6301\u3064\u8a08\u7b97\u300d\u3092\u8868\u3059\u578b\u3067\u3059\u3002</p> <ul> <li><code>IO a</code> \u306f\u300c\u5b9f\u884c\u3059\u308b\u3068 <code>a</code> \u578b\u306e\u5024\u3092\u8fd4\u3059\u526f\u4f5c\u7528\u306e\u3042\u308b\u8a08\u7b97\u300d</li> <li>IO \u5024\u306f <code>do</code> \u8a18\u6cd5\u3067\u5408\u6210\u3067\u304d\u308b</li> <li>Haskell \u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u306f <code>main :: IO ()</code> \u304b\u3089\u59cb\u307e\u308b</li> </ul> <p></p>"},{"location":"haskell/part-4/#83","title":"8.3 \u30b5\u30a4\u30b3\u30ed\u3092\u632f\u308b\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/haskell/src/Ch08/IOMonad.hs</code></p>"},{"location":"haskell/part-4/#io","title":"\u4e71\u6570\u751f\u6210\uff08IO \u3092\u4f7f\u7528\uff09","text":"<pre><code>import System.Random (randomRIO)\n\n-- | \u30b5\u30a4\u30b3\u30ed\u3092\u632f\u308b\uff08\u526f\u4f5c\u7528\u3042\u308a\uff09\ncastTheDie :: IO Int\ncastTheDie = randomRIO (1, 6)\n</code></pre> <p>Scala \u3068\u306e\u9055\u3044: - Scala: <code>IO.delay(random.nextInt(6) + 1)</code> \u3067\u526f\u4f5c\u7528\u3092\u30e9\u30c3\u30d7 - Haskell: <code>randomRIO</code> \u81ea\u4f53\u304c <code>IO Int</code> \u3092\u8fd4\u3059</p>"},{"location":"haskell/part-4/#2","title":"\u30b5\u30a4\u30b3\u30ed\u30922\u56de\u632f\u308b","text":"<pre><code>-- | \u30b5\u30a4\u30b3\u30ed\u30922\u56de\u632f\u3063\u3066\u5408\u8a08\u3092\u8fd4\u3059\ncastTheDieTwice :: IO Int\ncastTheDieTwice = do\n    first  &lt;- castTheDie\n    second &lt;- castTheDie\n    return (first + second)\n</code></pre> <p>Scala \u3067\u306e\u540c\u7b49\u306e\u30b3\u30fc\u30c9: <pre><code>def castTheDieTwice(): IO[Int] = {\n  for {\n    first  &lt;- castTheDie()\n    second &lt;- castTheDie()\n  } yield first + second\n}\n</code></pre></p>"},{"location":"haskell/part-4/#84-do","title":"8.4 do \u8a18\u6cd5","text":"<p>Haskell \u306e <code>do</code> \u8a18\u6cd5\u306f\u3001Scala \u306e <code>for</code> \u5185\u5305\u8868\u8a18\u306b\u76f8\u5f53\u3057\u307e\u3059\u3002</p> <pre><code>-- do \u8a18\u6cd5\ncastTheDieTwice :: IO Int\ncastTheDieTwice = do\n    first  &lt;- castTheDie\n    second &lt;- castTheDie\n    return (first + second)\n\n-- \u8131\u7cd6\u5f8c\uff08&gt;&gt;=\u3092\u4f7f\u7528\uff09\ncastTheDieTwice :: IO Int\ncastTheDieTwice =\n    castTheDie &gt;&gt;= \\first -&gt;\n    castTheDie &gt;&gt;= \\second -&gt;\n    return (first + second)\n</code></pre> Haskell Scala \u8aac\u660e <code>do</code> <code>for</code> \u30e2\u30ca\u30c9\u5185\u5305\u8868\u8a18 <code>&lt;-</code> <code>&lt;-</code> \u5024\u306e\u53d6\u308a\u51fa\u3057 <code>return</code> <code>yield</code> \u307e\u305f\u306f <code>IO.pure</code> \u5024\u3092\u30e2\u30ca\u30c9\u306b\u5305\u3080 <code>&gt;&gt;=</code> <code>flatMap</code> \u30e2\u30ca\u30c9\u306e\u9023\u9396"},{"location":"haskell/part-4/#85","title":"8.5 \u8907\u6570\u56de\u306e\u30b5\u30a4\u30b3\u30ed","text":"<pre><code>import Control.Monad (replicateM)\n\n-- | \u30b5\u30a4\u30b3\u30ed\u3092n\u56de\u632f\u3063\u3066\u7d50\u679c\u3092\u30ea\u30b9\u30c8\u3067\u8fd4\u3059\ncastTheDieN :: Int -&gt; IO [Int]\ncastTheDieN n = replicateM n castTheDie\n</code></pre> <p><code>replicateM</code> \u306f Scala \u306e <code>sequence</code> + <code>List.fill</code> \u306b\u76f8\u5f53: <pre><code>// Scala\ndef castTheDieN(n: Int): IO[List[Int]] =\n  List.fill(n)(castTheDie()).sequence\n</code></pre></p>"},{"location":"haskell/part-4/#86","title":"8.6 \u30df\u30fc\u30c6\u30a3\u30f3\u30b0\u30b9\u30b1\u30b8\u30e5\u30fc\u30ea\u30f3\u30b0\u306e\u4f8b","text":""},{"location":"haskell/part-4/#_1","title":"\u30c7\u30fc\u30bf\u578b\u306e\u5b9a\u7fa9","text":"<pre><code>-- | \u30df\u30fc\u30c6\u30a3\u30f3\u30b0\u6642\u9593\u3092\u8868\u3059\u30c7\u30fc\u30bf\u578b\ndata MeetingTime = MeetingTime\n    { mtStartHour :: Int\n    , mtEndHour   :: Int\n    } deriving (Show, Eq)\n</code></pre>"},{"location":"haskell/part-4/#_2","title":"\u91cd\u8907\u5224\u5b9a\uff08\u7d14\u7c8b\u95a2\u6570\uff09","text":"<pre><code>-- | 2\u3064\u306e\u30df\u30fc\u30c6\u30a3\u30f3\u30b0\u304c\u91cd\u306a\u3063\u3066\u3044\u308b\u304b\u3092\u5224\u5b9a\nmeetingsOverlap :: MeetingTime -&gt; MeetingTime -&gt; Bool\nmeetingsOverlap m1 m2 =\n    mtStartHour m1 &lt; mtEndHour m2 &amp;&amp; mtEndHour m1 &gt; mtStartHour m2\n</code></pre>"},{"location":"haskell/part-4/#_3","title":"\u7a7a\u304d\u6642\u9593\u306e\u8a08\u7b97","text":"<pre><code>-- | \u53ef\u80fd\u306a\u30df\u30fc\u30c6\u30a3\u30f3\u30b0\u6642\u9593\u3092\u8a08\u7b97\uff08\u7d14\u7c8b\u95a2\u6570\uff09\npossibleMeetings :: [MeetingTime] -&gt; Int -&gt; Int -&gt; Int -&gt; [MeetingTime]\npossibleMeetings existingMeetings startHour endHour lengthHours =\n    let slots = [MeetingTime s (s + lengthHours) | s &lt;- [startHour .. endHour - lengthHours]]\n    in filter (\\slot -&gt; all (not . meetingsOverlap slot) existingMeetings) slots\n</code></pre> <p>Haskell \u306e\u30ea\u30b9\u30c8\u5185\u5305\u8868\u8a18 <code>[... | ...]</code> \u306f\u3001Scala \u306e <code>for</code> \u5185\u5305\u8868\u8a18\u306b\u4f3c\u3066\u3044\u307e\u3059: <pre><code>// Scala\nval slots = for {\n  s &lt;- startHour to (endHour - lengthHours)\n} yield MeetingTime(s, s + lengthHours)\n</code></pre></p>"},{"location":"haskell/part-4/#87-io","title":"8.7 IO \u306e\u5408\u6210","text":"<pre><code>-- | 2\u3064\u306e IO \u3092\u5408\u6210\ncombineIO :: IO a -&gt; IO b -&gt; (a -&gt; b -&gt; c) -&gt; IO c\ncombineIO io1 io2 f = do\n    a &lt;- io1\n    b &lt;- io2\n    return (f a b)\n</code></pre> <p>\u4f7f\u7528\u4f8b: <pre><code>ghci&gt; result &lt;- combineIO (return 1) (return 2) (+)\nghci&gt; print result\n3\n</code></pre></p>"},{"location":"haskell/part-4/#io_1","title":"IO \u306e\u30ea\u30b9\u30c8\u3092\u9806\u756a\u306b\u5b9f\u884c","text":"<pre><code>-- | IO \u306e\u30ea\u30b9\u30c8\u3092\u9806\u756a\u306b\u5b9f\u884c\nsequenceIO :: [IO a] -&gt; IO [a]\nsequenceIO []     = return []\nsequenceIO (x:xs) = do\n    a  &lt;- x\n    as &lt;- sequenceIO xs\n    return (a : as)\n</code></pre> <p>\u6a19\u6e96\u30e9\u30a4\u30d6\u30e9\u30ea\u306e <code>sequence</code> \u3068\u540c\u3058\u6a5f\u80fd\u3067\u3059\u3002</p>"},{"location":"haskell/part-4/#88","title":"8.8 \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":"<pre><code>import Control.Exception (try, SomeException)\n\n-- | \u4f8b\u5916\u3092\u30ad\u30e3\u30c3\u30c1\u3057\u3066 Either \u306b\u5909\u63db\ncatchIO :: IO a -&gt; IO (Either String a)\ncatchIO action = do\n    result &lt;- try action :: IO (Either SomeException a)\n    return $ case result of\n        Right a -&gt; Right a\n        Left e  -&gt; Left (show e)\n</code></pre>"},{"location":"haskell/part-4/#_4","title":"\u30ea\u30c8\u30e9\u30a4\u6a5f\u80fd","text":"<pre><code>-- | IO \u30a2\u30af\u30b7\u30e7\u30f3\u3092\u30ea\u30c8\u30e9\u30a4\nretryIO :: Int -&gt; IO a -&gt; IO (Maybe a)\nretryIO 0 _      = return Nothing\nretryIO n action = do\n    result &lt;- try action :: IO (Either SomeException a)\n    case result of\n        Right a -&gt; return (Just a)\n        Left _  -&gt; retryIO (n - 1) action\n\n-- | \u30ea\u30c8\u30e9\u30a4\u3057\u3066\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u3092\u8fd4\u3059\nretryWithDefault :: Int -&gt; a -&gt; IO a -&gt; IO a\nretryWithDefault maxRetries defaultVal action = do\n    result &lt;- retryIO maxRetries action\n    return $ maybe defaultVal id result\n</code></pre>"},{"location":"haskell/part-4/#89-io","title":"8.9 \u7d14\u7c8b\u95a2\u6570\u3068 IO \u306e\u5206\u96e2","text":"<pre><code>-- | \u5165\u529b\u3092\u30d1\u30fc\u30b9\u3057\u3066\u691c\u8a3c\uff08\u7d14\u7c8b\u95a2\u6570\uff09\nparseAndValidate :: String -&gt; Either String Int\nparseAndValidate input =\n    case reads input of\n        [(n, \"\")] | n &gt; 0     -&gt; Right n\n                  | otherwise -&gt; Left \"Number must be positive\"\n        _                     -&gt; Left \"Invalid number\"\n\n-- | \u5165\u529b\u3092\u51e6\u7406\uff08IO \u3068\u7d14\u7c8b\u95a2\u6570\u306e\u5206\u96e2\uff09\nprocessInput :: IO ()\nprocessInput = do\n    putStr \"Enter a positive number: \"\n    input &lt;- getLine\n    case parseAndValidate input of\n        Right n  -&gt; putStrLn $ \"Valid: \" ++ show n\n        Left err -&gt; putStrLn $ \"Error: \" ++ err\n</code></pre>"},{"location":"haskell/part-4/#9","title":"\u7b2c9\u7ae0: \u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406","text":""},{"location":"haskell/part-4/#91","title":"9.1 \u9045\u5ef6\u30ea\u30b9\u30c8\u3068\u306f","text":"<p>Haskell \u306e\u30ea\u30b9\u30c8\u306f\u9045\u5ef6\u8a55\u4fa1\u3055\u308c\u307e\u3059\u3002\u3053\u308c\u306b\u3088\u308a\u3001\u7121\u9650\u30ea\u30b9\u30c8\u3092\u6271\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002</p> <p></p> <p>Scala \u3067\u306f <code>fs2.Stream</code> \u3092\u4f7f\u3044\u307e\u3059\u304c\u3001Haskell \u3067\u306f\u6a19\u6e96\u306e\u30ea\u30b9\u30c8\u304c\u9045\u5ef6\u8a55\u4fa1\u306e\u305f\u3081\u3001\u305d\u306e\u307e\u307e\u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0\u3068\u3057\u3066\u6a5f\u80fd\u3057\u307e\u3059\u3002</p>"},{"location":"haskell/part-4/#92","title":"9.2 \u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0\u306e\u57fa\u672c","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/haskell/src/Ch09/StreamProcessing.hs</code></p> <pre><code>-- | \u81ea\u7136\u6570\u306e\u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0\nnaturals :: [Integer]\nnaturals = [1..]\n\n-- | \u5076\u6570\u306e\u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0\nevens :: [Integer]\nevens = [2,4..]\n\n-- | \u5947\u6570\u306e\u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0\nodds :: [Integer]\nodds = [1,3..]\n</code></pre> <pre><code>ghci&gt; take 10 naturals\n[1,2,3,4,5,6,7,8,9,10]\n\nghci&gt; take 5 evens\n[2,4,6,8,10]\n</code></pre>"},{"location":"haskell/part-4/#93","title":"9.3 \u30d5\u30a3\u30dc\u30ca\u30c3\u30c1\u6570\u5217","text":"<p>\u9045\u5ef6\u8a55\u4fa1\u3092\u4f7f\u3063\u305f\u81ea\u5df1\u53c2\u7167\u7684\u306a\u5b9a\u7fa9:</p> <pre><code>-- | \u30d5\u30a3\u30dc\u30ca\u30c3\u30c1\u6570\u5217\u306e\u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0\nfibs :: [Integer]\nfibs = 0 : 1 : zipWith (+) fibs (tail fibs)\n</code></pre> <p></p> <pre><code>ghci&gt; take 10 fibs\n[0,1,1,2,3,5,8,13,21,34]\n</code></pre>"},{"location":"haskell/part-4/#94","title":"9.4 \u7d20\u6570\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\uff08\u30a8\u30e9\u30c8\u30b9\u30c6\u30cd\u30b9\u306e\u3075\u308b\u3044\uff09","text":"<pre><code>-- | \u7d20\u6570\u306e\u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0\nprimes :: [Integer]\nprimes = sieve [2..]\n  where\n    sieve (p:xs) = p : sieve [x | x &lt;- xs, x `mod` p /= 0]\n    sieve []     = []\n</code></pre> <pre><code>ghci&gt; take 10 primes\n[2,3,5,7,11,13,17,19,23,29]\n</code></pre>"},{"location":"haskell/part-4/#95","title":"9.5 \u30b9\u30c8\u30ea\u30fc\u30e0\u751f\u6210\u95a2\u6570","text":"<pre><code>-- | \u540c\u3058\u5024\u3092\u7121\u9650\u306b\u7e70\u308a\u8fd4\u3059\uff08Scala \u306e Stream.repeat \u306b\u76f8\u5f53\uff09\nrepeatVal :: a -&gt; [a]\nrepeatVal x = x : repeatVal x\n\n-- | \u30ea\u30b9\u30c8\u3092\u7121\u9650\u306b\u7e70\u308a\u8fd4\u3059\uff08Scala \u306e Stream(...).repeat \u306b\u76f8\u5f53\uff09\ncycleList :: [a] -&gt; [a]\ncycleList xs = xs ++ cycleList xs\n\n-- | \u95a2\u6570\u3092\u7e70\u308a\u8fd4\u3057\u9069\u7528\u3057\u3066\u7121\u9650\u30ea\u30b9\u30c8\u3092\u751f\u6210\niterate' :: (a -&gt; a) -&gt; a -&gt; [a]\niterate' f x = x : iterate' f (f x)\n</code></pre> <pre><code>ghci&gt; take 5 (repeatVal 1)\n[1,1,1,1,1]\n\nghci&gt; take 7 (cycleList [1,2,3])\n[1,2,3,1,2,3,1]\n\nghci&gt; take 5 (iterate' (*2) 1)\n[1,2,4,8,16]\n</code></pre>"},{"location":"haskell/part-4/#96-unfold","title":"9.6 unfold: \u6c4e\u7528\u7684\u306a\u30b9\u30c8\u30ea\u30fc\u30e0\u751f\u6210","text":"<pre><code>-- | unfold: \u7a2e\u304b\u3089\u7121\u9650\u30ea\u30b9\u30c8\u3092\u751f\u6210\nunfold :: (b -&gt; Maybe (a, b)) -&gt; b -&gt; [a]\nunfold f seed = case f seed of\n    Nothing      -&gt; []\n    Just (a, b') -&gt; a : unfold f b'\n</code></pre> <p>Scala \u306e <code>Stream.unfold</code> \u306b\u76f8\u5f53: <pre><code>// Scala\nStream.unfold(0)(n =&gt; Some((n, n + 1)))\n</code></pre></p> <pre><code>-- Haskell\nghci&gt; take 5 (unfold (\\n -&gt; Just (n, n+1)) 0)\n[0,1,2,3,4]\n</code></pre>"},{"location":"haskell/part-4/#97","title":"9.7 \u30b9\u30c8\u30ea\u30fc\u30e0\u64cd\u4f5c","text":"<pre><code>-- | \u6761\u4ef6\u3092\u6e80\u305f\u3059\u9593\u3001\u8981\u7d20\u3092\u53d6\u5f97\uff08Scala \u306e takeWhile\uff09\ntakeWhile' :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\ntakeWhile' _ []     = []\ntakeWhile' p (x:xs)\n    | p x       = x : takeWhile' p xs\n    | otherwise = []\n\n-- | \u6761\u4ef6\u3092\u6e80\u305f\u3059\u9593\u3001\u8981\u7d20\u3092\u30b9\u30ad\u30c3\u30d7\uff08Scala \u306e dropWhile\uff09\ndropWhile' :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\ndropWhile' _ []     = []\ndropWhile' p xs@(x:xs')\n    | p x       = dropWhile' p xs'\n    | otherwise = xs\n</code></pre> <pre><code>ghci&gt; takeWhile' (&lt;5) [1,2,3,4,5,6]\n[1,2,3,4]\n\nghci&gt; dropWhile' (&lt;5) [1,2,3,4,5,6]\n[5,6]\n</code></pre>"},{"location":"haskell/part-4/#98","title":"9.8 \u30b9\u30e9\u30a4\u30c7\u30a3\u30f3\u30b0\u30a6\u30a3\u30f3\u30c9\u30a6","text":"<pre><code>-- | \u30b9\u30e9\u30a4\u30c7\u30a3\u30f3\u30b0\u30a6\u30a3\u30f3\u30c9\u30a6\uff08Scala \u306e sliding \u306b\u76f8\u5f53\uff09\nsliding :: Int -&gt; [a] -&gt; [[a]]\nsliding n xs\n    | length window &lt; n = []\n    | otherwise         = window : sliding n (tail xs)\n  where\n    window = take n xs\n</code></pre> <pre><code>ghci&gt; sliding 3 [1,2,3,4,5]\n[[1,2,3],[2,3,4],[3,4,5]]\n</code></pre>"},{"location":"haskell/part-4/#99","title":"9.9 \u30c1\u30e3\u30f3\u30af\u5206\u5272","text":"<pre><code>-- | \u56fa\u5b9a\u30b5\u30a4\u30ba\u306e\u30c1\u30e3\u30f3\u30af\u306b\u5206\u5272\nchunksOf :: Int -&gt; [a] -&gt; [[a]]\nchunksOf _ [] = []\nchunksOf n xs = take n xs : chunksOf n (drop n xs)\n</code></pre> <pre><code>ghci&gt; chunksOf 3 [1,2,3,4,5,6,7,8]\n[[1,2,3],[4,5,6],[7,8]]\n</code></pre>"},{"location":"haskell/part-4/#910","title":"9.10 \u30c8\u30ec\u30f3\u30c9\u691c\u51fa","text":"<p>\u901a\u8ca8\u4ea4\u63db\u30ec\u30fc\u30c8\u306e\u76e3\u8996\u306b\u4f7f\u7528\u3059\u308b\u95a2\u6570:</p> <pre><code>-- | \u4e0a\u6607\u30c8\u30ec\u30f3\u30c9\u304b\u3069\u3046\u304b\u3092\u5224\u5b9a\ntrending :: Ord a =&gt; [a] -&gt; Bool\ntrending xs =\n    length xs &gt; 1 &amp;&amp;\n    all (uncurry (&lt;)) (zip xs (tail xs))\n\n-- | \u5b89\u5b9a\uff08\u5168\u3066\u540c\u3058\u5024\uff09\u304b\u3069\u3046\u304b\u3092\u5224\u5b9a\nisStable :: Eq a =&gt; [a] -&gt; Bool\nisStable xs =\n    length xs &gt;= 3 &amp;&amp;\n    all (== head xs) xs\n</code></pre> <pre><code>ghci&gt; trending [0.81, 0.82, 0.83]\nTrue\n\nghci&gt; trending [0.81, 0.84, 0.83]\nFalse\n\nghci&gt; isStable [5, 5, 5]\nTrue\n</code></pre>"},{"location":"haskell/part-4/#911","title":"9.11 \u901a\u8ca8\u4ea4\u63db\u30ec\u30fc\u30c8\u306e\u4f8b","text":"<pre><code>type ExchangeRate = Double\n\n-- | \u70ba\u66ff\u30ec\u30fc\u30c8\u3092\u30b7\u30df\u30e5\u30ec\u30fc\u30c8\uff08\u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0\uff09\nsimulateRates :: ExchangeRate -&gt; [ExchangeRate]\nsimulateRates initial = iterate' vary initial\n  where\n    vary rate = rate + sin (rate * 100) * 0.01\n\n-- | \u4e0a\u6607\u30c8\u30ec\u30f3\u30c9\u3092\u691c\u51fa\u3059\u308b\u307e\u3067\u30ec\u30fc\u30c8\u3092\u76e3\u8996\nfindUptrend :: Int -&gt; [ExchangeRate] -&gt; Maybe [ExchangeRate]\nfindUptrend = findTrend\n\n-- | \u30b9\u30c8\u30ea\u30fc\u30e0\u304b\u3089\u4e0a\u6607\u30c8\u30ec\u30f3\u30c9\u3092\u691c\u51fa\nfindTrend :: Ord a =&gt; Int -&gt; [a] -&gt; Maybe [a]\nfindTrend windowSize xs =\n    case filter trending (sliding windowSize xs) of\n        []    -&gt; Nothing\n        (w:_) -&gt; Just w\n</code></pre>"},{"location":"haskell/part-4/#_5","title":"\u30c8\u30ec\u30f3\u30c9\u3092\u691c\u51fa\u3057\u3066\u4ea4\u63db","text":"<pre><code>-- | \u4e0a\u6607\u30c8\u30ec\u30f3\u30c9\u3092\u691c\u51fa\u3057\u305f\u3089\u4ea4\u63db\nexchangeIfTrending :: Double -&gt; Int -&gt; [ExchangeRate] -&gt; Maybe Double\nexchangeIfTrending amount windowSize rates =\n    case findUptrend windowSize rates of\n        Just trend -&gt; Just $ amount * last trend\n        Nothing    -&gt; Nothing\n</code></pre> <pre><code>ghci&gt; exchangeIfTrending 100 3 [0.80, 0.81, 0.82, 0.83, 0.80]\nJust 82.0\n</code></pre>"},{"location":"haskell/part-4/#912","title":"9.12 \u30b9\u30c8\u30ea\u30fc\u30e0\u5408\u6210","text":"<pre><code>-- | \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u4ed8\u304d\u30b9\u30c8\u30ea\u30fc\u30e0\uff08Scala \u306e zipWithIndex\uff09\nzipWithIndex :: [a] -&gt; [(Int, a)]\nzipWithIndex = zip [0..]\n\n-- | 2\u3064\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u4ea4\u4e92\u306b\u5408\u6210\ninterleave :: [a] -&gt; [a] -&gt; [a]\ninterleave []     ys     = ys\ninterleave xs     []     = xs\ninterleave (x:xs) (y:ys) = x : y : interleave xs ys\n\n-- | 2\u3064\u306e\u30bd\u30fc\u30c8\u6e08\u307f\u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u30de\u30fc\u30b8\nmerge :: Ord a =&gt; [a] -&gt; [a] -&gt; [a]\nmerge []     ys     = ys\nmerge xs     []     = xs\nmerge (x:xs) (y:ys)\n    | x &lt;= y    = x : merge xs (y:ys)\n    | otherwise = y : merge (x:xs) ys\n</code></pre> <pre><code>ghci&gt; take 3 (zipWithIndex ['a', 'b', 'c'])\n[(0,'a'),(1,'b'),(2,'c')]\n\nghci&gt; take 6 (interleave [1,3,5] [2,4,6])\n[1,2,3,4,5,6]\n\nghci&gt; take 10 (merge [1,3,5,7,9] [2,4,6,8,10])\n[1,2,3,4,5,6,7,8,9,10]\n</code></pre>"},{"location":"haskell/part-4/#_6","title":"\u307e\u3068\u3081","text":""},{"location":"haskell/part-4/#part-iv","title":"Part IV \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"haskell/part-4/#scala-haskell","title":"Scala \u3068 Haskell \u306e\u6bd4\u8f03","text":"\u6982\u5ff5 Scala (cats-effect/fs2) Haskell \u526f\u4f5c\u7528\u306e\u578b <code>IO[A]</code> <code>IO a</code> \u9045\u5ef6\u5b9f\u884c <code>IO.delay(expr)</code> \u95a2\u6570\u304c <code>IO</code> \u3092\u8fd4\u3059 \u5024\u306e\u30e9\u30c3\u30d7 <code>IO.pure(value)</code> <code>return value</code> \u30e2\u30ca\u30c9\u5408\u6210 <code>for</code> \u5185\u5305\u8868\u8a18 <code>do</code> \u8a18\u6cd5 flatMap <code>flatMap</code> <code>&gt;&gt;=</code> \u30b9\u30c8\u30ea\u30fc\u30e0 <code>fs2.Stream[IO, A]</code> \u6a19\u6e96\u306e <code>[a]</code>\uff08\u9045\u5ef6\u8a55\u4fa1\uff09 \u7121\u9650\u7e70\u308a\u8fd4\u3057 <code>Stream(...).repeat</code> <code>repeat</code> / <code>cycle</code> \u30b9\u30e9\u30a4\u30c7\u30a3\u30f3\u30b0 <code>stream.sliding(n)</code> <code>sliding n xs</code> \u30ea\u30b9\u30c8\u306e sequence <code>list.sequence</code> <code>sequence</code>"},{"location":"haskell/part-4/#_7","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>IO \u30e2\u30ca\u30c9: Haskell \u3067\u306f\u526f\u4f5c\u7528\u3092\u6301\u3064\u8a08\u7b97\u306f\u5fc5\u305a <code>IO</code> \u578b\u3092\u8fd4\u3059</li> <li>do \u8a18\u6cd5: Scala \u306e <code>for</code> \u5185\u5305\u8868\u8a18\u306b\u76f8\u5f53\u3001\u30e2\u30ca\u30c9\u3092\u9806\u5e8f\u4ed8\u3051\u3066\u5408\u6210</li> <li>\u9045\u5ef6\u8a55\u4fa1: Haskell \u306e\u30ea\u30b9\u30c8\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u9045\u5ef6\u8a55\u4fa1\u3001\u7121\u9650\u30ea\u30b9\u30c8\u304c\u81ea\u7136\u306b\u6271\u3048\u308b</li> <li>\u7d14\u7c8b\u95a2\u6570\u3068\u306e\u5206\u96e2: \u30ed\u30b8\u30c3\u30af\u306f\u7d14\u7c8b\u95a2\u6570\u3067\u3001IO \u306f\u5883\u754c\u90e8\u5206\u306e\u307f</li> <li>\u30b9\u30c8\u30ea\u30fc\u30e0\u751f\u6210: <code>iterate</code>\u3001<code>unfold</code> \u3067\u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u751f\u6210</li> <li>\u30d1\u30bf\u30fc\u30f3\u691c\u51fa: <code>sliding</code> \u3067\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u4f5c\u308a\u3001<code>trending</code> \u3067\u30d1\u30bf\u30fc\u30f3\u3092\u691c\u51fa</li> </ol>"},{"location":"haskell/part-4/#_8","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part V \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li>\u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406</li> <li>Concurrent Haskell</li> <li>STM\uff08Software Transactional Memory\uff09</li> <li>async \u30e9\u30a4\u30d6\u30e9\u30ea</li> </ul>"},{"location":"haskell/part-4/#_9","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"haskell/part-4/#1-io","title":"\u554f\u984c 1: IO \u306e\u57fa\u672c","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>-- \u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u51fa\u529b\u3057\u3066\u8fd4\u3059\nprintAndReturn :: String -&gt; IO String\nprintAndReturn message = ???\n\n-- \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\n-- &gt; result &lt;- printAndReturn \"Hello\"\n-- Hello\n-- &gt; result\n-- \"Hello\"\n</code></pre> \u89e3\u7b54 <pre><code>printAndReturn :: String -&gt; IO String\nprintAndReturn message = do\n    putStrLn message\n    return message\n</code></pre>"},{"location":"haskell/part-4/#2-io","title":"\u554f\u984c 2: IO \u306e\u5408\u6210","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u30022\u3064\u306e IO \u3092\u9806\u756a\u306b\u5b9f\u884c\u3057\u3001\u7d50\u679c\u3092\u7d50\u5408\u3057\u307e\u3059\u3002</p> <pre><code>combineIO :: IO a -&gt; IO b -&gt; (a -&gt; b -&gt; c) -&gt; IO c\ncombineIO io1 io2 f = ???\n\n-- \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\n-- &gt; result &lt;- combineIO (return 1) (return 2) (+)\n-- &gt; result\n-- 3\n</code></pre> \u89e3\u7b54 <pre><code>combineIO :: IO a -&gt; IO b -&gt; (a -&gt; b -&gt; c) -&gt; IO c\ncombineIO io1 io2 f = do\n    a &lt;- io1\n    b &lt;- io2\n    return (f a b)\n</code></pre>"},{"location":"haskell/part-4/#3","title":"\u554f\u984c 3: \u30ea\u30c8\u30e9\u30a4","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u6307\u5b9a\u56de\u6570\u30ea\u30c8\u30e9\u30a4\u3057\u3001\u5168\u90e8\u5931\u6557\u3057\u305f\u3089\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>retryWithDefault :: Int -&gt; a -&gt; IO a -&gt; IO a\nretryWithDefault maxRetries defaultVal action = ???\n</code></pre> \u89e3\u7b54 <pre><code>import Control.Exception (try, SomeException)\n\nretryWithDefault :: Int -&gt; a -&gt; IO a -&gt; IO a\nretryWithDefault 0 defaultVal _ = return defaultVal\nretryWithDefault n defaultVal action = do\n    result &lt;- try action :: IO (Either SomeException a)\n    case result of\n        Right a -&gt; return a\n        Left _  -&gt; retryWithDefault (n - 1) defaultVal action\n</code></pre>"},{"location":"haskell/part-4/#4","title":"\u554f\u984c 4: \u30b9\u30c8\u30ea\u30fc\u30e0\u64cd\u4f5c","text":"<p>\u4ee5\u4e0b\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u4f5c\u6210\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>-- 1. 1\u304b\u308910\u307e\u3067\u306e\u5076\u6570\u306e\u30ea\u30b9\u30c8\nevens :: [Int]\nevens = ???\n\n-- 2. \u7121\u9650\u306b\u4ea4\u4e92\u306b True/False \u3092\u8fd4\u3059\u30ea\u30b9\u30c8\nalternating :: [Bool]\nalternating = ???\n\n-- 3. \u6700\u521d\u306e5\u3064\u306e\u8981\u7d20\u306e\u5408\u8a08\u3092\u8a08\u7b97\nsumFirst5 :: [Int] -&gt; Int\nsumFirst5 xs = ???\n</code></pre> \u89e3\u7b54 <pre><code>-- 1. 1\u304b\u308910\u307e\u3067\u306e\u5076\u6570\nevens :: [Int]\nevens = [2, 4, 6, 8, 10]\n-- \u307e\u305f\u306f\nevens = filter even [1..10]\n\n-- 2. \u7121\u9650\u306b\u4ea4\u4e92\u306b True/False\nalternating :: [Bool]\nalternating = cycle [True, False]\n\n-- 3. \u6700\u521d\u306e5\u3064\u306e\u8981\u7d20\u306e\u5408\u8a08\nsumFirst5 :: [Int] -&gt; Int\nsumFirst5 xs = sum (take 5 xs)\n</code></pre>"},{"location":"haskell/part-4/#5","title":"\u554f\u984c 5: \u30c8\u30ec\u30f3\u30c9\u691c\u51fa","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u76f4\u8fd1\u306e\u5024\u304c\u6e1b\u5c11\u50be\u5411\u304b\u3069\u3046\u304b\u3092\u5224\u5b9a\u3057\u307e\u3059\u3002</p> <pre><code>declining :: Ord a =&gt; [a] -&gt; Bool\ndeclining xs = ???\n\n-- \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\n-- declining [0.83, 0.82, 0.81]  -- True (\u6e1b\u5c11\u30c8\u30ec\u30f3\u30c9)\n-- declining [0.81, 0.82, 0.83]  -- False\n-- declining [0.81]              -- False (1\u8981\u7d20\u3067\u306f\u5224\u5b9a\u4e0d\u53ef)\n</code></pre> \u89e3\u7b54 <pre><code>declining :: Ord a =&gt; [a] -&gt; Bool\ndeclining xs =\n    length xs &gt; 1 &amp;&amp;\n    all (uncurry (&gt;)) (zip xs (tail xs))\n</code></pre>"},{"location":"haskell/part-5/","title":"Part V: \u4e26\u884c\u51e6\u7406","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u4e26\u884c\u51e6\u7406\u3092\u5b66\u3073\u307e\u3059\u3002Haskell \u3067\u306f IORef\u3001Async\u3001STM\uff08Software Transactional Memory\uff09\u3092\u4f7f\u3063\u3066\u3001\u5b89\u5168\u3067\u52b9\u7387\u7684\u306a\u4e26\u884c\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u69cb\u7bc9\u3067\u304d\u307e\u3059\u3002</p>"},{"location":"haskell/part-5/#10","title":"\u7b2c10\u7ae0: \u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406","text":""},{"location":"haskell/part-5/#101","title":"10.1 \u4e26\u884c\u51e6\u7406\u306e\u8ab2\u984c","text":"<p>\u5f93\u6765\u306e\u4e26\u884c\u51e6\u7406\u306b\u306f\u591a\u304f\u306e\u8ab2\u984c\u304c\u3042\u308a\u307e\u3059:</p> <ul> <li>\u30c7\u30c3\u30c9\u30ed\u30c3\u30af</li> <li>\u7af6\u5408\u72b6\u614b\uff08Race Condition\uff09</li> <li>\u5171\u6709\u72b6\u614b\u306e\u7ba1\u7406\u306e\u8907\u96d1\u3055</li> <li>\u30b9\u30ec\u30c3\u30c9\u306e\u30aa\u30fc\u30d0\u30fc\u30d8\u30c3\u30c9</li> </ul> <p></p>"},{"location":"haskell/part-5/#102-ioref-","title":"10.2 IORef - \u53ef\u5909\u53c2\u7167","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/haskell/src/Ch10/ConcurrentProcessing.hs</code></p> <p>IORef \u306f\u3001IO \u30e2\u30ca\u30c9\u5185\u3067\u53ef\u5909\u53c2\u7167\u3092\u63d0\u4f9b\u3057\u307e\u3059\u3002Scala \u306e <code>Ref</code> \u306b\u76f8\u5f53\u3057\u307e\u3059\u3002</p> <pre><code>import Data.IORef\n\n-- \u30ab\u30a6\u30f3\u30bf\u30fc\u306e\u4f5c\u6210\u3068\u4f7f\u7528\nexample :: IO Int\nexample = do\n    counter &lt;- newIORef 0           -- \u521d\u671f\u5024 0 \u306e IORef \u3092\u4f5c\u6210\n    atomicModifyIORef' counter (\\n -&gt; (n + 3, ()))  -- \u30a2\u30c8\u30df\u30c3\u30af\u306b\u66f4\u65b0\n    readIORef counter               -- \u73fe\u5728\u306e\u5024\u3092\u53d6\u5f97\n\n-- \u5b9f\u884c\u7d50\u679c: 3\n</code></pre> <p></p>"},{"location":"haskell/part-5/#ioref","title":"IORef \u306e\u4e3b\u8981\u95a2\u6570","text":"\u95a2\u6570 \u8aac\u660e \u4f8b <code>newIORef initial</code> \u521d\u671f\u5024\u3067 IORef \u3092\u4f5c\u6210 <code>newIORef 0</code> <code>readIORef ref</code> \u73fe\u5728\u306e\u5024\u3092\u53d6\u5f97 <code>readIORef counter</code> <code>writeIORef ref value</code> \u5024\u3092\u8a2d\u5b9a <code>writeIORef counter 10</code> <code>modifyIORef' ref f</code> \u66f4\u65b0\uff08\u975e\u30a2\u30c8\u30df\u30c3\u30af\uff09 <code>modifyIORef' counter (+1)</code> <code>atomicModifyIORef' ref f</code> \u30a2\u30c8\u30df\u30c3\u30af\u306b\u66f4\u65b0 <code>atomicModifyIORef' counter (\\n -&gt; (n+1, n))</code>"},{"location":"haskell/part-5/#103","title":"10.3 \u4e26\u5217\u5b9f\u884c","text":"<p>Haskell \u306e <code>async</code> \u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u4f7f\u3063\u3066\u3001IO \u30a2\u30af\u30b7\u30e7\u30f3\u3092\u4e26\u5217\u5b9f\u884c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>import Control.Concurrent.Async\n\n-- \u4e26\u5217\u5b9f\u884c\nresults &lt;- mapConcurrently (\\x -&gt; return (x * 2)) [1, 2, 3]\n-- results: [2, 4, 6]\n\n-- \u8907\u6570\u306e IO \u3092\u4e26\u5217\u5b9f\u884c\nresults &lt;- mapConcurrently id [return 1, return 2, return 3]\n-- results: [1, 2, 3]\n</code></pre> <p>Scala \u3068\u306e\u5bfe\u5fdc: - Scala \u306e <code>parSequence</code> \u2192 Haskell \u306e <code>mapConcurrently id</code> - Scala \u306e <code>parTraverse</code> \u2192 Haskell \u306e <code>mapConcurrently</code></p> <p></p>"},{"location":"haskell/part-5/#104","title":"10.4 \u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u306e\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u96c6\u8a08","text":"<p>\u90fd\u5e02\u3078\u306e\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u3092\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u3067\u96c6\u8a08\u3057\u3001\u30e9\u30f3\u30ad\u30f3\u30b0\u3092\u66f4\u65b0\u3059\u308b\u4f8b\u3067\u3059\u3002</p> <pre><code>import Data.Map.Strict (Map)\nimport qualified Data.Map.Strict as Map\n\n-- \u90fd\u5e02\u3068\u7d71\u8a08\u306e\u30c7\u30fc\u30bf\u578b\nnewtype City = City { cityName :: String }\n    deriving (Show, Eq, Ord)\n\ndata CityStats = CityStats\n    { csCity     :: City\n    , csCheckIns :: Int\n    } deriving (Show, Eq)\n\n-- \u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u72b6\u614b\ntype CheckInState = IORef (Map City Int)\n\n-- \u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u3092\u8a18\u9332\nrecordCheckIn :: CheckInState -&gt; City -&gt; IO ()\nrecordCheckIn state city = atomicModifyIORef' state $ \\m -&gt;\n    (Map.insertWith (+) city 1 m, ())\n</code></pre>"},{"location":"haskell/part-5/#_1","title":"\u30c8\u30c3\u30d7\u90fd\u5e02\u306e\u8a08\u7b97\uff08\u7d14\u7c8b\u95a2\u6570\uff09","text":"<pre><code>import Data.List (sortBy)\nimport Data.Ord (Down(..))\n\ntopCities :: Int -&gt; Map City Int -&gt; [CityStats]\ntopCities n cityCheckIns =\n    take n\n    . sortBy (\\a b -&gt; compare (Down $ csCheckIns a) (Down $ csCheckIns b))\n    . map (uncurry CityStats)\n    $ Map.toList cityCheckIns\n</code></pre>"},{"location":"haskell/part-5/#105","title":"10.5 \u30b5\u30a4\u30b3\u30ed\u3092\u4e26\u884c\u3057\u3066\u632f\u308b","text":"<pre><code>import System.Random (randomRIO)\nimport Control.Concurrent.Async (mapConcurrently)\n\n-- \u30b5\u30a4\u30b3\u30ed\u3092\u632f\u308b\ncastDie :: IO Int\ncastDie = randomRIO (1, 6)\n\n-- 2\u3064\u306e\u30b5\u30a4\u30b3\u30ed\u3092\u4e26\u884c\u3057\u3066\u632f\u308b\ncastDieConcurrently :: IO [Int]\ncastDieConcurrently = mapConcurrently id [castDie, castDie]\n\n-- n\u500b\u306e\u30b5\u30a4\u30b3\u30ed\u3092\u4e26\u884c\u3057\u3066\u632f\u308a\u3001\u5408\u8a08\u3092\u8fd4\u3059\nsumDiceConcurrently :: Int -&gt; IO Int\nsumDiceConcurrently n = sum &lt;$&gt; mapConcurrently id (replicate n castDie)\n</code></pre>"},{"location":"haskell/part-5/#106-async-","title":"10.6 Async - \u8efd\u91cf\u30b9\u30ec\u30c3\u30c9","text":"<p>Async \u306f\u3001Haskell \u306e\u8efd\u91cf\u30b9\u30ec\u30c3\u30c9\u3092\u8868\u3057\u307e\u3059\u3002Scala \u306e <code>Fiber</code> \u306b\u76f8\u5f53\u3057\u307e\u3059\u3002</p> <pre><code>import Control.Concurrent.Async\n\n-- \u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u5b9f\u884c\nhandle &lt;- async (return 42)\n\n-- \u7d50\u679c\u3092\u5f85\u6a5f\nresult &lt;- wait handle  -- 42\n\n-- \u30ad\u30e3\u30f3\u30bb\u30eb\ncancel handle\n</code></pre> <p></p>"},{"location":"haskell/part-5/#async","title":"Async \u306e\u4e3b\u8981\u95a2\u6570","text":"\u95a2\u6570 \u8aac\u660e Scala \u76f8\u5f53 <code>async action</code> \u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u8d77\u52d5 <code>fiber.start</code> <code>wait handle</code> \u5b8c\u4e86\u3092\u5f85\u6a5f <code>fiber.join</code> <code>cancel handle</code> \u30ad\u30e3\u30f3\u30bb\u30eb <code>fiber.cancel</code> <code>race a b</code> \u5148\u306b\u5b8c\u4e86\u3057\u305f\u65b9\u3092\u8fd4\u3059 <code>IO.race</code> <code>concurrently a b</code> \u4e21\u65b9\u3092\u4e26\u884c\u5b9f\u884c <code>IO.both</code>"},{"location":"haskell/part-5/#107-race-","title":"10.7 Race - \u7af6\u4e89","text":"<p>2\u3064\u306e IO \u3092\u7af6\u4e89\u3055\u305b\u3001\u5148\u306b\u5b8c\u4e86\u3057\u305f\u65b9\u306e\u7d50\u679c\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>import Control.Concurrent.Async (race)\nimport Control.Concurrent (threadDelay)\n\n-- \u5148\u306b\u5b8c\u4e86\u3057\u305f\u65b9\u306e\u7d50\u679c\u3092\u8fd4\u3059\nresult &lt;- race (return \"fast\") (threadDelay 1000000 &gt;&gt; return \"slow\")\n-- result: Left \"fast\"\n</code></pre>"},{"location":"haskell/part-5/#108","title":"10.8 \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8","text":"<pre><code>import System.Timeout (timeout)\n\n-- \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u4ed8\u304d\u3067\u5b9f\u884c\uff08\u30de\u30a4\u30af\u30ed\u79d2\u5358\u4f4d\uff09\nresult &lt;- timeout 1000000 (return 42)  -- 1\u79d2\n-- result: Just 42\n\n-- \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u3057\u305f\u5834\u5408\nresult &lt;- timeout 1000 (threadDelay 1000000 &gt;&gt; return 42)\n-- result: Nothing\n</code></pre>"},{"location":"haskell/part-5/#109","title":"10.9 \u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u51e6\u7406","text":"<p>Async \u3092\u4f7f\u3063\u3066\u3001\u547c\u3073\u51fa\u3057\u5143\u306b\u5236\u5fa1\u3092\u8fd4\u3057\u3064\u3064\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u51e6\u7406\u3092\u7d9a\u3051\u308b\u8a2d\u8a08\u304c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>data ProcessingCheckIns = ProcessingCheckIns\n    { currentRanking :: IO [CityStats]  -- \u73fe\u5728\u306e\u30e9\u30f3\u30ad\u30f3\u30b0\u3092\u53d6\u5f97\n    , stopProcessing :: IO ()           -- \u51e6\u7406\u3092\u505c\u6b62\n    }\n\nprocessCheckIns :: [City] -&gt; IO ProcessingCheckIns\nprocessCheckIns cities = do\n    state &lt;- newCheckInState\n\n    -- \u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u51e6\u7406\u3092\u958b\u59cb\n    handle &lt;- async $ mapM_ (recordCheckIn state) cities\n\n    return ProcessingCheckIns\n        { currentRanking = getTopCities 3 state\n        , stopProcessing = cancel handle\n        }\n</code></pre> <p></p>"},{"location":"haskell/part-5/#11-stmsoftware-transactional-memory","title":"\u7b2c11\u7ae0: STM\uff08Software Transactional Memory\uff09","text":""},{"location":"haskell/part-5/#111-stm","title":"11.1 STM \u3068\u306f","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/haskell/src/Ch11/STMProcessing.hs</code></p> <p>STM \u306f\u3001\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u30d9\u30fc\u30b9\u306e\u4e26\u884c\u51e6\u7406\u3092\u63d0\u4f9b\u3057\u307e\u3059\u3002\u8907\u6570\u306e\u5909\u6570\u3092\u5b89\u5168\u306b\u66f4\u65b0\u3067\u304d\u307e\u3059\u3002</p> <p></p>"},{"location":"haskell/part-5/#112-tvar-","title":"11.2 TVar - \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30ca\u30eb\u5909\u6570","text":"<p>TVar \u306f STM \u7528\u306e\u5909\u6570\u3067\u3059\u3002IORef \u3068\u4f3c\u3066\u3044\u307e\u3059\u304c\u3001\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u5185\u3067\u4f7f\u7528\u3057\u307e\u3059\u3002</p> <pre><code>import Control.Concurrent.STM\n\n-- TVar \u306e\u4f5c\u6210\u3068\u4f7f\u7528\nexample :: IO Int\nexample = do\n    counter &lt;- newTVarIO 0           -- \u521d\u671f\u5024 0 \u306e TVar \u3092\u4f5c\u6210\n    atomically $ modifyTVar' counter (+3)  -- \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u5185\u3067\u66f4\u65b0\n    readTVarIO counter               -- \u73fe\u5728\u306e\u5024\u3092\u53d6\u5f97\n</code></pre>"},{"location":"haskell/part-5/#tvar","title":"TVar \u306e\u4e3b\u8981\u95a2\u6570","text":"\u95a2\u6570 \u8aac\u660e \u30b3\u30f3\u30c6\u30ad\u30b9\u30c8 <code>newTVarIO initial</code> TVar \u3092\u4f5c\u6210 IO <code>newTVar initial</code> TVar \u3092\u4f5c\u6210 STM <code>readTVar var</code> \u5024\u3092\u8aad\u307f\u53d6\u308a STM <code>writeTVar var value</code> \u5024\u3092\u66f8\u304d\u8fbc\u307f STM <code>modifyTVar' var f</code> \u5024\u3092\u66f4\u65b0 STM <code>readTVarIO var</code> \u5024\u3092\u8aad\u307f\u53d6\u308a IO <code>atomically action</code> STM \u3092 IO \u3067\u5b9f\u884c IO"},{"location":"haskell/part-5/#113","title":"11.3 \u9280\u884c\u53e3\u5ea7\u306e\u4f8b","text":"<p>STM \u3092\u4f7f\u3063\u305f\u5b89\u5168\u306a\u9001\u91d1\u306e\u4f8b\u3067\u3059\u3002</p> <pre><code>-- \u53e3\u5ea7\u3092\u8868\u3059\u30c7\u30fc\u30bf\u578b\ndata Account = Account\n    { accountId      :: String\n    , accountBalance :: TVar Int\n    }\n\n-- \u65b0\u3057\u3044\u53e3\u5ea7\u3092\u4f5c\u6210\nnewAccount :: String -&gt; Int -&gt; IO Account\nnewAccount accId initialBalance = do\n    balanceVar &lt;- newTVarIO initialBalance\n    return $ Account accId balanceVar\n\n-- \u6b8b\u9ad8\u3092\u53d6\u5f97\ngetBalance :: Account -&gt; IO Int\ngetBalance = readTVarIO . accountBalance\n\n-- \u5165\u91d1\ndeposit :: Account -&gt; Int -&gt; IO ()\ndeposit acc amount = atomically $\n    modifyTVar' (accountBalance acc) (+ amount)\n\n-- \u51fa\u91d1\nwithdraw :: Account -&gt; Int -&gt; IO (Either String ())\nwithdraw acc amount = atomically $ do\n    balance &lt;- readTVar (accountBalance acc)\n    if balance &gt;= amount\n        then do\n            writeTVar (accountBalance acc) (balance - amount)\n            return $ Right ()\n        else return $ Left \"Insufficient funds\"\n</code></pre>"},{"location":"haskell/part-5/#_2","title":"\u5b89\u5168\u306a\u9001\u91d1\uff08\u30a2\u30c8\u30df\u30c3\u30af\uff09","text":"<pre><code>-- \u9001\u91d1\uff08\u30a2\u30c8\u30df\u30c3\u30af\u7248 - \u5b89\u5168\uff09\ntransferSafe :: Account -&gt; Account -&gt; Int -&gt; IO (Either String ())\ntransferSafe from to amount = atomically $ do\n    fromBalance &lt;- readTVar (accountBalance from)\n    if fromBalance &gt;= amount\n        then do\n            modifyTVar' (accountBalance from) (subtract amount)\n            modifyTVar' (accountBalance to) (+ amount)\n            return $ Right ()\n        else return $ Left \"Insufficient funds\"\n</code></pre>"},{"location":"haskell/part-5/#114-stm","title":"11.4 STM \u306e\u30ea\u30c8\u30e9\u30a4","text":"<p><code>retry</code> \u3092\u4f7f\u3046\u3068\u3001\u6761\u4ef6\u304c\u6e80\u305f\u3055\u308c\u308b\u307e\u3067\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u3092\u5f85\u6a5f\u3067\u304d\u307e\u3059\u3002</p> <pre><code>-- \u6b8b\u9ad8\u304c\u5341\u5206\u306b\u306a\u308b\u307e\u3067\u5f85\u6a5f\u3057\u3066\u51fa\u91d1\nwithdrawWait :: Account -&gt; Int -&gt; IO ()\nwithdrawWait acc amount = atomically $ do\n    balance &lt;- readTVar (accountBalance acc)\n    if balance &lt; amount\n        then retry  -- \u6b8b\u9ad8\u304c\u5909\u308f\u308b\u307e\u3067\u5f85\u6a5f\n        else modifyTVar' (accountBalance acc) (subtract amount)\n</code></pre>"},{"location":"haskell/part-5/#115-orelse-","title":"11.5 orElse - \u4ee3\u66ff\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3","text":"<p><code>orElse</code> \u3092\u4f7f\u3046\u3068\u3001\u6700\u521d\u306e\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u304c <code>retry</code> \u3057\u305f\u5834\u5408\u306b\u4ee3\u66ff\u3092\u8a66\u884c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>-- \u8907\u6570\u306e\u53e3\u5ea7\u304b\u3089\u51fa\u91d1\u3092\u8a66\u307f\u308b\nwithdrawFromAny :: [Account] -&gt; Int -&gt; IO (Either String Account)\nwithdrawFromAny accounts amount = atomically $\n    foldr tryAccount (return $ Left \"All accounts insufficient\") accounts\n  where\n    tryAccount acc alt = do\n        balance &lt;- readTVar (accountBalance acc)\n        if balance &gt;= amount\n            then do\n                modifyTVar' (accountBalance acc) (subtract amount)\n                return $ Right acc\n            else alt\n</code></pre>"},{"location":"haskell/part-5/#116","title":"11.6 \u5728\u5eab\u7ba1\u7406\u306e\u4f8b","text":"<pre><code>-- \u5728\u5eab\u3092\u8868\u3059\u30c7\u30fc\u30bf\u578b\ntype Inventory = TVar (Map String Int)\n\n-- \u5728\u5eab\u3092\u5225\u306e\u5009\u5eab\u306b\u79fb\u52d5\ntransferStock :: Inventory -&gt; Inventory -&gt; String -&gt; Int -&gt; IO (Either String ())\ntransferStock fromInv toInv item amount = atomically $ do\n    fromStock &lt;- readTVar fromInv\n    let currentAmount = Map.findWithDefault 0 item fromStock\n    if currentAmount &gt;= amount\n        then do\n            modifyTVar' fromInv $ Map.adjust (subtract amount) item\n            modifyTVar' toInv $ Map.insertWith (+) item amount\n            return $ Right ()\n        else return $ Left \"Insufficient stock\"\n</code></pre>"},{"location":"haskell/part-5/#117-tqueue","title":"11.7 \u4e26\u884c\u30ad\u30e5\u30fc\uff08TQueue\uff09","text":"<p>STM \u3092\u4f7f\u3063\u305f\u4e26\u884c\u30ad\u30e5\u30fc\u3067\u3059\u3002</p> <pre><code>import Control.Concurrent.STM.TQueue\n\n-- \u30ad\u30e5\u30fc\u306e\u4f5c\u6210\nq &lt;- newTQueueIO\n\n-- \u66f8\u304d\u8fbc\u307f\natomically $ writeTQueue q item\n\n-- \u8aad\u307f\u53d6\u308a\uff08\u30d6\u30ed\u30c3\u30ad\u30f3\u30b0\uff09\nitem &lt;- atomically $ readTQueue q\n\n-- \u8aad\u307f\u53d6\u308a\uff08\u30ce\u30f3\u30d6\u30ed\u30c3\u30ad\u30f3\u30b0\uff09\nmaybeItem &lt;- atomically $ tryReadTQueue q\n</code></pre>"},{"location":"haskell/part-5/#118-producer-consumer","title":"11.8 Producer-Consumer \u30d1\u30bf\u30fc\u30f3","text":"<pre><code>-- Producer\nproducer :: TQueue Int -&gt; Int -&gt; IO ()\nproducer q n = mapM_ (\\i -&gt; atomically $ writeTQueue q i) [1..n]\n\n-- Consumer\nconsumer :: TQueue Int -&gt; TVar Int -&gt; Int -&gt; IO ()\nconsumer q sumVar n = replicateM_ n $ do\n    item &lt;- atomically $ readTQueue q\n    atomically $ modifyTVar' sumVar (+ item)\n\n-- \u5b9f\u884c\nproducerConsumer :: Int -&gt; IO Int\nproducerConsumer n = do\n    q &lt;- newTQueueIO\n    sumVar &lt;- newTVarIO 0\n\n    _ &lt;- forkIO $ producer q n\n    consumer q sumVar n\n\n    readTVarIO sumVar\n</code></pre>"},{"location":"haskell/part-5/#119","title":"11.9 \u30bb\u30de\u30d5\u30a9","text":"<p>STM \u3092\u4f7f\u3063\u305f\u30bb\u30de\u30d5\u30a9\u306e\u5b9f\u88c5\u3067\u3059\u3002</p> <pre><code>-- \u30bb\u30de\u30d5\u30a9\u3092\u8868\u3059\u30c7\u30fc\u30bf\u578b\ntype Semaphore = TVar Int\n\n-- \u65b0\u3057\u3044\u30bb\u30de\u30d5\u30a9\u3092\u4f5c\u6210\nnewSemaphore :: Int -&gt; IO Semaphore\nnewSemaphore = newTVarIO\n\n-- \u30bb\u30de\u30d5\u30a9\u3092\u53d6\u5f97\nacquireSemaphore :: Semaphore -&gt; IO ()\nacquireSemaphore sem = atomically $ do\n    count &lt;- readTVar sem\n    if count &gt; 0\n        then writeTVar sem (count - 1)\n        else retry  -- \u7a7a\u304d\u304c\u3067\u304d\u308b\u307e\u3067\u5f85\u6a5f\n\n-- \u30bb\u30de\u30d5\u30a9\u3092\u89e3\u653e\nreleaseSemaphore :: Semaphore -&gt; IO ()\nreleaseSemaphore sem = atomically $ modifyTVar' sem (+1)\n\n-- \u30bb\u30de\u30d5\u30a9\u3067\u4fdd\u8b77\u3055\u308c\u305f\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u5b9f\u884c\nwithSemaphore :: Semaphore -&gt; IO a -&gt; IO a\nwithSemaphore sem action = do\n    acquireSemaphore sem\n    result &lt;- action\n    releaseSemaphore sem\n    return result\n</code></pre>"},{"location":"haskell/part-5/#_3","title":"\u307e\u3068\u3081","text":""},{"location":"haskell/part-5/#part-v_1","title":"Part V \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"haskell/part-5/#scala-haskell","title":"Scala \u3068 Haskell \u306e\u6bd4\u8f03","text":"\u6982\u5ff5 Scala (cats-effect) Haskell \u53ef\u5909\u53c2\u7167 <code>Ref[IO, A]</code> <code>IORef a</code> / <code>TVar a</code> \u4e26\u5217\u5b9f\u884c <code>parSequence</code> <code>mapConcurrently id</code> \u8efd\u91cf\u30b9\u30ec\u30c3\u30c9 <code>Fiber</code> <code>Async</code> \u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u5b9f\u884c <code>fiber.start</code> <code>async</code> \u30ad\u30e3\u30f3\u30bb\u30eb <code>fiber.cancel</code> <code>cancel</code> \u7af6\u4e89 <code>IO.race</code> <code>race</code> \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3 \u306a\u3057\uff08cats-stm\uff09 <code>STM</code>"},{"location":"haskell/part-5/#_4","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>IORef: IO \u30e2\u30ca\u30c9\u5185\u3067\u53ef\u5909\u53c2\u7167\u3092\u63d0\u4f9b\u3001<code>atomicModifyIORef'</code> \u3067\u30a2\u30c8\u30df\u30c3\u30af\u66f4\u65b0</li> <li>Async: \u8efd\u91cf\u30b9\u30ec\u30c3\u30c9\u3067\u4e26\u884c\u51e6\u7406\u3001<code>async</code> / <code>wait</code> / <code>cancel</code></li> <li>mapConcurrently: IO \u306e\u30ea\u30b9\u30c8\u3092\u4e26\u5217\u5b9f\u884c</li> <li>STM: \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u30d9\u30fc\u30b9\u306e\u4e26\u884c\u51e6\u7406\u3001\u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u30d5\u30ea\u30fc</li> <li>TVar: STM \u7528\u306e\u5909\u6570\u3001<code>atomically</code> \u30d6\u30ed\u30c3\u30af\u5185\u3067\u4f7f\u7528</li> <li>retry: \u6761\u4ef6\u304c\u6e80\u305f\u3055\u308c\u308b\u307e\u3067\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u3092\u5f85\u6a5f</li> <li>orElse: \u4ee3\u66ff\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u3092\u8a66\u884c</li> </ol>"},{"location":"haskell/part-5/#_5","title":"\u8a2d\u8a08\u30d1\u30bf\u30fc\u30f3","text":""},{"location":"haskell/part-5/#_6","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part VI \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li>\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9</li> <li>\u5916\u90e8 API \u3068\u306e\u9023\u643a</li> <li>\u30c6\u30b9\u30c8\u6226\u7565</li> </ul>"},{"location":"haskell/part-5/#_7","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"haskell/part-5/#1-ioref","title":"\u554f\u984c 1: IORef \u306e\u57fa\u672c","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u30ab\u30a6\u30f3\u30bf\u30fc\u3092 0 \u304b\u3089\u59cb\u3081\u3066\u30013\u56de\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\u3057\u305f\u7d50\u679c\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>incrementThreeTimes :: IO Int\nincrementThreeTimes = ???\n\n-- \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\n-- &gt; incrementThreeTimes\n-- 3\n</code></pre> \u89e3\u7b54 <pre><code>incrementThreeTimes :: IO Int\nincrementThreeTimes = do\n    counter &lt;- newIORef 0\n    atomicModifyIORef' counter (\\n -&gt; (n + 1, ()))\n    atomicModifyIORef' counter (\\n -&gt; (n + 1, ()))\n    atomicModifyIORef' counter (\\n -&gt; (n + 1, ()))\n    readIORef counter\n</code></pre>"},{"location":"haskell/part-5/#2","title":"\u554f\u984c 2: \u4e26\u5217\u5b9f\u884c","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u30023\u3064\u306e IO \u3092\u4e26\u5217\u5b9f\u884c\u3057\u3001\u7d50\u679c\u306e\u5408\u8a08\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>sumParallel :: IO Int -&gt; IO Int -&gt; IO Int -&gt; IO Int\nsumParallel io1 io2 io3 = ???\n\n-- \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\n-- &gt; sumParallel (return 1) (return 2) (return 3)\n-- 6\n</code></pre> \u89e3\u7b54 <pre><code>import Control.Concurrent.Async (mapConcurrently)\n\nsumParallel :: IO Int -&gt; IO Int -&gt; IO Int -&gt; IO Int\nsumParallel io1 io2 io3 = sum &lt;$&gt; mapConcurrently id [io1, io2, io3]\n</code></pre>"},{"location":"haskell/part-5/#3-stm","title":"\u554f\u984c 3: STM \u9001\u91d1","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u8907\u6570\u306e\u53e3\u5ea7\u9593\u3067\u5b89\u5168\u306b\u9001\u91d1\u3057\u307e\u3059\u3002</p> <pre><code>-- \u8907\u6570\u306e\u9001\u91d1\u3092\u30a2\u30c8\u30df\u30c3\u30af\u306b\u5b9f\u884c\nmultiTransfer :: [(Account, Account, Int)] -&gt; IO ()\nmultiTransfer transfers = ???\n</code></pre> \u89e3\u7b54 <pre><code>multiTransfer :: [(Account, Account, Int)] -&gt; IO ()\nmultiTransfer transfers = atomically $ mapM_ doTransfer transfers\n  where\n    doTransfer (from, to, amount) = do\n        fromBalance &lt;- readTVar (accountBalance from)\n        when (fromBalance &gt;= amount) $ do\n            modifyTVar' (accountBalance from) (subtract amount)\n            modifyTVar' (accountBalance to) (+ amount)\n</code></pre>"},{"location":"haskell/part-5/#4","title":"\u554f\u984c 4: \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u4ed8\u304d\u5b9f\u884c","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u6307\u5b9a\u6642\u9593\u5f8c\u306b Async \u3092\u30ad\u30e3\u30f3\u30bb\u30eb\u3057\u3001\u305d\u308c\u307e\u3067\u306b\u84c4\u7a4d\u3055\u308c\u305f\u7d50\u679c\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>collectFor :: Int -&gt; IO [Int]  -- \u30df\u30ea\u79d2\ncollectFor duration = ???\n\n-- \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\n-- 1\u79d2\u9593\u3001100ms\u3054\u3068\u306b\u4e71\u6570\u3092\u751f\u6210\u3057\u3066\u30ea\u30b9\u30c8\u306b\u8ffd\u52a0\n-- \u7d0410\u500b\u306e\u8981\u7d20\u304c\u8fd4\u3055\u308c\u308b\n-- &gt; collectFor 1000\n-- [42, 17, 83, ...]\n</code></pre> \u89e3\u7b54 <pre><code>import Control.Concurrent (threadDelay)\nimport Control.Concurrent.Async (async, cancel)\nimport System.Random (randomRIO)\n\ncollectFor :: Int -&gt; IO [Int]\ncollectFor duration = do\n    collected &lt;- newIORef []\n\n    -- 100ms\u3054\u3068\u306b\u4e71\u6570\u3092\u8ffd\u52a0\n    handle &lt;- async $ forever $ do\n        threadDelay 100000  -- 100ms\n        n &lt;- randomRIO (1, 100)\n        atomicModifyIORef' collected (\\xs -&gt; (xs ++ [n], ()))\n\n    -- \u6307\u5b9a\u6642\u9593\u5f85\u6a5f\n    threadDelay (duration * 1000)\n\n    -- \u30ad\u30e3\u30f3\u30bb\u30eb\n    cancel handle\n\n    -- \u7d50\u679c\u3092\u53d6\u5f97\n    readIORef collected\n</code></pre>"},{"location":"haskell/part-5/#5-producer-consumer","title":"\u554f\u984c 5: Producer-Consumer","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u8907\u6570\u306e Producer \u3068 Consumer \u3092\u4f7f\u7528\u3057\u307e\u3059\u3002</p> <pre><code>-- n\u500b\u306eProducer\u304c\u305d\u308c\u305e\u308cm\u500b\u306e\u30a2\u30a4\u30c6\u30e0\u3092\u751f\u6210\n-- 1\u500b\u306eConsumer\u304c\u5168\u3066\u3092\u6d88\u8cbb\u3057\u3066\u5408\u8a08\u3092\u8fd4\u3059\nmultiProducerConsumer :: Int -&gt; Int -&gt; IO Int\nmultiProducerConsumer numProducers itemsPerProducer = ???\n</code></pre> \u89e3\u7b54 <pre><code>import Control.Concurrent (forkIO)\nimport Control.Concurrent.STM\nimport Control.Monad (replicateM_)\n\nmultiProducerConsumer :: Int -&gt; Int -&gt; IO Int\nmultiProducerConsumer numProducers itemsPerProducer = do\n    q &lt;- newTQueueIO\n    sumVar &lt;- newTVarIO 0\n\n    -- \u8907\u6570\u306eProducer\u3092\u8d77\u52d5\n    replicateM_ numProducers $ forkIO $\n        mapM_ (\\i -&gt; atomically $ writeTQueue q i) [1..itemsPerProducer]\n\n    -- Consumer\uff08\u5168\u30a2\u30a4\u30c6\u30e0\u3092\u6d88\u8cbb\uff09\n    let totalItems = numProducers * itemsPerProducer\n    replicateM_ totalItems $ do\n        item &lt;- atomically $ readTQueue q\n        atomically $ modifyTVar' sumVar (+ item)\n\n    readTVarIO sumVar\n</code></pre>"},{"location":"haskell/part-6/","title":"Part VI: \u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u3068\u30c6\u30b9\u30c8","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u3053\u308c\u307e\u3067\u5b66\u3093\u3060\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u6982\u5ff5\u3092\u7d71\u5408\u3057\u3001\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002\u307e\u305f\u3001Haskell \u306b\u304a\u3051\u308b\u30c6\u30b9\u30c8\u6226\u7565\u306b\u3064\u3044\u3066\u3082\u5b66\u3073\u307e\u3059\u3002</p>"},{"location":"haskell/part-6/#12","title":"\u7b2c12\u7ae0: \u30c6\u30b9\u30c8\u6226\u7565\u3068\u5b9f\u8df5\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3","text":""},{"location":"haskell/part-6/#121-travelguide","title":"12.1 TravelGuide \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/haskell/src/Ch12/TestingStrategies.hs</code></p> <p>\u65c5\u884c\u30ac\u30a4\u30c9\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f8b\u306b\u3001\u5b9f\u8df5\u7684\u306a FP \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u69cb\u7bc9\u65b9\u6cd5\u3092\u5b66\u3073\u307e\u3059\u3002</p> <p></p>"},{"location":"haskell/part-6/#122","title":"12.2 \u30c9\u30e1\u30a4\u30f3\u30e2\u30c7\u30eb\u306e\u5b9a\u7fa9","text":"<pre><code>-- \u4f4d\u7f6eID\uff08\u5024\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\uff09\nnewtype LocationId = LocationId { unLocationId :: String }\n    deriving (Show, Eq, Ord)\n\n-- \u30ed\u30b1\u30fc\u30b7\u30e7\u30f3\ndata Location = Location\n    { locId         :: LocationId\n    , locName       :: String\n    , locPopulation :: Int\n    } deriving (Show, Eq)\n\n-- \u30a2\u30c8\u30e9\u30af\u30b7\u30e7\u30f3\uff08\u89b3\u5149\u5730\uff09\ndata Attraction = Attraction\n    { attrName        :: String\n    , attrDescription :: Maybe String\n    , attrLocation    :: Location\n    } deriving (Show, Eq)\n\n-- \u65c5\u884c\u30ac\u30a4\u30c9\ndata TravelGuide = TravelGuide\n    { tgAttraction   :: Attraction\n    , tgSubjects     :: [String]\n    , tgSearchReport :: SearchReport\n    } deriving (Show, Eq)\n</code></pre> <p>Scala \u3068\u306e\u5bfe\u5fdc: - <code>opaque type LocationId</code> \u2192 <code>newtype LocationId</code> - <code>case class</code> \u2192 <code>data</code> with record syntax - <code>Option[String]</code> \u2192 <code>Maybe String</code></p>"},{"location":"haskell/part-6/#123","title":"12.3 \u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\u5c64\u306e\u62bd\u8c61\u5316","text":"<p>\u5916\u90e8\u30c7\u30fc\u30bf\u30bd\u30fc\u30b9\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u30ec\u30b3\u30fc\u30c9\u578b\u3067\u62bd\u8c61\u5316\u3057\u307e\u3059\u3002</p> <pre><code>-- \u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\ndata DataAccess = DataAccess\n    { findAttractions         :: String -&gt; AttractionOrdering -&gt; Int -&gt; IO [Attraction]\n    , findArtistsFromLocation :: LocationId -&gt; Int -&gt; IO (Either String [MusicArtist])\n    , findMoviesAboutLocation :: LocationId -&gt; Int -&gt; IO (Either String [Movie])\n    }\n</code></pre> <p></p> <p>Scala \u3068\u306e\u5bfe\u5fdc: - <code>trait DataAccess</code> \u2192 <code>data DataAccess = DataAccess { ... }</code> - \u30e1\u30bd\u30c3\u30c9 \u2192 \u30ec\u30b3\u30fc\u30c9\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\uff08\u95a2\u6570\u578b\uff09</p>"},{"location":"haskell/part-6/#124","title":"12.4 \u30c6\u30b9\u30c8\u7528\u30b9\u30bf\u30d6\u306e\u4f5c\u6210","text":"<pre><code>-- \u30c6\u30b9\u30c8\u7528\u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\u306e\u4f5c\u6210\nmkTestDataAccess :: IO DataAccess\nmkTestDataAccess = return DataAccess\n    { findAttractions = \\name _ limit -&gt;\n        return $ take limit\n            [ Attraction\n                { attrName = \"Test Attraction\"\n                , attrDescription = Just \"A test attraction\"\n                , attrLocation = Location (LocationId \"Q123\") \"Test City\" 100000\n                }\n            | name == \"Test\" || name == \"\"\n            ]\n    , findArtistsFromLocation = \\_ limit -&gt;\n        return $ Right $ take limit [MusicArtist \"Test Artist\"]\n    , findMoviesAboutLocation = \\_ limit -&gt;\n        return $ Right $ take limit [Movie \"Test Movie\"]\n    }\n\n-- \u5931\u6557\u3059\u308b\u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\uff08\u30a8\u30e9\u30fc\u30c6\u30b9\u30c8\u7528\uff09\nmkFailingDataAccess :: IO DataAccess\nmkFailingDataAccess = return DataAccess\n    { findAttractions = \\_ _ limit -&gt;\n        return $ take limit [testAttraction]\n    , findArtistsFromLocation = \\_ _ -&gt;\n        return $ Left \"Network error\"\n    , findMoviesAboutLocation = \\_ _ -&gt;\n        return $ Left \"Timeout\"\n    }\n</code></pre>"},{"location":"haskell/part-6/#125-searchreport","title":"12.5 SearchReport \u306e\u5c0e\u5165","text":"<p>\u30c6\u30b9\u30c8\u53ef\u80fd\u6027\u3092\u9ad8\u3081\u308b\u305f\u3081\u3001<code>SearchReport</code> \u3092\u5c0e\u5165\u3057\u307e\u3059\u3002</p> <pre><code>-- \u691c\u7d22\u30ec\u30dd\u30fc\u30c8\ndata SearchReport = SearchReport\n    { srAttractionsSearched :: Int\n    , srErrors              :: [String]\n    } deriving (Show, Eq)\n\n-- \u65c5\u884c\u30ac\u30a4\u30c9\uff08SearchReport \u4ed8\u304d\uff09\ndata TravelGuide = TravelGuide\n    { tgAttraction   :: Attraction\n    , tgSubjects     :: [String]\n    , tgSearchReport :: SearchReport\n    } deriving (Show, Eq)\n</code></pre> <p></p>"},{"location":"haskell/part-6/#126","title":"12.6 \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u30ed\u30b8\u30c3\u30af","text":"<pre><code>-- \u65c5\u884c\u30ac\u30a4\u30c9\u3092\u53d6\u5f97\uff08SearchReport \u4ed8\u304d\uff09\ntravelGuideWithReport :: DataAccess -&gt; String -&gt; IO (Maybe TravelGuide)\ntravelGuideWithReport da attractionName = do\n    attractions &lt;- findAttractions da attractionName AttrByLocationPopulation 3\n    case attractions of\n        [] -&gt; return Nothing\n        (attraction:_) -&gt; do\n            let locId' = locId $ attrLocation attraction\n            artistsResult &lt;- findArtistsFromLocation da locId' 2\n            moviesResult &lt;- findMoviesAboutLocation da locId' 2\n\n            let errors = collectErrors [artistsResult, moviesResult]\n            let artists = either (const []) id artistsResult\n            let movies = either (const []) id moviesResult\n            let subjects = map artistName artists ++ map movieName movies\n\n            return $ Just TravelGuide\n                { tgAttraction = attraction\n                , tgSubjects = subjects\n                , tgSearchReport = SearchReport (length attractions) errors\n                }\n  where\n    collectErrors :: [Either String a] -&gt; [String]\n    collectErrors = foldr (\\r acc -&gt; either (:acc) (const acc) r) []\n</code></pre>"},{"location":"haskell/part-6/#127","title":"12.7 \u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u5b9f\u88c5","text":"<p><code>IORef</code> \u3092\u4f7f\u7528\u3057\u305f\u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u5b9f\u88c5:</p> <pre><code>import Data.IORef\nimport Data.Map.Strict (Map)\nimport qualified Data.Map.Strict as Map\n\n-- \u30ad\u30e3\u30c3\u30b7\u30e5\u4ed8\u304d\u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\ntype CachedDataAccess = (DataAccess, IORef (Map String [Attraction]))\n\n-- \u30ad\u30e3\u30c3\u30b7\u30e5\u4ed8\u304d\u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\u306e\u4f5c\u6210\nmkCachedDataAccess :: DataAccess -&gt; IO CachedDataAccess\nmkCachedDataAccess da = do\n    cache &lt;- newIORef Map.empty\n    return (da, cache)\n\n-- \u30ad\u30e3\u30c3\u30b7\u30e5\u4ed8\u304d\u30a2\u30c8\u30e9\u30af\u30b7\u30e7\u30f3\u691c\u7d22\ncachedFindAttractions :: CachedDataAccess -&gt; String -&gt; AttractionOrdering -&gt; Int -&gt; IO [Attraction]\ncachedFindAttractions (da, cache) name ordering limit = do\n    let key = name ++ \"-\" ++ show ordering ++ \"-\" ++ show limit\n    cached &lt;- Map.lookup key &lt;$&gt; readIORef cache\n    case cached of\n        Just attractions -&gt; return attractions  -- \u30ad\u30e3\u30c3\u30b7\u30e5\u30d2\u30c3\u30c8\n        Nothing -&gt; do\n            attractions &lt;- findAttractions da name ordering limit\n            atomicModifyIORef' cache (\\m -&gt; (Map.insert key attractions m, ()))\n            return attractions\n</code></pre> <p></p>"},{"location":"haskell/part-6/#128-bracket","title":"12.8 \u30ea\u30bd\u30fc\u30b9\u7ba1\u7406\uff08bracket\uff09","text":"<p>Haskell \u306e <code>bracket</code> \u3092\u4f7f\u7528\u3057\u3066\u3001\u5b89\u5168\u306a\u30ea\u30bd\u30fc\u30b9\u7ba1\u7406\u3092\u5b9f\u73fe\u3057\u307e\u3059\u3002</p> <pre><code>import Control.Exception (bracket)\nimport System.IO (Handle, openFile, hClose, hGetContents, IOMode(..))\n\n-- \u30ea\u30bd\u30fc\u30b9\u3092\u5b89\u5168\u306b\u4f7f\u7528\nwithResource :: IO a -&gt; (a -&gt; IO ()) -&gt; (a -&gt; IO b) -&gt; IO b\nwithResource acquire release = bracket acquire release\n\n-- \u30d5\u30a1\u30a4\u30eb\u3092\u5b89\u5168\u306b\u958b\u304f\nwithFile' :: FilePath -&gt; IOMode -&gt; (Handle -&gt; IO a) -&gt; IO a\nwithFile' path mode = bracket (openFile path mode) hClose\n\n-- \u4f7f\u7528\u4f8b\nreadFileContents :: FilePath -&gt; IO (Either String String)\nreadFileContents path = do\n    result &lt;- try $ withFile' path ReadMode hGetContents\n    case result of\n        Left e  -&gt; return $ Left (show e)\n        Right c -&gt; return $ Right c\n</code></pre> <p></p> <p>Scala \u3068\u306e\u5bfe\u5fdc: - <code>Resource[IO, A]</code> \u2192 <code>bracket acquire release use</code> - <code>Resource.make(acquire)(release)</code> \u2192 <code>bracket acquire release</code></p>"},{"location":"haskell/part-6/#129","title":"12.9 \u7d14\u7c8b\u95a2\u6570\u306e\u30c6\u30b9\u30c8","text":"<p>\u7d14\u7c8b\u95a2\u6570\u306f\u526f\u4f5c\u7528\u304c\u306a\u3044\u305f\u3081\u3001\u30c6\u30b9\u30c8\u304c\u975e\u5e38\u306b\u7c21\u5358\u3067\u3059\u3002</p> <pre><code>-- \u4eba\u53e3\u3067\u30ed\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\uff08\u7d14\u7c8b\u95a2\u6570\uff09\nfilterPopularLocations :: [Location] -&gt; Int -&gt; [Location]\nfilterPopularLocations locations minPopulation =\n    filter (\\loc -&gt; locPopulation loc &gt;= minPopulation) locations\n\n-- \u30a2\u30c8\u30e9\u30af\u30b7\u30e7\u30f3\u3092\u4eba\u53e3\u3067\u30bd\u30fc\u30c8\uff08\u7d14\u7c8b\u95a2\u6570\uff09\nsortAttractionsByPopulation :: [Attraction] -&gt; [Attraction]\nsortAttractionsByPopulation =\n    sortBy (\\a b -&gt; compare (Down $ locPopulation $ attrLocation a)\n                            (Down $ locPopulation $ attrLocation b))\n\n-- \u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\uff08\u7d14\u7c8b\u95a2\u6570\uff09\nvalidateLocation :: Location -&gt; Either String Location\nvalidateLocation loc\n    | null (unLocationId $ locId loc) = Left \"Location ID cannot be empty\"\n    | null (locName loc) = Left \"Location name cannot be empty\"\n    | locPopulation loc &lt; 0 = Left \"Population cannot be negative\"\n    | otherwise = Right loc\n</code></pre>"},{"location":"haskell/part-6/#1210-hspec","title":"12.10 HSpec \u306b\u3088\u308b\u30e6\u30cb\u30c3\u30c8\u30c6\u30b9\u30c8","text":"<pre><code>import Test.Hspec\n\nspec :: Spec\nspec = do\n    describe \"filterPopularLocations\" $ do\n        it \"filters by minimum population\" $ do\n            let locs = [ Location (LocationId \"1\") \"A\" 100\n                       , Location (LocationId \"2\") \"B\" 200\n                       , Location (LocationId \"3\") \"C\" 150\n                       ]\n            let filtered = filterPopularLocations locs 150\n            length filtered `shouldBe` 2\n\n        it \"returns empty for high minimum\" $ do\n            let locs = [Location (LocationId \"1\") \"A\" 100]\n            filterPopularLocations locs 1000 `shouldBe` []\n\n    describe \"validateLocation\" $ do\n        it \"validates correct location\" $ do\n            let loc = Location (LocationId \"Q1\") \"Tokyo\" 14000000\n            validateLocation loc `shouldBe` Right loc\n\n        it \"rejects empty ID\" $ do\n            let loc = Location (LocationId \"\") \"Tokyo\" 14000000\n            validateLocation loc `shouldBe` Left \"Location ID cannot be empty\"\n</code></pre>"},{"location":"haskell/part-6/#1211-quickcheck","title":"12.11 QuickCheck \u306b\u3088\u308b\u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8","text":"<p>QuickCheck \u3092\u4f7f\u7528\u3057\u305f\u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8:</p> <pre><code>import Test.QuickCheck\n\n-- Arbitrary \u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306e\u5b9a\u7fa9\ninstance Arbitrary LocationId where\n    arbitrary = LocationId &lt;$&gt; listOf1 (elements ['a'..'z'])\n\ninstance Arbitrary Location where\n    arbitrary = Location\n        &lt;$&gt; arbitrary\n        &lt;*&gt; listOf1 (elements ['A'..'Z'])\n        &lt;*&gt; (abs &lt;$&gt; arbitrary)\n\n-- \u30d7\u30ed\u30d1\u30c6\u30a3\u30c6\u30b9\u30c8\nspec :: Spec\nspec = do\n    describe \"Property-based tests\" $ do\n        it \"filterPopularLocations result size &lt;= input size\" $\n            property $ \\(locs :: [Location]) (minPop :: Int) -&gt;\n                length (filterPopularLocations locs (abs minPop)) &lt;= length locs\n\n        it \"filterPopularLocations all results meet minimum\" $\n            property $ \\(locs :: [Location]) (minPop :: Int) -&gt;\n                let filtered = filterPopularLocations locs (abs minPop)\n                in all (\\loc -&gt; locPopulation loc &gt;= abs minPop) filtered\n\n        it \"sortAttractionsByPopulation preserves length\" $\n            property $ \\(attrs :: [Attraction]) -&gt;\n                length (sortAttractionsByPopulation attrs) == length attrs\n</code></pre> <p></p> <p>Scala \u3068\u306e\u5bfe\u5fdc: - ScalaCheck <code>Gen[A]</code> \u2192 QuickCheck <code>Arbitrary a</code> - <code>forAll</code> \u2192 <code>property</code></p>"},{"location":"haskell/part-6/#1212","title":"12.12 \u7d71\u5408\u30c6\u30b9\u30c8","text":"<pre><code>describe \"Integration tests\" $ do\n    it \"travelGuide returns guide for valid attraction\" $ do\n        da &lt;- mkTestDataAccess\n        guide &lt;- travelGuide da \"Test\"\n        guide `shouldSatisfy` \\g -&gt; case g of\n            Just g' -&gt; attrName (tgAttraction g') == \"Test Attraction\"\n            Nothing -&gt; False\n\n    it \"travelGuideWithReport collects errors\" $ do\n        da &lt;- mkFailingDataAccess\n        guide &lt;- travelGuideWithReport da \"Test\"\n        case guide of\n            Just g -&gt; do\n                let errors = srErrors (tgSearchReport g)\n                length errors `shouldBe` 2\n                errors `shouldContain` [\"Network error\"]\n            Nothing -&gt; expectationFailure \"Expected Just\"\n\n    it \"still returns guide even with errors\" $ do\n        da &lt;- mkFailingDataAccess\n        guide &lt;- travelGuideWithReport da \"Test\"\n        guide `shouldSatisfy` \\g -&gt; case g of\n            Just _ -&gt; True\n            Nothing -&gt; False\n</code></pre>"},{"location":"haskell/part-6/#1213","title":"12.13 \u30c6\u30b9\u30c8\u30d4\u30e9\u30df\u30c3\u30c9","text":""},{"location":"haskell/part-6/#_1","title":"\u307e\u3068\u3081","text":""},{"location":"haskell/part-6/#part-vi_1","title":"Part VI \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"haskell/part-6/#scala-haskell","title":"Scala \u3068 Haskell \u306e\u6bd4\u8f03","text":"\u6982\u5ff5 Scala Haskell \u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9 <code>trait</code> <code>data</code> (\u30ec\u30b3\u30fc\u30c9\u578b) \u5024\u30aa\u30d6\u30b8\u30a7\u30af\u30c8 <code>opaque type</code> <code>newtype</code> \u30aa\u30d7\u30b7\u30e7\u30ca\u30eb <code>Option[A]</code> <code>Maybe a</code> \u30ea\u30bd\u30fc\u30b9\u7ba1\u7406 <code>Resource[IO, A]</code> <code>bracket</code> \u30ad\u30e3\u30c3\u30b7\u30e5 <code>Ref[IO, Map]</code> <code>IORef (Map ...)</code> \u30e6\u30cb\u30c3\u30c8\u30c6\u30b9\u30c8 ScalaTest HSpec \u30d7\u30ed\u30d1\u30c6\u30a3\u30c6\u30b9\u30c8 ScalaCheck QuickCheck \u30b8\u30a7\u30cd\u30ec\u30fc\u30bf <code>Gen[A]</code> <code>Arbitrary a</code>"},{"location":"haskell/part-6/#_2","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>\u62bd\u8c61\u5316\u306e\u91cd\u8981\u6027: \u30ec\u30b3\u30fc\u30c9\u578b\u3067\u5916\u90e8\u4f9d\u5b58\u3092\u62bd\u8c61\u5316</li> <li>bracket \u3067\u30ea\u30bd\u30fc\u30b9\u7ba1\u7406: \u5b89\u5168\u306a\u30ea\u30bd\u30fc\u30b9\u306e\u53d6\u5f97\u3068\u89e3\u653e</li> <li>IORef \u3067\u30ad\u30e3\u30c3\u30b7\u30e5: \u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u72b6\u614b\u7ba1\u7406</li> <li>Either \u3067\u30a8\u30e9\u30fc\u51e6\u7406: \u660e\u793a\u7684\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0</li> <li>SearchReport: \u30c6\u30b9\u30c8\u53ef\u80fd\u6027\u3068\u53ef\u89b3\u6e2c\u6027\u306e\u5411\u4e0a</li> <li>\u30b9\u30bf\u30d6: \u5916\u90e8\u4f9d\u5b58\u3092\u5dee\u3057\u66ff\u3048\u3066\u30c6\u30b9\u30c8</li> <li>\u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8: QuickCheck \u3067\u30e9\u30f3\u30c0\u30e0\u5165\u529b\u306b\u3088\u308b\u4e0d\u5909\u6761\u4ef6\u306e\u691c\u8a3c</li> </ol>"},{"location":"haskell/part-6/#_3","title":"\u5b66\u7fd2\u306e\u7dcf\u62ec","text":""},{"location":"haskell/part-6/#_4","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"haskell/part-6/#1-dataaccess","title":"\u554f\u984c 1: DataAccess \u306e\u62e1\u5f35","text":"<p>\u4ee5\u4e0b\u306e\u8981\u4ef6\u3067 <code>DataAccess</code> \u3092\u62e1\u5f35\u3057\u3066\u304f\u3060\u3055\u3044: - \u65b0\u3057\u3044\u30d5\u30a3\u30fc\u30eb\u30c9 <code>findHotelsNearLocation</code> \u3092\u8ffd\u52a0 - \u623b\u308a\u5024\u306f <code>IO (Either String [Hotel])</code></p> <pre><code>data Hotel = Hotel\n    { hotelName     :: String\n    , hotelRating   :: Double\n    , hotelLocation :: Location\n    } deriving (Show, Eq)\n</code></pre> \u89e3\u7b54 <pre><code>data DataAccess = DataAccess\n    { findAttractions         :: String -&gt; AttractionOrdering -&gt; Int -&gt; IO [Attraction]\n    , findArtistsFromLocation :: LocationId -&gt; Int -&gt; IO (Either String [MusicArtist])\n    , findMoviesAboutLocation :: LocationId -&gt; Int -&gt; IO (Either String [Movie])\n    , findHotelsNearLocation  :: LocationId -&gt; Int -&gt; IO (Either String [Hotel])\n    }\n\n-- \u30c6\u30b9\u30c8\u7528\u30b9\u30bf\u30d6\nmkTestDataAccess :: IO DataAccess\nmkTestDataAccess = return DataAccess\n    { -- \u65e2\u5b58\u306e\u5b9f\u88c5...\n    , findHotelsNearLocation = \\_ limit -&gt;\n        return $ Right $ take limit\n            [Hotel \"Test Hotel\" 4.5 (Location (LocationId \"Q123\") \"Test City\" 100000)]\n    }\n</code></pre>"},{"location":"haskell/part-6/#2","title":"\u554f\u984c 2: \u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u306b\u5bfe\u3059\u308b\u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8\u3092\u66f8\u3044\u3066\u304f\u3060\u3055\u3044:</p> <pre><code>combineSubjects :: [MusicArtist] -&gt; [Movie] -&gt; [String]\ncombineSubjects artists movies =\n    map artistName artists ++ map movieName movies\n</code></pre> \u89e3\u7b54 <pre><code>import Test.QuickCheck\n\ninstance Arbitrary MusicArtist where\n    arbitrary = MusicArtist &lt;$&gt; listOf1 (elements ['A'..'Z'])\n\ninstance Arbitrary Movie where\n    arbitrary = Movie &lt;$&gt; listOf1 (elements ['A'..'Z'])\n\nspec :: Spec\nspec = do\n    describe \"combineSubjects properties\" $ do\n        it \"length is sum of inputs\" $\n            property $ \\(artists :: [MusicArtist]) (movies :: [Movie]) -&gt;\n                length (combineSubjects artists movies) == length artists + length movies\n\n        it \"artists come first\" $\n            property $ \\(artists :: [MusicArtist]) (movies :: [Movie]) -&gt;\n                let result = combineSubjects artists movies\n                    artistNames = map artistName artists\n                in take (length artists) result == artistNames\n\n        it \"movies come after artists\" $\n            property $ \\(artists :: [MusicArtist]) (movies :: [Movie]) -&gt;\n                let result = combineSubjects artists movies\n                    movieNames = map movieName movies\n                in drop (length artists) result == movieNames\n</code></pre>"},{"location":"haskell/part-6/#3-bracket","title":"\u554f\u984c 3: bracket \u306e\u5b9f\u88c5","text":"<p>\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u63a5\u7d9a\u3092\u5b89\u5168\u306b\u7ba1\u7406\u3059\u308b\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>data Connection = Connection { connId :: Int }\n\n-- \u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\nwithConnection :: IO Connection -&gt; (Connection -&gt; IO a) -&gt; IO a\n</code></pre> \u89e3\u7b54 <pre><code>import Control.Exception (bracket)\n\ndata Connection = Connection { connId :: Int }\n\n-- \u63a5\u7d9a\u3092\u958b\u304f\nopenConnection :: IO Connection\nopenConnection = do\n    putStrLn \"Opening connection...\"\n    return $ Connection 1\n\n-- \u63a5\u7d9a\u3092\u9589\u3058\u308b\ncloseConnection :: Connection -&gt; IO ()\ncloseConnection conn = putStrLn $ \"Closing connection \" ++ show (connId conn)\n\n-- \u5b89\u5168\u306b\u63a5\u7d9a\u3092\u4f7f\u7528\nwithConnection :: (Connection -&gt; IO a) -&gt; IO a\nwithConnection = bracket openConnection closeConnection\n\n-- \u4f7f\u7528\u4f8b\nqueryDatabase :: IO String\nqueryDatabase = withConnection $ \\conn -&gt; do\n    putStrLn $ \"Querying with connection \" ++ show (connId conn)\n    return \"Query result\"\n</code></pre>"},{"location":"haskell/part-6/#4","title":"\u554f\u984c 4: \u30a8\u30e9\u30fc\u53ce\u96c6","text":"<p>\u8907\u6570\u306e <code>Either</code> \u304b\u3089\u30a8\u30e9\u30fc\u3092\u53ce\u96c6\u3059\u308b\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>collectAllErrors :: [Either String a] -&gt; [String]\ncollectAllErrors = ???\n</code></pre> \u89e3\u7b54 <pre><code>collectAllErrors :: [Either String a] -&gt; [String]\ncollectAllErrors = foldr collect []\n  where\n    collect (Left err) acc = err : acc\n    collect (Right _) acc  = acc\n\n-- \u307e\u305f\u306f\ncollectAllErrors :: [Either String a] -&gt; [String]\ncollectAllErrors results = [err | Left err &lt;- results]\n\n-- \u30c6\u30b9\u30c8\n-- collectAllErrors [Right 1, Left \"Error1\", Right 2, Left \"Error2\"]\n-- =&gt; [\"Error1\", \"Error2\"]\n</code></pre>"},{"location":"haskell/part-6/#_5","title":"\u30b7\u30ea\u30fc\u30ba\u5168\u4f53\u306e\u7dcf\u62ec","text":"<p>\u672c\u30b7\u30ea\u30fc\u30ba\u3067\u306f\u3001\u300cGrokking Functional Programming\u300d\u306e\u5185\u5bb9\u306b\u6cbf\u3063\u3066\u3001Haskell \u3067\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u790e\u304b\u3089\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u307e\u3067\u3092\u5b66\u3073\u307e\u3057\u305f\u3002</p>"},{"location":"haskell/part-6/#_6","title":"\u5b66\u3093\u3060\u4e3b\u306a\u6982\u5ff5","text":"Part \u7ae0 \u4e3b\u306a\u6982\u5ff5 I 1-2 \u7d14\u7c8b\u95a2\u6570\u3001\u53c2\u7167\u900f\u904e\u6027\u3001\u578b\u63a8\u8ad6 II 3-5 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u3001\u9ad8\u968e\u95a2\u6570\u3001do \u8a18\u6cd5 III 6-7 Maybe\u3001Either\u3001\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0 IV 8-9 IO \u30e2\u30ca\u30c9\u3001\u9045\u5ef6\u30ea\u30b9\u30c8\uff08\u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0\uff09 V 10-11 \u4e26\u884c\u51e6\u7406\u3001IORef\u3001Async\u3001STM VI 12 \u5b9f\u8df5\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3001\u30c6\u30b9\u30c8\u6226\u7565"},{"location":"haskell/part-6/#haskell","title":"Haskell \u306e\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u5229\u70b9","text":"<ol> <li>\u7d14\u7c8b\u6027\u306e\u4fdd\u8a3c: \u578b\u30b7\u30b9\u30c6\u30e0\u304c\u7d14\u7c8b\u95a2\u6570\u3068 IO \u3092\u5206\u96e2</li> <li>\u9045\u5ef6\u8a55\u4fa1: \u7121\u9650\u30ea\u30b9\u30c8\u304c\u81ea\u7136\u306b\u6271\u3048\u308b</li> <li>\u5f37\u529b\u306a\u578b\u30b7\u30b9\u30c6\u30e0: newtype\u3001ADT \u3067\u5b89\u5168\u306a\u30e2\u30c7\u30ea\u30f3\u30b0</li> <li>STM: \u30c7\u30c3\u30c9\u30ed\u30c3\u30af\u30d5\u30ea\u30fc\u306a\u4e26\u884c\u51e6\u7406</li> <li>QuickCheck: \u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8\u306e\u5148\u99c6\u8005</li> </ol>"},{"location":"haskell/part-6/#_7","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<ul> <li>Monad Transformers\uff08\u30e2\u30ca\u30c9\u30c8\u30e9\u30f3\u30b9\u30d5\u30a9\u30fc\u30de\u30fc\uff09\u3092\u5b66\u3076</li> <li>lens \u30e9\u30a4\u30d6\u30e9\u30ea\u3067\u30c7\u30fc\u30bf\u64cd\u4f5c\u3092\u52b9\u7387\u5316</li> <li>servant \u3067\u578b\u5b89\u5168\u306a Web API \u3092\u69cb\u7bc9</li> <li>\u5b9f\u969b\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067 Haskell \u3092\u9069\u7528\u3059\u308b</li> </ul>"},{"location":"java/","title":"Grokking Functional Programming Java \u7248\u89e3\u8aac","text":"<p>\u672c\u30b7\u30ea\u30fc\u30ba\u306f\u300cGrokking Functional Programming\u300d\uff08Micha\u0142 P\u0142achta \u8457\uff09\u306e\u5b66\u7fd2\u30b3\u30f3\u30d1\u30cb\u30aa\u30f3\u3068\u3057\u3066\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u6982\u5ff5\u3092 Java + Vavr \u3067\u5b9f\u88c5\u3057\u306a\u304c\u3089\u65e5\u672c\u8a9e\u3067\u89e3\u8aac\u3057\u307e\u3059\u3002</p>"},{"location":"java/#_1","title":"\u5bfe\u8c61\u8aad\u8005","text":"<ul> <li>Java \u306e\u7d4c\u9a13\u304c\u3042\u308a\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u8208\u5473\u304c\u3042\u308b\u958b\u767a\u8005</li> <li>Scala \u3092\u5b66\u3070\u305a\u306b Java \u3067 FP \u3092\u5b9f\u8df5\u3057\u305f\u3044\u65b9</li> <li>Vavr \u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u4f7f\u3063\u305f\u5b9f\u8df5\u7684\u306a FP \u306e\u9069\u7528\u65b9\u6cd5\u3092\u77e5\u308a\u305f\u3044\u30a8\u30f3\u30b8\u30cb\u30a2</li> </ul>"},{"location":"java/#_2","title":"\u8a18\u4e8b\u4e00\u89a7","text":""},{"location":"java/#part-i","title":"Part I: \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u790e","text":"<p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u672c\u6982\u5ff5\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c1\u7ae0 \u547d\u4ee4\u578b vs \u95a2\u6570\u578b\u3001Java \u3067\u306e FP \u5165\u9580 \u7b2c2\u7ae0 \u7d14\u7c8b\u95a2\u6570\u3001\u526f\u4f5c\u7528\u306e\u6392\u9664\u3001\u30c6\u30b9\u30c8\u306e\u5bb9\u6613\u3055 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: \u7d14\u7c8b\u95a2\u6570\u3001\u53c2\u7167\u900f\u904e\u6027\u3001\u526f\u4f5c\u7528</p>"},{"location":"java/#part-ii","title":"Part II: \u95a2\u6570\u578b\u30b9\u30bf\u30a4\u30eb\u306e\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0","text":"<p>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c\u3068\u9ad8\u968e\u95a2\u6570\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c3\u7ae0 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u3001Vavr List \u64cd\u4f5c \u7b2c4\u7ae0 \u9ad8\u968e\u95a2\u6570\u3001map/filter/foldLeft \u7b2c5\u7ae0 flatMap\u3001For \u5185\u5305\u8868\u8a18\uff08Vavr\uff09 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u3001\u9ad8\u968e\u95a2\u6570\u3001flatMap\u3001Vavr \u30b3\u30ec\u30af\u30b7\u30e7\u30f3</p>"},{"location":"java/#part-iii-optioneither","title":"Part III: \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3068 Option/Either","text":"<p>\u578b\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c6\u7ae0 Option \u578b\u3001Some/None \u7b2c7\u7ae0 Either \u578b\u3001Sealed \u30af\u30e9\u30b9\u3001\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: Option\u3001Either\u3001Sealed \u30af\u30e9\u30b9\uff08Java 17+\uff09</p>"},{"location":"java/#part-iv-io","title":"Part IV: IO \u3068\u526f\u4f5c\u7528\u306e\u7ba1\u7406","text":"<p>IO \u30d1\u30bf\u30fc\u30f3\u3068\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c8\u7ae0 IO \u30d1\u30bf\u30fc\u30f3\u3001Lazy \u8a55\u4fa1 \u7b2c9\u7ae0 Stream \u51e6\u7406\u3001\u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: Lazy\u3001Try\u3001Future\u3001\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406</p>"},{"location":"java/#part-v","title":"Part V: \u4e26\u884c\u51e6\u7406","text":"<p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u4e26\u884c\u51e6\u7406\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c10\u7ae0 CompletableFuture\u3001\u4e26\u5217\u30b9\u30c8\u30ea\u30fc\u30e0 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: \u4e26\u884c\u51e6\u7406\u3001CompletableFuture\u3001Virtual Threads\uff08Java 21+\uff09</p>"},{"location":"java/#part-vi","title":"Part VI: \u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u3068\u30c6\u30b9\u30c8","text":"<p>\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u3068\u30c6\u30b9\u30c8\u6226\u7565\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c11\u7ae0 TravelGuide \u30a2\u30d7\u30ea\u3001\u30ea\u30bd\u30fc\u30b9\u7ba1\u7406 \u7b2c12\u7ae0 \u30c6\u30b9\u30c8\u6226\u7565\u3001\u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: Try-with-resources\u3001DataAccess \u62bd\u8c61\u5316\u3001jqwik</p>"},{"location":"java/#_3","title":"\u5b66\u7fd2\u30d1\u30b9","text":""},{"location":"java/#_4","title":"\u4f7f\u7528\u30e9\u30a4\u30d6\u30e9\u30ea","text":"\u30e9\u30a4\u30d6\u30e9\u30ea \u7528\u9014 \u5bfe\u5fdc\u7ae0 Java 17+ \u8a00\u8a9e \u5168\u7ae0 Vavr \u95a2\u6570\u578b\u30c7\u30fc\u30bf\u69cb\u9020 \u5168\u7ae0 jqwik \u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8 Part VI JUnit 5 \u5358\u4f53\u30c6\u30b9\u30c8 \u5168\u7ae0"},{"location":"java/#vavr","title":"Vavr \u3068\u306f","text":"<p>Vavr \u306f Java \u5411\u3051\u306e\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u30e9\u30a4\u30d6\u30e9\u30ea\u3067\u3059\u3002</p>"},{"location":"java/#_5","title":"\u4e3b\u306a\u6a5f\u80fd","text":"<ul> <li>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30b3\u30ec\u30af\u30b7\u30e7\u30f3: <code>List</code>, <code>Set</code>, <code>Map</code>, <code>Seq</code></li> <li>\u95a2\u6570\u578b\u30c7\u30fc\u30bf\u578b: <code>Option</code>, <code>Either</code>, <code>Try</code>, <code>Lazy</code>, <code>Future</code></li> <li>\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0: <code>Match</code> API</li> <li>\u30bf\u30d7\u30eb: <code>Tuple1</code> \u301c <code>Tuple8</code></li> <li>\u95a2\u6570\u578b\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9: <code>Function0</code> \u301c <code>Function8</code></li> </ul>"},{"location":"java/#scala","title":"Scala \u3068\u306e\u5bfe\u5fdc","text":"Scala Vavr (Java) <code>Option[T]</code> <code>Option&lt;T&gt;</code> <code>Either[L, R]</code> <code>Either&lt;L, R&gt;</code> <code>Try[T]</code> <code>Try&lt;T&gt;</code> <code>List[T]</code> <code>List&lt;T&gt;</code> <code>for</code> \u5185\u5305\u8868\u8a18 <code>For.yield()</code> \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1 <code>Match(value).of()</code>"},{"location":"java/#_6","title":"\u30ea\u30dd\u30b8\u30c8\u30ea\u69cb\u6210","text":"<pre><code>grokkingfp-examples/\n\u251c\u2500\u2500 app/java/src/main/java/      # Java + Vavr \u306e\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n\u251c\u2500\u2500 app/java/src/test/java/      # \u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\n\u251c\u2500\u2500 app/scala/src/main/scala/    # Scala \u7248\uff08\u53c2\u8003\uff09\n\u2514\u2500\u2500 docs/article/                # \u89e3\u8aac\u8a18\u4e8b\n    \u251c\u2500\u2500 scala/                   # Scala \u7248\u89e3\u8aac\n    \u2514\u2500\u2500 java/                    # Java \u7248\u89e3\u8aac\uff08\u672c\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\uff09\n        \u251c\u2500\u2500 index.md             # \u3053\u306e\u8a18\u4e8b\n        \u251c\u2500\u2500 part-1.md            # Part I\n        \u251c\u2500\u2500 part-2.md            # Part II\n        \u251c\u2500\u2500 part-3.md            # Part III\n        \u251c\u2500\u2500 part-4.md            # Part IV\n        \u251c\u2500\u2500 part-5.md            # Part V\n        \u2514\u2500\u2500 part-6.md            # Part VI\n</code></pre>"},{"location":"java/#_7","title":"\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u5229\u70b9","text":"<p>\u672c\u30b7\u30ea\u30fc\u30ba\u3092\u901a\u3058\u3066\u3001\u4ee5\u4e0b\u306e\u5229\u70b9\u3092\u5b9f\u611f\u3067\u304d\u307e\u3059:</p> <ol> <li>\u4e88\u6e2c\u53ef\u80fd\u6027 - \u7d14\u7c8b\u95a2\u6570\u306f\u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b</li> <li>\u30c6\u30b9\u30c8\u5bb9\u6613\u6027 - \u526f\u4f5c\u7528\u304c\u306a\u3044\u305f\u3081\u30c6\u30b9\u30c8\u304c\u7c21\u5358</li> <li>\u5408\u6210\u53ef\u80fd\u6027 - \u5c0f\u3055\u306a\u95a2\u6570\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u8907\u96d1\u306a\u51e6\u7406\u3092\u69cb\u7bc9</li> <li>\u4e26\u884c\u5b89\u5168\u6027 - \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u306f\u7af6\u5408\u72b6\u614b\u3092\u9632\u3050</li> <li>\u578b\u5b89\u5168\u6027 - Option\u3001Either \u3067 null \u3084\u4f8b\u5916\u3092\u578b\u3067\u8868\u73fe</li> </ol>"},{"location":"java/#java-fp-scala","title":"Java \u3067\u306e FP: Scala \u3068\u306e\u6bd4\u8f03","text":"\u7279\u5fb4 Scala Java + Vavr \u69cb\u6587\u306e\u7c21\u6f54\u3055 \u975e\u5e38\u306b\u7c21\u6f54 \u3084\u3084\u5197\u9577 \u578b\u63a8\u8ad6 \u5f37\u529b \u9650\u5b9a\u7684 \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1 \u8a00\u8a9e\u6a5f\u80fd \u30e9\u30a4\u30d6\u30e9\u30ea \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb \u30c7\u30d5\u30a9\u30eb\u30c8 \u660e\u793a\u7684\u306b\u9078\u629e for \u5185\u5305\u8868\u8a18 \u8a00\u8a9e\u6a5f\u80fd <code>For.yield()</code> \u5b66\u7fd2\u30b3\u30b9\u30c8 \u9ad8\u3044 \u4f4e\u3044\uff08Java \u7d4c\u9a13\u8005\uff09 \u30a8\u30b3\u30b7\u30b9\u30c6\u30e0 Scala \u5c02\u7528 Java \u8cc7\u7523\u6d3b\u7528\u53ef\u80fd"},{"location":"java/#_8","title":"\u53c2\u8003\u8cc7\u6599","text":"<ul> <li>Grokking Functional Programming - \u539f\u8457</li> <li>Vavr \u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8</li> <li>Vavr GitHub</li> <li>jqwik \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8</li> <li>Java \u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8</li> </ul>"},{"location":"java/part-1/","title":"Part I: \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u790e","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\uff08FP\uff09\u306e\u57fa\u672c\u6982\u5ff5\u3092 Java + Vavr \u3067\u5b66\u3073\u307e\u3059\u3002\u547d\u4ee4\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u3068\u306e\u9055\u3044\u3092\u7406\u89e3\u3057\u3001\u7d14\u7c8b\u95a2\u6570\u306e\u5229\u70b9\u3092\u5b9f\u611f\u3059\u308b\u3053\u3068\u304c\u76ee\u6a19\u3067\u3059\u3002</p>"},{"location":"java/part-1/#1","title":"\u7b2c1\u7ae0: \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u5165\u9580","text":""},{"location":"java/part-1/#11-vs","title":"1.1 \u547d\u4ee4\u578b vs \u95a2\u6570\u578b","text":"<p>\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u306f\u5927\u304d\u304f\u5206\u3051\u30662\u3064\u306e\u30d1\u30e9\u30c0\u30a4\u30e0\u304c\u3042\u308a\u307e\u3059\u3002</p> <p></p> <p>\u547d\u4ee4\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306f\u300c\u3069\u3046\u3084\u308b\u304b\u300d\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002</p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch01/IntroJava.java</code></p> <pre><code>// Java: \u547d\u4ee4\u578b\u3067\u30ef\u30fc\u30c9\u30b9\u30b3\u30a2\u3092\u8a08\u7b97\npublic static int calculateScoreImperative(String word) {\n    int score = 0;\n    for (char c : word.toCharArray()) {\n        score++;\n    }\n    return score;\n}\n</code></pre> <p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306f\u300c\u4f55\u3092\u3059\u308b\u304b\u300d\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002</p> <pre><code>// Java: \u95a2\u6570\u578b\u3067\u30ef\u30fc\u30c9\u30b9\u30b3\u30a2\u3092\u8a08\u7b97\npublic static int wordScore(String word) {\n    return word.length();\n}\n</code></pre>"},{"location":"java/part-1/#12-java","title":"1.2 Java \u3067\u306e\u95a2\u6570\u5b9a\u7fa9","text":"<p>Java \u3067\u306e\u95a2\u6570\uff08\u30e1\u30bd\u30c3\u30c9\uff09\u5b9a\u7fa9\u306e\u57fa\u672c\u5f62\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p> <pre><code>public static int increment(int x) {\n    return x + 1;\n}\n\npublic static char getFirstCharacter(String s) {\n    return s.charAt(0);\n}\n\npublic static int wordScore(String word) {\n    return word.length();\n}\n</code></pre>"},{"location":"java/part-1/#13","title":"1.3 \u95a2\u6570\u306e\u69cb\u9020","text":""},{"location":"java/part-1/#14","title":"1.4 \u5b66\u7fd2\u30dd\u30a4\u30f3\u30c8","text":"\u6982\u5ff5 \u547d\u4ee4\u578b \u95a2\u6570\u578b \u7126\u70b9 \u624b\u9806\uff08How\uff09 \u7d50\u679c\uff08What\uff09 \u72b6\u614b \u5909\u66f4\u3059\u308b \u5909\u63db\u3059\u308b \u30eb\u30fc\u30d7 for/while map/filter/reduce \u30c7\u30fc\u30bf \u30df\u30e5\u30fc\u30bf\u30d6\u30eb \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb"},{"location":"java/part-1/#2","title":"\u7b2c2\u7ae0: \u7d14\u7c8b\u95a2\u6570\u3068\u30c6\u30b9\u30c8","text":""},{"location":"java/part-1/#21","title":"2.1 \u7d14\u7c8b\u95a2\u6570\u3068\u306f","text":"<p>\u7d14\u7c8b\u95a2\u6570\uff08Pure Function\uff09\u306f\u4ee5\u4e0b\u306e\u7279\u5fb4\u3092\u6301\u3064\u95a2\u6570\u3067\u3059:</p> <ol> <li>\u540c\u3058\u5165\u529b\u306b\u306f\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3059</li> <li>\u526f\u4f5c\u7528\u304c\u306a\u3044\uff08\u5916\u90e8\u72b6\u614b\u3092\u5909\u66f4\u3057\u306a\u3044\uff09</li> </ol> <p></p>"},{"location":"java/part-1/#22","title":"2.2 \u7d14\u7c8b\u95a2\u6570\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch02/PureFunctions.java</code></p> <pre><code>// \u7d14\u7c8b\u95a2\u6570\u306e\u4f8b\npublic static int increment(int x) {\n    return x + 1;\n}\n\npublic static int add(int a, int b) {\n    return a + b;\n}\n\npublic static char getFirstCharacter(String s) {\n    return s.charAt(0);\n}\n\npublic static double applyDiscount(double x) {\n    return x * 95.0 / 100.0;\n}\n</code></pre> <p>\u7d14\u7c8b\u3067\u306f\u306a\u3044\u95a2\u6570\u306e\u4f8b:</p> <pre><code>// \u4e0d\u7d14\u306a\u95a2\u6570 - Math.random() \u306f\u6bce\u56de\u7570\u306a\u308b\u5024\u3092\u8fd4\u3059\npublic static double randomPart(double x) {\n    return x * Math.random();\n}\n\n// \u4e0d\u7d14\u306a\u95a2\u6570 - \u73fe\u5728\u6642\u523b\u306f\u6bce\u56de\u7570\u306a\u308b\npublic static long currentTime() {\n    return System.currentTimeMillis();\n}\n</code></pre>"},{"location":"java/part-1/#23","title":"2.3 \u30b7\u30e7\u30c3\u30d4\u30f3\u30b0\u30ab\u30fc\u30c8\u306e\u4f8b","text":"<p>\u72b6\u614b\u3092\u6301\u3064\u30af\u30e9\u30b9\u306e\u554f\u984c\u70b9\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch02/ShoppingCartBad.java</code></p>"},{"location":"java/part-1/#_1","title":"\u554f\u984c\u306e\u3042\u308b\u30b3\u30fc\u30c9","text":"<pre><code>public class ShoppingCartBad {\n    private List&lt;String&gt; items = new ArrayList&lt;&gt;();\n    private boolean bookAdded = false;\n\n    public void addItem(String item) {\n        items.add(item);\n        if (item.equals(\"Book\")) {\n            bookAdded = true;\n        }\n    }\n\n    public int getDiscountPercentage() {\n        if (bookAdded) {\n            return 5;\n        } else {\n            return 0;\n        }\n    }\n\n    public List&lt;String&gt; getItems() {\n        return items;  // \u554f\u984c: \u5185\u90e8\u72b6\u614b\u3078\u306e\u53c2\u7167\u3092\u8fd4\u3057\u3066\u3044\u308b\n    }\n}\n</code></pre>"},{"location":"java/part-1/#_2","title":"\u7d14\u7c8b\u95a2\u6570\u306b\u3088\u308b\u89e3\u6c7a","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch02/ShoppingCart.java</code></p> <pre><code>import io.vavr.collection.List;\n\npublic class ShoppingCart {\n    /**\n     * \u5272\u5f15\u7387\u3092\u8a08\u7b97\u3059\u308b\u7d14\u7c8b\u95a2\u6570\n     */\n    public static int getDiscountPercentage(List&lt;String&gt; items) {\n        if (items.contains(\"Book\")) {\n            return 5;\n        } else {\n            return 0;\n        }\n    }\n}\n</code></pre> <p></p>"},{"location":"java/part-1/#24-vavr-list","title":"2.4 Vavr \u306e List \u3092\u4f7f\u3063\u305f\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u64cd\u4f5c","text":"<p>Vavr \u306e <code>List</code> \u306f\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u69cb\u9020\u3067\u3059\u3002</p> <pre><code>import io.vavr.collection.List;\n\n// \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u64cd\u4f5c\nList&lt;String&gt; cart1 = List.of(\"Apple\");\nList&lt;String&gt; cart2 = cart1.append(\"Book\");  // \u65b0\u3057\u3044\u30ea\u30b9\u30c8\u3092\u4f5c\u6210\nList&lt;String&gt; cart3 = cart2.append(\"Lemon\"); // \u65b0\u3057\u3044\u30ea\u30b9\u30c8\u3092\u4f5c\u6210\n\n// cart1 \u306f\u5909\u66f4\u3055\u308c\u3066\u3044\u306a\u3044\nSystem.out.println(cart1); // List(Apple)\nSystem.out.println(cart2); // List(Apple, Book)\nSystem.out.println(cart3); // List(Apple, Book, Lemon)\n\n// \u5272\u5f15\u7387\u3092\u8a08\u7b97\nShoppingCart.getDiscountPercentage(cart1); // 0\nShoppingCart.getDiscountPercentage(cart2); // 5\nShoppingCart.getDiscountPercentage(cart3); // 5\n</code></pre>"},{"location":"java/part-1/#25","title":"2.5 \u30c1\u30c3\u30d7\u8a08\u7b97\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch02/TipCalculator.java</code></p> <pre><code>import io.vavr.collection.List;\n\npublic class TipCalculator {\n    /**\n     * \u30c1\u30c3\u30d7\u7387\u3092\u8a08\u7b97\u3059\u308b\u7d14\u7c8b\u95a2\u6570\n     */\n    public static int getTipPercentage(List&lt;String&gt; names) {\n        if (names.size() &gt; 5) {\n            return 20;\n        } else if (names.size() &gt; 0) {\n            return 10;\n        } else {\n            return 0;\n        }\n    }\n}\n</code></pre> <p>\u3053\u306e\u95a2\u6570\u306f: - 6\u4eba\u4ee5\u4e0a\u306e\u30b0\u30eb\u30fc\u30d7 \u2192 20% \u306e\u30c1\u30c3\u30d7 - 1-5\u4eba\u306e\u30b0\u30eb\u30fc\u30d7 \u2192 10% \u306e\u30c1\u30c3\u30d7 - 0\u4eba\uff08\u7a7a\u30ea\u30b9\u30c8\uff09 \u2192 0% \u306e\u30c1\u30c3\u30d7</p>"},{"location":"java/part-1/#26","title":"2.6 \u7d14\u7c8b\u95a2\u6570\u306e\u30c6\u30b9\u30c8","text":"<p>\u7d14\u7c8b\u95a2\u6570\u306f\u975e\u5e38\u306b\u30c6\u30b9\u30c8\u3057\u3084\u3059\u3044\u3067\u3059\u3002</p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/test/java/ch01/IntroJavaTest.java</code></p> <pre><code>@Test\n@DisplayName(\"increment \u306f\u5165\u529b\u306b1\u3092\u52a0\u3048\u308b\")\nvoid incrementAddOne() {\n    assertThat(IntroJava.increment(0)).isEqualTo(1);\n    assertThat(IntroJava.increment(6)).isEqualTo(7);\n    assertThat(IntroJava.increment(-1)).isEqualTo(0);\n    assertThat(IntroJava.increment(Integer.MAX_VALUE - 1))\n            .isEqualTo(Integer.MAX_VALUE);\n}\n\n@Test\n@DisplayName(\"isEven \u306f\u5076\u6570\u3092\u5224\u5b9a\")\nvoid isEvenChecksEvenness() {\n    assertThat(IntroJava.isEven(0)).isTrue();\n    assertThat(IntroJava.isEven(2)).isTrue();\n    assertThat(IntroJava.isEven(1)).isFalse();\n    assertThat(IntroJava.isEven(-2)).isTrue();\n    assertThat(IntroJava.isEven(-3)).isFalse();\n}\n</code></pre> <p></p>"},{"location":"java/part-1/#27-a","title":"2.7 \u6587\u5b57 'a' \u3092\u9664\u5916\u3059\u308b\u30ef\u30fc\u30c9\u30b9\u30b3\u30a2","text":"<p>\u3088\u308a\u8907\u96d1\u306a\u4f8b\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p> <pre><code>public static int wordScoreWithoutA(String word) {\n    return word.replace(\"a\", \"\").length();\n}\n\n// \u30c6\u30b9\u30c8\nassertThat(wordScoreWithoutA(\"Scala\")).isEqualTo(3);    // \"Scl\" \u2192 3\u6587\u5b57\nassertThat(wordScoreWithoutA(\"function\")).isEqualTo(8); // 'a' \u306a\u3057 \u2192 8\u6587\u5b57\nassertThat(wordScoreWithoutA(\"\")).isEqualTo(0);         // \u7a7a\u6587\u5b57 \u2192 0\u6587\u5b57\n</code></pre>"},{"location":"java/part-1/#28","title":"2.8 \u53c2\u7167\u900f\u904e\u6027","text":"<p>\u7d14\u7c8b\u95a2\u6570\u306f\u53c2\u7167\u900f\u904e\u6027\uff08Referential Transparency\uff09\u3092\u6301\u3061\u307e\u3059\u3002</p> <p>\u5f0f\u3092\u305d\u306e\u8a55\u4fa1\u7d50\u679c\u3067\u7f6e\u304d\u63db\u3048\u3066\u3082\u3001\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u610f\u5473\u304c\u5909\u308f\u3089\u306a\u3044\u3053\u3068</p> <pre><code>// \u53c2\u7167\u900f\u904e\u6027\u306e\u4f8b\nint score1 = wordScore(\"Java\");\nint score2 = wordScore(\"Java\");\n// score1 \u3068 score2 \u306f\u5e38\u306b\u540c\u3058\u5024\uff084\uff09\n\n// \u4ee5\u4e0b\u306e2\u3064\u306f\u540c\u7b49\nint total1 = wordScore(\"Java\") + wordScore(\"Scala\");\nint total2 = 4 + 5;  // wordScore \u306e\u7d50\u679c\u3067\u7f6e\u304d\u63db\u3048\u53ef\u80fd\n</code></pre> <p></p>"},{"location":"java/part-1/#java-vavr","title":"Java \u3068 Vavr \u306e\u5bfe\u5fdc\u8868","text":"\u6982\u5ff5 \u6a19\u6e96 Java Vavr \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30ea\u30b9\u30c8 <code>List.of()</code> (Java 9+) <code>io.vavr.collection.List</code> \u7a7a\u30ea\u30b9\u30c8 <code>List.of()</code> <code>List.empty()</code> \u8981\u7d20\u8ffd\u52a0 \u4e0d\u53ef\uff08\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\uff09 <code>list.append(x)</code> \u8981\u7d20\u524a\u9664 \u4e0d\u53ef\uff08\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\uff09 <code>list.remove(x)</code> \u8981\u7d20\u691c\u7d22 <code>list.contains(x)</code> <code>list.contains(x)</code>"},{"location":"java/part-1/#_3","title":"\u307e\u3068\u3081","text":""},{"location":"java/part-1/#part-i_1","title":"Part I \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"java/part-1/#_4","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306f\u300c\u4f55\u3092\u3059\u308b\u304b\u300d\u3092\u5ba3\u8a00\u7684\u306b\u8a18\u8ff0\u3059\u308b</li> <li>\u7d14\u7c8b\u95a2\u6570\u306f\u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3059</li> <li>\u526f\u4f5c\u7528\u3092\u907f\u3051\u308b\u3053\u3068\u3067\u30b3\u30fc\u30c9\u306e\u4e88\u6e2c\u53ef\u80fd\u6027\u304c\u5411\u4e0a\u3059\u308b</li> <li>\u7d14\u7c8b\u95a2\u6570\u306f\u30c6\u30b9\u30c8\u304c\u975e\u5e38\u306b\u7c21\u5358</li> <li>\u53c2\u7167\u900f\u904e\u6027\u306b\u3088\u308a\u3001\u30b3\u30fc\u30c9\u306e\u7406\u89e3\u3068\u63a8\u8ad6\u304c\u5bb9\u6613\u306b\u306a\u308b</li> <li>Vavr \u306e List \u3092\u4f7f\u3046\u3068\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c\u304c\u7c21\u5358</li> </ol>"},{"location":"java/part-1/#_5","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part II \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c\uff08Vavr \u30b3\u30ec\u30af\u30b7\u30e7\u30f3\uff09</li> <li>\u9ad8\u968e\u95a2\u6570\uff08\u95a2\u6570\u3092\u5024\u3068\u3057\u3066\u6271\u3046\uff09</li> <li><code>flatMap</code> \u3068\u30cd\u30b9\u30c8\u69cb\u9020\u306e\u5e73\u5766\u5316</li> <li>Vavr \u306e <code>For.yield()</code> \u306b\u3088\u308b\u5185\u5305\u8868\u8a18</li> </ul>"},{"location":"java/part-1/#_6","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"java/part-1/#1_1","title":"\u554f\u984c 1: \u7d14\u7c8b\u95a2\u6570\u306e\u8b58\u5225","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u306e\u3046\u3061\u3001\u7d14\u7c8b\u95a2\u6570\u306f\u3069\u308c\u3067\u3059\u304b?</p> <pre><code>// A\npublic static int doubleValue(int x) {\n    return x * 2;\n}\n\n// B\nprivate static int counter = 0;\npublic static int incrementCounter() {\n    counter++;\n    return counter;\n}\n\n// C\npublic static String greet(String name) {\n    return \"Hello, \" + name + \"!\";\n}\n\n// D\npublic static long currentTime() {\n    return System.currentTimeMillis();\n}\n</code></pre> \u89e3\u7b54  **A \u3068 C \u306f\u7d14\u7c8b\u95a2\u6570**\u3067\u3059\u3002  - A: \u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3057\u3001\u526f\u4f5c\u7528\u304c\u306a\u3044 - B: \u5916\u90e8\u5909\u6570 `counter` \u3092\u5909\u66f4\u3059\u308b\u526f\u4f5c\u7528\u304c\u3042\u308b\uff08\u4e0d\u7d14\uff09 - C: \u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3057\u3001\u526f\u4f5c\u7528\u304c\u306a\u3044 - D: \u547c\u3073\u51fa\u3059\u305f\u3073\u306b\u7570\u306a\u308b\u5024\u3092\u8fd4\u3059\uff08\u4e0d\u7d14\uff09"},{"location":"java/part-1/#2_1","title":"\u554f\u984c 2: \u7d14\u7c8b\u95a2\u6570\u3078\u306e\u66f8\u304d\u63db\u3048","text":"<p>\u4ee5\u4e0b\u306e\u4e0d\u7d14\u306a\u95a2\u6570\u3092\u7d14\u7c8b\u95a2\u6570\u306b\u66f8\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>public class Counter {\n    private int value = 0;\n\n    public int increment() {\n        value++;\n        return value;\n    }\n}\n</code></pre> \u89e3\u7b54 <pre><code>public static int increment(int value) {\n    return value + 1;\n}\n\n// \u4f7f\u7528\u4f8b\nint v1 = 0;\nint v2 = increment(v1);  // 1\nint v3 = increment(v2);  // 2\n</code></pre>  \u72b6\u614b\u3092\u5916\u90e8\u306b\u6301\u3061\u3001\u95a2\u6570\u306f\u5024\u3092\u53d7\u3051\u53d6\u3063\u3066\u65b0\u3057\u3044\u5024\u3092\u8fd4\u3059\u3060\u3051\u306b\u3057\u307e\u3059\u3002"},{"location":"java/part-1/#3-vavr-list","title":"\u554f\u984c 3: Vavr List \u3092\u4f7f\u3063\u305f\u30c6\u30b9\u30c8\u3092\u66f8\u304f","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u306b\u5bfe\u3059\u308b\u30c6\u30b9\u30c8\u30b1\u30fc\u30b9\u3092 JUnit + AssertJ \u3067\u66f8\u3044\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>public static boolean hasDiscount(List&lt;String&gt; items) {\n    return items.contains(\"Book\") || items.contains(\"Magazine\");\n}\n</code></pre> \u89e3\u7b54 <pre><code>@Test\nvoid hasDiscountTest() {\n    // \u7a7a\u306e\u30ea\u30b9\u30c8\n    assertThat(hasDiscount(List.empty())).isFalse();\n\n    // Book \u306e\u307f\n    assertThat(hasDiscount(List.of(\"Book\"))).isTrue();\n\n    // Magazine \u306e\u307f\n    assertThat(hasDiscount(List.of(\"Magazine\"))).isTrue();\n\n    // \u4e21\u65b9\n    assertThat(hasDiscount(List.of(\"Book\", \"Magazine\"))).isTrue();\n\n    // \u3069\u3061\u3089\u3082\u306a\u3044\n    assertThat(hasDiscount(List.of(\"Apple\", \"Orange\"))).isFalse();\n\n    // \u6df7\u5728\n    assertThat(hasDiscount(List.of(\"Apple\", \"Book\", \"Orange\"))).isTrue();\n}\n</code></pre>"},{"location":"java/part-1/#_7","title":"\u5b9f\u884c\u65b9\u6cd5","text":""},{"location":"java/part-1/#_8","title":"\u30c6\u30b9\u30c8\u306e\u5b9f\u884c","text":"<pre><code>cd app/java\n./gradlew test\n</code></pre>"},{"location":"java/part-1/#_9","title":"\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\u306e\u5b9f\u884c","text":"<pre><code>cd app/java\n./gradlew run -PmainClass=ch01.IntroJava\n./gradlew run -PmainClass=ch02.PureFunctions\n./gradlew run -PmainClass=ch02.ShoppingCart\n./gradlew run -PmainClass=ch02.TipCalculator\n</code></pre>"},{"location":"java/part-2/","title":"Part II: \u95a2\u6570\u578b\u30b9\u30bf\u30a4\u30eb\u306e\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u6838\u5fc3\u3068\u306a\u308b\u30c6\u30af\u30cb\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059\u3002\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c\u3001\u9ad8\u968e\u95a2\u6570\u3001\u305d\u3057\u3066 <code>flatMap</code> \u306b\u3088\u308b\u8907\u96d1\u306a\u30c7\u30fc\u30bf\u5909\u63db\u3092 Vavr \u3092\u4f7f\u3063\u3066\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"java/part-2/#3","title":"\u7b2c3\u7ae0: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c","text":""},{"location":"java/part-2/#31","title":"3.1 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u3068\u306f","text":"<p>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\uff08\u4e0d\u5909\uff09\u3068\u306f\u3001\u4e00\u5ea6\u4f5c\u6210\u3055\u308c\u305f\u30c7\u30fc\u30bf\u304c\u5909\u66f4\u3055\u308c\u306a\u3044\u3053\u3068\u3092\u610f\u5473\u3057\u307e\u3059\u3002\u30c7\u30fc\u30bf\u3092\u300c\u5909\u66f4\u300d\u3059\u308b\u4ee3\u308f\u308a\u306b\u3001\u65b0\u3057\u3044\u30c7\u30fc\u30bf\u3092\u300c\u4f5c\u6210\u300d\u3057\u307e\u3059\u3002</p> <p></p>"},{"location":"java/part-2/#32-vavr-list","title":"3.2 Vavr List \u306e\u57fa\u672c\u64cd\u4f5c","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch03/ImmutableList.java</code></p>"},{"location":"java/part-2/#append-","title":"append - \u8981\u7d20\u306e\u8ffd\u52a0","text":"<pre><code>List&lt;String&gt; appleBook = List.of(\"Apple\", \"Book\");\nList&lt;String&gt; appleBookMango = appleBook.append(\"Mango\");\n\nassert appleBook.size() == 2;       // \u5143\u306e\u30ea\u30b9\u30c8\u306f\u5909\u308f\u3089\u306a\u3044\nassert appleBookMango.size() == 3;  // \u65b0\u3057\u3044\u30ea\u30b9\u30c8\u304c\u4f5c\u6210\u3055\u308c\u308b\nassert appleBookMango.equals(List.of(\"Apple\", \"Book\", \"Mango\"));\n</code></pre>"},{"location":"java/part-2/#take-drop-","title":"take / drop - \u30ea\u30b9\u30c8\u306e\u5207\u308a\u51fa\u3057","text":"<pre><code>public static List&lt;String&gt; firstTwo(List&lt;String&gt; list) {\n    return list.take(2);\n}\n\npublic static List&lt;String&gt; lastTwo(List&lt;String&gt; list) {\n    return list.takeRight(2);\n}\n\npublic static &lt;T&gt; List&lt;T&gt; slice(List&lt;T&gt; list, int start, int end) {\n    return list.drop(start).take(end - start);\n}\n\n// \u4f7f\u7528\u4f8b\nList&lt;String&gt; fruits = List.of(\"a\", \"b\", \"c\", \"d\");\nassert firstTwo(fruits).equals(List.of(\"a\", \"b\"));\nassert lastTwo(fruits).equals(List.of(\"c\", \"d\"));\nassert slice(fruits, 1, 3).equals(List.of(\"b\", \"c\"));\n</code></pre>"},{"location":"java/part-2/#33","title":"3.3 \u30ea\u30b9\u30c8\u306e\u5909\u63db\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch03/ImmutableList.java</code></p> <pre><code>// \u6700\u521d\u306e2\u8981\u7d20\u3092\u672b\u5c3e\u306b\u79fb\u52d5\npublic static List&lt;String&gt; movedFirstTwoToTheEnd(List&lt;String&gt; list) {\n    List&lt;String&gt; firstTwo = list.take(2);\n    List&lt;String&gt; withoutFirstTwo = list.drop(2);\n    return withoutFirstTwo.appendAll(firstTwo);\n}\n\nassert movedFirstTwoToTheEnd(List.of(\"a\", \"b\", \"c\")).equals(List.of(\"c\", \"a\", \"b\"));\n\n// \u6700\u5f8c\u306e\u8981\u7d20\u306e\u524d\u306b\u633f\u5165\npublic static List&lt;String&gt; insertedBeforeLast(List&lt;String&gt; list, String element) {\n    List&lt;String&gt; withoutLast = list.dropRight(1);\n    List&lt;String&gt; last = list.takeRight(1);\n    return withoutLast.append(element).appendAll(last);\n}\n\nassert insertedBeforeLast(List.of(\"a\", \"b\"), \"c\").equals(List.of(\"a\", \"c\", \"b\"));\n</code></pre>"},{"location":"java/part-2/#34","title":"3.4 \u65c5\u7a0b\u306e\u518d\u8a08\u753b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch03/Itinerary.java</code></p> <p>\u65c5\u884c\u306e\u8a08\u753b\u5909\u66f4\u3092\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306b\u884c\u3046\u4f8b\u3067\u3059\u3002</p> <pre><code>public static List&lt;String&gt; replan(List&lt;String&gt; plan, String newCity, String beforeCity) {\n    int beforeCityIndex = plan.indexOf(beforeCity);\n    List&lt;String&gt; citiesBefore = plan.take(beforeCityIndex);\n    List&lt;String&gt; citiesAfter = plan.drop(beforeCityIndex);\n    return citiesBefore.append(newCity).appendAll(citiesAfter);\n}\n\nList&lt;String&gt; planA = List.of(\"Paris\", \"Berlin\", \"Krak\u00f3w\");\nList&lt;String&gt; planB = replan(planA, \"Vienna\", \"Krak\u00f3w\");\n\nassert planB.equals(List.of(\"Paris\", \"Berlin\", \"Vienna\", \"Krak\u00f3w\"));\nassert planA.equals(List.of(\"Paris\", \"Berlin\", \"Krak\u00f3w\"));  // \u5143\u306e\u8a08\u753b\u306f\u5909\u308f\u3089\u306a\u3044!\n</code></pre> <p></p>"},{"location":"java/part-2/#4","title":"\u7b2c4\u7ae0: \u95a2\u6570\u3092\u5024\u3068\u3057\u3066\u6271\u3046","text":""},{"location":"java/part-2/#41","title":"4.1 \u9ad8\u968e\u95a2\u6570\u3068\u306f","text":"<p>\u9ad8\u968e\u95a2\u6570\uff08Higher-Order Function\uff09\u3068\u306f\u3001\u4ee5\u4e0b\u306e\u3044\u305a\u308c\u304b\u3092\u6e80\u305f\u3059\u95a2\u6570\u3067\u3059:</p> <ol> <li>\u95a2\u6570\u3092\u5f15\u6570\u3068\u3057\u3066\u53d7\u3051\u53d6\u308b</li> <li>\u95a2\u6570\u3092\u623b\u308a\u5024\u3068\u3057\u3066\u8fd4\u3059</li> </ol> <p></p>"},{"location":"java/part-2/#42","title":"4.2 \u95a2\u6570\u3092\u5f15\u6570\u3068\u3057\u3066\u6e21\u3059","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch04/HigherOrderFunctions.java</code></p>"},{"location":"java/part-2/#sortby-","title":"sortBy - \u30bd\u30fc\u30c8\u57fa\u6e96\u3092\u95a2\u6570\u3067\u6307\u5b9a","text":"<pre><code>public static int score(String word) {\n    return word.replaceAll(\"a\", \"\").length();\n}\n\nList&lt;String&gt; words = List.of(\"rust\", \"java\");\nList&lt;String&gt; sortedWords = words.sortBy(HigherOrderFunctions::score);\n\nassert sortedWords.equals(List.of(\"java\", \"rust\"));\n// java: 2\u6587\u5b57 (j, v), rust: 4\u6587\u5b57 (r, u, s, t)\n</code></pre>"},{"location":"java/part-2/#map-","title":"map - \u5404\u8981\u7d20\u3092\u5909\u63db","text":"<pre><code>public static int len(String s) {\n    return s.length();\n}\n\nList&lt;Integer&gt; lengths = List.of(\"scala\", \"rust\", \"ada\").map(HigherOrderFunctions::len);\nassert lengths.equals(List.of(5, 4, 3));\n\npublic static int doubleValue(int i) {\n    return 2 * i;\n}\n\nList&lt;Integer&gt; doubles = List.of(5, 1, 2, 4, 0).map(HigherOrderFunctions::doubleValue);\nassert doubles.equals(List.of(10, 2, 4, 8, 0));\n</code></pre>"},{"location":"java/part-2/#filter-","title":"filter - \u6761\u4ef6\u306b\u5408\u3046\u8981\u7d20\u3092\u62bd\u51fa","text":"<pre><code>public static boolean isOdd(int i) {\n    return i % 2 == 1;\n}\n\nList&lt;Integer&gt; odds = List.of(5, 1, 2, 4, 0).filter(HigherOrderFunctions::isOdd);\nassert odds.equals(List.of(5, 1));\n\npublic static boolean isLargerThan4(int i) {\n    return i &gt; 4;\n}\n\nList&lt;Integer&gt; large = List.of(5, 1, 2, 4, 0).filter(HigherOrderFunctions::isLargerThan4);\nassert large.equals(List.of(5));\n</code></pre>"},{"location":"java/part-2/#foldleft-","title":"foldLeft - \u7573\u307f\u8fbc\u307f","text":"<pre><code>List&lt;Integer&gt; numbers = List.of(5, 1, 2, 4, 100);\nint sum = numbers.foldLeft(0, (acc, i) -&gt; acc + i);\nassert sum == 112;\n\nint max = List.of(5, 1, 2, 4, 15).foldLeft(Integer.MIN_VALUE, (m, i) -&gt; i &gt; m ? i : m);\nassert max == 15;\n</code></pre>"},{"location":"java/part-2/#43-record","title":"4.3 record \u3068\u30e1\u30bd\u30c3\u30c9\u53c2\u7167","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch04/ProgrammingLanguage.java</code></p> <p>Java \u306e record \u3092\u4f7f\u3063\u305f\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u30af\u30e9\u30b9\u306e\u4f8b\u3067\u3059\u3002</p> <pre><code>public record ProgrammingLanguage(String name, int year) {}\n\nProgrammingLanguage java = new ProgrammingLanguage(\"Java\", 1995);\nProgrammingLanguage scala = new ProgrammingLanguage(\"Scala\", 2004);\n\nList&lt;ProgrammingLanguage&gt; languages = List.of(java, scala);\n\n// \u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u30a2\u30af\u30bb\u30b9\nList&lt;String&gt; names = languages.map(ProgrammingLanguage::name);\nassert names.equals(List.of(\"Java\", \"Scala\"));\n\n// \u6761\u4ef6\u3067\u30d5\u30a3\u30eb\u30bf\nList&lt;ProgrammingLanguage&gt; young = languages.filter(lang -&gt; lang.year() &gt; 2000);\nassert young.equals(List.of(scala));\n</code></pre>"},{"location":"java/part-2/#44","title":"4.4 \u95a2\u6570\u3092\u8fd4\u3059\u95a2\u6570","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch04/HigherOrderFunctions.java</code></p> <pre><code>public static Predicate&lt;Integer&gt; largerThan(int n) {\n    return i -&gt; i &gt; n;\n}\n\nList&lt;Integer&gt; large = List.of(5, 1, 2, 4, 0).filter(largerThan(4));\nassert large.equals(List.of(5));\n\nList&lt;Integer&gt; medium = List.of(5, 1, 2, 4, 0).filter(largerThan(1));\nassert medium.equals(List.of(5, 2, 4));\n</code></pre> <p></p>"},{"location":"java/part-2/#45","title":"4.5 \u30ef\u30fc\u30c9\u30b9\u30b3\u30a2\u30ea\u30f3\u30b0\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch04/WordScoring.java</code></p> <p>\u8907\u6570\u306e\u30b9\u30b3\u30a2\u30ea\u30f3\u30b0\u30ed\u30b8\u30c3\u30af\u3092\u7d44\u307f\u5408\u308f\u305b\u308b\u4f8b\u3067\u3059\u3002</p> <pre><code>public static int score(String word) {\n    return word.replaceAll(\"a\", \"\").length();\n}\n\npublic static int bonus(String word) {\n    return word.contains(\"c\") ? 5 : 0;\n}\n\npublic static int penalty(String word) {\n    return word.contains(\"s\") ? 7 : 0;\n}\n\nList&lt;String&gt; words = List.of(\"ada\", \"haskell\", \"scala\", \"java\", \"rust\");\n\n// \u95a2\u6570\u3092\u5f15\u6570\u3068\u3057\u3066\u6e21\u3059\npublic static List&lt;String&gt; rankedWords(Function&lt;String, Integer&gt; wordScore, List&lt;String&gt; words) {\n    return words.sortBy(wordScore).reverse();\n}\n\n// \u57fa\u672c\u30b9\u30b3\u30a2\u3067\u30e9\u30f3\u30ad\u30f3\u30b0\nList&lt;String&gt; ranking1 = rankedWords(WordScoring::score, words);\nassert ranking1.equals(List.of(\"haskell\", \"rust\", \"scala\", \"java\", \"ada\"));\n\n// \u30dc\u30fc\u30ca\u30b9\u4ed8\u304d\u30b9\u30b3\u30a2\u3067\u30e9\u30f3\u30ad\u30f3\u30b0\nList&lt;String&gt; ranking2 = rankedWords(w -&gt; score(w) + bonus(w), words);\nassert ranking2.equals(List.of(\"scala\", \"haskell\", \"rust\", \"java\", \"ada\"));\n\n// \u30dc\u30fc\u30ca\u30b9\u3068\u30da\u30ca\u30eb\u30c6\u30a3\u4ed8\u304d\u30b9\u30b3\u30a2\u3067\u30e9\u30f3\u30ad\u30f3\u30b0\nList&lt;String&gt; ranking3 = rankedWords(w -&gt; score(w) + bonus(w) - penalty(w), words);\n// java \u304c1\u4f4d\n</code></pre>"},{"location":"java/part-2/#5-flatmap","title":"\u7b2c5\u7ae0: flatMap \u3068\u30cd\u30b9\u30c8\u69cb\u9020","text":""},{"location":"java/part-2/#51-flatten-flatmap","title":"5.1 flatten \u3068 flatMap","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch05/FlatMapExamples.java</code></p>"},{"location":"java/part-2/#flatten-","title":"flatten - \u30cd\u30b9\u30c8\u3057\u305f\u30ea\u30b9\u30c8\u3092\u5e73\u5766\u5316","text":"<pre><code>List&lt;List&lt;Integer&gt;&gt; nested = List.of(\n    List.of(1, 2),\n    List.of(3, 4, 5),\n    List.of(6)\n);\n\n// flatMap \u3067\u5e73\u5766\u5316\nList&lt;Integer&gt; flat = nested.flatMap(x -&gt; x);\n// List(1, 2, 3, 4, 5, 6)\n</code></pre>"},{"location":"java/part-2/#flatmap-map-flatten","title":"flatMap = map + flatten","text":"<pre><code>// \u66f8\u7c4d\u3068\u6620\u753b\u5316\u306e\u4f8b\npublic record Book(String title, List&lt;String&gt; authors) {}\n\nList&lt;Book&gt; books = List.of(\n    new Book(\"FP in Scala\", List.of(\"Chiusano\", \"Bjarnason\")),\n    new Book(\"The Hobbit\", List.of(\"Tolkien\"))\n);\n\n// map \u3060\u3051\u3060\u3068\u30cd\u30b9\u30c8\u3059\u308b\nList&lt;List&lt;String&gt;&gt; authorLists = books.map(Book::authors);\n// List(List(\"Chiusano\", \"Bjarnason\"), List(\"Tolkien\"))\n\n// flatMap \u3067\u5e73\u5766\u5316\nList&lt;String&gt; authors = books.flatMap(Book::authors);\n// List(\"Chiusano\", \"Bjarnason\", \"Tolkien\")\n</code></pre>"},{"location":"java/part-2/#52-flatmap","title":"5.2 flatMap \u306b\u3088\u308b\u30ea\u30b9\u30c8\u30b5\u30a4\u30ba\u306e\u5909\u5316","text":"<pre><code>// \u8981\u7d20\u6570\u304c\u5897\u3048\u308b\nList.of(1, 2, 3).flatMap(i -&gt; List.of(i, i + 10));\n// List(1, 11, 2, 12, 3, 13) - 6\u8981\u7d20\n\n// \u8981\u7d20\u6570\u304c\u540c\u3058\nList.of(1, 2, 3).flatMap(i -&gt; List.of(i * 2));\n// List(2, 4, 6) - 3\u8981\u7d20\n\n// \u8981\u7d20\u6570\u304c\u6e1b\u308b\uff08\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u52b9\u679c\uff09\nList.of(1, 2, 3).flatMap(i -&gt; i % 2 == 0 ? List.of(i) : List.empty());\n// List(2) - 1\u8981\u7d20\n</code></pre>"},{"location":"java/part-2/#53-flatmap","title":"5.3 \u30cd\u30b9\u30c8\u3057\u305f flatMap","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch05/BookAdaptations.java</code></p> <p>\u8907\u6570\u306e\u30ea\u30b9\u30c8\u3092\u7d44\u307f\u5408\u308f\u305b\u308b\u5834\u5408\u3001flatMap \u3092\u30cd\u30b9\u30c8\u3057\u307e\u3059\u3002</p> <pre><code>public record Book(String title, List&lt;String&gt; authors) {}\npublic record Movie(String title) {}\n\npublic static List&lt;Movie&gt; bookAdaptations(String author) {\n    if (\"Tolkien\".equals(author)) {\n        return List.of(\n            new Movie(\"An Unexpected Journey\"),\n            new Movie(\"The Desolation of Smaug\")\n        );\n    }\n    return List.empty();\n}\n\nList&lt;Book&gt; books = List.of(\n    new Book(\"FP in Scala\", List.of(\"Chiusano\", \"Bjarnason\")),\n    new Book(\"The Hobbit\", List.of(\"Tolkien\"))\n);\n\n// \u30cd\u30b9\u30c8\u3057\u305f flatMap\nList&lt;String&gt; recommendations = books.flatMap(book -&gt;\n    book.authors().flatMap(author -&gt;\n        bookAdaptations(author).map(movie -&gt;\n            String.format(\"You may like %s, because you liked %s's %s\",\n                movie.title(), author, book.title())\n        )\n    )\n);\n\n// \u7d50\u679c:\n// List(\n//   \"You may like An Unexpected Journey, because you liked Tolkien's The Hobbit\",\n//   \"You may like The Desolation of Smaug, because you liked Tolkien's The Hobbit\"\n// )\n</code></pre> <p></p>"},{"location":"java/part-2/#54-java-for","title":"5.4 Java \u3067\u306e for \u5185\u5305\u8868\u8a18\u306e\u4ee3\u66ff","text":"<p>Scala \u306e for \u5185\u5305\u8868\u8a18\u306b\u76f8\u5f53\u3059\u308b\u6a5f\u80fd\u306f\u3001Java \u3067\u306f flatMap \u306e\u30c1\u30a7\u30fc\u30f3\u3067\u8868\u73fe\u3057\u307e\u3059\u3002</p> <pre><code>// flatMap/map \u7248\nList&lt;String&gt; c1 = books.flatMap(book -&gt;\n    book.authors().flatMap(author -&gt;\n        bookAdaptations(author).map(movie -&gt;\n            String.format(\"You may like %s, because you liked %s's %s\",\n                movie.title(), author, book.title())\n        )\n    )\n);\n\n// Vavr \u306e Iterator \u3092\u4f7f\u3063\u305f\u7248\uff08\u540c\u7b49\uff09\nList&lt;String&gt; c2 = Iterator.ofAll(books)\n    .flatMap(book -&gt; Iterator.ofAll(book.authors())\n        .flatMap(author -&gt; Iterator.ofAll(bookAdaptations(author))\n            .map(movie -&gt; String.format(\n                \"You may like %s, because you liked %s's %s\",\n                movie.title(), author, book.title()))))\n    .toList();\n</code></pre>"},{"location":"java/part-2/#55","title":"5.5 \u5186\u5185\u306e\u70b9\u306e\u5224\u5b9a","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch05/PointsInsideCircles.java</code></p> <p>flatMap \u3092\u4f7f\u3063\u305f\u7d44\u307f\u5408\u308f\u305b\u751f\u6210\u3068\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u306e\u4f8b\u3067\u3059\u3002</p> <pre><code>public record Point(int x, int y) {}\n\nList&lt;Point&gt; points = List.of(new Point(5, 2), new Point(1, 1));\nList&lt;Integer&gt; radiuses = List.of(2, 1);\n\npublic static boolean isInside(Point point, int radius) {\n    return radius * radius &gt;= point.x() * point.x() + point.y() * point.y();\n}\n\n// \u5168\u7d44\u307f\u5408\u308f\u305b\u3092\u751f\u6210\nList&lt;String&gt; allCombinations = radiuses.flatMap(r -&gt;\n    points.map(point -&gt;\n        String.format(\"%s is within radius %d: %s\", point, r, isInside(point, r))\n    )\n);\n\n// \u7d50\u679c:\n// List(\n//   \"(5, 2) is within radius 2: false\",\n//   \"(1, 1) is within radius 2: true\",\n//   \"(5, 2) is within radius 1: false\",\n//   \"(1, 1) is within radius 1: false\"\n// )\n</code></pre>"},{"location":"java/part-2/#_1","title":"\u30ac\u30fc\u30c9\u5f0f\u76f8\u5f53\u306e\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0","text":"<pre><code>// \u5186\u5185\u306e\u70b9\u306e\u307f\u3092\u53d6\u5f97\uff08\u30ac\u30fc\u30c9\u5f0f\u76f8\u5f53\uff09\nList&lt;String&gt; inside = radiuses.flatMap(r -&gt;\n    points.filter(point -&gt; isInside(point, r))\n        .map(point -&gt; String.format(\"%s is inside circle with radius %d\", point, r))\n);\n</code></pre>"},{"location":"java/part-2/#_2","title":"\u307e\u3068\u3081","text":""},{"location":"java/part-2/#_3","title":"\u5b66\u3093\u3060\u3053\u3068","text":"<ol> <li>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c</li> <li>Vavr \u306e <code>List</code> \u306f\u4e0d\u5909</li> <li><code>take</code>, <code>drop</code>, <code>append</code>, <code>appendAll</code> \u3067\u65b0\u3057\u3044\u30ea\u30b9\u30c8\u3092\u4f5c\u6210</li> <li> <p>\u5143\u306e\u30c7\u30fc\u30bf\u306f\u5909\u66f4\u3055\u308c\u306a\u3044</p> </li> <li> <p>\u9ad8\u968e\u95a2\u6570</p> </li> <li><code>map</code>: \u5404\u8981\u7d20\u3092\u5909\u63db</li> <li><code>filter</code>: \u6761\u4ef6\u306b\u5408\u3046\u8981\u7d20\u3092\u62bd\u51fa</li> <li><code>foldLeft</code>: \u7573\u307f\u8fbc\u307f</li> <li> <p><code>sortBy</code>: \u30bd\u30fc\u30c8\u57fa\u6e96\u3092\u95a2\u6570\u3067\u6307\u5b9a</p> </li> <li> <p>\u95a2\u6570\u3092\u8fd4\u3059\u95a2\u6570</p> </li> <li><code>Predicate&lt;T&gt;</code> \u3092\u8fd4\u3059\u3053\u3068\u3067\u518d\u5229\u7528\u53ef\u80fd\u306a\u30d5\u30a3\u30eb\u30bf\u3092\u4f5c\u6210</li> <li> <p>\u90e8\u5206\u9069\u7528\u306e\u3088\u3046\u306a\u52b9\u679c\u3092\u5f97\u3089\u308c\u308b</p> </li> <li> <p>flatMap</p> </li> <li>\u30cd\u30b9\u30c8\u3057\u305f\u30ea\u30b9\u30c8\u3092\u5e73\u5766\u5316</li> <li><code>map</code> + <code>flatten</code> \u306e\u7d44\u307f\u5408\u308f\u305b</li> <li>\u30ea\u30b9\u30c8\u30b5\u30a4\u30ba\u304c\u5897\u6e1b\u3059\u308b\u5909\u63db\u306b\u5bfe\u5fdc</li> </ol>"},{"location":"java/part-2/#scala","title":"Scala \u3068\u306e\u5bfe\u5fdc","text":"Scala Java + Vavr <code>List</code> <code>io.vavr.collection.List</code> <code>slice(a, b)</code> <code>drop(a).take(b - a)</code> <code>appended</code> <code>append</code> <code>appendedAll</code> <code>appendAll</code> <code>sortBy</code> <code>sortBy</code> <code>map</code> <code>map</code> <code>filter</code> <code>filter</code> <code>foldLeft</code> <code>foldLeft</code> <code>flatMap</code> <code>flatMap</code> <code>for {...} yield</code> <code>flatMap</code> \u306e\u30c1\u30a7\u30fc\u30f3"},{"location":"java/part-2/#_4","title":"\u6b21\u306e\u30d1\u30fc\u30c8","text":"<p>Part III \u3067\u306f\u3001\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u306b\u3064\u3044\u3066\u5b66\u3073\u307e\u3059\u3002<code>Option</code> \u3068 <code>Either</code> \u3092\u4f7f\u3063\u305f\u5b89\u5168\u306a\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u624b\u6cd5\u3092\u7d39\u4ecb\u3057\u307e\u3059\u3002</p>"},{"location":"java/part-3/","title":"Part III: \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3068 Option/Either","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3092\u5b66\u3073\u307e\u3059\u3002<code>null</code> \u3084\u4f8b\u5916\u306b\u983c\u3089\u305a\u3001Vavr \u306e <code>Option</code> \u3068 <code>Either</code> \u3092\u4f7f\u3063\u3066\u578b\u5b89\u5168\u306b\u30a8\u30e9\u30fc\u3092\u6271\u3046\u65b9\u6cd5\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"java/part-3/#6-option","title":"\u7b2c6\u7ae0: Option \u578b\u306b\u3088\u308b\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":""},{"location":"java/part-3/#61-option","title":"6.1 \u306a\u305c Option \u304c\u5fc5\u8981\u304b","text":"<p>\u5f93\u6765\u306e\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u306b\u306f\u554f\u984c\u304c\u3042\u308a\u307e\u3059\u3002</p> <p></p>"},{"location":"java/part-3/#62-option","title":"6.2 Option \u306e\u57fa\u672c","text":"<p><code>Option&lt;A&gt;</code> \u306f\u300c<code>A</code> \u578b\u306e\u5024\u304c\u3042\u308b\u304b\u3001\u306a\u3044\u304b\u300d\u3092\u8868\u3059\u578b\u3067\u3059\u3002</p> <p></p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch06/OptionBasics.java</code></p> <pre><code>import io.vavr.control.Option;\n\n// Some: \u5024\u304c\u5b58\u5728\u3059\u308b\nOption&lt;Integer&gt; some = Option.some(42);\n\n// None: \u5024\u304c\u5b58\u5728\u3057\u306a\u3044\nOption&lt;Integer&gt; none = Option.none();\n\n// null \u304b\u3089\u5b89\u5168\u306b\u4f5c\u6210\nOption&lt;String&gt; fromNull = Option.of(maybeNull); // null \u306a\u3089 None\n</code></pre>"},{"location":"java/part-3/#63-tv","title":"6.3 TV\u756a\u7d44\u306e\u30d1\u30fc\u30b9\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch06/TvShowParser.java</code></p> <p>TV\u756a\u7d44\u306e\u6587\u5b57\u5217\u3092\u30d1\u30fc\u30b9\u3059\u308b\u4f8b\u3067 Option \u306e\u4f7f\u3044\u65b9\u3092\u5b66\u3073\u307e\u3059\u3002</p> <pre><code>public record TvShow(String title, int start, int end) {}\n\n// \u5165\u529b\u4f8b: \"Breaking Bad (2008-2013)\"\n// \u671f\u5f85\u3059\u308b\u51fa\u529b: TvShow(\"Breaking Bad\", 2008, 2013)\n</code></pre>"},{"location":"java/part-3/#_1","title":"\u4f8b\u5916\u3092\u4f7f\u3046\u65b9\u6cd5\uff08\u554f\u984c\u3042\u308a\uff09","text":"<pre><code>public static TvShow parseShowUnsafe(String rawShow) {\n    int bracketOpen = rawShow.indexOf('(');\n    int bracketClose = rawShow.indexOf(')');\n    int dash = rawShow.indexOf('-');\n\n    String name = rawShow.substring(0, bracketOpen).trim();\n    int yearStart = Integer.parseInt(rawShow.substring(bracketOpen + 1, dash));\n    int yearEnd = Integer.parseInt(rawShow.substring(dash + 1, bracketClose));\n\n    return new TvShow(name, yearStart, yearEnd);\n}\n\n// \u6b63\u5e38\u30b1\u30fc\u30b9\nparseShowUnsafe(\"Breaking Bad (2008-2013)\");  // TvShow(\"Breaking Bad\", 2008, 2013)\n\n// \u7570\u5e38\u30b1\u30fc\u30b9 \u2192 \u4f8b\u5916\u304c\u30b9\u30ed\u30fc\u3055\u308c\u308b!\nparseShowUnsafe(\"Chernobyl (2019)\");           // StringIndexOutOfBoundsException\nparseShowUnsafe(\"The Wire 2002-2008\");         // StringIndexOutOfBoundsException\n</code></pre>"},{"location":"java/part-3/#option","title":"Option \u3092\u4f7f\u3046\u65b9\u6cd5","text":"<pre><code>public static Option&lt;TvShow&gt; parseShow(String rawShow) {\n    return extractName(rawShow).flatMap(name -&gt;\n        extractYearStart(rawShow).orElse(() -&gt; extractSingleYear(rawShow)).flatMap(yearStart -&gt;\n            extractYearEnd(rawShow).orElse(() -&gt; extractSingleYear(rawShow)).map(yearEnd -&gt;\n                new TvShow(name, yearStart, yearEnd)\n            )\n        )\n    );\n}\n\n// \u6b63\u5e38\u30b1\u30fc\u30b9\nparseShow(\"Breaking Bad (2008-2013)\");  // Some(TvShow(\"Breaking Bad\", 2008, 2013))\n\n// \u7570\u5e38\u30b1\u30fc\u30b9 \u2192 None \u304c\u8fd4\u3055\u308c\u308b\uff08\u4f8b\u5916\u306a\u3057\uff09\nparseShow(\"The Wire 2002-2008\");         // None\n</code></pre>"},{"location":"java/part-3/#64","title":"6.4 \u5c0f\u3055\u306a\u95a2\u6570\u304b\u3089\u7d44\u307f\u7acb\u3066\u308b","text":"<p>\u8907\u96d1\u306a\u30d1\u30fc\u30b9\u51e6\u7406\u3092\u5c0f\u3055\u306a\u95a2\u6570\u306b\u5206\u89e3\u3057\u307e\u3059\u3002</p> <pre><code>// \u540d\u524d\u3092\u62bd\u51fa\npublic static Option&lt;String&gt; extractName(String rawShow) {\n    int bracketOpen = rawShow.indexOf('(');\n    if (bracketOpen &gt; 0) {\n        return Option.some(rawShow.substring(0, bracketOpen).trim());\n    }\n    return Option.none();\n}\n\n// \u958b\u59cb\u5e74\u3092\u62bd\u51fa\npublic static Option&lt;Integer&gt; extractYearStart(String rawShow) {\n    int bracketOpen = rawShow.indexOf('(');\n    int dash = rawShow.indexOf('-');\n\n    if (bracketOpen != -1 &amp;&amp; dash &gt; bracketOpen + 1) {\n        String yearStr = rawShow.substring(bracketOpen + 1, dash);\n        return parseYear(yearStr);\n    }\n    return Option.none();\n}\n\n// \u6587\u5b57\u5217\u3092\u5e74\uff08\u6574\u6570\uff09\u306b\u30d1\u30fc\u30b9\npublic static Option&lt;Integer&gt; parseYear(String yearStr) {\n    try {\n        return Option.some(Integer.parseInt(yearStr.trim()));\n    } catch (NumberFormatException e) {\n        return Option.none();\n    }\n}\n</code></pre>"},{"location":"java/part-3/#65-orelse","title":"6.5 orElse \u306b\u3088\u308b\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af","text":"<p><code>orElse</code> \u3092\u4f7f\u3063\u3066\u3001\u6700\u521d\u306e Option \u304c <code>None</code> \u306e\u5834\u5408\u306b\u4ee3\u66ff\u3092\u8a66\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>Option&lt;Integer&gt; seven = Option.some(7);\nOption&lt;Integer&gt; eight = Option.some(8);\nOption&lt;Integer&gt; none = Option.none();\n\nseven.orElse(eight);  // Some(7) - \u6700\u521d\u304c Some \u306a\u306e\u3067\u305d\u306e\u307e\u307e\nnone.orElse(eight);   // Some(8) - \u6700\u521d\u304c None \u306a\u306e\u3067\u4ee3\u66ff\u3092\u4f7f\u7528\nseven.orElse(none);   // Some(7)\nnone.orElse(none);    // None\n</code></pre>"},{"location":"java/part-3/#_2","title":"\u5358\u5e74\u306e\u756a\u7d44\u306b\u5bfe\u5fdc\u3059\u308b","text":"<p>\u300cChernobyl (2019)\u300d\u306e\u3088\u3046\u306a\u5358\u5e74\u306e\u756a\u7d44\u3092\u30d1\u30fc\u30b9\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002</p> <pre><code>public static Option&lt;Integer&gt; extractSingleYear(String rawShow) {\n    int dash = rawShow.indexOf('-');\n    int bracketOpen = rawShow.indexOf('(');\n    int bracketClose = rawShow.indexOf(')');\n\n    if (dash == -1 &amp;&amp; bracketOpen != -1 &amp;&amp; bracketClose &gt; bracketOpen + 1) {\n        String yearStr = rawShow.substring(bracketOpen + 1, bracketClose);\n        return parseYear(yearStr);\n    }\n    return Option.none();\n}\n\n// \u3053\u308c\u3067\u5358\u5e74\u306e\u756a\u7d44\u3082\u30d1\u30fc\u30b9\u3067\u304d\u308b\nparseShow(\"Chernobyl (2019)\");  // Some(TvShow(\"Chernobyl\", 2019, 2019))\n</code></pre>"},{"location":"java/part-3/#66-option","title":"6.6 Option \u306e\u4e3b\u8981\u30e1\u30bd\u30c3\u30c9","text":"\u30e1\u30bd\u30c3\u30c9 \u8aac\u660e \u4f8b <code>map</code> \u5024\u304c\u3042\u308c\u3070\u5909\u63db <code>Some(5).map(x -&gt; x * 2)</code> \u2192 <code>Some(10)</code> <code>flatMap</code> \u5024\u304c\u3042\u308c\u3070 Option \u3092\u8fd4\u3059\u95a2\u6570\u3092\u9069\u7528 <code>Some(5).flatMap(x -&gt; Some(x * 2))</code> \u2192 <code>Some(10)</code> <code>filter</code> \u6761\u4ef6\u3092\u6e80\u305f\u3055\u306a\u3051\u308c\u3070 None <code>Some(5).filter(x -&gt; x &gt; 10)</code> \u2192 <code>None</code> <code>orElse</code> None \u306a\u3089\u4ee3\u66ff\u3092\u4f7f\u7528 <code>None.orElse(Some(5))</code> \u2192 <code>Some(5)</code> <code>getOrElse</code> None \u306a\u3089\u30c7\u30d5\u30a9\u30eb\u30c8\u5024 <code>None.getOrElse(0)</code> \u2192 <code>0</code> <code>toList</code> List \u306b\u5909\u63db <code>Some(5).toList()</code> \u2192 <code>List(5)</code> <code>toEither</code> Either \u306b\u5909\u63db <code>Some(5).toEither(\"error\")</code> \u2192 <code>Right(5)</code> <pre><code>Option&lt;Integer&gt; year = Option.some(996);\nOption&lt;Integer&gt; noYear = Option.none();\n\n// map\nyear.map(y -&gt; y * 2);    // Some(1992)\nnoYear.map(y -&gt; y * 2);  // None\n\n// flatMap\nyear.flatMap(y -&gt; Option.some(y * 2));    // Some(1992)\nnoYear.flatMap(y -&gt; Option.some(y * 2));  // None\n\n// filter\nyear.filter(y -&gt; y &lt; 2020);   // Some(996)\nyear.filter(y -&gt; y &gt; 2020);   // None\n\n// getOrElse\nyear.getOrElse(2020);    // 996\nnoYear.getOrElse(2020);  // 2020\n</code></pre>"},{"location":"java/part-3/#67","title":"6.7 \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u6226\u7565","text":"<p>\u8907\u6570\u306e\u8981\u7d20\u3092\u30d1\u30fc\u30b9\u3059\u308b\u5834\u5408\u30012\u3064\u306e\u6226\u7565\u304c\u3042\u308a\u307e\u3059\u3002</p> <p></p>"},{"location":"java/part-3/#best-effort","title":"Best-effort \u6226\u7565","text":"<pre><code>public static List&lt;TvShow&gt; parseShowsBestEffort(List&lt;String&gt; rawShows) {\n    return rawShows\n        .map(TvShowParser::parseShow)\n        .flatMap(Option::toList);\n}\n\nList&lt;String&gt; rawShows = List.of(\n    \"Breaking Bad (2008-2013)\",\n    \"The Wire 2002 2008\",        // \u7121\u52b9\u306a\u5f62\u5f0f\n    \"Mad Men (2007-2015)\"\n);\n\nparseShowsBestEffort(rawShows);\n// List(TvShow(\"Breaking Bad\", 2008, 2013), TvShow(\"Mad Men\", 2007, 2015))\n// \u7121\u52b9\u306a\u3082\u306e\u306f\u7121\u8996\u3055\u308c\u308b\n</code></pre>"},{"location":"java/part-3/#all-or-nothing","title":"All-or-nothing \u6226\u7565","text":"<pre><code>public static Option&lt;List&lt;TvShow&gt;&gt; parseShowsAllOrNothing(List&lt;String&gt; rawShows) {\n    Option&lt;List&lt;TvShow&gt;&gt; initial = Option.some(List.empty());\n\n    return rawShows\n        .map(TvShowParser::parseShow)\n        .foldLeft(initial, (acc, optShow) -&gt;\n            acc.flatMap(shows -&gt;\n                optShow.map(shows::append)\n            )\n        );\n}\n\n// \u5168\u90e8\u6210\u529f \u2192 Some(List(...))\nparseShowsAllOrNothing(List.of(\"Breaking Bad (2008-2013)\", \"Mad Men (2007-2015)\"));\n// Some(List(TvShow(...), TvShow(...)))\n\n// \u4e00\u3064\u3067\u3082\u5931\u6557 \u2192 None\nparseShowsAllOrNothing(List.of(\"Breaking Bad (2008-2013)\", \"Invalid\"));\n// None\n</code></pre>"},{"location":"java/part-3/#68-forall-exists","title":"6.8 forall \u3068 exists","text":"<p>Option \u3067\u6761\u4ef6\u5224\u5b9a\u3092\u3059\u308b\u969b\u306b\u4fbf\u5229\u306a\u30e1\u30bd\u30c3\u30c9\u3067\u3059\u3002</p> \u30e1\u30bd\u30c3\u30c9 Option \u3067\u306e\u52d5\u4f5c <code>forAll(p)</code> None \u2192 true, Some(x) \u2192 p(x) <code>exists(p)</code> None \u2192 false, Some(x) \u2192 p(x) <pre><code>Option&lt;Integer&gt; year = Option.some(996);\nOption&lt;Integer&gt; noYear = Option.none();\n\n// forAll - \u300c\u5168\u3066\u300d\u307e\u305f\u306f\u300c\u5b58\u5728\u3057\u306a\u3044\u300d\nyear.forAll(y -&gt; y &lt; 2020);    // true (996 &lt; 2020)\nnoYear.forAll(y -&gt; y &lt; 2020);  // true (\u5024\u304c\u306a\u3044\u306e\u3067\u300c\u5168\u3066\u300d\u304c\u81ea\u660e\u306b\u771f)\nyear.forAll(y -&gt; y &gt; 2020);    // false\n\n// exists - \u300c\u5b58\u5728\u3057\u3066\u6761\u4ef6\u3092\u6e80\u305f\u3059\u300d\nyear.exists(y -&gt; y &lt; 2020);    // true\nnoYear.exists(y -&gt; y &lt; 2020);  // false (\u5024\u304c\u306a\u3044\u306e\u3067\u5b58\u5728\u3057\u306a\u3044)\n</code></pre>"},{"location":"java/part-3/#7-either","title":"\u7b2c7\u7ae0: Either \u578b\u3068\u8907\u5408\u7684\u306a\u30a8\u30e9\u30fc\u51e6\u7406","text":""},{"location":"java/part-3/#71-option","title":"7.1 Option \u306e\u9650\u754c","text":"<p><code>Option</code> \u306f\u300c\u5024\u304c\u3042\u308b\u304b\u306a\u3044\u304b\u300d\u3057\u304b\u8868\u73fe\u3067\u304d\u307e\u305b\u3093\u3002\u306a\u305c\u5931\u6557\u3057\u305f\u306e\u304b\u3092\u4f1d\u3048\u3089\u308c\u307e\u305b\u3093\u3002</p> <p></p>"},{"location":"java/part-3/#72-either","title":"7.2 Either \u306e\u57fa\u672c","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch07/EitherBasics.java</code></p> <p><code>Either&lt;E, A&gt;</code> \u306f\u300c<code>E</code> \u578b\u306e\u30a8\u30e9\u30fc\u304b\u3001<code>A</code> \u578b\u306e\u6210\u529f\u5024\u304b\u300d\u3092\u8868\u3059\u578b\u3067\u3059\u3002</p> <ul> <li><code>Right(value)</code>: \u6210\u529f\uff08\u6163\u4f8b\u7684\u306b\u300c\u6b63\u3057\u3044\u300d= right\uff09</li> <li><code>Left(error)</code>: \u5931\u6557\uff08\u30a8\u30e9\u30fc\u60c5\u5831\u3092\u4fdd\u6301\uff09</li> </ul> <pre><code>import io.vavr.control.Either;\n\npublic static Either&lt;String, String&gt; extractName(String show) {\n    int bracketOpen = show.indexOf('(');\n    if (bracketOpen &gt; 0) {\n        return Either.right(show.substring(0, bracketOpen).trim());\n    }\n    return Either.left(\"Can't extract name from: \" + show);\n}\n\nextractName(\"The Wire (2002-2008)\");  // Right(\"The Wire\")\nextractName(\"(2022)\");                // Left(\"Can't extract name from: (2022)\")\n</code></pre>"},{"location":"java/part-3/#73-either","title":"7.3 Either \u3092\u4f7f\u3063\u305f\u30d1\u30fc\u30b9","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch07/TvShowParserEither.java</code></p> <pre><code>public static Either&lt;String, Integer&gt; extractYearStart(String rawShow) {\n    int bracketOpen = rawShow.indexOf('(');\n    int dash = rawShow.indexOf('-');\n\n    if (bracketOpen != -1 &amp;&amp; dash &gt; bracketOpen + 1) {\n        String yearStr = rawShow.substring(bracketOpen + 1, dash);\n        return parseYear(yearStr, \"start year\");\n    }\n    return Either.left(\"Can't extract start year from: \" + rawShow);\n}\n\nextractYearStart(\"The Wire (2002-2008)\");  // Right(2002)\nextractYearStart(\"The Wire (-2008)\");      // Left(\"Can't extract start year from: The Wire (-2008)\")\nextractYearStart(\"The Wire (oops-2008)\");  // Left(\"Can't parse start year: 'oops'\")\n</code></pre>"},{"location":"java/part-3/#74-option-either","title":"7.4 Option \u304b\u3089 Either \u3078\u306e\u5909\u63db","text":"<p><code>toEither</code> \u30e1\u30bd\u30c3\u30c9\u3067 <code>Option</code> \u3092 <code>Either</code> \u306b\u5909\u63db\u3067\u304d\u307e\u3059\u3002</p> <pre><code>Option&lt;Integer&gt; year = Option.some(996);\nOption&lt;Integer&gt; noYear = Option.none();\n\nyear.toEither(\"no year given\");    // Right(996)\nnoYear.toEither(\"no year given\");  // Left(\"no year given\")\n</code></pre>"},{"location":"java/part-3/#75-either","title":"7.5 Either \u306e\u4e3b\u8981\u30e1\u30bd\u30c3\u30c9","text":"\u30e1\u30bd\u30c3\u30c9 \u8aac\u660e \u4f8b <code>map</code> Right \u306e\u5024\u3092\u5909\u63db <code>Right(5).map(x -&gt; x * 2)</code> \u2192 <code>Right(10)</code> <code>flatMap</code> Right \u306a\u3089 Either \u3092\u8fd4\u3059\u95a2\u6570\u3092\u9069\u7528 <code>Right(5).flatMap(x -&gt; Right(x * 2))</code> \u2192 <code>Right(10)</code> <code>orElse</code> Left \u306a\u3089\u4ee3\u66ff\u3092\u4f7f\u7528 <code>Left(\"err\").orElse(Right(5))</code> \u2192 <code>Right(5)</code> <code>toOption</code> Option \u306b\u5909\u63db <code>Right(5).toOption()</code> \u2192 <code>Some(5)</code> <code>fold</code> \u4e21\u65b9\u306e\u30b1\u30fc\u30b9\u3092\u51e6\u7406 <code>either.fold(err -&gt; ..., val -&gt; ...)</code> <pre><code>Either&lt;String, Integer&gt; year = Either.right(996);\nEither&lt;String, Integer&gt; noYear = Either.left(\"no year\");\n\n// map\nyear.map(y -&gt; y * 2);    // Right(1992)\nnoYear.map(y -&gt; y * 2);  // Left(\"no year\")\n\n// flatMap\nyear.flatMap(y -&gt; Either.right(y * 2));   // Right(1992)\nnoYear.flatMap(y -&gt; Either.right(y * 2)); // Left(\"no year\")\n\n// fold\nyear.fold(\n    error -&gt; \"Error: \" + error,\n    value -&gt; \"Success: \" + value\n);  // \"Success: 996\"\n</code></pre>"},{"location":"java/part-3/#76","title":"7.6 \u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u306e\u4f8b","text":"<pre><code>public static Either&lt;String, Integer&gt; validateAge(int age) {\n    if (age &lt; 0) {\n        return Either.left(\"Age cannot be negative\");\n    } else if (age &gt; 150) {\n        return Either.left(\"Age cannot be greater than 150\");\n    }\n    return Either.right(age);\n}\n\nvalidateAge(25);   // Right(25)\nvalidateAge(-5);   // Left(\"Age cannot be negative\")\nvalidateAge(200);  // Left(\"Age cannot be greater than 150\")\n</code></pre>"},{"location":"java/part-3/#_3","title":"\u8907\u5408\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3","text":"<pre><code>public record User(String username, String email, int age) {}\n\npublic static Either&lt;String, User&gt; validateUser(String username, String email, int age) {\n    return validateUsername(username).flatMap(validUsername -&gt;\n        validateEmail(email).flatMap(validEmail -&gt;\n            validateAge(age).map(validAge -&gt;\n                new User(validUsername, validEmail, validAge)\n            )\n        )\n    );\n}\n\nvalidateUser(\"alice\", \"alice@example.com\", 25);  // Right(User(...))\nvalidateUser(\"ab\", \"alice@example.com\", 25);     // Left(\"Username must be at least 3 characters\")\n</code></pre>"},{"location":"java/part-3/#77-adt","title":"7.7 \u4ee3\u6570\u7684\u30c7\u30fc\u30bf\u578b\uff08ADT\uff09","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch07/MusicArtist.java</code></p> <p>Java 17+ \u306e sealed interface \u3068 record \u3092\u4f7f\u3063\u3066 ADT \u3092\u8868\u73fe\u3057\u307e\u3059\u3002</p>"},{"location":"java/part-3/#sum-type-sealed-interface","title":"\u76f4\u548c\u578b\uff08Sum Type\uff09- sealed interface","text":"<pre><code>// \u6d3b\u52d5\u671f\u9593\u3092\u8868\u3059\u76f4\u548c\u578b\npublic sealed interface YearsActive permits StillActive, ActiveBetween {}\n\npublic record StillActive(int since) implements YearsActive {}\npublic record ActiveBetween(int start, int end) implements YearsActive {}\n</code></pre>"},{"location":"java/part-3/#product-type-record","title":"\u76f4\u7a4d\u578b\uff08Product Type\uff09- record","text":"<pre><code>public record Artist(\n    String name,\n    MusicGenre genre,\n    String origin,\n    YearsActive yearsActive\n) {}\n</code></pre>"},{"location":"java/part-3/#78","title":"7.8 \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0","text":"<p>Java 21 \u306e\u62e1\u5f35 switch \u3092\u4f7f\u3063\u3066\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u884c\u3044\u307e\u3059\u3002</p> <pre><code>public static boolean wasArtistActive(Artist artist, int yearStart, int yearEnd) {\n    return switch (artist.yearsActive()) {\n        case StillActive(int since) -&gt; since &lt;= yearEnd;\n        case ActiveBetween(int start, int end) -&gt; start &lt;= yearEnd &amp;&amp; end &gt;= yearStart;\n    };\n}\n\npublic static int activeLength(Artist artist, int currentYear) {\n    return switch (artist.yearsActive()) {\n        case StillActive(int since) -&gt; currentYear - since;\n        case ActiveBetween(int start, int end) -&gt; end - start;\n    };\n}\n\n// \u4f7f\u7528\u4f8b\nArtist metallica = new Artist(\"Metallica\", MusicGenre.HEAVY_METAL, \"U.S.\", new StillActive(1981));\nArtist ledZeppelin = new Artist(\"Led Zeppelin\", MusicGenre.HARD_ROCK, \"England\", new ActiveBetween(1968, 1980));\n\nactiveLength(metallica, 2024);    // 43 (2024 - 1981)\nactiveLength(ledZeppelin, 2024);  // 12 (1980 - 1968)\n</code></pre>"},{"location":"java/part-3/#79","title":"7.9 \u691c\u7d22\u6761\u4ef6\u306e\u30e2\u30c7\u30ea\u30f3\u30b0","text":"<p>\u691c\u7d22\u6761\u4ef6\u3082 ADT \u3067\u30e2\u30c7\u30ea\u30f3\u30b0\u3067\u304d\u307e\u3059\u3002</p> <pre><code>public sealed interface SearchCondition permits SearchByGenre, SearchByOrigin, SearchByActiveYears {}\n\npublic record SearchByGenre(List&lt;MusicGenre&gt; genres) implements SearchCondition {}\npublic record SearchByOrigin(List&lt;String&gt; locations) implements SearchCondition {}\npublic record SearchByActiveYears(int start, int end) implements SearchCondition {}\n\npublic static List&lt;Artist&gt; searchArtists(\n        List&lt;Artist&gt; artists,\n        List&lt;SearchCondition&gt; requiredConditions) {\n    return artists.filter(artist -&gt;\n        requiredConditions.forAll(condition -&gt; matchesCondition(artist, condition))\n    );\n}\n\npublic static boolean matchesCondition(Artist artist, SearchCondition condition) {\n    return switch (condition) {\n        case SearchByGenre(List&lt;MusicGenre&gt; genres) -&gt;\n            genres.contains(artist.genre());\n        case SearchByOrigin(List&lt;String&gt; locations) -&gt;\n            locations.contains(artist.origin());\n        case SearchByActiveYears(int start, int end) -&gt;\n            wasArtistActive(artist, start, end);\n    };\n}\n</code></pre>"},{"location":"java/part-3/#710","title":"7.10 \u652f\u6255\u3044\u65b9\u6cd5\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch07/PaymentMethod.java</code></p> <pre><code>public sealed interface Payment permits CreditCard, BankTransfer, Cash {}\n\npublic record CreditCard(String number, String expiry) implements Payment {}\npublic record BankTransfer(String accountNumber) implements Payment {}\npublic record Cash() implements Payment {}\n\npublic static String describePayment(Payment method) {\n    return switch (method) {\n        case CreditCard(String number, String expiry) -&gt;\n            \"Credit card ending in \" + number.substring(number.length() - 4);\n        case BankTransfer(String account) -&gt;\n            \"Bank transfer to account \" + account;\n        case Cash() -&gt;\n            \"Cash payment\";\n    };\n}\n</code></pre>"},{"location":"java/part-3/#_4","title":"\u307e\u3068\u3081","text":""},{"location":"java/part-3/#part-iii","title":"Part III \u3067\u5b66\u3093\u3060\u3053\u3068","text":"<ol> <li>Option: \u5024\u306e\u6709\u7121\u3092\u578b\u3067\u8868\u73fe\u3059\u308b</li> <li>Either: \u6210\u529f/\u5931\u6557\u3068\u30a8\u30e9\u30fc\u60c5\u5831\u3092\u578b\u3067\u8868\u73fe\u3059\u308b</li> <li>flatMap: Option/Either \u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u4f7f\u3046</li> <li>orElse: \u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u3092\u63d0\u4f9b\u3059\u308b</li> <li>ADT: \u76f4\u7a4d\u578b\u3068\u76f4\u548c\u578b\u3067\u30c9\u30e1\u30a4\u30f3\u3092\u6b63\u78ba\u306b\u30e2\u30c7\u30ea\u30f3\u30b0</li> <li>\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0: \u76f4\u548c\u578b\u3092\u5b89\u5168\u306b\u51e6\u7406\u3059\u308b</li> </ol>"},{"location":"java/part-3/#option-vs-either","title":"Option vs Either \u306e\u4f7f\u3044\u5206\u3051","text":"\u72b6\u6cc1 \u4f7f\u7528\u3059\u308b\u578b \u5024\u304c\u3042\u308b\u304b\u306a\u3044\u304b\u3060\u3051\u304c\u91cd\u8981 <code>Option&lt;A&gt;</code> \u5931\u6557\u7406\u7531\u3092\u4f1d\u3048\u308b\u5fc5\u8981\u304c\u3042\u308b <code>Either&lt;E, A&gt;</code> \u691c\u7d22\u7d50\u679c\u304c\u898b\u3064\u304b\u3089\u306a\u3044 <code>Option&lt;A&gt;</code> \u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u30a8\u30e9\u30fc\u3092\u4f1d\u3048\u308b <code>Either&lt;String, A&gt;</code> \u8907\u6570\u306e\u30a8\u30e9\u30fc\u7a2e\u5225\u304c\u3042\u308b <code>Either&lt;ErrorType, A&gt;</code>"},{"location":"java/part-3/#scala","title":"Scala \u3068\u306e\u5bfe\u5fdc","text":"Scala Java + Vavr <code>Option[A]</code> <code>io.vavr.control.Option&lt;A&gt;</code> <code>Some(x)</code> <code>Option.some(x)</code> <code>None</code> <code>Option.none()</code> <code>Either[E, A]</code> <code>io.vavr.control.Either&lt;E, A&gt;</code> <code>Right(x)</code> <code>Either.right(x)</code> <code>Left(e)</code> <code>Either.left(e)</code> <code>toRight(e)</code> <code>toEither(e)</code> <code>case class</code> <code>record</code> <code>sealed trait</code> <code>sealed interface</code> <code>match { case ... }</code> <code>switch (expr) { case ... -&gt; }</code>"},{"location":"java/part-3/#_5","title":"\u6b21\u306e\u30d1\u30fc\u30c8","text":"<p>Part IV \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li>IO \u30e2\u30ca\u30c9\u306e\u5c0e\u5165</li> <li>\u526f\u4f5c\u7528\u306e\u7ba1\u7406</li> <li>\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406</li> </ul>"},{"location":"java/part-4/","title":"Part IV: IO \u3068\u526f\u4f5c\u7528\u306e\u7ba1\u7406","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u526f\u4f5c\u7528\u306e\u6271\u3044\u65b9\u3092\u5b66\u3073\u307e\u3059\u3002IO \u30e2\u30ca\u30c9\u3092\u4f7f\u3063\u3066\u526f\u4f5c\u7528\u3092\u7d14\u7c8b\u95a2\u6570\u5185\u3067\u5b89\u5168\u306b\u8a18\u8ff0\u3057\u3001\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406\u3067\u7121\u9650\u306e\u30c7\u30fc\u30bf\u3092\u6271\u3046\u65b9\u6cd5\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"java/part-4/#8-io","title":"\u7b2c8\u7ae0: IO \u30e2\u30ca\u30c9\u306e\u5c0e\u5165","text":""},{"location":"java/part-4/#81","title":"8.1 \u526f\u4f5c\u7528\u306e\u554f\u984c","text":"<p>\u7d14\u7c8b\u95a2\u6570\u306f\u526f\u4f5c\u7528\u3092\u6301\u3061\u307e\u305b\u3093\u3002\u3057\u304b\u3057\u3001\u5b9f\u969b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u306b\u306f\u526f\u4f5c\u7528\u304c\u5fc5\u8981\u3067\u3059:</p> <ul> <li>\u30d5\u30a1\u30a4\u30eb\u306e\u8aad\u307f\u66f8\u304d</li> <li>\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u901a\u4fe1</li> <li>\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30a2\u30af\u30bb\u30b9</li> <li>\u4e71\u6570\u751f\u6210</li> <li>\u73fe\u5728\u6642\u523b\u306e\u53d6\u5f97</li> </ul> <p></p>"},{"location":"java/part-4/#82-io","title":"8.2 IO \u30e2\u30ca\u30c9\u3068\u306f","text":"<p>IO \u30e2\u30ca\u30c9\u306f\u300c\u526f\u4f5c\u7528\u3092\u6301\u3064\u8a08\u7b97\u306e\u8a18\u8ff0\u300d\u3092\u8868\u3059\u578b\u3067\u3059\u3002</p> <ul> <li><code>IO&lt;A&gt;</code> \u306f\u300c\u5b9f\u884c\u3059\u308b\u3068 <code>A</code> \u578b\u306e\u5024\u3092\u8fd4\u3059\u526f\u4f5c\u7528\u306e\u3042\u308b\u8a08\u7b97\u300d</li> <li>IO \u5024\u3092\u4f5c\u6210\u3057\u305f\u3060\u3051\u3067\u306f\u526f\u4f5c\u7528\u306f\u767a\u751f\u3057\u306a\u3044</li> <li><code>unsafeRun()</code> \u3067\u5b9f\u969b\u306b\u5b9f\u884c\u3055\u308c\u308b</li> </ul> <p></p>"},{"location":"java/part-4/#83-io","title":"8.3 IO \u306e\u5b9f\u88c5","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch08/IO.java</code></p> <p>Java + Vavr \u3067\u306e IO \u30e2\u30ca\u30c9\u306e\u7c21\u6613\u5b9f\u88c5\u3067\u3059:</p> <pre><code>public final class IO&lt;A&gt; {\n\n    private final Supplier&lt;A&gt; thunk;\n\n    private IO(Supplier&lt;A&gt; thunk) {\n        this.thunk = thunk;\n    }\n\n    // \u526f\u4f5c\u7528\u306e\u3042\u308b\u5f0f\u3092\u9045\u5ef6\u5b9f\u884c\u3059\u308b IO \u3092\u4f5c\u6210\n    public static &lt;A&gt; IO&lt;A&gt; delay(Supplier&lt;A&gt; supplier) {\n        return new IO&lt;&gt;(supplier);\n    }\n\n    // \u65e2\u5b58\u306e\u5024\u3092\u30e9\u30c3\u30d7\uff08\u526f\u4f5c\u7528\u306a\u3057\uff09\n    public static &lt;A&gt; IO&lt;A&gt; pure(A value) {\n        return new IO&lt;&gt;(() -&gt; value);\n    }\n\n    // IO \u3092\u5b9f\u884c\u3057\u3066\u7d50\u679c\u3092\u53d6\u5f97\uff08\u526f\u4f5c\u7528\u304c\u767a\u751f\u3059\u308b\uff09\n    public A unsafeRun() {\n        return thunk.get();\n    }\n\n    // \u7d50\u679c\u3092\u5909\u63db\u3059\u308b\n    public &lt;B&gt; IO&lt;B&gt; map(Function&lt;A, B&gt; f) {\n        return new IO&lt;&gt;(() -&gt; f.apply(thunk.get()));\n    }\n\n    // IO \u3092\u8fd4\u3059\u95a2\u6570\u3092\u9069\u7528\u3057\u3066\u30d5\u30e9\u30c3\u30c8\u5316\n    public &lt;B&gt; IO&lt;B&gt; flatMap(Function&lt;A, IO&lt;B&gt;&gt; f) {\n        return new IO&lt;&gt;(() -&gt; f.apply(thunk.get()).unsafeRun());\n    }\n}\n</code></pre>"},{"location":"java/part-4/#84","title":"8.4 \u30b5\u30a4\u30b3\u30ed\u3092\u632f\u308b\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch08/CastingDie.java</code></p>"},{"location":"java/part-4/#_1","title":"\u4e0d\u7d14\u306a\u95a2\u6570\uff08\u526f\u4f5c\u7528\u3042\u308a\uff09","text":"<pre><code>private static final Random random = new Random();\n\n// \u547c\u3073\u51fa\u3059\u305f\u3073\u306b\u7570\u306a\u308b\u5024\u304c\u8fd4\u308b\npublic static int castTheDieImpure() {\n    return random.nextInt(6) + 1;\n}\n</code></pre>"},{"location":"java/part-4/#io","title":"IO \u3092\u4f7f\u3063\u305f\u7d14\u7c8b\u306a\u8a18\u8ff0","text":"<pre><code>// \u30b5\u30a4\u30b3\u30ed\u3092\u632f\u308b\uff08IO \u3067\u30e9\u30c3\u30d7\uff09\n// IO \u5024\u3092\u4f5c\u6210\u3057\u305f\u3060\u3051\u3067\u306f\u5b9f\u884c\u3055\u308c\u306a\u3044\npublic static IO&lt;Integer&gt; castTheDie() {\n    return IO.delay(CastingDie::castTheDieImpure);\n}\n\n// IO \u5024\u3092\u4f5c\u6210\uff08\u3053\u306e\u6642\u70b9\u3067\u306f\u5b9f\u884c\u3055\u308c\u306a\u3044\uff09\nIO&lt;Integer&gt; dieCast = castTheDie();\nSystem.out.println(dieCast);  // IO(...) - \u307e\u3060\u5b9f\u884c\u3055\u308c\u3066\u3044\u306a\u3044\n\n// \u5b9f\u969b\u306b\u5b9f\u884c\nSystem.out.println(dieCast.unsafeRun());  // 4\n</code></pre>"},{"location":"java/part-4/#85-io","title":"8.5 IO \u306e\u4f5c\u6210\u65b9\u6cd5","text":"\u30e1\u30bd\u30c3\u30c9 \u7528\u9014 \u4f8b <code>IO.delay(expr)</code> \u526f\u4f5c\u7528\u306e\u3042\u308b\u5f0f\u3092\u30e9\u30c3\u30d7 <code>IO.delay(() -&gt; System.out.println(\"hello\"))</code> <code>IO.pure(value)</code> \u65e2\u5b58\u306e\u5024\u3092\u30e9\u30c3\u30d7\uff08\u526f\u4f5c\u7528\u306a\u3057\uff09 <code>IO.pure(42)</code> <code>IO.unit()</code> \u4f55\u3082\u3057\u306a\u3044 IO <code>IO.unit()</code> (= <code>IO.pure(null)</code>) <code>IO.effect(runnable)</code> \u526f\u4f5c\u7528\u306e\u307f\u3092\u5b9f\u884c <code>IO.effect(() -&gt; System.out.println(\"!\"))</code> <pre><code>// IO.delay: \u526f\u4f5c\u7528\u3092\u9045\u5ef6\u5b9f\u884c\nIO&lt;Void&gt; delayedPrint = IO.effect(() -&gt; System.out.println(\"Hello\"));\n// println \u306f\u307e\u3060\u5b9f\u884c\u3055\u308c\u3066\u3044\u306a\u3044\n\n// IO.pure: \u65e2\u5b58\u306e\u5024\u3092\u30e9\u30c3\u30d7\nIO&lt;Integer&gt; pureValue = IO.pure(42);\n// \u526f\u4f5c\u7528\u306a\u3057\u3001\u5373\u5ea7\u306b 42 \u304c\u78ba\u5b9a\n</code></pre>"},{"location":"java/part-4/#86-io","title":"8.6 IO \u306e\u5408\u6210","text":"<p>IO \u5024\u306f <code>flatMap</code> \u3084 <code>map</code> \u3067\u5408\u6210\u3067\u304d\u307e\u3059\u3002</p> <pre><code>// \u30b5\u30a4\u30b3\u30ed\u30922\u56de\u632f\u3063\u3066\u5408\u8a08\u3092\u8fd4\u3059\npublic static IO&lt;Integer&gt; castTheDieTwice() {\n    return castTheDie()\n            .flatMap(first -&gt; castTheDie()\n                    .map(second -&gt; first + second));\n}\n\n// \u307e\u3060\u5b9f\u884c\u3055\u308c\u3066\u3044\u306a\u3044\nIO&lt;Integer&gt; program = castTheDieTwice();\n\n// \u5b9f\u884c\nint result = program.unsafeRun();\n</code></pre> <p></p>"},{"location":"java/part-4/#87","title":"8.7 \u30df\u30fc\u30c6\u30a3\u30f3\u30b0\u30b9\u30b1\u30b8\u30e5\u30fc\u30ea\u30f3\u30b0\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch08/SchedulingMeetings.java</code></p> <p>\u3088\u308a\u5b9f\u8df5\u7684\u306a\u4f8b\u3068\u3057\u3066\u3001\u30df\u30fc\u30c6\u30a3\u30f3\u30b0\u306e\u30b9\u30b1\u30b8\u30e5\u30fc\u30ea\u30f3\u30b0\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p>"},{"location":"java/part-4/#_2","title":"\u30c7\u30fc\u30bf\u578b","text":"<pre><code>public record MeetingTime(int startHour, int endHour) {\n    public int lengthHours() {\n        return endHour - startHour;\n    }\n}\n</code></pre>"},{"location":"java/part-4/#api-io","title":"\u526f\u4f5c\u7528\u306e\u3042\u308b API \u547c\u3073\u51fa\u3057\u3092 IO \u3067\u30e9\u30c3\u30d7","text":"<pre><code>public static IO&lt;List&lt;MeetingTime&gt;&gt; calendarEntries(String name) {\n    return IO.delay(() -&gt; simulateCalendarApi(name));\n}\n\npublic static IO&lt;Void&gt; createMeeting(List&lt;String&gt; attendees, MeetingTime meeting) {\n    return IO.effect(() -&gt; {\n        System.out.println(\"Creating meeting for \" + attendees.mkString(\", \") +\n                \" at \" + meeting.startHour() + \":00 - \" + meeting.endHour() + \":00\");\n    });\n}\n</code></pre>"},{"location":"java/part-4/#_3","title":"\u4e88\u5b9a\u306e\u53d6\u5f97","text":"<pre><code>public static IO&lt;List&lt;MeetingTime&gt;&gt; scheduledMeetings(String person1, String person2) {\n    return calendarEntries(person1)\n            .flatMap(p1Entries -&gt; calendarEntries(person2)\n                    .map(p2Entries -&gt; p1Entries.appendAll(p2Entries)));\n}\n</code></pre>"},{"location":"java/part-4/#_4","title":"\u7a7a\u304d\u6642\u9593\u306e\u8a08\u7b97\uff08\u7d14\u7c8b\u95a2\u6570\uff09","text":"<pre><code>public static List&lt;MeetingTime&gt; possibleMeetings(\n        List&lt;MeetingTime&gt; existingMeetings,\n        int startHour,\n        int endHour,\n        int lengthHours) {\n\n    return List.range(startHour, endHour - lengthHours + 1)\n            .map(start -&gt; new MeetingTime(start, start + lengthHours))\n            .filter(slot -&gt; existingMeetings.forAll(\n                    existing -&gt; !meetingsOverlap(existing, slot)));\n}\n</code></pre>"},{"location":"java/part-4/#88-orelse","title":"8.8 orElse \u306b\u3088\u308b\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":"<p>IO \u306e <code>orElse</code> \u30e1\u30bd\u30c3\u30c9\u3067\u3001\u5931\u6557\u6642\u306e\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002</p> <pre><code>IO&lt;Integer&gt; year = IO.delay(() -&gt; 996);\nIO&lt;Integer&gt; noYear = IO.delay(() -&gt; { throw new RuntimeException(\"no year\"); });\n\nyear.orElse(2020).unsafeRun();    // 996\nnoYear.orElse(2020).unsafeRun();  // 2020\n</code></pre> <p></p>"},{"location":"java/part-4/#_5","title":"\u30ea\u30c8\u30e9\u30a4\u6226\u7565","text":"<pre><code>// API \u547c\u3073\u51fa\u3057\u30923\u56de\u307e\u3067\u30ea\u30c8\u30e9\u30a4\ncalendarEntries(\"Alice\")\n    .retry(3)\n    .orElse(List.empty());  // \u5168\u90e8\u5931\u6557\u3057\u305f\u3089\u7a7a\u30ea\u30b9\u30c8\n</code></pre>"},{"location":"java/part-4/#_6","title":"\u6c4e\u7528\u30ea\u30c8\u30e9\u30a4\u95a2\u6570","text":"<pre><code>public IO&lt;A&gt; retry(int maxRetries) {\n    IO&lt;A&gt; result = this;\n    for (int i = 0; i &lt; maxRetries; i++) {\n        result = result.orElse(() -&gt; this);\n    }\n    return result;\n}\n\n// \u4f7f\u7528\u4f8b\ncalendarEntries(\"Alice\").retry(10);\n</code></pre>"},{"location":"java/part-4/#89-sequence-io","title":"8.9 sequence \u306b\u3088\u308b IO \u306e\u30ea\u30b9\u30c8\u51e6\u7406","text":"<p><code>List&lt;IO&lt;A&gt;&gt;</code> \u3092 <code>IO&lt;List&lt;A&gt;&gt;</code> \u306b\u5909\u63db\u3059\u308b\u306b\u306f <code>sequence</code> \u3092\u4f7f\u3044\u307e\u3059\u3002</p> <pre><code>public static &lt;A&gt; IO&lt;List&lt;A&gt;&gt; sequence(List&lt;IO&lt;A&gt;&gt; ios) {\n    return ios.foldLeft(\n            IO.pure(List.empty()),\n            (acc, io) -&gt; acc.flatMap(list -&gt; io.map(list::append))\n    );\n}\n\nList&lt;IO&lt;Integer&gt;&gt; actions = List.of(IO.pure(1), IO.pure(2), IO.pure(3));\nIO&lt;List&lt;Integer&gt;&gt; combined = IO.sequence(actions);\n\ncombined.unsafeRun();  // List(1, 2, 3)\n</code></pre>"},{"location":"java/part-4/#_7","title":"\u8907\u6570\u4eba\u306e\u4e88\u5b9a\u3092\u53d6\u5f97","text":"<pre><code>public static IO&lt;List&lt;MeetingTime&gt;&gt; scheduledMeetings(List&lt;String&gt; attendees) {\n    return IO.traverse(attendees, SchedulingMeetings::calendarEntries)\n            .map(lists -&gt; lists.flatMap(x -&gt; x));\n}\n</code></pre>"},{"location":"java/part-4/#9","title":"\u7b2c9\u7ae0: \u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406","text":""},{"location":"java/part-4/#91","title":"9.1 \u30b9\u30c8\u30ea\u30fc\u30e0\u3068\u306f","text":"<p>\u30b9\u30c8\u30ea\u30fc\u30e0\u306f\u3001\u8981\u7d20\u306e\uff08\u6f5c\u5728\u7684\u306b\u7121\u9650\u306e\uff09\u30b7\u30fc\u30b1\u30f3\u30b9\u3092\u8868\u3057\u307e\u3059\u3002</p> <p></p>"},{"location":"java/part-4/#92-lazystream","title":"9.2 LazyStream \u306e\u5b9f\u88c5","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch09/LazyStream.java</code></p> <p>Java + Vavr \u3067\u306e\u9045\u5ef6\u8a55\u4fa1\u30b9\u30c8\u30ea\u30fc\u30e0\u306e\u5b9f\u88c5\u3067\u3059:</p> <pre><code>public final class LazyStream&lt;A&gt; implements Iterable&lt;A&gt; {\n\n    private final Supplier&lt;Option&lt;Cons&lt;A&gt;&gt;&gt; headTail;\n\n    private record Cons&lt;A&gt;(A head, LazyStream&lt;A&gt; tail) {}\n\n    private LazyStream(Supplier&lt;Option&lt;Cons&lt;A&gt;&gt;&gt; headTail) {\n        this.headTail = headTail;\n    }\n\n    // \u7a7a\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\n    public static &lt;A&gt; LazyStream&lt;A&gt; empty() {\n        return new LazyStream&lt;&gt;(Option::none);\n    }\n\n    // \u5358\u4e00\u8981\u7d20\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\n    public static &lt;A&gt; LazyStream&lt;A&gt; of(A value) {\n        return new LazyStream&lt;&gt;(() -&gt;\n            Option.some(new Cons&lt;&gt;(value, empty())));\n    }\n\n    // \u7121\u9650\u306b\u5024\u3092\u7e70\u308a\u8fd4\u3059\u30b9\u30c8\u30ea\u30fc\u30e0\n    public static &lt;A&gt; LazyStream&lt;A&gt; repeat(A value) {\n        return new LazyStream&lt;&gt;(() -&gt;\n            Option.some(new Cons&lt;&gt;(value, repeat(value))));\n    }\n}\n</code></pre>"},{"location":"java/part-4/#93","title":"9.3 \u7d14\u7c8b\u306a\u30b9\u30c8\u30ea\u30fc\u30e0","text":"<pre><code>// \u6709\u9650\u30b9\u30c8\u30ea\u30fc\u30e0\nLazyStream&lt;Integer&gt; numbers = LazyStream.of(1, 2, 3);\n\n// List \u306b\u5909\u63db\nnumbers.toList();  // List(1, 2, 3)\n\n// \u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\nLazyStream&lt;Integer&gt; oddNumbers = numbers.filter(x -&gt; x % 2 != 0);\noddNumbers.toList();  // List(1, 3)\n</code></pre>"},{"location":"java/part-4/#94","title":"9.4 \u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0","text":"<pre><code>// repeat \u3067\u7121\u9650\u306b\u7e70\u308a\u8fd4\u3057\nLazyStream&lt;Integer&gt; infinite123s = LazyStream.of(1, 2, 3).repeat();\n\n// take \u3067\u6709\u9650\u500b\u3092\u53d6\u5f97\ninfinite123s.take(8).toList();  // List(1, 2, 3, 1, 2, 3, 1, 2)\n</code></pre>"},{"location":"java/part-4/#95","title":"9.5 \u30b9\u30c8\u30ea\u30fc\u30e0\u306e\u4e3b\u8981\u64cd\u4f5c","text":"\u64cd\u4f5c \u8aac\u660e \u4f8b <code>take(n)</code> \u6700\u521d\u306e n \u8981\u7d20\u3092\u53d6\u5f97 <code>stream.take(3)</code> <code>filter(p)</code> \u6761\u4ef6\u3092\u6e80\u305f\u3059\u8981\u7d20\u306e\u307f <code>stream.filter(x -&gt; x &gt; 0)</code> <code>map(f)</code> \u5404\u8981\u7d20\u3092\u5909\u63db <code>stream.map(x -&gt; x * 2)</code> <code>append(s)</code> \u5225\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u7d50\u5408 <code>stream1.append(stream2)</code> <code>repeat()</code> \u7121\u9650\u306b\u7e70\u308a\u8fd4\u3057 <code>stream.repeat()</code> <code>sliding(n)</code> \u30b9\u30e9\u30a4\u30c7\u30a3\u30f3\u30b0\u30a6\u30a3\u30f3\u30c9\u30a6 <code>stream.sliding(3)</code>"},{"location":"java/part-4/#96","title":"9.6 \u901a\u8ca8\u4ea4\u63db\u30ec\u30fc\u30c8\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch09/CurrencyExchange.java</code></p> <p>\u70ba\u66ff\u30ec\u30fc\u30c8\u3092\u76e3\u8996\u3057\u3066\u3001\u4e0a\u6607\u30c8\u30ec\u30f3\u30c9\u3092\u691c\u51fa\u3059\u308b\u4f8b\u3067\u3059\u3002</p>"},{"location":"java/part-4/#_8","title":"\u30c8\u30ec\u30f3\u30c9\u5224\u5b9a\uff08\u7d14\u7c8b\u95a2\u6570\uff09","text":"<pre><code>public static boolean trending(List&lt;BigDecimal&gt; rates) {\n    if (rates.size() &lt;= 1) {\n        return false;\n    }\n    return rates.zip(rates.drop(1))\n            .forAll(pair -&gt; pair._2().compareTo(pair._1()) &gt; 0);\n}\n\ntrending(List.of(\n    BigDecimal.valueOf(0.81),\n    BigDecimal.valueOf(0.82),\n    BigDecimal.valueOf(0.83)\n));  // true (\u4e0a\u6607\u30c8\u30ec\u30f3\u30c9)\n\ntrending(List.of(\n    BigDecimal.valueOf(0.81),\n    BigDecimal.valueOf(0.84),\n    BigDecimal.valueOf(0.83)\n));  // false\n</code></pre>"},{"location":"java/part-4/#_9","title":"\u30ec\u30fc\u30c8\u306e\u30b9\u30c8\u30ea\u30fc\u30e0","text":"<pre><code>public static LazyStream&lt;IO&lt;Option&lt;BigDecimal&gt;&gt;&gt; ratesStream(\n        Currency from,\n        Currency to) {\n    return LazyStream.continually(() -&gt; rate(from, to));\n}\n</code></pre>"},{"location":"java/part-4/#97","title":"9.7 \u30b9\u30e9\u30a4\u30c7\u30a3\u30f3\u30b0\u30a6\u30a3\u30f3\u30c9\u30a6","text":"<p><code>sliding</code> \u3067\u9023\u7d9a\u3059\u308b\u8981\u7d20\u3092\u30b0\u30eb\u30fc\u30d7\u5316\u3067\u304d\u307e\u3059\u3002</p> <pre><code>LazyStream&lt;Integer&gt; stream = LazyStream.of(1, 2, 3, 4, 5);\n\nstream.sliding(3).toList().map(Queue::toList);\n// List(List(1, 2, 3), List(2, 3, 4), List(3, 4, 5))\n</code></pre> <p></p>"},{"location":"java/part-4/#_10","title":"\u30c8\u30ec\u30f3\u30c9\u3092\u691c\u51fa","text":"<pre><code>public static Option&lt;BigDecimal&gt; findTrendInRates(\n        List&lt;BigDecimal&gt; rates,\n        int windowSize) {\n\n    LazyStream&lt;Queue&lt;BigDecimal&gt;&gt; windows = LazyStream.fromList(rates)\n            .sliding(windowSize);\n\n    for (Queue&lt;BigDecimal&gt; window : windows) {\n        List&lt;BigDecimal&gt; windowList = window.toList();\n        if (trending(windowList)) {\n            return Option.some(windowList.last());\n        }\n    }\n    return Option.none();\n}\n</code></pre>"},{"location":"java/part-4/#_11","title":"\u307e\u3068\u3081","text":""},{"location":"java/part-4/#part-iv","title":"Part IV \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"java/part-4/#io-lazystream","title":"IO \u3068 LazyStream \u306e\u6bd4\u8f03","text":"\u7279\u6027 IO LazyStream \u8981\u7d20\u6570 1\u3064 0\u500b\u4ee5\u4e0a\uff08\u7121\u9650\u3082\u53ef\uff09 \u5b9f\u884c <code>unsafeRun()</code> <code>toList()</code> \u7528\u9014 \u5358\u4e00\u306e\u526f\u4f5c\u7528 \u9023\u7d9a\u3057\u305f\u30c7\u30fc\u30bf\u51e6\u7406"},{"location":"java/part-4/#_12","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>IO \u30e2\u30ca\u30c9: \u526f\u4f5c\u7528\u3092\u300c\u8a18\u8ff0\u300d\u3068\u3057\u3066\u6271\u3044\u3001\u5b9f\u884c\u3092\u9045\u5ef6\u3055\u305b\u308b</li> <li>IO.delay: \u526f\u4f5c\u7528\u306e\u3042\u308b\u5f0f\u3092 IO \u306b\u30e9\u30c3\u30d7</li> <li>orElse: \u5931\u6557\u6642\u306e\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u3092\u6307\u5b9a</li> <li>sequence: <code>List&lt;IO&lt;A&gt;&gt;</code> \u2192 <code>IO&lt;List&lt;A&gt;&gt;</code></li> <li>LazyStream: \u6f5c\u5728\u7684\u306b\u7121\u9650\u306e\u30b7\u30fc\u30b1\u30f3\u30b9\u3092\u9045\u5ef6\u8a55\u4fa1\u3067\u51e6\u7406</li> <li>sliding: \u9023\u7d9a\u3059\u308b\u8981\u7d20\u3092\u30b0\u30eb\u30fc\u30d7\u5316\u3057\u3066\u30d1\u30bf\u30fc\u30f3\u3092\u691c\u51fa</li> </ol>"},{"location":"java/part-4/#scala","title":"Scala \u3068\u306e\u6bd4\u8f03","text":"\u6982\u5ff5 Scala (cats-effect/fs2) Java + Vavr IO \u578b <code>cats.effect.IO[A]</code> <code>IO&lt;A&gt;</code> (\u72ec\u81ea\u5b9f\u88c5) \u9045\u5ef6\u5b9f\u884c <code>IO.delay(expr)</code> <code>IO.delay(() -&gt; expr)</code> \u5373\u5ea7\u306e\u5024 <code>IO.pure(value)</code> <code>IO.pure(value)</code> \u5b9f\u884c <code>unsafeRunSync()</code> <code>unsafeRun()</code> \u30b9\u30c8\u30ea\u30fc\u30e0 <code>fs2.Stream[F, A]</code> <code>LazyStream&lt;A&gt;</code> (\u72ec\u81ea\u5b9f\u88c5) \u7121\u9650\u7e70\u308a\u8fd4\u3057 <code>stream.repeat</code> <code>stream.repeat()</code>"},{"location":"java/part-4/#_13","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part V \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3076\u4e88\u5b9a\u3067\u3059:</p> <ul> <li>\u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406</li> <li>\u5171\u6709\u72b6\u614b\u7ba1\u7406</li> </ul>"},{"location":"java/part-4/#_14","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"java/part-4/#1-io","title":"\u554f\u984c 1: IO \u306e\u57fa\u672c","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>public static IO&lt;String&gt; printAndReturn(String message) {\n    // \"message\" \u3092\u30b3\u30f3\u30bd\u30fc\u30eb\u306b\u51fa\u529b\u3057\u3001\"message\" \u3092\u8fd4\u3059 IO\n}\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\n// printAndReturn(\"Hello\").unsafeRun() \u306f\n// \"Hello\" \u3092\u30b3\u30f3\u30bd\u30fc\u30eb\u306b\u51fa\u529b\u3057\u3001\"Hello\" \u3092\u8fd4\u3059\n</code></pre> \u89e3\u7b54 <pre><code>public static IO&lt;String&gt; printAndReturn(String message) {\n    return IO.delay(() -&gt; {\n        System.out.println(message);\n        return message;\n    });\n}\n</code></pre>"},{"location":"java/part-4/#2-io","title":"\u554f\u984c 2: IO \u306e\u5408\u6210","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u30022\u3064\u306e IO \u3092\u9806\u756a\u306b\u5b9f\u884c\u3057\u3001\u7d50\u679c\u3092\u7d50\u5408\u3057\u307e\u3059\u3002</p> <pre><code>public static &lt;A, B, C&gt; IO&lt;C&gt; combineIO(\n        IO&lt;A&gt; io1,\n        IO&lt;B&gt; io2,\n        BiFunction&lt;A, B, C&gt; f) {\n    // ???\n}\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nIO&lt;Integer&gt; result = combineIO(IO.pure(1), IO.pure(2), Integer::sum);\nresult.unsafeRun();  // 3\n</code></pre> \u89e3\u7b54 <pre><code>public static &lt;A, B, C&gt; IO&lt;C&gt; combineIO(\n        IO&lt;A&gt; io1,\n        IO&lt;B&gt; io2,\n        BiFunction&lt;A, B, C&gt; f) {\n    return io1.flatMap(a -&gt; io2.map(b -&gt; f.apply(a, b)));\n}\n</code></pre>"},{"location":"java/part-4/#3","title":"\u554f\u984c 3: \u30ea\u30c8\u30e9\u30a4","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u6307\u5b9a\u56de\u6570\u30ea\u30c8\u30e9\u30a4\u3057\u3001\u5168\u90e8\u5931\u6557\u3057\u305f\u3089\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>public IO&lt;A&gt; retryWithDefault(int maxRetries, A defaultValue) {\n    // ???\n}\n</code></pre> \u89e3\u7b54 <pre><code>public IO&lt;A&gt; retryWithDefault(int maxRetries, A defaultValue) {\n    return retry(maxRetries).orElse(defaultValue);\n}\n</code></pre>"},{"location":"java/part-4/#4","title":"\u554f\u984c 4: \u30b9\u30c8\u30ea\u30fc\u30e0\u64cd\u4f5c","text":"<p>\u4ee5\u4e0b\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u4f5c\u6210\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>// 1. 1\u304b\u308910\u307e\u3067\u306e\u5076\u6570\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\nLazyStream&lt;Integer&gt; evens = ???\n\n// 2. \u7121\u9650\u306b\u4ea4\u4e92\u306b true/false \u3092\u8fd4\u3059\u30b9\u30c8\u30ea\u30fc\u30e0\nLazyStream&lt;Boolean&gt; alternating = ???\n\n// 3. \u6700\u521d\u306e5\u3064\u306e\u8981\u7d20\u306e\u5408\u8a08\u3092\u8a08\u7b97\nint sum = LazyStream.of(1, 2, 3, 4, 5, 6, 7, 8, 9, 10).take(5).???\n</code></pre> \u89e3\u7b54 <pre><code>// 1. 1\u304b\u308910\u307e\u3067\u306e\u5076\u6570\nLazyStream&lt;Integer&gt; evens = LazyStream.range(1, 11).filter(x -&gt; x % 2 == 0);\n// \u307e\u305f\u306f\nLazyStream&lt;Integer&gt; evens = LazyStream.of(2, 4, 6, 8, 10);\n\n// 2. \u7121\u9650\u306b\u4ea4\u4e92\u306b true/false\nLazyStream&lt;Boolean&gt; alternating = LazyStream.of(true, false).repeat();\n\n// 3. \u6700\u521d\u306e5\u3064\u306e\u8981\u7d20\u306e\u5408\u8a08\nint sum = LazyStream.of(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)\n    .take(5)\n    .foldLeft(0, Integer::sum);  // 15\n</code></pre>"},{"location":"java/part-4/#5","title":"\u554f\u984c 5: \u30c8\u30ec\u30f3\u30c9\u691c\u51fa","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u76f4\u8fd13\u3064\u306e\u5024\u304c\u5168\u3066\u540c\u3058\u304b\u3069\u3046\u304b\u3092\u5224\u5b9a\u3057\u307e\u3059\u3002</p> <pre><code>public static boolean isStable(List&lt;BigDecimal&gt; values) {\n    // ???\n}\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert isStable(List.of(bd(5), bd(5), bd(5))) == true;\nassert isStable(List.of(bd(5), bd(5), bd(6))) == false;\nassert isStable(List.of(bd(5), bd(6), bd(5))) == false;\nassert isStable(List.of(bd(5))) == false;  // 3\u3064\u672a\u6e80\u306f false\n</code></pre> \u89e3\u7b54 <pre><code>public static boolean isStable(List&lt;BigDecimal&gt; values) {\n    return values.size() &gt;= 3 &amp;&amp; values.distinct().size() == 1;\n}\n</code></pre>"},{"location":"java/part-5/","title":"Part V: \u4e26\u884c\u51e6\u7406","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u4e26\u884c\u51e6\u7406\u3092\u5b66\u3073\u307e\u3059\u3002Ref \u306b\u3088\u308b\u5b89\u5168\u306a\u5171\u6709\u72b6\u614b\u7ba1\u7406\u3001Fiber \u306b\u3088\u308b\u8efd\u91cf\u30b9\u30ec\u30c3\u30c9\u3001\u305d\u3057\u3066\u4e26\u5217 IO \u64cd\u4f5c\u306e\u69cb\u7bc9\u65b9\u6cd5\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"java/part-5/#10","title":"\u7b2c10\u7ae0: \u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406","text":""},{"location":"java/part-5/#101","title":"10.1 \u4e26\u884c\u51e6\u7406\u306e\u8ab2\u984c","text":"<p>\u5f93\u6765\u306e\u4e26\u884c\u51e6\u7406\u306b\u306f\u591a\u304f\u306e\u8ab2\u984c\u304c\u3042\u308a\u307e\u3059:</p> <ul> <li>\u30c7\u30c3\u30c9\u30ed\u30c3\u30af</li> <li>\u7af6\u5408\u72b6\u614b\uff08Race Condition\uff09</li> <li>\u5171\u6709\u72b6\u614b\u306e\u7ba1\u7406\u306e\u8907\u96d1\u3055</li> <li>\u30b9\u30ec\u30c3\u30c9\u306e\u30aa\u30fc\u30d0\u30fc\u30d8\u30c3\u30c9</li> </ul> <p></p>"},{"location":"java/part-5/#102","title":"10.2 \u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u306e\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u96c6\u8a08","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch10/CheckIns.java</code></p> <p>\u90fd\u5e02\u3078\u306e\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u3092\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u3067\u96c6\u8a08\u3057\u3001\u30e9\u30f3\u30ad\u30f3\u30b0\u3092\u66f4\u65b0\u3059\u308b\u4f8b\u3092\u898b\u3066\u3044\u304d\u307e\u3059\u3002</p> <pre><code>public record City(String name) {}\npublic record CityStats(City city, int checkIns) {}\n\n// \u30b5\u30f3\u30d7\u30eb\u306e\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u30c7\u30fc\u30bf\u3092\u751f\u6210\npublic static List&lt;City&gt; sampleCheckIns(int repeatCount) {\n    List&lt;City&gt; cities = List.of(\n            new City(\"Sydney\"),\n            new City(\"Dublin\"),\n            new City(\"Cape Town\"),\n            new City(\"Lima\"),\n            new City(\"Singapore\")\n    );\n\n    return List.range(0, repeatCount)\n            .flatMap(i -&gt; cities);\n}\n</code></pre>"},{"location":"java/part-5/#n","title":"\u30c8\u30c3\u30d7 N \u90fd\u5e02\u306e\u8a08\u7b97\uff08\u7d14\u7c8b\u95a2\u6570\uff09","text":"<pre><code>public static List&lt;CityStats&gt; topCities(Map&lt;City, Integer&gt; cityCheckIns, int n) {\n    return cityCheckIns.toList()\n            .map(t -&gt; new CityStats(t._1(), t._2()))\n            .sortBy(stats -&gt; -stats.checkIns())  // \u964d\u9806\n            .take(n);\n}\n</code></pre>"},{"location":"java/part-5/#103","title":"10.3 \u9010\u6b21\u51e6\u7406\u306e\u554f\u984c","text":"<p>\u6700\u521d\u306e\u5b9f\u88c5\u306f\u9010\u6b21\u51e6\u7406\u3067\u3001\u30b7\u30f3\u30d7\u30eb\u3067\u3059\u304c\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u306b\u554f\u984c\u304c\u3042\u308a\u307e\u3059\u3002</p> <pre><code>public static IO&lt;List&lt;CityStats&gt;&gt; processCheckInsSequential(List&lt;City&gt; checkIns, int topN) {\n    return IO.delay(() -&gt; {\n        Map&lt;City, Integer&gt; cityCheckIns = checkIns.foldLeft(\n                HashMap.&lt;City, Integer&gt;empty(),\n                CheckIns::updateCheckIns\n        );\n        return topCities(cityCheckIns, topN);\n    });\n}\n\npublic static Map&lt;City, Integer&gt; updateCheckIns(Map&lt;City, Integer&gt; current, City city) {\n    return current.put(city, current.get(city).map(c -&gt; c + 1).getOrElse(1));\n}\n</code></pre> <p></p>"},{"location":"java/part-5/#104-ref-","title":"10.4 Ref - \u30a2\u30c8\u30df\u30c3\u30af\u306a\u5171\u6709\u72b6\u614b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch10/Ref.java</code></p> <p>Ref \u306f\u3001\u8907\u6570\u306e\u4e26\u884c\u51e6\u7406\u304b\u3089\u5b89\u5168\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u30a2\u30c8\u30df\u30c3\u30af\u306a\u53c2\u7167\u3067\u3059\u3002Java \u306e <code>AtomicReference</code> \u3092\u30e9\u30c3\u30d7\u3057\u3001IO \u30e2\u30ca\u30c9\u3068\u7d71\u5408\u3057\u3066\u3044\u307e\u3059\u3002</p> <pre><code>public final class Ref&lt;A&gt; {\n\n    private final AtomicReference&lt;A&gt; value;\n\n    private Ref(A initial) {\n        this.value = new AtomicReference&lt;&gt;(initial);\n    }\n\n    // \u521d\u671f\u5024\u3067 Ref \u3092\u4f5c\u6210\uff08IO \u3067\u30e9\u30c3\u30d7\uff09\n    public static &lt;A&gt; IO&lt;Ref&lt;A&gt;&gt; of(A initial) {\n        return IO.delay(() -&gt; new Ref&lt;&gt;(initial));\n    }\n\n    // \u73fe\u5728\u306e\u5024\u3092\u53d6\u5f97\n    public IO&lt;A&gt; get() {\n        return IO.delay(value::get);\n    }\n\n    // \u5024\u3092\u8a2d\u5b9a\n    public IO&lt;Void&gt; set(A newValue) {\n        return IO.effect(() -&gt; value.set(newValue));\n    }\n\n    // \u30a2\u30c8\u30df\u30c3\u30af\u306b\u5024\u3092\u66f4\u65b0\n    public IO&lt;Void&gt; update(UnaryOperator&lt;A&gt; f) {\n        return IO.effect(() -&gt; value.updateAndGet(f));\n    }\n}\n</code></pre>"},{"location":"java/part-5/#ref","title":"Ref \u306e\u4f7f\u7528\u4f8b","text":"<pre><code>// Ref \u306e\u4f5c\u6210\u3068\u4f7f\u7528\nIO&lt;Integer&gt; program = Ref.of(0)\n        .flatMap(counter -&gt;\n                counter.update(x -&gt; x + 3)    // \u30a2\u30c8\u30df\u30c3\u30af\u306b\u66f4\u65b0\n                        .andThen(counter.get()) // \u73fe\u5728\u306e\u5024\u3092\u53d6\u5f97\n        );\n\nprogram.unsafeRun();  // 3\n</code></pre>"},{"location":"java/part-5/#ref_1","title":"Ref \u306e\u4e3b\u8981\u30e1\u30bd\u30c3\u30c9","text":"\u30e1\u30bd\u30c3\u30c9 \u8aac\u660e \u4f8b <code>Ref.of(initial)</code> \u521d\u671f\u5024\u3067 Ref \u3092\u4f5c\u6210 <code>Ref.of(0)</code> <code>ref.get()</code> \u73fe\u5728\u306e\u5024\u3092\u53d6\u5f97 <code>counter.get()</code> <code>ref.set(value)</code> \u5024\u3092\u8a2d\u5b9a <code>counter.set(10)</code> <code>ref.update(f)</code> \u30a2\u30c8\u30df\u30c3\u30af\u306b\u66f4\u65b0 <code>counter.update(x -&gt; x + 1)</code> <code>ref.modify(f)</code> \u66f4\u65b0\u3057\u3066\u7d50\u679c\u3092\u8fd4\u3059 <code>counter.modify(n -&gt; ModifyResult.of(n + 1, n))</code> <code>ref.getAndUpdate(f)</code> \u53e4\u3044\u5024\u3092\u8fd4\u3057\u3066\u66f4\u65b0 <code>counter.getAndUpdate(x -&gt; x * 2)</code> <code>ref.updateAndGet(f)</code> \u66f4\u65b0\u3057\u3066\u65b0\u3057\u3044\u5024\u3092\u8fd4\u3059 <code>counter.updateAndGet(x -&gt; x * 2)</code>"},{"location":"java/part-5/#modify","title":"modify \u306e\u4f7f\u7528\u4f8b","text":"<p><code>modify</code> \u306f\u5024\u3092\u66f4\u65b0\u3057\u3064\u3064\u3001\u4f55\u304b\u5225\u306e\u5024\u3092\u8fd4\u3057\u305f\u3044\u5834\u5408\u306b\u4fbf\u5229\u3067\u3059\u3002</p> <pre><code>Ref&lt;Integer&gt; ref = Ref.unsafe(10);\nString result = ref.modify(x -&gt;\n        Ref.ModifyResult.of(x + 1, \"was \" + x)\n).unsafeRun();\n\n// result: \"was 10\"\n// ref \u306e\u5024: 11\n</code></pre>"},{"location":"java/part-5/#105-parallelio-","title":"10.5 ParallelIO - \u4e26\u5217\u5b9f\u884c","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch10/ParallelIO.java</code></p> <p><code>IO.sequence</code> \u306f IO \u3092\u9806\u756a\u306b\u5b9f\u884c\u3057\u307e\u3059\u304c\u3001<code>ParallelIO.parSequence</code> \u306f\u4e26\u5217\u306b\u5b9f\u884c\u3057\u307e\u3059\u3002</p> <pre><code>public final class ParallelIO {\n\n    private static final ExecutorService executor =\n        Executors.newVirtualThreadPerTaskExecutor();\n\n    // IO \u306e\u30ea\u30b9\u30c8\u3092\u4e26\u5217\u306b\u5b9f\u884c\n    public static &lt;A&gt; IO&lt;List&lt;A&gt;&gt; parSequence(List&lt;IO&lt;A&gt;&gt; ios) {\n        return IO.delay(() -&gt; {\n            // \u5404 IO \u3092 CompletableFuture \u3068\u3057\u3066\u975e\u540c\u671f\u5b9f\u884c\n            java.util.List&lt;CompletableFuture&lt;A&gt;&gt; futures = ios\n                    .map(io -&gt; CompletableFuture.supplyAsync(io::unsafeRun, executor))\n                    .toJavaList();\n\n            // \u3059\u3079\u3066\u306e\u5b8c\u4e86\u3092\u5f85\u6a5f\n            CompletableFuture.allOf(futures.toArray(new CompletableFuture[0])).join();\n\n            // \u7d50\u679c\u3092\u53ce\u96c6\n            return List.ofAll(futures.stream().map(CompletableFuture::join).toList());\n        });\n    }\n}\n</code></pre> <p></p>"},{"location":"java/part-5/#_1","title":"\u4e26\u5217\u5b9f\u884c\u306e\u52b9\u679c","text":"<pre><code>List&lt;IO&lt;Integer&gt;&gt; ios = List.of(\n        Fiber.sleep(100).andThen(IO.pure(1)),\n        Fiber.sleep(100).andThen(IO.pure(2)),\n        Fiber.sleep(100).andThen(IO.pure(3))\n);\n\nlong start = System.currentTimeMillis();\nParallelIO.parSequence(ios).unsafeRun();\nlong elapsed = System.currentTimeMillis() - start;\n\n// \u4e26\u5217\u306a\u306e\u3067\u7d04100ms\uff08\u9806\u6b21\u306a\u3089\u7d04300ms\uff09\nassertThat(elapsed).isLessThan(200);\n</code></pre>"},{"location":"java/part-5/#partraverse","title":"parTraverse","text":"<p><code>parTraverse</code> \u306f\u3001\u30ea\u30b9\u30c8\u306e\u5404\u8981\u7d20\u306b IO \u3092\u8fd4\u3059\u95a2\u6570\u3092\u9069\u7528\u3057\u3001\u4e26\u5217\u306b\u5b9f\u884c\u3057\u307e\u3059\u3002</p> <pre><code>public static &lt;A, B&gt; IO&lt;List&lt;B&gt;&gt; parTraverse(\n        List&lt;A&gt; list,\n        Function&lt;A, IO&lt;B&gt;&gt; f) {\n    return parSequence(list.map(f));\n}\n\n// \u4f7f\u7528\u4f8b\nList&lt;Integer&gt; numbers = List.of(1, 2, 3, 4, 5);\n\nList&lt;Integer&gt; result = ParallelIO.parTraverse(\n        numbers,\n        n -&gt; IO.pure(n * 2)\n).unsafeRun();  // List(2, 4, 6, 8, 10)\n</code></pre>"},{"location":"java/part-5/#106","title":"10.6 \u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u51e6\u7406\u306e\u4e26\u884c\u7248","text":"<p>Ref \u3068 ParallelIO \u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u3001\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u3092\u4e26\u884c\u51e6\u7406\u3057\u307e\u3059\u3002</p>"},{"location":"java/part-5/#_2","title":"\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u306e\u4fdd\u5b58","text":"<pre><code>public static IO&lt;Void&gt; storeCheckIn(\n        Ref&lt;Map&lt;City, Integer&gt;&gt; storedCheckIns,\n        City city) {\n    return storedCheckIns.update(current -&gt; updateCheckIns(current, city));\n}\n</code></pre>"},{"location":"java/part-5/#_3","title":"\u4e26\u884c\u51e6\u7406\u7248","text":"<pre><code>public static IO&lt;List&lt;CityStats&gt;&gt; processCheckInsConcurrent(\n        List&lt;City&gt; checkIns,\n        int topN) {\n    return Ref.&lt;Map&lt;City, Integer&gt;&gt;of(HashMap.empty())\n            .flatMap(storedCheckIns -&gt;\n                    // \u3059\u3079\u3066\u306e\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u3092\u4e26\u5217\u306b\u51e6\u7406\n                    ParallelIO.parTraverse(checkIns, city -&gt;\n                            storeCheckIn(storedCheckIns, city))\n                            .andThen(storedCheckIns.get())\n                            .map(cityCheckIns -&gt; topCities(cityCheckIns, topN))\n            );\n}\n</code></pre>"},{"location":"java/part-5/#107-partuple-parmap","title":"10.7 parTuple \u3068 parMap","text":"<p>\u8907\u6570\u306e IO \u3092\u4e26\u5217\u306b\u5b9f\u884c\u3057\u3066\u7d50\u679c\u3092\u7d44\u307f\u5408\u308f\u305b\u308b\u4fbf\u5229\u306a\u30e1\u30bd\u30c3\u30c9\u3067\u3059\u3002</p>"},{"location":"java/part-5/#partuple2-partuple3","title":"parTuple2 / parTuple3","text":"<pre><code>// 2\u3064\u306e IO \u3092\u4e26\u5217\u5b9f\u884c\u3057\u3001\u30bf\u30d7\u30eb\u3067\u8fd4\u3059\nTuple2&lt;Integer, String&gt; result = ParallelIO.parTuple2(\n        IO.pure(42),\n        IO.pure(\"hello\")\n).unsafeRun();\n\n// result._1(): 42\n// result._2(): \"hello\"\n\n// 3\u3064\u306e IO \u3082\u540c\u69d8\nvar result3 = ParallelIO.parTuple3(\n        IO.pure(1),\n        IO.pure(\"two\"),\n        IO.pure(3.0)\n).unsafeRun();\n</code></pre>"},{"location":"java/part-5/#parmap2","title":"parMap2","text":"<pre><code>// 2\u3064\u306e IO \u3092\u4e26\u5217\u5b9f\u884c\u3057\u3066\u7d50\u679c\u3092\u7d50\u5408\nIO&lt;Integer&gt; result = ParallelIO.parMap2(\n        IO.pure(10),\n        IO.pure(20),\n        Integer::sum\n);\n\nresult.unsafeRun();  // 30\n</code></pre>"},{"location":"java/part-5/#108-race-timeout","title":"10.8 race \u3068 timeout","text":""},{"location":"java/part-5/#race-","title":"race - \u7af6\u4e89","text":"<p>2\u3064\u306e IO \u3092\u4e26\u5217\u306b\u5b9f\u884c\u3057\u3001\u6700\u521d\u306b\u5b8c\u4e86\u3057\u305f\u65b9\u306e\u7d50\u679c\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>public static &lt;A&gt; IO&lt;A&gt; race(IO&lt;A&gt; io1, IO&lt;A&gt; io2) {\n    return IO.delay(() -&gt; {\n        CompletableFuture&lt;A&gt; f1 = CompletableFuture.supplyAsync(io1::unsafeRun, executor);\n        CompletableFuture&lt;A&gt; f2 = CompletableFuture.supplyAsync(io2::unsafeRun, executor);\n\n        return CompletableFuture.anyOf(f1, f2)\n                .thenApply(result -&gt; {\n                    f1.cancel(true);\n                    f2.cancel(true);\n                    @SuppressWarnings(\"unchecked\")\n                    A typedResult = (A) result;\n                    return typedResult;\n                })\n                .join();\n    });\n}\n\n// \u4f7f\u7528\u4f8b\nIO&lt;String&gt; slow = Fiber.sleep(200).andThen(IO.pure(\"slow\"));\nIO&lt;String&gt; fast = Fiber.sleep(50).andThen(IO.pure(\"fast\"));\n\nString result = ParallelIO.race(slow, fast).unsafeRun();\n// result: \"fast\"\n</code></pre>"},{"location":"java/part-5/#timeout-","title":"timeout - \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8","text":"<pre><code>public static &lt;A&gt; IO&lt;Option&lt;A&gt;&gt; timeout(IO&lt;A&gt; action, long millis) {\n    return IO.delay(() -&gt; {\n        CompletableFuture&lt;A&gt; future =\n            CompletableFuture.supplyAsync(action::unsafeRun, executor);\n\n        try {\n            A result = future.get(millis, TimeUnit.MILLISECONDS);\n            return Option.some(result);\n        } catch (TimeoutException e) {\n            future.cancel(true);\n            return Option.none();\n        } catch (Exception e) {\n            throw new RuntimeException(e);\n        }\n    });\n}\n\n// \u4f7f\u7528\u4f8b\nIO&lt;Integer&gt; fast = Fiber.sleep(50).andThen(IO.pure(42));\nOption&lt;Integer&gt; result1 = ParallelIO.timeout(fast, 200).unsafeRun();\n// result1: Some(42)\n\nIO&lt;Integer&gt; slow = Fiber.sleep(500).andThen(IO.pure(42));\nOption&lt;Integer&gt; result2 = ParallelIO.timeout(slow, 100).unsafeRun();\n// result2: None\n</code></pre>"},{"location":"java/part-5/#109-fiber-","title":"10.9 Fiber - \u8efd\u91cf\u30b9\u30ec\u30c3\u30c9","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch10/Fiber.java</code></p> <p>Fiber \u306f\u3001IO \u306e\u5b9f\u884c\u3092\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u884c\u3046\u8efd\u91cf\u306a\u5b9f\u884c\u5358\u4f4d\u3067\u3059\u3002Java 21 \u306e\u4eee\u60f3\u30b9\u30ec\u30c3\u30c9\uff08Virtual Thread\uff09\u3092\u6d3b\u7528\u3057\u3066\u3044\u307e\u3059\u3002</p> <p></p>"},{"location":"java/part-5/#fiber","title":"Fiber \u306e\u5b9f\u88c5","text":"<pre><code>public final class Fiber&lt;A&gt; {\n\n    private static final ExecutorService executor =\n        Executors.newVirtualThreadPerTaskExecutor();\n\n    private final CompletableFuture&lt;A&gt; future;\n    private final AtomicBoolean cancelled;\n    private final Future&lt;?&gt; task;\n\n    // IO \u3092\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u8d77\u52d5\u3057\u3001Fiber \u3092\u8fd4\u3059\n    public static &lt;A&gt; IO&lt;Fiber&lt;A&gt;&gt; start(IO&lt;A&gt; io) {\n        return IO.delay(() -&gt; {\n            CompletableFuture&lt;A&gt; future = new CompletableFuture&lt;&gt;();\n            AtomicBoolean cancelled = new AtomicBoolean(false);\n\n            Future&lt;?&gt; task = executor.submit(() -&gt; {\n                try {\n                    if (!cancelled.get()) {\n                        A result = io.unsafeRun();\n                        if (!cancelled.get()) {\n                            future.complete(result);\n                        }\n                    }\n                } catch (Exception e) {\n                    if (!cancelled.get()) {\n                        future.completeExceptionally(e);\n                    }\n                }\n            });\n\n            return new Fiber&lt;&gt;(future, cancelled, task);\n        });\n    }\n}\n</code></pre>"},{"location":"java/part-5/#fiber_1","title":"Fiber \u306e\u8d77\u52d5\u3068\u30ad\u30e3\u30f3\u30bb\u30eb","text":"<pre><code>AtomicInteger counter = new AtomicInteger(0);\n\n// \u7121\u9650\u30eb\u30fc\u30d7\u3059\u308b IO \u3092\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u8d77\u52d5\nFiber&lt;Void&gt; fiber = Fiber.startForever(\n        Fiber.sleep(10).andThen(IO.effect(counter::incrementAndGet))\n).unsafeRun();\n\n// \u3057\u3070\u3089\u304f\u5b9f\u884c\nThread.sleep(100);\nint countBefore = counter.get();\nassertThat(countBefore).isGreaterThan(0);\n\n// \u30ad\u30e3\u30f3\u30bb\u30eb\nfiber.cancel().unsafeRun();\nThread.sleep(50);\n\nint countAfter = counter.get();\n// \u30ad\u30e3\u30f3\u30bb\u30eb\u5f8c\u306f\u5897\u52a0\u3057\u306a\u3044\nassertThat(fiber.isCancelled()).isTrue();\n</code></pre>"},{"location":"java/part-5/#fiber_2","title":"Fiber \u306e\u4e3b\u8981\u30e1\u30bd\u30c3\u30c9","text":"\u30e1\u30bd\u30c3\u30c9 \u8aac\u660e \u4f8b <code>Fiber.start(io)</code> IO \u3092\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u8d77\u52d5 <code>Fiber.start(IO.pure(42))</code> <code>Fiber.startForever(io)</code> \u7121\u9650\u30eb\u30fc\u30d7\u3067\u8d77\u52d5 <code>Fiber.startForever(process)</code> <code>fiber.join()</code> \u5b8c\u4e86\u3092\u5f85\u6a5f\u3057\u7d50\u679c\u3092\u53d6\u5f97 <code>fiber.join().unsafeRun()</code> <code>fiber.cancel()</code> Fiber \u3092\u30ad\u30e3\u30f3\u30bb\u30eb <code>fiber.cancel().unsafeRun()</code> <code>fiber.isDone()</code> \u5b8c\u4e86\u3057\u305f\u304b <code>fiber.isDone()</code> <code>fiber.isCancelled()</code> \u30ad\u30e3\u30f3\u30bb\u30eb\u3055\u308c\u305f\u304b <code>fiber.isCancelled()</code> <code>Fiber.sleep(millis)</code> \u6307\u5b9a\u6642\u9593\u30b9\u30ea\u30fc\u30d7 <code>Fiber.sleep(100)</code> <code>Fiber.delay(millis, io)</code> \u9045\u5ef6\u5b9f\u884c <code>Fiber.delay(100, IO.pure(42))</code>"},{"location":"java/part-5/#1010","title":"10.10 \u547c\u3073\u51fa\u3057\u5143\u306b\u5236\u5fa1\u3092\u8fd4\u3059","text":"<p>Fiber \u3092\u4f7f\u3063\u3066\u3001\u547c\u3073\u51fa\u3057\u5143\u306b\u3059\u3050\u5236\u5fa1\u3092\u8fd4\u3057\u3064\u3064\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u51e6\u7406\u3092\u7d9a\u3051\u308b\u8a2d\u8a08\u304c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>public record ProcessingCheckIns(\n        IO&lt;List&lt;CityStats&gt;&gt; currentRanking,  // \u73fe\u5728\u306e\u30e9\u30f3\u30ad\u30f3\u30b0\u3092\u53d6\u5f97\n        IO&lt;Void&gt; stop                         // \u51e6\u7406\u3092\u505c\u6b62\n) {}\n\npublic static IO&lt;ProcessingCheckIns&gt; processCheckInsBackground(\n        List&lt;City&gt; checkIns,\n        int topN,\n        long updateIntervalMillis) {\n\n    return Ref.&lt;Map&lt;City, Integer&gt;&gt;of(HashMap.empty())\n            .flatMap(storedCheckIns -&gt;\n                    Ref.&lt;List&lt;CityStats&gt;&gt;of(List.empty())\n                            .flatMap(storedRanking -&gt; {\n                                // \u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u51e6\u7406\u30d7\u30ed\u30b0\u30e9\u30e0\n                                IO&lt;Void&gt; checkInsProgram = IO.traverse(\n                                        checkIns,\n                                        city -&gt; storeCheckIn(storedCheckIns, city)\n                                ).map(ignored -&gt; null);\n\n                                // \u30e9\u30f3\u30ad\u30f3\u30b0\u66f4\u65b0\u30d7\u30ed\u30b0\u30e9\u30e0\uff08\u5b9a\u671f\u7684\u306b\u5b9f\u884c\uff09\n                                IO&lt;Void&gt; rankingProgram = IO.delay(() -&gt; {\n                                    updateRanking(storedCheckIns, storedRanking, topN)\n                                        .unsafeRun();\n                                    return null;\n                                });\n\n                                // Fiber \u3068\u3057\u3066\u8d77\u52d5\u3057\u3001\u3059\u3050\u306b\u623b\u308b\n                                return Fiber.start(checkInsProgram)\n                                        .flatMap(checkInsFiber -&gt;\n                                                Fiber.startForever(\n                                                        Fiber.sleep(updateIntervalMillis)\n                                                                .andThen(rankingProgram)\n                                                ).map(rankingFiber -&gt;\n                                                        new ProcessingCheckIns(\n                                                                storedRanking.get(),\n                                                                checkInsFiber.cancel()\n                                                                        .andThen(rankingFiber.cancel())\n                                                        )\n                                                )\n                                        );\n                            })\n            );\n}\n</code></pre> <p></p>"},{"location":"java/part-5/#1011-parfold-","title":"10.11 parFold - \u4e26\u5217\u5b9f\u884c\u3057\u3066\u96c6\u7d04","text":"<pre><code>public static &lt;A, B&gt; IO&lt;B&gt; parFold(\n        List&lt;IO&lt;A&gt;&gt; ios,\n        B initial,\n        BiFunction&lt;B, A, B&gt; f) {\n    return parSequence(ios).map(results -&gt; results.foldLeft(initial, f));\n}\n\n// \u4f7f\u7528\u4f8b\nList&lt;IO&lt;Integer&gt;&gt; ios = List.of(\n        IO.pure(1),\n        IO.pure(2),\n        IO.pure(3),\n        IO.pure(4)\n);\n\nInteger sum = ParallelIO.parFold(ios, 0, Integer::sum).unsafeRun();\n// sum: 10\n</code></pre>"},{"location":"java/part-5/#1012-java-21-virtual-thread","title":"10.12 Java 21 Virtual Thread \u306e\u6d3b\u7528","text":"<p>\u3053\u306e\u5b9f\u88c5\u3067\u306f Java 21 \u306e\u4eee\u60f3\u30b9\u30ec\u30c3\u30c9\uff08Virtual Thread\uff09\u3092\u6d3b\u7528\u3057\u3066\u3044\u307e\u3059\u3002</p> <pre><code>private static final ExecutorService executor =\n    Executors.newVirtualThreadPerTaskExecutor();\n</code></pre> <p>\u4eee\u60f3\u30b9\u30ec\u30c3\u30c9\u306e\u5229\u70b9:</p> <ul> <li>\u8efd\u91cf: \u5f93\u6765\u306e\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0\u30b9\u30ec\u30c3\u30c9\u3088\u308a\u9065\u304b\u306b\u8efd\u91cf</li> <li>\u30b9\u30b1\u30fc\u30e9\u30d6\u30eb: \u6570\u767e\u4e07\u306e\u540c\u6642\u5b9f\u884c\u304c\u53ef\u80fd</li> <li>\u30d6\u30ed\u30c3\u30ad\u30f3\u30b0 OK: \u30d6\u30ed\u30c3\u30ad\u30f3\u30b0\u64cd\u4f5c\u3067\u3082\u30b9\u30ec\u30c3\u30c9\u30d7\u30fc\u30eb\u3092\u67af\u6e07\u3055\u305b\u306a\u3044</li> <li>\u65e2\u5b58\u30b3\u30fc\u30c9\u3068\u4e92\u63db: \u65e2\u5b58\u306e Java \u30b3\u30fc\u30c9\u3092\u305d\u306e\u307e\u307e\u4f7f\u7528\u53ef\u80fd</li> </ul>"},{"location":"java/part-5/#_4","title":"\u307e\u3068\u3081","text":""},{"location":"java/part-5/#part-v_1","title":"Part V \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"java/part-5/#_5","title":"\u4e3b\u8981\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8","text":"\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8 \u7528\u9014 <code>Ref&lt;A&gt;</code> \u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u5171\u6709\u72b6\u614b <code>ParallelIO.parSequence</code> IO \u306e\u30ea\u30b9\u30c8\u3092\u4e26\u5217\u5b9f\u884c <code>ParallelIO.parTraverse</code> \u30ea\u30b9\u30c8\u306b\u95a2\u6570\u3092\u9069\u7528\u3057\u3066\u4e26\u5217\u5b9f\u884c <code>ParallelIO.race</code> \u6700\u521d\u306b\u5b8c\u4e86\u3057\u305f\u65b9\u3092\u8fd4\u3059 <code>ParallelIO.timeout</code> \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u4ed8\u304d\u5b9f\u884c <code>Fiber</code> \u8efd\u91cf\u306a\u5b9f\u884c\u5358\u4f4d <code>fiber.start</code> Fiber \u3092\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u8d77\u52d5 <code>fiber.cancel</code> Fiber \u3092\u30ad\u30e3\u30f3\u30bb\u30eb"},{"location":"java/part-5/#_6","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>Ref: <code>AtomicReference</code> \u3092\u30e9\u30c3\u30d7\u3057\u3001IO \u30e2\u30ca\u30c9\u3068\u7d71\u5408\u3057\u305f\u30a2\u30c8\u30df\u30c3\u30af\u306a\u53c2\u7167</li> <li>parSequence: IO \u306e\u30ea\u30b9\u30c8\u3092\u4e26\u5217\u5b9f\u884c\u3057\u3066\u7d50\u679c\u3092\u96c6\u7d04</li> <li>Fiber: Java 21 \u306e\u4eee\u60f3\u30b9\u30ec\u30c3\u30c9\u3092\u6d3b\u7528\u3057\u305f\u8efd\u91cf\u306a\u5b9f\u884c\u5358\u4f4d</li> <li>start: Fiber \u3092\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u8d77\u52d5\u3057\u3001\u3059\u3050\u306b\u5236\u5fa1\u3092\u8fd4\u3059</li> <li>race: 2\u3064\u306e IO \u3092\u7af6\u4e89\u3055\u305b\u3001\u6700\u521d\u306b\u5b8c\u4e86\u3057\u305f\u65b9\u3092\u63a1\u7528</li> <li>timeout: \u6307\u5b9a\u6642\u9593\u5185\u306b\u5b8c\u4e86\u3057\u306a\u3051\u308c\u3070 None \u3092\u8fd4\u3059</li> </ol>"},{"location":"java/part-5/#_7","title":"\u8a2d\u8a08\u30d1\u30bf\u30fc\u30f3","text":""},{"location":"java/part-5/#scala","title":"Scala \u3068\u306e\u6bd4\u8f03","text":"\u6982\u5ff5 Scala (cats-effect) Java + Vavr \u30a2\u30c8\u30df\u30c3\u30af\u53c2\u7167 <code>Ref[IO, A]</code> <code>Ref&lt;A&gt;</code> (\u72ec\u81ea\u5b9f\u88c5) \u4e26\u5217\u5b9f\u884c <code>parSequence</code> <code>ParallelIO.parSequence</code> \u8efd\u91cf\u30b9\u30ec\u30c3\u30c9 <code>Fiber[IO, A]</code> <code>Fiber&lt;A&gt;</code> (Virtual Thread) Fiber \u8d77\u52d5 <code>io.start</code> <code>Fiber.start(io)</code> \u30ad\u30e3\u30f3\u30bb\u30eb <code>fiber.cancel</code> <code>fiber.cancel()</code> \u7af6\u4e89 <code>IO.race(io1, io2)</code> <code>ParallelIO.race(io1, io2)</code> \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8 <code>io.timeout(duration)</code> <code>ParallelIO.timeout(io, millis)</code>"},{"location":"java/part-5/#_8","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"java/part-5/#1-ref","title":"\u554f\u984c 1: Ref \u306e\u57fa\u672c","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u30ab\u30a6\u30f3\u30bf\u30fc\u3092 0 \u304b\u3089\u59cb\u3081\u3066\u30013\u56de\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\u3057\u305f\u7d50\u679c\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>public static IO&lt;Integer&gt; incrementThreeTimes() {\n    // ???\n}\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nincrementThreeTimes().unsafeRun();  // 3\n</code></pre> \u89e3\u7b54 <pre><code>public static IO&lt;Integer&gt; incrementThreeTimes() {\n    return Ref.of(0)\n            .flatMap(counter -&gt;\n                    counter.update(x -&gt; x + 1)\n                            .andThen(counter.update(x -&gt; x + 1))\n                            .andThen(counter.update(x -&gt; x + 1))\n                            .andThen(counter.get())\n            );\n}\n</code></pre>"},{"location":"java/part-5/#2","title":"\u554f\u984c 2: \u4e26\u5217\u5b9f\u884c","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u30023\u3064\u306e IO \u3092\u4e26\u5217\u5b9f\u884c\u3057\u3001\u7d50\u679c\u306e\u5408\u8a08\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>public static IO&lt;Integer&gt; sumParallel(IO&lt;Integer&gt; io1, IO&lt;Integer&gt; io2, IO&lt;Integer&gt; io3) {\n    // ???\n}\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nsumParallel(IO.pure(1), IO.pure(2), IO.pure(3)).unsafeRun();  // 6\n</code></pre> \u89e3\u7b54 <pre><code>public static IO&lt;Integer&gt; sumParallel(IO&lt;Integer&gt; io1, IO&lt;Integer&gt; io2, IO&lt;Integer&gt; io3) {\n    return ParallelIO.parSequence(List.of(io1, io2, io3))\n            .map(list -&gt; list.foldLeft(0, Integer::sum));\n}\n\n// \u307e\u305f\u306f parFold \u3092\u4f7f\u7528\npublic static IO&lt;Integer&gt; sumParallel(IO&lt;Integer&gt; io1, IO&lt;Integer&gt; io2, IO&lt;Integer&gt; io3) {\n    return ParallelIO.parFold(List.of(io1, io2, io3), 0, Integer::sum);\n}\n</code></pre>"},{"location":"java/part-5/#3","title":"\u554f\u984c 3: \u4e26\u884c\u30ab\u30a6\u30f3\u30c8","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002IO \u306e\u30ea\u30b9\u30c8\u3092\u4e26\u884c\u5b9f\u884c\u3057\u3001\u305d\u306e\u3046\u3061\u5076\u6570\u3092\u8fd4\u3057\u305f\u56de\u6570\u3092\u30ab\u30a6\u30f3\u30c8\u3057\u307e\u3059\u3002</p> <pre><code>public static IO&lt;Integer&gt; countEvens(List&lt;IO&lt;Integer&gt;&gt; ios) {\n    // ???\n}\n\n// \u4f7f\u7528\u4f8b\nList&lt;IO&lt;Integer&gt;&gt; ios = List.range(0, 100).map(IO::pure);\ncountEvens(ios).unsafeRun();  // 50\n</code></pre> \u89e3\u7b54 <pre><code>public static IO&lt;Integer&gt; countEvens(List&lt;IO&lt;Integer&gt;&gt; ios) {\n    return Ref.of(0)\n            .flatMap(counter -&gt;\n                    ParallelIO.parTraverse(ios, io -&gt;\n                            io.flatMap(n -&gt;\n                                    n % 2 == 0\n                                            ? counter.update(x -&gt; x + 1)\n                                            : IO.unit()\n                            )\n                    ).andThen(counter.get())\n            );\n}\n</code></pre>"},{"location":"java/part-5/#4","title":"\u554f\u984c 4: \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u4ed8\u304d\u5b9f\u884c","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u6307\u5b9a\u6642\u9593\u5f8c\u306b Fiber \u3092\u30ad\u30e3\u30f3\u30bb\u30eb\u3057\u3001\u305d\u308c\u307e\u3067\u306b\u84c4\u7a4d\u3055\u308c\u305f\u7d50\u679c\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>public static IO&lt;List&lt;Integer&gt;&gt; collectFor(long durationMillis) {\n    // 100ms\u3054\u3068\u306b\u4e71\u6570\u3092\u751f\u6210\u3057\u3066\u30ea\u30b9\u30c8\u306b\u8ffd\u52a0\n    // \u6307\u5b9a\u6642\u9593\u5f8c\u306b\u505c\u6b62\u3057\u3066\u7d50\u679c\u3092\u8fd4\u3059\n    // ???\n}\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\n// 1\u79d2\u9593\u5b9f\u884c\u3059\u308b\u3068\u7d0410\u500b\u306e\u8981\u7d20\u304c\u8fd4\u3055\u308c\u308b\ncollectFor(1000).unsafeRun();\n</code></pre> \u89e3\u7b54 <pre><code>public static IO&lt;List&lt;Integer&gt;&gt; collectFor(long durationMillis) {\n    return Ref.&lt;List&lt;Integer&gt;&gt;of(List.empty())\n            .flatMap(collected -&gt; {\n                Random random = new Random();\n\n                // 100ms\u3054\u3068\u306b\u4e71\u6570\u3092\u8ffd\u52a0\u3059\u308b\u30d7\u30ed\u30b0\u30e9\u30e0\n                IO&lt;Void&gt; producer = Fiber.sleep(100)\n                        .andThen(IO.delay(() -&gt; random.nextInt(100)))\n                        .flatMap(n -&gt; collected.update(list -&gt; list.append(n)));\n\n                return Fiber.startForever(producer)\n                        .flatMap(fiber -&gt;\n                                Fiber.sleep(durationMillis)\n                                        .andThen(fiber.cancel())\n                                        .andThen(collected.get())\n                        );\n            });\n}\n</code></pre>"},{"location":"java/part-5/#5","title":"\u554f\u984c 5: \u4e26\u884c\u30de\u30c3\u30d7\u66f4\u65b0","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u8907\u6570\u306e\u66f4\u65b0\u3092\u4e26\u884c\u3057\u3066 Map \u306b\u9069\u7528\u3057\u3001\u6700\u7d42\u7684\u306a Map \u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>record Update(String key, int value) {}\n\npublic static IO&lt;Map&lt;String, Integer&gt;&gt; applyUpdates(List&lt;Update&gt; updates) {\n    // ???\n}\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nList&lt;Update&gt; updates = List.of(\n    new Update(\"a\", 1),\n    new Update(\"b\", 2),\n    new Update(\"a\", 3),  // \"a\" \u3092\u4e0a\u66f8\u304d\n    new Update(\"c\", 4)\n);\napplyUpdates(updates).unsafeRun();  // HashMap(a -&gt; 3, b -&gt; 2, c -&gt; 4)\n</code></pre> \u89e3\u7b54 <pre><code>record Update(String key, int value) {}\n\npublic static IO&lt;Map&lt;String, Integer&gt;&gt; applyUpdates(List&lt;Update&gt; updates) {\n    return Ref.&lt;Map&lt;String, Integer&gt;&gt;of(HashMap.empty())\n            .flatMap(mapRef -&gt;\n                    ParallelIO.parTraverse(updates, update -&gt;\n                            mapRef.update(m -&gt; m.put(update.key(), update.value()))\n                    ).andThen(mapRef.get())\n            );\n}\n</code></pre>  \u6ce8\u610f: \u4e26\u884c\u5b9f\u884c\u306a\u306e\u3067\u3001\u540c\u3058\u30ad\u30fc\u3078\u306e\u8907\u6570\u306e\u66f4\u65b0\u304c\u3042\u308b\u5834\u5408\u3001\u6700\u7d42\u7684\u306a\u5024\u306f\u5b9f\u884c\u9806\u5e8f\u306b\u4f9d\u5b58\u3057\u307e\u3059\u3002"},{"location":"java/part-6/","title":"Part VI: \u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u3068\u30c6\u30b9\u30c8","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u3053\u308c\u307e\u3067\u5b66\u3093\u3060\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u6982\u5ff5\u3092\u7d71\u5408\u3057\u3001\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002\u307e\u305f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u30c6\u30b9\u30c8\u6226\u7565\u306b\u3064\u3044\u3066\u3082\u5b66\u3073\u307e\u3059\u3002</p>"},{"location":"java/part-6/#11","title":"\u7b2c11\u7ae0: \u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9","text":""},{"location":"java/part-6/#111-travelguide","title":"11.1 TravelGuide \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3","text":"<p>\u65c5\u884c\u30ac\u30a4\u30c9\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f8b\u306b\u3001\u5b9f\u8df5\u7684\u306a FP \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u69cb\u7bc9\u65b9\u6cd5\u3092\u5b66\u3073\u307e\u3059\u3002</p> <p></p>"},{"location":"java/part-6/#112","title":"11.2 \u30c9\u30e1\u30a4\u30f3\u30e2\u30c7\u30eb\u306e\u5b9a\u7fa9","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch11/TravelGuide.java</code></p> <pre><code>// \u4f4d\u7f6e\u60c5\u5831\u3092\u8868\u3059\u5024\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\npublic record LocationId(String value) {\n    public LocationId {\n        Objects.requireNonNull(value, \"LocationId value cannot be null\");\n    }\n}\n\n// \u30ed\u30b1\u30fc\u30b7\u30e7\u30f3\npublic record Location(LocationId id, String name, int population) {\n    public Location {\n        Objects.requireNonNull(id, \"Location id cannot be null\");\n        Objects.requireNonNull(name, \"Location name cannot be null\");\n    }\n}\n\n// \u30a2\u30c8\u30e9\u30af\u30b7\u30e7\u30f3\uff08\u89b3\u5149\u5730\uff09\npublic record Attraction(\n        String name,\n        Option&lt;String&gt; description,\n        Location location\n) {\n    public Attraction {\n        Objects.requireNonNull(name, \"Attraction name cannot be null\");\n        Objects.requireNonNull(description, \"Attraction description cannot be null\");\n        Objects.requireNonNull(location, \"Attraction location cannot be null\");\n    }\n}\n\n// \u30dd\u30c3\u30d7\u30ab\u30eb\u30c1\u30e3\u30fc\u306e\u984c\u6750\uff08sealed interface\uff09\npublic sealed interface PopCultureSubject permits Artist, Movie {\n    String name();\n}\n\n// \u30a2\u30fc\u30c6\u30a3\u30b9\u30c8\npublic record Artist(String name, int followers) implements PopCultureSubject {\n    public Artist {\n        Objects.requireNonNull(name, \"Artist name cannot be null\");\n    }\n}\n\n// \u6620\u753b\npublic record Movie(String name, int boxOffice) implements PopCultureSubject {\n    public Movie {\n        Objects.requireNonNull(name, \"Movie name cannot be null\");\n    }\n}\n\n// \u65c5\u884c\u30ac\u30a4\u30c9\npublic record Guide(\n        Attraction attraction,\n        List&lt;PopCultureSubject&gt; subjects\n) {\n    public Guide {\n        Objects.requireNonNull(attraction, \"Guide attraction cannot be null\");\n        Objects.requireNonNull(subjects, \"Guide subjects cannot be null\");\n    }\n}\n</code></pre> <p>Java 17 \u306e <code>record</code> \u3068 <code>sealed interface</code> \u3092\u6d3b\u7528\u3057\u3066\u3001Scala \u306e case class \u3068 ADT \u3092\u8868\u73fe\u3057\u3066\u3044\u307e\u3059\u3002</p>"},{"location":"java/part-6/#113","title":"11.3 \u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\u5c64\u306e\u62bd\u8c61\u5316","text":"<p>\u5916\u90e8\u30c7\u30fc\u30bf\u30bd\u30fc\u30b9\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3067\u62bd\u8c61\u5316\u3057\u307e\u3059\u3002</p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch11/DataAccess.java</code></p> <pre><code>public interface DataAccess {\n    IO&lt;List&lt;Attraction&gt;&gt; findAttractions(\n            String name,\n            AttractionOrdering ordering,\n            int limit\n    );\n\n    IO&lt;List&lt;Artist&gt;&gt; findArtistsFromLocation(\n            LocationId locationId,\n            int limit\n    );\n\n    IO&lt;List&lt;Movie&gt;&gt; findMoviesAboutLocation(\n            LocationId locationId,\n            int limit\n    );\n}\n</code></pre> <p></p>"},{"location":"java/part-6/#114-resource","title":"11.4 Resource \u306b\u3088\u308b\u30ea\u30bd\u30fc\u30b9\u7ba1\u7406","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch11/Resource.java</code></p> <p><code>Resource</code> \u306f\u3001\u30ea\u30bd\u30fc\u30b9\u306e\u53d6\u5f97\uff08acquire\uff09\u3068\u89e3\u653e\uff08release\uff09\u3092\u5b89\u5168\u306b\u7ba1\u7406\u3059\u308b\u305f\u3081\u306e\u578b\u3067\u3059\u3002cats-effect \u306e <code>Resource</code> \u306b\u76f8\u5f53\u3059\u308b\u6a5f\u80fd\u3092\u63d0\u4f9b\u3057\u307e\u3059\u3002</p> <pre><code>public final class Resource&lt;A&gt; {\n\n    private final IO&lt;A&gt; acquire;\n    private final Consumer&lt;A&gt; release;\n\n    private Resource(IO&lt;A&gt; acquire, Consumer&lt;A&gt; release) {\n        this.acquire = acquire;\n        this.release = release;\n    }\n\n    // \u30ea\u30bd\u30fc\u30b9\u3092\u4f5c\u6210\n    public static &lt;A&gt; Resource&lt;A&gt; make(IO&lt;A&gt; acquire, Consumer&lt;A&gt; release) {\n        return new Resource&lt;&gt;(acquire, release);\n    }\n\n    // AutoCloseable \u304b\u3089\u30ea\u30bd\u30fc\u30b9\u3092\u4f5c\u6210\n    public static &lt;A extends AutoCloseable&gt; Resource&lt;A&gt; fromAutoCloseable(IO&lt;A&gt; acquire) {\n        return new Resource&lt;&gt;(acquire, a -&gt; {\n            try {\n                a.close();\n            } catch (Exception e) {\n                throw new RuntimeException(\"Failed to close resource\", e);\n            }\n        });\n    }\n\n    // \u30ea\u30bd\u30fc\u30b9\u3092\u4f7f\u7528\u3057\u3066\u51e6\u7406\u3092\u5b9f\u884c\n    // \u30ea\u30bd\u30fc\u30b9\u306f\u51e6\u7406\u5b8c\u4e86\u5f8c\uff08\u6210\u529f\u30fb\u5931\u6557\u554f\u308f\u305a\uff09\u306b\u5fc5\u305a\u89e3\u653e\u3055\u308c\u308b\n    public &lt;B&gt; IO&lt;B&gt; use(Function&lt;A, IO&lt;B&gt;&gt; f) {\n        return acquire.flatMap(resource -&gt;\n                f.apply(resource)\n                        .guarantee(IO.effect(() -&gt; release.accept(resource)))\n        );\n    }\n}\n</code></pre>"},{"location":"java/part-6/#resource","title":"Resource \u306e\u4f7f\u7528\u4f8b","text":"<pre><code>// \u30d5\u30a1\u30a4\u30eb\u30ea\u30bd\u30fc\u30b9\u306e\u4f8b\nResource&lt;BufferedReader&gt; fileResource = Resource.fromAutoCloseable(\n        IO.delay(() -&gt; new BufferedReader(new FileReader(\"data.txt\")))\n);\n\n// \u30ea\u30bd\u30fc\u30b9\u3092\u4f7f\u7528\u3057\u3066\u51e6\u7406\u3092\u5b9f\u884c\nIO&lt;String&gt; readFirstLine = fileResource.use(reader -&gt;\n        IO.delay(reader::readLine)\n);\n\n// \u30d5\u30a1\u30a4\u30eb\u306f\u81ea\u52d5\u7684\u306b\u30af\u30ed\u30fc\u30ba\u3055\u308c\u308b\nString firstLine = readFirstLine.unsafeRun();\n</code></pre>"},{"location":"java/part-6/#guarantee","title":"guarantee \u30e1\u30bd\u30c3\u30c9","text":"<p><code>IO</code> \u30af\u30e9\u30b9\u306b\u8ffd\u52a0\u3057\u305f <code>guarantee</code> \u30e1\u30bd\u30c3\u30c9\u306f\u3001\u6210\u529f\u30fb\u5931\u6557\u306b\u304b\u304b\u308f\u3089\u305a\u5fc5\u305a\u5b9f\u884c\u3055\u308c\u308b\u51e6\u7406\u3092\u6307\u5b9a\u3057\u307e\u3059\u3002</p> <pre><code>// IO \u30af\u30e9\u30b9\u306e guarantee \u30e1\u30bd\u30c3\u30c9\npublic IO&lt;A&gt; guarantee(IO&lt;Void&gt; finalizer) {\n    return new IO&lt;&gt;(() -&gt; {\n        try {\n            return thunk.get();\n        } finally {\n            try {\n                finalizer.unsafeRun();\n            } catch (Exception ignored) {\n                // finalizer \u306e\u30a8\u30e9\u30fc\u306f\u7121\u8996\n            }\n        }\n    });\n}\n</code></pre>"},{"location":"java/part-6/#115","title":"11.5 \u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u5b9f\u88c5","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch11/CachedDataAccess.java</code></p> <p><code>Ref</code> \u3092\u4f7f\u7528\u3057\u305f\u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u5b9f\u88c5:</p> <pre><code>public final class CachedDataAccess implements DataAccess {\n\n    private final DataAccess underlying;\n    private final Ref&lt;Map&lt;String, Object&gt;&gt; cache;\n\n    private CachedDataAccess(DataAccess underlying, Ref&lt;Map&lt;String, Object&gt;&gt; cache) {\n        this.underlying = underlying;\n        this.cache = cache;\n    }\n\n    // IO \u7d4c\u7531\u3067\u30ad\u30e3\u30c3\u30b7\u30e5\u4ed8\u304d DataAccess \u3092\u4f5c\u6210\n    public static IO&lt;DataAccess&gt; create(DataAccess underlying) {\n        return Ref.&lt;Map&lt;String, Object&gt;&gt;of(HashMap.empty())\n                .map(cache -&gt; new CachedDataAccess(underlying, cache));\n    }\n\n    @Override\n    public IO&lt;List&lt;Attraction&gt;&gt; findAttractions(\n            String name,\n            AttractionOrdering ordering,\n            int limit) {\n        String key = \"attractions:\" + name + \":\" + ordering + \":\" + limit;\n        return getOrCompute(key, () -&gt; underlying.findAttractions(name, ordering, limit));\n    }\n\n    @SuppressWarnings(\"unchecked\")\n    private &lt;T&gt; IO&lt;T&gt; getOrCompute(String key, Supplier&lt;IO&lt;T&gt;&gt; compute) {\n        return cache.get()\n                .flatMap(currentCache -&gt;\n                        currentCache.get(key)\n                                .map(cached -&gt; IO.pure((T) cached))\n                                .getOrElse(() -&gt;\n                                        compute.get().flatMap(result -&gt;\n                                                cache.update(c -&gt; c.put(key, result))\n                                                        .andThen(IO.pure(result))\n                                        )\n                                )\n                );\n    }\n\n    // ... \u4ed6\u306e\u30e1\u30bd\u30c3\u30c9\u3082\u540c\u69d8\n}\n</code></pre> <p></p>"},{"location":"java/part-6/#116","title":"11.6 \u30ac\u30a4\u30c9\u30b9\u30b3\u30a2\u306e\u8a08\u7b97","text":"<p>\u7d14\u7c8b\u95a2\u6570\u3067\u30ac\u30a4\u30c9\u306e\u30b9\u30b3\u30a2\u3092\u8a08\u7b97\u3057\u307e\u3059:</p> <pre><code>/**\n * \u30ac\u30a4\u30c9\u306e\u30b9\u30b3\u30a2\u3092\u8a08\u7b97\n *\n * \u8981\u4ef6:\n * - 30 \u70b9: \u8aac\u660e\u304c\u3042\u308b\u5834\u5408\n * - 10 \u70b9/\u4ef6: \u30a2\u30fc\u30c6\u30a3\u30b9\u30c8\u307e\u305f\u306f\u6620\u753b\uff08\u6700\u5927 40 \u70b9\uff09\n * - 1 \u70b9/100,000 \u30d5\u30a9\u30ed\u30ef\u30fc: \u5168\u30a2\u30fc\u30c6\u30a3\u30b9\u30c8\u5408\u8a08\uff08\u6700\u5927 15 \u70b9\uff09\n * - 1 \u70b9/10,000,000 \u30c9\u30eb: \u5168\u6620\u753b\u306e\u8208\u884c\u53ce\u5165\u5408\u8a08\uff08\u6700\u5927 15 \u70b9\uff09\n */\npublic static int guideScore(Guide guide) {\n    int descriptionScore = guide.attraction().description().isDefined() ? 30 : 0;\n    int quantityScore = Math.min(40, guide.subjects().size() * 10);\n\n    // Long \u3092\u4f7f\u7528\u3057\u3066\u30aa\u30fc\u30d0\u30fc\u30d5\u30ed\u30fc\u3092\u9632\u3050\n    long totalFollowers = guide.subjects()\n            .filter(s -&gt; s instanceof Artist)\n            .map(s -&gt; (long) ((Artist) s).followers())\n            .sum().longValue();\n\n    long totalBoxOffice = guide.subjects()\n            .filter(s -&gt; s instanceof Movie)\n            .map(s -&gt; (long) ((Movie) s).boxOffice())\n            .sum().longValue();\n\n    int followersScore = (int) Math.min(15, totalFollowers / 100_000);\n    int boxOfficeScore = (int) Math.min(15, totalBoxOffice / 10_000_000);\n\n    return descriptionScore + quantityScore + followersScore + boxOfficeScore;\n}\n</code></pre> <p>\u91cd\u8981\u306a\u30dd\u30a4\u30f3\u30c8: - \u30aa\u30fc\u30d0\u30fc\u30d5\u30ed\u30fc\u9632\u6b62: <code>long</code> \u3092\u4f7f\u7528\u3057\u3066\u5927\u304d\u306a\u6570\u5024\u306e\u5408\u8a08\u3092\u5b89\u5168\u306b\u8a08\u7b97 - \u4e0a\u9650\u5024\u306e\u8a2d\u5b9a: \u5404\u30b9\u30b3\u30a2\u6210\u5206\u306b\u6700\u5927\u5024\u3092\u8a2d\u5b9a\u3057\u3066\u30b9\u30b3\u30a2\u3092 0-100 \u306e\u7bc4\u56f2\u306b</p>"},{"location":"java/part-6/#117","title":"11.7 \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u7d44\u307f\u7acb\u3066","text":"<p>\u3059\u3079\u3066\u306e\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002</p>"},{"location":"java/part-6/#1","title":"\u30d0\u30fc\u30b8\u30e7\u30f3 1: \u57fa\u672c\u7684\u306a\u5b9f\u88c5","text":"<pre><code>public static IO&lt;Option&lt;Guide&gt;&gt; travelGuideV1(\n        DataAccess dataAccess,\n        String attractionName) {\n\n    return dataAccess.findAttractions(attractionName, AttractionOrdering.BY_LOCATION_POPULATION, 1)\n            .flatMap(attractions -&gt; attractions.headOption()\n                    .map(attraction -&gt;\n                            dataAccess.findArtistsFromLocation(attraction.location().id(), 2)\n                                    .flatMap(artists -&gt;\n                                            dataAccess.findMoviesAboutLocation(attraction.location().id(), 2)\n                                                    .map(movies -&gt; {\n                                                        List&lt;PopCultureSubject&gt; subjects = List.&lt;PopCultureSubject&gt;empty()\n                                                                .appendAll(artists)\n                                                                .appendAll(movies);\n                                                        return Option.some(new Guide(attraction, subjects));\n                                                    })\n                                    )\n                    )\n                    .getOrElse(IO.pure(Option.none()))\n            );\n}\n</code></pre>"},{"location":"java/part-6/#2","title":"\u30d0\u30fc\u30b8\u30e7\u30f3 2: \u8907\u6570\u5019\u88dc\u304b\u3089\u30d9\u30b9\u30c8\u3092\u9078\u629e","text":"<pre><code>public static IO&lt;Option&lt;Guide&gt;&gt; travelGuideV2(\n        DataAccess dataAccess,\n        String attractionName) {\n\n    return dataAccess.findAttractions(attractionName, AttractionOrdering.BY_LOCATION_POPULATION, 3)\n            .flatMap(attractions -&gt;\n                    IO.traverse(attractions, attraction -&gt;\n                            dataAccess.findArtistsFromLocation(attraction.location().id(), 2)\n                                    .flatMap(artists -&gt;\n                                            dataAccess.findMoviesAboutLocation(attraction.location().id(), 2)\n                                                    .map(movies -&gt; {\n                                                        List&lt;PopCultureSubject&gt; subjects = List.&lt;PopCultureSubject&gt;empty()\n                                                                .appendAll(artists)\n                                                                .appendAll(movies);\n                                                        return new Guide(attraction, subjects);\n                                                    })\n                                    )\n                    ).map(TravelGuide::findBestGuide)\n            );\n}\n</code></pre>"},{"location":"java/part-6/#3","title":"\u30d0\u30fc\u30b8\u30e7\u30f3 3: \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u4ed8\u304d","text":"<pre><code>public static IO&lt;Either&lt;SearchReport, Guide&gt;&gt; travelGuideV3(\n        DataAccess dataAccess,\n        String attractionName) {\n\n    return dataAccess.findAttractions(attractionName, AttractionOrdering.BY_LOCATION_POPULATION, 3)\n            .attempt()\n            .flatMap(attractionsResult -&gt;\n                    attractionsResult.fold(\n                            error -&gt; IO.pure(Either.left(\n                                    SearchReport.withProblems(List.of(error.getMessage())))),\n                            attractions -&gt;\n                                    IO.traverse(attractions, attraction -&gt;\n                                                    guideForAttraction(dataAccess, attraction).attempt()\n                                            )\n                                            .map(TravelGuide::processGuideResults)\n                    )\n            );\n}\n</code></pre>"},{"location":"java/part-6/#118-attempt","title":"11.8 attempt \u30e1\u30bd\u30c3\u30c9\u306b\u3088\u308b\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":"<p><code>IO</code> \u30af\u30e9\u30b9\u306b\u8ffd\u52a0\u3057\u305f <code>attempt</code> \u30e1\u30bd\u30c3\u30c9\u306f\u3001\u4f8b\u5916\u3092 <code>Either</code> \u306b\u5909\u63db\u3057\u307e\u3059:</p> <pre><code>// IO \u30af\u30e9\u30b9\u306e attempt \u30e1\u30bd\u30c3\u30c9\npublic IO&lt;Either&lt;Throwable, A&gt;&gt; attempt() {\n    return new IO&lt;&gt;(() -&gt; {\n        try {\n            return Either.right(thunk.get());\n        } catch (Throwable e) {\n            return Either.left(e);\n        }\n    });\n}\n</code></pre> <p>\u3053\u308c\u306b\u3088\u308a\u3001\u4f8b\u5916\u3092\u5024\u3068\u3057\u3066\u6271\u3046\u3053\u3068\u304c\u3067\u304d\u3001\u95a2\u6570\u578b\u306e\u65b9\u6cd5\u3067\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u304c\u3067\u304d\u307e\u3059\u3002</p>"},{"location":"java/part-6/#12","title":"\u7b2c12\u7ae0: \u30c6\u30b9\u30c8\u6226\u7565","text":""},{"location":"java/part-6/#121","title":"12.1 \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u30c6\u30b9\u30c8","text":"<p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u3067\u306f\u3001\u7d14\u7c8b\u95a2\u6570\u306e\u304a\u304b\u3052\u3067\u30c6\u30b9\u30c8\u304c\u975e\u5e38\u306b\u7c21\u5358\u306b\u306a\u308a\u307e\u3059\u3002</p> <p></p>"},{"location":"java/part-6/#122-searchreport","title":"12.2 SearchReport \u306e\u5c0e\u5165","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch11/TravelGuide.java</code></p> <p>\u30c6\u30b9\u30c8\u53ef\u80fd\u6027\u3092\u9ad8\u3081\u308b\u305f\u3081\u3001<code>SearchReport</code> \u3092\u5c0e\u5165\u3057\u307e\u3059\u3002</p> <pre><code>/**\n * \u691c\u7d22\u30ec\u30dd\u30fc\u30c8\uff08\u30a8\u30e9\u30fc\u3084\u4e0d\u5341\u5206\u306a\u7d50\u679c\u3092\u5831\u544a\uff09\n */\npublic record SearchReport(\n        List&lt;Guide&gt; badGuides,\n        List&lt;String&gt; problems\n) {\n    public SearchReport {\n        Objects.requireNonNull(badGuides, \"SearchReport badGuides cannot be null\");\n        Objects.requireNonNull(problems, \"SearchReport problems cannot be null\");\n    }\n\n    public static SearchReport empty() {\n        return new SearchReport(List.empty(), List.empty());\n    }\n\n    public static SearchReport withProblems(List&lt;String&gt; problems) {\n        return new SearchReport(List.empty(), problems);\n    }\n\n    public static SearchReport withBadGuides(List&lt;Guide&gt; badGuides) {\n        return new SearchReport(badGuides, List.empty());\n    }\n}\n</code></pre> <p></p>"},{"location":"java/part-6/#123-testdataaccess-","title":"12.3 TestDataAccess - \u30c6\u30b9\u30c8\u7528\u30b9\u30bf\u30d6","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/test/java/ch12/TestDataAccess.java</code></p> <p>Builder \u30d1\u30bf\u30fc\u30f3\u3092\u4f7f\u7528\u3057\u305f\u30c6\u30b9\u30c8\u7528\u30b9\u30bf\u30d6:</p> <pre><code>public class TestDataAccess implements DataAccess {\n\n    // \u30d3\u30eb\u30c0\u30fc\u30d1\u30bf\u30fc\u30f3\u3067\u4f5c\u6210\n    public static Builder builder() {\n        return new Builder();\n    }\n\n    // \u7a7a\u306e DataAccess \u3092\u4f5c\u6210\n    public static DataAccess empty() {\n        return builder().build();\n    }\n\n    // \u30d5\u30a1\u30af\u30c8\u30ea\u30e1\u30bd\u30c3\u30c9\n    public static DataAccess withAttractions(Attraction... attractions) {\n        return builder().withAttractions(attractions).build();\n    }\n\n    public static class Builder {\n        private List&lt;Attraction&gt; attractions = List.empty();\n        private List&lt;Artist&gt; artists = List.empty();\n        private List&lt;Movie&gt; movies = List.empty();\n        private String attractionsError = null;\n        private String artistsError = null;\n        private String moviesError = null;\n\n        public Builder withAttractions(Attraction... attractions) {\n            this.attractions = List.of(attractions);\n            return this;\n        }\n\n        public Builder withArtists(Artist... artists) {\n            this.artists = List.of(artists);\n            return this;\n        }\n\n        public Builder withMovies(Movie... movies) {\n            this.movies = List.of(movies);\n            return this;\n        }\n\n        public Builder failOnAttractions(String errorMessage) {\n            this.attractionsError = errorMessage;\n            return this;\n        }\n\n        public Builder failOnArtists(String errorMessage) {\n            this.artistsError = errorMessage;\n            return this;\n        }\n\n        public Builder failOnMovies(String errorMessage) {\n            this.moviesError = errorMessage;\n            return this;\n        }\n\n        public TestDataAccess build() {\n            return new TestDataAccess(this);\n        }\n    }\n}\n</code></pre> <p></p>"},{"location":"java/part-6/#testdataaccess","title":"TestDataAccess \u306e\u4f7f\u7528\u4f8b","text":"<pre><code>// \u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u306e\u6e96\u5099\nstatic final Location LONDON = new Location(\n        new LocationId(\"Q84\"),\n        \"London\",\n        8_908_081\n);\n\nstatic final Attraction TOWER_BRIDGE = new Attraction(\n        \"Tower Bridge\",\n        Option.none(),\n        LONDON\n);\n\nstatic final Artist QUEEN = new Artist(\"Queen\", 2_050_559);\nstatic final Movie INSIDE_OUT = new Movie(\"Inside Out\", 857_611_174);\n\n// \u6b63\u5e38\u7cfb\u306e\u30c6\u30b9\u30c8\n@Test\nvoid withAllData() {\n    DataAccess dataAccess = TestDataAccess.of(\n            List.of(TOWER_BRIDGE),\n            List.of(QUEEN),\n            List.of(INSIDE_OUT)\n    );\n\n    assertThat(dataAccess.findAttractions(\"test\", AttractionOrdering.BY_NAME, 10).unsafeRun())\n            .containsExactly(TOWER_BRIDGE);\n    assertThat(dataAccess.findArtistsFromLocation(LONDON.id(), 10).unsafeRun())\n            .containsExactly(QUEEN);\n    assertThat(dataAccess.findMoviesAboutLocation(LONDON.id(), 10).unsafeRun())\n            .containsExactly(INSIDE_OUT);\n}\n\n// \u30a8\u30e9\u30fc\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3\n@Test\nvoid failOnAttractions() {\n    DataAccess dataAccess = TestDataAccess.builder()\n            .failOnAttractions(\"Network error\")\n            .build();\n\n    assertThatThrownBy(() -&gt;\n            dataAccess.findAttractions(\"test\", AttractionOrdering.BY_NAME, 10).unsafeRun()\n    ).isInstanceOf(RuntimeException.class)\n            .hasMessage(\"Network error\");\n}\n</code></pre>"},{"location":"java/part-6/#124","title":"12.4 \u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/test/java/ch12/PropertyBasedTest.java</code></p> <p>JUnit 5 \u306e <code>@RepeatedTest</code> \u3092\u4f7f\u7528\u3057\u305f\u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8:</p> <pre><code>// \u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306e\u5b9a\u7fa9\nstatic int nonNegativeInt() {\n    return random.nextInt(Integer.MAX_VALUE);\n}\n\nstatic String randomString() {\n    int length = random.nextInt(20) + 1;\n    StringBuilder sb = new StringBuilder();\n    for (int i = 0; i &lt; length; i++) {\n        sb.append((char) ('a' + random.nextInt(26)));\n    }\n    return sb.toString();\n}\n\nstatic Location randomLocation() {\n    return new Location(\n            new LocationId(\"Q\" + nonNegativeInt(1000000)),\n            randomString(),\n            nonNegativeInt(10_000_000)\n    );\n}\n\nstatic Attraction randomAttraction(boolean withDescription) {\n    return new Attraction(\n            randomString(),\n            withDescription ? Option.some(randomString()) : Option.none(),\n            randomLocation()\n    );\n}\n\nstatic Guide randomGuide(boolean withDescription, int maxSubjects) {\n    return new Guide(\n            randomAttraction(withDescription),\n            randomSubjects(maxSubjects)\n    );\n}\n</code></pre> <p></p>"},{"location":"java/part-6/#125","title":"12.5 \u4e0d\u5909\u6761\u4ef6\u306e\u30c6\u30b9\u30c8","text":"<pre><code>@Nested\n@DisplayName(\"guideScore \u306e\u30d7\u30ed\u30d1\u30c6\u30a3\")\nclass GuideScorePropertyTest {\n\n    @RepeatedTest(100)\n    @DisplayName(\"\u30b9\u30b3\u30a2\u306f\u5e38\u306b 0 \u4ee5\u4e0a 100 \u4ee5\u4e0b\")\n    void scoreIsBetween0And100() {\n        Guide guide = randomGuide(random.nextBoolean(), 10);\n\n        int score = guideScore(guide);\n\n        assertThat(score).isBetween(0, 100);\n    }\n\n    @RepeatedTest(100)\n    @DisplayName(\"\u8aac\u660e\u3042\u308a\u306e\u30b9\u30b3\u30a2\u306f\u8aac\u660e\u306a\u3057\u3088\u308a 30 \u70b9\u9ad8\u3044\")\n    void descriptionAdds30Points() {\n        Location location = randomLocation();\n        List&lt;PopCultureSubject&gt; subjects = randomSubjects(4);\n\n        Attraction withDesc = new Attraction(\"Test\", Option.some(\"Description\"), location);\n        Attraction withoutDesc = new Attraction(\"Test\", Option.none(), location);\n\n        Guide guideWithDesc = new Guide(withDesc, subjects);\n        Guide guideWithoutDesc = new Guide(withoutDesc, subjects);\n\n        int scoreDiff = guideScore(guideWithDesc) - guideScore(guideWithoutDesc);\n\n        assertThat(scoreDiff).isEqualTo(30);\n    }\n\n    @RepeatedTest(100)\n    @DisplayName(\"\u30b9\u30b3\u30a2\u306f\u30a2\u30c8\u30e9\u30af\u30b7\u30e7\u30f3\u540d\u306b\u4f9d\u5b58\u3057\u306a\u3044\")\n    void scoreDoesNotDependOnName() {\n        Location location = randomLocation();\n        Option&lt;String&gt; description = Option.some(randomString());\n        List&lt;PopCultureSubject&gt; subjects = randomSubjects(4);\n\n        Attraction attr1 = new Attraction(\"Name1\", description, location);\n        Attraction attr2 = new Attraction(\"Name2\", description, location);\n\n        Guide guide1 = new Guide(attr1, subjects);\n        Guide guide2 = new Guide(attr2, subjects);\n\n        assertThat(guideScore(guide1)).isEqualTo(guideScore(guide2));\n    }\n\n    @Test\n    @DisplayName(\"\u30d5\u30a9\u30ed\u30ef\u30fc\u6570\u306e\u30aa\u30fc\u30d0\u30fc\u30d5\u30ed\u30fc\u3092\u9632\u3050\")\n    void preventsFollowerOverflow() {\n        Attraction attraction = randomAttraction(false);\n        List&lt;Artist&gt; artists = List.range(0, 100)\n                .map(i -&gt; new Artist(\"Artist\" + i, Integer.MAX_VALUE));\n        Guide guide = new Guide(attraction, List.narrow(artists));\n\n        int score = guideScore(guide);\n\n        assertThat(score).isBetween(0, 100);\n    }\n}\n</code></pre>"},{"location":"java/part-6/#126","title":"12.6 \u7d14\u7c8b\u95a2\u6570\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\u30c6\u30b9\u30c8","text":"<pre><code>@Nested\n@DisplayName(\"\u7d14\u7c8b\u95a2\u6570\u306e\u30d7\u30ed\u30d1\u30c6\u30a3\")\nclass PureFunctionPropertyTest {\n\n    @RepeatedTest(100)\n    @DisplayName(\"guideScore \u306f\u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3059\uff08\u53c2\u7167\u900f\u904e\u6027\uff09\")\n    void guideScoreIsReferentiallyTransparent() {\n        Guide guide = randomGuide(random.nextBoolean(), 5);\n\n        int score1 = guideScore(guide);\n        int score2 = guideScore(guide);\n        int score3 = guideScore(guide);\n\n        assertThat(score1).isEqualTo(score2).isEqualTo(score3);\n    }\n\n    @RepeatedTest(100)\n    @DisplayName(\"findBestGuide \u306f\u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3059\")\n    void findBestGuideIsReferentiallyTransparent() {\n        List&lt;Guide&gt; guides = List.range(0, random.nextInt(5) + 1)\n                .map(i -&gt; randomGuide(random.nextBoolean(), 3));\n\n        Option&lt;Guide&gt; result1 = TravelGuide.findBestGuide(guides);\n        Option&lt;Guide&gt; result2 = TravelGuide.findBestGuide(guides);\n\n        assertThat(result1).isEqualTo(result2);\n    }\n}\n</code></pre>"},{"location":"java/part-6/#127","title":"12.7 \u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u30c6\u30b9\u30c8","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/test/java/ch11/CachedDataAccessTest.java</code></p> <pre><code>@Test\n@DisplayName(\"\u540c\u3058\u30af\u30a8\u30ea\u306f2\u56de\u76ee\u4ee5\u964d\u30ad\u30e3\u30c3\u30b7\u30e5\u304b\u3089\u8fd4\u3055\u308c\u308b\")\nvoid cachedResultsAreReused() {\n    AtomicInteger callCount = new AtomicInteger(0);\n\n    DataAccess underlying = new DataAccess() {\n        @Override\n        public IO&lt;List&lt;Attraction&gt;&gt; findAttractions(String name, AttractionOrdering ordering, int limit) {\n            return IO.delay(() -&gt; {\n                callCount.incrementAndGet();\n                return List.of(TOWER_BRIDGE);\n            });\n        }\n\n        // \u4ed6\u306e\u30e1\u30bd\u30c3\u30c9\u3082\u540c\u69d8\u306b\u5b9f\u88c5...\n    };\n\n    DataAccess cached = CachedDataAccess.createUnsafe(underlying);\n\n    // 1\u56de\u76ee\u306e\u30af\u30a8\u30ea\n    cached.findAttractions(\"Bridge\", AttractionOrdering.BY_NAME, 10).unsafeRun();\n    assertThat(callCount.get()).isEqualTo(1);\n\n    // 2\u56de\u76ee\u306e\u30af\u30a8\u30ea\uff08\u540c\u3058\u30d1\u30e9\u30e1\u30fc\u30bf\uff09\n    cached.findAttractions(\"Bridge\", AttractionOrdering.BY_NAME, 10).unsafeRun();\n    assertThat(callCount.get()).isEqualTo(1); // \u30ad\u30e3\u30c3\u30b7\u30e5\u304b\u3089\u8fd4\u3055\u308c\u308b\u306e\u3067\u547c\u3073\u51fa\u3057\u56de\u6570\u306f\u5897\u3048\u306a\u3044\n\n    // 3\u56de\u76ee\u306e\u30af\u30a8\u30ea\uff08\u7570\u306a\u308b\u30d1\u30e9\u30e1\u30fc\u30bf\uff09\n    cached.findAttractions(\"Tower\", AttractionOrdering.BY_NAME, 10).unsafeRun();\n    assertThat(callCount.get()).isEqualTo(2); // \u65b0\u3057\u3044\u30af\u30a8\u30ea\u306a\u306e\u3067\u547c\u3073\u51fa\u3055\u308c\u308b\n}\n</code></pre>"},{"location":"java/part-6/#128-resource","title":"12.8 Resource \u306e\u30c6\u30b9\u30c8","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/test/java/ch11/ResourceTest.java</code></p> <pre><code>@Test\n@DisplayName(\"use \u3067\u30ea\u30bd\u30fc\u30b9\u3092\u53d6\u5f97\u3057\u3066\u4f7f\u7528\")\nvoid useAcquiresAndReleasesResource() {\n    AtomicBoolean released = new AtomicBoolean(false);\n\n    Resource&lt;String&gt; resource = Resource.make(\n            IO.pure(\"hello\"),\n            s -&gt; released.set(true)\n    );\n\n    String result = resource.use(s -&gt; IO.pure(s.toUpperCase())).unsafeRun();\n\n    assertThat(result).isEqualTo(\"HELLO\");\n    assertThat(released.get()).isTrue();\n}\n\n@Test\n@DisplayName(\"\u51e6\u7406\u304c\u5931\u6557\u3057\u3066\u3082\u30ea\u30bd\u30fc\u30b9\u306f\u89e3\u653e\u3055\u308c\u308b\")\nvoid resourceReleasedOnFailure() {\n    AtomicBoolean released = new AtomicBoolean(false);\n\n    Resource&lt;String&gt; resource = Resource.make(\n            IO.pure(\"hello\"),\n            s -&gt; released.set(true)\n    );\n\n    assertThatThrownBy(() -&gt;\n            resource.use(s -&gt; IO.delay(() -&gt; {\n                throw new RuntimeException(\"error\");\n            })).unsafeRun()\n    ).isInstanceOf(RuntimeException.class);\n\n    assertThat(released.get()).isTrue();\n}\n\n@Test\n@DisplayName(\"both \u30672\u3064\u306e\u30ea\u30bd\u30fc\u30b9\u3092\u7d44\u307f\u5408\u308f\u305b\u308b\")\nvoid bothCombinesTwoResources() {\n    AtomicBoolean firstReleased = new AtomicBoolean(false);\n    AtomicBoolean secondReleased = new AtomicBoolean(false);\n\n    Resource&lt;Integer&gt; first = Resource.make(\n            IO.pure(1),\n            i -&gt; firstReleased.set(true)\n    );\n\n    Resource&lt;String&gt; second = Resource.make(\n            IO.pure(\"two\"),\n            s -&gt; secondReleased.set(true)\n    );\n\n    var result = Resource.both(first, second)\n            .use(tuple -&gt; IO.pure(tuple._1() + tuple._2()))\n            .unsafeRun();\n\n    assertThat(result).isEqualTo(\"1two\");\n    assertThat(firstReleased.get()).isTrue();\n    assertThat(secondReleased.get()).isTrue();\n}\n</code></pre>"},{"location":"java/part-6/#129","title":"12.9 \u30c6\u30b9\u30c8\u30d4\u30e9\u30df\u30c3\u30c9","text":""},{"location":"java/part-6/#_1","title":"\u307e\u3068\u3081","text":""},{"location":"java/part-6/#part-vi_1","title":"Part VI \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"java/part-6/#_2","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>record \u3068 sealed interface: Java 17 \u306e\u6a5f\u80fd\u3067 Scala \u306e case class \u3068 ADT \u3092\u8868\u73fe</li> <li>DataAccess \u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9: \u5916\u90e8\u4f9d\u5b58\u3092\u62bd\u8c61\u5316\u3057\u3066\u30c6\u30b9\u30c8\u53ef\u80fd\u306b</li> <li>Resource: acquire/release \u30d1\u30bf\u30fc\u30f3\u3067\u5b89\u5168\u306a\u30ea\u30bd\u30fc\u30b9\u7ba1\u7406</li> <li>guarantee: finally \u7684\u306a\u30bb\u30de\u30f3\u30c6\u30a3\u30af\u30b9\u3092 IO \u306b\u8ffd\u52a0</li> <li>attempt: \u4f8b\u5916\u3092 Either \u306b\u5909\u63db\u3057\u3066\u30a8\u30e9\u30fc\u3092\u5024\u3068\u3057\u3066\u6271\u3046</li> <li>CachedDataAccess: Ref \u3092\u4f7f\u7528\u3057\u305f\u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u30ad\u30e3\u30c3\u30b7\u30e5</li> <li>TestDataAccess: Builder \u30d1\u30bf\u30fc\u30f3\u3067\u30c6\u30b9\u30c8\u30b9\u30bf\u30d6\u3092\u67d4\u8edf\u306b\u4f5c\u6210</li> <li>\u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8: @RepeatedTest \u3068\u30e9\u30f3\u30c0\u30e0\u751f\u6210\u3067\u4e0d\u5909\u6761\u4ef6\u3092\u691c\u8a3c</li> </ol>"},{"location":"java/part-6/#_3","title":"\u5b66\u7fd2\u306e\u7dcf\u62ec","text":""},{"location":"java/part-6/#scala","title":"Scala \u3068\u306e\u6bd4\u8f03","text":"\u6982\u5ff5 Scala (cats-effect) Java + Vavr \u5024\u30aa\u30d6\u30b8\u30a7\u30af\u30c8 <code>opaque type LocationId</code> <code>record LocationId(String value)</code> \u30c9\u30e1\u30a4\u30f3\u30e2\u30c7\u30eb <code>case class</code> <code>record</code> ADT <code>sealed trait</code> <code>sealed interface</code> \u30ea\u30bd\u30fc\u30b9\u7ba1\u7406 <code>Resource[IO, A]</code> <code>Resource&lt;A&gt;</code> (\u72ec\u81ea\u5b9f\u88c5) \u30ad\u30e3\u30c3\u30b7\u30e5 <code>Ref[IO, Map[...]]</code> <code>Ref&lt;Map&lt;...&gt;&gt;</code> \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0 <code>IO[A].attempt</code> <code>IO&lt;A&gt;.attempt()</code> \u30c6\u30b9\u30c8\u30b9\u30bf\u30d6 <code>val stub = new DataAccess {...}</code> <code>TestDataAccess.builder().build()</code> \u30d7\u30ed\u30d1\u30c6\u30a3\u30c6\u30b9\u30c8 ScalaCheck <code>Gen[A]</code> <code>@RepeatedTest</code> + random generators"},{"location":"java/part-6/#_4","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"java/part-6/#1-dataaccess","title":"\u554f\u984c 1: DataAccess \u306e\u62e1\u5f35","text":"<p>\u4ee5\u4e0b\u306e\u8981\u4ef6\u3067 <code>DataAccess</code> \u3092\u62e1\u5f35\u3057\u3066\u304f\u3060\u3055\u3044: - \u65b0\u3057\u3044\u30e1\u30bd\u30c3\u30c9 <code>findHotelsNearLocation</code> \u3092\u8ffd\u52a0 - \u623b\u308a\u5024\u306f <code>IO&lt;List&lt;Hotel&gt;&gt;</code></p> \u89e3\u7b54 <pre><code>public record Hotel(String name, double rating, Location location) {}\n\npublic interface DataAccess {\n    // \u65e2\u5b58\u306e\u30e1\u30bd\u30c3\u30c9...\n\n    IO&lt;List&lt;Hotel&gt;&gt; findHotelsNearLocation(\n            LocationId locationId,\n            int limit\n    );\n}\n\n// TestDataAccess.Builder \u306b\u8ffd\u52a0\npublic Builder withHotels(Hotel... hotels) {\n    this.hotels = List.of(hotels);\n    return this;\n}\n</code></pre>"},{"location":"java/part-6/#2_1","title":"\u554f\u984c 2: \u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u306b\u5bfe\u3059\u308b\u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8\u3092\u66f8\u3044\u3066\u304f\u3060\u3055\u3044:</p> <pre><code>public static List&lt;Location&gt; filterPopularLocations(\n        List&lt;Location&gt; locations,\n        int minPopulation) {\n    return locations.filter(loc -&gt; loc.population() &gt;= minPopulation);\n}\n</code></pre> \u89e3\u7b54 <pre><code>static List&lt;Location&gt; randomLocations(int maxCount) {\n    int count = random.nextInt(maxCount + 1);\n    return List.range(0, count).map(i -&gt; randomLocation());\n}\n\n// \u30d7\u30ed\u30d1\u30c6\u30a31: \u7d50\u679c\u306f\u5165\u529b\u4ee5\u4e0b\u306e\u8981\u7d20\u6570\n@RepeatedTest(100)\n@DisplayName(\"\u7d50\u679c\u306e\u30b5\u30a4\u30ba\u306f\u5165\u529b\u4ee5\u4e0b\")\nvoid resultSizeIsLessOrEqual() {\n    List&lt;Location&gt; locations = randomLocations(20);\n    int minPop = nonNegativeInt(10_000_000);\n\n    List&lt;Location&gt; result = filterPopularLocations(locations, minPop);\n\n    assertThat(result.size()).isLessThanOrEqualTo(locations.size());\n}\n\n// \u30d7\u30ed\u30d1\u30c6\u30a32: \u7d50\u679c\u306e\u3059\u3079\u3066\u306e\u8981\u7d20\u306f\u6761\u4ef6\u3092\u6e80\u305f\u3059\n@RepeatedTest(100)\n@DisplayName(\"\u3059\u3079\u3066\u306e\u7d50\u679c\u306f\u6700\u5c0f\u4eba\u53e3\u4ee5\u4e0a\")\nvoid allResultsMeetMinimum() {\n    List&lt;Location&gt; locations = randomLocations(20);\n    int minPop = nonNegativeInt(10_000_000);\n\n    List&lt;Location&gt; result = filterPopularLocations(locations, minPop);\n\n    assertThat(result.forAll(loc -&gt; loc.population() &gt;= minPop)).isTrue();\n}\n\n// \u30d7\u30ed\u30d1\u30c6\u30a33: \u6761\u4ef6\u3092\u6e80\u305f\u3059\u8981\u7d20\u306f\u3059\u3079\u3066\u7d50\u679c\u306b\u542b\u307e\u308c\u308b\n@RepeatedTest(100)\n@DisplayName(\"\u6761\u4ef6\u3092\u6e80\u305f\u3059\u8981\u7d20\u306f\u3059\u3079\u3066\u7d50\u679c\u306b\u542b\u307e\u308c\u308b\")\nvoid allQualifyingLocationsAreInResult() {\n    List&lt;Location&gt; locations = randomLocations(20);\n    int minPop = nonNegativeInt(10_000_000);\n\n    List&lt;Location&gt; result = filterPopularLocations(locations, minPop);\n    List&lt;Location&gt; expected = locations.filter(loc -&gt; loc.population() &gt;= minPop);\n\n    assertThat(result).containsExactlyInAnyOrderElementsOf(expected);\n}\n</code></pre>"},{"location":"java/part-6/#3-resource","title":"\u554f\u984c 3: Resource \u306e\u5b9f\u88c5","text":"<p>\u30d5\u30a1\u30a4\u30eb\u3092\u5b89\u5168\u306b\u8aad\u307f\u53d6\u308b <code>Resource</code> \u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> \u89e3\u7b54 <pre><code>public static Resource&lt;BufferedReader&gt; fileResource(String path) {\n    return Resource.fromAutoCloseable(\n            IO.delay(() -&gt; new BufferedReader(new FileReader(path)))\n    );\n}\n\npublic static IO&lt;List&lt;String&gt;&gt; readLines(String path) {\n    return fileResource(path).use(reader -&gt;\n            IO.delay(() -&gt; {\n                java.util.List&lt;String&gt; lines = new java.util.ArrayList&lt;&gt;();\n                String line;\n                while ((line = reader.readLine()) != null) {\n                    lines.add(line);\n                }\n                return List.ofAll(lines);\n            })\n    );\n}\n\n// \u4f7f\u7528\u4f8b\nIO&lt;Void&gt; program = readLines(\"data.txt\")\n        .flatMap(lines -&gt;\n                IO.effect(() -&gt; System.out.println(\"Read \" + lines.size() + \" lines\"))\n        );\n\nprogram.unsafeRun();\n</code></pre>"},{"location":"java/part-6/#_5","title":"\u30b7\u30ea\u30fc\u30ba\u5168\u4f53\u306e\u7dcf\u62ec","text":"<p>\u672c\u30b7\u30ea\u30fc\u30ba\u3067\u306f\u3001\u300cGrokking Functional Programming\u300d\u306e\u5185\u5bb9\u306b\u6cbf\u3063\u3066\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u790e\u304b\u3089\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u307e\u3067\u3092\u5b66\u3073\u307e\u3057\u305f\u3002</p>"},{"location":"java/part-6/#_6","title":"\u5b66\u3093\u3060\u4e3b\u306a\u6982\u5ff5","text":"Part \u7ae0 \u4e3b\u306a\u6982\u5ff5 I 1-2 \u7d14\u7c8b\u95a2\u6570\u3001\u53c2\u7167\u900f\u904e\u6027 II 3-5 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u3001\u9ad8\u968e\u95a2\u6570\u3001flatMap III 6-7 Option\u3001Either\u3001ADT IV 8-9 IO \u30e2\u30ca\u30c9\u3001Stream V 10 \u4e26\u884c\u51e6\u7406\u3001Ref\u3001Fiber VI 11-12 \u5b9f\u8df5\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3001\u30c6\u30b9\u30c8"},{"location":"java/part-6/#_7","title":"\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u5229\u70b9","text":"<ol> <li>\u4e88\u6e2c\u53ef\u80fd\u6027: \u7d14\u7c8b\u95a2\u6570\u306f\u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b</li> <li>\u30c6\u30b9\u30c8\u5bb9\u6613\u6027: \u526f\u4f5c\u7528\u304c\u306a\u3044\u305f\u3081\u30c6\u30b9\u30c8\u304c\u7c21\u5358</li> <li>\u5408\u6210\u53ef\u80fd\u6027: \u5c0f\u3055\u306a\u95a2\u6570\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u8907\u96d1\u306a\u51e6\u7406\u3092\u69cb\u7bc9</li> <li>\u4e26\u884c\u5b89\u5168\u6027: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u306f\u7af6\u5408\u72b6\u614b\u3092\u9632\u3050</li> <li>\u578b\u5b89\u5168\u6027: Option\u3001Either \u3067 null \u3084\u4f8b\u5916\u3092\u578b\u3067\u8868\u73fe</li> </ol>"},{"location":"java/part-6/#_8","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<ul> <li>Vavr \u306e\u3088\u308a\u9ad8\u5ea6\u306a\u6a5f\u80fd\u3092\u5b66\u3076</li> <li>\u30d7\u30ed\u30b8\u30a7\u30af\u30c8 Reactor \u3084 RxJava \u3092\u63a2\u7d22</li> <li>Virtual Thread \u3068\u7d44\u307f\u5408\u308f\u305b\u305f\u5b9f\u8df5\u7684\u306a\u4e26\u884c\u51e6\u7406</li> <li>\u5b9f\u969b\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067 FP \u3092\u9069\u7528\u3059\u308b</li> </ul>"},{"location":"rust/","title":"Grokking Functional Programming - Rust \u7248","text":"<p>\u672c\u30b7\u30ea\u30fc\u30ba\u306f\u300cGrokking Functional Programming\u300d\uff08Micha\u0142 P\u0142achta \u8457\uff09\u306e\u5b66\u7fd2\u30b3\u30f3\u30d1\u30cb\u30aa\u30f3\u3068\u3057\u3066\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u6982\u5ff5\u3092 Rust \u3067\u5b9f\u88c5\u3057\u306a\u304c\u3089\u65e5\u672c\u8a9e\u3067\u89e3\u8aac\u3057\u307e\u3059\u3002</p>"},{"location":"rust/#_1","title":"\u5bfe\u8c61\u8aad\u8005","text":"<ul> <li>\u4ed6\u8a00\u8a9e\u306e\u7d4c\u9a13\u304c\u3042\u308a\u3001Rust \u3068\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u8208\u5473\u304c\u3042\u308b\u958b\u767a\u8005</li> <li>Rust \u306e\u6240\u6709\u6a29\u30b7\u30b9\u30c6\u30e0\u3068 FP \u306e\u6982\u5ff5\u3092\u7d50\u3073\u3064\u3051\u3066\u7406\u89e3\u3057\u305f\u3044\u65b9</li> <li>\u5b9f\u8df5\u7684\u306a FP \u306e\u9069\u7528\u65b9\u6cd5\u3092 Rust \u3067\u5b66\u3073\u305f\u3044\u30a8\u30f3\u30b8\u30cb\u30a2</li> </ul>"},{"location":"rust/#_2","title":"\u8a18\u4e8b\u4e00\u89a7","text":""},{"location":"rust/#part-i","title":"Part I: \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u790e","text":"<p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u672c\u6982\u5ff5\u3092 Rust \u3067\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c1\u7ae0 \u547d\u4ee4\u578b vs \u95a2\u6570\u578b\u3001Rust \u57fa\u672c\u69cb\u6587 \u7b2c2\u7ae0 \u7d14\u7c8b\u95a2\u6570\u3001\u526f\u4f5c\u7528\u306e\u6392\u9664\u3001\u6240\u6709\u6a29\u3068\u30a4\u30df\u30e5\u30fc\u30bf\u30d3\u30ea\u30c6\u30a3 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: \u7d14\u7c8b\u95a2\u6570\u3001\u53c2\u7167\u900f\u904e\u6027\u3001\u6240\u6709\u6a29\u3001\u501f\u7528</p>"},{"location":"rust/#part-ii","title":"Part II: \u95a2\u6570\u578b\u30b9\u30bf\u30a4\u30eb\u306e\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0","text":"<p>\u30a4\u30c6\u30ec\u30fc\u30bf\u3068\u30af\u30ed\u30fc\u30b8\u30e3\u3092\u4f7f\u3063\u305f\u95a2\u6570\u578b\u30b9\u30bf\u30a4\u30eb\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c3\u7ae0 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u3001Vec \u64cd\u4f5c \u7b2c4\u7ae0 \u30a4\u30c6\u30ec\u30fc\u30bf\u3001map/filter/fold \u7b2c5\u7ae0 flat_map\u3001\u30a4\u30c6\u30ec\u30fc\u30bf\u30c1\u30a7\u30fc\u30f3 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: \u30a4\u30c6\u30ec\u30fc\u30bf\u3001\u30af\u30ed\u30fc\u30b8\u30e3\u3001Iterator \u30c8\u30ec\u30a4\u30c8</p>"},{"location":"rust/#part-iii-optionresult","title":"Part III: \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3068 Option/Result","text":"<p>\u578b\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c6\u7ae0 Option \u578b\u3001Some/None \u7b2c7\u7ae0 Result \u578b\u3001\u5217\u6319\u578b\uff08enum\uff09\u3001\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: Option\u3001Result\u3001? \u6f14\u7b97\u5b50\u3001\u4ee3\u6570\u7684\u30c7\u30fc\u30bf\u578b\uff08ADT\uff09</p>"},{"location":"rust/#part-iv","title":"Part IV: \u975e\u540c\u671f\u51e6\u7406\u3068\u30b9\u30c8\u30ea\u30fc\u30e0","text":"<p>async/await \u3068\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c8\u7ae0 async/await\u3001Future \u7b2c9\u7ae0 Stream\u3001tokio-stream <p>\u30ad\u30fc\u30ef\u30fc\u30c9: async/await\u3001Future\u3001Stream\u3001tokio</p>"},{"location":"rust/#part-v","title":"Part V: \u4e26\u884c\u51e6\u7406","text":"<p>Rust \u306b\u304a\u3051\u308b\u5b89\u5168\u306a\u4e26\u884c\u51e6\u7406\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c10\u7ae0 Arc\u3001Mutex\u3001\u30c1\u30e3\u30cd\u30eb \u7b2c11\u7ae0 tokio \u30bf\u30b9\u30af\u3001\u4e26\u884c\u30d1\u30bf\u30fc\u30f3 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: \u4e26\u884c\u51e6\u7406\u3001Arc\u3001Mutex\u3001mpsc\u3001tokio</p>"},{"location":"rust/#part-vi","title":"Part VI: \u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u3068\u30c6\u30b9\u30c8","text":"<p>\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u3068\u30c6\u30b9\u30c8\u6226\u7565\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c12\u7ae0 TravelGuide \u30a2\u30d7\u30ea\u3001\u30c8\u30ec\u30a4\u30c8\u306b\u3088\u308b\u62bd\u8c61\u5316\u3001\u30c6\u30b9\u30c8\u6226\u7565 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: \u30c8\u30ec\u30a4\u30c8\u3001\u4f9d\u5b58\u6027\u6ce8\u5165\u3001proptest</p>"},{"location":"rust/#_3","title":"\u5b66\u7fd2\u30d1\u30b9","text":""},{"location":"rust/#_4","title":"\u4f7f\u7528\u30e9\u30a4\u30d6\u30e9\u30ea","text":"\u30e9\u30a4\u30d6\u30e9\u30ea \u7528\u9014 \u5bfe\u5fdc\u7ae0 Rust (stable) \u8a00\u8a9e \u5168\u7ae0 tokio \u975e\u540c\u671f\u30e9\u30f3\u30bf\u30a4\u30e0 Part IV-VI tokio-stream \u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406 Part IV-V proptest \u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8 Part VI anyhow / thiserror \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0 Part III-VI"},{"location":"rust/#_5","title":"\u30ea\u30dd\u30b8\u30c8\u30ea\u69cb\u6210","text":"<pre><code>grokkingfp-examples/\n\u251c\u2500\u2500 app/rust/src/           # Rust \u306e\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n\u2502   \u251c\u2500\u2500 ch01/               # \u7b2c1\u7ae0\n\u2502   \u251c\u2500\u2500 ch02/               # \u7b2c2\u7ae0\n\u2502   \u2514\u2500\u2500 ...                 # \u4ee5\u964d\u306e\u7ae0\n\u251c\u2500\u2500 app/rust/Cargo.toml     # \u4f9d\u5b58\u95a2\u4fc2\n\u2514\u2500\u2500 docs/article/rust/      # \u89e3\u8aac\u8a18\u4e8b\uff08\u672c\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\uff09\n    \u251c\u2500\u2500 index.md            # \u3053\u306e\u8a18\u4e8b\n    \u251c\u2500\u2500 part-1.md           # Part I\n    \u251c\u2500\u2500 part-2.md           # Part II\n    \u251c\u2500\u2500 part-3.md           # Part III\n    \u251c\u2500\u2500 part-4.md           # Part IV\n    \u251c\u2500\u2500 part-5.md           # Part V\n    \u2514\u2500\u2500 part-6.md           # Part VI\n</code></pre>"},{"location":"rust/#rust","title":"Rust \u3068\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0","text":"<p>Rust \u306f\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u591a\u304f\u306e\u6982\u5ff5\u3092\u53d6\u308a\u5165\u308c\u3066\u3044\u307e\u3059:</p>"},{"location":"rust/#_6","title":"\u6240\u6709\u6a29\u3068\u30a4\u30df\u30e5\u30fc\u30bf\u30d3\u30ea\u30c6\u30a3","text":"<pre><code>// \u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\nlet x = 5;\n// x = 6; // \u30b3\u30f3\u30d1\u30a4\u30eb\u30a8\u30e9\u30fc\n\n// \u660e\u793a\u7684\u306b mut \u3092\u4ed8\u3051\u308b\nlet mut y = 5;\ny = 6; // OK\n</code></pre>"},{"location":"rust/#_7","title":"\u30a4\u30c6\u30ec\u30fc\u30bf\u3068\u30af\u30ed\u30fc\u30b8\u30e3","text":"<pre><code>let numbers = vec![1, 2, 3, 4, 5];\nlet doubled: Vec&lt;i32&gt; = numbers\n    .iter()\n    .map(|x| x * 2)\n    .filter(|x| *x &gt; 4)\n    .collect();\n</code></pre>"},{"location":"rust/#_8","title":"\u4ee3\u6570\u7684\u30c7\u30fc\u30bf\u578b","text":"<pre><code>enum Option&lt;T&gt; {\n    Some(T),\n    None,\n}\n\nenum Result&lt;T, E&gt; {\n    Ok(T),\n    Err(E),\n}\n</code></pre>"},{"location":"rust/#_9","title":"\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0","text":"<pre><code>match value {\n    Some(x) if x &gt; 0 =&gt; println!(\"Positive: {}\", x),\n    Some(x) =&gt; println!(\"Non-positive: {}\", x),\n    None =&gt; println!(\"No value\"),\n}\n</code></pre>"},{"location":"rust/#_10","title":"\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u5229\u70b9","text":"<p>\u672c\u30b7\u30ea\u30fc\u30ba\u3092\u901a\u3058\u3066\u3001\u4ee5\u4e0b\u306e\u5229\u70b9\u3092\u5b9f\u611f\u3067\u304d\u307e\u3059:</p> <ol> <li>\u4e88\u6e2c\u53ef\u80fd\u6027 - \u7d14\u7c8b\u95a2\u6570\u306f\u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b</li> <li>\u30c6\u30b9\u30c8\u5bb9\u6613\u6027 - \u526f\u4f5c\u7528\u304c\u306a\u3044\u305f\u3081\u30c6\u30b9\u30c8\u304c\u7c21\u5358</li> <li>\u5408\u6210\u53ef\u80fd\u6027 - \u30a4\u30c6\u30ec\u30fc\u30bf\u30c1\u30a7\u30fc\u30f3\u3067\u8907\u96d1\u306a\u51e6\u7406\u3092\u69cb\u7bc9</li> <li>\u4e26\u884c\u5b89\u5168\u6027 - \u6240\u6709\u6a29\u30b7\u30b9\u30c6\u30e0\u304c\u30c7\u30fc\u30bf\u7af6\u5408\u3092\u9632\u3050</li> <li>\u578b\u5b89\u5168\u6027 - Option\u3001Result \u3067 null \u3084\u4f8b\u5916\u3092\u578b\u3067\u8868\u73fe</li> </ol>"},{"location":"rust/#scala","title":"Scala \u3068\u306e\u5bfe\u6bd4","text":"\u6982\u5ff5 Scala Rust \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u5909\u6570 <code>val</code> <code>let</code> \u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u5909\u6570 <code>var</code> <code>let mut</code> null \u5b89\u5168 <code>Option[T]</code> <code>Option&lt;T&gt;</code> \u30a8\u30e9\u30fc\u51e6\u7406 <code>Either[E, A]</code> <code>Result&lt;T, E&gt;</code> \u9ad8\u968e\u95a2\u6570 <code>map</code>, <code>flatMap</code> <code>map</code>, <code>flat_map</code> \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1 <code>match</code> <code>match</code> \u30c8\u30ec\u30a4\u30c8 <code>trait</code> <code>trait</code> \u30b8\u30a7\u30cd\u30ea\u30af\u30b9 <code>def foo[T]</code> <code>fn foo&lt;T&gt;</code> \u975e\u540c\u671f <code>IO[A]</code> (cats-effect) <code>async fn</code> / <code>Future</code>"},{"location":"rust/#_11","title":"\u53c2\u8003\u8cc7\u6599","text":"<ul> <li>Grokking Functional Programming - \u539f\u8457</li> <li>The Rust Programming Language - \u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8</li> <li>Rust by Example - \u5b9f\u4f8b\u3067\u5b66\u3076 Rust</li> <li>tokio \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8 - \u975e\u540c\u671f\u30e9\u30f3\u30bf\u30a4\u30e0</li> <li>Rust Design Patterns - Rust \u306e\u30c7\u30b6\u30a4\u30f3\u30d1\u30bf\u30fc\u30f3</li> </ul>"},{"location":"rust/part-1/","title":"Part I: \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u790e","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\uff08FP\uff09\u306e\u57fa\u672c\u6982\u5ff5\u3092 Rust \u3067\u5b66\u3073\u307e\u3059\u3002\u547d\u4ee4\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u3068\u306e\u9055\u3044\u3092\u7406\u89e3\u3057\u3001\u7d14\u7c8b\u95a2\u6570\u306e\u5229\u70b9\u3092\u5b9f\u611f\u3059\u308b\u3053\u3068\u304c\u76ee\u6a19\u3067\u3059\u3002</p>"},{"location":"rust/part-1/#1","title":"\u7b2c1\u7ae0: \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u5165\u9580","text":""},{"location":"rust/part-1/#11-vs","title":"1.1 \u547d\u4ee4\u578b vs \u95a2\u6570\u578b","text":"<p>\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u306f\u5927\u304d\u304f\u5206\u3051\u30662\u3064\u306e\u30d1\u30e9\u30c0\u30a4\u30e0\u304c\u3042\u308a\u307e\u3059\u3002</p> <p></p> <p>\u547d\u4ee4\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306f\u300c\u3069\u3046\u3084\u308b\u304b\u300d\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002</p> <pre><code>// \u547d\u4ee4\u578b\u30b9\u30bf\u30a4\u30eb: \u30b9\u30c6\u30c3\u30d7\u30d0\u30a4\u30b9\u30c6\u30c3\u30d7\u3067\u8a08\u7b97\nfn calculate_score_imperative(word: &amp;str) -&gt; usize {\n    let mut score = 0;\n    for _ in word.chars() {\n        score += 1;\n    }\n    score\n}\n</code></pre> <p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306f\u300c\u4f55\u3092\u3059\u308b\u304b\u300d\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002</p> <pre><code>// \u95a2\u6570\u578b\u30b9\u30bf\u30a4\u30eb: \u5ba3\u8a00\u7684\u306b\u8a18\u8ff0\nfn word_score(word: &amp;str) -&gt; usize {\n    word.len()\n}\n</code></pre>"},{"location":"rust/part-1/#12-rust","title":"1.2 Rust \u306e\u57fa\u672c\u7684\u306a\u95a2\u6570","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/rust/src/ch01_intro.rs</code></p> <p>Rust \u3067\u306e\u95a2\u6570\u5b9a\u7fa9\u306e\u57fa\u672c\u5f62\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p> <pre><code>/// \u6574\u6570\u3092\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\nfn increment(x: i32) -&gt; i32 {\n    x + 1\n}\n\n/// \u6587\u5b57\u5217\u306e\u6700\u521d\u306e\u6587\u5b57\u3092\u53d6\u5f97\nfn get_first_character(s: &amp;str) -&gt; Option&lt;char&gt; {\n    s.chars().next()\n}\n\n/// \u6328\u62f6\u6587\u3092\u751f\u6210\nfn greet(name: &amp;str) -&gt; String {\n    format!(\"Hello, {}!\", name)\n}\n</code></pre>"},{"location":"rust/part-1/#13","title":"1.3 \u95a2\u6570\u306e\u69cb\u9020","text":""},{"location":"rust/part-1/#14-rust","title":"1.4 Rust \u306e\u7279\u5fb4: \u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb","text":"<p>Rust \u3067\u306f\u5909\u6570\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\uff08\u4e0d\u5909\uff09\u3067\u3059\u3002</p> <pre><code>let x = 5;        // \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\n// x = 6;         // \u30b3\u30f3\u30d1\u30a4\u30eb\u30a8\u30e9\u30fc!\n\nlet mut y = 5;    // \u30df\u30e5\u30fc\u30bf\u30d6\u30eb\uff08\u660e\u793a\u7684\u306b\u6307\u5b9a\uff09\ny = 6;            // OK\n</code></pre> <p>\u3053\u306e\u7279\u6027\u306f\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u3068\u975e\u5e38\u306b\u76f8\u6027\u304c\u826f\u3044\u3067\u3059\u3002</p>"},{"location":"rust/part-1/#15","title":"1.5 \u5b66\u7fd2\u30dd\u30a4\u30f3\u30c8","text":"\u6982\u5ff5 \u547d\u4ee4\u578b \u95a2\u6570\u578b (Rust) \u7126\u70b9 \u624b\u9806\uff08How\uff09 \u7d50\u679c\uff08What\uff09 \u5909\u6570 <code>let mut</code> <code>let</code> \u30eb\u30fc\u30d7 <code>for</code>/<code>while</code> <code>iter().map()</code> \u30c7\u30fc\u30bf \u30df\u30e5\u30fc\u30bf\u30d6\u30eb \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb"},{"location":"rust/part-1/#2","title":"\u7b2c2\u7ae0: \u7d14\u7c8b\u95a2\u6570\u3068\u30c6\u30b9\u30c8","text":""},{"location":"rust/part-1/#21","title":"2.1 \u7d14\u7c8b\u95a2\u6570\u3068\u306f","text":"<p>\u7d14\u7c8b\u95a2\u6570\uff08Pure Function\uff09\u306f\u4ee5\u4e0b\u306e\u7279\u5fb4\u3092\u6301\u3064\u95a2\u6570\u3067\u3059:</p> <ol> <li>\u540c\u3058\u5165\u529b\u306b\u306f\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3059</li> <li>\u526f\u4f5c\u7528\u304c\u306a\u3044\uff08\u5916\u90e8\u72b6\u614b\u3092\u5909\u66f4\u3057\u306a\u3044\uff09</li> </ol> <p></p>"},{"location":"rust/part-1/#22","title":"2.2 \u7d14\u7c8b\u95a2\u6570\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/rust/src/ch02_pure_functions.rs</code></p> <pre><code>/// \u7d14\u7c8b\u95a2\u6570: \u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b\nfn add(a: i32, b: i32) -&gt; i32 {\n    a + b\n}\n\n/// \u7d14\u7c8b\u95a2\u6570: \u6587\u5b57 'a' \u3092\u9664\u5916\u3057\u305f\u30ef\u30fc\u30c9\u30b9\u30b3\u30a2\nfn word_score(word: &amp;str) -&gt; usize {\n    word.chars().filter(|&amp;c| c != 'a').count()\n}\n\n// \u30c6\u30b9\u30c8\nassert_eq!(word_score(\"Scala\"), 3);    // \"Scl\" \u2192 3\u6587\u5b57\nassert_eq!(word_score(\"function\"), 8); // 'a' \u306a\u3057 \u2192 8\u6587\u5b57\nassert_eq!(word_score(\"\"), 0);         // \u7a7a\u6587\u5b57 \u2192 0\u6587\u5b57\n</code></pre> <p>\u4e0d\u7d14\u306a\u95a2\u6570\u306e\u4f8b:</p> <pre><code>// \u4e0d\u7d14\u306a\u95a2\u6570 - \u547c\u3073\u51fa\u3059\u305f\u3073\u306b\u7570\u306a\u308b\u5024\u3092\u8fd4\u3059\nfn current_timestamp() -&gt; u64 {\n    use std::time::{SystemTime, UNIX_EPOCH};\n    SystemTime::now()\n        .duration_since(UNIX_EPOCH)\n        .unwrap()\n        .as_secs()\n}\n</code></pre>"},{"location":"rust/part-1/#23","title":"2.3 \u30b7\u30e7\u30c3\u30d4\u30f3\u30b0\u30ab\u30fc\u30c8\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/rust/src/ch02_pure_functions.rs</code></p> <p>\u7d14\u7c8b\u95a2\u6570\u3092\u4f7f\u3063\u305f\u30b7\u30e7\u30c3\u30d4\u30f3\u30b0\u30ab\u30fc\u30c8\u306e\u5b9f\u88c5:</p> <pre><code>/// \u30b7\u30e7\u30c3\u30d4\u30f3\u30b0\u30ab\u30fc\u30c8\u306e\u5272\u5f15\u7387\u3092\u8a08\u7b97\uff08\u7d14\u7c8b\u95a2\u6570\uff09\nfn get_discount_percentage(items: &amp;[&amp;str]) -&gt; i32 {\n    if items.contains(&amp;\"Book\") {\n        5\n    } else {\n        0\n    }\n}\n\n/// \u5272\u5f15\u984d\u3092\u8a08\u7b97\uff08\u7d14\u7c8b\u95a2\u6570\uff09\nfn calculate_discount(total: i32, percentage: i32) -&gt; i32 {\n    total * percentage / 100\n}\n\n/// \u6700\u7d42\u4fa1\u683c\u3092\u8a08\u7b97\uff08\u7d14\u7c8b\u95a2\u6570\u306e\u5408\u6210\uff09\nfn calculate_final_price(total: i32, items: &amp;[&amp;str]) -&gt; i32 {\n    let discount_percentage = get_discount_percentage(items);\n    let discount = calculate_discount(total, discount_percentage);\n    total - discount\n}\n\n// \u30c6\u30b9\u30c8\nassert_eq!(calculate_final_price(100, &amp;[\"Apple\", \"Book\"]), 95);\nassert_eq!(calculate_final_price(100, &amp;[\"Apple\"]), 100);\n</code></pre> <p></p>"},{"location":"rust/part-1/#24","title":"2.4 \u30c1\u30c3\u30d7\u8a08\u7b97\u306e\u4f8b","text":"<pre><code>/// \u30c1\u30c3\u30d7\u306e\u5272\u5408\u3092\u8a08\u7b97\uff08\u7d14\u7c8b\u95a2\u6570\uff09\nfn get_tip_percentage(names: &amp;[&amp;str]) -&gt; i32 {\n    match names.len() {\n        0 =&gt; 0,\n        1..=5 =&gt; 10,\n        _ =&gt; 20,\n    }\n}\n\n// \u30c6\u30b9\u30c8\nassert_eq!(get_tip_percentage(&amp;[]), 0);\nassert_eq!(get_tip_percentage(&amp;[\"Alice\", \"Bob\"]), 10);\nassert_eq!(get_tip_percentage(&amp;[\"A\", \"B\", \"C\", \"D\", \"E\", \"F\"]), 20);\n</code></pre>"},{"location":"rust/part-1/#25-rust","title":"2.5 Rust \u306e\u6240\u6709\u6a29\u3068\u7d14\u7c8b\u6027","text":"<p>Rust \u306e\u6240\u6709\u6a29\u30b7\u30b9\u30c6\u30e0\u306f\u7d14\u7c8b\u95a2\u6570\u306e\u5b9f\u88c5\u3092\u652f\u63f4\u3057\u307e\u3059\u3002</p> <pre><code>/// \u501f\u7528\u3092\u4f7f\u3063\u305f\u7d14\u7c8b\u95a2\u6570\uff08\u5143\u306e\u30c7\u30fc\u30bf\u3092\u5909\u66f4\u3057\u306a\u3044\uff09\nfn count_vowels(s: &amp;str) -&gt; usize {\n    s.chars()\n        .filter(|c| matches!(c.to_ascii_lowercase(), 'a' | 'e' | 'i' | 'o' | 'u'))\n        .count()\n}\n\n/// Vec \u3092\u5909\u63db\u3059\u308b\u7d14\u7c8b\u95a2\u6570\uff08\u65b0\u3057\u3044 Vec \u3092\u8fd4\u3059\uff09\nfn double_all(numbers: &amp;[i32]) -&gt; Vec&lt;i32&gt; {\n    numbers.iter().map(|x| x * 2).collect()\n}\n\n// \u5143\u306e\u30c7\u30fc\u30bf\u306f\u5909\u66f4\u3055\u308c\u306a\u3044\nlet numbers = vec![1, 2, 3];\nlet doubled = double_all(&amp;numbers);\nassert_eq!(doubled, vec![2, 4, 6]);\nassert_eq!(numbers, vec![1, 2, 3]);  // \u5143\u306e\u30c7\u30fc\u30bf\u306f\u305d\u306e\u307e\u307e\n</code></pre> <p></p>"},{"location":"rust/part-1/#26","title":"2.6 \u53c2\u7167\u900f\u904e\u6027","text":"<p>\u7d14\u7c8b\u95a2\u6570\u306f\u53c2\u7167\u900f\u904e\u6027\uff08Referential Transparency\uff09\u3092\u6301\u3061\u307e\u3059\u3002</p> <p>\u5f0f\u3092\u305d\u306e\u8a55\u4fa1\u7d50\u679c\u3067\u7f6e\u304d\u63db\u3048\u3066\u3082\u3001\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u610f\u5473\u304c\u5909\u308f\u3089\u306a\u3044\u3053\u3068</p> <pre><code>// word_score(\"Scala\") \u306f\u5e38\u306b 3 \u3092\u8fd4\u3059\nlet score1 = word_score(\"Scala\");\nlet score2 = word_score(\"Scala\");\n// score1 \u3068 score2 \u306f\u5e38\u306b\u540c\u3058\u5024\uff083\uff09\n\n// \u4ee5\u4e0b\u306e2\u3064\u306f\u540c\u7b49\nlet total1 = word_score(\"Scala\") + word_score(\"Java\");\nlet total2 = 3 + 2;  // word_score \u306e\u7d50\u679c\u3067\u7f6e\u304d\u63db\u3048\u53ef\u80fd\nassert_eq!(total1, total2);\n</code></pre> <p></p>"},{"location":"rust/part-1/#27","title":"2.7 \u7d14\u7c8b\u95a2\u6570\u306e\u30c6\u30b9\u30c8","text":"<p>\u7d14\u7c8b\u95a2\u6570\u306f\u975e\u5e38\u306b\u30c6\u30b9\u30c8\u3057\u3084\u3059\u3044\u3067\u3059\u3002</p> <pre><code>#[cfg(test)]\nmod tests {\n    use super::*;\n\n    #[test]\n    fn test_word_score() {\n        assert_eq!(word_score(\"Scala\"), 3);\n        assert_eq!(word_score(\"function\"), 8);\n        assert_eq!(word_score(\"aaa\"), 0);\n        assert_eq!(word_score(\"\"), 0);\n    }\n\n    #[test]\n    fn test_get_discount_percentage() {\n        assert_eq!(get_discount_percentage(&amp;[\"Apple\", \"Book\"]), 5);\n        assert_eq!(get_discount_percentage(&amp;[\"Apple\"]), 0);\n        assert_eq!(get_discount_percentage(&amp;[]), 0);\n    }\n\n    #[test]\n    fn test_referential_transparency() {\n        // \u53c2\u7167\u900f\u904e\u6027: \u540c\u3058\u547c\u3073\u51fa\u3057\u306f\u5e38\u306b\u540c\u3058\u7d50\u679c\n        let result1 = word_score(\"Scala\");\n        let result2 = word_score(\"Scala\");\n        assert_eq!(result1, result2);\n    }\n}\n</code></pre> <p></p>"},{"location":"rust/part-1/#_1","title":"\u307e\u3068\u3081","text":""},{"location":"rust/part-1/#part-i_1","title":"Part I \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"rust/part-1/#_2","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306f\u300c\u4f55\u3092\u3059\u308b\u304b\u300d\u3092\u5ba3\u8a00\u7684\u306b\u8a18\u8ff0\u3059\u308b</li> <li>\u7d14\u7c8b\u95a2\u6570\u306f\u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3059</li> <li>Rust \u306e\u30c7\u30d5\u30a9\u30eb\u30c8\u306f\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u3067\u3001FP \u3068\u76f8\u6027\u304c\u826f\u3044</li> <li>\u6240\u6709\u6a29\u30b7\u30b9\u30c6\u30e0\u304c\u7d14\u7c8b\u6027\u306e\u7dad\u6301\u3092\u652f\u63f4\u3059\u308b</li> <li>\u7d14\u7c8b\u95a2\u6570\u306f\u30c6\u30b9\u30c8\u304c\u975e\u5e38\u306b\u7c21\u5358</li> <li>\u53c2\u7167\u900f\u904e\u6027\u306b\u3088\u308a\u3001\u30b3\u30fc\u30c9\u306e\u7406\u89e3\u3068\u63a8\u8ad6\u304c\u5bb9\u6613\u306b\u306a\u308b</li> </ol>"},{"location":"rust/part-1/#scala","title":"Scala \u3068\u306e\u5bfe\u6bd4","text":"\u6982\u5ff5 Scala Rust \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u5909\u6570 <code>val</code> <code>let</code> \u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u5909\u6570 <code>var</code> <code>let mut</code> \u95a2\u6570\u5b9a\u7fa9 <code>def f(x: Int): Int</code> <code>fn f(x: i32) -&gt; i32</code> null \u5b89\u5168 <code>Option[T]</code> <code>Option&lt;T&gt;</code> \u6587\u5b57\u5217\u53c2\u7167 <code>String</code> <code>&amp;str</code> / <code>String</code> \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1 <code>match</code> <code>match</code>"},{"location":"rust/part-1/#_3","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part II \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li>\u30a4\u30c6\u30ec\u30fc\u30bf\u3092\u4f7f\u3063\u305f\u95a2\u6570\u578b\u30b9\u30bf\u30a4\u30eb</li> <li>\u9ad8\u968e\u95a2\u6570\uff08\u30af\u30ed\u30fc\u30b8\u30e3\uff09</li> <li><code>map</code>/<code>filter</code>/<code>fold</code> \u30d1\u30bf\u30fc\u30f3</li> <li>\u30a4\u30c6\u30ec\u30fc\u30bf\u30c1\u30a7\u30fc\u30f3</li> </ul>"},{"location":"rust/part-1/#_4","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"rust/part-1/#1_1","title":"\u554f\u984c 1: \u7d14\u7c8b\u95a2\u6570\u306e\u8b58\u5225","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u306e\u3046\u3061\u3001\u7d14\u7c8b\u95a2\u6570\u306f\u3069\u308c\u3067\u3059\u304b?</p> <pre><code>// A\nfn double(x: i32) -&gt; i32 {\n    x * 2\n}\n\n// B\nstatic mut COUNTER: i32 = 0;\nfn increment_counter() -&gt; i32 {\n    unsafe {\n        COUNTER += 1;\n        COUNTER\n    }\n}\n\n// C\nfn greet(name: &amp;str) -&gt; String {\n    format!(\"Hello, {}!\", name)\n}\n\n// D\nfn current_time() -&gt; u64 {\n    std::time::SystemTime::now()\n        .duration_since(std::time::UNIX_EPOCH)\n        .unwrap()\n        .as_secs()\n}\n</code></pre> \u89e3\u7b54  **A \u3068 C \u306f\u7d14\u7c8b\u95a2\u6570**\u3067\u3059\u3002  - A: \u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3057\u3001\u526f\u4f5c\u7528\u304c\u306a\u3044 - B: \u5916\u90e8\u5909\u6570 `COUNTER` \u3092\u5909\u66f4\u3059\u308b\u526f\u4f5c\u7528\u304c\u3042\u308b\uff08\u4e0d\u7d14\uff09 - C: \u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3057\u3001\u526f\u4f5c\u7528\u304c\u306a\u3044 - D: \u547c\u3073\u51fa\u3059\u305f\u3073\u306b\u7570\u306a\u308b\u5024\u3092\u8fd4\u3059\uff08\u4e0d\u7d14\uff09"},{"location":"rust/part-1/#2_1","title":"\u554f\u984c 2: \u7d14\u7c8b\u95a2\u6570\u3078\u306e\u66f8\u304d\u63db\u3048","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u7d14\u7c8b\u95a2\u6570\u306b\u66f8\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>struct Counter {\n    value: i32,\n}\n\nimpl Counter {\n    fn increment(&amp;mut self) -&gt; i32 {\n        self.value += 1;\n        self.value\n    }\n}\n</code></pre> \u89e3\u7b54 <pre><code>fn increment(value: i32) -&gt; i32 {\n    value + 1\n}\n\n// \u4f7f\u7528\u4f8b\nlet v1 = 0;\nlet v2 = increment(v1);  // 1\nlet v3 = increment(v2);  // 2\n</code></pre>  \u72b6\u614b\u3092\u5f15\u6570\u3068\u3057\u3066\u53d7\u3051\u53d6\u308a\u3001\u95a2\u6570\u306f\u65b0\u3057\u3044\u5024\u3092\u8fd4\u3059\u3060\u3051\u306b\u3057\u307e\u3059\u3002"},{"location":"rust/part-1/#3","title":"\u554f\u984c 3: \u30c6\u30b9\u30c8\u3092\u66f8\u304f","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u306b\u5bfe\u3059\u308b\u30c6\u30b9\u30c8\u30b1\u30fc\u30b9\u3092\u8003\u3048\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>fn is_even(n: i32) -&gt; bool {\n    n % 2 == 0\n}\n</code></pre> \u89e3\u7b54 <pre><code>#[cfg(test)]\nmod tests {\n    use super::*;\n\n    #[test]\n    fn test_is_even() {\n        // \u57fa\u672c\u30b1\u30fc\u30b9\n        assert!(is_even(0));\n        assert!(is_even(2));\n        assert!(is_even(4));\n\n        // \u5947\u6570\n        assert!(!is_even(1));\n        assert!(!is_even(3));\n\n        // \u8ca0\u306e\u6570\n        assert!(is_even(-2));\n        assert!(!is_even(-3));\n\n        // \u5883\u754c\u5024\n        assert!(!is_even(i32::MAX));\n        assert!(is_even(i32::MIN));\n    }\n}\n</code></pre>"},{"location":"rust/part-1/#4","title":"\u554f\u984c 4: \u30a4\u30c6\u30ec\u30fc\u30bf\u3092\u4f7f\u3063\u305f\u5909\u63db","text":"<p>\u4ee5\u4e0b\u306e\u547d\u4ee4\u578b\u30b3\u30fc\u30c9\u3092\u3001\u30a4\u30c6\u30ec\u30fc\u30bf\u3092\u4f7f\u3063\u305f\u95a2\u6570\u578b\u30b9\u30bf\u30a4\u30eb\u306b\u66f8\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>fn sum_of_squares(numbers: &amp;[i32]) -&gt; i32 {\n    let mut sum = 0;\n    for n in numbers {\n        sum += n * n;\n    }\n    sum\n}\n</code></pre> \u89e3\u7b54 <pre><code>fn sum_of_squares(numbers: &amp;[i32]) -&gt; i32 {\n    numbers.iter().map(|n| n * n).sum()\n}\n\n// \u30c6\u30b9\u30c8\nassert_eq!(sum_of_squares(&amp;[1, 2, 3]), 14);  // 1 + 4 + 9\nassert_eq!(sum_of_squares(&amp;[]), 0);\n</code></pre>"},{"location":"rust/part-2/","title":"Part II: \u95a2\u6570\u578b\u30b9\u30bf\u30a4\u30eb\u306e\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u6838\u5fc3\u3068\u306a\u308b\u30c6\u30af\u30cb\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059\u3002\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c\u3001\u9ad8\u968e\u95a2\u6570\u3001\u305d\u3057\u3066 <code>flat_map</code> \u306b\u3088\u308b\u8907\u96d1\u306a\u30c7\u30fc\u30bf\u5909\u63db\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"rust/part-2/#3","title":"\u7b2c3\u7ae0: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c","text":""},{"location":"rust/part-2/#31","title":"3.1 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u3068\u306f","text":"<p>Rust \u3067\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u5909\u6570\u306f\u4e0d\u5909\uff08\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\uff09\u3067\u3059\u3002\u3053\u308c\u306f\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u91cd\u8981\u306a\u539f\u5247\u3068\u4e00\u81f4\u3057\u3066\u3044\u307e\u3059\u3002</p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/rust/src/ch03_immutable_data.rs</code></p> <p></p> <pre><code>let list = vec![\"Apple\", \"Book\"];\n// list.push(\"Mango\"); // \u30b3\u30f3\u30d1\u30a4\u30eb\u30a8\u30e9\u30fc\uff01\u4e0d\u5909\u3060\u304b\u3089\n\n// \u65b0\u3057\u3044 Vec \u3092\u4f5c\u6210\u3059\u308b\nlet mut new_list = list.clone();\nnew_list.push(\"Mango\");\n\nassert_eq!(list.len(), 2);     // \u5143\u306e\u30ea\u30b9\u30c8\u306f\u5909\u308f\u3089\u306a\u3044\nassert_eq!(new_list.len(), 3); // \u65b0\u3057\u3044\u30ea\u30b9\u30c8\u306b\u8ffd\u52a0\u3055\u308c\u305f\n</code></pre>"},{"location":"rust/part-2/#32-vec","title":"3.2 Vec \u306e\u57fa\u672c\u64cd\u4f5c","text":""},{"location":"rust/part-2/#appended-","title":"appended - \u8981\u7d20\u306e\u8ffd\u52a0","text":"<p>\u5143\u306e Vec \u3092\u5909\u66f4\u305b\u305a\u3001\u65b0\u3057\u3044 Vec \u3092\u8fd4\u3059\u95a2\u6570\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002</p> <pre><code>pub fn appended&lt;T: Clone&gt;(list: &amp;[T], element: T) -&gt; Vec&lt;T&gt; {\n    let mut result = list.to_vec();\n    result.push(element);\n    result\n}\n\nlet apple_book = vec![\"Apple\", \"Book\"];\nlet apple_book_mango = appended(&amp;apple_book, \"Mango\");\n\nassert_eq!(apple_book.len(), 2);      // \u5143\u306e\u30ea\u30b9\u30c8\u306f\u5909\u308f\u3089\u306a\u3044\nassert_eq!(apple_book_mango.len(), 3);\nassert_eq!(apple_book_mango, vec![\"Apple\", \"Book\", \"Mango\"]);\n</code></pre>"},{"location":"rust/part-2/#slice-","title":"slice - \u30ea\u30b9\u30c8\u306e\u5207\u308a\u51fa\u3057","text":"<p>Rust \u306e\u30b9\u30e9\u30a4\u30b9\u3092\u4f7f\u3063\u3066\u90e8\u5206\u7684\u306a\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002</p> <pre><code>pub fn first_two&lt;T: Clone&gt;(list: &amp;[T]) -&gt; Vec&lt;T&gt; {\n    list.iter().take(2).cloned().collect()\n}\n\npub fn last_two&lt;T: Clone&gt;(list: &amp;[T]) -&gt; Vec&lt;T&gt; {\n    let len = list.len();\n    if len &lt;= 2 {\n        list.to_vec()\n    } else {\n        list[len - 2..].to_vec()\n    }\n}\n\nassert_eq!(first_two(&amp;[\"a\", \"b\", \"c\"]), vec![\"a\", \"b\"]);\nassert_eq!(last_two(&amp;[\"a\", \"b\", \"c\"]), vec![\"b\", \"c\"]);\n</code></pre> <p></p>"},{"location":"rust/part-2/#33","title":"3.3 \u30ea\u30b9\u30c8\u306e\u5909\u63db\u4f8b","text":"<pre><code>/// \u6700\u521d\u306e2\u8981\u7d20\u3092\u672b\u5c3e\u306b\u79fb\u52d5\npub fn move_first_two_to_end&lt;T: Clone&gt;(list: &amp;[T]) -&gt; Vec&lt;T&gt; {\n    if list.len() &lt;= 2 {\n        return list.to_vec();\n    }\n    let first_two = &amp;list[..2];\n    let without_first_two = &amp;list[2..];\n    appended_all(without_first_two, first_two)\n}\n\nassert_eq!(\n    move_first_two_to_end(&amp;[\"a\", \"b\", \"c\"]),\n    vec![\"c\", \"a\", \"b\"]\n);\n\n/// \u6700\u5f8c\u306e\u8981\u7d20\u306e\u524d\u306b\u65b0\u3057\u3044\u8981\u7d20\u3092\u633f\u5165\npub fn insert_before_last&lt;T: Clone&gt;(list: &amp;[T], element: T) -&gt; Vec&lt;T&gt; {\n    if list.is_empty() {\n        return vec![element];\n    }\n    let len = list.len();\n    let without_last = &amp;list[..len - 1];\n    let last = &amp;list[len - 1..];\n    let mut result = without_last.to_vec();\n    result.push(element);\n    result.extend_from_slice(last);\n    result\n}\n\nassert_eq!(insert_before_last(&amp;[\"a\", \"b\"], \"c\"), vec![\"a\", \"c\", \"b\"]);\n</code></pre>"},{"location":"rust/part-2/#34","title":"3.4 \u65c5\u7a0b\u306e\u518d\u8a08\u753b","text":"<p>\u65c5\u884c\u306e\u8a08\u753b\u5909\u66f4\u3092\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306b\u884c\u3046\u4f8b\u3067\u3059\u3002</p> <pre><code>pub fn replan&lt;'a&gt;(plan: &amp;[&amp;'a str], new_city: &amp;'a str, before_city: &amp;str) -&gt; Vec&lt;&amp;'a str&gt; {\n    let before_city_index = plan.iter().position(|&amp;c| c == before_city);\n\n    match before_city_index {\n        Some(index) =&gt; {\n            let cities_before = &amp;plan[..index];\n            let cities_after = &amp;plan[index..];\n            let mut result = cities_before.to_vec();\n            result.push(new_city);\n            result.extend_from_slice(cities_after);\n            result\n        }\n        None =&gt; {\n            let mut result = plan.to_vec();\n            result.push(new_city);\n            result\n        }\n    }\n}\n\nlet plan_a = vec![\"Paris\", \"Berlin\", \"Krak\u00f3w\"];\nlet plan_b = replan(&amp;plan_a, \"Vienna\", \"Krak\u00f3w\");\n\nassert_eq!(plan_b, vec![\"Paris\", \"Berlin\", \"Vienna\", \"Krak\u00f3w\"]);\nassert_eq!(plan_a, vec![\"Paris\", \"Berlin\", \"Krak\u00f3w\"]);  // \u5143\u306e\u8a08\u753b\u306f\u5909\u308f\u3089\u306a\u3044!\n</code></pre> <p></p>"},{"location":"rust/part-2/#35-string","title":"3.5 String \u3068\u30b9\u30e9\u30a4\u30b9\u306e\u985e\u4f3c\u6027","text":"<p>Rust \u306e <code>&amp;str</code> \u3068 <code>&amp;[T]</code> \u306f\u4f3c\u305f\u64cd\u4f5c\u304c\u3067\u304d\u307e\u3059\u3002</p> \u64cd\u4f5c Vec/\u30b9\u30e9\u30a4\u30b9 String/&amp;str \u7d50\u5408 <code>extend_from_slice</code> <code>push_str</code>, <code>+</code> \u5207\u308a\u51fa\u3057 <code>&amp;list[start..end]</code> <code>&amp;s[start..end]</code> \u30b5\u30a4\u30ba <code>len()</code> <code>len()</code> <pre><code>pub fn abbreviate(name: &amp;str) -&gt; String {\n    if let Some(space_index) = name.find(' ') {\n        let initial = &amp;name[..1];\n        let last_name = &amp;name[space_index + 1..];\n        format!(\"{}. {}\", initial, last_name)\n    } else {\n        name.to_string()\n    }\n}\n\nassert_eq!(abbreviate(\"Alonzo Church\"), \"A. Church\");\nassert_eq!(abbreviate(\"Alan Turing\"), \"A. Turing\");\n</code></pre>"},{"location":"rust/part-2/#4","title":"\u7b2c4\u7ae0: \u95a2\u6570\u3092\u5024\u3068\u3057\u3066\u6271\u3046","text":""},{"location":"rust/part-2/#41","title":"4.1 \u9ad8\u968e\u95a2\u6570\u3068\u306f","text":"<p>\u9ad8\u968e\u95a2\u6570\uff08Higher-Order Function\uff09\u3068\u306f\u3001\u4ee5\u4e0b\u306e\u3044\u305a\u308c\u304b\u3092\u6e80\u305f\u3059\u95a2\u6570\u3067\u3059:</p> <ol> <li>\u95a2\u6570\u3092\u5f15\u6570\u3068\u3057\u3066\u53d7\u3051\u53d6\u308b</li> <li>\u95a2\u6570\u3092\u623b\u308a\u5024\u3068\u3057\u3066\u8fd4\u3059</li> </ol> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/rust/src/ch04_higher_order.rs</code></p> <p></p>"},{"location":"rust/part-2/#42","title":"4.2 \u95a2\u6570\u3092\u5f15\u6570\u3068\u3057\u3066\u6e21\u3059","text":""},{"location":"rust/part-2/#sort_by-","title":"sort_by - \u30bd\u30fc\u30c8\u57fa\u6e96\u3092\u95a2\u6570\u3067\u6307\u5b9a","text":"<pre><code>pub fn score(word: &amp;str) -&gt; usize {\n    word.chars().filter(|&amp;c| c != 'a').count()\n}\n\npub fn sort_by_score&lt;T, F, K&gt;(list: &amp;[T], key_fn: F) -&gt; Vec&lt;T&gt;\nwhere\n    T: Clone,\n    F: Fn(&amp;T) -&gt; K,\n    K: Ord,\n{\n    let mut result = list.to_vec();\n    result.sort_by_key(|item| key_fn(item));\n    result\n}\n\nlet words = vec![\"rust\", \"java\"];\nlet sorted = sort_by_score(&amp;words, |w| score(w));\n\nassert_eq!(sorted, vec![\"java\", \"rust\"]);\n// java: 2\u6587\u5b57 (j, v), rust: 4\u6587\u5b57 (r, u, s, t)\n</code></pre>"},{"location":"rust/part-2/#map-","title":"map - \u5404\u8981\u7d20\u3092\u5909\u63db","text":"<p>Rust \u306e\u30a4\u30c6\u30ec\u30fc\u30bf\u306b\u306f <code>map</code> \u30e1\u30bd\u30c3\u30c9\u304c\u7d44\u307f\u8fbc\u307e\u308c\u3066\u3044\u307e\u3059\u3002</p> <pre><code>let lengths: Vec&lt;usize&gt; = vec![\"scala\", \"rust\", \"ada\"]\n    .iter()\n    .map(|s| s.len())\n    .collect();\nassert_eq!(lengths, vec![5, 4, 3]);\n\nlet doubles: Vec&lt;i32&gt; = vec![5, 1, 2, 4, 0]\n    .iter()\n    .map(|&amp;i| i * 2)\n    .collect();\nassert_eq!(doubles, vec![10, 2, 4, 8, 0]);\n</code></pre> <p></p>"},{"location":"rust/part-2/#filter-","title":"filter - \u6761\u4ef6\u306b\u5408\u3046\u8981\u7d20\u3092\u62bd\u51fa","text":"<pre><code>let odds: Vec&lt;i32&gt; = vec![5, 1, 2, 4, 0]\n    .iter()\n    .filter(|&amp;&amp;i| i % 2 == 1)\n    .cloned()\n    .collect();\nassert_eq!(odds, vec![5, 1]);\n\nlet large: Vec&lt;i32&gt; = vec![5, 1, 2, 4, 0]\n    .iter()\n    .filter(|&amp;&amp;i| i &gt; 4)\n    .cloned()\n    .collect();\nassert_eq!(large, vec![5]);\n</code></pre>"},{"location":"rust/part-2/#fold-","title":"fold - \u7573\u307f\u8fbc\u307f","text":"<p>Rust \u3067\u306f <code>fold</code> \u30e1\u30bd\u30c3\u30c9\u3092\u4f7f\u3044\u307e\u3059\uff08Scala \u306e <code>foldLeft</code> \u76f8\u5f53\uff09\u3002</p> <pre><code>let sum = vec![5, 1, 2, 4, 100]\n    .iter()\n    .fold(0, |acc, &amp;i| acc + i);\nassert_eq!(sum, 112);\n\nlet max = vec![5, 1, 2, 4, 15]\n    .iter()\n    .fold(i32::MIN, |max, &amp;i| if i &gt; max { i } else { max });\nassert_eq!(max, 15);\n</code></pre> <p></p>"},{"location":"rust/part-2/#43","title":"4.3 \u69cb\u9020\u4f53\u3068\u30d1\u30bf\u30fc\u30f3","text":"<pre><code>#[derive(Debug, Clone, PartialEq)]\npub struct ProgrammingLanguage {\n    pub name: String,\n    pub year: i32,\n}\n\nimpl ProgrammingLanguage {\n    pub fn new(name: &amp;str, year: i32) -&gt; Self {\n        Self {\n            name: name.to_string(),\n            year,\n        }\n    }\n}\n\nlet java = ProgrammingLanguage::new(\"Java\", 1995);\nlet scala = ProgrammingLanguage::new(\"Scala\", 2004);\nlet languages = vec![java.clone(), scala.clone()];\n\n// \u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u30a2\u30af\u30bb\u30b9\nlet names: Vec&lt;String&gt; = languages.iter().map(|lang| lang.name.clone()).collect();\nassert_eq!(names, vec![\"Java\", \"Scala\"]);\n\n// \u6761\u4ef6\u3067\u30d5\u30a3\u30eb\u30bf\nlet young: Vec&lt;_&gt; = languages.iter().filter(|lang| lang.year &gt; 2000).collect();\nassert_eq!(young.len(), 1);\n</code></pre>"},{"location":"rust/part-2/#44","title":"4.4 \u95a2\u6570\u3092\u8fd4\u3059\u95a2\u6570","text":"<p>Rust \u3067\u306f\u30af\u30ed\u30fc\u30b8\u30e3\u3092\u8fd4\u3059\u3053\u3068\u3067\u3001\u95a2\u6570\u3092\u8fd4\u3059\u95a2\u6570\u3092\u5b9f\u73fe\u3057\u307e\u3059\u3002</p> <pre><code>pub fn larger_than(n: i32) -&gt; impl Fn(i32) -&gt; bool {\n    move |i| i &gt; n\n}\n\nlet larger_than_4 = larger_than(4);\nassert!(larger_than_4(5));\nassert!(!larger_than_4(4));\n\n// filter \u3067\u4f7f\u3046\u5834\u5408\nlet large: Vec&lt;i32&gt; = vec![5, 1, 2, 4, 0]\n    .into_iter()\n    .filter(|&amp;x| larger_than(4)(x))\n    .collect();\nassert_eq!(large, vec![5]);\n</code></pre> <p></p>"},{"location":"rust/part-2/#45","title":"4.5 \u30ab\u30ea\u30fc\u5316","text":"<p>\u30ab\u30ea\u30fc\u5316\uff08Currying\uff09\u306f\u3001\u8907\u6570\u306e\u5f15\u6570\u3092\u53d6\u308b\u95a2\u6570\u3092\u3001\u5f15\u6570\u30921\u3064\u305a\u3064\u53d6\u308b\u95a2\u6570\u306e\u30c1\u30a7\u30fc\u30f3\u306b\u5909\u63db\u3059\u308b\u6280\u6cd5\u3067\u3059\u3002</p> <pre><code>// \u30ab\u30ea\u30fc\u5316\u3055\u308c\u305f\u95a2\u6570\npub fn curried_add(a: i32) -&gt; impl Fn(i32) -&gt; i32 {\n    move |b| a + b\n}\n\nlet add_10 = curried_add(10);\nassert_eq!(add_10(5), 15);\nassert_eq!(add_10(20), 30);\n</code></pre> <p></p>"},{"location":"rust/part-2/#46","title":"4.6 \u30ef\u30fc\u30c9\u30b9\u30b3\u30a2\u30ea\u30f3\u30b0\u306e\u4f8b","text":"<p>\u8907\u6570\u306e\u30b9\u30b3\u30a2\u30ea\u30f3\u30b0\u30ed\u30b8\u30c3\u30af\u3092\u7d44\u307f\u5408\u308f\u305b\u308b\u4f8b\u3067\u3059\u3002</p> <pre><code>pub fn score(word: &amp;str) -&gt; usize {\n    word.chars().filter(|&amp;c| c != 'a').count()\n}\n\npub fn bonus(word: &amp;str) -&gt; i32 {\n    if word.contains('c') { 5 } else { 0 }\n}\n\npub fn penalty(word: &amp;str) -&gt; i32 {\n    if word.contains('s') { 7 } else { 0 }\n}\n\npub fn ranked_words&lt;'a, F&gt;(words: &amp;[&amp;'a str], word_score: F) -&gt; Vec&lt;&amp;'a str&gt;\nwhere\n    F: Fn(&amp;str) -&gt; i32,\n{\n    let mut result: Vec&lt;&amp;'a str&gt; = words.to_vec();\n    result.sort_by(|a, b| word_score(b).cmp(&amp;word_score(a))); // \u964d\u9806\n    result\n}\n\nlet words = vec![\"ada\", \"haskell\", \"scala\", \"java\", \"rust\"];\n\n// \u57fa\u672c\u30b9\u30b3\u30a2\u3067\u30e9\u30f3\u30ad\u30f3\u30b0\nlet ranking1 = ranked_words(&amp;words, |w| score(w) as i32);\nassert_eq!(ranking1, vec![\"haskell\", \"rust\", \"scala\", \"java\", \"ada\"]);\n\n// \u30dc\u30fc\u30ca\u30b9\u4ed8\u304d\u30b9\u30b3\u30a2\u3067\u30e9\u30f3\u30ad\u30f3\u30b0\nlet ranking2 = ranked_words(&amp;words, |w| score(w) as i32 + bonus(w));\nassert_eq!(ranking2, vec![\"scala\", \"haskell\", \"rust\", \"java\", \"ada\"]);\n</code></pre>"},{"location":"rust/part-2/#5-flat_map","title":"\u7b2c5\u7ae0: flat_map \u3068\u30cd\u30b9\u30c8\u69cb\u9020","text":""},{"location":"rust/part-2/#51-flatten-flat_map","title":"5.1 flatten \u3068 flat_map","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/rust/src/ch05_flatmap.rs</code></p>"},{"location":"rust/part-2/#flatten-","title":"flatten - \u30cd\u30b9\u30c8\u3057\u305f\u30a4\u30c6\u30ec\u30fc\u30bf\u3092\u5e73\u5766\u5316","text":"<pre><code>#[derive(Debug, Clone, PartialEq)]\npub struct Book {\n    pub title: String,\n    pub authors: Vec&lt;String&gt;,\n}\n\nlet books = vec![\n    Book::new(\"FP in Scala\", vec![\"Chiusano\", \"Bjarnason\"]),\n    Book::new(\"The Hobbit\", vec![\"Tolkien\"]),\n];\n\n// map \u3060\u3051\u3060\u3068\u30cd\u30b9\u30c8\u3059\u308b\nlet author_lists: Vec&lt;Vec&lt;String&gt;&gt; = books.iter().map(|b| b.authors.clone()).collect();\n// [[\"Chiusano\", \"Bjarnason\"], [\"Tolkien\"]]\n\n// flatten \u3067\u5e73\u5766\u5316\nlet authors: Vec&lt;String&gt; = author_lists.into_iter().flatten().collect();\n// [\"Chiusano\", \"Bjarnason\", \"Tolkien\"]\n</code></pre>"},{"location":"rust/part-2/#flat_map-map-flatten","title":"flat_map = map + flatten","text":"<pre><code>// flat_map \u3067\u540c\u3058\u3053\u3068\u30921\u884c\u3067\nlet authors: Vec&lt;String&gt; = books\n    .iter()\n    .flat_map(|book| book.authors.clone())\n    .collect();\n\nassert_eq!(authors, vec![\"Chiusano\", \"Bjarnason\", \"Tolkien\"]);\n</code></pre>"},{"location":"rust/part-2/#52-flat_map","title":"5.2 flat_map \u306b\u3088\u308b\u30ea\u30b9\u30c8\u30b5\u30a4\u30ba\u306e\u5909\u5316","text":"<pre><code>// \u8981\u7d20\u6570\u304c\u5897\u3048\u308b\nlet expanded: Vec&lt;i32&gt; = vec![1, 2, 3]\n    .iter()\n    .flat_map(|&amp;i| vec![i, i + 10])\n    .collect();\nassert_eq!(expanded, vec![1, 11, 2, 12, 3, 13]);\n\n// \u8981\u7d20\u6570\u304c\u540c\u3058\uff08map \u3068\u540c\u7b49\uff09\nlet doubled: Vec&lt;i32&gt; = vec![1, 2, 3]\n    .iter()\n    .flat_map(|&amp;i| vec![i * 2])\n    .collect();\nassert_eq!(doubled, vec![2, 4, 6]);\n\n// \u8981\u7d20\u6570\u304c\u6e1b\u308b\uff08filter \u306e\u4ee3\u66ff\uff09\nlet evens: Vec&lt;i32&gt; = vec![1, 2, 3]\n    .iter()\n    .flat_map(|&amp;i| if i % 2 == 0 { vec![i] } else { vec![] })\n    .collect();\nassert_eq!(evens, vec![2]);\n</code></pre>"},{"location":"rust/part-2/#53-flat_map","title":"5.3 \u30cd\u30b9\u30c8\u3057\u305f flat_map","text":"<p>\u8907\u6570\u306e\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u3092\u7d44\u307f\u5408\u308f\u305b\u308b\u5834\u5408\u3001flat_map \u3092\u30cd\u30b9\u30c8\u3057\u307e\u3059\u3002</p> <pre><code>#[derive(Debug, Clone, PartialEq)]\npub struct Movie {\n    pub title: String,\n}\n\npub fn book_adaptations(author: &amp;str) -&gt; Vec&lt;Movie&gt; {\n    if author == \"Tolkien\" {\n        vec![\n            Movie::new(\"An Unexpected Journey\"),\n            Movie::new(\"The Desolation of Smaug\"),\n        ]\n    } else {\n        vec![]\n    }\n}\n\nlet books = vec![\n    Book::new(\"FP in Scala\", vec![\"Chiusano\", \"Bjarnason\"]),\n    Book::new(\"The Hobbit\", vec![\"Tolkien\"]),\n];\n\n// \u30cd\u30b9\u30c8\u3057\u305f flat_map\nlet recommendations: Vec&lt;String&gt; = books\n    .iter()\n    .flat_map(|book| {\n        let book_title = book.title.clone();\n        book.authors.iter().flat_map(move |author| {\n            let author_name = author.clone();\n            let book_title_inner = book_title.clone();\n            book_adaptations(&amp;author_name).into_iter().map(move |movie| {\n                format!(\n                    \"You may like {}, because you liked {}'s {}\",\n                    movie.title, author_name, book_title_inner\n                )\n            })\n        })\n    })\n    .collect();\n\n// \u7d50\u679c:\n// [\n//   \"You may like An Unexpected Journey, because you liked Tolkien's The Hobbit\",\n//   \"You may like The Desolation of Smaug, because you liked Tolkien's The Hobbit\"\n// ]\n</code></pre> <p></p>"},{"location":"rust/part-2/#54-rust-for","title":"5.4 \u30a4\u30c6\u30ec\u30fc\u30bf\u30c1\u30a7\u30fc\u30f3\uff08Rust \u306e for \u5185\u5305\u8868\u8a18\u76f8\u5f53\uff09","text":"<p>Scala \u306e for \u5185\u5305\u8868\u8a18\u306b\u76f8\u5f53\u3059\u308b\u3082\u306e\u3068\u3057\u3066\u3001Rust \u3067\u306f\u30a4\u30c6\u30ec\u30fc\u30bf\u30c1\u30a7\u30fc\u30f3\u3092\u4f7f\u3044\u307e\u3059\u3002</p> <pre><code>// \u5168\u7d44\u307f\u5408\u308f\u305b\u3092\u751f\u6210\npub fn all_combinations(xs: &amp;[i32], ys: &amp;[i32]) -&gt; Vec&lt;i32&gt; {\n    xs.iter()\n        .flat_map(|&amp;x| ys.iter().map(move |&amp;y| x + y))\n        .collect()\n}\n\nlet result = all_combinations(&amp;[1, 2], &amp;[10, 20]);\nassert_eq!(result, vec![11, 21, 12, 22]);\n\n// 3\u3064\u306e\u30ea\u30b9\u30c8\u306e\u7d44\u307f\u5408\u308f\u305b\npub fn three_way_combinations(xs: &amp;[i32], ys: &amp;[i32], zs: &amp;[i32]) -&gt; Vec&lt;i32&gt; {\n    xs.iter()\n        .flat_map(|&amp;x| {\n            ys.iter()\n                .flat_map(move |&amp;y| zs.iter().map(move |&amp;z| x + y + z))\n        })\n        .collect()\n}\n\nlet result = three_way_combinations(&amp;[1, 2], &amp;[10, 20], &amp;[100, 200]);\nassert_eq!(result, vec![111, 211, 121, 221, 112, 212, 122, 222]);\n</code></pre>"},{"location":"rust/part-2/#55","title":"5.5 \u5186\u5185\u306e\u70b9\u306e\u5224\u5b9a","text":"<p>\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u3082\u542b\u3081\u305f\u4f8b\u3067\u3059\u3002</p> <pre><code>#[derive(Debug, Clone, Copy, PartialEq)]\npub struct Point {\n    pub x: i32,\n    pub y: i32,\n}\n\npub fn is_inside(point: &amp;Point, radius: i32) -&gt; bool {\n    radius * radius &gt;= point.x * point.x + point.y * point.y\n}\n\nlet points = vec![Point::new(5, 2), Point::new(1, 1)];\nlet radiuses = vec![2, 1];\n\n// \u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u3057\u3066\u5186\u5185\u306e\u70b9\u306e\u307f\u3092\u8fd4\u3059\nlet inside: Vec&lt;String&gt; = radiuses\n    .iter()\n    .flat_map(|&amp;r| {\n        points\n            .iter()\n            .filter(move |point| is_inside(point, r))\n            .map(move |point| {\n                format!(\"Point({},{}) is within a radius of {}\", point.x, point.y, r)\n            })\n    })\n    .collect();\n\nassert_eq!(inside, vec![\"Point(1,1) is within a radius of 2\"]);\n</code></pre>"},{"location":"rust/part-2/#flat_map-filter","title":"flat_map \u3067\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\uff08filter \u306e\u4ee3\u66ff\uff09","text":"<pre><code>// flat_map \u3092\u4f7f\u3063\u305f\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\nlet inside: Vec&lt;String&gt; = radiuses\n    .iter()\n    .flat_map(|&amp;r| {\n        points.iter().flat_map(move |point| {\n            if is_inside(point, r) {\n                vec![format!(\n                    \"Point({},{}) is within a radius of {}\",\n                    point.x, point.y, r\n                )]\n            } else {\n                vec![]\n            }\n        })\n    })\n    .collect();\n</code></pre>"},{"location":"rust/part-2/#56","title":"5.6 \u578b\u306e\u5909\u5316","text":"<p>\u30a4\u30c6\u30ec\u30fc\u30bf\u306e\u6700\u521d\u306e\u578b\u304c\u7d50\u679c\u306e\u578b\u3092\u6c7a\u5b9a\u3057\u307e\u3059\u3002</p> <pre><code>use std::collections::HashSet;\n\n// Vec \u304b\u3089\u59cb\u307e\u308b\u3068 Vec \u304c\u8fd4\u308b\nlet list_result: Vec&lt;i32&gt; = vec![1, 2]\n    .into_iter()\n    .flat_map(|a| vec![2, 1].into_iter().map(move |b| a * b))\n    .collect();\nassert_eq!(list_result, vec![2, 1, 4, 2]); // \u91cd\u8907\u3042\u308a\n\n// HashSet \u3092\u4f7f\u3046\u3068\u91cd\u8907\u304c\u9664\u53bb\u3055\u308c\u308b\nlet set_a: HashSet&lt;i32&gt; = [1, 2].into_iter().collect();\nlet list_b = vec![2, 1];\n\nlet set_result: HashSet&lt;i32&gt; = set_a\n    .into_iter()\n    .flat_map(|a| list_b.iter().map(move |&amp;b| a * b))\n    .collect();\nassert_eq!(set_result.len(), 3); // \u91cd\u8907\u306a\u3057: {1, 2, 4}\n</code></pre>"},{"location":"rust/part-2/#_1","title":"\u307e\u3068\u3081","text":""},{"location":"rust/part-2/#part-ii_1","title":"Part II \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"rust/part-2/#scala","title":"Scala \u3068\u306e\u6bd4\u8f03","text":"\u6982\u5ff5 Scala Rust \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb <code>val</code> (\u30c7\u30d5\u30a9\u30eb\u30c8) <code>let</code> (\u30c7\u30d5\u30a9\u30eb\u30c8) \u30ea\u30b9\u30c8\u8ffd\u52a0 <code>list.appended(elem)</code> \u81ea\u4f5c <code>appended()</code> or <code>Vec::push</code> \u30b9\u30e9\u30a4\u30b9 <code>list.slice(start, end)</code> <code>&amp;list[start..end]</code> \u9ad8\u968e\u95a2\u6570 <code>list.map(f)</code> <code>iter().map(f).collect()</code> \u30d5\u30a3\u30eb\u30bf <code>list.filter(p)</code> <code>iter().filter(p).collect()</code> \u7573\u307f\u8fbc\u307f <code>list.foldLeft(init)(f)</code> <code>iter().fold(init, f)</code> \u95a2\u6570\u3092\u8fd4\u3059 <code>def f(x: Int): Int =&gt; Boolean</code> <code>fn f(x: i32) -&gt; impl Fn(i32) -&gt; bool</code> for \u5185\u5305\u8868\u8a18 <code>for { ... } yield ...</code> \u30a4\u30c6\u30ec\u30fc\u30bf\u30c1\u30a7\u30fc\u30f3 flat_map <code>list.flatMap(f)</code> <code>iter().flat_map(f).collect()</code>"},{"location":"rust/part-2/#_2","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"\u7ae0 \u4e3b\u8981\u6982\u5ff5 \u30ad\u30fc\u64cd\u4f5c \u7b2c3\u7ae0 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb \u30b9\u30e9\u30a4\u30b9 <code>[..]</code>, <code>to_vec()</code>, <code>extend_from_slice</code> \u7b2c4\u7ae0 \u9ad8\u968e\u95a2\u6570 <code>map</code>, <code>filter</code>, <code>fold</code>, <code>sort_by_key</code> \u7b2c5\u7ae0 \u5e73\u5766\u5316 <code>flatten</code>, <code>flat_map</code>, \u30a4\u30c6\u30ec\u30fc\u30bf\u30c1\u30a7\u30fc\u30f3"},{"location":"rust/part-2/#_3","title":"\u91cd\u8981\u306a\u6cd5\u5247","text":"<ol> <li>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf: Rust \u3067\u306f\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u4e0d\u5909\u3002\u65b0\u3057\u3044\u30c7\u30fc\u30bf\u3092\u4f5c\u6210\u3059\u308b</li> <li>\u95a2\u6570\u306f\u5024: \u30af\u30ed\u30fc\u30b8\u30e3\u3092\u5f15\u6570\u3068\u3057\u3066\u6e21\u3057\u305f\u308a\u3001\u623b\u308a\u5024\u3068\u3057\u3066\u8fd4\u3057\u305f\u308a\u3067\u304d\u308b</li> <li>flat_map \u30d1\u30bf\u30fc\u30f3: \u30cd\u30b9\u30c8\u3057\u305f\u69cb\u9020\u3092\u5e73\u5766\u5316\u3057\u306a\u304c\u3089\u5909\u63db\u3059\u308b</li> <li>\u30a4\u30c6\u30ec\u30fc\u30bf\u30c1\u30a7\u30fc\u30f3: Scala \u306e for \u5185\u5305\u8868\u8a18\u306b\u76f8\u5f53\u3059\u308b\u8868\u73fe\u529b\u3092\u6301\u3064</li> </ol>"},{"location":"rust/part-2/#_4","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part III \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li><code>Option&lt;T&gt;</code> \u578b\u306b\u3088\u308b\u5b89\u5168\u306a null \u30cf\u30f3\u30c9\u30ea\u30f3\u30b0</li> <li><code>Result&lt;T, E&gt;</code> \u578b\u3068\u30a8\u30e9\u30fc\u51e6\u7406</li> </ul>"},{"location":"rust/part-2/#_5","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"rust/part-2/#1","title":"\u554f\u984c 1: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u64cd\u4f5c","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u30ea\u30b9\u30c8\u306e\u4e2d\u592e\u306b\u8981\u7d20\u3092\u633f\u5165\u3059\u308b\u95a2\u6570\u3067\u3059\u3002</p> <pre><code>fn insert_at_middle&lt;T: Clone&gt;(list: &amp;[T], element: T) -&gt; Vec&lt;T&gt; {\n    todo!()\n}\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert_eq!(insert_at_middle(&amp;[\"a\", \"b\", \"c\", \"d\"], \"X\"), vec![\"a\", \"b\", \"X\", \"c\", \"d\"]);\nassert_eq!(insert_at_middle(&amp;[\"a\", \"b\"], \"X\"), vec![\"a\", \"X\", \"b\"]);\n</code></pre> \u89e3\u7b54 <pre><code>fn insert_at_middle&lt;T: Clone&gt;(list: &amp;[T], element: T) -&gt; Vec&lt;T&gt; {\n    let middle = list.len() / 2;\n    let before = &amp;list[..middle];\n    let after = &amp;list[middle..];\n    let mut result = before.to_vec();\n    result.push(element);\n    result.extend_from_slice(after);\n    result\n}\n</code></pre>"},{"location":"rust/part-2/#2","title":"\u554f\u984c 2: \u9ad8\u968e\u95a2\u6570","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u6761\u4ef6\u3092\u6e80\u305f\u3059\u8981\u7d20\u306e\u6570\u3092\u30ab\u30a6\u30f3\u30c8\u3059\u308b\u95a2\u6570\u3067\u3059\u3002</p> <pre><code>fn count_where&lt;T, F&gt;(list: &amp;[T], predicate: F) -&gt; usize\nwhere\n    F: Fn(&amp;T) -&gt; bool,\n{\n    todo!()\n}\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert_eq!(count_where(&amp;[1, 2, 3, 4, 5], |&amp;i| i &gt; 3), 2);\nassert_eq!(count_where(&amp;[\"a\", \"bb\", \"ccc\"], |s| s.len() &gt; 1), 2);\n</code></pre> \u89e3\u7b54 <pre><code>fn count_where&lt;T, F&gt;(list: &amp;[T], predicate: F) -&gt; usize\nwhere\n    F: Fn(&amp;T) -&gt; bool,\n{\n    list.iter().filter(|item| predicate(item)).count()\n}\n\n// \u307e\u305f\u306f fold \u3092\u4f7f\u3063\u3066\nfn count_where2&lt;T, F&gt;(list: &amp;[T], predicate: F) -&gt; usize\nwhere\n    F: Fn(&amp;T) -&gt; bool,\n{\n    list.iter().fold(0, |count, elem| {\n        if predicate(elem) { count + 1 } else { count }\n    })\n}\n</code></pre>"},{"location":"rust/part-2/#3_1","title":"\u554f\u984c 3: \u30a4\u30c6\u30ec\u30fc\u30bf\u30c1\u30a7\u30fc\u30f3","text":"<p>\u4ee5\u4e0b\u306e\u30cd\u30b9\u30c8\u3057\u305f flat_map \u3092\u8aad\u307f\u3084\u3059\u304f\u6574\u7406\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>let result: Vec&lt;i32&gt; = vec![1, 2]\n    .iter()\n    .flat_map(|&amp;x| {\n        vec![10, 20]\n            .iter()\n            .flat_map(move |&amp;y| {\n                vec![100, 200]\n                    .iter()\n                    .map(move |&amp;z| x + y + z)\n            })\n    })\n    .collect();\n</code></pre> \u89e3\u7b54 <pre><code>// \u30a4\u30c6\u30ec\u30fc\u30bf\u30a2\u30c0\u30d7\u30bf iproduct \u3092\u4f7f\u3046\u65b9\u6cd5\uff08itertools \u30af\u30ec\u30fc\u30c8\uff09\nuse itertools::iproduct;\n\nlet result: Vec&lt;i32&gt; = iproduct!(\n    vec![1, 2],\n    vec![10, 20],\n    vec![100, 200]\n)\n.map(|(x, y, z)| x + y + z)\n.collect();\n\n// \u307e\u305f\u306f\u3001\u30d8\u30eb\u30d1\u30fc\u95a2\u6570\u3092\u4f7f\u3046\nfn three_way_combinations(xs: &amp;[i32], ys: &amp;[i32], zs: &amp;[i32]) -&gt; Vec&lt;i32&gt; {\n    xs.iter()\n        .flat_map(|&amp;x| {\n            ys.iter()\n                .flat_map(move |&amp;y| zs.iter().map(move |&amp;z| x + y + z))\n        })\n        .collect()\n}\n\nlet result = three_way_combinations(&amp;[1, 2], &amp;[10, 20], &amp;[100, 200]);\n// \u7d50\u679c: [111, 211, 121, 221, 112, 212, 122, 222]\n</code></pre>"},{"location":"rust/part-2/#4-flat_map","title":"\u554f\u984c 4: flat_map \u306b\u3088\u308b\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0","text":"<p>flat_map \u3060\u3051\u3067\u5076\u6570\u306e\u307f\u3092\u62bd\u51fa\u3059\u308b\u30b3\u30fc\u30c9\u3092\u66f8\u3044\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>let numbers = vec![1, 2, 3, 4, 5, 6];\n// \u5076\u6570\u306e\u307f\u3092\u62bd\u51fa: vec![2, 4, 6]\n</code></pre> \u89e3\u7b54 <pre><code>let even_numbers: Vec&lt;i32&gt; = numbers\n    .iter()\n    .flat_map(|&amp;n| if n % 2 == 0 { vec![n] } else { vec![] })\n    .collect();\n\n// \u307e\u305f\u306f\u95a2\u6570\u306b\u5206\u96e2\nfn even_filter(n: &amp;i32) -&gt; Vec&lt;i32&gt; {\n    if n % 2 == 0 { vec![*n] } else { vec![] }\n}\n\nlet even_numbers2: Vec&lt;i32&gt; = numbers.iter().flat_map(even_filter).collect();\n</code></pre>"},{"location":"rust/part-3/","title":"Part III: \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3068 Option/Result","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3092\u5b66\u3073\u307e\u3059\u3002<code>null</code> \u3084\u4f8b\u5916\u306b\u983c\u3089\u305a\u3001<code>Option&lt;T&gt;</code> \u3068 <code>Result&lt;T, E&gt;</code> \u3092\u4f7f\u3063\u3066\u578b\u5b89\u5168\u306b\u30a8\u30e9\u30fc\u3092\u6271\u3046\u65b9\u6cd5\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"rust/part-3/#6-option","title":"\u7b2c6\u7ae0: Option \u578b\u306b\u3088\u308b\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":""},{"location":"rust/part-3/#61-option","title":"6.1 \u306a\u305c Option \u304c\u5fc5\u8981\u304b","text":"<p>\u5f93\u6765\u306e\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u306b\u306f\u554f\u984c\u304c\u3042\u308a\u307e\u3059\u3002</p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/rust/src/ch06_option.rs</code></p> <p></p>"},{"location":"rust/part-3/#unwrap","title":"\u554f\u984c\u306e\u3042\u308b\u30b3\u30fc\u30c9\uff08unwrap \u3092\u4f7f\u7528\uff09","text":"<pre><code>// panic! \u304c\u767a\u751f\u3059\u308b\u53ef\u80fd\u6027\u3042\u308a\npub fn parse_show_unsafe(raw_show: &amp;str) -&gt; (&amp;str, i32, i32) {\n    let bracket_open = raw_show.find('(').unwrap();  // \u30d1\u30cb\u30c3\u30af\u306e\u53ef\u80fd\u6027\n    let bracket_close = raw_show.find(')').unwrap(); // \u30d1\u30cb\u30c3\u30af\u306e\u53ef\u80fd\u6027\n    let dash = raw_show.find('-').unwrap();          // \u30d1\u30cb\u30c3\u30af\u306e\u53ef\u80fd\u6027\n\n    let name = raw_show[..bracket_open].trim();\n    let year_start: i32 = raw_show[bracket_open + 1..dash].parse().unwrap();\n    let year_end: i32 = raw_show[dash + 1..bracket_close].parse().unwrap();\n\n    (name, year_start, year_end)\n}\n\n// \u6b63\u5e38\u30b1\u30fc\u30b9\nparse_show_unsafe(\"Breaking Bad (2008-2013)\");  // OK\n\n// \u7570\u5e38\u30b1\u30fc\u30b9 \u2192 panic!\nparse_show_unsafe(\"Chernobyl (2019)\");  // \u30d1\u30cb\u30c3\u30af\uff01 '-' \u304c\u306a\u3044\nparse_show_unsafe(\"The Wire 2002-2008\"); // \u30d1\u30cb\u30c3\u30af\uff01 '(' \u304c\u306a\u3044\n</code></pre>"},{"location":"rust/part-3/#62-option","title":"6.2 Option \u306e\u57fa\u672c","text":"<p><code>Option&lt;T&gt;</code> \u306f\u300c<code>T</code> \u578b\u306e\u5024\u304c\u3042\u308b\u304b\u3001\u306a\u3044\u304b\u300d\u3092\u8868\u3059\u578b\u3067\u3059\u3002</p> <p></p> <pre><code>#[derive(Debug, Clone, PartialEq)]\npub struct TvShow {\n    pub title: String,\n    pub start: i32,\n    pub end: i32,\n}\n\nimpl TvShow {\n    pub fn new(title: &amp;str, start: i32, end: i32) -&gt; Self {\n        Self {\n            title: title.to_string(),\n            start,\n            end,\n        }\n    }\n}\n</code></pre>"},{"location":"rust/part-3/#63-tv","title":"6.3 TV\u756a\u7d44\u306e\u30d1\u30fc\u30b9\u4f8b","text":"<p>Option \u3092\u4f7f\u3063\u3066\u5b89\u5168\u306b\u30d1\u30fc\u30b9\u3059\u308b\u65b9\u6cd5\u3092\u5b66\u3073\u307e\u3059\u3002</p>"},{"location":"rust/part-3/#_1","title":"\u5c0f\u3055\u306a\u95a2\u6570\u304b\u3089\u7d44\u307f\u7acb\u3066\u308b","text":"<pre><code>/// \u756a\u7d44\u540d\u3092\u62bd\u51fa\npub fn extract_name(raw_show: &amp;str) -&gt; Option&lt;String&gt; {\n    let bracket_open = raw_show.find('(')?;  // ? \u6f14\u7b97\u5b50\u3067 None \u3092\u4f1d\u64ad\n    if bracket_open &gt; 0 {\n        Some(raw_show[..bracket_open].trim().to_string())\n    } else {\n        None\n    }\n}\n\n/// \u958b\u59cb\u5e74\u3092\u62bd\u51fa\npub fn extract_year_start(raw_show: &amp;str) -&gt; Option&lt;i32&gt; {\n    let bracket_open = raw_show.find('(')?;\n    let dash = raw_show.find('-')?;\n\n    if dash &gt; bracket_open + 1 {\n        let year_str = &amp;raw_show[bracket_open + 1..dash];\n        year_str.parse().ok()  // parse \u306e Result \u3092 Option \u306b\u5909\u63db\n    } else {\n        None\n    }\n}\n\n/// \u7d42\u4e86\u5e74\u3092\u62bd\u51fa\npub fn extract_year_end(raw_show: &amp;str) -&gt; Option&lt;i32&gt; {\n    let dash = raw_show.find('-')?;\n    let bracket_close = raw_show.find(')')?;\n\n    if bracket_close &gt; dash + 1 {\n        let year_str = &amp;raw_show[dash + 1..bracket_close];\n        year_str.parse().ok()\n    } else {\n        None\n    }\n}\n</code></pre>"},{"location":"rust/part-3/#64","title":"6.4 ? \u6f14\u7b97\u5b50\u306b\u3088\u308b\u5408\u6210","text":"<p>Rust \u306e <code>?</code> \u6f14\u7b97\u5b50\u306f\u3001Scala \u306e for \u5185\u5305\u8868\u8a18\u306b\u76f8\u5f53\u3057\u307e\u3059\u3002</p> <pre><code>/// TV\u756a\u7d44\u3092\u30d1\u30fc\u30b9\uff08Option \u7248\uff09\npub fn parse_show(raw_show: &amp;str) -&gt; Option&lt;TvShow&gt; {\n    let name = extract_name(raw_show)?;\n    let year_start = extract_year_start(raw_show)\n        .or_else(|| extract_single_year(raw_show))?;\n    let year_end = extract_year_end(raw_show)\n        .or_else(|| extract_single_year(raw_show))?;\n\n    Some(TvShow::new(&amp;name, year_start, year_end))\n}\n\n// \u6b63\u5e38\u30b1\u30fc\u30b9\nparse_show(\"Breaking Bad (2008-2013)\");  // Some(TvShow { ... })\nparse_show(\"Chernobyl (2019)\");          // Some(TvShow { ... })\n\n// \u7570\u5e38\u30b1\u30fc\u30b9 \u2192 None \u304c\u8fd4\u3055\u308c\u308b\uff08\u30d1\u30cb\u30c3\u30af\u306a\u3057\uff09\nparse_show(\"The Wire 2002-2008\");         // None\n</code></pre>"},{"location":"rust/part-3/#65-or_else","title":"6.5 or_else \u306b\u3088\u308b\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af","text":"<p><code>or_else</code> \u3092\u4f7f\u3063\u3066\u3001\u6700\u521d\u306e Option \u304c <code>None</code> \u306e\u5834\u5408\u306b\u4ee3\u66ff\u3092\u8a66\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>let seven: Option&lt;i32&gt; = Some(7);\nlet eight: Option&lt;i32&gt; = Some(8);\nlet none: Option&lt;i32&gt; = None;\n\nassert_eq!(seven.or(eight), Some(7));   // \u6700\u521d\u304c Some \u306a\u306e\u3067\u305d\u306e\u307e\u307e\nassert_eq!(none.or(eight), Some(8));    // \u6700\u521d\u304c None \u306a\u306e\u3067\u4ee3\u66ff\u3092\u4f7f\u7528\nassert_eq!(seven.or(none), Some(7));\nassert_eq!(none.or(none), None);\n</code></pre>"},{"location":"rust/part-3/#_2","title":"\u5358\u5e74\u306e\u756a\u7d44\u306b\u5bfe\u5fdc\u3059\u308b","text":"<pre><code>/// \u5358\u5e74\u306e\u756a\u7d44\u304b\u3089\u5e74\u3092\u62bd\u51fa\uff08\u4f8b: \"Chernobyl (2019)\"\uff09\npub fn extract_single_year(raw_show: &amp;str) -&gt; Option&lt;i32&gt; {\n    // \u30c0\u30c3\u30b7\u30e5\u304c\u3042\u308b\u5834\u5408\u306f\u5358\u5e74\u3067\u306f\u306a\u3044\n    if raw_show.contains('-') {\n        return None;\n    }\n\n    let bracket_open = raw_show.find('(')?;\n    let bracket_close = raw_show.find(')')?;\n\n    if bracket_close &gt; bracket_open + 1 {\n        let year_str = &amp;raw_show[bracket_open + 1..bracket_close];\n        year_str.parse().ok()\n    } else {\n        None\n    }\n}\n\n// \u3053\u308c\u3067\u5358\u5e74\u306e\u756a\u7d44\u3082\u30d1\u30fc\u30b9\u3067\u304d\u308b\nparse_show(\"Chernobyl (2019)\");  // Some(TvShow { title: \"Chernobyl\", start: 2019, end: 2019 })\n</code></pre>"},{"location":"rust/part-3/#66-option","title":"6.6 Option \u306e\u4e3b\u8981\u30e1\u30bd\u30c3\u30c9","text":"\u30e1\u30bd\u30c3\u30c9 \u8aac\u660e \u4f8b <code>map</code> \u5024\u304c\u3042\u308c\u3070\u5909\u63db <code>Some(5).map(\\|x\\| x * 2)</code> \u2192 <code>Some(10)</code> <code>and_then</code> \u5024\u304c\u3042\u308c\u3070 Option \u3092\u8fd4\u3059\u95a2\u6570\u3092\u9069\u7528 <code>Some(5).and_then(\\|x\\| Some(x * 2))</code> \u2192 <code>Some(10)</code> <code>filter</code> \u6761\u4ef6\u3092\u6e80\u305f\u3055\u306a\u3051\u308c\u3070 None <code>Some(5).filter(\\|&amp;x\\| x &gt; 10)</code> \u2192 <code>None</code> <code>or</code> / <code>or_else</code> None \u306a\u3089\u4ee3\u66ff\u3092\u4f7f\u7528 <code>None.or(Some(5))</code> \u2192 <code>Some(5)</code> <code>unwrap_or</code> None \u306a\u3089\u30c7\u30d5\u30a9\u30eb\u30c8\u5024 <code>None.unwrap_or(0)</code> \u2192 <code>0</code> <code>ok_or</code> Result \u306b\u5909\u63db <code>Some(5).ok_or(\"error\")</code> \u2192 <code>Ok(5)</code> <pre><code>let year: Option&lt;i32&gt; = Some(996);\nlet no_year: Option&lt;i32&gt; = None;\n\n// map\nassert_eq!(year.map(|y| y * 2), Some(1992));\nassert_eq!(no_year.map(|y| y * 2), None);\n\n// and_then (Scala \u306e flatMap \u76f8\u5f53)\nassert_eq!(year.and_then(|y| Some(y * 2)), Some(1992));\nassert_eq!(no_year.and_then(|y| Some(y * 2)), None);\n\n// filter\nassert_eq!(year.filter(|&amp;y| y &lt; 2020), Some(996));\nassert_eq!(year.filter(|&amp;y| y &gt; 2020), None);\n\n// unwrap_or\nassert_eq!(year.unwrap_or(0), 996);\nassert_eq!(no_year.unwrap_or(0), 0);\n</code></pre>"},{"location":"rust/part-3/#67","title":"6.7 \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u6226\u7565","text":"<p>\u8907\u6570\u306e\u8981\u7d20\u3092\u30d1\u30fc\u30b9\u3059\u308b\u5834\u5408\u30012\u3064\u306e\u6226\u7565\u304c\u3042\u308a\u307e\u3059\u3002</p> <p></p>"},{"location":"rust/part-3/#best-effort","title":"Best-effort \u6226\u7565","text":"<pre><code>pub fn parse_shows_best_effort(raw_shows: &amp;[&amp;str]) -&gt; Vec&lt;TvShow&gt; {\n    raw_shows\n        .iter()\n        .filter_map(|raw| parse_show(raw))  // Some \u306e\u307f\u53ce\u96c6\n        .collect()\n}\n\nlet raw_shows = vec![\n    \"Breaking Bad (2008-2013)\",\n    \"The Wire 2002 2008\",        // \u7121\u52b9\u306a\u5f62\u5f0f\n    \"Mad Men (2007-2015)\",\n];\n\nlet shows = parse_shows_best_effort(&amp;raw_shows);\n// vec![TvShow(\"Breaking Bad\", ...), TvShow(\"Mad Men\", ...)]\n// \u7121\u52b9\u306a\u3082\u306e\u306f\u7121\u8996\u3055\u308c\u308b\n</code></pre>"},{"location":"rust/part-3/#all-or-nothing","title":"All-or-nothing \u6226\u7565","text":"<pre><code>pub fn parse_shows_all_or_nothing(raw_shows: &amp;[&amp;str]) -&gt; Option&lt;Vec&lt;TvShow&gt;&gt; {\n    raw_shows.iter().map(|raw| parse_show(raw)).collect()\n}\n\n// \u5168\u90e8\u6210\u529f \u2192 Some(vec![...])\nparse_shows_all_or_nothing(&amp;[\"Breaking Bad (2008-2013)\", \"Mad Men (2007-2015)\"]);\n// Some(vec![TvShow(...), TvShow(...)])\n\n// \u4e00\u3064\u3067\u3082\u5931\u6557 \u2192 None\nparse_shows_all_or_nothing(&amp;[\"Breaking Bad (2008-2013)\", \"Invalid\"]);\n// None\n</code></pre>"},{"location":"rust/part-3/#68-forall-exists","title":"6.8 forall \u3068 exists \u76f8\u5f53","text":"<p>Scala \u306e <code>forall</code> \u3068 <code>exists</code> \u306b\u76f8\u5f53\u3059\u308b\u64cd\u4f5c\u3092\u5b9f\u88c5\u3067\u304d\u307e\u3059\u3002</p> <pre><code>/// Option \u306b\u5bfe\u3059\u308b forall\npub fn option_forall&lt;T, F&gt;(opt: &amp;Option&lt;T&gt;, predicate: F) -&gt; bool\nwhere\n    F: Fn(&amp;T) -&gt; bool,\n{\n    opt.as_ref().map(predicate).unwrap_or(true)\n}\n\n/// Option \u306b\u5bfe\u3059\u308b exists\npub fn option_exists&lt;T, F&gt;(opt: &amp;Option&lt;T&gt;, predicate: F) -&gt; bool\nwhere\n    F: Fn(&amp;T) -&gt; bool,\n{\n    opt.as_ref().map(predicate).unwrap_or(false)\n}\n\nlet year: Option&lt;i32&gt; = Some(996);\nlet no_year: Option&lt;i32&gt; = None;\n\n// forall: \u300c\u5168\u3066\u300d\u307e\u305f\u306f\u300c\u5b58\u5728\u3057\u306a\u3044\u300d\nassert!(option_forall(&amp;year, |&amp;y| y &lt; 2020));     // true\nassert!(option_forall(&amp;no_year, |&amp;y| y &lt; 2020));  // true (None \u306f true)\n\n// exists: \u300c\u5b58\u5728\u3057\u3066\u6761\u4ef6\u3092\u6e80\u305f\u3059\u300d\nassert!(option_exists(&amp;year, |&amp;y| y &lt; 2020));     // true\nassert!(!option_exists(&amp;no_year, |&amp;y| y &lt; 2020)); // false (None \u306f false)\n</code></pre>"},{"location":"rust/part-3/#7-result","title":"\u7b2c7\u7ae0: Result \u578b\u3068\u8907\u5408\u7684\u306a\u30a8\u30e9\u30fc\u51e6\u7406","text":""},{"location":"rust/part-3/#71-option","title":"7.1 Option \u306e\u9650\u754c","text":"<p><code>Option</code> \u306f\u300c\u5024\u304c\u3042\u308b\u304b\u306a\u3044\u304b\u300d\u3057\u304b\u8868\u73fe\u3067\u304d\u307e\u305b\u3093\u3002\u306a\u305c\u5931\u6557\u3057\u305f\u306e\u304b\u3092\u4f1d\u3048\u3089\u308c\u307e\u305b\u3093\u3002</p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/rust/src/ch07_result.rs</code></p> <p></p>"},{"location":"rust/part-3/#72-result","title":"7.2 Result \u306e\u57fa\u672c","text":"<p><code>Result&lt;T, E&gt;</code> \u306f\u300c<code>T</code> \u578b\u306e\u6210\u529f\u5024\u304b\u3001<code>E</code> \u578b\u306e\u30a8\u30e9\u30fc\u304b\u300d\u3092\u8868\u3059\u578b\u3067\u3059\u3002</p> <ul> <li><code>Ok(value)</code>: \u6210\u529f</li> <li><code>Err(error)</code>: \u5931\u6557\uff08\u30a8\u30e9\u30fc\u60c5\u5831\u3092\u4fdd\u6301\uff09</li> </ul> <pre><code>pub fn extract_name(raw_show: &amp;str) -&gt; Result&lt;String, String&gt; {\n    let bracket_open = raw_show\n        .find('(')\n        .ok_or_else(|| format!(\"Can't find '(' in {}\", raw_show))?;\n\n    if bracket_open &gt; 0 {\n        Ok(raw_show[..bracket_open].trim().to_string())\n    } else {\n        Err(format!(\"Can't extract name from {}\", raw_show))\n    }\n}\n\nextract_name(\"The Wire (2002-2008)\");  // Ok(\"The Wire\")\nextract_name(\"(2022)\");                // Err(\"Can't extract name from (2022)\")\n</code></pre>"},{"location":"rust/part-3/#73-result","title":"7.3 Result \u3092\u4f7f\u3063\u305f\u30d1\u30fc\u30b9","text":"<pre><code>pub fn extract_year_start(raw_show: &amp;str) -&gt; Result&lt;i32, String&gt; {\n    let bracket_open = raw_show\n        .find('(')\n        .ok_or_else(|| format!(\"Can't find '(' in {}\", raw_show))?;\n    let dash = raw_show\n        .find('-')\n        .ok_or_else(|| format!(\"Can't find '-' in {}\", raw_show))?;\n\n    if dash &gt; bracket_open + 1 {\n        let year_str = &amp;raw_show[bracket_open + 1..dash];\n        year_str\n            .parse()\n            .map_err(|_| format!(\"Can't parse '{}' as year\", year_str))\n    } else {\n        Err(format!(\"Can't extract start year from {}\", raw_show))\n    }\n}\n\nextract_year_start(\"The Wire (2002-2008)\");  // Ok(2002)\nextract_year_start(\"The Wire (-2008)\");      // Err(\"Can't extract start year from ...\")\nextract_year_start(\"The Wire (oops-2008)\");  // Err(\"Can't parse 'oops' as year\")\n</code></pre>"},{"location":"rust/part-3/#74-option-result","title":"7.4 Option \u304b\u3089 Result \u3078\u306e\u5909\u63db","text":"<p><code>ok_or</code> / <code>ok_or_else</code> \u30e1\u30bd\u30c3\u30c9\u3067 <code>Option</code> \u3092 <code>Result</code> \u306b\u5909\u63db\u3067\u304d\u307e\u3059\u3002</p> <pre><code>let year: Option&lt;i32&gt; = Some(996);\nlet no_year: Option&lt;i32&gt; = None;\n\nassert_eq!(year.ok_or(\"no year given\"), Ok(996));\nassert_eq!(no_year.ok_or(\"no year given\"), Err(\"no year given\"));\n</code></pre> <p></p>"},{"location":"rust/part-3/#75-result","title":"7.5 Result \u306b\u3088\u308b\u5b8c\u5168\u306a\u30d1\u30fc\u30b5\u30fc","text":"<pre><code>pub fn parse_show(raw_show: &amp;str) -&gt; Result&lt;TvShow, String&gt; {\n    let name = extract_name(raw_show)?;\n    let year_start = extract_year_start(raw_show)\n        .or_else(|_| extract_single_year(raw_show))?;\n    let year_end = extract_year_end(raw_show)\n        .or_else(|_| extract_single_year(raw_show))?;\n\n    Ok(TvShow::new(&amp;name, year_start, year_end))\n}\n\nparse_show(\"The Wire (2002-2008)\");  // Ok(TvShow { ... })\nparse_show(\"Mad Men ()\");            // Err(\"Can't extract single year from ...\")\nparse_show(\"(2002-2008)\");           // Err(\"Can't extract name from ...\")\n</code></pre>"},{"location":"rust/part-3/#76-result","title":"7.6 Result \u306e\u4e3b\u8981\u30e1\u30bd\u30c3\u30c9","text":"\u30e1\u30bd\u30c3\u30c9 \u8aac\u660e \u4f8b <code>map</code> Ok \u306e\u5024\u3092\u5909\u63db <code>Ok(5).map(\\|x\\| x * 2)</code> \u2192 <code>Ok(10)</code> <code>and_then</code> Ok \u306a\u3089 Result \u3092\u8fd4\u3059\u95a2\u6570\u3092\u9069\u7528 <code>Ok(5).and_then(\\|x\\| Ok(x * 2))</code> \u2192 <code>Ok(10)</code> <code>or_else</code> Err \u306a\u3089\u4ee3\u66ff\u3092\u4f7f\u7528 <code>Err(\"err\").or_else(\\|_\\| Ok(5))</code> \u2192 <code>Ok(5)</code> <code>ok</code> Option \u306b\u5909\u63db <code>Ok(5).ok()</code> \u2192 <code>Some(5)</code> <code>map_err</code> Err \u306e\u5024\u3092\u5909\u63db <code>Err(\"e\").map_err(\\|e\\| format!(\"Error: {}\", e))</code> <pre><code>let year: Result&lt;i32, &amp;str&gt; = Ok(996);\nlet no_year: Result&lt;i32, &amp;str&gt; = Err(\"no year\");\n\n// map\nassert_eq!(year.map(|y| y * 2), Ok(1992));\nassert_eq!(no_year.map(|y| y * 2), Err(\"no year\"));\n\n// and_then\nassert_eq!(year.and_then(|y| Ok(y * 2)), Ok(1992));\nassert_eq!(no_year.and_then(|y| Ok(y * 2)), Err(\"no year\"));\n\n// ok (Option \u306b\u5909\u63db)\nassert_eq!(year.ok(), Some(996));\nassert_eq!(no_year.ok(), None);\n</code></pre>"},{"location":"rust/part-3/#77-adt-enum","title":"7.7 \u4ee3\u6570\u7684\u30c7\u30fc\u30bf\u578b\uff08ADT\uff09- enum","text":"<p>Rust \u306e <code>enum</code> \u3092\u4f7f\u3063\u3066\u3001\u3088\u308a\u8868\u73fe\u529b\u306e\u9ad8\u3044\u30e2\u30c7\u30eb\u3092\u4f5c\u308c\u307e\u3059\u3002</p>"},{"location":"rust/part-3/#sum-type","title":"\u76f4\u548c\u578b\uff08Sum Type\uff09","text":"<p>\u8907\u6570\u306e\u9078\u629e\u80a2\u3092 OR \u3067\u8868\u3059\u578b\u3067\u3059\u3002</p> <pre><code>/// \u97f3\u697d\u30b8\u30e3\u30f3\u30eb\n#[derive(Debug, Clone, Copy, PartialEq, Eq)]\npub enum MusicGenre {\n    HeavyMetal,\n    Pop,\n    HardRock,\n    Jazz,\n}\n\n/// \u6d3b\u52d5\u671f\u9593\n#[derive(Debug, Clone, PartialEq)]\npub enum YearsActive {\n    /// \u73fe\u5728\u3082\u6d3b\u52d5\u4e2d\n    StillActive { since: i32 },\n    /// \u6d3b\u52d5\u7d42\u4e86\n    ActiveBetween { start: i32, end: i32 },\n}\n</code></pre>"},{"location":"rust/part-3/#product-type","title":"\u76f4\u7a4d\u578b\uff08Product Type\uff09","text":"<p>\u8907\u6570\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u3092 AND \u3067\u7d44\u307f\u5408\u308f\u305b\u308b\u578b\u3067\u3059\u3002</p> <pre><code>/// \u30a2\u30fc\u30c6\u30a3\u30b9\u30c8\n#[derive(Debug, Clone, PartialEq)]\npub struct Artist {\n    pub name: String,\n    pub genre: MusicGenre,\n    pub origin: String,\n    pub years_active: YearsActive,\n}\n</code></pre> <p></p>"},{"location":"rust/part-3/#78","title":"7.8 \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0","text":"<p>\u76f4\u548c\u578b\u306f \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0 \u3067\u51e6\u7406\u3057\u307e\u3059\u3002</p> <pre><code>/// \u30a2\u30fc\u30c6\u30a3\u30b9\u30c8\u304c\u6307\u5b9a\u671f\u9593\u306b\u6d3b\u52d5\u3057\u3066\u3044\u305f\u304b\u5224\u5b9a\npub fn was_artist_active(artist: &amp;Artist, year_start: i32, year_end: i32) -&gt; bool {\n    match &amp;artist.years_active {\n        YearsActive::StillActive { since } =&gt; *since &lt;= year_end,\n        YearsActive::ActiveBetween { start, end } =&gt; *start &lt;= year_end &amp;&amp; *end &gt;= year_start,\n    }\n}\n\n/// \u30a2\u30fc\u30c6\u30a3\u30b9\u30c8\u306e\u6d3b\u52d5\u5e74\u6570\u3092\u8a08\u7b97\npub fn active_length(artist: &amp;Artist, current_year: i32) -&gt; i32 {\n    match &amp;artist.years_active {\n        YearsActive::StillActive { since } =&gt; current_year - since,\n        YearsActive::ActiveBetween { start, end } =&gt; end - start,\n    }\n}\n\nlet metallica = Artist::new(\n    \"Metallica\",\n    MusicGenre::HeavyMetal,\n    \"U.S.\",\n    YearsActive::StillActive { since: 1981 }\n);\n\nlet led_zeppelin = Artist::new(\n    \"Led Zeppelin\",\n    MusicGenre::HardRock,\n    \"England\",\n    YearsActive::ActiveBetween { start: 1968, end: 1980 }\n);\n\nassert!(was_artist_active(&amp;metallica, 1990, 2000));\nassert!(!was_artist_active(&amp;led_zeppelin, 1990, 2000));\n\nassert_eq!(active_length(&amp;metallica, 2024), 43);\nassert_eq!(active_length(&amp;led_zeppelin, 2024), 12);\n</code></pre> <p></p>"},{"location":"rust/part-3/#79","title":"7.9 \u691c\u7d22\u6761\u4ef6\u306e\u30e2\u30c7\u30ea\u30f3\u30b0","text":"<p>\u691c\u7d22\u6761\u4ef6\u3082 enum \u3067\u30e2\u30c7\u30ea\u30f3\u30b0\u3067\u304d\u307e\u3059\u3002</p> <pre><code>/// \u691c\u7d22\u6761\u4ef6\n#[derive(Debug, Clone, PartialEq)]\npub enum SearchCondition {\n    SearchByGenre(Vec&lt;MusicGenre&gt;),\n    SearchByOrigin(Vec&lt;String&gt;),\n    SearchByActiveYears { start: i32, end: i32 },\n}\n\n/// \u30a2\u30fc\u30c6\u30a3\u30b9\u30c8\u3092\u691c\u7d22\npub fn search_artists&lt;'a&gt;(\n    artists: &amp;'a [Artist],\n    conditions: &amp;[SearchCondition],\n) -&gt; Vec&lt;&amp;'a Artist&gt; {\n    artists\n        .iter()\n        .filter(|artist| {\n            conditions.iter().all(|condition| match condition {\n                SearchCondition::SearchByGenre(genres) =&gt; genres.contains(&amp;artist.genre),\n                SearchCondition::SearchByOrigin(locations) =&gt; locations.contains(&amp;artist.origin),\n                SearchCondition::SearchByActiveYears { start, end } =&gt; {\n                    was_artist_active(artist, *start, *end)\n                }\n            })\n        })\n        .collect()\n}\n</code></pre>"},{"location":"rust/part-3/#710","title":"7.10 \u30ab\u30b9\u30bf\u30e0\u30a8\u30e9\u30fc\u578b","text":"<p>\u30a8\u30e9\u30fc\u7a2e\u5225\u3092 enum \u3067\u5b9a\u7fa9\u3059\u308b\u3053\u3068\u3067\u3001\u3088\u308a\u578b\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u304c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>/// \u30d1\u30fc\u30b9\u30a8\u30e9\u30fc\n#[derive(Debug, Clone, PartialEq)]\npub enum ParseError {\n    MissingName,\n    MissingYear,\n    InvalidYear(String),\n    MissingBracket,\n}\n\nimpl std::fmt::Display for ParseError {\n    fn fmt(&amp;self, f: &amp;mut std::fmt::Formatter&lt;'_&gt;) -&gt; std::fmt::Result {\n        match self {\n            ParseError::MissingName =&gt; write!(f, \"Missing name\"),\n            ParseError::MissingYear =&gt; write!(f, \"Missing year\"),\n            ParseError::InvalidYear(s) =&gt; write!(f, \"Invalid year: {}\", s),\n            ParseError::MissingBracket =&gt; write!(f, \"Missing bracket\"),\n        }\n    }\n}\n\n/// TV\u756a\u7d44\u3092\u30d1\u30fc\u30b9\uff08\u30ab\u30b9\u30bf\u30e0\u30a8\u30e9\u30fc\u578b\u7248\uff09\npub fn parse_show_typed(raw_show: &amp;str) -&gt; Result&lt;TvShow, ParseError&gt; {\n    let bracket_open = raw_show.find('(').ok_or(ParseError::MissingBracket)?;\n\n    if bracket_open == 0 {\n        return Err(ParseError::MissingName);\n    }\n\n    // ... \u4ee5\u4e0b\u7701\u7565\n}\n\nparse_show_typed(\"Breaking Bad (2008-2013)\");  // Ok(TvShow { ... })\nparse_show_typed(\"(2008-2013)\");               // Err(ParseError::MissingName)\nparse_show_typed(\"Test ()\");                   // Err(ParseError::MissingYear)\n</code></pre>"},{"location":"rust/part-3/#711","title":"7.11 \u652f\u6255\u3044\u65b9\u6cd5\u306e\u4f8b","text":"<p>\u3088\u308a\u5b9f\u8df5\u7684\u306a enum \u306e\u4f8b\u3068\u3057\u3066\u3001\u652f\u6255\u3044\u65b9\u6cd5\u3092\u30e2\u30c7\u30ea\u30f3\u30b0\u3057\u307e\u3059\u3002</p> <pre><code>/// \u652f\u6255\u3044\u65b9\u6cd5\n#[derive(Debug, Clone, PartialEq)]\npub enum PaymentMethod {\n    CreditCard { number: String, expiry: String },\n    BankTransfer { account_number: String },\n    Cash,\n}\n\n/// \u652f\u6255\u3044\u65b9\u6cd5\u3092\u8aac\u660e\npub fn describe_payment(method: &amp;PaymentMethod) -&gt; String {\n    match method {\n        PaymentMethod::CreditCard { number, .. } =&gt; {\n            format!(\"Credit card ending in {}\", number)\n        }\n        PaymentMethod::BankTransfer { account_number } =&gt; {\n            format!(\"Bank transfer to account {}\", account_number)\n        }\n        PaymentMethod::Cash =&gt; \"Cash payment\".to_string(),\n    }\n}\n\nassert_eq!(\n    describe_payment(&amp;PaymentMethod::CreditCard {\n        number: \"1234\".to_string(),\n        expiry: \"12/25\".to_string()\n    }),\n    \"Credit card ending in 1234\"\n);\nassert_eq!(describe_payment(&amp;PaymentMethod::Cash), \"Cash payment\");\n</code></pre>"},{"location":"rust/part-3/#_3","title":"\u307e\u3068\u3081","text":""},{"location":"rust/part-3/#part-iii","title":"Part III \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"rust/part-3/#scala","title":"Scala \u3068\u306e\u6bd4\u8f03","text":"\u6982\u5ff5 Scala Rust \u5024\u306e\u6709\u7121 <code>Option[A]</code> <code>Option&lt;T&gt;</code> \u6210\u529f/\u5931\u6557 <code>Either[E, A]</code> <code>Result&lt;T, E&gt;</code> \u5024\u3042\u308a <code>Some(value)</code> <code>Some(value)</code> \u5024\u306a\u3057 <code>None</code> <code>None</code> \u6210\u529f <code>Right(value)</code> <code>Ok(value)</code> \u5931\u6557 <code>Left(error)</code> <code>Err(error)</code> for \u5185\u5305\u8868\u8a18 <code>for { ... } yield</code> <code>?</code> \u6f14\u7b97\u5b50 flatMap <code>flatMap</code> <code>and_then</code> orElse <code>orElse</code> <code>or_else</code> Option\u2192Either <code>toRight</code> <code>ok_or</code> ADT <code>sealed trait</code> + <code>case class</code> <code>enum</code>"},{"location":"rust/part-3/#option-vs-result","title":"Option vs Result \u306e\u4f7f\u3044\u5206\u3051","text":"\u72b6\u6cc1 \u4f7f\u7528\u3059\u308b\u578b \u5024\u304c\u3042\u308b\u304b\u306a\u3044\u304b\u3060\u3051\u304c\u91cd\u8981 <code>Option&lt;T&gt;</code> \u5931\u6557\u7406\u7531\u3092\u4f1d\u3048\u308b\u5fc5\u8981\u304c\u3042\u308b <code>Result&lt;T, E&gt;</code> \u691c\u7d22\u7d50\u679c\u304c\u898b\u3064\u304b\u3089\u306a\u3044 <code>Option&lt;T&gt;</code> \u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u30a8\u30e9\u30fc\u3092\u4f1d\u3048\u308b <code>Result&lt;T, String&gt;</code> \u8907\u6570\u306e\u30a8\u30e9\u30fc\u7a2e\u5225\u304c\u3042\u308b <code>Result&lt;T, ErrorEnum&gt;</code>"},{"location":"rust/part-3/#_4","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>Option: \u5024\u306e\u6709\u7121\u3092\u578b\u3067\u8868\u73fe\u3059\u308b</li> <li>Result: \u6210\u529f/\u5931\u6557\u3068\u30a8\u30e9\u30fc\u60c5\u5831\u3092\u578b\u3067\u8868\u73fe\u3059\u308b</li> <li>? \u6f14\u7b97\u5b50: Option/Result \u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u4f7f\u3046\uff08Scala \u306e for \u5185\u5305\u8868\u8a18\u76f8\u5f53\uff09</li> <li>or_else: \u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u3092\u63d0\u4f9b\u3059\u308b</li> <li>ADT: enum \u3067\u30c9\u30e1\u30a4\u30f3\u3092\u6b63\u78ba\u306b\u30e2\u30c7\u30ea\u30f3\u30b0</li> <li>\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0: enum \u3092\u5b89\u5168\u306b\u51e6\u7406\u3059\u308b\uff08\u7db2\u7f85\u6027\u30c1\u30a7\u30c3\u30af\u3042\u308a\uff09</li> </ol>"},{"location":"rust/part-3/#_5","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part IV \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li>\u975e\u540c\u671f\u51e6\u7406\uff08async/await\uff09</li> <li>\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406\uff08tokio-stream\uff09</li> </ul>"},{"location":"rust/part-3/#_6","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"rust/part-3/#1-option","title":"\u554f\u984c 1: Option \u306e\u57fa\u672c","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>fn safe_divide(a: i32, b: i32) -&gt; Option&lt;i32&gt; {\n    todo!()\n}\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert_eq!(safe_divide(10, 2), Some(5));\nassert_eq!(safe_divide(10, 0), None);\nassert_eq!(safe_divide(7, 2), Some(3));\n</code></pre> \u89e3\u7b54 <pre><code>fn safe_divide(a: i32, b: i32) -&gt; Option&lt;i32&gt; {\n    if b == 0 {\n        None\n    } else {\n        Some(a / b)\n    }\n}\n</code></pre>"},{"location":"rust/part-3/#2-option","title":"\u554f\u984c 2: Option \u306e\u5408\u6210","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u30022\u3064\u306e\u6570\u5024\u6587\u5b57\u5217\u3092\u53d7\u3051\u53d6\u308a\u3001\u305d\u306e\u5408\u8a08\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>fn add_strings(a: &amp;str, b: &amp;str) -&gt; Option&lt;i32&gt; {\n    todo!()\n}\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert_eq!(add_strings(\"10\", \"20\"), Some(30));\nassert_eq!(add_strings(\"10\", \"abc\"), None);\nassert_eq!(add_strings(\"xyz\", \"20\"), None);\n</code></pre> \u89e3\u7b54 <pre><code>fn add_strings(a: &amp;str, b: &amp;str) -&gt; Option&lt;i32&gt; {\n    let x: i32 = a.parse().ok()?;\n    let y: i32 = b.parse().ok()?;\n    Some(x + y)\n}\n</code></pre>"},{"location":"rust/part-3/#3-result","title":"\u554f\u984c 3: Result \u306b\u3088\u308b\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u5e74\u9f62\u3092\u691c\u8a3c\u3057\u3001\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>fn validate_age(age: i32) -&gt; Result&lt;i32, String&gt; {\n    todo!()\n}\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert_eq!(validate_age(25), Ok(25));\nassert_eq!(validate_age(-5), Err(\"Age cannot be negative\".to_string()));\nassert_eq!(validate_age(200), Err(\"Age cannot be greater than 150\".to_string()));\n</code></pre> \u89e3\u7b54 <pre><code>fn validate_age(age: i32) -&gt; Result&lt;i32, String&gt; {\n    if age &lt; 0 {\n        Err(\"Age cannot be negative\".to_string())\n    } else if age &gt; 150 {\n        Err(\"Age cannot be greater than 150\".to_string())\n    } else {\n        Ok(age)\n    }\n}\n</code></pre>"},{"location":"rust/part-3/#4","title":"\u554f\u984c 4: \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0","text":"<p>\u4ee5\u4e0b\u306e enum \u3068\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u4f7f\u3063\u305f\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>enum PaymentMethod {\n    CreditCard { number: String, expiry: String },\n    BankTransfer { account_number: String },\n    Cash,\n}\n\nfn describe_payment(method: &amp;PaymentMethod) -&gt; String {\n    todo!()\n}\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert_eq!(\n    describe_payment(&amp;PaymentMethod::CreditCard {\n        number: \"1234\".to_string(),\n        expiry: \"12/25\".to_string()\n    }),\n    \"Credit card ending in 1234\"\n);\nassert_eq!(\n    describe_payment(&amp;PaymentMethod::BankTransfer {\n        account_number: \"9876\".to_string()\n    }),\n    \"Bank transfer to account 9876\"\n);\nassert_eq!(describe_payment(&amp;PaymentMethod::Cash), \"Cash payment\");\n</code></pre> \u89e3\u7b54 <pre><code>fn describe_payment(method: &amp;PaymentMethod) -&gt; String {\n    match method {\n        PaymentMethod::CreditCard { number, .. } =&gt; {\n            format!(\"Credit card ending in {}\", number)\n        }\n        PaymentMethod::BankTransfer { account_number } =&gt; {\n            format!(\"Bank transfer to account {}\", account_number)\n        }\n        PaymentMethod::Cash =&gt; \"Cash payment\".to_string(),\n    }\n}\n</code></pre>"},{"location":"rust/part-4/","title":"Rust \u3067\u5b66\u3076\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0 Part IV: \u975e\u540c\u671f\u51e6\u7406\u3068\u30b9\u30c8\u30ea\u30fc\u30e0","text":""},{"location":"rust/part-4/#_1","title":"\u306f\u3058\u3081\u306b","text":"<p>Part III \u3067\u306f Option \u3068 Result \u3092\u4f7f\u3063\u305f\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3068\u3001\u4ee3\u6570\u7684\u30c7\u30fc\u30bf\u578b\uff08ADT\uff09\u306b\u3088\u308b\u30c9\u30e1\u30a4\u30f3\u30e2\u30c7\u30ea\u30f3\u30b0\u3092\u5b66\u3073\u307e\u3057\u305f\u3002Part IV \u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u91cd\u8981\u306a\u30c8\u30d4\u30c3\u30af\u3067\u3042\u308b\u526f\u4f5c\u7528\u306e\u7ba1\u7406\u3068\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406\u3092\u6271\u3044\u307e\u3059\u3002</p> <p>Scala \u3067\u306f IO \u30e2\u30ca\u30c9\u3068 fs2 Stream \u3092\u4f7f\u3044\u307e\u3059\u304c\u3001Rust \u3067\u306f <code>async/await</code> \u3068 <code>tokio-stream</code> / <code>futures</code> \u30af\u30ec\u30fc\u30c8\u3092\u4f7f\u3063\u3066\u540c\u69d8\u306e\u6982\u5ff5\u3092\u5b9f\u73fe\u3057\u307e\u3059\u3002</p>"},{"location":"rust/part-4/#8","title":"\u7b2c8\u7ae0: \u975e\u540c\u671f\u51e6\u7406\u3068\u526f\u4f5c\u7528\u306e\u7ba1\u7406","text":""},{"location":"rust/part-4/#81","title":"8.1 \u526f\u4f5c\u7528\u306e\u554f\u984c","text":"<p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u3067\u306f\u3001\u526f\u4f5c\u7528\uff08side effects\uff09\u3092\u660e\u793a\u7684\u306b\u7ba1\u7406\u3059\u308b\u3053\u3068\u304c\u91cd\u8981\u3067\u3059\u3002\u526f\u4f5c\u7528\u3068\u306f\u3001\u95a2\u6570\u306e\u5916\u90e8\u306e\u72b6\u614b\u3092\u5909\u66f4\u3057\u305f\u308a\u3001\u5916\u90e8\u306e\u72b6\u614b\u306b\u4f9d\u5b58\u3057\u305f\u308a\u3059\u308b\u64cd\u4f5c\u306e\u3053\u3068\u3067\u3059\u3002</p> <pre><code>/// \u4e0d\u7d14\u306a\u95a2\u6570\uff08\u526f\u4f5c\u7528\u3042\u308a\uff09- \u30b5\u30a4\u30b3\u30ed\u3092\u632f\u308b\npub fn cast_the_die_impure() -&gt; i32 {\n    use std::time::{SystemTime, UNIX_EPOCH};\n    let nanos = SystemTime::now()\n        .duration_since(UNIX_EPOCH)\n        .unwrap()\n        .subsec_nanos();\n    (nanos % 6) as i32 + 1\n}\n</code></pre> <p>\u3053\u306e\u95a2\u6570\u306f\u53c2\u7167\u900f\u904e\u6027\uff08referential transparency\uff09\u3092\u6301\u3061\u307e\u305b\u3093\u3002\u540c\u3058\u5f15\u6570\u3067\u547c\u3073\u51fa\u3057\u3066\u3082\u3001\u6bce\u56de\u7570\u306a\u308b\u7d50\u679c\u3092\u8fd4\u3059\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002</p>"},{"location":"rust/part-4/#82-asyncawait","title":"8.2 async/await \u306b\u3088\u308b\u526f\u4f5c\u7528\u306e\u9045\u5ef6\u5b9f\u884c","text":"<p>Rust \u306e <code>async/await</code> \u306f\u3001\u526f\u4f5c\u7528\u3092\u9045\u5ef6\u5b9f\u884c\u3059\u308b\u305f\u3081\u306e\u4ed5\u7d44\u307f\u3092\u63d0\u4f9b\u3057\u307e\u3059\u3002Scala \u306e IO \u30e2\u30ca\u30c9\u3068\u540c\u69d8\u306b\u3001\u526f\u4f5c\u7528\u3092\u300c\u8a18\u8ff0\u300d\u3068\u300c\u5b9f\u884c\u300d\u306b\u5206\u96e2\u3067\u304d\u307e\u3059\u3002</p> <pre><code>/// \u975e\u540c\u671f\u3067\u30b5\u30a4\u30b3\u30ed\u3092\u632f\u308b\uff08\u526f\u4f5c\u7528\u3092\u9045\u5ef6\uff09\npub async fn cast_the_die() -&gt; i32 {\n    cast_the_die_impure()\n}\n\n/// 2\u56de\u30b5\u30a4\u30b3\u30ed\u3092\u632f\u3063\u3066\u5408\u8a08\u3092\u8fd4\u3059\npub async fn cast_the_die_twice() -&gt; i32 {\n    let first = cast_the_die().await;\n    let second = cast_the_die().await;\n    first + second\n}\n</code></pre> <p><code>async fn</code> \u306f <code>Future</code> \u3092\u8fd4\u3057\u307e\u3059\u3002<code>Future</code> \u306f\u300c\u5c06\u6765\u306e\u5024\u306e\u7d04\u675f\u300d\u3067\u3042\u308a\u3001<code>.await</code> \u3055\u308c\u308b\u307e\u3067\u5b9f\u884c\u3055\u308c\u307e\u305b\u3093\u3002\u3053\u308c\u306b\u3088\u308a\uff1a</p> <ol> <li>\u9045\u5ef6\u8a55\u4fa1: \u526f\u4f5c\u7528\u306f <code>.await</code> \u307e\u3067\u5b9f\u884c\u3055\u308c\u306a\u3044</li> <li>\u5408\u6210\u53ef\u80fd: \u8907\u6570\u306e\u975e\u540c\u671f\u51e6\u7406\u3092\u7d44\u307f\u5408\u308f\u305b\u3089\u308c\u308b</li> <li>\u660e\u793a\u7684\u306a\u526f\u4f5c\u7528: \u578b\u30b7\u30b9\u30c6\u30e0\u3067\u526f\u4f5c\u7528\u306e\u5b58\u5728\u304c\u660e\u793a\u3055\u308c\u308b</li> </ol>"},{"location":"rust/part-4/#83","title":"8.3 \u7d14\u7c8b\u95a2\u6570\u3068\u975e\u540c\u671f\u95a2\u6570\u306e\u5206\u96e2","text":"<p>\u5b9f\u969b\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3067\u306f\u3001\u30d3\u30b8\u30cd\u30b9\u30ed\u30b8\u30c3\u30af\uff08\u7d14\u7c8b\u95a2\u6570\uff09\u3068\u526f\u4f5c\u7528\u3092\u542b\u3080\u51e6\u7406\u3092\u5206\u96e2\u3059\u308b\u3053\u3068\u304c\u91cd\u8981\u3067\u3059\u3002</p> <pre><code>/// \u30df\u30fc\u30c6\u30a3\u30f3\u30b0\u6642\u9593\u3092\u8868\u3059\u69cb\u9020\u4f53\n#[derive(Debug, Clone, PartialEq)]\npub struct MeetingTime {\n    pub start_hour: i32,\n    pub end_hour: i32,\n}\n\n/// 2\u3064\u306e\u30df\u30fc\u30c6\u30a3\u30f3\u30b0\u304c\u91cd\u306a\u3063\u3066\u3044\u308b\u304b\u5224\u5b9a\uff08\u7d14\u7c8b\u95a2\u6570\uff09\npub fn meetings_overlap(m1: &amp;MeetingTime, m2: &amp;MeetingTime) -&gt; bool {\n    m1.start_hour &lt; m2.end_hour &amp;&amp; m2.start_hour &lt; m1.end_hour\n}\n\n/// \u53ef\u80fd\u306a\u30df\u30fc\u30c6\u30a3\u30f3\u30b0\u6642\u9593\u3092\u8a08\u7b97\uff08\u7d14\u7c8b\u95a2\u6570\uff09\npub fn possible_meetings(\n    existing_meetings: &amp;[MeetingTime],\n    start_hour: i32,\n    end_hour: i32,\n    length_hours: i32,\n) -&gt; Vec&lt;MeetingTime&gt; {\n    (start_hour..=end_hour - length_hours)\n        .map(|start| MeetingTime::new(start, start + length_hours))\n        .filter(|slot| {\n            existing_meetings\n                .iter()\n                .all(|meeting| !meetings_overlap(meeting, slot))\n        })\n        .collect()\n}\n</code></pre> <p>\u7d14\u7c8b\u95a2\u6570\u306f\uff1a - \u30c6\u30b9\u30c8\u304c\u5bb9\u6613 - \u4e26\u5217\u5b9f\u884c\u304c\u5b89\u5168 - \u7d50\u679c\u3092\u4e88\u6e2c\u53ef\u80fd</p>"},{"location":"rust/part-4/#84-api","title":"8.4 \u30ab\u30ec\u30f3\u30c0\u30fc API \u306e\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3","text":"<p>\u5916\u90e8 API \u3068\u306e\u9023\u643a\u306f\u5178\u578b\u7684\u306a\u526f\u4f5c\u7528\u3067\u3059\u3002<code>async fn</code> \u3067\u660e\u793a\u7684\u306b\u8868\u73fe\u3057\u307e\u3059\u3002</p> <pre><code>/// \u30ab\u30ec\u30f3\u30c0\u30fc\u30a8\u30f3\u30c8\u30ea\u3092\u53d6\u5f97\uff08\u975e\u540c\u671f\uff09\npub async fn calendar_entries(name: &amp;str) -&gt; Vec&lt;MeetingTime&gt; {\n    // \u5b9f\u969b\u306b\u306fAPI\u30b3\u30fc\u30eb\u3092\u30b7\u30df\u30e5\u30ec\u30fc\u30c8\n    tokio::time::sleep(tokio::time::Duration::from_millis(10)).await;\n\n    // \u30c0\u30df\u30fc\u30c7\u30fc\u30bf\u3092\u8fd4\u3059\n    match name {\n        \"Alice\" =&gt; vec![MeetingTime::new(9, 10), MeetingTime::new(14, 15)],\n        \"Bob\" =&gt; vec![MeetingTime::new(10, 12)],\n        _ =&gt; vec![],\n    }\n}\n\n/// \u8907\u6570\u4eba\u306e\u4e88\u5b9a\u3092\u53d6\u5f97\uff08\u975e\u540c\u671f\uff09\npub async fn scheduled_meetings(person1: &amp;str, person2: &amp;str) -&gt; Vec&lt;MeetingTime&gt; {\n    let entries1 = calendar_entries(person1).await;\n    let entries2 = calendar_entries(person2).await;\n\n    let mut result = entries1;\n    result.extend(entries2);\n    result\n}\n</code></pre>"},{"location":"rust/part-4/#85-result","title":"8.5 Result \u3092\u4f7f\u3063\u305f\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":"<p>\u975e\u540c\u671f\u51e6\u7406\u3067\u306f\u3001\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a8\u30e9\u30fc\u306a\u3069\u306e\u5931\u6557\u304c\u767a\u751f\u3057\u307e\u3059\u3002<code>Result</code> \u3068\u7d44\u307f\u5408\u308f\u305b\u3066\u5805\u7262\u306a\u51e6\u7406\u3092\u5b9f\u73fe\u3057\u307e\u3059\u3002</p> <pre><code>/// \u5931\u6557\u3059\u308b\u53ef\u80fd\u6027\u306e\u3042\u308b\u30ab\u30ec\u30f3\u30c0\u30fc\u53d6\u5f97\npub async fn calendar_entries_may_fail(name: &amp;str) -&gt; Result&lt;Vec&lt;MeetingTime&gt;, String&gt; {\n    if name == \"Error\" {\n        Err(\"API call failed\".to_string())\n    } else {\n        Ok(calendar_entries(name).await)\n    }\n}\n\n/// \u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u4ed8\u304d\u306e\u30ab\u30ec\u30f3\u30c0\u30fc\u53d6\u5f97\npub async fn calendar_entries_with_fallback(name: &amp;str) -&gt; Vec&lt;MeetingTime&gt; {\n    calendar_entries_may_fail(name)\n        .await\n        .unwrap_or_else(|_| vec![])\n}\n</code></pre>"},{"location":"rust/part-4/#86","title":"8.6 \u30ea\u30c8\u30e9\u30a4\u6a5f\u80fd","text":"<p>\u4e00\u6642\u7684\u306a\u30a8\u30e9\u30fc\u306b\u5bfe\u3057\u3066\u30ea\u30c8\u30e9\u30a4\u3092\u884c\u3046\u6c4e\u7528\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u307e\u3059\u3002</p> <pre><code>/// \u6307\u5b9a\u56de\u6570\u30ea\u30c8\u30e9\u30a4\u3059\u308b\npub async fn retry&lt;T, E, F, Fut&gt;(action: F, max_retries: usize) -&gt; Result&lt;T, E&gt;\nwhere\n    F: Fn() -&gt; Fut,\n    Fut: Future&lt;Output = Result&lt;T, E&gt;&gt;,\n{\n    let mut last_error = None;\n\n    for _ in 0..max_retries {\n        match action().await {\n            Ok(result) =&gt; return Ok(result),\n            Err(e) =&gt; last_error = Some(e),\n        }\n    }\n\n    Err(last_error.unwrap())\n}\n\n/// \u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u4ed8\u304d\u30ea\u30c8\u30e9\u30a4\npub async fn retry_with_default&lt;T, E, F, Fut&gt;(action: F, max_retries: usize, default: T) -&gt; T\nwhere\n    F: Fn() -&gt; Fut,\n    Fut: Future&lt;Output = Result&lt;T, E&gt;&gt;,\n{\n    retry(action, max_retries).await.unwrap_or(default)\n}\n</code></pre>"},{"location":"rust/part-4/#87","title":"8.7 \u8907\u6570\u306e\u975e\u540c\u671f\u51e6\u7406\u306e\u5408\u6210","text":"<p>\u8907\u6570\u306e\u975e\u540c\u671f\u51e6\u7406\u3092\u4e26\u884c\u5b9f\u884c\u3059\u308b\u3053\u3068\u3067\u3001\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u3092\u5411\u4e0a\u3055\u305b\u307e\u3059\u3002</p> <pre><code>/// \u8907\u6570\u4eba\u306e\u4e88\u5b9a\u3092\u4e26\u884c\u53d6\u5f97\npub async fn scheduled_meetings_for_all(attendees: &amp;[&amp;str]) -&gt; Vec&lt;MeetingTime&gt; {\n    let futures: Vec&lt;_&gt; = attendees\n        .iter()\n        .map(|name| calendar_entries(name))\n        .collect();\n\n    let results = futures::future::join_all(futures).await;\n    results.into_iter().flatten().collect()\n}\n\n/// \u8907\u6570\u306e\u975e\u540c\u671f\u51e6\u7406\u3092\u9806\u756a\u306b\u5b9f\u884c\u3057\u3066\u7d50\u5408\npub async fn combine_async&lt;A, B, C, F&gt;(\n    future1: impl Future&lt;Output = A&gt;,\n    future2: impl Future&lt;Output = B&gt;,\n    combine: F,\n) -&gt; C\nwhere\n    F: FnOnce(A, B) -&gt; C,\n{\n    let a = future1.await;\n    let b = future2.await;\n    combine(a, b)\n}\n</code></pre>"},{"location":"rust/part-4/#88-future","title":"8.8 \u52d5\u7684\u306a Future \u306e\u51e6\u7406","text":"<p>\u6761\u4ef6\u306b\u3088\u3063\u3066\u7570\u306a\u308b\u578b\u306e Future \u3092\u8fd4\u3059\u5834\u5408\u3001<code>Box&lt;dyn Future&gt;</code> \u3092\u4f7f\u7528\u3057\u307e\u3059\u3002</p> <pre><code>pub type BoxFuture&lt;'a, T&gt; = Pin&lt;Box&lt;dyn Future&lt;Output = T&gt; + Send + 'a&gt;&gt;;\n\n/// \u6761\u4ef6\u306b\u5fdc\u3058\u3066\u7570\u306a\u308b\u975e\u540c\u671f\u51e6\u7406\u3092\u8fd4\u3059\npub fn conditional_async(condition: bool) -&gt; BoxFuture&lt;'static, &amp;'static str&gt; {\n    if condition {\n        Box::pin(async { \"Success\" })\n    } else {\n        Box::pin(async { \"Failure\" })\n    }\n}\n</code></pre>"},{"location":"rust/part-4/#9","title":"\u7b2c9\u7ae0: \u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406","text":""},{"location":"rust/part-4/#91","title":"9.1 \u30b9\u30c8\u30ea\u30fc\u30e0\u306e\u57fa\u672c","text":"<p>\u30b9\u30c8\u30ea\u30fc\u30e0\u306f\u300c\u9045\u5ef6\u8a55\u4fa1\u3055\u308c\u308b\u5024\u306e\u30b7\u30fc\u30b1\u30f3\u30b9\u300d\u3067\u3059\u3002Rust \u3067\u306f <code>futures::Stream</code> \u30c8\u30ec\u30a4\u30c8\u3067\u8868\u73fe\u3057\u307e\u3059\u3002</p> <pre><code>use futures::stream::{self, Stream, StreamExt};\n\n/// \u30a4\u30c6\u30ec\u30fc\u30bf\u304b\u3089\u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u4f5c\u6210\npub fn numbers_stream(start: i32, end: i32) -&gt; impl Stream&lt;Item = i32&gt; {\n    stream::iter(start..=end)\n}\n\n/// \u30b9\u30c8\u30ea\u30fc\u30e0\u306b map \u3092\u9069\u7528\npub fn map_stream&lt;S, F, T, U&gt;(stream: S, f: F) -&gt; impl Stream&lt;Item = U&gt;\nwhere\n    S: Stream&lt;Item = T&gt;,\n    F: FnMut(T) -&gt; U,\n{\n    stream.map(f)\n}\n\n/// \u30b9\u30c8\u30ea\u30fc\u30e0\u306b filter \u3092\u9069\u7528\npub fn filter_stream&lt;S, F, T&gt;(stream: S, mut f: F) -&gt; impl Stream&lt;Item = T&gt;\nwhere\n    S: Stream&lt;Item = T&gt;,\n    F: FnMut(&amp;T) -&gt; bool,\n{\n    stream.filter(move |x| {\n        let result = f(x);\n        async move { result }\n    })\n}\n</code></pre>"},{"location":"rust/part-4/#92","title":"9.2 \u30b9\u30c8\u30ea\u30fc\u30e0\u306e\u5408\u6210","text":"<p>\u30b9\u30c8\u30ea\u30fc\u30e0\u306f\u69d8\u3005\u306a\u65b9\u6cd5\u3067\u5408\u6210\u3067\u304d\u307e\u3059\u3002</p> <pre><code>/// 2\u3064\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u7d50\u5408\npub fn concat_streams&lt;S1, S2, T&gt;(stream1: S1, stream2: S2) -&gt; impl Stream&lt;Item = T&gt;\nwhere\n    S1: Stream&lt;Item = T&gt;,\n    S2: Stream&lt;Item = T&gt;,\n{\n    stream1.chain(stream2)\n}\n\n/// \u30b9\u30c8\u30ea\u30fc\u30e0\u3092 take \u3067\u5207\u308a\u53d6\u308a\npub fn take_stream&lt;S, T&gt;(stream: S, n: usize) -&gt; impl Stream&lt;Item = T&gt;\nwhere\n    S: Stream&lt;Item = T&gt;,\n{\n    stream.take(n)\n}\n\n/// \u30b9\u30c8\u30ea\u30fc\u30e0\u3092 skip \u3067\u8aad\u307f\u98db\u3070\u3057\npub fn skip_stream&lt;S, T&gt;(stream: S, n: usize) -&gt; impl Stream&lt;Item = T&gt;\nwhere\n    S: Stream&lt;Item = T&gt;,\n{\n    stream.skip(n)\n}\n</code></pre>"},{"location":"rust/part-4/#93","title":"9.3 \u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0","text":"<p>\u9045\u5ef6\u8a55\u4fa1\u306e\u529b\u306b\u3088\u308a\u3001\u7121\u9650\u306e\u30b7\u30fc\u30b1\u30f3\u30b9\u3092\u8868\u73fe\u3067\u304d\u307e\u3059\u3002</p> <pre><code>/// \u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u751f\u6210\npub fn infinite_stream&lt;T, F&gt;(initial: T, f: F) -&gt; impl Stream&lt;Item = T&gt;\nwhere\n    T: Clone,\n    F: FnMut(&amp;T) -&gt; T,\n{\n    stream::unfold((initial, f), |(state, mut f)| async move {\n        let next = f(&amp;state);\n        Some((state, (next, f)))\n    })\n}\n\n/// \u30d5\u30a3\u30dc\u30ca\u30c3\u30c1\u6570\u5217\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\npub fn fibonacci_stream() -&gt; impl Stream&lt;Item = u64&gt; {\n    stream::unfold((0u64, 1u64), |(a, b)| async move {\n        Some((a, (b, a + b)))\n    })\n}\n\n/// \u7e70\u308a\u8fd4\u3057\u30b9\u30c8\u30ea\u30fc\u30e0\npub fn repeat_stream&lt;T: Clone&gt;(value: T) -&gt; impl Stream&lt;Item = T&gt; {\n    stream::repeat(value)\n}\n</code></pre> <p>\u4f7f\u7528\u4f8b\uff1a <pre><code>let stream = fibonacci_stream();\nlet first_ten: Vec&lt;u64&gt; = stream.take(10).collect().await;\nassert_eq!(first_ten, vec![0, 1, 1, 2, 3, 5, 8, 13, 21, 34]);\n</code></pre></p>"},{"location":"rust/part-4/#94","title":"9.4 \u30b9\u30c8\u30ea\u30fc\u30e0\u306e\u7573\u307f\u8fbc\u307f","text":"<p>\u30b9\u30c8\u30ea\u30fc\u30e0\u306e\u5168\u8981\u7d20\u3092\u5358\u4e00\u306e\u5024\u306b\u7573\u307f\u8fbc\u307f\u307e\u3059\u3002</p> <pre><code>/// \u30b9\u30c8\u30ea\u30fc\u30e0\u3092 fold \u3067\u7573\u307f\u8fbc\u307f\npub async fn fold_stream&lt;S, T, U, F&gt;(stream: S, initial: U, mut f: F) -&gt; U\nwhere\n    S: Stream&lt;Item = T&gt;,\n    F: FnMut(U, T) -&gt; U,\n{\n    stream\n        .fold(initial, |acc, x| {\n            let result = f(acc, x);\n            async move { result }\n        })\n        .await\n}\n\n/// \u30b9\u30c8\u30ea\u30fc\u30e0\u306e\u5408\u8a08\npub async fn sum_stream&lt;S&gt;(stream: S) -&gt; i32\nwhere\n    S: Stream&lt;Item = i32&gt;,\n{\n    stream.fold(0, |acc, x| async move { acc + x }).await\n}\n</code></pre>"},{"location":"rust/part-4/#95","title":"9.5 \u30c1\u30e3\u30f3\u30af\u3068\u79fb\u52d5\u5e73\u5747","text":"<p>\u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u30c1\u30e3\u30f3\u30af\uff08\u30b0\u30eb\u30fc\u30d7\uff09\u306b\u5206\u5272\u3057\u305f\u308a\u3001\u79fb\u52d5\u5e73\u5747\u3092\u8a08\u7b97\u3057\u305f\u308a\u3067\u304d\u307e\u3059\u3002</p> <pre><code>/// \u30c1\u30e3\u30f3\u30af\u7248\npub fn chunks_stream&lt;S, T&gt;(stream: S, size: usize) -&gt; impl Stream&lt;Item = Vec&lt;T&gt;&gt;\nwhere\n    S: Stream&lt;Item = T&gt;,\n{\n    stream.chunks(size)\n}\n\n/// \u79fb\u52d5\u5e73\u5747\u3092\u8a08\u7b97\u3059\u308b\u30b9\u30c8\u30ea\u30fc\u30e0\npub fn moving_average&lt;S&gt;(stream: S, window_size: usize) -&gt; impl Stream&lt;Item = f64&gt;\nwhere\n    S: Stream&lt;Item = f64&gt; + Send + 'static,\n{\n    stream::unfold(\n        (stream.boxed(), Vec::new(), window_size),\n        |(mut stream, mut window, size)| async move {\n            match stream.next().await {\n                Some(value) =&gt; {\n                    window.push(value);\n                    if window.len() &gt; size {\n                        window.remove(0);\n                    }\n                    let avg = window.iter().sum::&lt;f64&gt;() / window.len() as f64;\n                    Some((avg, (stream, window, size)))\n                }\n                None =&gt; None,\n            }\n        },\n    )\n}\n</code></pre>"},{"location":"rust/part-4/#96-zip","title":"9.6 zip \u3067\u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u7d50\u5408","text":"<p>2\u3064\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u8981\u7d20\u3054\u3068\u306b\u30da\u30a2\u306b\u3057\u307e\u3059\u3002</p> <pre><code>/// 2\u3064\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\u3092 zip\npub fn zip_streams&lt;S1, S2, T1, T2&gt;(stream1: S1, stream2: S2) -&gt; impl Stream&lt;Item = (T1, T2)&gt;\nwhere\n    S1: Stream&lt;Item = T1&gt;,\n    S2: Stream&lt;Item = T2&gt;,\n{\n    stream1.zip(stream2)\n}\n\n/// \u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u4ed8\u304d\u30b9\u30c8\u30ea\u30fc\u30e0\npub fn enumerate_stream&lt;S, T&gt;(stream: S) -&gt; impl Stream&lt;Item = (usize, T)&gt;\nwhere\n    S: Stream&lt;Item = T&gt;,\n{\n    stream.enumerate()\n}\n</code></pre>"},{"location":"rust/part-4/#97-flatmap","title":"9.7 flatMap \u3067\u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u5e73\u5766\u5316","text":"<p>\u30cd\u30b9\u30c8\u3055\u308c\u305f\u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u5e73\u5766\u5316\u3057\u307e\u3059\u3002</p> <pre><code>/// \u30b9\u30c8\u30ea\u30fc\u30e0\u306e\u5404\u8981\u7d20\u3092\u5c55\u958b\u3057\u3066\u5e73\u5766\u5316\npub fn flat_map_stream&lt;S, F, U, T&gt;(stream: S, f: F) -&gt; impl Stream&lt;Item = T&gt;\nwhere\n    S: Stream&lt;Item = U&gt;,\n    F: FnMut(U) -&gt; Pin&lt;Box&lt;dyn Stream&lt;Item = T&gt; + Send&gt;&gt;,\n{\n    stream.flat_map(f)\n}\n\n/// \u30cd\u30b9\u30c8\u3055\u308c\u305f\u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u5e73\u5766\u5316\npub fn flatten_stream&lt;S, Inner, T&gt;(stream: S) -&gt; impl Stream&lt;Item = T&gt;\nwhere\n    S: Stream&lt;Item = Inner&gt;,\n    Inner: Stream&lt;Item = T&gt;,\n{\n    stream.flatten()\n}\n</code></pre>"},{"location":"rust/part-4/#98","title":"9.8 \u975e\u540c\u671f\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406","text":"<p>\u5404\u8981\u7d20\u306b\u975e\u540c\u671f\u51e6\u7406\u3092\u9069\u7528\u3057\u307e\u3059\u3002</p> <pre><code>/// \u5404\u8981\u7d20\u306b\u975e\u540c\u671f\u51e6\u7406\u3092\u9069\u7528\npub fn async_map_stream&lt;S, F, Fut, T, U&gt;(stream: S, f: F) -&gt; impl Stream&lt;Item = U&gt;\nwhere\n    S: Stream&lt;Item = T&gt;,\n    F: FnMut(T) -&gt; Fut,\n    Fut: std::future::Future&lt;Output = U&gt;,\n{\n    stream.then(f)\n}\n\n/// \u30d0\u30c3\u30d5\u30a1\u4ed8\u304d\u975e\u540c\u671f\u51e6\u7406\uff08\u4e26\u884c\u5b9f\u884c\uff09\npub fn buffered_async_stream&lt;S, F, Fut, T, U&gt;(\n    stream: S,\n    f: F,\n    buffer_size: usize,\n) -&gt; impl Stream&lt;Item = U&gt;\nwhere\n    S: Stream&lt;Item = T&gt;,\n    F: FnMut(T) -&gt; Fut,\n    Fut: std::future::Future&lt;Output = U&gt;,\n{\n    stream.map(f).buffered(buffer_size)\n}\n</code></pre> <p><code>buffered</code> \u3092\u4f7f\u3046\u3068\u3001\u6307\u5b9a\u3057\u305f\u6570\u306e Future \u3092\u4e26\u884c\u5b9f\u884c\u3067\u304d\u307e\u3059\u3002</p>"},{"location":"rust/part-4/#99","title":"9.9 \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":"<p><code>Result</code> \u3092\u542b\u3080\u30b9\u30c8\u30ea\u30fc\u30e0\u306e\u51e6\u7406\u30d1\u30bf\u30fc\u30f3\u3067\u3059\u3002</p> <pre><code>/// Result \u3092\u542b\u3080\u30b9\u30c8\u30ea\u30fc\u30e0\u304b\u3089\u6210\u529f\u5024\u306e\u307f\u3092\u62bd\u51fa\npub fn filter_ok_stream&lt;S, T, E&gt;(stream: S) -&gt; impl Stream&lt;Item = T&gt;\nwhere\n    S: Stream&lt;Item = Result&lt;T, E&gt;&gt;,\n{\n    stream.filter_map(|r| async move { r.ok() })\n}\n\n/// \u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406\u4e2d\u306e\u30a8\u30e9\u30fc\u3092\u53ce\u96c6\npub async fn collect_results_stream&lt;S, T, E&gt;(stream: S) -&gt; Result&lt;Vec&lt;T&gt;, E&gt;\nwhere\n    S: Stream&lt;Item = Result&lt;T, E&gt;&gt;,\n{\n    stream.collect::&lt;Vec&lt;_&gt;&gt;().await.into_iter().collect()\n}\n</code></pre>"},{"location":"rust/part-4/#910","title":"9.10 \u30a4\u30d9\u30f3\u30c8\u51e6\u7406\u30b7\u30df\u30e5\u30ec\u30fc\u30b7\u30e7\u30f3","text":"<p>\u5b9f\u969b\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3067\u306f\u3001\u30a4\u30d9\u30f3\u30c8\u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u51e6\u7406\u3059\u308b\u3053\u3068\u304c\u591a\u3044\u3067\u3059\u3002</p> <pre><code>/// \u30a4\u30d9\u30f3\u30c8\u306e\u7a2e\u985e\n#[derive(Debug, Clone, PartialEq)]\npub enum Event {\n    Click { x: i32, y: i32 },\n    KeyPress { key: char },\n    Scroll { delta: i32 },\n}\n\n/// \u30a4\u30d9\u30f3\u30c8\u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\npub fn filter_clicks&lt;S&gt;(stream: S) -&gt; impl Stream&lt;Item = Event&gt;\nwhere\n    S: Stream&lt;Item = Event&gt;,\n{\n    stream.filter(|e| {\n        let is_click = matches!(e, Event::Click { .. });\n        async move { is_click }\n    })\n}\n\n/// \u30a4\u30d9\u30f3\u30c8\u3092\u96c6\u8a08\npub async fn count_events&lt;S&gt;(stream: S) -&gt; (usize, usize, usize)\nwhere\n    S: Stream&lt;Item = Event&gt;,\n{\n    stream\n        .fold((0, 0, 0), |(clicks, keys, scrolls), event| async move {\n            match event {\n                Event::Click { .. } =&gt; (clicks + 1, keys, scrolls),\n                Event::KeyPress { .. } =&gt; (clicks, keys + 1, scrolls),\n                Event::Scroll { .. } =&gt; (clicks, keys, scrolls + 1),\n            }\n        })\n        .await\n}\n</code></pre>"},{"location":"rust/part-4/#scala","title":"Scala \u3068\u306e\u5bfe\u6bd4","text":"\u6982\u5ff5 Scala Rust \u526f\u4f5c\u7528\u306e\u9045\u5ef6 <code>IO[A]</code> <code>impl Future&lt;Output = A&gt;</code> \u526f\u4f5c\u7528\u306e\u5b9f\u884c <code>unsafeRunSync()</code> <code>.await</code> \u30b9\u30c8\u30ea\u30fc\u30e0 <code>fs2.Stream[F, A]</code> <code>impl Stream&lt;Item = A&gt;</code> \u30a8\u30e9\u30fc <code>IO[Either[E, A]]</code> <code>Result&lt;A, E&gt;</code> \u4e26\u884c\u5b9f\u884c <code>parTraverse</code> <code>join_all</code> / <code>buffered</code> \u7121\u9650\u30b7\u30fc\u30b1\u30f3\u30b9 <code>Stream.iterate</code> <code>stream::unfold</code>"},{"location":"rust/part-4/#_2","title":"\u307e\u3068\u3081","text":"<p>Part IV \u3067\u306f\u4ee5\u4e0b\u3092\u5b66\u3073\u307e\u3057\u305f\uff1a</p> <ol> <li>\u526f\u4f5c\u7528\u306e\u7ba1\u7406: <code>async/await</code> \u3067\u526f\u4f5c\u7528\u3092\u660e\u793a\u7684\u306b\u9045\u5ef6\u5b9f\u884c</li> <li>\u7d14\u7c8b\u95a2\u6570\u3068\u306e\u5206\u96e2: \u30d3\u30b8\u30cd\u30b9\u30ed\u30b8\u30c3\u30af\u3092\u7d14\u7c8b\u95a2\u6570\u3068\u3057\u3066\u5b9f\u88c5</li> <li>\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0: <code>Result</code> \u3068\u306e\u7d44\u307f\u5408\u308f\u305b\u3067\u5805\u7262\u306a\u51e6\u7406</li> <li>\u30ea\u30c8\u30e9\u30a4\u30d1\u30bf\u30fc\u30f3: \u6c4e\u7528\u7684\u306a\u30ea\u30c8\u30e9\u30a4\u95a2\u6570\u306e\u5b9f\u88c5</li> <li>\u4e26\u884c\u51e6\u7406: <code>join_all</code> \u3067\u8907\u6570\u306e\u975e\u540c\u671f\u51e6\u7406\u3092\u4e26\u884c\u5b9f\u884c</li> <li>\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406: \u9045\u5ef6\u8a55\u4fa1\u3055\u308c\u308b\u30b7\u30fc\u30b1\u30f3\u30b9\u306e\u64cd\u4f5c</li> <li>\u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0: <code>unfold</code> \u306b\u3088\u308b\u7121\u9650\u30b7\u30fc\u30b1\u30f3\u30b9\u306e\u8868\u73fe</li> <li>\u30a4\u30d9\u30f3\u30c8\u51e6\u7406: \u5b9f\u969b\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3067\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\u6d3b\u7528</li> </ol> <p>Rust \u306e <code>async/await</code> \u3068 <code>futures::Stream</code> \u306f\u3001Scala \u306e IO \u30e2\u30ca\u30c9\u3068 fs2 Stream \u3068\u540c\u7b49\u306e\u8868\u73fe\u529b\u3092\u6301\u3061\u307e\u3059\u3002\u578b\u30b7\u30b9\u30c6\u30e0\u306b\u3088\u308b\u5b89\u5168\u6027\u3068\u3001\u30bc\u30ed\u30b3\u30b9\u30c8\u62bd\u8c61\u5316\u306b\u3088\u308b\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u3092\u4e21\u7acb\u3057\u3066\u3044\u307e\u3059\u3002</p>"},{"location":"rust/part-4/#_3","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part V \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u6271\u3046\u4e88\u5b9a\u3067\u3059\uff1a</p> <ul> <li>\u578b\u30af\u30e9\u30b9\u30d1\u30bf\u30fc\u30f3</li> <li>\u30e2\u30ca\u30c9\u5909\u63db\u5b50</li> <li>\u4f9d\u5b58\u6027\u6ce8\u5165</li> <li>\u30a8\u30d5\u30a7\u30af\u30c8\u30b7\u30b9\u30c6\u30e0</li> </ul> <p>\u3053\u308c\u3089\u306e\u9ad8\u5ea6\u306a\u30d1\u30bf\u30fc\u30f3\u3092\u5b66\u3076\u3053\u3068\u3067\u3001\u3088\u308a\u5927\u898f\u6a21\u3067\u4fdd\u5b88\u6027\u306e\u9ad8\u3044\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u69cb\u7bc9\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002</p>"},{"location":"rust/part-5/","title":"Rust \u3067\u5b66\u3076\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0 Part V: \u4e26\u884c\u51e6\u7406","text":""},{"location":"rust/part-5/#_1","title":"\u306f\u3058\u3081\u306b","text":"<p>Part IV \u3067\u306f async/await \u3068\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406\u3092\u5b66\u3073\u307e\u3057\u305f\u3002Part V \u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u4e26\u884c\u51e6\u7406\u3092\u6271\u3044\u307e\u3059\u3002</p> <p>Scala \u3067\u306f Ref\uff08\u30a2\u30c8\u30df\u30c3\u30af\u53c2\u7167\uff09\u3068 Fiber\uff08\u8efd\u91cf\u30b9\u30ec\u30c3\u30c9\uff09\u3092\u4f7f\u3044\u307e\u3059\u304c\u3001Rust \u3067\u306f <code>Arc</code>\u3001<code>Mutex</code>/<code>RwLock</code>\u3001tokio \u30bf\u30b9\u30af\u3001\u305d\u3057\u3066\u30c1\u30e3\u30cd\u30eb\u3092\u4f7f\u3063\u3066\u540c\u69d8\u306e\u6982\u5ff5\u3092\u5b9f\u73fe\u3057\u307e\u3059\u3002</p>"},{"location":"rust/part-5/#10","title":"\u7b2c10\u7ae0: \u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406","text":""},{"location":"rust/part-5/#101-arc-mutex","title":"10.1 \u5171\u6709\u72b6\u614b\u306e\u57fa\u672c - Arc \u3068 Mutex","text":"<p>Rust \u306e\u6240\u6709\u6a29\u30b7\u30b9\u30c6\u30e0\u3067\u306f\u3001\u8907\u6570\u306e\u30b9\u30ec\u30c3\u30c9\u304b\u3089\u30c7\u30fc\u30bf\u3092\u5171\u6709\u3059\u308b\u305f\u3081\u306b <code>Arc</code>\uff08Atomic Reference Counting\uff09\u3068 <code>Mutex</code> \u3092\u7d44\u307f\u5408\u308f\u305b\u307e\u3059\u3002</p> <pre><code>use std::sync::Arc;\nuse tokio::sync::Mutex;\n\n/// \u30a2\u30c8\u30df\u30c3\u30af\u30ab\u30a6\u30f3\u30bf\u30fc\n#[derive(Clone)]\npub struct AtomicCounter {\n    value: Arc&lt;Mutex&lt;i32&gt;&gt;,\n}\n\nimpl AtomicCounter {\n    pub fn new(initial: i32) -&gt; Self {\n        Self {\n            value: Arc::new(Mutex::new(initial)),\n        }\n    }\n\n    pub async fn get(&amp;self) -&gt; i32 {\n        *self.value.lock().await\n    }\n\n    pub async fn increment(&amp;self) {\n        let mut guard = self.value.lock().await;\n        *guard += 1;\n    }\n\n    pub async fn update&lt;F&gt;(&amp;self, f: F)\n    where\n        F: FnOnce(i32) -&gt; i32,\n    {\n        let mut guard = self.value.lock().await;\n        *guard = f(*guard);\n    }\n}\n</code></pre> <p>Scala \u306e <code>Ref</code> \u3068\u6bd4\u8f03\u3059\u308b\u3068\uff1a</p> Scala Rust <code>Ref.of[IO, Int](0)</code> <code>Arc::new(Mutex::new(0))</code> <code>ref.get</code> <code>arc.lock().await</code> <code>ref.update(_ + 1)</code> <code>*guard += 1</code>"},{"location":"rust/part-5/#102-rwlock-","title":"10.2 RwLock - \u8aad\u307f\u66f8\u304d\u30ed\u30c3\u30af","text":"<p>\u8907\u6570\u306e\u8aad\u307f\u53d6\u308a\u3092\u540c\u6642\u306b\u8a31\u53ef\u3057\u3064\u3064\u3001\u66f8\u304d\u8fbc\u307f\u306f\u6392\u4ed6\u7684\u306b\u884c\u3046\u5834\u5408\u306f <code>RwLock</code> \u3092\u4f7f\u3044\u307e\u3059\u3002</p> <pre><code>use tokio::sync::RwLock;\n\n#[derive(Clone)]\npub struct SharedValue&lt;T&gt; {\n    value: Arc&lt;RwLock&lt;T&gt;&gt;,\n}\n\nimpl&lt;T: Clone&gt; SharedValue&lt;T&gt; {\n    pub fn new(initial: T) -&gt; Self {\n        Self {\n            value: Arc::new(RwLock::new(initial)),\n        }\n    }\n\n    pub async fn read(&amp;self) -&gt; T {\n        self.value.read().await.clone()\n    }\n\n    pub async fn write(&amp;self, value: T) {\n        *self.value.write().await = value;\n    }\n}\n</code></pre>"},{"location":"rust/part-5/#103","title":"10.3 \u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u306e\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u96c6\u8a08","text":"<p>\u90fd\u5e02\u3078\u306e\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u3092\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u3067\u96c6\u8a08\u3059\u308b\u4f8b\u3092\u5b9f\u88c5\u3057\u307e\u3059\u3002</p> <pre><code>#[derive(Debug, Clone, PartialEq, Eq, Hash)]\npub struct City {\n    pub name: String,\n}\n\n#[derive(Debug, Clone, PartialEq, Eq)]\npub struct CityStats {\n    pub city: City,\n    pub check_ins: i32,\n}\n\n/// \u30c8\u30c3\u30d7N\u90fd\u5e02\u3092\u8a08\u7b97\uff08\u7d14\u7c8b\u95a2\u6570\uff09\npub fn top_cities(city_check_ins: &amp;HashMap&lt;City, i32&gt;, n: usize) -&gt; Vec&lt;CityStats&gt; {\n    let mut stats: Vec&lt;CityStats&gt; = city_check_ins\n        .iter()\n        .map(|(city, &amp;check_ins)| CityStats::new(city.clone(), check_ins))\n        .collect();\n\n    stats.sort_by(|a, b| b.check_ins.cmp(&amp;a.check_ins));\n    stats.truncate(n);\n    stats\n}\n</code></pre> <p>\u7d14\u7c8b\u95a2\u6570\u3068\u3057\u3066 <code>top_cities</code> \u3092\u5b9f\u88c5\u3059\u308b\u3053\u3068\u3067\u3001\u30c6\u30b9\u30c8\u304c\u5bb9\u6613\u306b\u306a\u308a\u3001\u4e26\u884c\u51e6\u7406\u306e\u8907\u96d1\u3055\u304b\u3089\u5206\u96e2\u3067\u304d\u307e\u3059\u3002</p>"},{"location":"rust/part-5/#104","title":"10.4 \u5171\u6709\u72b6\u614b\u3092\u4f7f\u3063\u305f\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u51e6\u7406","text":"<pre><code>#[derive(Clone)]\npub struct CheckInStore {\n    check_ins: Arc&lt;RwLock&lt;HashMap&lt;City, i32&gt;&gt;&gt;,\n}\n\nimpl CheckInStore {\n    pub fn new() -&gt; Self {\n        Self {\n            check_ins: Arc::new(RwLock::new(HashMap::new())),\n        }\n    }\n\n    pub async fn store_check_in(&amp;self, city: City) {\n        let mut guard = self.check_ins.write().await;\n        *guard.entry(city).or_insert(0) += 1;\n    }\n\n    pub async fn get_top(&amp;self, n: usize) -&gt; Vec&lt;CityStats&gt; {\n        let check_ins = self.check_ins.read().await;\n        top_cities(&amp;check_ins, n)\n    }\n}\n</code></pre>"},{"location":"rust/part-5/#105-tokiospawn-joinhandle","title":"10.5 \u4e26\u5217\u5b9f\u884c - tokio::spawn \u3068 JoinHandle","text":"<p>\u8907\u6570\u306e\u30bf\u30b9\u30af\u3092\u4e26\u5217\u5b9f\u884c\u3059\u308b\u306b\u306f <code>tokio::spawn</code> \u3092\u4f7f\u3044\u307e\u3059\u3002</p> <pre><code>pub async fn run_parallel&lt;T, U, F, Fut&gt;(items: Vec&lt;T&gt;, f: F) -&gt; Vec&lt;U&gt;\nwhere\n    T: Send + 'static,\n    U: Send + 'static,\n    F: Fn(T) -&gt; Fut + Send + Sync + 'static,\n    Fut: std::future::Future&lt;Output = U&gt; + Send,\n{\n    let f = Arc::new(f);\n    let handles: Vec&lt;JoinHandle&lt;U&gt;&gt; = items\n        .into_iter()\n        .map(|item| {\n            let f = Arc::clone(&amp;f);\n            tokio::spawn(async move { f(item).await })\n        })\n        .collect();\n\n    let mut results = Vec::with_capacity(handles.len());\n    for handle in handles {\n        results.push(handle.await.unwrap());\n    }\n    results\n}\n</code></pre> <p>Scala \u306e <code>parSequence</code> \u306b\u76f8\u5f53\u3057\u307e\u3059\uff1a</p> Scala Rust <code>List(io1, io2, io3).parSequence</code> <code>futures::future::join_all(...)</code> <code>List.fill(3)(io).parSequence</code> <code>tokio::spawn</code> + <code>join_all</code>"},{"location":"rust/part-5/#106","title":"10.6 \u30bf\u30b9\u30af\u306e\u30ad\u30e3\u30f3\u30bb\u30eb","text":"<p>\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u30bf\u30b9\u30af\u3092\u30ad\u30e3\u30f3\u30bb\u30eb\u3059\u308b\u306b\u306f <code>JoinHandle::abort()</code> \u3092\u4f7f\u3044\u307e\u3059\u3002</p> <pre><code>pub struct BackgroundTask&lt;T&gt; {\n    handle: JoinHandle&lt;T&gt;,\n}\n\nimpl&lt;T&gt; BackgroundTask&lt;T&gt; {\n    pub fn cancel(self) {\n        self.handle.abort();\n    }\n\n    pub async fn join(self) -&gt; Result&lt;T, tokio::task::JoinError&gt; {\n        self.handle.await\n    }\n}\n\n/// \u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u30ab\u30a6\u30f3\u30c8\u30a2\u30c3\u30d7\u3059\u308b\u30bf\u30b9\u30af\u3092\u958b\u59cb\npub fn start_counter_task(\n    interval: std::time::Duration,\n) -&gt; (AtomicCounter, BackgroundTask&lt;()&gt;) {\n    let counter = AtomicCounter::new(0);\n    let counter_clone = counter.clone();\n\n    let handle = tokio::spawn(async move {\n        loop {\n            tokio::time::sleep(interval).await;\n            counter_clone.increment().await;\n        }\n    });\n\n    (counter, BackgroundTask { handle })\n}\n</code></pre>"},{"location":"rust/part-5/#107","title":"10.7 \u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u51e6\u7406\u30b7\u30b9\u30c6\u30e0","text":"<p>\u8907\u6570\u306e\u30bf\u30b9\u30af\u3092\u4e26\u884c\u5b9f\u884c\u3057\u3066\u3001\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u306e\u51e6\u7406\u3068\u30e9\u30f3\u30ad\u30f3\u30b0\u306e\u66f4\u65b0\u3092\u884c\u3044\u307e\u3059\u3002</p> <pre><code>pub struct ProcessingCheckIns {\n    store: CheckInStore,\n    ranking: SharedValue&lt;Vec&lt;CityStats&gt;&gt;,\n    tasks: Vec&lt;JoinHandle&lt;()&gt;&gt;,\n}\n\nimpl ProcessingCheckIns {\n    pub async fn current_ranking(&amp;self) -&gt; Vec&lt;CityStats&gt; {\n        self.ranking.read().await\n    }\n\n    pub fn stop(self) {\n        for task in self.tasks {\n            task.abort();\n        }\n    }\n}\n\npub async fn process_check_ins(\n    cities: Vec&lt;City&gt;,\n    ranking_update_interval: std::time::Duration,\n) -&gt; ProcessingCheckIns {\n    let store = CheckInStore::new();\n    let ranking = SharedValue::new(Vec::new());\n\n    // \u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u51e6\u7406\u30bf\u30b9\u30af\n    let store_clone = store.clone();\n    let check_in_task = tokio::spawn(async move {\n        for city in cities {\n            store_clone.store_check_in(city).await;\n        }\n    });\n\n    // \u30e9\u30f3\u30ad\u30f3\u30b0\u66f4\u65b0\u30bf\u30b9\u30af\n    let store_clone = store.clone();\n    let ranking_clone = ranking.clone();\n    let ranking_task = tokio::spawn(async move {\n        loop {\n            tokio::time::sleep(ranking_update_interval).await;\n            let top = store_clone.get_top(3).await;\n            ranking_clone.write(top).await;\n        }\n    });\n\n    ProcessingCheckIns {\n        store,\n        ranking,\n        tasks: vec![check_in_task, ranking_task],\n    }\n}\n</code></pre>"},{"location":"rust/part-5/#11","title":"\u7b2c11\u7ae0: \u30c1\u30e3\u30cd\u30eb\u3068\u4e26\u884c\u30d1\u30bf\u30fc\u30f3","text":""},{"location":"rust/part-5/#111-mpsc-","title":"11.1 mpsc \u30c1\u30e3\u30cd\u30eb - \u8907\u6570\u9001\u4fe1\u8005\u30fb\u5358\u4e00\u53d7\u4fe1\u8005","text":"<p>Go \u306e goroutine \u3068 channel \u306b\u4f3c\u305f\u6982\u5ff5\u3067\u3001\u4e26\u884c\u51e6\u7406\u9593\u306e\u901a\u4fe1\u3092\u884c\u3044\u307e\u3059\u3002</p> <pre><code>use tokio::sync::mpsc;\n\npub async fn basic_mpsc_example() -&gt; Vec&lt;i32&gt; {\n    let (tx, mut rx) = mpsc::channel(10);\n\n    // \u9001\u4fe1\u30bf\u30b9\u30af\n    tokio::spawn(async move {\n        for i in 1..=3 {\n            tx.send(i).await.unwrap();\n        }\n    });\n\n    // \u53d7\u4fe1\n    let mut results = Vec::new();\n    while let Some(value) = rx.recv().await {\n        results.push(value);\n    }\n\n    results\n}\n</code></pre>"},{"location":"rust/part-5/#112-oneshot-","title":"11.2 oneshot \u30c1\u30e3\u30cd\u30eb - \u4e00\u56de\u9650\u308a\u306e\u901a\u4fe1","text":"<p>\u7d50\u679c\u3092\u4e00\u5ea6\u3060\u3051\u8fd4\u3059\u5834\u5408\u306b\u4f7f\u3044\u307e\u3059\u3002</p> <pre><code>use tokio::sync::oneshot;\n\npub async fn compute_with_oneshot(input: i32) -&gt; i32 {\n    let (tx, rx) = oneshot::channel();\n\n    tokio::spawn(async move {\n        let result = input * input;\n        tx.send(result).unwrap();\n    });\n\n    rx.await.unwrap()\n}\n\n/// \u8907\u6570\u306e\u8a08\u7b97\u3092\u4e26\u5217\u5b9f\u884c\u3057\u3066\u7d50\u679c\u3092\u53ce\u96c6\npub async fn parallel_compute(inputs: Vec&lt;i32&gt;) -&gt; Vec&lt;i32&gt; {\n    let mut receivers = Vec::with_capacity(inputs.len());\n\n    for input in inputs {\n        let (tx, rx) = oneshot::channel();\n        tokio::spawn(async move {\n            let result = input * input;\n            let _ = tx.send(result);\n        });\n        receivers.push(rx);\n    }\n\n    let mut results = Vec::with_capacity(receivers.len());\n    for rx in receivers {\n        results.push(rx.await.unwrap());\n    }\n    results\n}\n</code></pre>"},{"location":"rust/part-5/#113-broadcast-","title":"11.3 broadcast \u30c1\u30e3\u30cd\u30eb - \u8907\u6570\u53d7\u4fe1\u8005","text":"<p>\u8907\u6570\u306e\u53d7\u4fe1\u8005\u306b\u540c\u3058\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u914d\u4fe1\u3057\u307e\u3059\u3002</p> <pre><code>use tokio::sync::broadcast;\n\npub async fn broadcast_example(receiver_count: usize) -&gt; Vec&lt;Vec&lt;String&gt;&gt; {\n    let (tx, _) = broadcast::channel(16);\n\n    // \u53d7\u4fe1\u30bf\u30b9\u30af\u3092\u8d77\u52d5\n    let mut handles = Vec::new();\n    for _ in 0..receiver_count {\n        let mut rx = tx.subscribe();\n        handles.push(tokio::spawn(async move {\n            let mut received = Vec::new();\n            while let Ok(msg) = rx.recv().await {\n                received.push(msg);\n            }\n            received\n        }));\n    }\n\n    // \u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u9001\u4fe1\n    tx.send(\"Hello\".to_string()).unwrap();\n    tx.send(\"World\".to_string()).unwrap();\n    drop(tx);\n\n    // \u7d50\u679c\u3092\u53ce\u96c6\n    let mut results = Vec::new();\n    for handle in handles {\n        results.push(handle.await.unwrap());\n    }\n    results\n}\n</code></pre>"},{"location":"rust/part-5/#114","title":"11.4 \u30ef\u30fc\u30ab\u30fc\u30d7\u30fc\u30eb\u30d1\u30bf\u30fc\u30f3","text":"<p>\u56fa\u5b9a\u6570\u306e\u30ef\u30fc\u30ab\u30fc\u3067\u4e26\u5217\u51e6\u7406\u3092\u884c\u3046\u30d1\u30bf\u30fc\u30f3\u3067\u3059\u3002</p> <pre><code>pub async fn worker_pool&lt;T, U, F&gt;(items: Vec&lt;T&gt;, worker_count: usize, f: F) -&gt; Vec&lt;U&gt;\nwhere\n    T: Send + 'static,\n    U: Send + 'static,\n    F: Fn(T) -&gt; U + Send + Sync + Clone + 'static,\n{\n    let (work_tx, work_rx) = async_channel::bounded(items.len());\n    let (result_tx, mut result_rx) = mpsc::channel(items.len());\n\n    let work_rx = Arc::new(work_rx);\n\n    // \u30ef\u30fc\u30ab\u30fc\u3092\u8d77\u52d5\n    let mut handles = Vec::new();\n    for _ in 0..worker_count {\n        let work_rx = Arc::clone(&amp;work_rx);\n        let result_tx = result_tx.clone();\n        let f = f.clone();\n\n        handles.push(tokio::spawn(async move {\n            while let Ok(item) = work_rx.recv().await {\n                let result = f(item);\n                let _ = result_tx.send(result).await;\n            }\n        }));\n    }\n\n    // \u4f5c\u696d\u3092\u30ad\u30e5\u30fc\u306b\u8ffd\u52a0\n    for item in items {\n        work_tx.send(item).await.unwrap();\n    }\n    work_tx.close();\n    drop(result_tx);\n\n    // \u7d50\u679c\u3092\u53ce\u96c6\n    let mut results = Vec::new();\n    while let Some(result) = result_rx.recv().await {\n        results.push(result);\n    }\n\n    results\n}\n</code></pre>"},{"location":"rust/part-5/#115","title":"11.5 \u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u30d1\u30bf\u30fc\u30f3","text":"<p>\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406\u3092\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u5f62\u5f0f\u3067\u69cb\u7bc9\u3057\u307e\u3059\u3002</p> <pre><code>pub struct Pipeline&lt;T&gt; {\n    receiver: mpsc::Receiver&lt;T&gt;,\n}\n\nimpl&lt;T: Send + 'static&gt; Pipeline&lt;T&gt; {\n    pub fn from_iter&lt;I&gt;(iter: I) -&gt; Self\n    where\n        I: IntoIterator&lt;Item = T&gt; + Send + 'static,\n        I::IntoIter: Send,\n    {\n        let (tx, rx) = mpsc::channel(100);\n        tokio::spawn(async move {\n            for item in iter {\n                if tx.send(item).await.is_err() { break; }\n            }\n        });\n        Pipeline { receiver: rx }\n    }\n\n    pub fn map&lt;U, F&gt;(self, f: F) -&gt; Pipeline&lt;U&gt;\n    where\n        U: Send + 'static,\n        F: Fn(T) -&gt; U + Send + 'static,\n    {\n        let (tx, rx) = mpsc::channel(100);\n        let mut receiver = self.receiver;\n        tokio::spawn(async move {\n            while let Some(item) = receiver.recv().await {\n                if tx.send(f(item)).await.is_err() { break; }\n            }\n        });\n        Pipeline { receiver: rx }\n    }\n\n    pub async fn collect(mut self) -&gt; Vec&lt;T&gt; {\n        let mut results = Vec::new();\n        while let Some(item) = self.receiver.recv().await {\n            results.push(item);\n        }\n        results\n    }\n}\n\n// \u4f7f\u7528\u4f8b\nlet results = Pipeline::from_iter(1..=10)\n    .map(|x| x * 2)\n    .filter(|x| *x &gt; 10)\n    .collect()\n    .await;\n// [12, 14, 16, 18, 20]\n</code></pre>"},{"location":"rust/part-5/#116","title":"11.6 \u30a2\u30af\u30bf\u30fc\u30d1\u30bf\u30fc\u30f3","text":"<p>\u30e1\u30c3\u30bb\u30fc\u30b8\u30d1\u30c3\u30b7\u30f3\u30b0\u3067\u72b6\u614b\u3092\u7ba1\u7406\u3059\u308b\u30a2\u30af\u30bf\u30fc\u30e2\u30c7\u30eb\u3092\u5b9f\u88c5\u3057\u307e\u3059\u3002</p> <pre><code>pub enum CounterMessage {\n    Increment,\n    Decrement,\n    Get(oneshot::Sender&lt;i32&gt;),\n    Stop,\n}\n\npub struct CounterActor {\n    sender: mpsc::Sender&lt;CounterMessage&gt;,\n}\n\nimpl CounterActor {\n    pub fn new(initial: i32) -&gt; Self {\n        let (tx, mut rx) = mpsc::channel::&lt;CounterMessage&gt;(32);\n\n        tokio::spawn(async move {\n            let mut value = initial;\n\n            while let Some(msg) = rx.recv().await {\n                match msg {\n                    CounterMessage::Increment =&gt; value += 1,\n                    CounterMessage::Decrement =&gt; value -= 1,\n                    CounterMessage::Get(reply) =&gt; {\n                        let _ = reply.send(value);\n                    }\n                    CounterMessage::Stop =&gt; break,\n                }\n            }\n        });\n\n        CounterActor { sender: tx }\n    }\n\n    pub async fn increment(&amp;self) {\n        let _ = self.sender.send(CounterMessage::Increment).await;\n    }\n\n    pub async fn get(&amp;self) -&gt; i32 {\n        let (tx, rx) = oneshot::channel();\n        let _ = self.sender.send(CounterMessage::Get(tx)).await;\n        rx.await.unwrap_or(0)\n    }\n}\n</code></pre>"},{"location":"rust/part-5/#117","title":"11.7 \u9280\u884c\u53e3\u5ea7\u30a2\u30af\u30bf\u30fc","text":"<p>\u3088\u308a\u5b9f\u8df5\u7684\u306a\u30a2\u30af\u30bf\u30fc\u306e\u4f8b\u3068\u3057\u3066\u3001\u9280\u884c\u53e3\u5ea7\u3092\u5b9f\u88c5\u3057\u307e\u3059\u3002</p> <pre><code>pub enum BankMessage {\n    Deposit(i32),\n    Withdraw(i32, oneshot::Sender&lt;Result&lt;(), String&gt;&gt;),\n    GetBalance(oneshot::Sender&lt;i32&gt;),\n    Stop,\n}\n\npub struct BankAccount {\n    sender: mpsc::Sender&lt;BankMessage&gt;,\n}\n\nimpl BankAccount {\n    pub fn new(initial_balance: i32) -&gt; Self {\n        let (tx, mut rx) = mpsc::channel::&lt;BankMessage&gt;(32);\n\n        tokio::spawn(async move {\n            let mut balance = initial_balance;\n\n            while let Some(msg) = rx.recv().await {\n                match msg {\n                    BankMessage::Deposit(amount) =&gt; balance += amount,\n                    BankMessage::Withdraw(amount, reply) =&gt; {\n                        if balance &gt;= amount {\n                            balance -= amount;\n                            let _ = reply.send(Ok(()));\n                        } else {\n                            let _ = reply.send(Err(\"Insufficient funds\".to_string()));\n                        }\n                    }\n                    BankMessage::GetBalance(reply) =&gt; { let _ = reply.send(balance); }\n                    BankMessage::Stop =&gt; break,\n                }\n            }\n        });\n\n        BankAccount { sender: tx }\n    }\n\n    pub async fn withdraw(&amp;self, amount: i32) -&gt; Result&lt;(), String&gt; {\n        let (tx, rx) = oneshot::channel();\n        let _ = self.sender.send(BankMessage::Withdraw(amount, tx)).await;\n        rx.await.unwrap_or(Err(\"Actor not responding\".to_string()))\n    }\n}\n</code></pre>"},{"location":"rust/part-5/#118","title":"11.8 \u30a4\u30d9\u30f3\u30c8\u30d0\u30b9","text":"<p>Pub/Sub \u30d1\u30bf\u30fc\u30f3\u3067\u30a4\u30d9\u30f3\u30c8\u3092\u914d\u4fe1\u3057\u307e\u3059\u3002</p> <pre><code>#[derive(Debug, Clone)]\npub enum Event {\n    UserLoggedIn { user_id: String },\n    UserLoggedOut { user_id: String },\n    MessageSent { from: String, to: String, content: String },\n}\n\npub struct EventBus {\n    sender: broadcast::Sender&lt;Event&gt;,\n}\n\nimpl EventBus {\n    pub fn new() -&gt; Self {\n        let (sender, _) = broadcast::channel(100);\n        EventBus { sender }\n    }\n\n    pub fn subscribe(&amp;self) -&gt; broadcast::Receiver&lt;Event&gt; {\n        self.sender.subscribe()\n    }\n\n    pub fn publish(&amp;self, event: Event) {\n        let _ = self.sender.send(event);\n    }\n}\n</code></pre>"},{"location":"rust/part-5/#119","title":"11.9 \u30bb\u30de\u30d5\u30a9\u306b\u3088\u308b\u540c\u6642\u5b9f\u884c\u5236\u9650","text":"<p>\u540c\u6642\u5b9f\u884c\u6570\u3092\u5236\u9650\u3059\u308b\u5834\u5408\u306f <code>Semaphore</code> \u3092\u4f7f\u3044\u307e\u3059\u3002</p> <pre><code>use tokio::sync::Semaphore;\n\npub async fn rate_limited_process&lt;T, U, F&gt;(\n    items: Vec&lt;T&gt;,\n    max_concurrent: usize,\n    f: F,\n) -&gt; Vec&lt;U&gt;\nwhere\n    T: Send + 'static,\n    U: Send + Clone + 'static,\n    F: Fn(T) -&gt; U + Send + Sync + Clone + 'static,\n{\n    let semaphore = Arc::new(Semaphore::new(max_concurrent));\n    let results = Arc::new(Mutex::new(Vec::with_capacity(items.len())));\n\n    let mut handles = Vec::new();\n    for item in items {\n        let semaphore = Arc::clone(&amp;semaphore);\n        let results = Arc::clone(&amp;results);\n        let f = f.clone();\n\n        handles.push(tokio::spawn(async move {\n            let _permit = semaphore.acquire().await.unwrap();\n            let result = f(item);\n            results.lock().await.push(result);\n        }));\n    }\n\n    for handle in handles {\n        let _ = handle.await;\n    }\n\n    // ...\n}\n</code></pre>"},{"location":"rust/part-5/#scala","title":"Scala \u3068\u306e\u5bfe\u6bd4","text":"\u6982\u5ff5 Scala (cats-effect) Rust (tokio) \u30a2\u30c8\u30df\u30c3\u30af\u53c2\u7167 <code>Ref[IO, A]</code> <code>Arc&lt;Mutex&lt;A&gt;&gt;</code> / <code>Arc&lt;RwLock&lt;A&gt;&gt;</code> \u8efd\u91cf\u30b9\u30ec\u30c3\u30c9 <code>Fiber[IO, E, A]</code> <code>JoinHandle&lt;A&gt;</code> \u4e26\u5217\u5b9f\u884c <code>parSequence</code> <code>join_all</code> / <code>tokio::spawn</code> \u6c38\u7d9a\u5b9f\u884c <code>foreverM</code> <code>loop { ... }</code> \u30ad\u30e3\u30f3\u30bb\u30eb <code>fiber.cancel</code> <code>handle.abort()</code> \u30c1\u30e3\u30cd\u30eb <code>Queue[IO, A]</code> <code>mpsc::channel</code> \u540c\u6642\u5b9f\u884c\u5236\u9650 <code>Semaphore</code> <code>tokio::sync::Semaphore</code>"},{"location":"rust/part-5/#_2","title":"\u307e\u3068\u3081","text":"<p>Part V \u3067\u306f\u4ee5\u4e0b\u3092\u5b66\u3073\u307e\u3057\u305f\uff1a</p>"},{"location":"rust/part-5/#10_1","title":"\u7b2c10\u7ae0: \u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406","text":"<ol> <li>Arc \u3068 Mutex: \u5171\u6709\u72b6\u614b\u306e\u5b89\u5168\u306a\u7ba1\u7406</li> <li>RwLock: \u8aad\u307f\u66f8\u304d\u30ed\u30c3\u30af\u306b\u3088\u308b\u52b9\u7387\u7684\u306a\u5171\u6709</li> <li>tokio::spawn: \u4e26\u5217\u30bf\u30b9\u30af\u306e\u8d77\u52d5</li> <li>JoinHandle: \u30bf\u30b9\u30af\u306e\u5b8c\u4e86\u5f85\u6a5f\u3068\u30ad\u30e3\u30f3\u30bb\u30eb</li> <li>\u7d14\u7c8b\u95a2\u6570\u3068\u306e\u5206\u96e2: \u30d3\u30b8\u30cd\u30b9\u30ed\u30b8\u30c3\u30af\u3068\u4e26\u884c\u51e6\u7406\u306e\u5206\u96e2</li> </ol>"},{"location":"rust/part-5/#11_1","title":"\u7b2c11\u7ae0: \u30c1\u30e3\u30cd\u30eb\u3068\u4e26\u884c\u30d1\u30bf\u30fc\u30f3","text":"<ol> <li>mpsc: \u8907\u6570\u9001\u4fe1\u8005\u30fb\u5358\u4e00\u53d7\u4fe1\u8005\u30c1\u30e3\u30cd\u30eb</li> <li>oneshot: \u4e00\u56de\u9650\u308a\u306e\u7d50\u679c\u8fd4\u5374</li> <li>broadcast: \u8907\u6570\u53d7\u4fe1\u8005\u3078\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u914d\u4fe1</li> <li>\u30ef\u30fc\u30ab\u30fc\u30d7\u30fc\u30eb: \u56fa\u5b9a\u6570\u30ef\u30fc\u30ab\u30fc\u306b\u3088\u308b\u4e26\u5217\u51e6\u7406</li> <li>\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3: \u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406\u306e\u30d1\u30a4\u30d7\u30e9\u30a4\u30f3\u69cb\u7bc9</li> <li>\u30a2\u30af\u30bf\u30fc: \u30e1\u30c3\u30bb\u30fc\u30b8\u30d1\u30c3\u30b7\u30f3\u30b0\u306b\u3088\u308b\u72b6\u614b\u7ba1\u7406</li> <li>\u30bb\u30de\u30d5\u30a9: \u540c\u6642\u5b9f\u884c\u6570\u306e\u5236\u9650</li> </ol> <p>Rust \u306e\u6240\u6709\u6a29\u30b7\u30b9\u30c6\u30e0\u3068 tokio \u306e\u7d44\u307f\u5408\u308f\u305b\u306f\u3001\u30b3\u30f3\u30d1\u30a4\u30eb\u6642\u306b\u30c7\u30fc\u30bf\u7af6\u5408\u3092\u9632\u304e\u3064\u3064\u3001\u9ad8\u6027\u80fd\u306a\u4e26\u884c\u51e6\u7406\u3092\u5b9f\u73fe\u3057\u307e\u3059\u3002</p>"},{"location":"rust/part-5/#_3","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part VI \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u6271\u3046\u4e88\u5b9a\u3067\u3059\uff1a</p> <ul> <li>\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9</li> <li>\u30c8\u30ec\u30a4\u30c8\u306b\u3088\u308b\u62bd\u8c61\u5316</li> <li>\u30c6\u30b9\u30c8\u6226\u7565</li> <li>\u4f9d\u5b58\u6027\u6ce8\u5165</li> </ul> <p>\u3053\u308c\u3089\u306e\u30d1\u30bf\u30fc\u30f3\u3092\u5b66\u3076\u3053\u3068\u3067\u3001\u4fdd\u5b88\u6027\u306e\u9ad8\u3044\u5b9f\u969b\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u69cb\u7bc9\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002</p>"},{"location":"rust/part-6/","title":"Rust \u3067\u5b66\u3076\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0 Part VI: \u5b9f\u8df5\u7684\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9","text":""},{"location":"rust/part-6/#_1","title":"\u306f\u3058\u3081\u306b","text":"<p>Part V \u3067\u306f\u4e26\u884c\u51e6\u7406\uff08Arc\u3001Mutex\u3001\u30c1\u30e3\u30cd\u30eb\uff09\u3092\u5b66\u3073\u307e\u3057\u305f\u3002Part VI \u3067\u306f\u3001\u3053\u308c\u307e\u3067\u5b66\u3093\u3060 FP \u306e\u6982\u5ff5\u3092\u7dcf\u52d5\u54e1\u3057\u3066\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002</p> <p>Scala \u3067\u306f trait \u306b\u3088\u308b\u62bd\u8c61\u5316\u3001Resource \u306b\u3088\u308b\u30ea\u30bd\u30fc\u30b9\u7ba1\u7406\u3001\u305d\u3057\u3066\u30c6\u30b9\u30c8\u6226\u7565\u3092\u5b66\u3073\u307e\u3059\u304c\u3001Rust \u3067\u3082\u540c\u69d8\u306e\u30d1\u30bf\u30fc\u30f3\u3092 async-trait\u3001RAII \u30d1\u30bf\u30fc\u30f3\u3001proptest \u3092\u4f7f\u3063\u3066\u5b9f\u73fe\u3057\u307e\u3059\u3002</p>"},{"location":"rust/part-6/#12","title":"\u7b2c12\u7ae0: \u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9","text":""},{"location":"rust/part-6/#121","title":"12.1 \u30c9\u30e1\u30a4\u30f3\u30e2\u30c7\u30eb\u306e\u5b9a\u7fa9","text":"<p>\u5b9f\u969b\u306e\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u958b\u767a\u3067\u306f\u3001\u30c9\u30e1\u30a4\u30f3\u30e2\u30c7\u30eb\u3092\u9069\u5207\u306b\u5b9a\u7fa9\u3059\u308b\u3053\u3068\u304c\u91cd\u8981\u3067\u3059\u3002TravelGuide \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f8b\u306b\u898b\u3066\u3044\u304d\u307e\u3059\u3002</p> <pre><code>/// Newtype \u30d1\u30bf\u30fc\u30f3\u3067\u578b\u5b89\u5168\u306a ID \u3092\u5b9a\u7fa9\n#[derive(Debug, Clone, PartialEq, Eq, Hash)]\npub struct LocationId(pub String);\n\nimpl LocationId {\n    pub fn new(id: &amp;str) -&gt; Self {\n        Self(id.to_string())\n    }\n}\n\n/// \u30ed\u30b1\u30fc\u30b7\u30e7\u30f3\n#[derive(Debug, Clone, PartialEq, Eq)]\npub struct Location {\n    pub id: LocationId,\n    pub name: String,\n    pub population: i32,\n}\n\n/// \u30a2\u30c8\u30e9\u30af\u30b7\u30e7\u30f3\uff08\u89b3\u5149\u5730\uff09\n#[derive(Debug, Clone, PartialEq, Eq)]\npub struct Attraction {\n    pub name: String,\n    pub description: Option&lt;String&gt;,\n    pub location: Location,\n}\n\n/// \u65c5\u884c\u30ac\u30a4\u30c9 - \u6700\u7d42\u7684\u306a\u51fa\u529b\u30e2\u30c7\u30eb\n#[derive(Debug, Clone, PartialEq, Eq)]\npub struct TravelGuide {\n    pub attraction: Attraction,\n    pub subjects: Vec&lt;String&gt;,       // \u95a2\u9023\u3059\u308b\u30a2\u30fc\u30c6\u30a3\u30b9\u30c8\u3084\u6620\u753b\n    pub search_report: SearchReport, // \u691c\u7d22\u30e1\u30bf\u30c7\u30fc\u30bf\n}\n</code></pre> <p>Scala \u3068\u6bd4\u8f03\u3059\u308b\u3068\uff1a</p> Scala Rust <code>case class LocationId(value: String)</code> <code>struct LocationId(pub String)</code> <code>Option[String]</code> <code>Option&lt;String&gt;</code> <code>List[String]</code> <code>Vec&lt;String&gt;</code>"},{"location":"rust/part-6/#122-dataaccess-","title":"12.2 DataAccess \u30c8\u30ec\u30a4\u30c8 - \u4f9d\u5b58\u6027\u306e\u62bd\u8c61\u5316","text":"<p>\u5916\u90e8\u30c7\u30fc\u30bf\u30bd\u30fc\u30b9\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u30c8\u30ec\u30a4\u30c8\u3067\u62bd\u8c61\u5316\u3057\u307e\u3059\u3002\u3053\u308c\u306b\u3088\u308a\u3001\u30c6\u30b9\u30c8\u6642\u306b\u30b9\u30bf\u30d6\u5b9f\u88c5\u306b\u5dee\u3057\u66ff\u3048\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>use async_trait::async_trait;\n\n/// \u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\u5c64\u306e\u30c8\u30ec\u30a4\u30c8\n#[async_trait]\npub trait DataAccess: Send + Sync {\n    /// \u30a2\u30c8\u30e9\u30af\u30b7\u30e7\u30f3\u3092\u691c\u7d22\n    async fn find_attractions(\n        &amp;self,\n        name: &amp;str,\n        ordering: AttractionOrdering,\n        limit: usize,\n    ) -&gt; Vec&lt;Attraction&gt;;\n\n    /// \u30ed\u30b1\u30fc\u30b7\u30e7\u30f3\u304b\u3089\u30a2\u30fc\u30c6\u30a3\u30b9\u30c8\u3092\u691c\u7d22\n    async fn find_artists_from_location(\n        &amp;self,\n        location_id: &amp;LocationId,\n        limit: usize,\n    ) -&gt; Result&lt;Vec&lt;MusicArtist&gt;, String&gt;;\n\n    /// \u30ed\u30b1\u30fc\u30b7\u30e7\u30f3\u306b\u95a2\u3059\u308b\u6620\u753b\u3092\u691c\u7d22\n    async fn find_movies_about_location(\n        &amp;self,\n        location_id: &amp;LocationId,\n        limit: usize,\n    ) -&gt; Result&lt;Vec&lt;Movie&gt;, String&gt;;\n}\n</code></pre> <p>Scala \u306e trait \u3068\u6bd4\u8f03\uff1a</p> Scala Rust <code>trait DataAccess[F[_]]</code> <code>#[async_trait] trait DataAccess</code> <code>def findAttractions(...): F[List[Attraction]]</code> <code>async fn find_attractions(...) -&gt; Vec&lt;Attraction&gt;</code> <code>F[Either[String, List[A]]]</code> <code>Result&lt;Vec&lt;A&gt;, String&gt;</code>"},{"location":"rust/part-6/#123","title":"12.3 \u30c6\u30b9\u30c8\u7528\u30b9\u30bf\u30d6\u5b9f\u88c5","text":"<p>Builder \u30d1\u30bf\u30fc\u30f3\u3092\u4f7f\u3063\u3066\u67d4\u8edf\u306b\u30c6\u30b9\u30c8\u30c7\u30fc\u30bf\u3092\u8a2d\u5b9a\u3067\u304d\u308b\u30b9\u30bf\u30d6\u5b9f\u88c5\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002</p> <pre><code>pub struct StubDataAccess {\n    attractions: Vec&lt;Attraction&gt;,\n    artists: HashMap&lt;LocationId, Vec&lt;MusicArtist&gt;&gt;,\n    movies: HashMap&lt;LocationId, Vec&lt;Movie&gt;&gt;,\n    artists_error: Option&lt;String&gt;,\n    movies_error: Option&lt;String&gt;,\n}\n\nimpl StubDataAccess {\n    pub fn new() -&gt; Self {\n        Self {\n            attractions: vec![],\n            artists: HashMap::new(),\n            movies: HashMap::new(),\n            artists_error: None,\n            movies_error: None,\n        }\n    }\n\n    // Builder \u30d1\u30bf\u30fc\u30f3\u3067\u30e1\u30bd\u30c3\u30c9\u30c1\u30a7\u30fc\u30f3\n    pub fn with_attractions(mut self, attractions: Vec&lt;Attraction&gt;) -&gt; Self {\n        self.attractions = attractions;\n        self\n    }\n\n    pub fn with_artists(mut self, location_id: LocationId, artists: Vec&lt;MusicArtist&gt;) -&gt; Self {\n        self.artists.insert(location_id, artists);\n        self\n    }\n\n    pub fn with_artists_error(mut self, error: &amp;str) -&gt; Self {\n        self.artists_error = Some(error.to_string());\n        self\n    }\n}\n</code></pre> <p>\u4f7f\u7528\u4f8b\uff1a</p> <pre><code>#[tokio::test]\nasync fn test_travel_guide_with_error() {\n    let data = Arc::new(\n        StubDataAccess::new()\n            .with_attractions(vec![create_test_attraction()])\n            .with_artists_error(\"Artist service unavailable\")\n    );\n\n    let guide = travel_guide(data.as_ref(), \"Test\").await;\n\n    assert!(guide.is_some());\n    assert!(!guide.unwrap().search_report.errors.is_empty());\n}\n</code></pre>"},{"location":"rust/part-6/#124-dataaccess","title":"12.4 \u30ad\u30e3\u30c3\u30b7\u30e5\u4ed8\u304d DataAccess","text":"<p>\u30c7\u30b3\u30ec\u30fc\u30bf\u30fc\u30d1\u30bf\u30fc\u30f3\u3092\u4f7f\u3063\u3066\u3001\u65e2\u5b58\u306e DataAccess \u306b\u30ad\u30e3\u30c3\u30b7\u30e5\u6a5f\u80fd\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002</p> <pre><code>pub struct CachedDataAccess&lt;D: DataAccess&gt; {\n    inner: Arc&lt;D&gt;,\n    attractions_cache: Arc&lt;RwLock&lt;HashMap&lt;String, Vec&lt;Attraction&gt;&gt;&gt;&gt;,\n}\n\nimpl&lt;D: DataAccess&gt; CachedDataAccess&lt;D&gt; {\n    pub fn new(inner: Arc&lt;D&gt;) -&gt; Self {\n        Self {\n            inner,\n            attractions_cache: Arc::new(RwLock::new(HashMap::new())),\n        }\n    }\n\n    fn cache_key(name: &amp;str, ordering: AttractionOrdering, limit: usize) -&gt; String {\n        format!(\"{}-{:?}-{}\", name, ordering, limit)\n    }\n}\n\n#[async_trait]\nimpl&lt;D: DataAccess + 'static&gt; DataAccess for CachedDataAccess&lt;D&gt; {\n    async fn find_attractions(\n        &amp;self,\n        name: &amp;str,\n        ordering: AttractionOrdering,\n        limit: usize,\n    ) -&gt; Vec&lt;Attraction&gt; {\n        let key = Self::cache_key(name, ordering, limit);\n\n        // \u30ad\u30e3\u30c3\u30b7\u30e5\u3092\u78ba\u8a8d\uff08\u8aad\u307f\u53d6\u308a\u30ed\u30c3\u30af\uff09\n        {\n            let cache = self.attractions_cache.read().await;\n            if let Some(cached) = cache.get(&amp;key) {\n                return cached.clone();\n            }\n        }\n\n        // \u30ad\u30e3\u30c3\u30b7\u30e5\u306b\u306a\u3044\u5834\u5408\u306f\u53d6\u5f97\n        let result = self.inner.find_attractions(name, ordering, limit).await;\n\n        // \u30ad\u30e3\u30c3\u30b7\u30e5\u306b\u4fdd\u5b58\uff08\u66f8\u304d\u8fbc\u307f\u30ed\u30c3\u30af\uff09\n        {\n            let mut cache = self.attractions_cache.write().await;\n            cache.insert(key, result.clone());\n        }\n\n        result\n    }\n\n    // \u4ed6\u306e\u30e1\u30bd\u30c3\u30c9\u306f inner \u306b\u59d4\u8b72\n}\n</code></pre>"},{"location":"rust/part-6/#125-travelguide","title":"12.5 TravelGuide \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3","text":"<p>\u30c8\u30ec\u30a4\u30c8\u3092\u4f7f\u3063\u305f\u4f9d\u5b58\u6027\u6ce8\u5165\u306b\u3088\u308a\u3001\u30d3\u30b8\u30cd\u30b9\u30ed\u30b8\u30c3\u30af\u3092\u30c6\u30b9\u30c8\u53ef\u80fd\u306a\u5f62\u3067\u5b9f\u88c5\u3057\u307e\u3059\u3002</p> <pre><code>/// \u65c5\u884c\u30ac\u30a4\u30c9\u3092\u751f\u6210\npub async fn travel_guide(\n    data: &amp;dyn DataAccess,\n    attraction_name: &amp;str,\n) -&gt; Option&lt;TravelGuide&gt; {\n    // \u30a2\u30c8\u30e9\u30af\u30b7\u30e7\u30f3\u3092\u691c\u7d22\n    let attractions = data\n        .find_attractions(attraction_name, AttractionOrdering::ByLocationPopulation, 1)\n        .await;\n\n    let attraction = attractions.into_iter().next()?;\n\n    // \u95a2\u9023\u60c5\u5831\u3092\u4e26\u884c\u3057\u3066\u53d6\u5f97\n    let artists_result = data\n        .find_artists_from_location(&amp;attraction.location.id, 2)\n        .await;\n    let movies_result = data\n        .find_movies_about_location(&amp;attraction.location.id, 2)\n        .await;\n\n    // \u30a8\u30e9\u30fc\u3092\u53ce\u96c6\uff08\u5931\u6557\u3057\u3066\u3082\u7d99\u7d9a\uff09\n    let mut errors = Vec::new();\n    if let Err(e) = &amp;artists_result {\n        errors.push(e.clone());\n    }\n    if let Err(e) = &amp;movies_result {\n        errors.push(e.clone());\n    }\n\n    // \u6210\u529f\u3057\u305f\u7d50\u679c\u3092\u7d50\u5408\n    let artists = artists_result.unwrap_or_default();\n    let movies = movies_result.unwrap_or_default();\n\n    let subjects: Vec&lt;String&gt; = artists\n        .into_iter()\n        .map(|a| a.name)\n        .chain(movies.into_iter().map(|m| m.name))\n        .collect();\n\n    Some(TravelGuide::new(\n        attraction,\n        subjects,\n        SearchReport::new(1, errors),\n    ))\n}\n</code></pre>"},{"location":"rust/part-6/#126","title":"12.6 \u7d14\u7c8b\u95a2\u6570\u30e6\u30fc\u30c6\u30a3\u30ea\u30c6\u30a3","text":"<p>\u526f\u4f5c\u7528\u306e\u306a\u3044\u7d14\u7c8b\u95a2\u6570\u306f\u3001\u5358\u4f53\u30c6\u30b9\u30c8\u304c\u5bb9\u6613\u3067\u518d\u5229\u7528\u6027\u304c\u9ad8\u3044\u3067\u3059\u3002</p> <pre><code>/// \u4eba\u53e3\u3067\u30ed\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\npub fn filter_popular_locations(locations: Vec&lt;Location&gt;, min_population: i32) -&gt; Vec&lt;Location&gt; {\n    locations\n        .into_iter()\n        .filter(|loc| loc.population &gt;= min_population)\n        .collect()\n}\n\n/// \u4eba\u53e3\u9806\u3067\u30bd\u30fc\u30c8\npub fn sort_by_population(mut locations: Vec&lt;Location&gt;) -&gt; Vec&lt;Location&gt; {\n    locations.sort_by(|a, b| b.population.cmp(&amp;a.population));\n    locations\n}\n\n/// \u8907\u6570\u306e\u30b5\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u7d50\u5408\npub fn combine_subjects(subjects_list: Vec&lt;Vec&lt;String&gt;&gt;) -&gt; Vec&lt;String&gt; {\n    subjects_list.into_iter().flatten().collect()\n}\n\n/// \u8907\u6570\u306e SearchReport \u3092\u96c6\u7d04\npub fn aggregate_reports(reports: Vec&lt;SearchReport&gt;) -&gt; SearchReport {\n    let total_searched = reports.iter().map(|r| r.attractions_searched).sum();\n    let all_errors: Vec&lt;String&gt; = reports.into_iter().flat_map(|r| r.errors).collect();\n    SearchReport::new(total_searched, all_errors)\n}\n</code></pre>"},{"location":"rust/part-6/#127","title":"12.7 \u30ea\u30bd\u30fc\u30b9\u7ba1\u7406\u30d1\u30bf\u30fc\u30f3","text":"<p>Scala \u306e Resource \u306b\u76f8\u5f53\u3059\u308b\u6982\u5ff5\u3092 Rust \u3067\u5b9f\u88c5\u3057\u307e\u3059\u3002</p> <pre><code>/// \u30ea\u30bd\u30fc\u30b9\u7ba1\u7406\u306e\u30c8\u30ec\u30a4\u30c8\npub trait Resource {\n    type Item;\n\n    fn use_resource&lt;F, R&gt;(&amp;self, f: F) -&gt; R\n    where\n        F: FnOnce(&amp;Self::Item) -&gt; R;\n}\n\n/// \u30d5\u30a1\u30a4\u30eb\u30ea\u30bd\u30fc\u30b9\npub struct FileResource {\n    path: String,\n}\n\nimpl Resource for FileResource {\n    type Item = Result&lt;String, std::io::Error&gt;;\n\n    fn use_resource&lt;F, R&gt;(&amp;self, f: F) -&gt; R\n    where\n        F: FnOnce(&amp;Self::Item) -&gt; R,\n    {\n        let content = std::fs::read_to_string(&amp;self.path);\n        f(&amp;content)\n    }\n}\n</code></pre> <p>Rust \u306e\u5f37\u307f\u306f\u3001RAII\uff08Resource Acquisition Is Initialization\uff09\u30d1\u30bf\u30fc\u30f3\u306b\u3088\u308a\u3001\u30ea\u30bd\u30fc\u30b9\u306e\u89e3\u653e\u304c\u81ea\u52d5\u7684\u306b\u884c\u308f\u308c\u308b\u3053\u3068\u3067\u3059\u3002</p>"},{"location":"rust/part-6/#128","title":"12.8 \u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3","text":"<p>\u72ec\u81ea\u306e\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u578b\u3092\u5b9a\u7fa9\u3057\u3066\u3001\u578b\u5b89\u5168\u306a\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u3092\u5b9f\u88c5\u3057\u307e\u3059\u3002</p> <pre><code>#[derive(Debug, Clone, PartialEq, Eq)]\npub enum Validation&lt;T&gt; {\n    Valid(T),\n    Invalid(Vec&lt;String&gt;),\n}\n\nimpl&lt;T&gt; Validation&lt;T&gt; {\n    pub fn valid(value: T) -&gt; Self {\n        Validation::Valid(value)\n    }\n\n    pub fn invalid(errors: Vec&lt;String&gt;) -&gt; Self {\n        Validation::Invalid(errors)\n    }\n\n    pub fn is_valid(&amp;self) -&gt; bool {\n        matches!(self, Validation::Valid(_))\n    }\n\n    pub fn map&lt;U, F&gt;(self, f: F) -&gt; Validation&lt;U&gt;\n    where\n        F: FnOnce(T) -&gt; U,\n    {\n        match self {\n            Validation::Valid(v) =&gt; Validation::Valid(f(v)),\n            Validation::Invalid(e) =&gt; Validation::Invalid(e),\n        }\n    }\n\n    pub fn and_then&lt;U, F&gt;(self, f: F) -&gt; Validation&lt;U&gt;\n    where\n        F: FnOnce(T) -&gt; Validation&lt;U&gt;,\n    {\n        match self {\n            Validation::Valid(v) =&gt; f(v),\n            Validation::Invalid(e) =&gt; Validation::Invalid(e),\n        }\n    }\n}\n\n/// Location \u306e\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\npub fn validate_location(location: Location) -&gt; Validation&lt;Location&gt; {\n    let mut errors = Vec::new();\n\n    if location.name.trim().is_empty() {\n        errors.push(\"Name cannot be empty\".to_string());\n    }\n    if location.population &lt; 0 {\n        errors.push(\"Population cannot be negative\".to_string());\n    }\n\n    if errors.is_empty() {\n        Validation::valid(location)\n    } else {\n        Validation::invalid(errors)\n    }\n}\n</code></pre>"},{"location":"rust/part-6/#129","title":"12.9 \u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8","text":"<p>proptest \u3092\u4f7f\u3063\u3066\u3001\u30e9\u30f3\u30c0\u30e0\u306a\u5165\u529b\u306b\u5bfe\u3059\u308b\u4e0d\u5909\u6761\u4ef6\u3092\u30c6\u30b9\u30c8\u3057\u307e\u3059\u3002</p> <pre><code>use proptest::prelude::*;\n\nproptest! {\n    /// \u30bd\u30fc\u30c8\u306f\u8981\u7d20\u3092\u4fdd\u6301\u3059\u308b\n    #[test]\n    fn sort_by_population_preserves_elements(\n        populations in prop::collection::vec(0i32..10_000_000, 0..10)\n    ) {\n        let locations: Vec&lt;Location&gt; = populations\n            .iter()\n            .enumerate()\n            .map(|(i, &amp;pop)| Location::new(\n                LocationId::new(&amp;format!(\"loc{}\", i)),\n                &amp;format!(\"City{}\", i),\n                pop,\n            ))\n            .collect();\n\n        let sorted = sort_by_population(locations.clone());\n\n        prop_assert_eq!(sorted.len(), locations.len());\n    }\n\n    /// \u30bd\u30fc\u30c8\u7d50\u679c\u306f\u964d\u9806\n    #[test]\n    fn sort_by_population_is_sorted(\n        populations in prop::collection::vec(0i32..10_000_000, 0..10)\n    ) {\n        let locations: Vec&lt;Location&gt; = populations\n            .iter()\n            .enumerate()\n            .map(|(i, &amp;pop)| Location::new(\n                LocationId::new(&amp;format!(\"loc{}\", i)),\n                &amp;format!(\"City{}\", i),\n                pop,\n            ))\n            .collect();\n\n        let sorted = sort_by_population(locations);\n\n        for window in sorted.windows(2) {\n            prop_assert!(window[0].population &gt;= window[1].population);\n        }\n    }\n\n    /// \u7a7a\u306e\u540d\u524d\u306f\u7121\u52b9\n    #[test]\n    fn validate_location_empty_name_is_invalid(\n        population in 0i32..10_000_000\n    ) {\n        let location = Location::new(LocationId::new(\"test\"), \"\", population);\n        let result = validate_location(location);\n        prop_assert!(!result.is_valid());\n    }\n\n    /// \u8ca0\u306e\u4eba\u53e3\u306f\u7121\u52b9\n    #[test]\n    fn validate_location_negative_population_is_invalid(\n        name in \"[a-zA-Z]+\",\n        population in i32::MIN..-1i32\n    ) {\n        let location = Location::new(LocationId::new(\"test\"), &amp;name, population);\n        let result = validate_location(location);\n        prop_assert!(!result.is_valid());\n    }\n}\n</code></pre> <p>Scala \u306e ScalaCheck \u3068\u6bd4\u8f03\uff1a</p> ScalaCheck proptest <code>forAll { (n: Int) =&gt; ... }</code> <code>proptest! { fn test(n in any::&lt;i32&gt;()) { ... } }</code> <code>Gen.choose(0, 100)</code> <code>0i32..100</code> <code>Gen.listOfN(10, gen)</code> <code>prop::collection::vec(gen, 0..10)</code> <code>Prop.passed</code> <code>prop_assert!(true)</code>"},{"location":"rust/part-6/#_2","title":"\u307e\u3068\u3081","text":"<p>Part VI \u3067\u5b66\u3093\u3060\u91cd\u8981\u306a\u30dd\u30a4\u30f3\u30c8\uff1a</p> <ol> <li>\u30c9\u30e1\u30a4\u30f3\u30e2\u30c7\u30eb: Newtype \u30d1\u30bf\u30fc\u30f3\u3067\u578b\u5b89\u5168\u6027\u3092\u78ba\u4fdd</li> <li>\u30c8\u30ec\u30a4\u30c8\u62bd\u8c61\u5316: <code>async_trait</code> \u3067\u975e\u540c\u671f\u30e1\u30bd\u30c3\u30c9\u3092\u6301\u3064\u30c8\u30ec\u30a4\u30c8\u3092\u5b9a\u7fa9</li> <li>\u4f9d\u5b58\u6027\u6ce8\u5165: \u30c8\u30ec\u30a4\u30c8\u30aa\u30d6\u30b8\u30a7\u30af\u30c8 (<code>&amp;dyn DataAccess</code>) \u3067\u5b9f\u88c5\u3092\u5dee\u3057\u66ff\u3048\u53ef\u80fd\u306b</li> <li>\u30c7\u30b3\u30ec\u30fc\u30bf\u30fc\u30d1\u30bf\u30fc\u30f3: \u30ad\u30e3\u30c3\u30b7\u30e5\u306a\u3069\u306e\u6a2a\u65ad\u7684\u95a2\u5fc3\u4e8b\u3092\u5206\u96e2</li> <li>\u7d14\u7c8b\u95a2\u6570: \u30c6\u30b9\u30bf\u30d6\u30eb\u3067\u518d\u5229\u7528\u53ef\u80fd\u306a\u30e6\u30fc\u30c6\u30a3\u30ea\u30c6\u30a3</li> <li>\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3: \u72ec\u81ea\u578b\u3067\u30a8\u30e9\u30fc\u3092\u53ce\u96c6</li> <li>\u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8: \u30e9\u30f3\u30c0\u30e0\u5165\u529b\u3067\u4e0d\u5909\u6761\u4ef6\u3092\u691c\u8a3c</li> </ol> <p>Scala \u3068 Rust \u306e\u5bfe\u5fdc\u8868\uff1a</p> \u6982\u5ff5 Scala Rust \u975e\u540c\u671f\u30c8\u30ec\u30a4\u30c8 <code>trait DataAccess[F[_]]</code> <code>#[async_trait] trait DataAccess</code> \u30c6\u30b9\u30c8\u30b9\u30bf\u30d6 <code>Stub extends DataAccess</code> <code>impl DataAccess for StubDataAccess</code> \u30ea\u30bd\u30fc\u30b9\u7ba1\u7406 <code>Resource[IO, A]</code> <code>trait Resource</code> / RAII \u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3 <code>Validated[E, A]</code> <code>enum Validation&lt;T&gt;</code> \u30d7\u30ed\u30d1\u30c6\u30a3\u30c6\u30b9\u30c8 ScalaCheck proptest"},{"location":"rust/part-6/#_3","title":"\u53c2\u8003\u30ea\u30f3\u30af","text":"<ul> <li>async-trait crate</li> <li>proptest crate</li> <li>Rust Design Patterns</li> </ul>"},{"location":"scala/","title":"Grokking Functional Programming \u65e5\u672c\u8a9e\u89e3\u8aac","text":"<p>\u672c\u30b7\u30ea\u30fc\u30ba\u306f\u300cGrokking Functional Programming\u300d\uff08Micha\u0142 P\u0142achta \u8457\uff09\u306e\u5b66\u7fd2\u30b3\u30f3\u30d1\u30cb\u30aa\u30f3\u3068\u3057\u3066\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u6982\u5ff5\u3092\u65e5\u672c\u8a9e\u3067\u89e3\u8aac\u3057\u307e\u3059\u3002</p>"},{"location":"scala/#_1","title":"\u5bfe\u8c61\u8aad\u8005","text":"<ul> <li>Java \u3084 OOP \u306e\u7d4c\u9a13\u304c\u3042\u308a\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u8208\u5473\u304c\u3042\u308b\u958b\u767a\u8005</li> <li>Scala \u3092\u5b66\u3073\u305f\u3044\u304c\u3001FP \u306e\u6982\u5ff5\u304b\u3089\u7406\u89e3\u3057\u305f\u3044\u65b9</li> <li>\u5b9f\u8df5\u7684\u306a FP \u306e\u9069\u7528\u65b9\u6cd5\u3092\u77e5\u308a\u305f\u3044\u30a8\u30f3\u30b8\u30cb\u30a2</li> </ul>"},{"location":"scala/#_2","title":"\u8a18\u4e8b\u4e00\u89a7","text":""},{"location":"scala/#part-i","title":"Part I: \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u790e","text":"<p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u672c\u6982\u5ff5\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c1\u7ae0 \u547d\u4ee4\u578b vs \u95a2\u6570\u578b\u3001Scala \u57fa\u672c\u69cb\u6587 \u7b2c2\u7ae0 \u7d14\u7c8b\u95a2\u6570\u3001\u526f\u4f5c\u7528\u306e\u6392\u9664\u3001\u30c6\u30b9\u30c8\u306e\u5bb9\u6613\u3055 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: \u7d14\u7c8b\u95a2\u6570\u3001\u53c2\u7167\u900f\u904e\u6027\u3001\u526f\u4f5c\u7528</p>"},{"location":"scala/#part-ii","title":"Part II: \u95a2\u6570\u578b\u30b9\u30bf\u30a4\u30eb\u306e\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0","text":"<p>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c\u3068\u9ad8\u968e\u95a2\u6570\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c3\u7ae0 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u3001List \u64cd\u4f5c \u7b2c4\u7ae0 \u9ad8\u968e\u95a2\u6570\u3001map/filter/foldLeft \u7b2c5\u7ae0 flatMap\u3001for \u5185\u5305\u8868\u8a18 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u3001\u9ad8\u968e\u95a2\u6570\u3001flatMap\u3001for \u5185\u5305\u8868\u8a18</p>"},{"location":"scala/#part-iii-optioneither","title":"Part III: \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3068 Option/Either","text":"<p>\u578b\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c6\u7ae0 Option \u578b\u3001Some/None \u7b2c7\u7ae0 Either \u578b\u3001ADT\u3001\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: Option\u3001Either\u3001\u4ee3\u6570\u7684\u30c7\u30fc\u30bf\u578b\uff08ADT\uff09</p>"},{"location":"scala/#part-iv-io","title":"Part IV: IO \u3068\u526f\u4f5c\u7528\u306e\u7ba1\u7406","text":"<p>IO \u30e2\u30ca\u30c9\u3068\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c8\u7ae0 IO \u30e2\u30ca\u30c9\u3001cats-effect \u7b2c9\u7ae0 fs2 Stream\u3001\u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: IO \u30e2\u30ca\u30c9\u3001\u9045\u5ef6\u8a55\u4fa1\u3001\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406</p>"},{"location":"scala/#part-v","title":"Part V: \u4e26\u884c\u51e6\u7406","text":"<p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u4e26\u884c\u51e6\u7406\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c10\u7ae0 Ref\u3001Fiber\u3001parSequence <p>\u30ad\u30fc\u30ef\u30fc\u30c9: \u4e26\u884c\u51e6\u7406\u3001Ref\u3001Fiber\u3001\u8efd\u91cf\u30b9\u30ec\u30c3\u30c9</p>"},{"location":"scala/#part-vi","title":"Part VI: \u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u3068\u30c6\u30b9\u30c8","text":"<p>\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u3068\u30c6\u30b9\u30c8\u6226\u7565\u3092\u5b66\u3073\u307e\u3059\u3002</p> \u7ae0 \u30c8\u30d4\u30c3\u30af \u7b2c11\u7ae0 TravelGuide \u30a2\u30d7\u30ea\u3001Resource\u3001\u30ad\u30e3\u30c3\u30b7\u30e5 \u7b2c12\u7ae0 \u30c6\u30b9\u30c8\u6226\u7565\u3001\u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8 <p>\u30ad\u30fc\u30ef\u30fc\u30c9: Resource\u3001DataAccess \u62bd\u8c61\u5316\u3001ScalaCheck</p>"},{"location":"scala/#_3","title":"\u5b66\u7fd2\u30d1\u30b9","text":""},{"location":"scala/#_4","title":"\u4f7f\u7528\u30e9\u30a4\u30d6\u30e9\u30ea","text":"\u30e9\u30a4\u30d6\u30e9\u30ea \u7528\u9014 \u5bfe\u5fdc\u7ae0 Scala 3 \u8a00\u8a9e \u5168\u7ae0 cats-effect IO \u30e2\u30ca\u30c9 Part IV-VI fs2 \u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406 Part IV-V ScalaCheck \u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8 Part VI"},{"location":"scala/#_5","title":"\u30ea\u30dd\u30b8\u30c8\u30ea\u69cb\u6210","text":"<pre><code>grokkingfp-examples/\n\u251c\u2500\u2500 app/scala/src/main/scala/    # Scala \u306e\u30b5\u30f3\u30d7\u30eb\u30b3\u30fc\u30c9\n\u251c\u2500\u2500 app/java/src/main/java/      # Java \u306e\u6bd4\u8f03\u7528\u30b3\u30fc\u30c9\n\u251c\u2500\u2500 src/test/scala/              # \u30c6\u30b9\u30c8\u30b3\u30fc\u30c9\n\u251c\u2500\u2500 docs/journal/                # \u958b\u767a\u5c65\u6b74\n\u2514\u2500\u2500 docs/article/                # \u89e3\u8aac\u8a18\u4e8b\uff08\u672c\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\uff09\n    \u251c\u2500\u2500 index.md                 # \u3053\u306e\u8a18\u4e8b\n    \u251c\u2500\u2500 outline.md               # \u30a2\u30a6\u30c8\u30e9\u30a4\u30f3\n    \u251c\u2500\u2500 part-1.md                # Part I\n    \u251c\u2500\u2500 part-2.md                # Part II\n    \u251c\u2500\u2500 part-3.md                # Part III\n    \u251c\u2500\u2500 part-4.md                # Part IV\n    \u251c\u2500\u2500 part-5.md                # Part V\n    \u2514\u2500\u2500 part-6.md                # Part VI\n</code></pre>"},{"location":"scala/#_6","title":"\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u5229\u70b9","text":"<p>\u672c\u30b7\u30ea\u30fc\u30ba\u3092\u901a\u3058\u3066\u3001\u4ee5\u4e0b\u306e\u5229\u70b9\u3092\u5b9f\u611f\u3067\u304d\u307e\u3059:</p> <ol> <li>\u4e88\u6e2c\u53ef\u80fd\u6027 - \u7d14\u7c8b\u95a2\u6570\u306f\u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b</li> <li>\u30c6\u30b9\u30c8\u5bb9\u6613\u6027 - \u526f\u4f5c\u7528\u304c\u306a\u3044\u305f\u3081\u30c6\u30b9\u30c8\u304c\u7c21\u5358</li> <li>\u5408\u6210\u53ef\u80fd\u6027 - \u5c0f\u3055\u306a\u95a2\u6570\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u8907\u96d1\u306a\u51e6\u7406\u3092\u69cb\u7bc9</li> <li>\u4e26\u884c\u5b89\u5168\u6027 - \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u306f\u7af6\u5408\u72b6\u614b\u3092\u9632\u3050</li> <li>\u578b\u5b89\u5168\u6027 - Option\u3001Either \u3067 null \u3084\u4f8b\u5916\u3092\u578b\u3067\u8868\u73fe</li> </ol>"},{"location":"scala/#_7","title":"\u53c2\u8003\u8cc7\u6599","text":"<ul> <li>Grokking Functional Programming - \u539f\u8457</li> <li>Scala \u516c\u5f0f\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8</li> <li>cats-effect \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8</li> <li>fs2 \u30c9\u30ad\u30e5\u30e1\u30f3\u30c8</li> </ul>"},{"location":"scala/part-1/","title":"Part I: \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u790e","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\uff08FP\uff09\u306e\u57fa\u672c\u6982\u5ff5\u3092\u5b66\u3073\u307e\u3059\u3002\u547d\u4ee4\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u3068\u306e\u9055\u3044\u3092\u7406\u89e3\u3057\u3001\u7d14\u7c8b\u95a2\u6570\u306e\u5229\u70b9\u3092\u5b9f\u611f\u3059\u308b\u3053\u3068\u304c\u76ee\u6a19\u3067\u3059\u3002</p>"},{"location":"scala/part-1/#1","title":"\u7b2c1\u7ae0: \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u5165\u9580","text":""},{"location":"scala/part-1/#11-vs","title":"1.1 \u547d\u4ee4\u578b vs \u95a2\u6570\u578b","text":"<p>\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u306f\u5927\u304d\u304f\u5206\u3051\u30662\u3064\u306e\u30d1\u30e9\u30c0\u30a4\u30e0\u304c\u3042\u308a\u307e\u3059\u3002</p> <p></p> <p>\u547d\u4ee4\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306f\u300c\u3069\u3046\u3084\u308b\u304b\u300d\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002</p> <pre><code>// Java: \u547d\u4ee4\u578b\u3067\u30ef\u30fc\u30c9\u30b9\u30b3\u30a2\u3092\u8a08\u7b97\npublic static int calculateScore(String word) {\n    int score = 0;\n    for(char c : word.toCharArray()) {\n        score++;\n    }\n    return score;\n}\n</code></pre> <p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306f\u300c\u4f55\u3092\u3059\u308b\u304b\u300d\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002</p> <pre><code>// Scala: \u95a2\u6570\u578b\u3067\u30ef\u30fc\u30c9\u30b9\u30b3\u30a2\u3092\u8a08\u7b97\ndef wordScore(word: String): Int = {\n  word.length()\n}\n</code></pre>"},{"location":"scala/part-1/#12-scala","title":"1.2 Scala \u306e\u57fa\u672c\u69cb\u6587","text":"<p>Scala \u3067\u306e\u95a2\u6570\u5b9a\u7fa9\u306e\u57fa\u672c\u5f62\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch01_IntroScala.scala</code></p> <pre><code>def increment(x: Int): Int = {\n  x + 1\n}\n\ndef getFirstCharacter(s: String): Char = {\n  s.charAt(0)\n}\n\ndef wordScore(word: String): Int = {\n  word.length()\n}\n</code></pre>"},{"location":"scala/part-1/#13","title":"1.3 \u95a2\u6570\u306e\u69cb\u9020","text":""},{"location":"scala/part-1/#14","title":"1.4 \u5b66\u7fd2\u30dd\u30a4\u30f3\u30c8","text":"\u6982\u5ff5 \u547d\u4ee4\u578b \u95a2\u6570\u578b \u7126\u70b9 \u624b\u9806\uff08How\uff09 \u7d50\u679c\uff08What\uff09 \u72b6\u614b \u5909\u66f4\u3059\u308b \u5909\u63db\u3059\u308b \u30eb\u30fc\u30d7 for/while map/filter/reduce \u30c7\u30fc\u30bf \u30df\u30e5\u30fc\u30bf\u30d6\u30eb \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb"},{"location":"scala/part-1/#2","title":"\u7b2c2\u7ae0: \u7d14\u7c8b\u95a2\u6570\u3068\u30c6\u30b9\u30c8","text":""},{"location":"scala/part-1/#21","title":"2.1 \u7d14\u7c8b\u95a2\u6570\u3068\u306f","text":"<p>\u7d14\u7c8b\u95a2\u6570\uff08Pure Function\uff09\u306f\u4ee5\u4e0b\u306e\u7279\u5fb4\u3092\u6301\u3064\u95a2\u6570\u3067\u3059:</p> <ol> <li>\u540c\u3058\u5165\u529b\u306b\u306f\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3059</li> <li>\u526f\u4f5c\u7528\u304c\u306a\u3044\uff08\u5916\u90e8\u72b6\u614b\u3092\u5909\u66f4\u3057\u306a\u3044\uff09</li> </ol> <p></p>"},{"location":"scala/part-1/#22","title":"2.2 \u7d14\u7c8b\u95a2\u6570\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch02_PureFunctions.java</code></p> <pre><code>// \u7d14\u7c8b\u95a2\u6570\u306e\u4f8b\nstatic int increment(int x) {\n    return x + 1;\n}\n\nstatic int add(int a, int b) {\n    return a + b;\n}\n\nstatic char getFirstCharacter(String s) {\n    return s.charAt(0);\n}\n</code></pre> <p>\u7d14\u7c8b\u3067\u306f\u306a\u3044\u95a2\u6570\u306e\u4f8b:</p> <pre><code>// \u4e0d\u7d14\u306a\u95a2\u6570 - Math.random() \u306f\u6bce\u56de\u7570\u306a\u308b\u5024\u3092\u8fd4\u3059\nstatic double randomPart(double x) {\n    return x * Math.random();\n}\n</code></pre>"},{"location":"scala/part-1/#23","title":"2.3 \u30b7\u30e7\u30c3\u30d4\u30f3\u30b0\u30ab\u30fc\u30c8\u306e\u4f8b","text":"<p>\u72b6\u614b\u3092\u6301\u3064\u30af\u30e9\u30b9\u306e\u554f\u984c\u70b9\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/java/src/main/java/ch02_ShoppingCartDiscounts.java</code></p>"},{"location":"scala/part-1/#_1","title":"\u554f\u984c\u306e\u3042\u308b\u30b3\u30fc\u30c9","text":"<pre><code>class ShoppingCartBad {\n    private List&lt;String&gt; items = new ArrayList&lt;&gt;();\n    private boolean bookAdded = false;\n\n    public void addItem(String item) {\n        items.add(item);\n        if(item.equals(\"Book\")) {\n            bookAdded = true;\n        }\n    }\n\n    public int getDiscountPercentage() {\n        if(bookAdded) {\n            return 5;\n        } else {\n            return 0;\n        }\n    }\n\n    public List&lt;String&gt; getItems() {\n        return items;  // \u554f\u984c: \u5185\u90e8\u72b6\u614b\u3078\u306e\u53c2\u7167\u3092\u8fd4\u3057\u3066\u3044\u308b\n    }\n}\n</code></pre>"},{"location":"scala/part-1/#_2","title":"\u7d14\u7c8b\u95a2\u6570\u306b\u3088\u308b\u89e3\u6c7a","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch02_ShoppingCartDiscountsScala.scala</code></p> <pre><code>object ShoppingCart {\n  def getDiscountPercentage(items: List[String]): Int = {\n    if (items.contains(\"Book\")) {\n      5\n    } else {\n      0\n    }\n  }\n}\n</code></pre> <p></p>"},{"location":"scala/part-1/#24","title":"2.4 \u30c1\u30c3\u30d7\u8a08\u7b97\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch02_TipCalculationScala.scala</code></p> <pre><code>object TipCalculator {\n  def getTipPercentage(names: List[String]): Int = {\n    if (names.size &gt; 5) 20\n    else if (names.size &gt; 0) 10\n    else 0\n  }\n}\n</code></pre> <p>\u3053\u306e\u95a2\u6570\u306f: - 6\u4eba\u4ee5\u4e0a\u306e\u30b0\u30eb\u30fc\u30d7 \u2192 20% \u306e\u30c1\u30c3\u30d7 - 1-5\u4eba\u306e\u30b0\u30eb\u30fc\u30d7 \u2192 10% \u306e\u30c1\u30c3\u30d7 - 0\u4eba\uff08\u7a7a\u30ea\u30b9\u30c8\uff09 \u2192 0% \u306e\u30c1\u30c3\u30d7</p>"},{"location":"scala/part-1/#25","title":"2.5 \u7d14\u7c8b\u95a2\u6570\u306e\u30c6\u30b9\u30c8","text":"<p>\u7d14\u7c8b\u95a2\u6570\u306f\u975e\u5e38\u306b\u30c6\u30b9\u30c8\u3057\u3084\u3059\u3044\u3067\u3059\u3002</p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch02_TestingPureFunctions.scala</code></p> <pre><code>def increment(x: Int): Int = {\n  x + 1\n}\n\n// \u30c6\u30b9\u30c8\u30b1\u30fc\u30b9\nassert(increment(6) == 7)\nassert(increment(0) == 1)\nassert(increment(-6) == -5)\nassert(increment(Integer.MAX_VALUE - 1) == Integer.MAX_VALUE)\n</code></pre> <p></p>"},{"location":"scala/part-1/#26-a","title":"2.6 \u6587\u5b57 'a' \u3092\u9664\u5916\u3059\u308b\u30ef\u30fc\u30c9\u30b9\u30b3\u30a2","text":"<p>\u3088\u308a\u8907\u96d1\u306a\u4f8b\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p> <pre><code>def wordScore(word: String): Int = {\n  word.replaceAll(\"a\", \"\").length\n}\n\n// \u30c6\u30b9\u30c8\nassert(wordScore(\"Scala\") == 3)    // \"Scl\" \u2192 3\u6587\u5b57\nassert(wordScore(\"function\") == 8) // 'a' \u306a\u3057 \u2192 8\u6587\u5b57\nassert(wordScore(\"\") == 0)         // \u7a7a\u6587\u5b57 \u2192 0\u6587\u5b57\n</code></pre>"},{"location":"scala/part-1/#27","title":"2.7 \u53c2\u7167\u900f\u904e\u6027","text":"<p>\u7d14\u7c8b\u95a2\u6570\u306f\u53c2\u7167\u900f\u904e\u6027\uff08Referential Transparency\uff09\u3092\u6301\u3061\u307e\u3059\u3002</p> <p>\u5f0f\u3092\u305d\u306e\u8a55\u4fa1\u7d50\u679c\u3067\u7f6e\u304d\u63db\u3048\u3066\u3082\u3001\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u610f\u5473\u304c\u5909\u308f\u3089\u306a\u3044\u3053\u3068</p> <pre><code>// \u53c2\u7167\u900f\u904e\u6027\u306e\u4f8b\nval score1 = wordScore(\"Scala\")\nval score2 = wordScore(\"Scala\")\n// score1 \u3068 score2 \u306f\u5e38\u306b\u540c\u3058\u5024\uff083\uff09\n\n// \u4ee5\u4e0b\u306e2\u3064\u306f\u540c\u7b49\nval total1 = wordScore(\"Scala\") + wordScore(\"Java\")\nval total2 = 3 + 4  // wordScore \u306e\u7d50\u679c\u3067\u7f6e\u304d\u63db\u3048\u53ef\u80fd\n</code></pre> <p></p>"},{"location":"scala/part-1/#_3","title":"\u307e\u3068\u3081","text":""},{"location":"scala/part-1/#part-i_1","title":"Part I \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"scala/part-1/#_4","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306f\u300c\u4f55\u3092\u3059\u308b\u304b\u300d\u3092\u5ba3\u8a00\u7684\u306b\u8a18\u8ff0\u3059\u308b</li> <li>\u7d14\u7c8b\u95a2\u6570\u306f\u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3059</li> <li>\u526f\u4f5c\u7528\u3092\u907f\u3051\u308b\u3053\u3068\u3067\u30b3\u30fc\u30c9\u306e\u4e88\u6e2c\u53ef\u80fd\u6027\u304c\u5411\u4e0a\u3059\u308b</li> <li>\u7d14\u7c8b\u95a2\u6570\u306f\u30c6\u30b9\u30c8\u304c\u975e\u5e38\u306b\u7c21\u5358</li> <li>\u53c2\u7167\u900f\u904e\u6027\u306b\u3088\u308a\u3001\u30b3\u30fc\u30c9\u306e\u7406\u89e3\u3068\u63a8\u8ad6\u304c\u5bb9\u6613\u306b\u306a\u308b</li> </ol>"},{"location":"scala/part-1/#_5","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part II \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c</li> <li>\u9ad8\u968e\u95a2\u6570\uff08\u95a2\u6570\u3092\u5024\u3068\u3057\u3066\u6271\u3046\uff09</li> <li><code>flatMap</code> \u3068\u30cd\u30b9\u30c8\u69cb\u9020\u306e\u5e73\u5766\u5316</li> <li>for \u5185\u5305\u8868\u8a18</li> </ul>"},{"location":"scala/part-1/#_6","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"scala/part-1/#1_1","title":"\u554f\u984c 1: \u7d14\u7c8b\u95a2\u6570\u306e\u8b58\u5225","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u306e\u3046\u3061\u3001\u7d14\u7c8b\u95a2\u6570\u306f\u3069\u308c\u3067\u3059\u304b?</p> <pre><code>// A\ndef double(x: Int): Int = x * 2\n\n// B\nvar counter = 0\ndef incrementCounter(): Int = {\n  counter += 1\n  counter\n}\n\n// C\ndef greet(name: String): String = s\"Hello, $name!\"\n\n// D\ndef currentTime(): Long = System.currentTimeMillis()\n</code></pre> \u89e3\u7b54  **A \u3068 C \u306f\u7d14\u7c8b\u95a2\u6570**\u3067\u3059\u3002  - A: \u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3057\u3001\u526f\u4f5c\u7528\u304c\u306a\u3044 - B: \u5916\u90e8\u5909\u6570 `counter` \u3092\u5909\u66f4\u3059\u308b\u526f\u4f5c\u7528\u304c\u3042\u308b\uff08\u4e0d\u7d14\uff09 - C: \u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b\u3092\u8fd4\u3057\u3001\u526f\u4f5c\u7528\u304c\u306a\u3044 - D: \u547c\u3073\u51fa\u3059\u305f\u3073\u306b\u7570\u306a\u308b\u5024\u3092\u8fd4\u3059\uff08\u4e0d\u7d14\uff09"},{"location":"scala/part-1/#2_1","title":"\u554f\u984c 2: \u7d14\u7c8b\u95a2\u6570\u3078\u306e\u66f8\u304d\u63db\u3048","text":"<p>\u4ee5\u4e0b\u306e\u4e0d\u7d14\u306a\u95a2\u6570\u3092\u7d14\u7c8b\u95a2\u6570\u306b\u66f8\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>class Counter {\n    private int value = 0;\n\n    public int increment() {\n        value++;\n        return value;\n    }\n}\n</code></pre> \u89e3\u7b54 <pre><code>def increment(value: Int): Int = value + 1\n\n// \u4f7f\u7528\u4f8b\nval v1 = 0\nval v2 = increment(v1)  // 1\nval v3 = increment(v2)  // 2\n</code></pre>  \u72b6\u614b\u3092\u5916\u90e8\u306b\u6301\u3061\u3001\u95a2\u6570\u306f\u5024\u3092\u53d7\u3051\u53d6\u3063\u3066\u65b0\u3057\u3044\u5024\u3092\u8fd4\u3059\u3060\u3051\u306b\u3057\u307e\u3059\u3002"},{"location":"scala/part-1/#3","title":"\u554f\u984c 3: \u30c6\u30b9\u30c8\u3092\u66f8\u304f","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u306b\u5bfe\u3059\u308b\u30c6\u30b9\u30c8\u30b1\u30fc\u30b9\u3092\u8003\u3048\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>def isEven(n: Int): Boolean = n % 2 == 0\n</code></pre> \u89e3\u7b54 <pre><code>// \u57fa\u672c\u30b1\u30fc\u30b9\nassert(isEven(0) == true)\nassert(isEven(2) == true)\nassert(isEven(4) == true)\n\n// \u5947\u6570\nassert(isEven(1) == false)\nassert(isEven(3) == false)\n\n// \u8ca0\u306e\u6570\nassert(isEven(-2) == true)\nassert(isEven(-3) == false)\n\n// \u5883\u754c\u5024\nassert(isEven(Integer.MAX_VALUE) == false)\nassert(isEven(Integer.MIN_VALUE) == true)\n</code></pre>"},{"location":"scala/part-2/","title":"Part II: \u95a2\u6570\u578b\u30b9\u30bf\u30a4\u30eb\u306e\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u6838\u5fc3\u3068\u306a\u308b\u30c6\u30af\u30cb\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059\u3002\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c\u3001\u9ad8\u968e\u95a2\u6570\u3001\u305d\u3057\u3066 <code>flatMap</code> \u306b\u3088\u308b\u8907\u96d1\u306a\u30c7\u30fc\u30bf\u5909\u63db\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"scala/part-2/#3","title":"\u7b2c3\u7ae0: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u30c7\u30fc\u30bf\u64cd\u4f5c","text":""},{"location":"scala/part-2/#31","title":"3.1 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u3068\u306f","text":"<p>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\uff08\u4e0d\u5909\uff09\u3068\u306f\u3001\u4e00\u5ea6\u4f5c\u6210\u3055\u308c\u305f\u30c7\u30fc\u30bf\u304c\u5909\u66f4\u3055\u308c\u306a\u3044\u3053\u3068\u3092\u610f\u5473\u3057\u307e\u3059\u3002\u30c7\u30fc\u30bf\u3092\u300c\u5909\u66f4\u300d\u3059\u308b\u4ee3\u308f\u308a\u306b\u3001\u65b0\u3057\u3044\u30c7\u30fc\u30bf\u3092\u300c\u4f5c\u6210\u300d\u3057\u307e\u3059\u3002</p> <p></p>"},{"location":"scala/part-2/#32-list","title":"3.2 List \u306e\u57fa\u672c\u64cd\u4f5c","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch03_SlicingAndAppending.scala</code></p>"},{"location":"scala/part-2/#appended-","title":"appended - \u8981\u7d20\u306e\u8ffd\u52a0","text":"<pre><code>val appleBook      = List(\"Apple\", \"Book\")\nval appleBookMango = appleBook.appended(\"Mango\")\n\nassert(appleBook.size == 2)       // \u5143\u306e\u30ea\u30b9\u30c8\u306f\u5909\u308f\u3089\u306a\u3044\nassert(appleBookMango.size == 3)  // \u65b0\u3057\u3044\u30ea\u30b9\u30c8\u304c\u4f5c\u6210\u3055\u308c\u308b\nassert(appleBookMango == List(\"Apple\", \"Book\", \"Mango\"))\n</code></pre>"},{"location":"scala/part-2/#slice-","title":"slice - \u30ea\u30b9\u30c8\u306e\u5207\u308a\u51fa\u3057","text":"<pre><code>def firstTwo(list: List[String]): List[String] =\n  list.slice(0, 2)\n\ndef lastTwo(list: List[String]): List[String] =\n  list.slice(list.size - 2, list.size)\n\nassert(firstTwo(List(\"a\", \"b\", \"c\")) == List(\"a\", \"b\"))\nassert(lastTwo(List(\"a\", \"b\", \"c\")) == List(\"b\", \"c\"))\n</code></pre>"},{"location":"scala/part-2/#33","title":"3.3 \u30ea\u30b9\u30c8\u306e\u5909\u63db\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch03_SlicingAndAppending.scala</code></p> <pre><code>// \u6700\u521d\u306e2\u8981\u7d20\u3092\u672b\u5c3e\u306b\u79fb\u52d5\ndef movedFirstTwoToTheEnd(list: List[String]): List[String] = {\n  val firstTwo        = list.slice(0, 2)\n  val withoutFirstTwo = list.slice(2, list.size)\n  withoutFirstTwo.appendedAll(firstTwo)\n}\n\nassert(movedFirstTwoToTheEnd(List(\"a\", \"b\", \"c\")) == List(\"c\", \"a\", \"b\"))\n\n// \u6700\u5f8c\u306e\u8981\u7d20\u306e\u524d\u306b\u633f\u5165\ndef insertedBeforeLast(list: List[String], element: String): List[String] = {\n  val last        = list.slice(list.size - 1, list.size)\n  val withoutLast = list.slice(0, list.size - 1)\n  withoutLast.appended(element).appendedAll(last)\n}\n\nassert(insertedBeforeLast(List(\"a\", \"b\"), \"c\") == List(\"a\", \"c\", \"b\"))\n</code></pre>"},{"location":"scala/part-2/#34","title":"3.4 \u65c5\u7a0b\u306e\u518d\u8a08\u753b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch03_ItineraryScala.scala</code></p> <p>\u65c5\u884c\u306e\u8a08\u753b\u5909\u66f4\u3092\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306b\u884c\u3046\u4f8b\u3067\u3059\u3002</p> <pre><code>def replan(plan: List[String], newCity: String, beforeCity: String): List[String] = {\n  val beforeCityIndex = plan.indexOf(beforeCity)\n  val citiesBefore    = plan.slice(0, beforeCityIndex)\n  val citiesAfter     = plan.slice(beforeCityIndex, plan.size)\n  citiesBefore.appended(newCity).appendedAll(citiesAfter)\n}\n\nval planA = List(\"Paris\", \"Berlin\", \"Krak\u00f3w\")\nval planB = replan(planA, \"Vienna\", \"Krak\u00f3w\")\n\nassert(planB == List(\"Paris\", \"Berlin\", \"Vienna\", \"Krak\u00f3w\"))\nassert(planA == List(\"Paris\", \"Berlin\", \"Krak\u00f3w\"))  // \u5143\u306e\u8a08\u753b\u306f\u5909\u308f\u3089\u306a\u3044!\n</code></pre> <p></p>"},{"location":"scala/part-2/#35-string-list","title":"3.5 String \u3068 List \u306e\u985e\u4f3c\u6027","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch03_ListVsStringScala.scala</code></p> <p>String \u3068 List \u306f\u4f3c\u305f\u64cd\u4f5c\u304c\u3067\u304d\u307e\u3059\u3002</p> \u64cd\u4f5c List String \u7d50\u5408 <code>appendedAll</code> <code>concat</code> \u5207\u308a\u51fa\u3057 <code>slice</code> <code>substring</code> \u30b5\u30a4\u30ba <code>size</code> <code>length</code> <pre><code>// List \u306e\u64cd\u4f5c\nval abList   = List(\"a\", \"b\")\nval cdList   = List(\"c\", \"d\")\nval abcdList = abList.appendedAll(cdList)\nassert(abcdList == List(\"a\", \"b\", \"c\", \"d\"))\n\n// String \u306e\u64cd\u4f5c\nval abStr   = \"ab\"\nval cdStr   = \"cd\"\nval abcdStr = abStr.concat(cdStr)\nassert(abcdStr == \"abcd\")\n</code></pre>"},{"location":"scala/part-2/#36","title":"3.6 \u540d\u524d\u306e\u7701\u7565","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch03_AbbreviateNames.scala</code></p> <pre><code>def abbreviate(name: String): String = {\n  val initial   = name.substring(0, 1)\n  val separator = name.indexOf(' ')\n  val lastName  = name.substring(separator + 1)\n  initial + \". \" + lastName\n}\n\nassert(abbreviate(\"Alonzo Church\") == \"A. Church\")\nassert(abbreviate(\"A. Church\") == \"A. Church\")\n</code></pre>"},{"location":"scala/part-2/#4","title":"\u7b2c4\u7ae0: \u95a2\u6570\u3092\u5024\u3068\u3057\u3066\u6271\u3046","text":""},{"location":"scala/part-2/#41","title":"4.1 \u9ad8\u968e\u95a2\u6570\u3068\u306f","text":"<p>\u9ad8\u968e\u95a2\u6570\uff08Higher-Order Function\uff09\u3068\u306f\u3001\u4ee5\u4e0b\u306e\u3044\u305a\u308c\u304b\u3092\u6e80\u305f\u3059\u95a2\u6570\u3067\u3059:</p> <ol> <li>\u95a2\u6570\u3092\u5f15\u6570\u3068\u3057\u3066\u53d7\u3051\u53d6\u308b</li> <li>\u95a2\u6570\u3092\u623b\u308a\u5024\u3068\u3057\u3066\u8fd4\u3059</li> </ol> <p></p>"},{"location":"scala/part-2/#42","title":"4.2 \u95a2\u6570\u3092\u5f15\u6570\u3068\u3057\u3066\u6e21\u3059","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch04_PassingFunctions.scala</code></p>"},{"location":"scala/part-2/#sortby-","title":"sortBy - \u30bd\u30fc\u30c8\u57fa\u6e96\u3092\u95a2\u6570\u3067\u6307\u5b9a","text":"<pre><code>def score(word: String): Int = word.replaceAll(\"a\", \"\").length\n\nval words = List(\"rust\", \"java\")\nval sortedWords = words.sortBy(score)\n\nassert(sortedWords == List(\"java\", \"rust\"))\n// java: 2\u6587\u5b57 (j, v), rust: 4\u6587\u5b57 (r, u, s, t)\n</code></pre>"},{"location":"scala/part-2/#map-","title":"map - \u5404\u8981\u7d20\u3092\u5909\u63db","text":"<pre><code>def len(s: String): Int = s.length\n\nval lengths = List(\"scala\", \"rust\", \"ada\").map(len)\nassert(lengths == List(5, 4, 3))\n\ndef double(i: Int): Int = 2 * i\nval doubles = List(5, 1, 2, 4, 0).map(double)\nassert(doubles == List(10, 2, 4, 8, 0))\n</code></pre>"},{"location":"scala/part-2/#filter-","title":"filter - \u6761\u4ef6\u306b\u5408\u3046\u8981\u7d20\u3092\u62bd\u51fa","text":"<pre><code>def odd(i: Int): Boolean = i % 2 == 1\n\nval odds = List(5, 1, 2, 4, 0).filter(odd)\nassert(odds == List(5, 1))\n\ndef largerThan4(i: Int): Boolean = i &gt; 4\nval large = List(5, 1, 2, 4, 0).filter(largerThan4)\nassert(large == List(5))\n</code></pre>"},{"location":"scala/part-2/#foldleft-","title":"foldLeft - \u7573\u307f\u8fbc\u307f","text":"<pre><code>val sum = List(5, 1, 2, 4, 100).foldLeft(0)((acc, i) =&gt; acc + i)\nassert(sum == 112)\n\nval max = List(5, 1, 2, 4, 15).foldLeft(Int.MinValue)((max, i) =&gt;\n  if (i &gt; max) i else max\n)\nassert(max == 15)\n</code></pre>"},{"location":"scala/part-2/#43-case-class","title":"4.3 case class \u3068\u30d1\u30bf\u30fc\u30f3","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch04_ProgrammingLanguages.scala</code></p> <pre><code>case class ProgrammingLanguage(name: String, year: Int)\n\nval javalang  = ProgrammingLanguage(\"Java\", 1995)\nval scalalang = ProgrammingLanguage(\"Scala\", 2004)\n\nval languages = List(javalang, scalalang)\n\n// \u30d5\u30a3\u30fc\u30eb\u30c9\u306b\u30a2\u30af\u30bb\u30b9\nval names = languages.map(lang =&gt; lang.name)\nassert(names == List(\"Java\", \"Scala\"))\n\n// \u7701\u7565\u8a18\u6cd5\uff08\u30a2\u30f3\u30c0\u30fc\u30b9\u30b3\u30a2\uff09\nval names2 = languages.map(_.name)\nassert(names2 == List(\"Java\", \"Scala\"))\n\n// \u6761\u4ef6\u3067\u30d5\u30a3\u30eb\u30bf\nval young = languages.filter(_.year &gt; 2000)\nassert(young == List(scalalang))\n</code></pre>"},{"location":"scala/part-2/#44","title":"4.4 \u95a2\u6570\u3092\u8fd4\u3059\u95a2\u6570","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch04_ReturningFunctions.scala</code></p> <pre><code>def largerThan(n: Int): Int =&gt; Boolean = i =&gt; i &gt; n\n\nval large = List(5, 1, 2, 4, 0).filter(largerThan(4))\nassert(large == List(5))\n\nval medium = List(5, 1, 2, 4, 0).filter(largerThan(1))\nassert(medium == List(5, 2, 4))\n</code></pre> <p></p>"},{"location":"scala/part-2/#45","title":"4.5 \u30ab\u30ea\u30fc\u5316","text":"<p>\u30ab\u30ea\u30fc\u5316\uff08Currying\uff09\u306f\u3001\u8907\u6570\u306e\u5f15\u6570\u3092\u53d6\u308b\u95a2\u6570\u3092\u3001\u5f15\u6570\u30921\u3064\u305a\u3064\u53d6\u308b\u95a2\u6570\u306e\u30c1\u30a7\u30fc\u30f3\u306b\u5909\u63db\u3059\u308b\u6280\u6cd5\u3067\u3059\u3002</p> <pre><code>// \u901a\u5e38\u306e\u95a2\u6570\ndef largerThanNormal(n: Int, i: Int): Boolean = i &gt; n\n\n// \u30ab\u30ea\u30fc\u5316\u3055\u308c\u305f\u95a2\u6570\ndef largerThan(n: Int)(i: Int): Boolean = i &gt; n\n\n// \u4f7f\u7528\u4f8b\nval large = List(5, 1, 2, 4, 0).filter(largerThan(4))\nassert(large == List(5))\n</code></pre> <p></p>"},{"location":"scala/part-2/#46","title":"4.6 \u30ef\u30fc\u30c9\u30b9\u30b3\u30a2\u30ea\u30f3\u30b0\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch04_WordScoringScala.scala</code></p> <p>\u8907\u6570\u306e\u30b9\u30b3\u30a2\u30ea\u30f3\u30b0\u30ed\u30b8\u30c3\u30af\u3092\u7d44\u307f\u5408\u308f\u305b\u308b\u4f8b\u3067\u3059\u3002</p> <pre><code>def score(word: String): Int = word.replaceAll(\"a\", \"\").length\ndef bonus(word: String): Int = if (word.contains(\"c\")) 5 else 0\ndef penalty(word: String): Int = if (word.contains(\"s\")) 7 else 0\n\nval words = List(\"ada\", \"haskell\", \"scala\", \"java\", \"rust\")\n\n// \u95a2\u6570\u3092\u5f15\u6570\u3068\u3057\u3066\u6e21\u3059\ndef rankedWords(wordScore: String =&gt; Int, words: List[String]): List[String] = {\n  words.sortBy(wordScore).reverse\n}\n\n// \u57fa\u672c\u30b9\u30b3\u30a2\u3067\u30e9\u30f3\u30ad\u30f3\u30b0\nval ranking1 = rankedWords(score, words)\nassert(ranking1 == List(\"haskell\", \"rust\", \"scala\", \"java\", \"ada\"))\n\n// \u30dc\u30fc\u30ca\u30b9\u4ed8\u304d\u30b9\u30b3\u30a2\u3067\u30e9\u30f3\u30ad\u30f3\u30b0\nval ranking2 = rankedWords(w =&gt; score(w) + bonus(w), words)\nassert(ranking2 == List(\"scala\", \"haskell\", \"rust\", \"java\", \"ada\"))\n\n// \u30dc\u30fc\u30ca\u30b9\u3068\u30da\u30ca\u30eb\u30c6\u30a3\u4ed8\u304d\u30b9\u30b3\u30a2\u3067\u30e9\u30f3\u30ad\u30f3\u30b0\nval ranking3 = rankedWords(w =&gt; score(w) + bonus(w) - penalty(w), words)\nassert(ranking3 == List(\"java\", \"scala\", \"ada\", \"haskell\", \"rust\"))\n</code></pre>"},{"location":"scala/part-2/#5-flatmap","title":"\u7b2c5\u7ae0: flatMap \u3068\u30cd\u30b9\u30c8\u69cb\u9020","text":""},{"location":"scala/part-2/#51-flatten-flatmap","title":"5.1 flatten \u3068 flatMap","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch05_BookAdaptations.scala</code></p>"},{"location":"scala/part-2/#flatten-","title":"flatten - \u30cd\u30b9\u30c8\u3057\u305f\u30ea\u30b9\u30c8\u3092\u5e73\u5766\u5316","text":"<pre><code>case class Book(title: String, authors: List[String])\n\nval books = List(\n  Book(\"FP in Scala\", List(\"Chiusano\", \"Bjarnason\")),\n  Book(\"The Hobbit\", List(\"Tolkien\"))\n)\n\n// map \u3060\u3051\u3060\u3068\u30cd\u30b9\u30c8\u3059\u308b\nval authorLists = books.map(_.authors)\n// List(List(\"Chiusano\", \"Bjarnason\"), List(\"Tolkien\"))\n\n// flatten \u3067\u5e73\u5766\u5316\nval authors = authorLists.flatten\n// List(\"Chiusano\", \"Bjarnason\", \"Tolkien\")\n</code></pre>"},{"location":"scala/part-2/#flatmap-map-flatten","title":"flatMap = map + flatten","text":"<pre><code>// map \u3057\u3066 flatten\nval authors1 = books.map(_.authors).flatten\n\n// flatMap \u3067\u540c\u3058\u3053\u3068\u30921\u884c\u3067\nval authors2 = books.flatMap(_.authors)\n\nassert(authors1 == authors2)\n// List(\"Chiusano\", \"Bjarnason\", \"Tolkien\")\n</code></pre>"},{"location":"scala/part-2/#52-flatmap","title":"5.2 flatMap \u306b\u3088\u308b\u30ea\u30b9\u30c8\u30b5\u30a4\u30ba\u306e\u5909\u5316","text":"<pre><code>// \u8981\u7d20\u6570\u304c\u5897\u3048\u308b\nList(1, 2, 3).flatMap(i =&gt; List(i, i + 10))\n// List(1, 11, 2, 12, 3, 13) - 6\u8981\u7d20\n\n// \u8981\u7d20\u6570\u304c\u540c\u3058\nList(1, 2, 3).flatMap(i =&gt; List(i * 2))\n// List(2, 4, 6) - 3\u8981\u7d20\n\n// \u8981\u7d20\u6570\u304c\u6e1b\u308b\uff08\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u52b9\u679c\uff09\nList(1, 2, 3).flatMap(i =&gt; if (i % 2 == 0) List(i) else List.empty)\n// List(2) - 1\u8981\u7d20\n</code></pre>"},{"location":"scala/part-2/#53-flatmap","title":"5.3 \u30cd\u30b9\u30c8\u3057\u305f flatMap","text":"<p>\u8907\u6570\u306e\u30ea\u30b9\u30c8\u3092\u7d44\u307f\u5408\u308f\u305b\u308b\u5834\u5408\u3001flatMap \u3092\u30cd\u30b9\u30c8\u3057\u307e\u3059\u3002</p> <pre><code>case class Book(title: String, authors: List[String])\ncase class Movie(title: String)\n\ndef bookAdaptations(author: String): List[Movie] = {\n  if (author == \"Tolkien\")\n    List(Movie(\"An Unexpected Journey\"), Movie(\"The Desolation of Smaug\"))\n  else\n    List.empty\n}\n\nval books = List(\n  Book(\"FP in Scala\", List(\"Chiusano\", \"Bjarnason\")),\n  Book(\"The Hobbit\", List(\"Tolkien\"))\n)\n\n// \u30cd\u30b9\u30c8\u3057\u305f flatMap\nval recommendations = books.flatMap(book =&gt;\n  book.authors.flatMap(author =&gt;\n    bookAdaptations(author).map(movie =&gt;\n      s\"You may like ${movie.title}, because you liked $author's ${book.title}\"\n    )\n  )\n)\n\n// \u7d50\u679c:\n// List(\n//   \"You may like An Unexpected Journey, because you liked Tolkien's The Hobbit\",\n//   \"You may like The Desolation of Smaug, because you liked Tolkien's The Hobbit\"\n// )\n</code></pre> <p></p>"},{"location":"scala/part-2/#54-for","title":"5.4 for \u5185\u5305\u8868\u8a18","text":"<p>\u30cd\u30b9\u30c8\u3057\u305f flatMap \u306f for \u5185\u5305\u8868\u8a18\u3067\u8aad\u307f\u3084\u3059\u304f\u66f8\u3051\u307e\u3059\u3002</p> <pre><code>// flatMap/map \u7248\nval c1 = books.flatMap(book =&gt;\n  book.authors.flatMap(author =&gt;\n    bookAdaptations(author).map(movie =&gt;\n      s\"You may like ${movie.title}, because you liked $author's ${book.title}\"\n    )\n  )\n)\n\n// for \u5185\u5305\u8868\u8a18\u7248\uff08\u7b49\u4fa1\uff09\nval c2 = for {\n  book   &lt;- books\n  author &lt;- book.authors\n  movie  &lt;- bookAdaptations(author)\n} yield s\"You may like ${movie.title}, because you liked $author's ${book.title}\"\n\nassert(c1 == c2)\n</code></pre> <p></p>"},{"location":"scala/part-2/#55","title":"5.5 \u5186\u5185\u306e\u70b9\u306e\u5224\u5b9a","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch05_PointsInsideCircles.scala</code></p> <p>for \u5185\u5305\u8868\u8a18\u3067\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u3082\u884c\u3046\u4f8b\u3067\u3059\u3002</p> <pre><code>case class Point(x: Int, y: Int)\n\nval points   = List(Point(5, 2), Point(1, 1))\nval radiuses = List(2, 1)\n\ndef isInside(point: Point, radius: Int): Boolean = {\n  radius * radius &gt;= point.x * point.x + point.y * point.y\n}\n\n// \u5168\u7d44\u307f\u5408\u308f\u305b\u3092\u751f\u6210\nval allCombinations = for {\n  r     &lt;- radiuses\n  point &lt;- points\n} yield s\"$point is within a radius of $r: ${isInside(point, r)}\"\n\n// \u7d50\u679c:\n// List(\n//   \"Point(5,2) is within a radius of 2: false\",\n//   \"Point(1,1) is within a radius of 2: true\",\n//   \"Point(5,2) is within a radius of 1: false\",\n//   \"Point(1,1) is within a radius of 1: false\"\n// )\n</code></pre>"},{"location":"scala/part-2/#_1","title":"\u30ac\u30fc\u30c9\u5f0f\u306b\u3088\u308b\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0","text":"<pre><code>// if \u3092\u4f7f\u3063\u305f\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\uff08\u30ac\u30fc\u30c9\u5f0f\uff09\nval insidePoints = for {\n  r     &lt;- radiuses\n  point &lt;- points\n  if isInside(point, r)  // \u30ac\u30fc\u30c9\u5f0f\n} yield s\"$point is within a radius of $r\"\n\n// \u7d50\u679c: List(\"Point(1,1) is within a radius of 2\")\n</code></pre>"},{"location":"scala/part-2/#56-for","title":"5.6 for \u5185\u5305\u8868\u8a18\u3068\u578b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch05_RandomForComprehensions.scala</code></p> <p>for \u5185\u5305\u8868\u8a18\u306e\u623b\u308a\u5024\u306e\u578b\u306f\u3001\u6700\u521d\u306e\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306e\u578b\u306b\u4f9d\u5b58\u3057\u307e\u3059\u3002</p> <pre><code>// List \u304b\u3089\u59cb\u307e\u308b \u2192 List \u3092\u8fd4\u3059\nval listResult = for {\n  a &lt;- List(1, 2)\n  b &lt;- Set(2, 1)\n} yield a * b\n// List(2, 1, 4, 2) - \u91cd\u8907\u3042\u308a\n\n// Set \u304b\u3089\u59cb\u307e\u308b \u2192 Set \u3092\u8fd4\u3059\nval setResult = for {\n  a &lt;- Set(1, 2)\n  b &lt;- List(2, 1)\n} yield a * b\n// Set(2, 1, 4) - \u91cd\u8907\u306a\u3057\n</code></pre> <p></p>"},{"location":"scala/part-2/#_2","title":"\u307e\u3068\u3081","text":""},{"location":"scala/part-2/#part-ii_1","title":"Part II \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"scala/part-2/#_3","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"\u7ae0 \u4e3b\u8981\u6982\u5ff5 \u30ad\u30fc\u64cd\u4f5c \u7b2c3\u7ae0 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb <code>slice</code>, <code>appended</code>, <code>appendedAll</code> \u7b2c4\u7ae0 \u9ad8\u968e\u95a2\u6570 <code>map</code>, <code>filter</code>, <code>foldLeft</code>, <code>sortBy</code> \u7b2c5\u7ae0 \u5e73\u5766\u5316 <code>flatten</code>, <code>flatMap</code>, <code>for</code> \u5185\u5305\u8868\u8a18"},{"location":"scala/part-2/#_4","title":"\u91cd\u8981\u306a\u6cd5\u5247","text":"<ol> <li>\u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf: \u5143\u306e\u30c7\u30fc\u30bf\u306f\u5909\u66f4\u305b\u305a\u3001\u65b0\u3057\u3044\u30c7\u30fc\u30bf\u3092\u4f5c\u6210\u3059\u308b</li> <li>\u95a2\u6570\u306f\u5024: \u95a2\u6570\u3092\u5f15\u6570\u3068\u3057\u3066\u6e21\u3057\u305f\u308a\u3001\u623b\u308a\u5024\u3068\u3057\u3066\u8fd4\u3057\u305f\u308a\u3067\u304d\u308b</li> <li>flatMap \u30d1\u30bf\u30fc\u30f3: \u30cd\u30b9\u30c8\u3057\u305f\u69cb\u9020\u3092\u5e73\u5766\u5316\u3057\u306a\u304c\u3089\u5909\u63db\u3059\u308b</li> <li>for \u5185\u5305\u8868\u8a18: flatMap/map \u306e\u7cd6\u8863\u69cb\u6587\u3068\u3057\u3066\u4f7f\u3048\u308b</li> </ol>"},{"location":"scala/part-2/#_5","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part III \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li><code>Option</code> \u578b\u306b\u3088\u308b\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0</li> <li><code>Either</code> \u578b\u3068\u8907\u5408\u7684\u306a\u30a8\u30e9\u30fc\u51e6\u7406</li> </ul>"},{"location":"scala/part-2/#_6","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"scala/part-2/#1","title":"\u554f\u984c 1: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u306a\u64cd\u4f5c","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u30ea\u30b9\u30c8\u306e\u4e2d\u592e\u306b\u8981\u7d20\u3092\u633f\u5165\u3059\u308b\u95a2\u6570\u3067\u3059\u3002</p> <pre><code>def insertAtMiddle(list: List[String], element: String): List[String] = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert(insertAtMiddle(List(\"a\", \"b\", \"c\", \"d\"), \"X\") == List(\"a\", \"b\", \"X\", \"c\", \"d\"))\nassert(insertAtMiddle(List(\"a\", \"b\"), \"X\") == List(\"a\", \"X\", \"b\"))\n</code></pre> \u89e3\u7b54 <pre><code>def insertAtMiddle(list: List[String], element: String): List[String] = {\n  val middle = list.size / 2\n  val before = list.slice(0, middle)\n  val after  = list.slice(middle, list.size)\n  before.appended(element).appendedAll(after)\n}\n</code></pre>"},{"location":"scala/part-2/#2","title":"\u554f\u984c 2: \u9ad8\u968e\u95a2\u6570","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u6761\u4ef6\u3092\u6e80\u305f\u3059\u8981\u7d20\u306e\u6570\u3092\u30ab\u30a6\u30f3\u30c8\u3059\u308b\u95a2\u6570\u3067\u3059\u3002</p> <pre><code>def countWhere[A](list: List[A], predicate: A =&gt; Boolean): Int = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert(countWhere(List(1, 2, 3, 4, 5), (i: Int) =&gt; i &gt; 3) == 2)\nassert(countWhere(List(\"a\", \"bb\", \"ccc\"), (s: String) =&gt; s.length &gt; 1) == 2)\n</code></pre> \u89e3\u7b54 <pre><code>def countWhere[A](list: List[A], predicate: A =&gt; Boolean): Int = {\n  list.filter(predicate).size\n}\n\n// \u307e\u305f\u306f foldLeft \u3092\u4f7f\u3063\u3066\ndef countWhere2[A](list: List[A], predicate: A =&gt; Boolean): Int = {\n  list.foldLeft(0)((count, elem) =&gt; if (predicate(elem)) count + 1 else count)\n}\n</code></pre>"},{"location":"scala/part-2/#3-for","title":"\u554f\u984c 3: for \u5185\u5305\u8868\u8a18","text":"<p>\u4ee5\u4e0b\u306e\u30cd\u30b9\u30c8\u3057\u305f flatMap \u3092 for \u5185\u5305\u8868\u8a18\u3067\u66f8\u304d\u63db\u3048\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>val result = List(1, 2).flatMap(x =&gt;\n  List(10, 20).flatMap(y =&gt;\n    List(100, 200).map(z =&gt;\n      x + y + z\n    )\n  )\n)\n</code></pre> \u89e3\u7b54 <pre><code>val result = for {\n  x &lt;- List(1, 2)\n  y &lt;- List(10, 20)\n  z &lt;- List(100, 200)\n} yield x + y + z\n\n// \u7d50\u679c: List(111, 211, 121, 221, 112, 212, 122, 222)\n</code></pre>"},{"location":"scala/part-2/#4-flatmap","title":"\u554f\u984c 4: flatMap \u306b\u3088\u308b\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0","text":"<p>for \u5185\u5305\u8868\u8a18\u306e <code>if</code> \u3092\u4f7f\u308f\u305a\u306b\u3001flatMap \u3060\u3051\u3067\u5076\u6570\u306e\u307f\u3092\u62bd\u51fa\u3059\u308b\u30b3\u30fc\u30c9\u3092\u66f8\u3044\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>val numbers = List(1, 2, 3, 4, 5, 6)\n// \u5076\u6570\u306e\u307f\u3092\u62bd\u51fa: List(2, 4, 6)\n</code></pre> \u89e3\u7b54 <pre><code>val evenNumbers = numbers.flatMap(n =&gt;\n  if (n % 2 == 0) List(n) else List.empty\n)\n\n// \u307e\u305f\u306f\u95a2\u6570\u306b\u5206\u96e2\ndef evenFilter(n: Int): List[Int] =\n  if (n % 2 == 0) List(n) else List.empty\n\nval evenNumbers2 = numbers.flatMap(evenFilter)\n</code></pre>"},{"location":"scala/part-3/","title":"Part III: \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3068 Option/Either","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u3092\u5b66\u3073\u307e\u3059\u3002<code>null</code> \u3084\u4f8b\u5916\u306b\u983c\u3089\u305a\u3001<code>Option</code> \u3068 <code>Either</code> \u3092\u4f7f\u3063\u3066\u578b\u5b89\u5168\u306b\u30a8\u30e9\u30fc\u3092\u6271\u3046\u65b9\u6cd5\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"scala/part-3/#6-option","title":"\u7b2c6\u7ae0: Option \u578b\u306b\u3088\u308b\u5b89\u5168\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":""},{"location":"scala/part-3/#61-option","title":"6.1 \u306a\u305c Option \u304c\u5fc5\u8981\u304b","text":"<p>\u5f93\u6765\u306e\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u306b\u306f\u554f\u984c\u304c\u3042\u308a\u307e\u3059\u3002</p> <p></p>"},{"location":"scala/part-3/#62-option","title":"6.2 Option \u306e\u57fa\u672c","text":"<p><code>Option[A]</code> \u306f\u300c<code>A</code> \u578b\u306e\u5024\u304c\u3042\u308b\u304b\u3001\u306a\u3044\u304b\u300d\u3092\u8868\u3059\u578b\u3067\u3059\u3002</p> <p></p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch06_TvShows.scala</code></p>"},{"location":"scala/part-3/#63-tv","title":"6.3 TV\u756a\u7d44\u306e\u30d1\u30fc\u30b9\u4f8b","text":"<p>TV\u756a\u7d44\u306e\u6587\u5b57\u5217\u3092\u30d1\u30fc\u30b9\u3059\u308b\u4f8b\u3067 Option \u306e\u4f7f\u3044\u65b9\u3092\u5b66\u3073\u307e\u3059\u3002</p> <pre><code>case class TvShow(title: String, start: Int, end: Int)\n\n// \u5165\u529b\u4f8b: \"Breaking Bad (2008-2013)\"\n// \u671f\u5f85\u3059\u308b\u51fa\u529b: TvShow(\"Breaking Bad\", 2008, 2013)\n</code></pre>"},{"location":"scala/part-3/#_1","title":"\u4f8b\u5916\u3092\u4f7f\u3046\u65b9\u6cd5\uff08\u554f\u984c\u3042\u308a\uff09","text":"<pre><code>def parseShow(rawShow: String): TvShow = {\n  val bracketOpen  = rawShow.indexOf('(')\n  val bracketClose = rawShow.indexOf(')')\n  val dash         = rawShow.indexOf('-')\n\n  val name      = rawShow.substring(0, bracketOpen).trim\n  val yearStart = rawShow.substring(bracketOpen + 1, dash).toInt\n  val yearEnd   = rawShow.substring(dash + 1, bracketClose).toInt\n\n  TvShow(name, yearStart, yearEnd)\n}\n\n// \u6b63\u5e38\u30b1\u30fc\u30b9\nparseShow(\"Breaking Bad (2008-2013)\")  // TvShow(\"Breaking Bad\", 2008, 2013)\n\n// \u7570\u5e38\u30b1\u30fc\u30b9 \u2192 \u4f8b\u5916\u304c\u30b9\u30ed\u30fc\u3055\u308c\u308b!\nparseShow(\"Chernobyl (2019)\")           // StringIndexOutOfBoundsException\nparseShow(\"The Wire 2002-2008\")         // StringIndexOutOfBoundsException\n</code></pre>"},{"location":"scala/part-3/#option","title":"Option \u3092\u4f7f\u3046\u65b9\u6cd5","text":"<pre><code>def parseShow(rawShow: String): Option[TvShow] = {\n  for {\n    name      &lt;- extractName(rawShow)\n    yearStart &lt;- extractYearStart(rawShow)\n    yearEnd   &lt;- extractYearEnd(rawShow)\n  } yield TvShow(name, yearStart, yearEnd)\n}\n\n// \u6b63\u5e38\u30b1\u30fc\u30b9\nparseShow(\"Breaking Bad (2008-2013)\")  // Some(TvShow(\"Breaking Bad\", 2008, 2013))\n\n// \u7570\u5e38\u30b1\u30fc\u30b9 \u2192 None \u304c\u8fd4\u3055\u308c\u308b\uff08\u4f8b\u5916\u306a\u3057\uff09\nparseShow(\"The Wire 2002-2008\")         // None\n</code></pre>"},{"location":"scala/part-3/#64","title":"6.4 \u5c0f\u3055\u306a\u95a2\u6570\u304b\u3089\u7d44\u307f\u7acb\u3066\u308b","text":"<p>\u8907\u96d1\u306a\u30d1\u30fc\u30b9\u51e6\u7406\u3092\u5c0f\u3055\u306a\u95a2\u6570\u306b\u5206\u89e3\u3057\u307e\u3059\u3002</p> <pre><code>// \u540d\u524d\u3092\u62bd\u51fa\ndef extractName(rawShow: String): Option[String] = {\n  val bracketOpen = rawShow.indexOf('(')\n  if (bracketOpen &gt; 0) Some(rawShow.substring(0, bracketOpen).trim)\n  else None\n}\n\n// \u958b\u59cb\u5e74\u3092\u62bd\u51fa\ndef extractYearStart(rawShow: String): Option[Int] = {\n  val bracketOpen = rawShow.indexOf('(')\n  val dash        = rawShow.indexOf('-')\n  for {\n    yearStr &lt;- if (bracketOpen != -1 &amp;&amp; dash &gt; bracketOpen + 1)\n                 Some(rawShow.substring(bracketOpen + 1, dash))\n               else None\n    year    &lt;- yearStr.toIntOption\n  } yield year\n}\n\n// \u7d42\u4e86\u5e74\u3092\u62bd\u51fa\ndef extractYearEnd(rawShow: String): Option[Int] = {\n  val dash         = rawShow.indexOf('-')\n  val bracketClose = rawShow.indexOf(')')\n  for {\n    yearStr &lt;- if (dash != -1 &amp;&amp; bracketClose &gt; dash + 1)\n                 Some(rawShow.substring(dash + 1, bracketClose))\n               else None\n    year    &lt;- yearStr.toIntOption\n  } yield year\n}\n</code></pre> <p></p>"},{"location":"scala/part-3/#65-orelse","title":"6.5 orElse \u306b\u3088\u308b\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af","text":"<p><code>orElse</code> \u3092\u4f7f\u3063\u3066\u3001\u6700\u521d\u306e Option \u304c <code>None</code> \u306e\u5834\u5408\u306b\u4ee3\u66ff\u3092\u8a66\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>val seven: Option[Int] = Some(7)\nval eight: Option[Int] = Some(8)\nval none: Option[Int]  = None\n\nseven.orElse(eight)  // Some(7) - \u6700\u521d\u304c Some \u306a\u306e\u3067\u305d\u306e\u307e\u307e\nnone.orElse(eight)   // Some(8) - \u6700\u521d\u304c None \u306a\u306e\u3067\u4ee3\u66ff\u3092\u4f7f\u7528\nseven.orElse(none)   // Some(7)\nnone.orElse(none)    // None\n</code></pre>"},{"location":"scala/part-3/#_2","title":"\u5358\u5e74\u306e\u756a\u7d44\u306b\u5bfe\u5fdc\u3059\u308b","text":"<p>\u300cChernobyl (2019)\u300d\u306e\u3088\u3046\u306a\u5358\u5e74\u306e\u756a\u7d44\u3092\u30d1\u30fc\u30b9\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002</p> <pre><code>def extractSingleYear(rawShow: String): Option[Int] = {\n  val dash         = rawShow.indexOf('-')\n  val bracketOpen  = rawShow.indexOf('(')\n  val bracketClose = rawShow.indexOf(')')\n  for {\n    yearStr &lt;- if (dash == -1 &amp;&amp; bracketOpen != -1 &amp;&amp; bracketClose &gt; bracketOpen + 1)\n                 Some(rawShow.substring(bracketOpen + 1, bracketClose))\n               else None\n    year    &lt;- yearStr.toIntOption\n  } yield year\n}\n\ndef parseShow(rawShow: String): Option[TvShow] = {\n  for {\n    name      &lt;- extractName(rawShow)\n    yearStart &lt;- extractYearStart(rawShow).orElse(extractSingleYear(rawShow))\n    yearEnd   &lt;- extractYearEnd(rawShow).orElse(extractSingleYear(rawShow))\n  } yield TvShow(name, yearStart, yearEnd)\n}\n\n// \u3053\u308c\u3067\u5358\u5e74\u306e\u756a\u7d44\u3082\u30d1\u30fc\u30b9\u3067\u304d\u308b\nparseShow(\"Chernobyl (2019)\")  // Some(TvShow(\"Chernobyl\", 2019, 2019))\n</code></pre> <p></p>"},{"location":"scala/part-3/#66-option","title":"6.6 Option \u306e\u4e3b\u8981\u30e1\u30bd\u30c3\u30c9","text":"\u30e1\u30bd\u30c3\u30c9 \u8aac\u660e \u4f8b <code>map</code> \u5024\u304c\u3042\u308c\u3070\u5909\u63db <code>Some(5).map(_ * 2)</code> \u2192 <code>Some(10)</code> <code>flatMap</code> \u5024\u304c\u3042\u308c\u3070 Option \u3092\u8fd4\u3059\u95a2\u6570\u3092\u9069\u7528 <code>Some(5).flatMap(x =&gt; Some(x * 2))</code> \u2192 <code>Some(10)</code> <code>filter</code> \u6761\u4ef6\u3092\u6e80\u305f\u3055\u306a\u3051\u308c\u3070 None <code>Some(5).filter(_ &gt; 10)</code> \u2192 <code>None</code> <code>orElse</code> None \u306a\u3089\u4ee3\u66ff\u3092\u4f7f\u7528 <code>None.orElse(Some(5))</code> \u2192 <code>Some(5)</code> <code>getOrElse</code> None \u306a\u3089\u30c7\u30d5\u30a9\u30eb\u30c8\u5024 <code>None.getOrElse(0)</code> \u2192 <code>0</code> <code>toList</code> List \u306b\u5909\u63db <code>Some(5).toList</code> \u2192 <code>List(5)</code> <code>toRight</code> Either \u306b\u5909\u63db <code>Some(5).toRight(\"error\")</code> \u2192 <code>Right(5)</code> <pre><code>val year: Option[Int]   = Some(996)\nval noYear: Option[Int] = None\n\n// map\nyear.map(_ * 2)    // Some(1992)\nnoYear.map(_ * 2)  // None\n\n// flatMap\nyear.flatMap(y =&gt; Some(y * 2))    // Some(1992)\nnoYear.flatMap(y =&gt; Some(y * 2))  // None\n\n// filter\nyear.filter(_ &lt; 2020)   // Some(996)\nyear.filter(_ &gt; 2020)   // None\n\n// orElse\nyear.orElse(Some(2020))    // Some(996)\nnoYear.orElse(Some(2020))  // Some(2020)\n</code></pre>"},{"location":"scala/part-3/#67","title":"6.7 \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u6226\u7565","text":"<p>\u8907\u6570\u306e\u8981\u7d20\u3092\u30d1\u30fc\u30b9\u3059\u308b\u5834\u5408\u30012\u3064\u306e\u6226\u7565\u304c\u3042\u308a\u307e\u3059\u3002</p> <p></p>"},{"location":"scala/part-3/#best-effort","title":"Best-effort \u6226\u7565","text":"<pre><code>def parseShows(rawShows: List[String]): List[TvShow] = {\n  rawShows\n    .map(parseShow)     // List[Option[TvShow]]\n    .map(_.toList)      // List[List[TvShow]]\n    .flatten            // List[TvShow]\n}\n\nval rawShows = List(\n  \"Breaking Bad (2008-2013)\",\n  \"The Wire 2002 2008\",        // \u7121\u52b9\u306a\u5f62\u5f0f\n  \"Mad Men (2007-2015)\"\n)\n\nparseShows(rawShows)\n// List(TvShow(\"Breaking Bad\", 2008, 2013), TvShow(\"Mad Men\", 2007, 2015))\n// \u7121\u52b9\u306a\u3082\u306e\u306f\u7121\u8996\u3055\u308c\u308b\n</code></pre>"},{"location":"scala/part-3/#all-or-nothing","title":"All-or-nothing \u6226\u7565","text":"<pre><code>def addOrResign(\n    parsedShows: Option[List[TvShow]],\n    newParsedShow: Option[TvShow]\n): Option[List[TvShow]] = {\n  for {\n    shows      &lt;- parsedShows\n    parsedShow &lt;- newParsedShow\n  } yield shows.appended(parsedShow)\n}\n\ndef parseShows(rawShows: List[String]): Option[List[TvShow]] = {\n  val initialResult: Option[List[TvShow]] = Some(List.empty)\n  rawShows\n    .map(parseShow)\n    .foldLeft(initialResult)(addOrResign)\n}\n\n// \u5168\u90e8\u6210\u529f \u2192 Some(List(...))\nparseShows(List(\"Breaking Bad (2008-2013)\", \"Mad Men (2007-2015)\"))\n// Some(List(TvShow(\"Breaking Bad\", 2008, 2013), TvShow(\"Mad Men\", 2007, 2015)))\n\n// \u4e00\u3064\u3067\u3082\u5931\u6557 \u2192 None\nparseShows(List(\"Breaking Bad (2008-2013)\", \"Invalid\"))\n// None\n</code></pre>"},{"location":"scala/part-3/#7-either","title":"\u7b2c7\u7ae0: Either \u578b\u3068\u8907\u5408\u7684\u306a\u30a8\u30e9\u30fc\u51e6\u7406","text":""},{"location":"scala/part-3/#71-option","title":"7.1 Option \u306e\u9650\u754c","text":"<p><code>Option</code> \u306f\u300c\u5024\u304c\u3042\u308b\u304b\u306a\u3044\u304b\u300d\u3057\u304b\u8868\u73fe\u3067\u304d\u307e\u305b\u3093\u3002\u306a\u305c\u5931\u6557\u3057\u305f\u306e\u304b\u3092\u4f1d\u3048\u3089\u308c\u307e\u305b\u3093\u3002</p> <p></p>"},{"location":"scala/part-3/#72-either","title":"7.2 Either \u306e\u57fa\u672c","text":"<p><code>Either[E, A]</code> \u306f\u300c<code>E</code> \u578b\u306e\u30a8\u30e9\u30fc\u304b\u3001<code>A</code> \u578b\u306e\u6210\u529f\u5024\u304b\u300d\u3092\u8868\u3059\u578b\u3067\u3059\u3002</p> <ul> <li><code>Right(value)</code>: \u6210\u529f\uff08\u6163\u4f8b\u7684\u306b\u300c\u6b63\u3057\u3044\u300d= right\uff09</li> <li><code>Left(error)</code>: \u5931\u6557\uff08\u30a8\u30e9\u30fc\u60c5\u5831\u3092\u4fdd\u6301\uff09</li> </ul> <pre><code>def extractName(show: String): Either[String, String] = {\n  val bracketOpen = show.indexOf('(')\n  if (bracketOpen &gt; 0) Right(show.substring(0, bracketOpen).trim)\n  else Left(s\"Can't extract name from $show\")\n}\n\nextractName(\"The Wire (2002-2008)\")  // Right(\"The Wire\")\nextractName(\"(2022)\")                // Left(\"Can't extract name from (2022)\")\n</code></pre>"},{"location":"scala/part-3/#73-either","title":"7.3 Either \u3092\u4f7f\u3063\u305f\u30d1\u30fc\u30b9","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch06_TvShows.scala</code></p> <pre><code>def extractYearStart(rawShow: String): Either[String, Int] = {\n  val bracketOpen = rawShow.indexOf('(')\n  val dash        = rawShow.indexOf('-')\n  for {\n    yearStr &lt;- if (bracketOpen != -1 &amp;&amp; dash &gt; bracketOpen + 1)\n                 Right(rawShow.substring(bracketOpen + 1, dash))\n               else Left(s\"Can't extract start year from $rawShow\")\n    year    &lt;- yearStr.toIntOption.toRight(s\"Can't parse $yearStr\")\n  } yield year\n}\n\nextractYearStart(\"The Wire (2002-2008)\")  // Right(2002)\nextractYearStart(\"The Wire (-2008)\")      // Left(\"Can't extract start year from The Wire (-2008)\")\nextractYearStart(\"The Wire (oops-2008)\")  // Left(\"Can't parse oops\")\n</code></pre>"},{"location":"scala/part-3/#74-option-either","title":"7.4 Option \u304b\u3089 Either \u3078\u306e\u5909\u63db","text":"<p><code>toRight</code> \u30e1\u30bd\u30c3\u30c9\u3067 <code>Option</code> \u3092 <code>Either</code> \u306b\u5909\u63db\u3067\u304d\u307e\u3059\u3002</p> <pre><code>val year: Option[Int] = Some(996)\nval noYear: Option[Int] = None\n\nyear.toRight(\"no year given\")    // Right(996)\nnoYear.toRight(\"no year given\")  // Left(\"no year given\")\n</code></pre> <p></p>"},{"location":"scala/part-3/#75-either","title":"7.5 Either \u306b\u3088\u308b\u5b8c\u5168\u306a\u30d1\u30fc\u30b5\u30fc","text":"<pre><code>def parseShow(rawShow: String): Either[String, TvShow] = {\n  for {\n    name      &lt;- extractName(rawShow)\n    yearStart &lt;- extractYearStart(rawShow).orElse(extractSingleYear(rawShow))\n    yearEnd   &lt;- extractYearEnd(rawShow).orElse(extractSingleYear(rawShow))\n  } yield TvShow(name, yearStart, yearEnd)\n}\n\nparseShow(\"The Wire (2002-2008)\")  // Right(TvShow(\"The Wire\", 2002, 2008))\nparseShow(\"Mad Men ()\")            // Left(\"Can't extract single year from Mad Men ()\")\nparseShow(\"The Wire (-)\")          // Left(\"Can't extract single year from The Wire (-)\")\nparseShow(\"(2002-2008)\")           // Left(\"Can't extract name from (2002-2008)\")\n</code></pre>"},{"location":"scala/part-3/#76-either","title":"7.6 Either \u306e\u4e3b\u8981\u30e1\u30bd\u30c3\u30c9","text":"\u30e1\u30bd\u30c3\u30c9 \u8aac\u660e \u4f8b <code>map</code> Right \u306e\u5024\u3092\u5909\u63db <code>Right(5).map(_ * 2)</code> \u2192 <code>Right(10)</code> <code>flatMap</code> Right \u306a\u3089 Either \u3092\u8fd4\u3059\u95a2\u6570\u3092\u9069\u7528 <code>Right(5).flatMap(x =&gt; Right(x * 2))</code> \u2192 <code>Right(10)</code> <code>orElse</code> Left \u306a\u3089\u4ee3\u66ff\u3092\u4f7f\u7528 <code>Left(\"err\").orElse(Right(5))</code> \u2192 <code>Right(5)</code> <code>toOption</code> Option \u306b\u5909\u63db <code>Right(5).toOption</code> \u2192 <code>Some(5)</code> <code>flatten</code> \u30cd\u30b9\u30c8\u3057\u305f Either \u3092\u5e73\u5766\u5316 <code>Right(Right(5)).flatten</code> \u2192 <code>Right(5)</code> <pre><code>val year: Either[String, Int]   = Right(996)\nval noYear: Either[String, Int] = Left(\"no year\")\n\n// map\nyear.map(_ * 2)    // Right(1992)\nnoYear.map(_ * 2)  // Left(\"no year\")\n\n// flatMap\nyear.flatMap(y =&gt; Right(y * 2))             // Right(1992)\nnoYear.flatMap(y =&gt; Right(y * 2))           // Left(\"no year\")\nyear.flatMap(y =&gt; Left(\"can't progress\"))   // Left(\"can't progress\")\n\n// orElse\nyear.orElse(Right(2020))           // Right(996)\nnoYear.orElse(Right(2020))         // Right(2020)\nnoYear.orElse(Left(\"can't recover\")) // Left(\"can't recover\")\n\n// toOption\nyear.toOption    // Some(996)\nnoYear.toOption  // None\n</code></pre>"},{"location":"scala/part-3/#77","title":"7.7 \u97f3\u697d\u30a2\u30fc\u30c6\u30a3\u30b9\u30c8\u691c\u7d22\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch07_MusicArtistsSearch.scala</code></p> <p>\u3088\u308a\u8907\u96d1\u306a\u4f8b\u3068\u3057\u3066\u3001\u97f3\u697d\u30a2\u30fc\u30c6\u30a3\u30b9\u30c8\u306e\u691c\u7d22\u6a5f\u80fd\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p>"},{"location":"scala/part-3/#_3","title":"\u57fa\u672c\u7684\u306a\u30e2\u30c7\u30eb\uff08\u554f\u984c\u3042\u308a\uff09","text":"<pre><code>case class Artist(\n    name: String,\n    genre: String,\n    origin: String,\n    yearsActiveStart: Int,\n    isActive: Boolean,\n    yearsActiveEnd: Int  // \u30a2\u30af\u30c6\u30a3\u30d6\u306a\u5834\u5408\u306f 0 \u3092\u5165\u308c\u308b\uff1f\n)\n</code></pre> <p>\u3053\u306e\u8a2d\u8a08\u306b\u306f\u554f\u984c\u304c\u3042\u308a\u307e\u3059: - <code>isActive</code> \u304c <code>true</code> \u306e\u5834\u5408\u3001<code>yearsActiveEnd</code> \u306f\u4f55\u3092\u5165\u308c\u308b\u3079\u304d\uff1f - \u7121\u52b9\u306a\u72b6\u614b\uff08<code>isActive = true</code> \u304b\u3064 <code>yearsActiveEnd = 2020</code>\uff09\u3092\u4f5c\u308c\u3066\u3057\u307e\u3046</p>"},{"location":"scala/part-3/#option_1","title":"Option \u3092\u4f7f\u3063\u305f\u6539\u5584","text":"<pre><code>case class Artist(\n    name: String,\n    genre: String,\n    origin: String,\n    yearsActiveStart: Int,\n    yearsActiveEnd: Option[Int]  // \u30a2\u30af\u30c6\u30a3\u30d6\u306a\u3089 None\n)\n\nval metallica = Artist(\"Metallica\", \"Heavy Metal\", \"U.S.\", 1981, None)\nval ledZeppelin = Artist(\"Led Zeppelin\", \"Hard Rock\", \"England\", 1968, Some(1980))\n</code></pre>"},{"location":"scala/part-3/#78-adt","title":"7.8 \u4ee3\u6570\u7684\u30c7\u30fc\u30bf\u578b\uff08ADT\uff09","text":"<p>enum\uff08\u5217\u6319\u578b\uff09\u3092\u4f7f\u3063\u3066\u3001\u3088\u308a\u8868\u73fe\u529b\u306e\u9ad8\u3044\u30e2\u30c7\u30eb\u3092\u4f5c\u308c\u307e\u3059\u3002</p>"},{"location":"scala/part-3/#product-type","title":"\u76f4\u7a4d\u578b\uff08Product Type\uff09","text":"<p>\u8907\u6570\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u3092AND\u3067\u7d44\u307f\u5408\u308f\u305b\u308b\u578b\u3067\u3059\u3002</p> <pre><code>case class PeriodInYears(start: Int, end: Option[Int])\n\ncase class Artist(\n    name: String,\n    genre: MusicGenre,\n    origin: Location,\n    yearsActive: PeriodInYears\n)\n</code></pre>"},{"location":"scala/part-3/#sum-type","title":"\u76f4\u548c\u578b\uff08Sum Type\uff09","text":"<p>\u8907\u6570\u306e\u9078\u629e\u80a2\u3092OR\u3067\u8868\u3059\u578b\u3067\u3059\u3002</p> <pre><code>enum MusicGenre {\n  case HeavyMetal\n  case Pop\n  case HardRock\n}\n\nenum YearsActive {\n  case StillActive(since: Int)\n  case ActiveBetween(start: Int, end: Int)\n}\n</code></pre> <p></p>"},{"location":"scala/part-3/#79","title":"7.9 \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0","text":"<p>\u76f4\u548c\u578b\u306f\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3067\u51e6\u7406\u3057\u307e\u3059\u3002</p> <pre><code>def wasArtistActive(artist: Artist, yearStart: Int, yearEnd: Int): Boolean = {\n  artist.yearsActive match {\n    case StillActive(since)        =&gt; since &lt;= yearEnd\n    case ActiveBetween(start, end) =&gt; start &lt;= yearEnd &amp;&amp; end &gt;= yearStart\n  }\n}\n\ndef activeLength(artist: Artist, currentYear: Int): Int = {\n  artist.yearsActive match {\n    case StillActive(since)        =&gt; currentYear - since\n    case ActiveBetween(start, end) =&gt; end - start\n  }\n}\n</code></pre> <p></p>"},{"location":"scala/part-3/#710","title":"7.10 \u691c\u7d22\u6761\u4ef6\u306e\u30e2\u30c7\u30ea\u30f3\u30b0","text":"<p>\u691c\u7d22\u6761\u4ef6\u3082 ADT \u3067\u30e2\u30c7\u30ea\u30f3\u30b0\u3067\u304d\u307e\u3059\u3002</p> <pre><code>enum SearchCondition {\n  case SearchByGenre(genres: List[MusicGenre])\n  case SearchByOrigin(locations: List[Location])\n  case SearchByActiveYears(start: Int, end: Int)\n}\n\ndef searchArtists(\n    artists: List[Artist],\n    requiredConditions: List[SearchCondition]\n): List[Artist] = {\n  artists.filter(artist =&gt;\n    requiredConditions.forall(condition =&gt;\n      condition match {\n        case SearchByGenre(genres)           =&gt; genres.contains(artist.genre)\n        case SearchByOrigin(locations)       =&gt; locations.contains(artist.origin)\n        case SearchByActiveYears(start, end) =&gt; wasArtistActive(artist, start, end)\n      }\n    )\n  )\n}\n</code></pre>"},{"location":"scala/part-3/#711-forall-exists","title":"7.11 forall \u3068 exists","text":"<p>Option \u3068 List \u3067\u6761\u4ef6\u5224\u5b9a\u3092\u3059\u308b\u969b\u306b\u4fbf\u5229\u306a\u30e1\u30bd\u30c3\u30c9\u3067\u3059\u3002</p> \u30e1\u30bd\u30c3\u30c9 Option \u3067\u306e\u52d5\u4f5c List \u3067\u306e\u52d5\u4f5c <code>forall(p)</code> None \u2192 true, Some(x) \u2192 p(x) \u5168\u8981\u7d20\u304c p \u3092\u6e80\u305f\u3059 <code>exists(p)</code> None \u2192 false, Some(x) \u2192 p(x) \u3044\u305a\u308c\u304b\u306e\u8981\u7d20\u304c p \u3092\u6e80\u305f\u3059 <code>contains(x)</code> Some(x) \u3068\u7b49\u3057\u3044\u304b x \u3092\u542b\u3080\u304b <pre><code>val year: Option[Int] = Some(996)\nval noYear: Option[Int] = None\n\n// forall - \u300c\u5168\u3066\u300d\u307e\u305f\u306f\u300c\u5b58\u5728\u3057\u306a\u3044\u300d\nyear.forall(_ &lt; 2020)    // true (996 &lt; 2020)\nnoYear.forall(_ &lt; 2020)  // true (\u5024\u304c\u306a\u3044\u306e\u3067\u300c\u5168\u3066\u300d\u304c\u81ea\u660e\u306b\u771f)\nyear.forall(_ &gt; 2020)    // false\n\n// exists - \u300c\u5b58\u5728\u3057\u3066\u6761\u4ef6\u3092\u6e80\u305f\u3059\u300d\nyear.exists(_ &lt; 2020)    // true\nnoYear.exists(_ &lt; 2020)  // false (\u5024\u304c\u306a\u3044\u306e\u3067\u5b58\u5728\u3057\u306a\u3044)\n</code></pre>"},{"location":"scala/part-3/#_4","title":"\u307e\u3068\u3081","text":""},{"location":"scala/part-3/#part-iii","title":"Part III \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"scala/part-3/#option-vs-either","title":"Option vs Either \u306e\u4f7f\u3044\u5206\u3051","text":"\u72b6\u6cc1 \u4f7f\u7528\u3059\u308b\u578b \u5024\u304c\u3042\u308b\u304b\u306a\u3044\u304b\u3060\u3051\u304c\u91cd\u8981 <code>Option[A]</code> \u5931\u6557\u7406\u7531\u3092\u4f1d\u3048\u308b\u5fc5\u8981\u304c\u3042\u308b <code>Either[E, A]</code> \u691c\u7d22\u7d50\u679c\u304c\u898b\u3064\u304b\u3089\u306a\u3044 <code>Option[A]</code> \u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3\u30a8\u30e9\u30fc\u3092\u4f1d\u3048\u308b <code>Either[String, A]</code> \u8907\u6570\u306e\u30a8\u30e9\u30fc\u7a2e\u5225\u304c\u3042\u308b <code>Either[ErrorType, A]</code>"},{"location":"scala/part-3/#_5","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>Option: \u5024\u306e\u6709\u7121\u3092\u578b\u3067\u8868\u73fe\u3059\u308b</li> <li>Either: \u6210\u529f/\u5931\u6557\u3068\u30a8\u30e9\u30fc\u60c5\u5831\u3092\u578b\u3067\u8868\u73fe\u3059\u308b</li> <li>for \u5185\u5305\u8868\u8a18: Option/Either \u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u4f7f\u3046</li> <li>orElse: \u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u3092\u63d0\u4f9b\u3059\u308b</li> <li>ADT: \u76f4\u7a4d\u578b\u3068\u76f4\u548c\u578b\u3067\u30c9\u30e1\u30a4\u30f3\u3092\u6b63\u78ba\u306b\u30e2\u30c7\u30ea\u30f3\u30b0</li> <li>\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0: \u76f4\u548c\u578b\u3092\u5b89\u5168\u306b\u51e6\u7406\u3059\u308b</li> </ol>"},{"location":"scala/part-3/#_6","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part IV \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li>IO \u30e2\u30ca\u30c9\u306e\u5c0e\u5165</li> <li>\u526f\u4f5c\u7528\u306e\u7ba1\u7406</li> <li>\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406</li> </ul>"},{"location":"scala/part-3/#_7","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"scala/part-3/#1-option","title":"\u554f\u984c 1: Option \u306e\u57fa\u672c","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>def safeDivide(a: Int, b: Int): Option[Int] = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert(safeDivide(10, 2) == Some(5))\nassert(safeDivide(10, 0) == None)\nassert(safeDivide(7, 2) == Some(3))\n</code></pre> \u89e3\u7b54 <pre><code>def safeDivide(a: Int, b: Int): Option[Int] = {\n  if (b == 0) None\n  else Some(a / b)\n}\n</code></pre>"},{"location":"scala/part-3/#2-option","title":"\u554f\u984c 2: Option \u306e\u5408\u6210","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u30022\u3064\u306e\u6570\u5024\u6587\u5b57\u5217\u3092\u53d7\u3051\u53d6\u308a\u3001\u305d\u306e\u5408\u8a08\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>def addStrings(a: String, b: String): Option[Int] = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert(addStrings(\"10\", \"20\") == Some(30))\nassert(addStrings(\"10\", \"abc\") == None)\nassert(addStrings(\"xyz\", \"20\") == None)\n</code></pre> \u89e3\u7b54 <pre><code>def addStrings(a: String, b: String): Option[Int] = {\n  for {\n    x &lt;- a.toIntOption\n    y &lt;- b.toIntOption\n  } yield x + y\n}\n</code></pre>"},{"location":"scala/part-3/#3-either","title":"\u554f\u984c 3: Either \u306b\u3088\u308b\u30d0\u30ea\u30c7\u30fc\u30b7\u30e7\u30f3","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u5e74\u9f62\u3092\u691c\u8a3c\u3057\u3001\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>def validateAge(age: Int): Either[String, Int] = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert(validateAge(25) == Right(25))\nassert(validateAge(-5) == Left(\"Age cannot be negative\"))\nassert(validateAge(200) == Left(\"Age cannot be greater than 150\"))\n</code></pre> \u89e3\u7b54 <pre><code>def validateAge(age: Int): Either[String, Int] = {\n  if (age &lt; 0) Left(\"Age cannot be negative\")\n  else if (age &gt; 150) Left(\"Age cannot be greater than 150\")\n  else Right(age)\n}\n</code></pre>"},{"location":"scala/part-3/#4","title":"\u554f\u984c 4: \u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0","text":"<p>\u4ee5\u4e0b\u306e enum \u3068\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u30f3\u30b0\u3092\u4f7f\u3063\u305f\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>enum PaymentMethod {\n  case CreditCard(number: String, expiry: String)\n  case BankTransfer(accountNumber: String)\n  case Cash\n}\n\ndef describePayment(method: PaymentMethod): String = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert(describePayment(CreditCard(\"1234\", \"12/25\")) == \"Credit card ending in 1234\")\nassert(describePayment(BankTransfer(\"9876\")) == \"Bank transfer to account 9876\")\nassert(describePayment(Cash) == \"Cash payment\")\n</code></pre> \u89e3\u7b54 <pre><code>import PaymentMethod._\n\ndef describePayment(method: PaymentMethod): String = method match {\n  case CreditCard(number, _) =&gt; s\"Credit card ending in $number\"\n  case BankTransfer(account) =&gt; s\"Bank transfer to account $account\"\n  case Cash                  =&gt; \"Cash payment\"\n}\n</code></pre>"},{"location":"scala/part-3/#5-forall-exists","title":"\u554f\u984c 5: forall \u3068 exists","text":"<p>\u4ee5\u4e0b\u306e\u6761\u4ef6\u306b\u5408\u3046\u30e6\u30fc\u30b6\u30fc\u3092\u62bd\u51fa\u3059\u308b\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>case class User(name: String, email: Option[String], age: Int)\n\nval users = List(\n  User(\"Alice\", Some(\"alice@example.com\"), 25),\n  User(\"Bob\", None, 30),\n  User(\"Charlie\", Some(\"charlie@test.com\"), 17)\n)\n\n// 1. \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u304b\u3001example.com \u30c9\u30e1\u30a4\u30f3\u306e\u30e6\u30fc\u30b6\u30fc\ndef f1(users: List[User]): List[User] = ???\n\n// 2. \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u3066\u3001test.com \u30c9\u30e1\u30a4\u30f3\u306e\u30e6\u30fc\u30b6\u30fc\ndef f2(users: List[User]): List[User] = ???\n</code></pre> \u89e3\u7b54 <pre><code>// 1. \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u304b\u3001example.com \u30c9\u30e1\u30a4\u30f3\ndef f1(users: List[User]): List[User] = {\n  users.filter(_.email.forall(_.endsWith(\"@example.com\")))\n}\n// List(User(\"Alice\", ...), User(\"Bob\", None, 30))\n\n// 2. \u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u3066\u3001test.com \u30c9\u30e1\u30a4\u30f3\ndef f2(users: List[User]): List[User] = {\n  users.filter(_.email.exists(_.endsWith(\"@test.com\")))\n}\n// List(User(\"Charlie\", ...))\n</code></pre>"},{"location":"scala/part-4/","title":"Part IV: IO \u3068\u526f\u4f5c\u7528\u306e\u7ba1\u7406","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u526f\u4f5c\u7528\u306e\u6271\u3044\u65b9\u3092\u5b66\u3073\u307e\u3059\u3002IO \u30e2\u30ca\u30c9\u3092\u4f7f\u3063\u3066\u526f\u4f5c\u7528\u3092\u7d14\u7c8b\u95a2\u6570\u5185\u3067\u5b89\u5168\u306b\u8a18\u8ff0\u3057\u3001\u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406\u3067\u7121\u9650\u306e\u30c7\u30fc\u30bf\u3092\u6271\u3046\u65b9\u6cd5\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"scala/part-4/#8-io","title":"\u7b2c8\u7ae0: IO \u30e2\u30ca\u30c9\u306e\u5c0e\u5165","text":""},{"location":"scala/part-4/#81","title":"8.1 \u526f\u4f5c\u7528\u306e\u554f\u984c","text":"<p>\u7d14\u7c8b\u95a2\u6570\u306f\u526f\u4f5c\u7528\u3092\u6301\u3061\u307e\u305b\u3093\u3002\u3057\u304b\u3057\u3001\u5b9f\u969b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u306b\u306f\u526f\u4f5c\u7528\u304c\u5fc5\u8981\u3067\u3059:</p> <ul> <li>\u30d5\u30a1\u30a4\u30eb\u306e\u8aad\u307f\u66f8\u304d</li> <li>\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u901a\u4fe1</li> <li>\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30a2\u30af\u30bb\u30b9</li> <li>\u4e71\u6570\u751f\u6210</li> <li>\u73fe\u5728\u6642\u523b\u306e\u53d6\u5f97</li> </ul> <p></p>"},{"location":"scala/part-4/#82-io","title":"8.2 IO \u30e2\u30ca\u30c9\u3068\u306f","text":"<p>IO \u30e2\u30ca\u30c9\u306f\u300c\u526f\u4f5c\u7528\u3092\u6301\u3064\u8a08\u7b97\u306e\u8a18\u8ff0\u300d\u3092\u8868\u3059\u578b\u3067\u3059\u3002</p> <ul> <li><code>IO[A]</code> \u306f\u300c\u5b9f\u884c\u3059\u308b\u3068 <code>A</code> \u578b\u306e\u5024\u3092\u8fd4\u3059\u526f\u4f5c\u7528\u306e\u3042\u308b\u8a08\u7b97\u300d</li> <li>IO \u5024\u3092\u4f5c\u6210\u3057\u305f\u3060\u3051\u3067\u306f\u526f\u4f5c\u7528\u306f\u767a\u751f\u3057\u306a\u3044</li> <li><code>unsafeRunSync()</code> \u3067\u5b9f\u969b\u306b\u5b9f\u884c\u3055\u308c\u308b</li> </ul> <p></p>"},{"location":"scala/part-4/#83","title":"8.3 \u30b5\u30a4\u30b3\u30ed\u3092\u632f\u308b\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch08_CastingDie.scala</code></p>"},{"location":"scala/part-4/#_1","title":"\u4e0d\u7d14\u306a\u95a2\u6570\uff08\u526f\u4f5c\u7528\u3042\u308a\uff09","text":"<pre><code>def castTheDieImpure(): Int = {\n  val random = new java.util.Random()\n  random.nextInt(6) + 1\n}\n\n// \u547c\u3073\u51fa\u3059\u305f\u3073\u306b\u7570\u306a\u308b\u5024\u304c\u8fd4\u308b\nprintln(castTheDieImpure())  // 3\nprintln(castTheDieImpure())  // 5\nprintln(castTheDieImpure())  // 1\n</code></pre>"},{"location":"scala/part-4/#io","title":"IO \u3092\u4f7f\u3063\u305f\u7d14\u7c8b\u306a\u8a18\u8ff0","text":"<pre><code>import cats.effect.IO\n\ndef castTheDie(): IO[Int] = IO.delay(castTheDieImpure())\n\n// IO \u5024\u3092\u4f5c\u6210\uff08\u3053\u306e\u6642\u70b9\u3067\u306f\u5b9f\u884c\u3055\u308c\u306a\u3044\uff09\nval dieCast: IO[Int] = castTheDie()\nprintln(dieCast)  // IO(...) - \u307e\u3060\u5b9f\u884c\u3055\u308c\u3066\u3044\u306a\u3044\n\n// \u5b9f\u969b\u306b\u5b9f\u884c\nprintln(dieCast.unsafeRunSync())  // 4\n</code></pre>"},{"location":"scala/part-4/#84-io","title":"8.4 IO \u306e\u4f5c\u6210\u65b9\u6cd5","text":"\u30e1\u30bd\u30c3\u30c9 \u7528\u9014 \u4f8b <code>IO.delay(expr)</code> \u526f\u4f5c\u7528\u306e\u3042\u308b\u5f0f\u3092\u30e9\u30c3\u30d7 <code>IO.delay(println(\"hello\"))</code> <code>IO.pure(value)</code> \u65e2\u5b58\u306e\u5024\u3092\u30e9\u30c3\u30d7\uff08\u526f\u4f5c\u7528\u306a\u3057\uff09 <code>IO.pure(42)</code> <code>IO.unit</code> \u4f55\u3082\u3057\u306a\u3044 IO <code>IO.unit</code> (= <code>IO.pure(())</code>) <pre><code>// IO.delay: \u526f\u4f5c\u7528\u3092\u9045\u5ef6\u5b9f\u884c\nval delayedPrint: IO[Unit] = IO.delay(println(\"Hello\"))\n// println \u306f\u307e\u3060\u5b9f\u884c\u3055\u308c\u3066\u3044\u306a\u3044\n\n// IO.pure: \u65e2\u5b58\u306e\u5024\u3092\u30e9\u30c3\u30d7\nval pureValue: IO[Int] = IO.pure(42)\n// \u526f\u4f5c\u7528\u306a\u3057\u3001\u5373\u5ea7\u306b 42 \u304c\u78ba\u5b9a\n</code></pre>"},{"location":"scala/part-4/#85-io","title":"8.5 IO \u306e\u5408\u6210","text":"<p>IO \u5024\u306f <code>flatMap</code> \u3084 <code>for</code> \u5185\u5305\u8868\u8a18\u3067\u5408\u6210\u3067\u304d\u307e\u3059\u3002</p> <pre><code>def castTheDieTwice(): IO[Int] = {\n  for {\n    firstCast  &lt;- castTheDie()\n    secondCast &lt;- castTheDie()\n  } yield firstCast + secondCast\n}\n\n// \u307e\u3060\u5b9f\u884c\u3055\u308c\u3066\u3044\u306a\u3044\nval program: IO[Int] = castTheDieTwice()\n\n// \u5b9f\u884c\nval result: Int = program.unsafeRunSync()\n</code></pre> <p></p>"},{"location":"scala/part-4/#86","title":"8.6 \u30df\u30fc\u30c6\u30a3\u30f3\u30b0\u30b9\u30b1\u30b8\u30e5\u30fc\u30ea\u30f3\u30b0\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch08_SchedulingMeetings.scala</code></p> <p>\u3088\u308a\u5b9f\u8df5\u7684\u306a\u4f8b\u3068\u3057\u3066\u3001\u30df\u30fc\u30c6\u30a3\u30f3\u30b0\u306e\u30b9\u30b1\u30b8\u30e5\u30fc\u30ea\u30f3\u30b0\u3092\u898b\u3066\u307f\u307e\u3057\u3087\u3046\u3002</p> <pre><code>case class MeetingTime(startHour: Int, endHour: Int)\n\n// \u526f\u4f5c\u7528\u306e\u3042\u308b API \u547c\u3073\u51fa\u3057\u3092 IO \u3067\u30e9\u30c3\u30d7\ndef calendarEntries(name: String): IO[List[MeetingTime]] = {\n  IO.delay(calendarEntriesApiCall(name))\n}\n\ndef createMeeting(names: List[String], meeting: MeetingTime): IO[Unit] = {\n  IO.delay(createMeetingApiCall(names, meeting))\n}\n</code></pre>"},{"location":"scala/part-4/#_2","title":"\u4e88\u5b9a\u306e\u53d6\u5f97","text":"<pre><code>def scheduledMeetings(person1: String, person2: String): IO[List[MeetingTime]] = {\n  for {\n    person1Entries &lt;- calendarEntries(person1)\n    person2Entries &lt;- calendarEntries(person2)\n  } yield person1Entries.appendedAll(person2Entries)\n}\n</code></pre>"},{"location":"scala/part-4/#_3","title":"\u7a7a\u304d\u6642\u9593\u306e\u8a08\u7b97\uff08\u7d14\u7c8b\u95a2\u6570\uff09","text":"<pre><code>def possibleMeetings(\n    existingMeetings: List[MeetingTime],\n    startHour: Int,\n    endHour: Int,\n    lengthHours: Int\n): List[MeetingTime] = {\n  val slots = List.range(startHour, endHour - lengthHours + 1)\n    .map(start =&gt; MeetingTime(start, start + lengthHours))\n  slots.filter(slot =&gt;\n    existingMeetings.forall(meeting =&gt; !meetingsOverlap(meeting, slot))\n  )\n}\n</code></pre>"},{"location":"scala/part-4/#87-orelse","title":"8.7 orElse \u306b\u3088\u308b\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0","text":"<p>IO \u306e <code>orElse</code> \u30e1\u30bd\u30c3\u30c9\u3067\u3001\u5931\u6557\u6642\u306e\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002</p> <pre><code>val year: IO[Int]   = IO.delay(996)\nval noYear: IO[Int] = IO.delay(throw new Exception(\"no year\"))\n\nyear.orElse(IO.delay(2020)).unsafeRunSync()    // 996\nnoYear.orElse(IO.delay(2020)).unsafeRunSync()  // 2020\n</code></pre> <p></p>"},{"location":"scala/part-4/#_4","title":"\u30ea\u30c8\u30e9\u30a4\u6226\u7565","text":"<pre><code>// API \u547c\u3073\u51fa\u3057\u30923\u56de\u307e\u3067\u30ea\u30c8\u30e9\u30a4\ncalendarEntries(\"Alice\")\n  .orElse(calendarEntries(\"Alice\"))\n  .orElse(calendarEntries(\"Alice\"))\n  .orElse(IO.pure(List.empty))  // \u5168\u90e8\u5931\u6557\u3057\u305f\u3089\u7a7a\u30ea\u30b9\u30c8\n</code></pre>"},{"location":"scala/part-4/#_5","title":"\u6c4e\u7528\u30ea\u30c8\u30e9\u30a4\u95a2\u6570","text":"<pre><code>def retry[A](action: IO[A], maxRetries: Int): IO[A] = {\n  List.range(0, maxRetries)\n    .map(_ =&gt; action)\n    .foldLeft(action)((program, retryAction) =&gt;\n      program.orElse(retryAction)\n    )\n}\n\n// \u4f7f\u7528\u4f8b\nretry(calendarEntries(\"Alice\"), 10)\n</code></pre>"},{"location":"scala/part-4/#88-sequence-io","title":"8.8 sequence \u306b\u3088\u308b IO \u306e\u30ea\u30b9\u30c8\u51e6\u7406","text":"<p><code>List[IO[A]]</code> \u3092 <code>IO[List[A]]</code> \u306b\u5909\u63db\u3059\u308b\u306b\u306f <code>sequence</code> \u3092\u4f7f\u3044\u307e\u3059\u3002</p> <pre><code>import cats.implicits._\n\nval actions: List[IO[Int]] = List(IO.pure(1), IO.pure(2), IO.pure(3))\nval combined: IO[List[Int]] = actions.sequence\n\ncombined.unsafeRunSync()  // List(1, 2, 3)\n</code></pre>"},{"location":"scala/part-4/#_6","title":"\u8907\u6570\u4eba\u306e\u4e88\u5b9a\u3092\u53d6\u5f97","text":"<pre><code>def scheduledMeetings(attendees: List[String]): IO[List[MeetingTime]] = {\n  attendees\n    .map(attendee =&gt; retry(calendarEntries(attendee), 10))\n    .sequence\n    .map(_.flatten)\n}\n</code></pre>"},{"location":"scala/part-4/#9","title":"\u7b2c9\u7ae0: \u30b9\u30c8\u30ea\u30fc\u30e0\u51e6\u7406","text":""},{"location":"scala/part-4/#91","title":"9.1 \u30b9\u30c8\u30ea\u30fc\u30e0\u3068\u306f","text":"<p>\u30b9\u30c8\u30ea\u30fc\u30e0\u306f\u3001\u8981\u7d20\u306e\uff08\u6f5c\u5728\u7684\u306b\u7121\u9650\u306e\uff09\u30b7\u30fc\u30b1\u30f3\u30b9\u3092\u8868\u3057\u307e\u3059\u3002fs2 \u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002</p> <p></p>"},{"location":"scala/part-4/#92","title":"9.2 \u7d14\u7c8b\u306a\u30b9\u30c8\u30ea\u30fc\u30e0","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch09_CastingDieStream.scala</code></p> <pre><code>import fs2.{Pure, Stream}\n\n// \u6709\u9650\u30b9\u30c8\u30ea\u30fc\u30e0\nval numbers: Stream[Pure, Int] = Stream(1, 2, 3)\n\n// List \u306b\u5909\u63db\nnumbers.toList  // List(1, 2, 3)\n\n// \u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\nval oddNumbers = numbers.filter(_ % 2 != 0)\noddNumbers.toList  // List(1, 3)\n</code></pre>"},{"location":"scala/part-4/#93","title":"9.3 \u7121\u9650\u30b9\u30c8\u30ea\u30fc\u30e0","text":"<pre><code>// repeat \u3067\u7121\u9650\u306b\u7e70\u308a\u8fd4\u3057\nval infinite123s: Stream[Pure, Int] = Stream(1, 2, 3).repeat\n\n// take \u3067\u6709\u9650\u500b\u3092\u53d6\u5f97\ninfinite123s.take(8).toList  // List(1, 2, 3, 1, 2, 3, 1, 2)\n</code></pre>"},{"location":"scala/part-4/#94-io","title":"9.4 IO \u3092\u542b\u3080\u30b9\u30c8\u30ea\u30fc\u30e0","text":"<pre><code>import cats.effect.IO\nimport fs2.Stream\n\ndef castTheDie(): IO[Int] = IO.delay(castTheDieImpure())\n\n// \u5358\u4e00\u306e IO \u3092\u30b9\u30c8\u30ea\u30fc\u30e0\u306b\nval dieCast: Stream[IO, Int] = Stream.eval(castTheDie())\n\n// \u7121\u9650\u306b\u30b5\u30a4\u30b3\u30ed\u3092\u632f\u308b\u30b9\u30c8\u30ea\u30fc\u30e0\nval infiniteDieCasts: Stream[IO, Int] = Stream.eval(castTheDie()).repeat\n</code></pre>"},{"location":"scala/part-4/#_7","title":"\u30b9\u30c8\u30ea\u30fc\u30e0\u306e\u5b9f\u884c","text":"<pre><code>// \u6700\u521d\u306e3\u56de\u3092\u53d6\u5f97\nval firstThree: IO[List[Int]] = infiniteDieCasts.take(3).compile.toList\nfirstThree.unsafeRunSync()  // List(4, 2, 6)\n\n// 6 \u304c\u51fa\u308b\u307e\u3067\u632f\u308a\u7d9a\u3051\u308b\nval six: IO[List[Int]] = infiniteDieCasts.filter(_ == 6).take(1).compile.toList\nsix.unsafeRunSync()  // List(6)\n</code></pre>"},{"location":"scala/part-4/#95","title":"9.5 \u30b9\u30c8\u30ea\u30fc\u30e0\u306e\u4e3b\u8981\u64cd\u4f5c","text":"\u64cd\u4f5c \u8aac\u660e \u4f8b <code>take(n)</code> \u6700\u521d\u306e n \u8981\u7d20\u3092\u53d6\u5f97 <code>stream.take(3)</code> <code>filter(p)</code> \u6761\u4ef6\u3092\u6e80\u305f\u3059\u8981\u7d20\u306e\u307f <code>stream.filter(_ &gt; 0)</code> <code>map(f)</code> \u5404\u8981\u7d20\u3092\u5909\u63db <code>stream.map(_ * 2)</code> <code>append(s)</code> \u5225\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u7d50\u5408 <code>stream1.append(stream2)</code> <code>repeat</code> \u7121\u9650\u306b\u7e70\u308a\u8fd4\u3057 <code>stream.repeat</code> <code>sliding(n)</code> \u30b9\u30e9\u30a4\u30c7\u30a3\u30f3\u30b0\u30a6\u30a3\u30f3\u30c9\u30a6 <code>stream.sliding(3)</code>"},{"location":"scala/part-4/#96","title":"9.6 \u901a\u8ca8\u4ea4\u63db\u30ec\u30fc\u30c8\u306e\u4f8b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch09_CurrencyExchange.scala</code></p> <p>\u70ba\u66ff\u30ec\u30fc\u30c8\u3092\u76e3\u8996\u3057\u3066\u3001\u4e0a\u6607\u30c8\u30ec\u30f3\u30c9\u3092\u691c\u51fa\u3059\u308b\u4f8b\u3067\u3059\u3002</p>"},{"location":"scala/part-4/#_8","title":"\u30c8\u30ec\u30f3\u30c9\u5224\u5b9a\uff08\u7d14\u7c8b\u95a2\u6570\uff09","text":"<pre><code>def trending(rates: List[BigDecimal]): Boolean = {\n  rates.size &gt; 1 &amp;&amp;\n  rates.zip(rates.drop(1)).forall {\n    case (previousRate, rate) =&gt; rate &gt; previousRate\n  }\n}\n\ntrending(List(0.81, 0.82, 0.83))  // true (\u4e0a\u6607\u30c8\u30ec\u30f3\u30c9)\ntrending(List(0.81, 0.84, 0.83))  // false\n</code></pre>"},{"location":"scala/part-4/#_9","title":"\u30ec\u30fc\u30c8\u306e\u30b9\u30c8\u30ea\u30fc\u30e0","text":"<pre><code>def rates(from: Currency, to: Currency): Stream[IO, BigDecimal] = {\n  Stream\n    .eval(exchangeTable(from))\n    .repeat\n    .map(extractSingleCurrencyRate(to))\n    .unNone  // None \u3092\u9664\u5916\n    .orElse(rates(from, to))  // \u30a8\u30e9\u30fc\u6642\u306f\u30ea\u30c8\u30e9\u30a4\n}\n</code></pre>"},{"location":"scala/part-4/#97","title":"9.7 \u30b9\u30e9\u30a4\u30c7\u30a3\u30f3\u30b0\u30a6\u30a3\u30f3\u30c9\u30a6","text":"<p><code>sliding</code> \u3067\u9023\u7d9a\u3059\u308b\u8981\u7d20\u3092\u30b0\u30eb\u30fc\u30d7\u5316\u3067\u304d\u307e\u3059\u3002</p> <pre><code>val stream = Stream(1, 2, 3, 4, 5)\n\nstream.sliding(3).toList\n// List(Queue(1, 2, 3), Queue(2, 3, 4), Queue(3, 4, 5))\n</code></pre> <p></p>"},{"location":"scala/part-4/#_10","title":"\u30c8\u30ec\u30f3\u30c9\u3092\u691c\u51fa\u3057\u3066\u4ea4\u63db","text":"<pre><code>def exchangeIfTrending(\n    amount: BigDecimal,\n    from: Currency,\n    to: Currency\n): IO[BigDecimal] = {\n  rates(from, to)\n    .sliding(3)\n    .map(_.toList)\n    .filter(trending)        // \u4e0a\u6607\u30c8\u30ec\u30f3\u30c9\u3092\u691c\u51fa\n    .map(_.last)             // \u6700\u65b0\u306e\u30ec\u30fc\u30c8\u3092\u53d6\u5f97\n    .take(1)\n    .compile\n    .lastOrError\n    .map(_ * amount)\n}\n</code></pre>"},{"location":"scala/part-4/#98","title":"9.8 \u30b9\u30c8\u30ea\u30fc\u30e0\u306e\u7d50\u5408","text":"<p>2\u3064\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\u3092 <code>zip</code> \u3067\u7d50\u5408\u3067\u304d\u307e\u3059\u3002</p> <pre><code>import scala.concurrent.duration._\n\nval ticks: Stream[IO, Unit] = Stream.fixedRate[IO](1.second)\n\n// \u30ec\u30fc\u30c8\u3068 tick \u3092\u7d50\u5408\uff081\u79d2\u9593\u9694\u3067\u53d6\u5f97\uff09\nval ratesWithDelay = rates(from, to).zipLeft(ticks)\n</code></pre> <p></p>"},{"location":"scala/part-4/#_11","title":"\u307e\u3068\u3081","text":""},{"location":"scala/part-4/#part-iv","title":"Part IV \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"scala/part-4/#io-stream","title":"IO \u3068 Stream \u306e\u6bd4\u8f03","text":"\u7279\u6027 IO[A] Stream[IO, A] \u8981\u7d20\u6570 1\u3064 0\u500b\u4ee5\u4e0a\uff08\u7121\u9650\u3082\u53ef\uff09 \u5b9f\u884c <code>unsafeRunSync()</code> <code>compile.toList.unsafeRunSync()</code> \u7528\u9014 \u5358\u4e00\u306e\u526f\u4f5c\u7528 \u9023\u7d9a\u3057\u305f\u526f\u4f5c\u7528"},{"location":"scala/part-4/#_12","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>IO \u30e2\u30ca\u30c9: \u526f\u4f5c\u7528\u3092\u300c\u8a18\u8ff0\u300d\u3068\u3057\u3066\u6271\u3044\u3001\u5b9f\u884c\u3092\u9045\u5ef6\u3055\u305b\u308b</li> <li>IO.delay: \u526f\u4f5c\u7528\u306e\u3042\u308b\u5f0f\u3092 IO \u306b\u30e9\u30c3\u30d7</li> <li>orElse: \u5931\u6557\u6642\u306e\u30d5\u30a9\u30fc\u30eb\u30d0\u30c3\u30af\u3092\u6307\u5b9a</li> <li>sequence: <code>List[IO[A]]</code> \u2192 <code>IO[List[A]]</code></li> <li>Stream: \u6f5c\u5728\u7684\u306b\u7121\u9650\u306e\u30b7\u30fc\u30b1\u30f3\u30b9\u3092\u9045\u5ef6\u8a55\u4fa1\u3067\u51e6\u7406</li> <li>sliding: \u9023\u7d9a\u3059\u308b\u8981\u7d20\u3092\u30b0\u30eb\u30fc\u30d7\u5316\u3057\u3066\u30d1\u30bf\u30fc\u30f3\u3092\u691c\u51fa</li> </ol>"},{"location":"scala/part-4/#_13","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part V \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li>\u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406</li> <li>Fiber \u306b\u3088\u308b\u8efd\u91cf\u30b9\u30ec\u30c3\u30c9</li> <li>Ref \u306b\u3088\u308b\u5171\u6709\u72b6\u614b\u7ba1\u7406</li> </ul>"},{"location":"scala/part-4/#_14","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"scala/part-4/#1-io","title":"\u554f\u984c 1: IO \u306e\u57fa\u672c","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>import cats.effect.IO\n\ndef printAndReturn(message: String): IO[String] = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\n// printAndReturn(\"Hello\").unsafeRunSync() \u306f\n// \"Hello\" \u3092\u30b3\u30f3\u30bd\u30fc\u30eb\u306b\u51fa\u529b\u3057\u3001\"Hello\" \u3092\u8fd4\u3059\n</code></pre> \u89e3\u7b54 <pre><code>def printAndReturn(message: String): IO[String] = {\n  IO.delay {\n    println(message)\n    message\n  }\n}\n\n// \u307e\u305f\u306f\ndef printAndReturn(message: String): IO[String] = {\n  for {\n    _ &lt;- IO.delay(println(message))\n  } yield message\n}\n</code></pre>"},{"location":"scala/part-4/#2-io","title":"\u554f\u984c 2: IO \u306e\u5408\u6210","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u30022\u3064\u306e IO \u3092\u9806\u756a\u306b\u5b9f\u884c\u3057\u3001\u7d50\u679c\u3092\u7d50\u5408\u3057\u307e\u3059\u3002</p> <pre><code>def combineIO[A, B, C](io1: IO[A], io2: IO[B])(f: (A, B) =&gt; C): IO[C] = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nval result = combineIO(IO.pure(1), IO.pure(2))(_ + _)\nresult.unsafeRunSync()  // 3\n</code></pre> \u89e3\u7b54 <pre><code>def combineIO[A, B, C](io1: IO[A], io2: IO[B])(f: (A, B) =&gt; C): IO[C] = {\n  for {\n    a &lt;- io1\n    b &lt;- io2\n  } yield f(a, b)\n}\n</code></pre>"},{"location":"scala/part-4/#3","title":"\u554f\u984c 3: \u30ea\u30c8\u30e9\u30a4","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u6307\u5b9a\u56de\u6570\u30ea\u30c8\u30e9\u30a4\u3057\u3001\u5168\u90e8\u5931\u6557\u3057\u305f\u3089\u30c7\u30d5\u30a9\u30eb\u30c8\u5024\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>def retryWithDefault[A](action: IO[A], maxRetries: Int, default: A): IO[A] = ???\n</code></pre> \u89e3\u7b54 <pre><code>def retryWithDefault[A](action: IO[A], maxRetries: Int, default: A): IO[A] = {\n  List.range(0, maxRetries)\n    .foldLeft(action)((program, _) =&gt; program.orElse(action))\n    .orElse(IO.pure(default))\n}\n</code></pre>"},{"location":"scala/part-4/#4","title":"\u554f\u984c 4: \u30b9\u30c8\u30ea\u30fc\u30e0\u64cd\u4f5c","text":"<p>\u4ee5\u4e0b\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\u3092\u4f5c\u6210\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> <pre><code>import fs2.Stream\n\n// 1. 1\u304b\u308910\u307e\u3067\u306e\u5076\u6570\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\nval evens: Stream[Pure, Int] = ???\n\n// 2. \u7121\u9650\u306b\u4ea4\u4e92\u306b true/false \u3092\u8fd4\u3059\u30b9\u30c8\u30ea\u30fc\u30e0\nval alternating: Stream[Pure, Boolean] = ???\n\n// 3. \u6700\u521d\u306e5\u3064\u306e\u8981\u7d20\u306e\u5408\u8a08\u3092\u8a08\u7b97\nval sum: Int = Stream(1, 2, 3, 4, 5, 6, 7, 8, 9, 10).take(5).???\n</code></pre> \u89e3\u7b54 <pre><code>// 1. 1\u304b\u308910\u307e\u3067\u306e\u5076\u6570\nval evens: Stream[Pure, Int] = Stream.range(1, 11).filter(_ % 2 == 0)\n// \u307e\u305f\u306f\nval evens: Stream[Pure, Int] = Stream(2, 4, 6, 8, 10)\n\n// 2. \u7121\u9650\u306b\u4ea4\u4e92\u306b true/false\nval alternating: Stream[Pure, Boolean] = Stream(true, false).repeat\n\n// 3. \u6700\u521d\u306e5\u3064\u306e\u8981\u7d20\u306e\u5408\u8a08\nval sum: Int = Stream(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)\n  .take(5)\n  .toList\n  .sum  // 15\n</code></pre>"},{"location":"scala/part-4/#5","title":"\u554f\u984c 5: \u30c8\u30ec\u30f3\u30c9\u691c\u51fa","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u76f4\u8fd13\u3064\u306e\u5024\u304c\u5168\u3066\u540c\u3058\u304b\u3069\u3046\u304b\u3092\u5224\u5b9a\u3057\u307e\u3059\u3002</p> <pre><code>def isStable(values: List[Int]): Boolean = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nassert(isStable(List(5, 5, 5)) == true)\nassert(isStable(List(5, 5, 6)) == false)\nassert(isStable(List(5, 6, 5)) == false)\nassert(isStable(List(5)) == false)  // 3\u3064\u672a\u6e80\u306f false\n</code></pre> \u89e3\u7b54 <pre><code>def isStable(values: List[Int]): Boolean = {\n  values.size &gt;= 3 &amp;&amp;\n  values.zip(values.drop(1)).forall {\n    case (prev, curr) =&gt; prev == curr\n  }\n}\n\n// \u307e\u305f\u306f\ndef isStable(values: List[Int]): Boolean = {\n  values.size &gt;= 3 &amp;&amp; values.distinct.size == 1\n}\n</code></pre>"},{"location":"scala/part-5/","title":"Part V: \u4e26\u884c\u51e6\u7406","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u4e26\u884c\u51e6\u7406\u3092\u5b66\u3073\u307e\u3059\u3002Fiber \u306b\u3088\u308b\u8efd\u91cf\u30b9\u30ec\u30c3\u30c9\u3001Ref \u306b\u3088\u308b\u5b89\u5168\u306a\u5171\u6709\u72b6\u614b\u7ba1\u7406\u3001\u305d\u3057\u3066\u4e26\u884c\u30d7\u30ed\u30b0\u30e9\u30e0\u306e\u69cb\u7bc9\u65b9\u6cd5\u3092\u7fd2\u5f97\u3057\u307e\u3059\u3002</p>"},{"location":"scala/part-5/#10","title":"\u7b2c10\u7ae0: \u4e26\u884c\u30fb\u4e26\u5217\u51e6\u7406","text":""},{"location":"scala/part-5/#101","title":"10.1 \u4e26\u884c\u51e6\u7406\u306e\u8ab2\u984c","text":"<p>\u5f93\u6765\u306e\u4e26\u884c\u51e6\u7406\u306b\u306f\u591a\u304f\u306e\u8ab2\u984c\u304c\u3042\u308a\u307e\u3059:</p> <ul> <li>\u30c7\u30c3\u30c9\u30ed\u30c3\u30af</li> <li>\u7af6\u5408\u72b6\u614b\uff08Race Condition\uff09</li> <li>\u5171\u6709\u72b6\u614b\u306e\u7ba1\u7406\u306e\u8907\u96d1\u3055</li> <li>\u30b9\u30ec\u30c3\u30c9\u306e\u30aa\u30fc\u30d0\u30fc\u30d8\u30c3\u30c9</li> </ul> <p></p>"},{"location":"scala/part-5/#102","title":"10.2 \u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u306e\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u96c6\u8a08","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch10_CheckIns.scala</code></p> <p>\u90fd\u5e02\u3078\u306e\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u3092\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u3067\u96c6\u8a08\u3057\u3001\u30e9\u30f3\u30ad\u30f3\u30b0\u3092\u66f4\u65b0\u3059\u308b\u4f8b\u3092\u898b\u3066\u3044\u304d\u307e\u3059\u3002</p> <pre><code>case class City(name: String)\ncase class CityStats(city: City, checkIns: Int)\n\n// \u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u306e\u30b9\u30c8\u30ea\u30fc\u30e0\nval checkIns: Stream[IO, City] =\n  Stream(City(\"Sydney\"), City(\"Dublin\"), City(\"Cape Town\"), City(\"Lima\"), City(\"Singapore\"))\n    .repeatN(100_000)\n    .covary[IO]\n</code></pre>"},{"location":"scala/part-5/#3","title":"\u30c8\u30c3\u30d73\u90fd\u5e02\u306e\u8a08\u7b97\uff08\u7d14\u7c8b\u95a2\u6570\uff09","text":"<pre><code>def topCities(cityCheckIns: Map[City, Int]): List[CityStats] = {\n  cityCheckIns.toList\n    .map { case (city, checkIns) =&gt; CityStats(city, checkIns) }\n    .sortBy(_.checkIns)\n    .reverse\n    .take(3)\n}\n</code></pre>"},{"location":"scala/part-5/#103","title":"10.3 \u9010\u6b21\u51e6\u7406\u306e\u554f\u984c","text":"<p>\u6700\u521d\u306e\u5b9f\u88c5\u306f\u9010\u6b21\u51e6\u7406\u3067\u3001\u30d1\u30d5\u30a9\u30fc\u30de\u30f3\u30b9\u306b\u554f\u984c\u304c\u3042\u308a\u307e\u3059\u3002</p> <pre><code>def processCheckIns(checkIns: Stream[IO, City]): IO[Unit] = {\n  checkIns\n    .scan(Map.empty[City, Int])((cityCheckIns, city) =&gt;\n      cityCheckIns.updatedWith(city)(_.map(_ + 1).orElse(Some(1)))\n    )\n    .map(topCities)\n    .foreach(IO.println)\n    .compile\n    .drain\n}\n</code></pre> <p></p>"},{"location":"scala/part-5/#104-ref-","title":"10.4 Ref - \u30a2\u30c8\u30df\u30c3\u30af\u306a\u5171\u6709\u72b6\u614b","text":"<p>Ref \u306f\u3001\u8907\u6570\u306e\u4e26\u884c\u51e6\u7406\u304b\u3089\u5b89\u5168\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u30a2\u30c8\u30df\u30c3\u30af\u306a\u53c2\u7167\u3067\u3059\u3002</p> <pre><code>import cats.effect.Ref\n\n// Ref \u306e\u4f5c\u6210\u3068\u4f7f\u7528\nval example: IO[Int] = for {\n  counter &lt;- Ref.of[IO, Int](0)    // \u521d\u671f\u5024 0 \u306e Ref \u3092\u4f5c\u6210\n  _       &lt;- counter.update(_ + 3)  // \u30a2\u30c8\u30df\u30c3\u30af\u306b\u66f4\u65b0\n  result  &lt;- counter.get            // \u73fe\u5728\u306e\u5024\u3092\u53d6\u5f97\n} yield result\n\nexample.unsafeRunSync()  // 3\n</code></pre> <p></p>"},{"location":"scala/part-5/#ref","title":"Ref \u306e\u4e3b\u8981\u30e1\u30bd\u30c3\u30c9","text":"\u30e1\u30bd\u30c3\u30c9 \u8aac\u660e \u4f8b <code>Ref.of[IO, A](initial)</code> \u521d\u671f\u5024\u3067 Ref \u3092\u4f5c\u6210 <code>Ref.of[IO, Int](0)</code> <code>ref.get</code> \u73fe\u5728\u306e\u5024\u3092\u53d6\u5f97 <code>counter.get</code> <code>ref.set(value)</code> \u5024\u3092\u8a2d\u5b9a <code>counter.set(10)</code> <code>ref.update(f)</code> \u30a2\u30c8\u30df\u30c3\u30af\u306b\u66f4\u65b0 <code>counter.update(_ + 1)</code> <code>ref.modify(f)</code> \u66f4\u65b0\u3057\u3066\u53e4\u3044\u5024\u3092\u8fd4\u3059 <code>counter.modify(n =&gt; (n + 1, n))</code>"},{"location":"scala/part-5/#105-parsequence-","title":"10.5 parSequence - \u4e26\u5217\u5b9f\u884c","text":"<p><code>sequence</code> \u306f IO \u3092\u9806\u756a\u306b\u5b9f\u884c\u3057\u307e\u3059\u304c\u3001<code>parSequence</code> \u306f\u4e26\u5217\u306b\u5b9f\u884c\u3057\u307e\u3059\u3002</p> <pre><code>import cats.implicits._\n\n// \u9806\u6b21\u5b9f\u884c\nval sequential: IO[List[Int]] =\n  List(IO.pure(1), IO.pure(2), IO.pure(3)).sequence\n\n// \u4e26\u5217\u5b9f\u884c\nval parallel: IO[List[Int]] =\n  List(IO.pure(1), IO.pure(2), IO.pure(3)).parSequence\n</code></pre> <p></p>"},{"location":"scala/part-5/#_1","title":"\u30b9\u30ea\u30fc\u30d7\u3092\u4f7f\u3063\u305f\u6bd4\u8f03","text":"<pre><code>import scala.concurrent.duration._\n\nval program1 = IO.sleep(1.second).flatMap(_ =&gt; IO.pure(1))\nval program2 = IO.sleep(1.second).flatMap(_ =&gt; IO.pure(2))\nval program3 = IO.sleep(1.second).flatMap(_ =&gt; IO.pure(3))\n\n// \u9806\u6b21\u5b9f\u884c: \u7d043\u79d2\nList(program1, program2, program3).sequence\n\n// \u4e26\u5217\u5b9f\u884c: \u7d041\u79d2\nList(program1, program2, program3).parSequence\n</code></pre>"},{"location":"scala/part-5/#106","title":"10.6 \u30b5\u30a4\u30b3\u30ed\u3092\u4e26\u884c\u3057\u3066\u632f\u308b","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch10_CastingDieConcurrently.scala</code></p> <pre><code>def castTheDie(): IO[Int] = IO.delay(castTheDieImpure())\n\n// 2\u3064\u306e\u30b5\u30a4\u30b3\u30ed\u3092\u4e26\u884c\u3057\u3066\u632f\u308a\u3001\u5408\u8a08\u3092\u8fd4\u3059\nval program: IO[Int] = for {\n  _      &lt;- IO.sleep(1.second)\n  result &lt;- List(castTheDie(), castTheDie()).parSequence\n} yield result.sum\n</code></pre>"},{"location":"scala/part-5/#ref-parsequence","title":"Ref \u3068 parSequence \u306e\u7d44\u307f\u5408\u308f\u305b","text":"<pre><code>// 3\u3064\u306e\u30b5\u30a4\u30b3\u30ed\u3092\u4e26\u884c\u3057\u3066\u632f\u308a\u3001\u7d50\u679c\u3092 Ref \u306b\u4fdd\u5b58\nval program: IO[List[Int]] = for {\n  storedCasts &lt;- Ref.of[IO, List[Int]](List.empty)\n  singleCast   = castTheDie().flatMap(result =&gt;\n                   storedCasts.update(_.appended(result)))\n  _           &lt;- List.fill(3)(singleCast).parSequence\n  casts       &lt;- storedCasts.get\n} yield casts\n</code></pre>"},{"location":"scala/part-5/#107","title":"10.7 \u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u51e6\u7406\u306e\u4e26\u884c\u7248","text":"<p>\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u306e\u4fdd\u5b58\u3068\u30e9\u30f3\u30ad\u30f3\u30b0\u306e\u66f4\u65b0\u3092\u4e26\u884c\u3057\u3066\u5b9f\u884c\u3057\u307e\u3059\u3002</p>"},{"location":"scala/part-5/#_2","title":"\u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u306e\u4fdd\u5b58","text":"<pre><code>def storeCheckIn(storedCheckIns: Ref[IO, Map[City, Int]])(city: City): IO[Unit] = {\n  storedCheckIns.update(_.updatedWith(city) {\n    case None           =&gt; Some(1)\n    case Some(checkIns) =&gt; Some(checkIns + 1)\n  })\n}\n</code></pre>"},{"location":"scala/part-5/#_3","title":"\u30e9\u30f3\u30ad\u30f3\u30b0\u306e\u7d99\u7d9a\u7684\u306a\u66f4\u65b0","text":"<pre><code>def updateRanking(\n    storedCheckIns: Ref[IO, Map[City, Int]],\n    storedRanking: Ref[IO, List[CityStats]]\n): IO[Nothing] = {\n  storedCheckIns.get\n    .map(topCities)\n    .flatMap(storedRanking.set)\n    .foreverM  // \u6c38\u9060\u306b\u7e70\u308a\u8fd4\u3059\n}\n</code></pre>"},{"location":"scala/part-5/#_4","title":"\u5b8c\u5168\u306a\u4e26\u884c\u51e6\u7406\u7248","text":"<pre><code>def processCheckIns(checkIns: Stream[IO, City]): IO[Unit] = {\n  for {\n    storedCheckIns &lt;- Ref.of[IO, Map[City, Int]](Map.empty)\n    storedRanking  &lt;- Ref.of[IO, List[CityStats]](List.empty)\n\n    // \u30e9\u30f3\u30ad\u30f3\u30b0\u66f4\u65b0\u30d7\u30ed\u30b0\u30e9\u30e0\uff08\u6c38\u9060\u306b\u5b9f\u884c\uff09\n    rankingProgram  = updateRanking(storedCheckIns, storedRanking)\n\n    // \u30c1\u30a7\u30c3\u30af\u30a4\u30f3\u51e6\u7406\u30d7\u30ed\u30b0\u30e9\u30e0\n    checkInsProgram = checkIns.evalMap(storeCheckIn(storedCheckIns)).compile.drain\n\n    // \u51fa\u529b\u30d7\u30ed\u30b0\u30e9\u30e0\uff081\u79d2\u3054\u3068\u306b\u30e9\u30f3\u30ad\u30f3\u30b0\u3092\u51fa\u529b\uff09\n    outputProgram   = IO.sleep(1.second)\n                        .flatMap(_ =&gt; storedRanking.get)\n                        .flatMap(IO.println)\n                        .foreverM\n\n    // 3\u3064\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u4e26\u884c\u5b9f\u884c\n    _ &lt;- List(rankingProgram, checkInsProgram, outputProgram).parSequence\n  } yield ()\n}\n</code></pre>"},{"location":"scala/part-5/#108-fiber-","title":"10.8 Fiber - \u8efd\u91cf\u30b9\u30ec\u30c3\u30c9","text":"<p>Fiber \u306f\u3001OS \u30b9\u30ec\u30c3\u30c9\u3088\u308a\u3082\u306f\u308b\u304b\u306b\u8efd\u91cf\u306a\u5b9f\u884c\u5358\u4f4d\u3067\u3059\u3002</p> <p></p>"},{"location":"scala/part-5/#fiber","title":"Fiber \u306e\u8d77\u52d5\u3068\u30ad\u30e3\u30f3\u30bb\u30eb","text":"<pre><code>val program: IO[Unit] = for {\n  // Fiber \u3092\u8d77\u52d5\uff08\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u5b9f\u884c\uff09\n  fiber &lt;- IO.sleep(300.millis)\n             .flatMap(_ =&gt; IO.println(\"hello\"))\n             .foreverM\n             .start\n\n  // 1\u79d2\u5f85\u6a5f\n  _ &lt;- IO.sleep(1.second)\n\n  // Fiber \u3092\u30ad\u30e3\u30f3\u30bb\u30eb\n  _ &lt;- fiber.cancel\n\n  // \u3055\u3089\u306b1\u79d2\u5f85\u6a5f\uff08hello \u306f\u51fa\u529b\u3055\u308c\u306a\u3044\uff09\n  _ &lt;- IO.sleep(1.second)\n} yield ()\n</code></pre>"},{"location":"scala/part-5/#109","title":"10.9 \u547c\u3073\u51fa\u3057\u5143\u306b\u5236\u5fa1\u3092\u8fd4\u3059","text":"<p>Fiber \u3092\u4f7f\u3063\u3066\u3001\u547c\u3073\u51fa\u3057\u5143\u306b\u5236\u5fa1\u3092\u8fd4\u3057\u3064\u3064\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u51e6\u7406\u3092\u7d9a\u3051\u308b\u8a2d\u8a08\u304c\u3067\u304d\u307e\u3059\u3002</p> <pre><code>case class ProcessingCheckIns(\n  currentRanking: IO[List[CityStats]],  // \u73fe\u5728\u306e\u30e9\u30f3\u30ad\u30f3\u30b0\u3092\u53d6\u5f97\n  stop: IO[Unit]                         // \u51e6\u7406\u3092\u505c\u6b62\n)\n\ndef processCheckIns(checkIns: Stream[IO, City]): IO[ProcessingCheckIns] = {\n  for {\n    storedCheckIns &lt;- Ref.of[IO, Map[City, Int]](Map.empty)\n    storedRanking  &lt;- Ref.of[IO, List[CityStats]](List.empty)\n\n    rankingProgram  = updateRanking(storedCheckIns, storedRanking)\n    checkInsProgram = checkIns.evalMap(storeCheckIn(storedCheckIns)).compile.drain\n\n    // Fiber \u3068\u3057\u3066\u8d77\u52d5\u3057\u3001\u3059\u3050\u306b\u623b\u308b\n    fiber &lt;- List(rankingProgram, checkInsProgram).parSequence.start\n  } yield ProcessingCheckIns(storedRanking.get, fiber.cancel)\n}\n</code></pre> <p></p>"},{"location":"scala/part-5/#_5","title":"\u4f7f\u7528\u4f8b","text":"<pre><code>val program: IO[List[CityStats]] = for {\n  processing &lt;- processCheckIns(checkIns)\n\n  // \u6700\u521d\u306e\u30e9\u30f3\u30ad\u30f3\u30b0\u3092\u53d6\u5f97\n  ranking    &lt;- processing.currentRanking\n  _          &lt;- IO.println(ranking)\n\n  // 1\u79d2\u5f85\u6a5f\n  _          &lt;- IO.sleep(1.second)\n\n  // \u66f4\u65b0\u3055\u308c\u305f\u30e9\u30f3\u30ad\u30f3\u30b0\u3092\u53d6\u5f97\n  newRanking &lt;- processing.currentRanking\n\n  // \u51e6\u7406\u3092\u505c\u6b62\n  _          &lt;- processing.stop\n} yield newRanking\n</code></pre>"},{"location":"scala/part-5/#1010-iosleep-vs-threadsleep","title":"10.10 IO.sleep vs Thread.sleep","text":"<p><code>IO.sleep</code> \u3068 <code>Thread.sleep</code> \u306f\u7570\u306a\u308b\u52d5\u4f5c\u3092\u3057\u307e\u3059\u3002</p> \u7279\u6027 IO.sleep Thread.sleep \u30d6\u30ed\u30c3\u30af\u5bfe\u8c61 Fiber OS Thread \u30ea\u30bd\u30fc\u30b9 \u8efd\u91cf \u91cd\u3044 \u4e26\u884c\u6027 \u4ed6\u306e Fiber \u304c\u5b9f\u884c\u53ef\u80fd \u30b9\u30ec\u30c3\u30c9\u304c\u30d6\u30ed\u30c3\u30af <pre><code>// Thread.sleep: \u30b9\u30ec\u30c3\u30c9\u3092\u30d6\u30ed\u30c3\u30af\nval threadSleep = IO.delay(Thread.sleep(1000))\n\n// IO.sleep: Fiber \u3092\u30b9\u30ea\u30fc\u30d7\uff08\u30b9\u30ec\u30c3\u30c9\u306f\u89e3\u653e\uff09\nval fiberSleep = IO.sleep(1.second)\n\n// \u30b7\u30f3\u30b0\u30eb\u30b9\u30ec\u30c3\u30c9\u30673\u3064\u306e IO.sleep \u3092\u4e26\u884c\u5b9f\u884c \u2192 \u7d041\u79d2\nList.fill(3)(fiberSleep).parSequence\n\n// \u30b7\u30f3\u30b0\u30eb\u30b9\u30ec\u30c3\u30c9\u30673\u3064\u306e Thread.sleep \u3092\u4e26\u884c\u5b9f\u884c \u2192 \u7d043\u79d2\nList.fill(3)(threadSleep).parSequence\n</code></pre>"},{"location":"scala/part-5/#_6","title":"\u307e\u3068\u3081","text":""},{"location":"scala/part-5/#part-v_1","title":"Part V \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"scala/part-5/#_7","title":"\u4e3b\u8981\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8","text":"\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8 \u7528\u9014 <code>Ref[IO, A]</code> \u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u5171\u6709\u72b6\u614b <code>parSequence</code> IO \u306e\u30ea\u30b9\u30c8\u3092\u4e26\u5217\u5b9f\u884c <code>Fiber</code> \u8efd\u91cf\u306a\u5b9f\u884c\u5358\u4f4d <code>fiber.start</code> Fiber \u3092\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u8d77\u52d5 <code>fiber.cancel</code> Fiber \u3092\u30ad\u30e3\u30f3\u30bb\u30eb <code>foreverM</code> \u6c38\u9060\u306b\u7e70\u308a\u8fd4\u3057\u5b9f\u884c"},{"location":"scala/part-5/#_8","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>Ref: \u8907\u6570\u306e\u4e26\u884c\u51e6\u7406\u304b\u3089\u5b89\u5168\u306b\u30a2\u30af\u30bb\u30b9\u3067\u304d\u308b\u30a2\u30c8\u30df\u30c3\u30af\u306a\u53c2\u7167</li> <li>parSequence: IO \u306e\u30ea\u30b9\u30c8\u3092\u4e26\u5217\u5b9f\u884c\u3057\u3066\u7d50\u679c\u3092\u96c6\u7d04</li> <li>Fiber: OS \u30b9\u30ec\u30c3\u30c9\u3088\u308a\u8efd\u91cf\u3067\u3001\u6570\u767e\u4e07\u306e\u4e26\u884c\u51e6\u7406\u304c\u53ef\u80fd</li> <li>start: Fiber \u3092\u30d0\u30c3\u30af\u30b0\u30e9\u30a6\u30f3\u30c9\u3067\u8d77\u52d5\u3057\u3001\u3059\u3050\u306b\u5236\u5fa1\u3092\u8fd4\u3059</li> <li>IO.sleep: Fiber \u3092\u30b9\u30ea\u30fc\u30d7\u3055\u305b\u3001\u30b9\u30ec\u30c3\u30c9\u306f\u89e3\u653e\u3059\u308b</li> </ol>"},{"location":"scala/part-5/#_9","title":"\u8a2d\u8a08\u30d1\u30bf\u30fc\u30f3","text":""},{"location":"scala/part-5/#_10","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<p>Part VI \u3067\u306f\u3001\u4ee5\u4e0b\u306e\u30c8\u30d4\u30c3\u30af\u3092\u5b66\u3073\u307e\u3059:</p> <ul> <li>\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9</li> <li>\u5916\u90e8 API \u3068\u306e\u9023\u643a</li> <li>\u30c6\u30b9\u30c8\u6226\u7565</li> </ul>"},{"location":"scala/part-5/#_11","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"scala/part-5/#1-ref","title":"\u554f\u984c 1: Ref \u306e\u57fa\u672c","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u30ab\u30a6\u30f3\u30bf\u30fc\u3092 0 \u304b\u3089\u59cb\u3081\u3066\u30013\u56de\u30a4\u30f3\u30af\u30ea\u30e1\u30f3\u30c8\u3057\u305f\u7d50\u679c\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>def incrementThreeTimes(): IO[Int] = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nincrementThreeTimes().unsafeRunSync()  // 3\n</code></pre> \u89e3\u7b54 <pre><code>def incrementThreeTimes(): IO[Int] = {\n  for {\n    counter &lt;- Ref.of[IO, Int](0)\n    _       &lt;- counter.update(_ + 1)\n    _       &lt;- counter.update(_ + 1)\n    _       &lt;- counter.update(_ + 1)\n    result  &lt;- counter.get\n  } yield result\n}\n</code></pre>"},{"location":"scala/part-5/#2","title":"\u554f\u984c 2: \u4e26\u5217\u5b9f\u884c","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u30023\u3064\u306e IO \u3092\u4e26\u5217\u5b9f\u884c\u3057\u3001\u7d50\u679c\u306e\u5408\u8a08\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>def sumParallel(io1: IO[Int], io2: IO[Int], io3: IO[Int]): IO[Int] = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nsumParallel(IO.pure(1), IO.pure(2), IO.pure(3)).unsafeRunSync()  // 6\n</code></pre> \u89e3\u7b54 <pre><code>import cats.implicits._\n\ndef sumParallel(io1: IO[Int], io2: IO[Int], io3: IO[Int]): IO[Int] = {\n  List(io1, io2, io3).parSequence.map(_.sum)\n}\n</code></pre>"},{"location":"scala/part-5/#3_1","title":"\u554f\u984c 3: \u4e26\u884c\u30ab\u30a6\u30f3\u30c8","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002100\u500b\u306e IO \u3092\u4e26\u884c\u5b9f\u884c\u3057\u3001\u305d\u306e\u3046\u3061\u5076\u6570\u3092\u8fd4\u3057\u305f\u56de\u6570\u3092\u30ab\u30a6\u30f3\u30c8\u3057\u307e\u3059\u3002</p> <pre><code>def countEvens(ios: List[IO[Int]]): IO[Int] = ???\n\n// \u4f7f\u7528\u4f8b\nval ios = List.fill(100)(IO.delay(scala.util.Random.nextInt(10)))\ncountEvens(ios).unsafeRunSync()  // \u7d0450\uff08\u30e9\u30f3\u30c0\u30e0\uff09\n</code></pre> \u89e3\u7b54 <pre><code>def countEvens(ios: List[IO[Int]]): IO[Int] = {\n  for {\n    counter &lt;- Ref.of[IO, Int](0)\n    _       &lt;- ios.map(io =&gt;\n                 io.flatMap(n =&gt;\n                   if (n % 2 == 0) counter.update(_ + 1)\n                   else IO.unit\n                 )\n               ).parSequence\n    result  &lt;- counter.get\n  } yield result\n}\n</code></pre>"},{"location":"scala/part-5/#4","title":"\u554f\u984c 4: \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u4ed8\u304d\u5b9f\u884c","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u6307\u5b9a\u6642\u9593\u5f8c\u306b Fiber \u3092\u30ad\u30e3\u30f3\u30bb\u30eb\u3057\u3001\u305d\u308c\u307e\u3067\u306b\u84c4\u7a4d\u3055\u308c\u305f\u7d50\u679c\u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>def collectFor(duration: FiniteDuration): IO[List[Int]] = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\n// 1\u79d2\u9593\u3001100ms\u3054\u3068\u306b\u4e71\u6570\u3092\u751f\u6210\u3057\u3066\u30ea\u30b9\u30c8\u306b\u8ffd\u52a0\n// \u7d0410\u500b\u306e\u8981\u7d20\u304c\u8fd4\u3055\u308c\u308b\ncollectFor(1.second).unsafeRunSync()\n</code></pre> \u89e3\u7b54 <pre><code>import scala.concurrent.duration._\n\ndef collectFor(duration: FiniteDuration): IO[List[Int]] = {\n  for {\n    collected &lt;- Ref.of[IO, List[Int]](List.empty)\n\n    // 100ms\u3054\u3068\u306b\u4e71\u6570\u3092\u8ffd\u52a0\u3059\u308b\u30d7\u30ed\u30b0\u30e9\u30e0\n    producer = (IO.sleep(100.millis) *&gt;\n                IO.delay(scala.util.Random.nextInt(100))\n                  .flatMap(n =&gt; collected.update(_.appended(n))))\n                .foreverM\n\n    // Fiber \u3068\u3057\u3066\u8d77\u52d5\n    fiber &lt;- producer.start\n\n    // \u6307\u5b9a\u6642\u9593\u5f85\u6a5f\n    _ &lt;- IO.sleep(duration)\n\n    // \u30ad\u30e3\u30f3\u30bb\u30eb\n    _ &lt;- fiber.cancel\n\n    // \u7d50\u679c\u3092\u53d6\u5f97\n    result &lt;- collected.get\n  } yield result\n}\n</code></pre>"},{"location":"scala/part-5/#5","title":"\u554f\u984c 5: \u4e26\u884c\u30de\u30c3\u30d7\u66f4\u65b0","text":"<p>\u4ee5\u4e0b\u306e\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u8907\u6570\u306e\u66f4\u65b0\u3092\u4e26\u884c\u3057\u3066 Map \u306b\u9069\u7528\u3057\u3001\u6700\u7d42\u7684\u306a Map \u3092\u8fd4\u3057\u307e\u3059\u3002</p> <pre><code>case class Update(key: String, value: Int)\n\ndef applyUpdates(updates: List[Update]): IO[Map[String, Int]] = ???\n\n// \u671f\u5f85\u3055\u308c\u308b\u52d5\u4f5c\nval updates = List(\n  Update(\"a\", 1),\n  Update(\"b\", 2),\n  Update(\"a\", 3),  // \"a\" \u3092\u4e0a\u66f8\u304d\n  Update(\"c\", 4)\n)\napplyUpdates(updates).unsafeRunSync()  // Map(\"a\" -&gt; 3, \"b\" -&gt; 2, \"c\" -&gt; 4)\n</code></pre> \u89e3\u7b54 <pre><code>case class Update(key: String, value: Int)\n\ndef applyUpdates(updates: List[Update]): IO[Map[String, Int]] = {\n  for {\n    mapRef &lt;- Ref.of[IO, Map[String, Int]](Map.empty)\n    _      &lt;- updates.map(update =&gt;\n                mapRef.update(_.updated(update.key, update.value))\n              ).parSequence\n    result &lt;- mapRef.get\n  } yield result\n}\n</code></pre>  \u6ce8\u610f: \u4e26\u884c\u5b9f\u884c\u306a\u306e\u3067\u3001\u540c\u3058\u30ad\u30fc\u3078\u306e\u8907\u6570\u306e\u66f4\u65b0\u304c\u3042\u308b\u5834\u5408\u3001\u6700\u7d42\u7684\u306a\u5024\u306f\u5b9f\u884c\u9806\u5e8f\u306b\u4f9d\u5b58\u3057\u307e\u3059\u3002"},{"location":"scala/part-6/","title":"Part VI: \u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u3068\u30c6\u30b9\u30c8","text":"<p>\u672c\u7ae0\u3067\u306f\u3001\u3053\u308c\u307e\u3067\u5b66\u3093\u3060\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u6982\u5ff5\u3092\u7d71\u5408\u3057\u3001\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002\u307e\u305f\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306b\u304a\u3051\u308b\u30c6\u30b9\u30c8\u6226\u7565\u306b\u3064\u3044\u3066\u3082\u5b66\u3073\u307e\u3059\u3002</p>"},{"location":"scala/part-6/#11","title":"\u7b2c11\u7ae0: \u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9","text":""},{"location":"scala/part-6/#111-travelguide","title":"11.1 TravelGuide \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3","text":"<p>\u65c5\u884c\u30ac\u30a4\u30c9\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u4f8b\u306b\u3001\u5b9f\u8df5\u7684\u306a FP \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u69cb\u7bc9\u65b9\u6cd5\u3092\u5b66\u3073\u307e\u3059\u3002</p> <p></p>"},{"location":"scala/part-6/#112","title":"11.2 \u30c9\u30e1\u30a4\u30f3\u30e2\u30c7\u30eb\u306e\u5b9a\u7fa9","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch11_TravelGuide.scala</code></p> <pre><code>// \u4f4d\u7f6e\u60c5\u5831\u3092\u8868\u3059\u5024\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\nopaque type LocationId = String\nobject LocationId {\n  def apply(value: String): LocationId = value\n  extension (a: LocationId) def value: String = a\n}\n\n// \u30ed\u30b1\u30fc\u30b7\u30e7\u30f3\ncase class Location(id: LocationId, name: String, population: Int)\n\n// \u30a2\u30c8\u30e9\u30af\u30b7\u30e7\u30f3\uff08\u89b3\u5149\u5730\uff09\ncase class Attraction(\n    name: String,\n    description: Option[String],\n    location: Location\n)\n\n// \u65c5\u884c\u30ac\u30a4\u30c9\ncase class TravelGuide(attraction: Attraction, subjects: List[String])\n</code></pre>"},{"location":"scala/part-6/#113","title":"11.3 \u30c7\u30fc\u30bf\u30a2\u30af\u30bb\u30b9\u5c64\u306e\u62bd\u8c61\u5316","text":"<p>\u5916\u90e8\u30c7\u30fc\u30bf\u30bd\u30fc\u30b9\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092\u30c8\u30ec\u30a4\u30c8\u3067\u62bd\u8c61\u5316\u3057\u307e\u3059\u3002</p> <pre><code>trait DataAccess {\n  def findAttractions(\n      name: String,\n      ordering: AttractionOrdering,\n      limit: Int\n  ): IO[List[Attraction]]\n\n  def findArtistsFromLocation(\n      locationId: LocationId,\n      limit: Int\n  ): IO[List[MusicArtist]]\n\n  def findMoviesAboutLocation(\n      locationId: LocationId,\n      limit: Int\n  ): IO[List[Movie]]\n}\n</code></pre> <p></p>"},{"location":"scala/part-6/#114-resource","title":"11.4 Resource \u306b\u3088\u308b\u30ea\u30bd\u30fc\u30b9\u7ba1\u7406","text":"<p>cats-effect \u306e <code>Resource</code> \u3092\u4f7f\u7528\u3057\u3066\u3001\u5b89\u5168\u306a\u30ea\u30bd\u30fc\u30b9\u7ba1\u7406\u3092\u5b9f\u73fe\u3057\u307e\u3059\u3002</p> <p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch11_TravelGuide.scala</code></p> <pre><code>def execQuery(\n    query: String\n): Resource[IO, List[QuerySolution]] = {\n  val connection: Resource[IO, RDFConnection] =\n    Resource.make(\n      IO.blocking(\n        RDFConnectionRemote\n          .create()\n          .destination(WikidataSparqlEndpoint)\n          .build()\n      )\n    )(connection =&gt; IO.blocking(connection.close()))\n\n  for {\n    conn   &lt;- connection\n    result &lt;- Resource.eval(IO.blocking {\n      val resultSet = conn.query(query).execSelect()\n      resultSet.asScala.toList\n    })\n  } yield result\n}\n</code></pre> <p></p>"},{"location":"scala/part-6/#115","title":"11.5 \u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u5b9f\u88c5","text":"<p><code>Ref</code> \u3092\u4f7f\u7528\u3057\u305f\u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u30ad\u30e3\u30c3\u30b7\u30e5\u306e\u5b9f\u88c5:</p> <pre><code>def cachedAttractions(\n    dataAccess: DataAccess\n): IO[DataAccess] = {\n  for {\n    cache &lt;- Ref.of[IO, Map[String, List[Attraction]]](Map.empty)\n  } yield new DataAccess {\n    def findAttractions(\n        name: String,\n        ordering: AttractionOrdering,\n        limit: Int\n    ): IO[List[Attraction]] = {\n      val key = s\"$name-$ordering-$limit\"\n      for {\n        cached &lt;- cache.get.map(_.get(key))\n        result &lt;- cached match {\n          case Some(attractions) =&gt; IO.pure(attractions)\n          case None =&gt;\n            for {\n              attractions &lt;- dataAccess.findAttractions(name, ordering, limit)\n              _           &lt;- cache.update(_ + (key -&gt; attractions))\n            } yield attractions\n        }\n      } yield result\n    }\n\n    // \u4ed6\u306e\u30e1\u30bd\u30c3\u30c9\u3082\u540c\u69d8\u306b\u5b9f\u88c5...\n  }\n}\n</code></pre> <p></p>"},{"location":"scala/part-6/#116","title":"11.6 \u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u306e\u7d44\u307f\u7acb\u3066","text":"<p>\u3059\u3079\u3066\u306e\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u69cb\u7bc9\u3057\u307e\u3059\u3002</p> <pre><code>def travelGuide(data: DataAccess, attractionName: String): IO[Option[TravelGuide]] = {\n  for {\n    attractions &lt;- data.findAttractions(attractionName, ByLocationPopulation, 1)\n    guide &lt;- attractions.headOption match {\n      case None =&gt; IO.pure(None)\n      case Some(attraction) =&gt;\n        for {\n          artists &lt;- data.findArtistsFromLocation(attraction.location.id, 2)\n          movies  &lt;- data.findMoviesAboutLocation(attraction.location.id, 2)\n        } yield Some(\n          TravelGuide(\n            attraction,\n            artists.map(_.name) ++ movies.map(_.name)\n          )\n        )\n    }\n  } yield guide\n}\n</code></pre> <p></p>"},{"location":"scala/part-6/#12","title":"\u7b2c12\u7ae0: \u30c6\u30b9\u30c8\u6226\u7565","text":""},{"location":"scala/part-6/#121","title":"12.1 \u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u30c6\u30b9\u30c8","text":"<p>\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u3067\u306f\u3001\u7d14\u7c8b\u95a2\u6570\u306e\u304a\u304b\u3052\u3067\u30c6\u30b9\u30c8\u304c\u975e\u5e38\u306b\u7c21\u5358\u306b\u306a\u308a\u307e\u3059\u3002</p> <p></p>"},{"location":"scala/part-6/#122-searchreport","title":"12.2 SearchReport \u306e\u5c0e\u5165","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch12_TravelGuide.scala</code></p> <p>\u30c6\u30b9\u30c8\u53ef\u80fd\u6027\u3092\u9ad8\u3081\u308b\u305f\u3081\u3001<code>SearchReport</code> \u3092\u5c0e\u5165\u3057\u307e\u3059\u3002</p> <pre><code>case class SearchReport(\n    attractionsSearched: Int,\n    errors: List[String]\n)\n\ncase class TravelGuide(\n    attraction: Attraction,\n    subjects: List[String],\n    searchReport: SearchReport\n)\n</code></pre> <p></p>"},{"location":"scala/part-6/#123","title":"12.3 \u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0\u306e\u6539\u5584","text":"<pre><code>def findArtistsFromLocation(\n    locationId: LocationId,\n    limit: Int\n): IO[Either[String, List[MusicArtist]]]\n\ndef findMoviesAboutLocation(\n    locationId: LocationId,\n    limit: Int\n): IO[Either[String, List[Movie]]]\n</code></pre> <p>Either \u3092\u4f7f\u7528\u3057\u3066\u30a8\u30e9\u30fc\u3092\u660e\u793a\u7684\u306b\u6271\u3044\u307e\u3059:</p> <pre><code>def travelGuide(\n    data: DataAccess,\n    attractionName: String\n): IO[Option[TravelGuide]] = {\n  for {\n    attractions &lt;- data.findAttractions(attractionName, ByLocationPopulation, 3)\n    guides &lt;- attractions.traverse { attraction =&gt;\n      for {\n        artistsResult &lt;- data.findArtistsFromLocation(attraction.location.id, 2)\n        moviesResult  &lt;- data.findMoviesAboutLocation(attraction.location.id, 2)\n      } yield {\n        val errors = List(artistsResult, moviesResult).collect {\n          case Left(error) =&gt; error\n        }\n        val artists = artistsResult.getOrElse(Nil)\n        val movies = moviesResult.getOrElse(Nil)\n        TravelGuide(\n          attraction,\n          artists.map(_.name) ++ movies.map(_.name),\n          SearchReport(attractions.size, errors)\n        )\n      }\n    }\n  } yield guides.headOption\n}\n</code></pre>"},{"location":"scala/part-6/#124","title":"12.4 \u30b9\u30bf\u30d6\u3092\u4f7f\u7528\u3057\u305f\u30c6\u30b9\u30c8","text":"<p>\u30bd\u30fc\u30b9\u30d5\u30a1\u30a4\u30eb: <code>app/scala/src/main/scala/ch12_TravelGuideTest.scala</code></p> <pre><code>// \u30c6\u30b9\u30c8\u7528\u306e\u30b9\u30bf\u30d6\u5b9f\u88c5\nval testDataAccess: DataAccess = new DataAccess {\n  def findAttractions(\n      name: String,\n      ordering: AttractionOrdering,\n      limit: Int\n  ): IO[List[Attraction]] = IO.pure(\n    List(\n      Attraction(\n        \"Test Attraction\",\n        Some(\"A test attraction\"),\n        Location(LocationId(\"Q123\"), \"Test City\", 100000)\n      )\n    )\n  )\n\n  def findArtistsFromLocation(\n      locationId: LocationId,\n      limit: Int\n  ): IO[Either[String, List[MusicArtist]]] =\n    IO.pure(Right(List(MusicArtist(\"Test Artist\"))))\n\n  def findMoviesAboutLocation(\n      locationId: LocationId,\n      limit: Int\n  ): IO[Either[String, List[Movie]]] =\n    IO.pure(Right(List(Movie(\"Test Movie\"))))\n}\n</code></pre> <p></p>"},{"location":"scala/part-6/#125","title":"12.5 \u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8","text":"<p>ScalaCheck \u3092\u4f7f\u7528\u3057\u305f\u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8:</p> <pre><code>import org.scalacheck.Gen\nimport org.scalacheck.Prop.forAll\n\n// \u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u306e\u5b9a\u7fa9\nval locationIdGen: Gen[LocationId] =\n  Gen.alphaNumStr.map(LocationId.apply)\n\nval locationGen: Gen[Location] = for {\n  id         &lt;- locationIdGen\n  name       &lt;- Gen.alphaStr\n  population &lt;- Gen.posNum[Int]\n} yield Location(id, name, population)\n\nval attractionGen: Gen[Attraction] = for {\n  name        &lt;- Gen.alphaStr\n  description &lt;- Gen.option(Gen.alphaStr)\n  location    &lt;- locationGen\n} yield Attraction(name, description, location)\n</code></pre> <p></p>"},{"location":"scala/part-6/#126","title":"12.6 \u4e0d\u5909\u6761\u4ef6\u306e\u30c6\u30b9\u30c8","text":"<pre><code>// \u30d7\u30ed\u30d1\u30c6\u30a3: \u30a2\u30c8\u30e9\u30af\u30b7\u30e7\u30f3\u306e\u6570\u306f limit \u4ee5\u4e0b\nproperty(\"findAttractions returns at most limit attractions\") =\n  forAll(Gen.alphaStr, Gen.posNum[Int]) { (name: String, limit: Int) =&gt;\n    val result = dataAccess\n      .findAttractions(name, ByLocationPopulation, limit)\n      .unsafeRunSync()\n    result.size &lt;= limit\n  }\n\n// \u30d7\u30ed\u30d1\u30c6\u30a3: SearchReport \u306e\u30a8\u30e9\u30fc\u6570\u306f\u691c\u7d22\u6570\u4ee5\u4e0b\nproperty(\"SearchReport errors are bounded by searches\") =\n  forAll(attractionGen) { attraction =&gt;\n    val guide = travelGuide(testDataAccess, attraction.name).unsafeRunSync()\n    guide.forall { g =&gt;\n      g.searchReport.errors.size &lt;= 2 // artists + movies\n    }\n  }\n</code></pre>"},{"location":"scala/part-6/#127","title":"12.7 \u7d71\u5408\u30c6\u30b9\u30c8","text":"<pre><code>// \u7d71\u5408\u30c6\u30b9\u30c8: \u30a8\u30f3\u30c9\u30c4\u30fc\u30a8\u30f3\u30c9\u306e\u30b7\u30ca\u30ea\u30aa\ntest(\"travelGuide returns guide for valid attraction\") {\n  val result = travelGuide(testDataAccess, \"Test\").unsafeRunSync()\n\n  assert(result.isDefined)\n  result.foreach { guide =&gt;\n    assert(guide.attraction.name == \"Test Attraction\")\n    assert(guide.subjects.nonEmpty)\n    assert(guide.searchReport.errors.isEmpty)\n  }\n}\n\n// \u30a8\u30e9\u30fc\u30b1\u30fc\u30b9\u306e\u30c6\u30b9\u30c8\ntest(\"travelGuide handles errors gracefully\") {\n  val failingDataAccess = new DataAccess {\n    def findAttractions(name: String, ordering: AttractionOrdering, limit: Int) =\n      IO.pure(List(testAttraction))\n\n    def findArtistsFromLocation(locationId: LocationId, limit: Int) =\n      IO.pure(Left(\"Network error\"))\n\n    def findMoviesAboutLocation(locationId: LocationId, limit: Int) =\n      IO.pure(Left(\"Timeout\"))\n  }\n\n  val result = travelGuide(failingDataAccess, \"Test\").unsafeRunSync()\n\n  assert(result.isDefined)\n  result.foreach { guide =&gt;\n    assert(guide.searchReport.errors.size == 2)\n  }\n}\n</code></pre>"},{"location":"scala/part-6/#128","title":"12.8 \u30c6\u30b9\u30c8\u30d4\u30e9\u30df\u30c3\u30c9","text":""},{"location":"scala/part-6/#_1","title":"\u307e\u3068\u3081","text":""},{"location":"scala/part-6/#part-vi_1","title":"Part VI \u3067\u5b66\u3093\u3060\u3053\u3068","text":""},{"location":"scala/part-6/#_2","title":"\u30ad\u30fc\u30dd\u30a4\u30f3\u30c8","text":"<ol> <li>\u62bd\u8c61\u5316\u306e\u91cd\u8981\u6027: DataAccess \u30c8\u30ec\u30a4\u30c8\u3067\u5916\u90e8\u4f9d\u5b58\u3092\u62bd\u8c61\u5316</li> <li>Resource \u3067\u30ea\u30bd\u30fc\u30b9\u7ba1\u7406: \u5b89\u5168\u306a\u30ea\u30bd\u30fc\u30b9\u306e\u53d6\u5f97\u3068\u89e3\u653e</li> <li>Ref \u3067\u30ad\u30e3\u30c3\u30b7\u30e5: \u30b9\u30ec\u30c3\u30c9\u30bb\u30fc\u30d5\u306a\u72b6\u614b\u7ba1\u7406</li> <li>Either \u3067\u30a8\u30e9\u30fc\u51e6\u7406: \u660e\u793a\u7684\u306a\u30a8\u30e9\u30fc\u30cf\u30f3\u30c9\u30ea\u30f3\u30b0</li> <li>SearchReport: \u30c6\u30b9\u30c8\u53ef\u80fd\u6027\u3068\u53ef\u89b3\u6e2c\u6027\u306e\u5411\u4e0a</li> <li>\u30b9\u30bf\u30d6: \u5916\u90e8\u4f9d\u5b58\u3092\u5dee\u3057\u66ff\u3048\u3066\u30c6\u30b9\u30c8</li> <li>\u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8: \u30e9\u30f3\u30c0\u30e0\u5165\u529b\u3067\u4e0d\u5909\u6761\u4ef6\u3092\u691c\u8a3c</li> </ol>"},{"location":"scala/part-6/#_3","title":"\u5b66\u7fd2\u306e\u7dcf\u62ec","text":""},{"location":"scala/part-6/#_4","title":"\u6f14\u7fd2\u554f\u984c","text":""},{"location":"scala/part-6/#1-dataaccess","title":"\u554f\u984c 1: DataAccess \u306e\u62e1\u5f35","text":"<p>\u4ee5\u4e0b\u306e\u8981\u4ef6\u3067 <code>DataAccess</code> \u3092\u62e1\u5f35\u3057\u3066\u304f\u3060\u3055\u3044: - \u65b0\u3057\u3044\u30e1\u30bd\u30c3\u30c9 <code>findHotelsNearLocation</code> \u3092\u8ffd\u52a0 - \u623b\u308a\u5024\u306f <code>IO[Either[String, List[Hotel]]]</code></p> \u89e3\u7b54 <pre><code>case class Hotel(name: String, rating: Double, location: Location)\n\ntrait DataAccess {\n  // \u65e2\u5b58\u306e\u30e1\u30bd\u30c3\u30c9...\n\n  def findHotelsNearLocation(\n      locationId: LocationId,\n      limit: Int\n  ): IO[Either[String, List[Hotel]]]\n}\n\n// \u30c6\u30b9\u30c8\u7528\u30b9\u30bf\u30d6\nval testDataAccess: DataAccess = new DataAccess {\n  // \u65e2\u5b58\u306e\u5b9f\u88c5...\n\n  def findHotelsNearLocation(\n      locationId: LocationId,\n      limit: Int\n  ): IO[Either[String, List[Hotel]]] =\n    IO.pure(Right(List(\n      Hotel(\"Test Hotel\", 4.5, testLocation)\n    )))\n}\n</code></pre>"},{"location":"scala/part-6/#2","title":"\u554f\u984c 2: \u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8","text":"<p>\u4ee5\u4e0b\u306e\u95a2\u6570\u306b\u5bfe\u3059\u308b\u30d7\u30ed\u30d1\u30c6\u30a3\u30d9\u30fc\u30b9\u30c6\u30b9\u30c8\u3092\u66f8\u3044\u3066\u304f\u3060\u3055\u3044:</p> <pre><code>def filterPopularLocations(\n    locations: List[Location],\n    minPopulation: Int\n): List[Location] =\n  locations.filter(_.population &gt;= minPopulation)\n</code></pre> \u89e3\u7b54 <pre><code>import org.scalacheck.Gen\nimport org.scalacheck.Prop.forAll\n\nval locationGen: Gen[Location] = for {\n  id         &lt;- Gen.alphaNumStr.map(LocationId.apply)\n  name       &lt;- Gen.alphaStr\n  population &lt;- Gen.chooseNum(0, 10000000)\n} yield Location(id, name, population)\n\nval locationsGen: Gen[List[Location]] =\n  Gen.listOf(locationGen)\n\n// \u30d7\u30ed\u30d1\u30c6\u30a31: \u7d50\u679c\u306f\u5165\u529b\u4ee5\u4e0b\u306e\u8981\u7d20\u6570\nproperty(\"result size &lt;= input size\") =\n  forAll(locationsGen, Gen.posNum[Int]) {\n    (locations: List[Location], minPop: Int) =&gt;\n      filterPopularLocations(locations, minPop).size &lt;= locations.size\n  }\n\n// \u30d7\u30ed\u30d1\u30c6\u30a32: \u7d50\u679c\u306e\u3059\u3079\u3066\u306e\u8981\u7d20\u306f\u6761\u4ef6\u3092\u6e80\u305f\u3059\nproperty(\"all results meet minimum population\") =\n  forAll(locationsGen, Gen.posNum[Int]) {\n    (locations: List[Location], minPop: Int) =&gt;\n      filterPopularLocations(locations, minPop)\n        .forall(_.population &gt;= minPop)\n  }\n\n// \u30d7\u30ed\u30d1\u30c6\u30a33: \u6761\u4ef6\u3092\u6e80\u305f\u3059\u8981\u7d20\u306f\u3059\u3079\u3066\u7d50\u679c\u306b\u542b\u307e\u308c\u308b\nproperty(\"all qualifying locations are in result\") =\n  forAll(locationsGen, Gen.posNum[Int]) {\n    (locations: List[Location], minPop: Int) =&gt;\n      val result = filterPopularLocations(locations, minPop)\n      locations.filter(_.population &gt;= minPop).forall(result.contains)\n  }\n</code></pre>"},{"location":"scala/part-6/#3-resource","title":"\u554f\u984c 3: Resource \u306e\u5b9f\u88c5","text":"<p>\u30d5\u30a1\u30a4\u30eb\u3092\u5b89\u5168\u306b\u8aad\u307f\u53d6\u308b <code>Resource</code> \u3092\u5b9f\u88c5\u3057\u3066\u304f\u3060\u3055\u3044\u3002</p> \u89e3\u7b54 <pre><code>import cats.effect.{IO, Resource}\nimport java.io.{BufferedReader, FileReader}\n\ndef fileResource(path: String): Resource[IO, BufferedReader] =\n  Resource.make(\n    IO.blocking(new BufferedReader(new FileReader(path)))\n  )(reader =&gt; IO.blocking(reader.close()))\n\ndef readLines(path: String): IO[List[String]] = {\n  fileResource(path).use { reader =&gt;\n    IO.blocking {\n      Iterator\n        .continually(reader.readLine())\n        .takeWhile(_ != null)\n        .toList\n    }\n  }\n}\n\n// \u4f7f\u7528\u4f8b\nval program: IO[Unit] = for {\n  lines &lt;- readLines(\"data.txt\")\n  _     &lt;- IO.println(s\"Read ${lines.size} lines\")\n} yield ()\n</code></pre>"},{"location":"scala/part-6/#_5","title":"\u30b7\u30ea\u30fc\u30ba\u5168\u4f53\u306e\u7dcf\u62ec","text":"<p>\u672c\u30b7\u30ea\u30fc\u30ba\u3067\u306f\u3001\u300cGrokking Functional Programming\u300d\u306e\u5185\u5bb9\u306b\u6cbf\u3063\u3066\u3001\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u57fa\u790e\u304b\u3089\u5b9f\u8df5\u7684\u306a\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u69cb\u7bc9\u307e\u3067\u3092\u5b66\u3073\u307e\u3057\u305f\u3002</p>"},{"location":"scala/part-6/#_6","title":"\u5b66\u3093\u3060\u4e3b\u306a\u6982\u5ff5","text":"Part \u7ae0 \u4e3b\u306a\u6982\u5ff5 I 1-2 \u7d14\u7c8b\u95a2\u6570\u3001\u53c2\u7167\u900f\u904e\u6027 II 3-5 \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u3001\u9ad8\u968e\u95a2\u6570\u3001flatMap III 6-7 Option\u3001Either\u3001ADT IV 8-9 IO \u30e2\u30ca\u30c9\u3001Stream V 10 \u4e26\u884c\u51e6\u7406\u3001Ref\u3001Fiber VI 11-12 \u5b9f\u8df5\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3001\u30c6\u30b9\u30c8"},{"location":"scala/part-6/#_7","title":"\u95a2\u6570\u578b\u30d7\u30ed\u30b0\u30e9\u30df\u30f3\u30b0\u306e\u5229\u70b9","text":"<ol> <li>\u4e88\u6e2c\u53ef\u80fd\u6027: \u7d14\u7c8b\u95a2\u6570\u306f\u540c\u3058\u5165\u529b\u306b\u5bfe\u3057\u3066\u5e38\u306b\u540c\u3058\u51fa\u529b</li> <li>\u30c6\u30b9\u30c8\u5bb9\u6613\u6027: \u526f\u4f5c\u7528\u304c\u306a\u3044\u305f\u3081\u30c6\u30b9\u30c8\u304c\u7c21\u5358</li> <li>\u5408\u6210\u53ef\u80fd\u6027: \u5c0f\u3055\u306a\u95a2\u6570\u3092\u7d44\u307f\u5408\u308f\u305b\u3066\u8907\u96d1\u306a\u51e6\u7406\u3092\u69cb\u7bc9</li> <li>\u4e26\u884c\u5b89\u5168\u6027: \u30a4\u30df\u30e5\u30fc\u30bf\u30d6\u30eb\u30c7\u30fc\u30bf\u306f\u7af6\u5408\u72b6\u614b\u3092\u9632\u3050</li> <li>\u578b\u5b89\u5168\u6027: Option\u3001Either \u3067 null \u3084\u4f8b\u5916\u3092\u578b\u3067\u8868\u73fe</li> </ol>"},{"location":"scala/part-6/#_8","title":"\u6b21\u306e\u30b9\u30c6\u30c3\u30d7","text":"<ul> <li>Cats Effect \u306e\u3088\u308a\u9ad8\u5ea6\u306a\u6a5f\u80fd\u3092\u5b66\u3076</li> <li>fs2 \u306e\u5b9f\u8df5\u7684\u306a\u4f7f\u7528\u65b9\u6cd5\u3092\u6df1\u3081\u308b</li> <li>ZIO \u306a\u3069\u4ed6\u306e FP \u30e9\u30a4\u30d6\u30e9\u30ea\u3092\u63a2\u7d22</li> <li>\u5b9f\u969b\u306e\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067 FP \u3092\u9069\u7528\u3059\u308b</li> </ul>"}]}